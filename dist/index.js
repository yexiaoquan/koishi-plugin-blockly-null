var rw=Object.defineProperty;var ow=(s,n,i)=>n in s?rw(s,n,{enumerable:true,configurable:true,writable:true,value:i}):s[n]=i;var oo=(s,n,i)=>ow(s,typeof n!="symbol"?n+"":n,i);import{send as _i,store as Ir,icons as aw}from"@koishijs/client";import{defineComponent as Ke,ref as me,watch as kt,resolveComponent as gt,createBlock as Ye,openBlock as ne,withCtx as je,createVNode as De,createElementVNode as de,createTextVNode as xt,computed as _e,createElementBlock as ve,normalizeClass as tt,renderSlot as Dt,toDisplayString as Bt,Fragment as Pt,renderList as pi,createCommentVNode as Ze,mergeProps as Hl,getCurrentInstance as sr,inject as Vs,unref as ue,isRef as Vl,warn as lw,provide as oc,onMounted as Rs,toRef as hn,onUnmounted as cw,shallowRef as xl,nextTick as rs,useAttrs as uw,useSlots as Cy,normalizeStyle as Hs,resolveDynamicComponent as qs,withModifiers as gs,onBeforeUnmount as Nr,Text as hw,reactive as zi,h as Wu,watchEffect as dw,onScopeDispose as Oy,markRaw as Wl,toRefs as wy,Transition as ac,withDirectives as hi,withKeys as lo,vShow as Hi,isVNode as ky,render as Ay,toRaw as df,toValue as Cr,getCurrentScope as _w,TransitionGroup as pw,shallowReadonly as gw,onUpdated as Ly,vModelText as Ny,customRef as fw,createStaticVNode as rh,createApp as mw,KeepAlive as Ew}from"vue";import{isClient as ir,computedEager as vw,useEventListener as J_,useResizeObserver as bw}from"@vueuse/core";function Tw(s,n){for(var i=0;i<n.length;i++){const o=n[i];if(typeof o!="string"&&!Array.isArray(o)){for(const l in o)if(l!=="default"&&!(l in s)){const f=Object.getOwnPropertyDescriptor(o,l);f&&Object.defineProperty(s,l,f.get?f:{enumerable:true,get:()=>o[l]})}}}return Object.freeze(Object.defineProperty(s,Symbol.toStringTag,{value:"Module"}))}const Sw={class:"dialog-footer"},$w=Ke({__name:"import",props:["modelValue"],emits:["update:modelValue","callback"],setup(s,{emit:n}){const i=me(""),o=s,l=n,f=me(false),m=me(false);function u(){l("update:modelValue",false),l("callback",i.value,m.value),i.value="",m.value=false}return kt(o,_=>{f.value=o.modelValue}),kt(f,_=>{l("update:modelValue",_)}),(_,c)=>{const h=gt("el-input"),p=gt("el-checkbox"),T=gt("el-button"),$=gt("el-dialog");return ne(),Ye($,{modelValue:f.value,"onUpdate:modelValue":c[4]||(c[4]=S=>f.value=S),title:"导入插件",width:"700px"},{footer:je(()=>[de("span",Sw,[De(T,{onClick:c[2]||(c[2]=S=>l("update:modelValue"))},{default:je(()=>c[5]||(c[5]=[xt("关闭")])),_:1,__:[5]}),De(T,{type:"primary",onClick:c[3]||(c[3]=S=>u())},{default:je(()=>c[6]||(c[6]=[xt(" 导入 ")])),_:1,__:[6]})])]),default:je(()=>[De(h,{type:"textarea",rows:"10","input-style":"height: 200px;resize:none;",modelValue:i.value,"onUpdate:modelValue":c[0]||(c[0]=S=>i.value=S)},null,8,["modelValue"]),De(p,{label:"作为全新插件导入",modelValue:m.value,"onUpdate:modelValue":c[1]||(c[1]=S=>m.value=S)},null,8,["modelValue"])]),_:1},8,["modelValue"])}}}),yw=Ke({__name:"export",props:["modelValue"],emits:["update:modelValue"],setup(s,{emit:n}){const i=me(false);kt(s,f=>{i.value=f.modelValue});const l=_e(()=>i.value??"");return(f,m)=>{const u=gt("el-input"),_=gt("el-dialog");return ne(),Ye(_,{modelValue:i.value,"onUpdate:modelValue":m[1]||(m[1]=c=>i.value=c),title:"导出插件",width:"700px"},{default:je(()=>[De(u,{type:"textarea",rows:"10","input-style":"height: 200px;resize:none;",modelValue:l.value,"onUpdate:modelValue":m[0]||(m[0]=c=>l.value=c),readonly:""},null,8,["modelValue"])]),_:1},8,["modelValue"])}}}),Rw=Ke({__name:"blockly-tab-item",props:{label:{},value:{},modelValue:{}},emits:["update:modelValue"],setup(s){return(n,i)=>(ne(),ve("div",{class:tt(["k-tab-item k-menu-item",{active:n.value===n.modelValue}]),onClick:i[0]||(i[0]=o=>n.$emit("update:modelValue",n.value))},[Dt(n.$slots,"default",{},()=>[xt(Bt(n.label.name)+" ",1),de("span",{class:tt({dot:true,enabled:n.label.enabled,edited:n.label.edited})},null,2)],true)],2))}}),rr=(s,n)=>{const i=s.__vccOpts||s;for(const[o,l]of n)i[o]=l;return i},Iw=rr(Rw,[["__scopeId","data-v-57c080b0"]]),Cw=Ke({__name:"blockly-tab-group",props:{data:{},modelValue:{},filter:{type:Function}},emits:["update:modelValue"],setup(s,{emit:n}){const i=s;console.info(i.data);const o=n,l=_e({get:()=>i.modelValue,set:f=>o("update:modelValue",f)});return(f,m)=>(ne(true),ve(Pt,null,pi(f.data,(u,_)=>(ne(),ve(Pt,{key:_},[!f.filter||f.filter(_)?(ne(),Ye(Iw,{key:0,modelValue:l.value,"onUpdate:modelValue":m[0]||(m[0]=c=>l.value=c),label:u,value:_},{default:je(()=>[Dt(f.$slots,"default",Hl({ref_for:true},{id:u}))]),_:2},1032,["modelValue","label","value"])):Ze("v-if",true)],64))),128))}}),My=Symbol(),Pu="el",Ow="is-",ao=(s,n,i,o,l)=>{let f=`${s}-${n}`;return i&&(f+=`-${i}`),o&&(f+=`__${o}`),l&&(f+=`--${l}`),f},Dy=Symbol("namespaceContextKey"),xy=s=>{const n=s||(sr()?Vs(Dy,me(Pu)):me(Pu));return _e(()=>ue(n)||Pu)},nr=(s,n)=>{const i=xy(n);return{namespace:i,b:(y="")=>ao(i.value,s,y,"",""),e:y=>y?ao(i.value,s,"",y,""):"",m:y=>y?ao(i.value,s,"","",y):"",be:(y,g)=>y&&g?ao(i.value,s,y,g,""):"",em:(y,g)=>y&&g?ao(i.value,s,"",y,g):"",bm:(y,g)=>y&&g?ao(i.value,s,y,"",g):"",bem:(y,g,E)=>y&&g&&E?ao(i.value,s,y,g,E):"",is:(y,...g)=>{const E=g.length>=1?g[0]:true;return y&&E?`${Ow}${y}`:""},cssVar:y=>{const g={};for(const E in y)y[E]&&(g[`--${i.value}-${E}`]=y[E]);return g},cssVarName:y=>`--${i.value}-${y}`,cssVarBlock:y=>{const g={};for(const E in y)y[E]&&(g[`--${i.value}-${s}-${E}`]=y[E]);return g},cssVarBlockName:y=>`--${i.value}-${s}-${y}`}};/**
* @vue/shared v3.5.17
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/const Bl=()=>{},ww=Object.prototype.hasOwnProperty,zu=(s,n)=>ww.call(s,n),ha=s=>typeof s=="function",er=s=>typeof s=="string",da=s=>s!==null&&typeof s=="object",kw=s=>{const n=Object.create(null);return i=>n[i]||(n[i]=s(i))},Aw=/-(\w)/g,Lw=kw(s=>s.replace(Aw,(n,i)=>i?i.toUpperCase():""));var Nw=typeof global=="object"&&global&&global.Object===Object&&global,Mw=typeof self=="object"&&self&&self.Object===Object&&self,Wf=Nw||Mw||Function("return this")(),Ar=Wf.Symbol,By=Object.prototype,Dw=By.hasOwnProperty,xw=By.toString,wl=Ar?Ar.toStringTag:void 0;function Bw(s){var n=Dw.call(s,wl),i=s[wl];try{s[wl]=void 0;var o=true}catch{}var l=xw.call(s);return o&&(n?s[wl]=i:delete s[wl]),l}var Pw=Object.prototype,Uw=Pw.toString;function Fw(s){return Uw.call(s)}var Gw="[object Null]",Hw="[object Undefined]",rT=Ar?Ar.toStringTag:void 0;function zf(s){return s==null?s===void 0?Hw:Gw:rT&&rT in Object(s)?Bw(s):Fw(s)}function jf(s){return s!=null&&typeof s=="object"}var Vw="[object Symbol]";function Xf(s){return typeof s=="symbol"||jf(s)&&zf(s)==Vw}function Ww(s,n){for(var i=-1,o=s==null?0:s.length,l=Array(o);++i<o;)l[i]=n(s[i],i,s);return l}var lc=Array.isArray,oT=Ar?Ar.prototype:void 0,aT=oT?oT.toString:void 0;function Py(s){if(typeof s=="string")return s;if(lc(s))return Ww(s,Py)+"";if(Xf(s))return aT?aT.call(s):"";var n=s+"";return n=="0"&&1/s==-1/0?"-0":n}function ju(s){var n=typeof s;return s!=null&&(n=="object"||n=="function")}function zw(s){return s}var jw="[object AsyncFunction]",Xw="[object Function]",Kw="[object GeneratorFunction]",Yw="[object Proxy]";function qw(s){if(!ju(s))return false;var n=zf(s);return n==Xw||n==Kw||n==jw||n==Yw}var Z_=Wf["__core-js_shared__"],lT=function(){var s=/[^.]+$/.exec(Z_&&Z_.keys&&Z_.keys.IE_PROTO||"");return s?"Symbol(src)_1."+s:""}();function Jw(s){return!!lT&&lT in s}var Zw=Function.prototype,Qw=Zw.toString;function ek(s){if(s!=null){try{return Qw.call(s)}catch{}try{return s+""}catch{}}return""}var tk=/[\\^$.*+?()[\]{}|]/g,sk=/^\[object .+?Constructor\]$/,ik=Function.prototype,nk=Object.prototype,rk=ik.toString,ok=nk.hasOwnProperty,ak=RegExp("^"+rk.call(ok).replace(tk,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function lk(s){if(!ju(s)||Jw(s))return false;var n=qw(s)?ak:sk;return n.test(ek(s))}function ck(s,n){return s==null?void 0:s[n]}function Kf(s,n){var i=ck(s,n);return lk(i)?i:void 0}function uk(s,n,i){switch(i.length){case 0:return s.call(n);case 1:return s.call(n,i[0]);case 2:return s.call(n,i[0],i[1]);case 3:return s.call(n,i[0],i[1],i[2])}return s.apply(n,i)}var hk=800,dk=16,_k=Date.now;function pk(s){var n=0,i=0;return function(){var o=_k(),l=dk-(o-i);if(i=o,l>0){if(++n>=hk)return arguments[0]}else n=0;return s.apply(void 0,arguments)}}function gk(s){return function(){return s}}var Xu=function(){try{var s=Kf(Object,"defineProperty");return s({},"",{}),s}catch{}}(),fk=Xu?function(s,n){return Xu(s,"toString",{configurable:true,enumerable:false,value:gk(n),writable:true})}:zw,mk=pk(fk),Ek=9007199254740991,vk=/^(?:0|[1-9]\d*)$/;function Uy(s,n){var i=typeof s;return n=n??Ek,!!n&&(i=="number"||i!="symbol"&&vk.test(s))&&s>-1&&s%1==0&&s<n}function bk(s,n,i){n=="__proto__"&&Xu?Xu(s,n,{configurable:true,enumerable:true,value:i,writable:true}):s[n]=i}function Fy(s,n){return s===n||s!==s&&n!==n}var Tk=Object.prototype,Sk=Tk.hasOwnProperty;function $k(s,n,i){var o=s[n];(!(Sk.call(s,n)&&Fy(o,i))||i===void 0&&!(n in s))&&bk(s,n,i)}var cT=Math.max;function yk(s,n,i){return n=cT(n===void 0?s.length-1:n,0),function(){for(var o=arguments,l=-1,f=cT(o.length-n,0),m=Array(f);++l<f;)m[l]=o[n+l];l=-1;for(var u=Array(n+1);++l<n;)u[l]=o[l];return u[n]=i(m),uk(s,this,u)}}var Rk=9007199254740991;function Ik(s){return typeof s=="number"&&s>-1&&s%1==0&&s<=Rk}var Ck="[object Arguments]";function uT(s){return jf(s)&&zf(s)==Ck}var Gy=Object.prototype,Ok=Gy.hasOwnProperty,wk=Gy.propertyIsEnumerable,Hy=uT(function(){return arguments}())?uT:function(s){return jf(s)&&Ok.call(s,"callee")&&!wk.call(s,"callee")},kk=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Ak=/^\w*$/;function Lk(s,n){if(lc(s))return false;var i=typeof s;return i=="number"||i=="symbol"||i=="boolean"||s==null||Xf(s)?true:Ak.test(s)||!kk.test(s)||n!=null&&s in Object(n)}var zl=Kf(Object,"create");function Nk(){this.__data__=zl?zl(null):{},this.size=0}function Mk(s){var n=this.has(s)&&delete this.__data__[s];return this.size-=n?1:0,n}var Dk="__lodash_hash_undefined__",xk=Object.prototype,Bk=xk.hasOwnProperty;function Pk(s){var n=this.__data__;if(zl){var i=n[s];return i===Dk?void 0:i}return Bk.call(n,s)?n[s]:void 0}var Uk=Object.prototype,Fk=Uk.hasOwnProperty;function Gk(s){var n=this.__data__;return zl?n[s]!==void 0:Fk.call(n,s)}var Hk="__lodash_hash_undefined__";function Vk(s,n){var i=this.__data__;return this.size+=this.has(s)?0:1,i[s]=zl&&n===void 0?Hk:n,this}function fo(s){var n=-1,i=s==null?0:s.length;for(this.clear();++n<i;){var o=s[n];this.set(o[0],o[1])}}fo.prototype.clear=Nk;fo.prototype.delete=Mk;fo.prototype.get=Pk;fo.prototype.has=Gk;fo.prototype.set=Vk;function Wk(){this.__data__=[],this.size=0}function oh(s,n){for(var i=s.length;i--;)if(Fy(s[i][0],n))return i;return-1}var zk=Array.prototype,jk=zk.splice;function Xk(s){var n=this.__data__,i=oh(n,s);if(i<0)return false;var o=n.length-1;return i==o?n.pop():jk.call(n,i,1),--this.size,true}function Kk(s){var n=this.__data__,i=oh(n,s);return i<0?void 0:n[i][1]}function Yk(s){return oh(this.__data__,s)>-1}function qk(s,n){var i=this.__data__,o=oh(i,s);return o<0?(++this.size,i.push([s,n])):i[o][1]=n,this}function Sa(s){var n=-1,i=s==null?0:s.length;for(this.clear();++n<i;){var o=s[n];this.set(o[0],o[1])}}Sa.prototype.clear=Wk;Sa.prototype.delete=Xk;Sa.prototype.get=Kk;Sa.prototype.has=Yk;Sa.prototype.set=qk;var Jk=Kf(Wf,"Map");function Zk(){this.size=0,this.__data__={hash:new fo,map:new(Jk||Sa),string:new fo}}function Qk(s){var n=typeof s;return n=="string"||n=="number"||n=="symbol"||n=="boolean"?s!=="__proto__":s===null}function ah(s,n){var i=s.__data__;return Qk(n)?i[typeof n=="string"?"string":"hash"]:i.map}function eA(s){var n=ah(this,s).delete(s);return this.size-=n?1:0,n}function tA(s){return ah(this,s).get(s)}function sA(s){return ah(this,s).has(s)}function iA(s,n){var i=ah(this,s),o=i.size;return i.set(s,n),this.size+=i.size==o?0:1,this}function To(s){var n=-1,i=s==null?0:s.length;for(this.clear();++n<i;){var o=s[n];this.set(o[0],o[1])}}To.prototype.clear=Zk;To.prototype.delete=eA;To.prototype.get=tA;To.prototype.has=sA;To.prototype.set=iA;var nA="Expected a function";function Yf(s,n){if(typeof s!="function"||n!=null&&typeof n!="function")throw new TypeError(nA);var i=function(){var o=arguments,l=n?n.apply(this,o):o[0],f=i.cache;if(f.has(l))return f.get(l);var m=s.apply(this,o);return i.cache=f.set(l,m)||f,m};return i.cache=new(Yf.Cache||To),i}Yf.Cache=To;var rA=500;function oA(s){var n=Yf(s,function(o){return i.size===rA&&i.clear(),o}),i=n.cache;return n}var aA=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,lA=/\\(\\)?/g,cA=oA(function(s){var n=[];return s.charCodeAt(0)===46&&n.push(""),s.replace(aA,function(i,o,l,f){n.push(l?f.replace(lA,"$1"):o||i)}),n});function uA(s){return s==null?"":Py(s)}function lh(s,n){return lc(s)?s:Lk(s,n)?[s]:cA(uA(s))}function qf(s){if(typeof s=="string"||Xf(s))return s;var n=s+"";return n=="0"&&1/s==-1/0?"-0":n}function Vy(s,n){n=lh(n,s);for(var i=0,o=n.length;s!=null&&i<o;)s=s[qf(n[i++])];return i&&i==o?s:void 0}function hA(s,n,i){var o=s==null?void 0:Vy(s,n);return o===void 0?i:o}function dA(s,n){for(var i=-1,o=n.length,l=s.length;++i<o;)s[l+i]=n[i];return s}var hT=Ar?Ar.isConcatSpreadable:void 0;function _A(s){return lc(s)||Hy(s)||!!(hT&&s&&s[hT])}function pA(s,n,i,o,l){var f=-1,m=s.length;for(i||(i=_A),l||(l=[]);++f<m;){var u=s[f];i(u)?dA(l,u):l[l.length]=u}return l}function gA(s){var n=s==null?0:s.length;return n?pA(s):[]}function fA(s){return mk(yk(s,void 0,gA),s+"")}function mA(s,n){return s!=null&&n in Object(s)}function EA(s,n,i){n=lh(n,s);for(var o=-1,l=n.length,f=false;++o<l;){var m=qf(n[o]);if(!(f=s!=null&&i(s,m)))break;s=s[m]}return f||++o!=l?f:(l=s==null?0:s.length,!!l&&Ik(l)&&Uy(m,l)&&(lc(s)||Hy(s)))}function vA(s,n){return s!=null&&EA(s,n,mA)}function Wy(s){for(var n=-1,i=s==null?0:s.length,o={};++n<i;){var l=s[n];o[l[0]]=l[1]}return o}function zy(s){return s==null}function bA(s,n,i,o){if(!ju(s))return s;n=lh(n,s);for(var l=-1,f=n.length,m=f-1,u=s;u!=null&&++l<f;){var _=qf(n[l]),c=i;if(_==="__proto__"||_==="constructor"||_==="prototype")return s;if(l!=m){var h=u[_];c=void 0,c===void 0&&(c=ju(h)?h:Uy(n[l+1])?[]:{})}$k(u,_,c),u=u[_]}return s}function TA(s,n,i){for(var o=-1,l=n.length,f={};++o<l;){var m=n[o],u=Vy(s,m);i(u,m)&&bA(f,lh(m,s),u)}return f}function SA(s,n){return TA(s,n,function(i,o){return vA(s,o)})}var $A=fA(function(s,n){return s==null?{}:SA(s,n)});const jy=s=>s===void 0,Ku=s=>typeof s=="number",Yu=s=>typeof Element>"u"?false:s instanceof Element,yA=s=>er(s)?!Number.isNaN(Number(s)):false;class RA extends Error{constructor(n){super(n),this.name="ElementPlusError"}}function IA(s,n){throw new RA(`[${s}] ${n}`)}const dT={current:0},_T=me(0),Xy=2e3,pT=Symbol("elZIndexContextKey"),Ky=Symbol("zIndexContextKey"),CA=s=>{const n=sr()?Vs(pT,dT):dT,i=s||(sr()?Vs(Ky,void 0):void 0),o=_e(()=>{const m=ue(i);return Ku(m)?m:Xy}),l=_e(()=>o.value+_T.value),f=()=>(n.current++,_T.value=n.current,l.value);return!ir&&Vs(pT),{initialZIndex:o,currentZIndex:l,nextZIndex:f}};var OA={name:"en",el:{breadcrumb:{label:"Breadcrumb"},colorpicker:{confirm:"OK",clear:"Clear",defaultLabel:"color picker",description:"current color is {color}. press enter to select a new color.",alphaLabel:"pick alpha value"},datepicker:{now:"Now",today:"Today",cancel:"Cancel",clear:"Clear",confirm:"OK",dateTablePrompt:"Use the arrow keys and enter to select the day of the month",monthTablePrompt:"Use the arrow keys and enter to select the month",yearTablePrompt:"Use the arrow keys and enter to select the year",selectedDate:"Selected date",selectDate:"Select date",selectTime:"Select time",startDate:"Start Date",startTime:"Start Time",endDate:"End Date",endTime:"End Time",prevYear:"Previous Year",nextYear:"Next Year",prevMonth:"Previous Month",nextMonth:"Next Month",year:"",month1:"January",month2:"February",month3:"March",month4:"April",month5:"May",month6:"June",month7:"July",month8:"August",month9:"September",month10:"October",month11:"November",month12:"December",week:"week",weeks:{sun:"Sun",mon:"Mon",tue:"Tue",wed:"Wed",thu:"Thu",fri:"Fri",sat:"Sat"},weeksFull:{sun:"Sunday",mon:"Monday",tue:"Tuesday",wed:"Wednesday",thu:"Thursday",fri:"Friday",sat:"Saturday"},months:{jan:"Jan",feb:"Feb",mar:"Mar",apr:"Apr",may:"May",jun:"Jun",jul:"Jul",aug:"Aug",sep:"Sep",oct:"Oct",nov:"Nov",dec:"Dec"}},inputNumber:{decrease:"decrease number",increase:"increase number"},select:{loading:"Loading",noMatch:"No matching data",noData:"No data",placeholder:"Select"},mention:{loading:"Loading"},dropdown:{toggleDropdown:"Toggle Dropdown"},cascader:{noMatch:"No matching data",loading:"Loading",placeholder:"Select",noData:"No data"},pagination:{goto:"Go to",pagesize:"/page",total:"Total {total}",pageClassifier:"",page:"Page",prev:"Go to previous page",next:"Go to next page",currentPage:"page {pager}",prevPages:"Previous {pager} pages",nextPages:"Next {pager} pages",deprecationWarning:"Deprecated usages detected, please refer to the el-pagination documentation for more details"},dialog:{close:"Close this dialog"},drawer:{close:"Close this dialog"},messagebox:{title:"Message",confirm:"OK",cancel:"Cancel",error:"Illegal input",close:"Close this dialog"},upload:{deleteTip:"press delete to remove",delete:"Delete",preview:"Preview",continue:"Continue"},slider:{defaultLabel:"slider between {min} and {max}",defaultRangeStartLabel:"pick start value",defaultRangeEndLabel:"pick end value"},table:{emptyText:"No Data",confirmFilter:"Confirm",resetFilter:"Reset",clearFilter:"All",sumText:"Sum"},tour:{next:"Next",previous:"Previous",finish:"Finish"},tree:{emptyText:"No Data"},transfer:{noMatch:"No matching data",noData:"No data",titles:["List 1","List 2"],filterPlaceholder:"Enter keyword",noCheckedFormat:"{total} items",hasCheckedFormat:"{checked}/{total} checked"},image:{error:"FAILED"},pageHeader:{title:"Back"},popconfirm:{confirmButtonText:"Yes",cancelButtonText:"No"},carousel:{leftArrow:"Carousel arrow left",rightArrow:"Carousel arrow right",indicator:"Carousel switch to index {index}"}}};const wA=s=>(n,i)=>kA(n,i,ue(s)),kA=(s,n,i)=>hA(i,s,s).replace(/\{(\w+)\}/g,(o,l)=>{var f;return`${(f=n==null?void 0:n[l])!=null?f:`{${l}}`}`}),AA=s=>{const n=_e(()=>ue(s).name),i=Vl(s)?s:me(s);return{lang:n,locale:i,t:wA(s)}},Yy=Symbol("localeContextKey"),LA=s=>{const n=s||Vs(Yy,me());return AA(_e(()=>n.value||OA))},qy="__epPropKey",Zn=s=>s,NA=s=>da(s)&&!!s[qy],Jy=(s,n)=>{if(!da(s)||NA(s))return s;const{values:i,required:o,default:l,type:f,validator:m}=s,_={type:f,required:!!o,validator:i||m?c=>{let h=false,p=[];if(i&&(p=Array.from(i),zu(s,"default")&&p.push(l),h||(h=p.includes(c))),m&&(h||(h=m(c))),!h&&p.length>0){const T=[...new Set(p)].map($=>JSON.stringify($)).join(", ");lw(`Invalid prop: validation failed${n?` for prop "${n}"`:""}. Expected one of [${T}], got value ${JSON.stringify(c)}.`)}return h}:void 0,[qy]:true};return zu(s,"default")&&(_.default=l),_},$a=s=>Wy(Object.entries(s).map(([n,i])=>[n,Jy(i,n)])),Zy=["","default","small","large"],Qy=Jy({type:String,values:Zy,required:false}),eR=Symbol("size"),MA=()=>{const s=Vs(eR,{});return _e(()=>ue(s.size)||"")},DA=Symbol("emptyValuesContextKey");$a({emptyValues:Array,valueOnClear:{type:[String,Number,Boolean,Function],default:void 0,validator:s=>ha(s)?!s():!s}});const gT=s=>Object.keys(s),qu=me();function Jf(s,n=void 0){const i=sr()?Vs(My,qu):qu;return s?_e(()=>{var o,l;return(l=(o=i.value)==null?void 0:o[s])!=null?l:n}):i}function xA(s,n){const i=Jf(),o=nr(s,_e(()=>{var u;return((u=i.value)==null?void 0:u.namespace)||Pu})),l=LA(_e(()=>{var u;return(u=i.value)==null?void 0:u.locale})),f=CA(_e(()=>{var u;return((u=i.value)==null?void 0:u.zIndex)||Xy})),m=_e(()=>{var u;return ue(n)||((u=i.value)==null?void 0:u.size)||""});return BA(_e(()=>ue(i)||{})),{ns:o,locale:l,zIndex:f,size:m}}const BA=(s,n,i=false)=>{var o;const l=!!sr(),f=l?Jf():void 0,m=(o=void 0)!=null?o:l?oc:void 0;if(!m)return;const u=_e(()=>{const _=ue(s);return f!=null&&f.value?PA(f.value,_):_});return m(My,u),m(Yy,_e(()=>u.value.locale)),m(Dy,_e(()=>u.value.namespace)),m(Ky,_e(()=>u.value.zIndex)),m(eR,{size:_e(()=>u.value.size||"")}),m(DA,_e(()=>({emptyValues:u.value.emptyValues,valueOnClear:u.value.valueOnClear}))),(i||!qu.value)&&(qu.value=u.value),u},PA=(s,n)=>{const i=[...new Set([...gT(s),...gT(n)])],o={};for(const l of i)o[l]=n[l]!==void 0?n[l]:s[l];return o},_f="update:modelValue",fT="change",mT="input";var ya=(s,n)=>{const i=s.__vccOpts||s;for(const[o,l]of n)i[o]=l;return i};const tR=(s="")=>s.split(" ").filter(n=>!!n.trim()),ET=(s,n)=>{if(!s||!n)return false;if(n.includes(" "))throw new Error("className should not contain space.");return s.classList.contains(n)},UA=(s,n)=>{!s||!n.trim()||s.classList.add(...tR(n))},FA=(s,n)=>{!s||!n.trim()||s.classList.remove(...tR(n))},GA=(s,n)=>{var i;if(!ir||!s||!n)return"";let o=Lw(n);o==="float"&&(o="cssFloat");try{const l=s.style[o];if(l)return l;const f=(i=document.defaultView)==null?void 0:i.getComputedStyle(s,"");return f?f[o]:""}catch{return s.style[o]}};function pf(s,n="px"){if(!s)return"";if(Ku(s)||yA(s))return`${s}${n}`;if(er(s))return s}let yu;const HA=s=>{var n;if(!ir)return 0;if(yu!==void 0)return yu;const i=document.createElement("div");i.className=`${s}-scrollbar__wrap`,i.style.visibility="hidden",i.style.width="100px",i.style.position="absolute",i.style.top="-9999px",document.body.appendChild(i);const o=i.offsetWidth;i.style.overflow="scroll";const l=document.createElement("div");l.style.width="100%",i.appendChild(l);const f=l.offsetWidth;return(n=i.parentNode)==null||n.removeChild(i),yu=o-f,yu},Zf=(s,n)=>{if(s.install=i=>{for(const o of[s,...Object.values(n??{})])i.component(o.name,o)},n)for(const[i,o]of Object.entries(n))s[i]=o;return s},VA=s=>(s.install=Bl,s),WA=$a({size:{type:Zn([Number,String])},color:{type:String}}),zA=Ke({name:"ElIcon",inheritAttrs:false}),jA=Ke({...zA,props:WA,setup(s){const n=s,i=nr("icon"),o=_e(()=>{const{size:l,color:f}=n;return!l&&!f?{}:{fontSize:jy(l)?void 0:pf(l),"--color":f}});return(l,f)=>(ne(),ve("i",Hl({class:ue(i).b(),style:ue(o)},l.$attrs),[Dt(l.$slots,"default")],16))}});var XA=ya(jA,[["__file","icon.vue"]]);const Sr=Zf(XA);/*! Element Plus Icons Vue v2.3.1 */var KA=Ke({name:"CircleCheck",__name:"circle-check",setup(s){return(n,i)=>(ne(),ve("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[de("path",{fill:"currentColor",d:"M512 896a384 384 0 1 0 0-768 384 384 0 0 0 0 768m0 64a448 448 0 1 1 0-896 448 448 0 0 1 0 896"}),de("path",{fill:"currentColor",d:"M745.344 361.344a32 32 0 0 1 45.312 45.312l-288 288a32 32 0 0 1-45.312 0l-160-160a32 32 0 1 1 45.312-45.312L480 626.752l265.344-265.408z"})]))}}),YA=KA,qA=Ke({name:"CircleCloseFilled",__name:"circle-close-filled",setup(s){return(n,i)=>(ne(),ve("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[de("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896 448 448 0 0 1 0-896m0 393.664L407.936 353.6a38.4 38.4 0 1 0-54.336 54.336L457.664 512 353.6 616.064a38.4 38.4 0 1 0 54.336 54.336L512 566.336 616.064 670.4a38.4 38.4 0 1 0 54.336-54.336L566.336 512 670.4 407.936a38.4 38.4 0 1 0-54.336-54.336z"})]))}}),sR=qA,JA=Ke({name:"CircleClose",__name:"circle-close",setup(s){return(n,i)=>(ne(),ve("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[de("path",{fill:"currentColor",d:"m466.752 512-90.496-90.496a32 32 0 0 1 45.248-45.248L512 466.752l90.496-90.496a32 32 0 1 1 45.248 45.248L557.248 512l90.496 90.496a32 32 0 1 1-45.248 45.248L512 557.248l-90.496 90.496a32 32 0 0 1-45.248-45.248z"}),de("path",{fill:"currentColor",d:"M512 896a384 384 0 1 0 0-768 384 384 0 0 0 0 768m0 64a448 448 0 1 1 0-896 448 448 0 0 1 0 896"})]))}}),iR=JA,ZA=Ke({name:"Close",__name:"close",setup(s){return(n,i)=>(ne(),ve("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[de("path",{fill:"currentColor",d:"M764.288 214.592 512 466.88 259.712 214.592a31.936 31.936 0 0 0-45.12 45.12L466.752 512 214.528 764.224a31.936 31.936 0 1 0 45.12 45.184L512 557.184l252.288 252.288a31.936 31.936 0 0 0 45.12-45.12L557.12 512.064l252.288-252.352a31.936 31.936 0 1 0-45.12-45.184z"})]))}}),QA=ZA,eL=Ke({name:"Hide",__name:"hide",setup(s){return(n,i)=>(ne(),ve("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[de("path",{fill:"currentColor",d:"M876.8 156.8c0-9.6-3.2-16-9.6-22.4-6.4-6.4-12.8-9.6-22.4-9.6-9.6 0-16 3.2-22.4 9.6L736 220.8c-64-32-137.6-51.2-224-60.8-160 16-288 73.6-377.6 176C44.8 438.4 0 496 0 512s48 73.6 134.4 176c22.4 25.6 44.8 48 73.6 67.2l-86.4 89.6c-6.4 6.4-9.6 12.8-9.6 22.4 0 9.6 3.2 16 9.6 22.4 6.4 6.4 12.8 9.6 22.4 9.6 9.6 0 16-3.2 22.4-9.6l704-710.4c3.2-6.4 6.4-12.8 6.4-22.4Zm-646.4 528c-76.8-70.4-128-128-153.6-172.8 28.8-48 80-105.6 153.6-172.8C304 272 400 230.4 512 224c64 3.2 124.8 19.2 176 44.8l-54.4 54.4C598.4 300.8 560 288 512 288c-64 0-115.2 22.4-160 64s-64 96-64 160c0 48 12.8 89.6 35.2 124.8L256 707.2c-9.6-6.4-19.2-16-25.6-22.4Zm140.8-96c-12.8-22.4-19.2-48-19.2-76.8 0-44.8 16-83.2 48-112 32-28.8 67.2-48 112-48 28.8 0 54.4 6.4 73.6 19.2zM889.599 336c-12.8-16-28.8-28.8-41.6-41.6l-48 48c73.6 67.2 124.8 124.8 150.4 169.6-28.8 48-80 105.6-153.6 172.8-73.6 67.2-172.8 108.8-284.8 115.2-51.2-3.2-99.2-12.8-140.8-28.8l-48 48c57.6 22.4 118.4 38.4 188.8 44.8 160-16 288-73.6 377.6-176C979.199 585.6 1024 528 1024 512s-48.001-73.6-134.401-176Z"}),de("path",{fill:"currentColor",d:"M511.998 672c-12.8 0-25.6-3.2-38.4-6.4l-51.2 51.2c28.8 12.8 57.6 19.2 89.6 19.2 64 0 115.2-22.4 160-64 41.6-41.6 64-96 64-160 0-32-6.4-64-19.2-89.6l-51.2 51.2c3.2 12.8 6.4 25.6 6.4 38.4 0 44.8-16 83.2-48 112-32 28.8-67.2 48-112 48Z"})]))}}),tL=eL,sL=Ke({name:"InfoFilled",__name:"info-filled",setup(s){return(n,i)=>(ne(),ve("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[de("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896.064A448 448 0 0 1 512 64m67.2 275.072c33.28 0 60.288-23.104 60.288-57.344s-27.072-57.344-60.288-57.344c-33.28 0-60.16 23.104-60.16 57.344s26.88 57.344 60.16 57.344M590.912 699.2c0-6.848 2.368-24.64 1.024-34.752l-52.608 60.544c-10.88 11.456-24.512 19.392-30.912 17.28a12.992 12.992 0 0 1-8.256-14.72l87.68-276.992c7.168-35.136-12.544-67.2-54.336-71.296-44.096 0-108.992 44.736-148.48 101.504 0 6.784-1.28 23.68.064 33.792l52.544-60.608c10.88-11.328 23.552-19.328 29.952-17.152a12.8 12.8 0 0 1 7.808 16.128L388.48 728.576c-10.048 32.256 8.96 63.872 55.04 71.04 67.84 0 107.904-43.648 147.456-100.416z"})]))}}),gf=sL,iL=Ke({name:"Loading",__name:"loading",setup(s){return(n,i)=>(ne(),ve("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[de("path",{fill:"currentColor",d:"M512 64a32 32 0 0 1 32 32v192a32 32 0 0 1-64 0V96a32 32 0 0 1 32-32m0 640a32 32 0 0 1 32 32v192a32 32 0 1 1-64 0V736a32 32 0 0 1 32-32m448-192a32 32 0 0 1-32 32H736a32 32 0 1 1 0-64h192a32 32 0 0 1 32 32m-640 0a32 32 0 0 1-32 32H96a32 32 0 0 1 0-64h192a32 32 0 0 1 32 32M195.2 195.2a32 32 0 0 1 45.248 0L376.32 331.008a32 32 0 0 1-45.248 45.248L195.2 240.448a32 32 0 0 1 0-45.248zm452.544 452.544a32 32 0 0 1 45.248 0L828.8 783.552a32 32 0 0 1-45.248 45.248L647.744 692.992a32 32 0 0 1 0-45.248zM828.8 195.264a32 32 0 0 1 0 45.184L692.992 376.32a32 32 0 0 1-45.248-45.248l135.808-135.808a32 32 0 0 1 45.248 0m-452.544 452.48a32 32 0 0 1 0 45.248L240.448 828.8a32 32 0 0 1-45.248-45.248l135.808-135.808a32 32 0 0 1 45.248 0z"})]))}}),Ju=iL,nL=Ke({name:"SuccessFilled",__name:"success-filled",setup(s){return(n,i)=>(ne(),ve("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[de("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896 448 448 0 0 1 0-896m-55.808 536.384-99.52-99.584a38.4 38.4 0 1 0-54.336 54.336l126.72 126.72a38.272 38.272 0 0 0 54.336 0l262.4-262.464a38.4 38.4 0 1 0-54.272-54.336z"})]))}}),nR=nL,rL=Ke({name:"View",__name:"view",setup(s){return(n,i)=>(ne(),ve("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[de("path",{fill:"currentColor",d:"M512 160c320 0 512 352 512 352S832 864 512 864 0 512 0 512s192-352 512-352m0 64c-225.28 0-384.128 208.064-436.8 288 52.608 79.872 211.456 288 436.8 288 225.28 0 384.128-208.064 436.8-288-52.608-79.872-211.456-288-436.8-288zm0 64a224 224 0 1 1 0 448 224 224 0 0 1 0-448m0 64a160.192 160.192 0 0 0-160 160c0 88.192 71.744 160 160 160s160-71.808 160-160-71.744-160-160-160"})]))}}),oL=rL,aL=Ke({name:"WarningFilled",__name:"warning-filled",setup(s){return(n,i)=>(ne(),ve("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[de("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896 448 448 0 0 1 0-896m0 192a58.432 58.432 0 0 0-58.24 63.744l23.36 256.384a35.072 35.072 0 0 0 69.76 0l23.296-256.384A58.432 58.432 0 0 0 512 256m0 512a51.2 51.2 0 1 0 0-102.4 51.2 51.2 0 0 0 0 102.4"})]))}}),rR=aL;const Zu=Zn([String,Object,Function]),lL={Close:QA,SuccessFilled:nR,InfoFilled:gf,WarningFilled:rR,CircleCloseFilled:sR},vT={primary:gf,success:nR,warning:rR,error:sR,info:gf},cL={validating:Ju,success:YA,error:iR},uL=()=>ir&&/firefox/i.test(window.navigator.userAgent);let ui;const hL={height:"0",visibility:"hidden",overflow:uL()?"":"hidden",position:"absolute","z-index":"-1000",top:"0",right:"0"},dL=["letter-spacing","line-height","padding-top","padding-bottom","font-family","font-weight","font-size","text-rendering","text-transform","width","text-indent","padding-left","padding-right","border-width","box-sizing"];function _L(s){const n=window.getComputedStyle(s),i=n.getPropertyValue("box-sizing"),o=Number.parseFloat(n.getPropertyValue("padding-bottom"))+Number.parseFloat(n.getPropertyValue("padding-top")),l=Number.parseFloat(n.getPropertyValue("border-bottom-width"))+Number.parseFloat(n.getPropertyValue("border-top-width"));return{contextStyle:dL.map(m=>[m,n.getPropertyValue(m)]),paddingSize:o,borderSize:l,boxSizing:i}}function bT(s,n=1,i){var o;ui||(ui=document.createElement("textarea"),document.body.appendChild(ui));const{paddingSize:l,borderSize:f,boxSizing:m,contextStyle:u}=_L(s);u.forEach(([p,T])=>ui==null?void 0:ui.style.setProperty(p,T)),Object.entries(hL).forEach(([p,T])=>ui==null?void 0:ui.style.setProperty(p,T,"important")),ui.value=s.value||s.placeholder||"";let _=ui.scrollHeight;const c={};m==="border-box"?_=_+f:m==="content-box"&&(_=_-l),ui.value="";const h=ui.scrollHeight-l;if(Ku(n)){let p=h*n;m==="border-box"&&(p=p+l+f),_=Math.max(p,_),c.minHeight=`${p}px`}if(Ku(i)){let p=h*i;m==="border-box"&&(p=p+l+f),_=Math.min(p,_)}return c.height=`${_}px`,(o=ui.parentNode)==null||o.removeChild(ui),ui=void 0,c}const pL=s=>s,gL=$a({ariaLabel:String,ariaOrientation:{type:String,values:["horizontal","vertical","undefined"]},ariaControls:String}),fL=s=>$A(gL,s),mL=$a({id:{type:String,default:void 0},size:Qy,disabled:Boolean,modelValue:{type:Zn([String,Number,Object]),default:""},maxlength:{type:[String,Number]},minlength:{type:[String,Number]},type:{type:String,default:"text"},resize:{type:String,values:["none","both","horizontal","vertical"]},autosize:{type:Zn([Boolean,Object]),default:false},autocomplete:{type:String,default:"off"},formatter:{type:Function},parser:{type:Function},placeholder:{type:String},form:{type:String},readonly:Boolean,clearable:Boolean,showPassword:Boolean,showWordLimit:Boolean,suffixIcon:{type:Zu},prefixIcon:{type:Zu},containerRole:{type:String,default:void 0},tabindex:{type:[String,Number],default:0},validateEvent:{type:Boolean,default:true},inputStyle:{type:Zn([Object,Array,String]),default:()=>pL({})},autofocus:Boolean,rows:{type:Number,default:2},...fL(["ariaLabel"]),inputmode:{type:Zn(String),default:void 0},name:String}),EL={[_f]:s=>er(s),input:s=>er(s),change:s=>er(s),focus:s=>s instanceof FocusEvent,blur:s=>s instanceof FocusEvent,clear:()=>true,mouseleave:s=>s instanceof MouseEvent,mouseenter:s=>s instanceof MouseEvent,keydown:s=>s instanceof Event,compositionstart:s=>s instanceof CompositionEvent,compositionupdate:s=>s instanceof CompositionEvent,compositionend:s=>s instanceof CompositionEvent},vL=["class","style"],bL=/^on[A-Z]/,TL=(s={})=>{const{excludeListeners:n=false,excludeKeys:i}=s,o=_e(()=>((i==null?void 0:i.value)||[]).concat(vL)),l=sr();return l?_e(()=>{var f;return Wy(Object.entries((f=l.proxy)==null?void 0:f.$attrs).filter(([m])=>!o.value.includes(m)&&!(n&&bL.test(m))))}):_e(()=>({}))},TT={prefix:Math.floor(Math.random()*1e4),current:0},SL=Symbol("elIdInjection"),$L=()=>sr()?Vs(SL,TT):TT,ff=s=>{const n=$L(),i=xy();return vw(()=>ue(s)||`${i.value}-id-${n.prefix}-${n.current++}`)},Qf=Symbol("formContextKey"),oR=Symbol("formItemContextKey"),aR=()=>{const s=Vs(Qf,void 0),n=Vs(oR,void 0);return{form:s,formItem:n}},yL=(s,{formItemContext:n,disableIdGeneration:i,disableIdManagement:o})=>{i||(i=me(false)),o||(o=me(false));const l=me();let f;const m=_e(()=>{var u;return!!(!(s.label||s.ariaLabel)&&n&&n.inputIds&&((u=n.inputIds)==null?void 0:u.length)<=1)});return Rs(()=>{f=kt([hn(s,"id"),i],([u,_])=>{const c=u??(_?void 0:ff().value);c!==l.value&&(n!=null&&n.removeInputId&&(l.value&&n.removeInputId(l.value),!(o!=null&&o.value)&&!_&&c&&n.addInputId(c)),l.value=c)},{immediate:true})}),cw(()=>{f&&f(),n!=null&&n.removeInputId&&l.value&&n.removeInputId(l.value)}),{isLabeledByFormItem:m,inputId:l}},lR=s=>{const n=sr();return _e(()=>{var i,o;return(o=(i=n==null?void 0:n.proxy)==null?void 0:i.$props)==null?void 0:o[s]})},cR=(s,n={})=>{const i=me(void 0),o=n.prop?i:lR("size"),l=n.global?i:MA(),f=n.form?{size:void 0}:Vs(Qf,void 0),m=n.formItem?{size:void 0}:Vs(oR,void 0);return _e(()=>o.value||ue(s)||(m==null?void 0:m.size)||(f==null?void 0:f.size)||l.value||"")},em=s=>{const n=lR("disabled"),i=Vs(Qf,void 0);return _e(()=>n.value||ue(s)||(i==null?void 0:i.disabled)||false)},RL='a[href],button:not([disabled]),button:not([hidden]),:not([tabindex="-1"]),input:not([disabled]),input:not([type="hidden"]),select:not([disabled]),textarea:not([disabled])',IL=s=>getComputedStyle(s).position==="fixed"?false:s.offsetParent!==null,ST=s=>Array.from(s.querySelectorAll(RL)).filter(n=>tm(n)&&IL(n)),tm=s=>{if(s.tabIndex>0||s.tabIndex===0&&s.getAttribute("tabIndex")!==null)return true;if(s.tabIndex<0||s.hasAttribute("disabled")||s.getAttribute("aria-disabled")==="true")return false;switch(s.nodeName){case"A":return!!s.href&&s.rel!=="ignore";case"INPUT":return!(s.type==="hidden"||s.type==="file");case"BUTTON":case"SELECT":case"TEXTAREA":return true;default:return false}};function CL(s,{disabled:n,beforeFocus:i,afterFocus:o,beforeBlur:l,afterBlur:f}={}){const m=sr(),{emit:u}=m,_=xl(),c=me(false),h=$=>{const S=ha(i)?i($):false;ue(n)||c.value||S||(c.value=true,u("focus",$),o==null||o())},p=$=>{var S;const y=ha(l)?l($):false;ue(n)||$.relatedTarget&&((S=_.value)!=null&&S.contains($.relatedTarget))||y||(c.value=false,u("blur",$),f==null||f())},T=$=>{var S,y;ue(n)||tm($.target)||(S=_.value)!=null&&S.contains(document.activeElement)&&_.value!==document.activeElement||(y=s.value)==null||y.focus()};return kt([_,()=>ue(n)],([$,S])=>{$&&(S?$.removeAttribute("tabindex"):$.setAttribute("tabindex","-1"))}),J_(_,"focus",h,true),J_(_,"blur",p,true),J_(_,"click",T,true),{isFocused:c,wrapperRef:_,handleFocus:h,handleBlur:p}}const OL=s=>/([\uAC00-\uD7AF\u3130-\u318F])+/gi.test(s);function wL({afterComposition:s,emit:n}){const i=me(false),o=u=>{n==null||n("compositionstart",u),i.value=true},l=u=>{var _;n==null||n("compositionupdate",u);const c=(_=u.target)==null?void 0:_.value,h=c[c.length-1]||"";i.value=!OL(h)},f=u=>{n==null||n("compositionend",u),i.value&&(i.value=false,rs(()=>s(u)))};return{isComposing:i,handleComposition:u=>{u.type==="compositionend"?f(u):l(u)},handleCompositionStart:o,handleCompositionUpdate:l,handleCompositionEnd:f}}function kL(s){let n;function i(){if(s.value==null)return;const{selectionStart:l,selectionEnd:f,value:m}=s.value;if(l==null||f==null)return;const u=m.slice(0,Math.max(0,l)),_=m.slice(Math.max(0,f));n={selectionStart:l,selectionEnd:f,value:m,beforeTxt:u,afterTxt:_}}function o(){if(s.value==null||n==null)return;const{value:l}=s.value,{beforeTxt:f,afterTxt:m,selectionStart:u}=n;if(f==null||m==null||u==null)return;let _=l.length;if(l.endsWith(m))_=l.length-m.length;else if(l.startsWith(f))_=f.length;else{const c=f[u-1],h=l.indexOf(c,u-1);h!==-1&&(_=h+1)}s.value.setSelectionRange(_,_)}return[i,o]}const AL="ElInput",LL=Ke({name:AL,inheritAttrs:false}),NL=Ke({...LL,props:mL,emits:EL,setup(s,{expose:n,emit:i}){const o=s,l=uw(),f=TL(),m=Cy(),u=_e(()=>[o.type==="textarea"?y.b():S.b(),S.m(T.value),S.is("disabled",$.value),S.is("exceed",H.value),{[S.b("group")]:m.prepend||m.append,[S.m("prefix")]:m.prefix||o.prefixIcon,[S.m("suffix")]:m.suffix||o.suffixIcon||o.clearable||o.showPassword,[S.bm("suffix","password-clear")]:M.value&&U.value,[S.b("hidden")]:o.type==="hidden"},l.class]),_=_e(()=>[S.e("wrapper"),S.is("focus",I.value)]),{form:c,formItem:h}=aR(),{inputId:p}=yL(o,{formItemContext:h}),T=cR(),$=em(),S=nr("input"),y=nr("textarea"),g=xl(),E=xl(),v=me(false),b=me(false),R=me(),O=xl(o.inputStyle),w=_e(()=>g.value||E.value),{wrapperRef:L,isFocused:I,handleFocus:k,handleBlur:x}=CL(w,{disabled:$,afterBlur(){var be;o.validateEvent&&((be=h==null?void 0:h.validate)==null||be.call(h,"blur").catch(qe=>void 0))}}),P=_e(()=>{var be;return(be=c==null?void 0:c.statusIcon)!=null?be:false}),F=_e(()=>(h==null?void 0:h.validateState)||""),X=_e(()=>F.value&&cL[F.value]),W=_e(()=>b.value?oL:tL),z=_e(()=>[l.style]),j=_e(()=>[o.inputStyle,O.value,{resize:o.resize}]),J=_e(()=>zy(o.modelValue)?"":String(o.modelValue)),M=_e(()=>o.clearable&&!$.value&&!o.readonly&&!!J.value&&(I.value||v.value)),U=_e(()=>o.showPassword&&!$.value&&!!J.value),V=_e(()=>o.showWordLimit&&!!o.maxlength&&(o.type==="text"||o.type==="textarea")&&!$.value&&!o.readonly&&!o.showPassword),K=_e(()=>J.value.length),H=_e(()=>!!V.value&&K.value>Number(o.maxlength)),ie=_e(()=>!!m.suffix||!!o.suffixIcon||M.value||o.showPassword||V.value||!!F.value&&P.value),[Ie,he]=kL(g);bw(E,be=>{if(te(),!V.value||o.resize!=="both")return;const qe=be[0],{width:ut}=qe.contentRect;R.value={right:`calc(100% - ${ut+15+6}px)`}});const st=()=>{const{type:be,autosize:qe}=o;if(!(!ir||be!=="textarea"||!E.value))if(qe){const ut=da(qe)?qe.minRows:void 0,jt=da(qe)?qe.maxRows:void 0,Ee=bT(E.value,ut,jt);O.value={overflowY:"hidden",...Ee},rs(()=>{E.value.offsetHeight,O.value=Ee})}else O.value={minHeight:bT(E.value).minHeight}},te=(be=>{let qe=false;return()=>{var ut;if(qe||!o.autosize)return;((ut=E.value)==null?void 0:ut.offsetParent)===null||(be(),qe=true)}})(st),le=()=>{const be=w.value,qe=o.formatter?o.formatter(J.value):J.value;!be||be.value===qe||(be.value=qe)},ae=async be=>{Ie();let{value:qe}=be.target;if(o.formatter&&o.parser&&(qe=o.parser(qe)),!Se.value){if(qe===J.value){le();return}i(_f,qe),i(mT,qe),await rs(),le(),he()}},Me=be=>{let{value:qe}=be.target;o.formatter&&o.parser&&(qe=o.parser(qe)),i(fT,qe)},{isComposing:Se,handleCompositionStart:nt,handleCompositionUpdate:St,handleCompositionEnd:Ut}=wL({emit:i,afterComposition:ae}),Jt=()=>{Ie(),b.value=!b.value,setTimeout(he)},We=()=>{var be;return(be=w.value)==null?void 0:be.focus()},Is=()=>{var be;return(be=w.value)==null?void 0:be.blur()},Cs=be=>{v.value=false,i("mouseleave",be)},Os=be=>{v.value=true,i("mouseenter",be)},xs=be=>{i("keydown",be)},Ws=()=>{var be;(be=w.value)==null||be.select()},At=()=>{i(_f,""),i(fT,""),i("clear"),i(mT,"")};return kt(()=>o.modelValue,()=>{var be;rs(()=>st()),o.validateEvent&&((be=h==null?void 0:h.validate)==null||be.call(h,"change").catch(qe=>void 0))}),kt(J,()=>le()),kt(()=>o.type,async()=>{await rs(),le(),st()}),Rs(()=>{!o.formatter&&o.parser,le(),rs(st)}),n({input:g,textarea:E,ref:w,textareaStyle:j,autosize:hn(o,"autosize"),isComposing:Se,focus:We,blur:Is,select:Ws,clear:At,resizeTextarea:st}),(be,qe)=>(ne(),ve("div",{class:tt([ue(u),{[ue(S).bm("group","append")]:be.$slots.append,[ue(S).bm("group","prepend")]:be.$slots.prepend}]),style:Hs(ue(z)),onMouseenter:Os,onMouseleave:Cs},[Ze(" input "),be.type!=="textarea"?(ne(),ve(Pt,{key:0},[Ze(" prepend slot "),be.$slots.prepend?(ne(),ve("div",{key:0,class:tt(ue(S).be("group","prepend"))},[Dt(be.$slots,"prepend")],2)):Ze("v-if",true),de("div",{ref_key:"wrapperRef",ref:L,class:tt(ue(_))},[Ze(" prefix slot "),be.$slots.prefix||be.prefixIcon?(ne(),ve("span",{key:0,class:tt(ue(S).e("prefix"))},[de("span",{class:tt(ue(S).e("prefix-inner"))},[Dt(be.$slots,"prefix"),be.prefixIcon?(ne(),Ye(ue(Sr),{key:0,class:tt(ue(S).e("icon"))},{default:je(()=>[(ne(),Ye(qs(be.prefixIcon)))]),_:1},8,["class"])):Ze("v-if",true)],2)],2)):Ze("v-if",true),de("input",Hl({id:ue(p),ref_key:"input",ref:g,class:ue(S).e("inner")},ue(f),{name:be.name,minlength:be.minlength,maxlength:be.maxlength,type:be.showPassword?b.value?"text":"password":be.type,disabled:ue($),readonly:be.readonly,autocomplete:be.autocomplete,tabindex:be.tabindex,"aria-label":be.ariaLabel,placeholder:be.placeholder,style:be.inputStyle,form:be.form,autofocus:be.autofocus,role:be.containerRole,inputmode:be.inputmode,onCompositionstart:ue(nt),onCompositionupdate:ue(St),onCompositionend:ue(Ut),onInput:ae,onChange:Me,onKeydown:xs}),null,16,["id","name","minlength","maxlength","type","disabled","readonly","autocomplete","tabindex","aria-label","placeholder","form","autofocus","role","inputmode","onCompositionstart","onCompositionupdate","onCompositionend"]),Ze(" suffix slot "),ue(ie)?(ne(),ve("span",{key:1,class:tt(ue(S).e("suffix"))},[de("span",{class:tt(ue(S).e("suffix-inner"))},[!ue(M)||!ue(U)||!ue(V)?(ne(),ve(Pt,{key:0},[Dt(be.$slots,"suffix"),be.suffixIcon?(ne(),Ye(ue(Sr),{key:0,class:tt(ue(S).e("icon"))},{default:je(()=>[(ne(),Ye(qs(be.suffixIcon)))]),_:1},8,["class"])):Ze("v-if",true)],64)):Ze("v-if",true),ue(M)?(ne(),Ye(ue(Sr),{key:1,class:tt([ue(S).e("icon"),ue(S).e("clear")]),onMousedown:gs(ue(Bl),["prevent"]),onClick:At},{default:je(()=>[De(ue(iR))]),_:1},8,["class","onMousedown"])):Ze("v-if",true),ue(U)?(ne(),Ye(ue(Sr),{key:2,class:tt([ue(S).e("icon"),ue(S).e("password")]),onClick:Jt},{default:je(()=>[(ne(),Ye(qs(ue(W))))]),_:1},8,["class"])):Ze("v-if",true),ue(V)?(ne(),ve("span",{key:3,class:tt(ue(S).e("count"))},[de("span",{class:tt(ue(S).e("count-inner"))},Bt(ue(K))+" / "+Bt(be.maxlength),3)],2)):Ze("v-if",true),ue(F)&&ue(X)&&ue(P)?(ne(),Ye(ue(Sr),{key:4,class:tt([ue(S).e("icon"),ue(S).e("validateIcon"),ue(S).is("loading",ue(F)==="validating")])},{default:je(()=>[(ne(),Ye(qs(ue(X))))]),_:1},8,["class"])):Ze("v-if",true)],2)],2)):Ze("v-if",true)],2),Ze(" append slot "),be.$slots.append?(ne(),ve("div",{key:1,class:tt(ue(S).be("group","append"))},[Dt(be.$slots,"append")],2)):Ze("v-if",true)],64)):(ne(),ve(Pt,{key:1},[Ze(" textarea "),de("textarea",Hl({id:ue(p),ref_key:"textarea",ref:E,class:[ue(y).e("inner"),ue(S).is("focus",ue(I))]},ue(f),{minlength:be.minlength,maxlength:be.maxlength,tabindex:be.tabindex,disabled:ue($),readonly:be.readonly,autocomplete:be.autocomplete,style:ue(j),"aria-label":be.ariaLabel,placeholder:be.placeholder,form:be.form,autofocus:be.autofocus,rows:be.rows,role:be.containerRole,onCompositionstart:ue(nt),onCompositionupdate:ue(St),onCompositionend:ue(Ut),onInput:ae,onFocus:ue(k),onBlur:ue(x),onChange:Me,onKeydown:xs}),null,16,["id","minlength","maxlength","tabindex","disabled","readonly","autocomplete","aria-label","placeholder","form","autofocus","rows","role","onCompositionstart","onCompositionupdate","onCompositionend","onFocus","onBlur"]),ue(V)?(ne(),ve("span",{key:0,style:Hs(R.value),class:tt(ue(S).e("count"))},Bt(ue(K))+" / "+Bt(be.maxlength),7)):Ze("v-if",true)],64))],38))}});var ML=ya(NL,[["__file","input.vue"]]);const uR=Zf(ML),Q_="focus-trap.focus-after-trapped",ep="focus-trap.focus-after-released",DL="focus-trap.focusout-prevented",$T={cancelable:true,bubbles:false},xL={cancelable:true,bubbles:false},yT="focusAfterTrapped",RT="focusAfterReleased",BL=Symbol("elFocusTrap"),sm=me(),ch=me(0),im=me(0);let Ru=0;const hR=s=>{const n=[],i=document.createTreeWalker(s,NodeFilter.SHOW_ELEMENT,{acceptNode:o=>{const l=o.tagName==="INPUT"&&o.type==="hidden";return o.disabled||o.hidden||l?NodeFilter.FILTER_SKIP:o.tabIndex>=0||o===document.activeElement?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;i.nextNode();)n.push(i.currentNode);return n},IT=(s,n)=>{for(const i of s)if(!PL(i,n))return i},PL=(s,n)=>{if(getComputedStyle(s).visibility==="hidden")return true;for(;s;){if(n&&s===n)return false;if(getComputedStyle(s).display==="none")return true;s=s.parentElement}return false},UL=s=>{const n=hR(s),i=IT(n,s),o=IT(n.reverse(),s);return[i,o]},FL=s=>s instanceof HTMLInputElement&&"select"in s,br=(s,n)=>{if(s&&s.focus){const i=document.activeElement;let o=false;Yu(s)&&!tm(s)&&!s.getAttribute("tabindex")&&(s.setAttribute("tabindex","-1"),o=true),s.focus({preventScroll:true}),im.value=window.performance.now(),s!==i&&FL(s)&&n&&s.select(),Yu(s)&&o&&s.removeAttribute("tabindex")}};function CT(s,n){const i=[...s],o=s.indexOf(n);return o!==-1&&i.splice(o,1),i}const GL=()=>{let s=[];return{push:o=>{const l=s[0];l&&o!==l&&l.pause(),s=CT(s,o),s.unshift(o)},remove:o=>{var l,f;s=CT(s,o),(f=(l=s[0])==null?void 0:l.resume)==null||f.call(l)}}},HL=(s,n=false)=>{const i=document.activeElement;for(const o of s)if(br(o,n),document.activeElement!==i)return},OT=GL(),VL=()=>ch.value>im.value,Iu=()=>{sm.value="pointer",ch.value=window.performance.now()},wT=()=>{sm.value="keyboard",ch.value=window.performance.now()},WL=()=>(Rs(()=>{Ru===0&&(document.addEventListener("mousedown",Iu),document.addEventListener("touchstart",Iu),document.addEventListener("keydown",wT)),Ru++}),Nr(()=>{Ru--,Ru<=0&&(document.removeEventListener("mousedown",Iu),document.removeEventListener("touchstart",Iu),document.removeEventListener("keydown",wT))}),{focusReason:sm,lastUserFocusTimestamp:ch,lastAutomatedFocusTimestamp:im}),Cu=s=>new CustomEvent(DL,{...xL,detail:s}),nm={tab:"Tab",esc:"Escape"};let ca=[];const kT=s=>{s.code===nm.esc&&ca.forEach(n=>n(s))},zL=s=>{Rs(()=>{ca.length===0&&document.addEventListener("keydown",kT),ir&&ca.push(s)}),Nr(()=>{ca=ca.filter(n=>n!==s),ca.length===0&&ir&&document.removeEventListener("keydown",kT)})},jL=Ke({name:"ElFocusTrap",inheritAttrs:false,props:{loop:Boolean,trapped:Boolean,focusTrapEl:Object,focusStartEl:{type:[Object,String],default:"first"}},emits:[yT,RT,"focusin","focusout","focusout-prevented","release-requested"],setup(s,{emit:n}){const i=me();let o,l;const{focusReason:f}=WL();zL(S=>{s.trapped&&!m.paused&&n("release-requested",S)});const m={paused:false,pause(){this.paused=true},resume(){this.paused=false}},u=S=>{if(!s.loop&&!s.trapped||m.paused)return;const{code:y,altKey:g,ctrlKey:E,metaKey:v,currentTarget:b,shiftKey:R}=S,{loop:O}=s,w=y===nm.tab&&!g&&!E&&!v,L=document.activeElement;if(w&&L){const I=b,[k,x]=UL(I);if(k&&x){if(!R&&L===x){const F=Cu({focusReason:f.value});n("focusout-prevented",F),F.defaultPrevented||(S.preventDefault(),O&&br(k,true))}else if(R&&[k,I].includes(L)){const F=Cu({focusReason:f.value});n("focusout-prevented",F),F.defaultPrevented||(S.preventDefault(),O&&br(x,true))}}else if(L===I){const F=Cu({focusReason:f.value});n("focusout-prevented",F),F.defaultPrevented||S.preventDefault()}}};oc(BL,{focusTrapRef:i,onKeydown:u}),kt(()=>s.focusTrapEl,S=>{S&&(i.value=S)},{immediate:true}),kt([i],([S],[y])=>{S&&(S.addEventListener("keydown",u),S.addEventListener("focusin",h),S.addEventListener("focusout",p)),y&&(y.removeEventListener("keydown",u),y.removeEventListener("focusin",h),y.removeEventListener("focusout",p))});const _=S=>{n(yT,S)},c=S=>n(RT,S),h=S=>{const y=ue(i);if(!y)return;const g=S.target,E=S.relatedTarget,v=g&&y.contains(g);s.trapped||E&&y.contains(E)||(o=E),v&&n("focusin",S),!m.paused&&s.trapped&&(v?l=g:br(l,true))},p=S=>{const y=ue(i);if(!(m.paused||!y))if(s.trapped){const g=S.relatedTarget;!zy(g)&&!y.contains(g)&&setTimeout(()=>{if(!m.paused&&s.trapped){const E=Cu({focusReason:f.value});n("focusout-prevented",E),E.defaultPrevented||br(l,true)}},0)}else{const g=S.target;g&&y.contains(g)||n("focusout",S)}};async function T(){await rs();const S=ue(i);if(S){OT.push(m);const y=S.contains(document.activeElement)?o:document.activeElement;if(o=y,!S.contains(y)){const E=new Event(Q_,$T);S.addEventListener(Q_,_),S.dispatchEvent(E),E.defaultPrevented||rs(()=>{let v=s.focusStartEl;er(v)||(br(v),document.activeElement!==v&&(v="first")),v==="first"&&HL(hR(S),true),(document.activeElement===y||v==="container")&&br(S)})}}}function $(){const S=ue(i);if(S){S.removeEventListener(Q_,_);const y=new CustomEvent(ep,{...$T,detail:{focusReason:f.value}});S.addEventListener(ep,c),S.dispatchEvent(y),!y.defaultPrevented&&(f.value=="keyboard"||!VL()||S.contains(document.activeElement))&&br(o??document.body),S.removeEventListener(ep,c),OT.remove(m)}}return Rs(()=>{s.trapped&&T(),kt(()=>s.trapped,S=>{S?T():$()})}),Nr(()=>{s.trapped&&$(),i.value&&(i.value.removeEventListener("keydown",u),i.value.removeEventListener("focusin",h),i.value.removeEventListener("focusout",p),i.value=void 0)}),{onKeydown:u}}});function XL(s,n,i,o,l,f){return Dt(s.$slots,"default",{handleKeydown:s.onKeydown})}var KL=ya(jL,[["render",XL],["__file","focus-trap.vue"]]);const dR=Symbol("buttonGroupContextKey"),YL=({from:s,replacement:n,scope:i,version:o,ref:l,type:f="API"},m)=>{kt(()=>ue(m),u=>{},{immediate:true})},qL=(s,n)=>{YL({from:"type.text",replacement:"link",version:"3.0.0",scope:"props",ref:"https://element-plus.org/en-US/component/button.html#button-attributes"},_e(()=>s.type==="text"));const i=Vs(dR,void 0),o=Jf("button"),{form:l}=aR(),f=cR(_e(()=>i==null?void 0:i.size)),m=em(),u=me(),_=Cy(),c=_e(()=>{var g;return s.type||(i==null?void 0:i.type)||((g=o.value)==null?void 0:g.type)||""}),h=_e(()=>{var g,E,v;return(v=(E=s.autoInsertSpace)!=null?E:(g=o.value)==null?void 0:g.autoInsertSpace)!=null?v:false}),p=_e(()=>{var g,E,v;return(v=(E=s.plain)!=null?E:(g=o.value)==null?void 0:g.plain)!=null?v:false}),T=_e(()=>{var g,E,v;return(v=(E=s.round)!=null?E:(g=o.value)==null?void 0:g.round)!=null?v:false}),$=_e(()=>s.tag==="button"?{ariaDisabled:m.value||s.loading,disabled:m.value||s.loading,autofocus:s.autofocus,type:s.nativeType}:{}),S=_e(()=>{var g;const E=(g=_.default)==null?void 0:g.call(_);if(h.value&&(E==null?void 0:E.length)===1){const v=E[0];if((v==null?void 0:v.type)===hw){const b=v.children;return new RegExp("^\\p{Unified_Ideograph}{2}$","u").test(b.trim())}}return false});return{_disabled:m,_size:f,_type:c,_ref:u,_props:$,_plain:p,_round:T,shouldAddSpace:S,handleClick:g=>{if(m.value||s.loading){g.stopPropagation();return}s.nativeType==="reset"&&(l==null||l.resetFields()),n("click",g)}}},JL=["default","primary","success","warning","info","danger","text",""],ZL=["button","submit","reset"],mf=$a({size:Qy,disabled:Boolean,type:{type:String,values:JL,default:""},icon:{type:Zu},nativeType:{type:String,values:ZL,default:"button"},loading:Boolean,loadingIcon:{type:Zu,default:()=>Ju},plain:{type:Boolean,default:void 0},text:Boolean,link:Boolean,bg:Boolean,autofocus:Boolean,round:{type:Boolean,default:void 0},circle:Boolean,color:String,dark:Boolean,autoInsertSpace:{type:Boolean,default:void 0},tag:{type:Zn([String,Object]),default:"button"}}),QL={click:s=>s instanceof MouseEvent};function Ds(s,n){eN(s)&&(s="100%");var i=tN(s);return s=n===360?s:Math.min(n,Math.max(0,parseFloat(s))),i&&(s=parseInt(String(s*n),10)/100),Math.abs(s-n)<1e-6?1:(n===360?s=(s<0?s%n+n:s%n)/parseFloat(String(n)):s=s%n/parseFloat(String(n)),s)}function Ou(s){return Math.min(1,Math.max(0,s))}function eN(s){return typeof s=="string"&&s.indexOf(".")!==-1&&parseFloat(s)===1}function tN(s){return typeof s=="string"&&s.indexOf("%")!==-1}function _R(s){return s=parseFloat(s),(isNaN(s)||s<0||s>1)&&(s=1),s}function wu(s){return s<=1?"".concat(Number(s)*100,"%"):s}function co(s){return s.length===1?"0"+s:String(s)}function sN(s,n,i){return{r:Ds(s,255)*255,g:Ds(n,255)*255,b:Ds(i,255)*255}}function AT(s,n,i){s=Ds(s,255),n=Ds(n,255),i=Ds(i,255);var o=Math.max(s,n,i),l=Math.min(s,n,i),f=0,m=0,u=(o+l)/2;if(o===l)m=0,f=0;else{var _=o-l;switch(m=u>.5?_/(2-o-l):_/(o+l),o){case s:f=(n-i)/_+(n<i?6:0);break;case n:f=(i-s)/_+2;break;case i:f=(s-n)/_+4;break}f/=6}return{h:f,s:m,l:u}}function tp(s,n,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?s+(n-s)*(6*i):i<1/2?n:i<2/3?s+(n-s)*(2/3-i)*6:s}function iN(s,n,i){var o,l,f;if(s=Ds(s,360),n=Ds(n,100),i=Ds(i,100),n===0)l=i,f=i,o=i;else{var m=i<.5?i*(1+n):i+n-i*n,u=2*i-m;o=tp(u,m,s+1/3),l=tp(u,m,s),f=tp(u,m,s-1/3)}return{r:o*255,g:l*255,b:f*255}}function LT(s,n,i){s=Ds(s,255),n=Ds(n,255),i=Ds(i,255);var o=Math.max(s,n,i),l=Math.min(s,n,i),f=0,m=o,u=o-l,_=o===0?0:u/o;if(o===l)f=0;else{switch(o){case s:f=(n-i)/u+(n<i?6:0);break;case n:f=(i-s)/u+2;break;case i:f=(s-n)/u+4;break}f/=6}return{h:f,s:_,v:m}}function nN(s,n,i){s=Ds(s,360)*6,n=Ds(n,100),i=Ds(i,100);var o=Math.floor(s),l=s-o,f=i*(1-n),m=i*(1-l*n),u=i*(1-(1-l)*n),_=o%6,c=[i,m,f,f,u,i][_],h=[u,i,i,m,f,f][_],p=[f,f,u,i,i,m][_];return{r:c*255,g:h*255,b:p*255}}function NT(s,n,i,o){var l=[co(Math.round(s).toString(16)),co(Math.round(n).toString(16)),co(Math.round(i).toString(16))];return o&&l[0].startsWith(l[0].charAt(1))&&l[1].startsWith(l[1].charAt(1))&&l[2].startsWith(l[2].charAt(1))?l[0].charAt(0)+l[1].charAt(0)+l[2].charAt(0):l.join("")}function rN(s,n,i,o,l){var f=[co(Math.round(s).toString(16)),co(Math.round(n).toString(16)),co(Math.round(i).toString(16)),co(oN(o))];return l&&f[0].startsWith(f[0].charAt(1))&&f[1].startsWith(f[1].charAt(1))&&f[2].startsWith(f[2].charAt(1))&&f[3].startsWith(f[3].charAt(1))?f[0].charAt(0)+f[1].charAt(0)+f[2].charAt(0)+f[3].charAt(0):f.join("")}function oN(s){return Math.round(parseFloat(s)*255).toString(16)}function MT(s){return wi(s)/255}function wi(s){return parseInt(s,16)}function aN(s){return{r:s>>16,g:(s&65280)>>8,b:s&255}}var Ef={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",goldenrod:"#daa520",gold:"#ffd700",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavenderblush:"#fff0f5",lavender:"#e6e6fa",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};function lN(s){var n={r:0,g:0,b:0},i=1,o=null,l=null,f=null,m=false,u=false;return typeof s=="string"&&(s=hN(s)),typeof s=="object"&&(Kn(s.r)&&Kn(s.g)&&Kn(s.b)?(n=sN(s.r,s.g,s.b),m=true,u=String(s.r).substr(-1)==="%"?"prgb":"rgb"):Kn(s.h)&&Kn(s.s)&&Kn(s.v)?(o=wu(s.s),l=wu(s.v),n=nN(s.h,o,l),m=true,u="hsv"):Kn(s.h)&&Kn(s.s)&&Kn(s.l)&&(o=wu(s.s),f=wu(s.l),n=iN(s.h,o,f),m=true,u="hsl"),Object.prototype.hasOwnProperty.call(s,"a")&&(i=s.a)),i=_R(i),{ok:m,format:s.format||u,r:Math.min(255,Math.max(n.r,0)),g:Math.min(255,Math.max(n.g,0)),b:Math.min(255,Math.max(n.b,0)),a:i}}var cN="[-\\+]?\\d+%?",uN="[-\\+]?\\d*\\.\\d+%?",yr="(?:".concat(uN,")|(?:").concat(cN,")"),sp="[\\s|\\(]+(".concat(yr,")[,|\\s]+(").concat(yr,")[,|\\s]+(").concat(yr,")\\s*\\)?"),ip="[\\s|\\(]+(".concat(yr,")[,|\\s]+(").concat(yr,")[,|\\s]+(").concat(yr,")[,|\\s]+(").concat(yr,")\\s*\\)?"),un={CSS_UNIT:new RegExp(yr),rgb:new RegExp("rgb"+sp),rgba:new RegExp("rgba"+ip),hsl:new RegExp("hsl"+sp),hsla:new RegExp("hsla"+ip),hsv:new RegExp("hsv"+sp),hsva:new RegExp("hsva"+ip),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/};function hN(s){if(s=s.trim().toLowerCase(),s.length===0)return false;var n=false;if(Ef[s])s=Ef[s],n=true;else if(s==="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var i=un.rgb.exec(s);return i?{r:i[1],g:i[2],b:i[3]}:(i=un.rgba.exec(s),i?{r:i[1],g:i[2],b:i[3],a:i[4]}:(i=un.hsl.exec(s),i?{h:i[1],s:i[2],l:i[3]}:(i=un.hsla.exec(s),i?{h:i[1],s:i[2],l:i[3],a:i[4]}:(i=un.hsv.exec(s),i?{h:i[1],s:i[2],v:i[3]}:(i=un.hsva.exec(s),i?{h:i[1],s:i[2],v:i[3],a:i[4]}:(i=un.hex8.exec(s),i?{r:wi(i[1]),g:wi(i[2]),b:wi(i[3]),a:MT(i[4]),format:n?"name":"hex8"}:(i=un.hex6.exec(s),i?{r:wi(i[1]),g:wi(i[2]),b:wi(i[3]),format:n?"name":"hex"}:(i=un.hex4.exec(s),i?{r:wi(i[1]+i[1]),g:wi(i[2]+i[2]),b:wi(i[3]+i[3]),a:MT(i[4]+i[4]),format:n?"name":"hex8"}:(i=un.hex3.exec(s),i?{r:wi(i[1]+i[1]),g:wi(i[2]+i[2]),b:wi(i[3]+i[3]),format:n?"name":"hex"}:false)))))))))}function Kn(s){return!!un.CSS_UNIT.exec(String(s))}var dN=function(){function s(n,i){n===void 0&&(n=""),i===void 0&&(i={});var o;if(n instanceof s)return n;typeof n=="number"&&(n=aN(n)),this.originalInput=n;var l=lN(n);this.originalInput=n,this.r=l.r,this.g=l.g,this.b=l.b,this.a=l.a,this.roundA=Math.round(100*this.a)/100,this.format=(o=i.format)!==null&&o!==void 0?o:l.format,this.gradientType=i.gradientType,this.r<1&&(this.r=Math.round(this.r)),this.g<1&&(this.g=Math.round(this.g)),this.b<1&&(this.b=Math.round(this.b)),this.isValid=l.ok}return s.prototype.isDark=function(){return this.getBrightness()<128},s.prototype.isLight=function(){return!this.isDark()},s.prototype.getBrightness=function(){var n=this.toRgb();return(n.r*299+n.g*587+n.b*114)/1e3},s.prototype.getLuminance=function(){var n=this.toRgb(),i,o,l,f=n.r/255,m=n.g/255,u=n.b/255;return f<=.03928?i=f/12.92:i=Math.pow((f+.055)/1.055,2.4),m<=.03928?o=m/12.92:o=Math.pow((m+.055)/1.055,2.4),u<=.03928?l=u/12.92:l=Math.pow((u+.055)/1.055,2.4),.2126*i+.7152*o+.0722*l},s.prototype.getAlpha=function(){return this.a},s.prototype.setAlpha=function(n){return this.a=_R(n),this.roundA=Math.round(100*this.a)/100,this},s.prototype.isMonochrome=function(){var n=this.toHsl().s;return n===0},s.prototype.toHsv=function(){var n=LT(this.r,this.g,this.b);return{h:n.h*360,s:n.s,v:n.v,a:this.a}},s.prototype.toHsvString=function(){var n=LT(this.r,this.g,this.b),i=Math.round(n.h*360),o=Math.round(n.s*100),l=Math.round(n.v*100);return this.a===1?"hsv(".concat(i,", ").concat(o,"%, ").concat(l,"%)"):"hsva(".concat(i,", ").concat(o,"%, ").concat(l,"%, ").concat(this.roundA,")")},s.prototype.toHsl=function(){var n=AT(this.r,this.g,this.b);return{h:n.h*360,s:n.s,l:n.l,a:this.a}},s.prototype.toHslString=function(){var n=AT(this.r,this.g,this.b),i=Math.round(n.h*360),o=Math.round(n.s*100),l=Math.round(n.l*100);return this.a===1?"hsl(".concat(i,", ").concat(o,"%, ").concat(l,"%)"):"hsla(".concat(i,", ").concat(o,"%, ").concat(l,"%, ").concat(this.roundA,")")},s.prototype.toHex=function(n){return n===void 0&&(n=false),NT(this.r,this.g,this.b,n)},s.prototype.toHexString=function(n){return n===void 0&&(n=false),"#"+this.toHex(n)},s.prototype.toHex8=function(n){return n===void 0&&(n=false),rN(this.r,this.g,this.b,this.a,n)},s.prototype.toHex8String=function(n){return n===void 0&&(n=false),"#"+this.toHex8(n)},s.prototype.toHexShortString=function(n){return n===void 0&&(n=false),this.a===1?this.toHexString(n):this.toHex8String(n)},s.prototype.toRgb=function(){return{r:Math.round(this.r),g:Math.round(this.g),b:Math.round(this.b),a:this.a}},s.prototype.toRgbString=function(){var n=Math.round(this.r),i=Math.round(this.g),o=Math.round(this.b);return this.a===1?"rgb(".concat(n,", ").concat(i,", ").concat(o,")"):"rgba(".concat(n,", ").concat(i,", ").concat(o,", ").concat(this.roundA,")")},s.prototype.toPercentageRgb=function(){var n=function(i){return"".concat(Math.round(Ds(i,255)*100),"%")};return{r:n(this.r),g:n(this.g),b:n(this.b),a:this.a}},s.prototype.toPercentageRgbString=function(){var n=function(i){return Math.round(Ds(i,255)*100)};return this.a===1?"rgb(".concat(n(this.r),"%, ").concat(n(this.g),"%, ").concat(n(this.b),"%)"):"rgba(".concat(n(this.r),"%, ").concat(n(this.g),"%, ").concat(n(this.b),"%, ").concat(this.roundA,")")},s.prototype.toName=function(){if(this.a===0)return"transparent";if(this.a<1)return false;for(var n="#"+NT(this.r,this.g,this.b,false),i=0,o=Object.entries(Ef);i<o.length;i++){var l=o[i],f=l[0],m=l[1];if(n===m)return f}return false},s.prototype.toString=function(n){var i=!!n;n=n??this.format;var o=false,l=this.a<1&&this.a>=0,f=!i&&l&&(n.startsWith("hex")||n==="name");return f?n==="name"&&this.a===0?this.toName():this.toRgbString():(n==="rgb"&&(o=this.toRgbString()),n==="prgb"&&(o=this.toPercentageRgbString()),(n==="hex"||n==="hex6")&&(o=this.toHexString()),n==="hex3"&&(o=this.toHexString(true)),n==="hex4"&&(o=this.toHex8String(true)),n==="hex8"&&(o=this.toHex8String()),n==="name"&&(o=this.toName()),n==="hsl"&&(o=this.toHslString()),n==="hsv"&&(o=this.toHsvString()),o||this.toHexString())},s.prototype.toNumber=function(){return(Math.round(this.r)<<16)+(Math.round(this.g)<<8)+Math.round(this.b)},s.prototype.clone=function(){return new s(this.toString())},s.prototype.lighten=function(n){n===void 0&&(n=10);var i=this.toHsl();return i.l+=n/100,i.l=Ou(i.l),new s(i)},s.prototype.brighten=function(n){n===void 0&&(n=10);var i=this.toRgb();return i.r=Math.max(0,Math.min(255,i.r-Math.round(255*-(n/100)))),i.g=Math.max(0,Math.min(255,i.g-Math.round(255*-(n/100)))),i.b=Math.max(0,Math.min(255,i.b-Math.round(255*-(n/100)))),new s(i)},s.prototype.darken=function(n){n===void 0&&(n=10);var i=this.toHsl();return i.l-=n/100,i.l=Ou(i.l),new s(i)},s.prototype.tint=function(n){return n===void 0&&(n=10),this.mix("white",n)},s.prototype.shade=function(n){return n===void 0&&(n=10),this.mix("black",n)},s.prototype.desaturate=function(n){n===void 0&&(n=10);var i=this.toHsl();return i.s-=n/100,i.s=Ou(i.s),new s(i)},s.prototype.saturate=function(n){n===void 0&&(n=10);var i=this.toHsl();return i.s+=n/100,i.s=Ou(i.s),new s(i)},s.prototype.greyscale=function(){return this.desaturate(100)},s.prototype.spin=function(n){var i=this.toHsl(),o=(i.h+n)%360;return i.h=o<0?360+o:o,new s(i)},s.prototype.mix=function(n,i){i===void 0&&(i=50);var o=this.toRgb(),l=new s(n).toRgb(),f=i/100,m={r:(l.r-o.r)*f+o.r,g:(l.g-o.g)*f+o.g,b:(l.b-o.b)*f+o.b,a:(l.a-o.a)*f+o.a};return new s(m)},s.prototype.analogous=function(n,i){n===void 0&&(n=6),i===void 0&&(i=30);var o=this.toHsl(),l=360/i,f=[this];for(o.h=(o.h-(l*n>>1)+720)%360;--n;)o.h=(o.h+l)%360,f.push(new s(o));return f},s.prototype.complement=function(){var n=this.toHsl();return n.h=(n.h+180)%360,new s(n)},s.prototype.monochromatic=function(n){n===void 0&&(n=6);for(var i=this.toHsv(),o=i.h,l=i.s,f=i.v,m=[],u=1/n;n--;)m.push(new s({h:o,s:l,v:f})),f=(f+u)%1;return m},s.prototype.splitcomplement=function(){var n=this.toHsl(),i=n.h;return[this,new s({h:(i+72)%360,s:n.s,l:n.l}),new s({h:(i+216)%360,s:n.s,l:n.l})]},s.prototype.onBackground=function(n){var i=this.toRgb(),o=new s(n).toRgb(),l=i.a+o.a*(1-i.a);return new s({r:(i.r*i.a+o.r*o.a*(1-i.a))/l,g:(i.g*i.a+o.g*o.a*(1-i.a))/l,b:(i.b*i.a+o.b*o.a*(1-i.a))/l,a:l})},s.prototype.triad=function(){return this.polyad(3)},s.prototype.tetrad=function(){return this.polyad(4)},s.prototype.polyad=function(n){for(var i=this.toHsl(),o=i.h,l=[this],f=360/n,m=1;m<n;m++)l.push(new s({h:(o+m*f)%360,s:i.s,l:i.l}));return l},s.prototype.equals=function(n){return this.toRgbString()===new s(n).toRgbString()},s}();function vr(s,n=20){return s.mix("#141414",n).toString()}function _N(s){const n=em(),i=nr("button");return _e(()=>{let o={},l=s.color;if(l){const f=l.match(/var\((.*?)\)/);f&&(l=window.getComputedStyle(window.document.documentElement).getPropertyValue(f[1]));const m=new dN(l),u=s.dark?m.tint(20).toString():vr(m,20);if(s.plain)o=i.cssVarBlock({"bg-color":s.dark?vr(m,90):m.tint(90).toString(),"text-color":l,"border-color":s.dark?vr(m,50):m.tint(50).toString(),"hover-text-color":`var(${i.cssVarName("color-white")})`,"hover-bg-color":l,"hover-border-color":l,"active-bg-color":u,"active-text-color":`var(${i.cssVarName("color-white")})`,"active-border-color":u}),n.value&&(o[i.cssVarBlockName("disabled-bg-color")]=s.dark?vr(m,90):m.tint(90).toString(),o[i.cssVarBlockName("disabled-text-color")]=s.dark?vr(m,50):m.tint(50).toString(),o[i.cssVarBlockName("disabled-border-color")]=s.dark?vr(m,80):m.tint(80).toString());else{const _=s.dark?vr(m,30):m.tint(30).toString(),c=m.isDark()?`var(${i.cssVarName("color-white")})`:`var(${i.cssVarName("color-black")})`;if(o=i.cssVarBlock({"bg-color":l,"text-color":c,"border-color":l,"hover-bg-color":_,"hover-text-color":c,"hover-border-color":_,"active-bg-color":u,"active-border-color":u}),n.value){const h=s.dark?vr(m,50):m.tint(50).toString();o[i.cssVarBlockName("disabled-bg-color")]=h,o[i.cssVarBlockName("disabled-text-color")]=s.dark?"rgba(255, 255, 255, 0.5)":`var(${i.cssVarName("color-white")})`,o[i.cssVarBlockName("disabled-border-color")]=h}}}return o})}const pN=Ke({name:"ElButton"}),gN=Ke({...pN,props:mf,emits:QL,setup(s,{expose:n,emit:i}){const o=s,l=_N(o),f=nr("button"),{_ref:m,_size:u,_type:_,_disabled:c,_props:h,_plain:p,_round:T,shouldAddSpace:$,handleClick:S}=qL(o,i),y=_e(()=>[f.b(),f.m(_.value),f.m(u.value),f.is("disabled",c.value),f.is("loading",o.loading),f.is("plain",p.value),f.is("round",T.value),f.is("circle",o.circle),f.is("text",o.text),f.is("link",o.link),f.is("has-bg",o.bg)]);return n({ref:m,size:u,type:_,disabled:c,shouldAddSpace:$}),(g,E)=>(ne(),Ye(qs(g.tag),Hl({ref_key:"_ref",ref:m},ue(h),{class:ue(y),style:ue(l),onClick:ue(S)}),{default:je(()=>[g.loading?(ne(),ve(Pt,{key:0},[g.$slots.loading?Dt(g.$slots,"loading",{key:0}):(ne(),Ye(ue(Sr),{key:1,class:tt(ue(f).is("loading"))},{default:je(()=>[(ne(),Ye(qs(g.loadingIcon)))]),_:1},8,["class"]))],64)):g.icon||g.$slots.icon?(ne(),Ye(ue(Sr),{key:1},{default:je(()=>[g.icon?(ne(),Ye(qs(g.icon),{key:0})):Dt(g.$slots,"icon",{key:1})]),_:3})):Ze("v-if",true),g.$slots.default?(ne(),ve("span",{key:2,class:tt({[ue(f).em("text","expand")]:ue($)})},[Dt(g.$slots,"default")],2)):Ze("v-if",true)]),_:3},16,["class","style","onClick"]))}});var fN=ya(gN,[["__file","button.vue"]]);const mN={size:mf.size,type:mf.type},EN=Ke({name:"ElButtonGroup"}),vN=Ke({...EN,props:mN,setup(s){const n=s;oc(dR,zi({size:hn(n,"size"),type:hn(n,"type")}));const i=nr("button");return(o,l)=>(ne(),ve("div",{class:tt(ue(i).b("group"))},[Dt(o.$slots,"default")],2))}});var pR=ya(vN,[["__file","button-group.vue"]]);const bN=Zf(fN,{ButtonGroup:pR});VA(pR);var Ni=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function rm(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var Uu=(s=>(s[s.TEXT=1]="TEXT",s[s.CLASS=2]="CLASS",s[s.STYLE=4]="STYLE",s[s.PROPS=8]="PROPS",s[s.FULL_PROPS=16]="FULL_PROPS",s[s.HYDRATE_EVENTS=32]="HYDRATE_EVENTS",s[s.STABLE_FRAGMENT=64]="STABLE_FRAGMENT",s[s.KEYED_FRAGMENT=128]="KEYED_FRAGMENT",s[s.UNKEYED_FRAGMENT=256]="UNKEYED_FRAGMENT",s[s.NEED_PATCH=512]="NEED_PATCH",s[s.DYNAMIC_SLOTS=1024]="DYNAMIC_SLOTS",s[s.HOISTED=-1]="HOISTED",s[s.BAIL=-2]="BAIL",s))(Uu||{});const gR=s=>{if(!s)return{onClick:Bl,onMousedown:Bl,onMouseup:Bl};let n=false,i=false;return{onClick:m=>{n&&i&&s(m),n=i=false},onMousedown:m=>{n=m.target===m.currentTarget},onMouseup:m=>{i=m.target===m.currentTarget}}},TN=$a({mask:{type:Boolean,default:true},customMaskEvent:Boolean,overlayClass:{type:Zn([String,Array,Object])},zIndex:{type:Zn([String,Number])}}),SN={click:s=>s instanceof MouseEvent},$N="overlay";var yN=Ke({name:"ElOverlay",props:TN,emits:SN,setup(s,{slots:n,emit:i}){const o=nr($N),l=_=>{i("click",_)},{onClick:f,onMousedown:m,onMouseup:u}=gR(s.customMaskEvent?void 0:l);return()=>s.mask?De("div",{class:[o.b(),s.overlayClass],style:{zIndex:s.zIndex},onClick:f,onMousedown:m,onMouseup:u},[Dt(n,"default")],Uu.STYLE|Uu.CLASS|Uu.PROPS,["onClick","onMouseup","onMousedown"]):Wu("div",{class:s.overlayClass,style:{zIndex:s.zIndex,position:"fixed",top:"0px",right:"0px",bottom:"0px",left:"0px"}},[Dt(n,"default")])}});const RN=yN,IN=(s,n,i,o)=>{const l={offsetX:0,offsetY:0},f=(p,T)=>{if(s.value){const{offsetX:$,offsetY:S}=l,y=s.value.getBoundingClientRect(),g=y.left,E=y.top,v=y.width,b=y.height,R=document.documentElement.clientWidth,O=document.documentElement.clientHeight,w=-g+$,L=-E+S,I=R-g-v+$,k=O-E-(b<O?b:0)+S;o!=null&&o.value||(p=Math.min(Math.max(p,w),I),T=Math.min(Math.max(T,L),k)),l.offsetX=p,l.offsetY=T,s.value.style.transform=`translate(${pf(p)}, ${pf(T)})`}},m=p=>{const T=p.clientX,$=p.clientY,{offsetX:S,offsetY:y}=l,g=v=>{const b=S+v.clientX-T,R=y+v.clientY-$;f(b,R)},E=()=>{document.removeEventListener("mousemove",g),document.removeEventListener("mouseup",E)};document.addEventListener("mousemove",g),document.addEventListener("mouseup",E)},u=()=>{n.value&&s.value&&(n.value.addEventListener("mousedown",m),window.addEventListener("resize",h))},_=()=>{n.value&&s.value&&(n.value.removeEventListener("mousedown",m),window.removeEventListener("resize",h))},c=()=>{l.offsetX=0,l.offsetY=0,s.value&&(s.value.style.transform="")},h=()=>{const{offsetX:p,offsetY:T}=l;f(p,T)};return Rs(()=>{dw(()=>{i.value?u():_()})}),Nr(()=>{_()}),{resetPosition:c,updatePosition:h}},CN=(s,n={})=>{Vl(s)||IA("[useLockscreen]","You need to pass a ref param to this function");const i=n.ns||nr("popup"),o=_e(()=>i.bm("parent","hidden"));if(!ir||ET(document.body,o.value))return;let l=0,f=false,m="0";const u=()=>{setTimeout(()=>{typeof document>"u"||f&&document&&(document.body.style.width=m,FA(document.body,o.value))},200)};kt(s,_=>{if(!_){u();return}f=!ET(document.body,o.value),f&&(m=document.body.style.width,UA(document.body,o.value)),l=HA(i.namespace.value);const c=document.documentElement.clientHeight<document.body.scrollHeight,h=GA(document.body,"overflowY");l>0&&(c||h==="scroll")&&f&&(document.body.style.width=`calc(100% - ${l}px)`)}),Oy(()=>u())},ON=s=>["",...Zy].includes(s),vf="_trap-focus-children",uo=[],DT=s=>{if(uo.length===0)return;const n=uo[uo.length-1][vf];if(n.length>0&&s.code===nm.tab){if(n.length===1){s.preventDefault(),document.activeElement!==n[0]&&n[0].focus();return}const i=s.shiftKey,o=s.target===n[0],l=s.target===n[n.length-1];o&&i&&(s.preventDefault(),n[n.length-1].focus()),l&&!i&&(s.preventDefault(),n[0].focus())}},wN={beforeMount(s){s[vf]=ST(s),uo.push(s),uo.length<=1&&document.addEventListener("keydown",DT)},updated(s){rs(()=>{s[vf]=ST(s)})},unmounted(){uo.shift(),uo.length===0&&document.removeEventListener("keydown",DT)}},kN=Ke({name:"ElMessageBox",directives:{TrapFocus:wN},components:{ElButton:bN,ElFocusTrap:KL,ElInput:uR,ElOverlay:RN,ElIcon:Sr,...lL},inheritAttrs:false,props:{buttonSize:{type:String,validator:ON},modal:{type:Boolean,default:true},lockScroll:{type:Boolean,default:true},showClose:{type:Boolean,default:true},closeOnClickModal:{type:Boolean,default:true},closeOnPressEscape:{type:Boolean,default:true},closeOnHashChange:{type:Boolean,default:true},center:Boolean,draggable:Boolean,overflow:Boolean,roundButton:Boolean,container:{type:String,default:"body"},boxType:{type:String,default:""}},emits:["vanish","action"],setup(s,{emit:n}){const{locale:i,zIndex:o,ns:l,size:f}=xA("message-box",_e(()=>s.buttonSize)),{t:m}=i,{nextZIndex:u}=o,_=me(false),c=zi({autofocus:true,beforeClose:null,callback:null,cancelButtonText:"",cancelButtonClass:"",confirmButtonText:"",confirmButtonClass:"",customClass:"",customStyle:{},dangerouslyUseHTMLString:false,distinguishCancelAndClose:false,icon:"",closeIcon:"",inputPattern:null,inputPlaceholder:"",inputType:"text",inputValue:"",inputValidator:void 0,inputErrorMessage:"",message:"",modalFade:true,modalClass:"",showCancelButton:false,showConfirmButton:true,type:"",title:void 0,showInput:false,action:"",confirmButtonLoading:false,cancelButtonLoading:false,confirmButtonLoadingIcon:Wl(Ju),cancelButtonLoadingIcon:Wl(Ju),confirmButtonDisabled:false,editorErrorMessage:"",validateError:false,zIndex:u()}),h=_e(()=>{const j=c.type;return{[l.bm("icon",j)]:j&&vT[j]}}),p=ff(),T=ff(),$=_e(()=>{const j=c.type;return c.icon||j&&vT[j]||""}),S=_e(()=>!!c.message),y=me(),g=me(),E=me(),v=me(),b=me(),R=_e(()=>c.confirmButtonClass);kt(()=>c.inputValue,async j=>{await rs(),s.boxType==="prompt"&&j&&F()},{immediate:true}),kt(()=>_.value,j=>{var J,M;j&&(s.boxType!=="prompt"&&(c.autofocus?E.value=(M=(J=b.value)==null?void 0:J.$el)!=null?M:y.value:E.value=y.value),c.zIndex=u()),s.boxType==="prompt"&&(j?rs().then(()=>{var U;v.value&&v.value.$el&&(c.autofocus?E.value=(U=X())!=null?U:y.value:E.value=y.value)}):(c.editorErrorMessage="",c.validateError=false))});const O=_e(()=>s.draggable),w=_e(()=>s.overflow);IN(y,g,O,w),Rs(async()=>{await rs(),s.closeOnHashChange&&window.addEventListener("hashchange",L)}),Nr(()=>{s.closeOnHashChange&&window.removeEventListener("hashchange",L)});function L(){_.value&&(_.value=false,rs(()=>{c.action&&n("action",c.action)}))}const I=()=>{s.closeOnClickModal&&P(c.distinguishCancelAndClose?"close":"cancel")},k=gR(I),x=j=>{if(c.inputType!=="textarea")return j.preventDefault(),P("confirm")},P=j=>{var J;s.boxType==="prompt"&&j==="confirm"&&!F()||(c.action=j,c.beforeClose?(J=c.beforeClose)==null||J.call(c,j,c,L):L())},F=()=>{if(s.boxType==="prompt"){const j=c.inputPattern;if(j&&!j.test(c.inputValue||""))return c.editorErrorMessage=c.inputErrorMessage||m("el.messagebox.error"),c.validateError=true,false;const J=c.inputValidator;if(ha(J)){const M=J(c.inputValue);if(M===false)return c.editorErrorMessage=c.inputErrorMessage||m("el.messagebox.error"),c.validateError=true,false;if(er(M))return c.editorErrorMessage=M,c.validateError=true,false}}return c.editorErrorMessage="",c.validateError=false,true},X=()=>{var j,J;const M=(j=v.value)==null?void 0:j.$refs;return(J=M==null?void 0:M.input)!=null?J:M==null?void 0:M.textarea},W=()=>{P("close")},z=()=>{s.closeOnPressEscape&&W()};return s.lockScroll&&CN(_),{...wy(c),ns:l,overlayEvent:k,visible:_,hasMessage:S,typeClass:h,contentId:p,inputId:T,btnSize:f,iconComponent:$,confirmButtonClasses:R,rootRef:y,focusStartRef:E,headerRef:g,inputRef:v,confirmRef:b,doClose:L,handleClose:W,onCloseRequested:z,handleWrapperClick:I,handleInputEnter:x,handleAction:P,t:m}}});function AN(s,n,i,o,l,f){const m=gt("el-icon"),u=gt("el-input"),_=gt("el-button"),c=gt("el-focus-trap"),h=gt("el-overlay");return ne(),Ye(ac,{name:"fade-in-linear",onAfterLeave:p=>s.$emit("vanish"),persisted:""},{default:je(()=>[hi(De(h,{"z-index":s.zIndex,"overlay-class":[s.ns.is("message-box"),s.modalClass],mask:s.modal},{default:je(()=>[de("div",{role:"dialog","aria-label":s.title,"aria-modal":"true","aria-describedby":s.showInput?void 0:s.contentId,class:tt(`${s.ns.namespace.value}-overlay-message-box`),onClick:s.overlayEvent.onClick,onMousedown:s.overlayEvent.onMousedown,onMouseup:s.overlayEvent.onMouseup},[De(c,{loop:"",trapped:s.visible,"focus-trap-el":s.rootRef,"focus-start-el":s.focusStartRef,onReleaseRequested:s.onCloseRequested},{default:je(()=>[de("div",{ref:"rootRef",class:tt([s.ns.b(),s.customClass,s.ns.is("draggable",s.draggable),{[s.ns.m("center")]:s.center}]),style:Hs(s.customStyle),tabindex:"-1",onClick:gs(()=>{},["stop"])},[s.title!==null&&s.title!==void 0?(ne(),ve("div",{key:0,ref:"headerRef",class:tt([s.ns.e("header"),{"show-close":s.showClose}])},[de("div",{class:tt(s.ns.e("title"))},[s.iconComponent&&s.center?(ne(),Ye(m,{key:0,class:tt([s.ns.e("status"),s.typeClass])},{default:je(()=>[(ne(),Ye(qs(s.iconComponent)))]),_:1},8,["class"])):Ze("v-if",true),de("span",null,Bt(s.title),1)],2),s.showClose?(ne(),ve("button",{key:0,type:"button",class:tt(s.ns.e("headerbtn")),"aria-label":s.t("el.messagebox.close"),onClick:p=>s.handleAction(s.distinguishCancelAndClose?"close":"cancel"),onKeydown:lo(gs(p=>s.handleAction(s.distinguishCancelAndClose?"close":"cancel"),["prevent"]),["enter"])},[De(m,{class:tt(s.ns.e("close"))},{default:je(()=>[(ne(),Ye(qs(s.closeIcon||"close")))]),_:1},8,["class"])],42,["aria-label","onClick","onKeydown"])):Ze("v-if",true)],2)):Ze("v-if",true),de("div",{id:s.contentId,class:tt(s.ns.e("content"))},[de("div",{class:tt(s.ns.e("container"))},[s.iconComponent&&!s.center&&s.hasMessage?(ne(),Ye(m,{key:0,class:tt([s.ns.e("status"),s.typeClass])},{default:je(()=>[(ne(),Ye(qs(s.iconComponent)))]),_:1},8,["class"])):Ze("v-if",true),s.hasMessage?(ne(),ve("div",{key:1,class:tt(s.ns.e("message"))},[Dt(s.$slots,"default",{},()=>[s.dangerouslyUseHTMLString?(ne(),Ye(qs(s.showInput?"label":"p"),{key:1,for:s.showInput?s.inputId:void 0,innerHTML:s.message},null,8,["for","innerHTML"])):(ne(),Ye(qs(s.showInput?"label":"p"),{key:0,for:s.showInput?s.inputId:void 0},{default:je(()=>[xt(Bt(s.dangerouslyUseHTMLString?"":s.message),1)]),_:1},8,["for"]))])],2)):Ze("v-if",true)],2),hi(de("div",{class:tt(s.ns.e("input"))},[De(u,{id:s.inputId,ref:"inputRef",modelValue:s.inputValue,"onUpdate:modelValue":p=>s.inputValue=p,type:s.inputType,placeholder:s.inputPlaceholder,"aria-invalid":s.validateError,class:tt({invalid:s.validateError}),onKeydown:lo(s.handleInputEnter,["enter"])},null,8,["id","modelValue","onUpdate:modelValue","type","placeholder","aria-invalid","class","onKeydown"]),de("div",{class:tt(s.ns.e("errormsg")),style:Hs({visibility:s.editorErrorMessage?"visible":"hidden"})},Bt(s.editorErrorMessage),7)],2),[[Hi,s.showInput]])],10,["id"]),de("div",{class:tt(s.ns.e("btns"))},[s.showCancelButton?(ne(),Ye(_,{key:0,loading:s.cancelButtonLoading,"loading-icon":s.cancelButtonLoadingIcon,class:tt([s.cancelButtonClass]),round:s.roundButton,size:s.btnSize,onClick:p=>s.handleAction("cancel"),onKeydown:lo(gs(p=>s.handleAction("cancel"),["prevent"]),["enter"])},{default:je(()=>[xt(Bt(s.cancelButtonText||s.t("el.messagebox.cancel")),1)]),_:1},8,["loading","loading-icon","class","round","size","onClick","onKeydown"])):Ze("v-if",true),hi(De(_,{ref:"confirmRef",type:"primary",loading:s.confirmButtonLoading,"loading-icon":s.confirmButtonLoadingIcon,class:tt([s.confirmButtonClasses]),round:s.roundButton,disabled:s.confirmButtonDisabled,size:s.btnSize,onClick:p=>s.handleAction("confirm"),onKeydown:lo(gs(p=>s.handleAction("confirm"),["prevent"]),["enter"])},{default:je(()=>[xt(Bt(s.confirmButtonText||s.t("el.messagebox.confirm")),1)]),_:1},8,["loading","loading-icon","class","round","disabled","size","onClick","onKeydown"]),[[Hi,s.showConfirmButton]])],2)],14,["onClick"])]),_:3},8,["trapped","focus-trap-el","focus-start-el","onReleaseRequested"])],42,["aria-label","aria-describedby","onClick","onMousedown","onMouseup"])]),_:3},8,["z-index","overlay-class","mask"]),[[Hi,s.visible]])]),_:3},8,["onAfterLeave"])}var LN=ya(kN,[["render",AN],["__file","index.vue"]]);const jl=new Map,NN=s=>{let n=document.body;return s.appendTo&&(er(s.appendTo)&&(n=document.querySelector(s.appendTo)),Yu(s.appendTo)&&(n=s.appendTo),Yu(n)||(n=document.body)),n},MN=(s,n,i=null)=>{const o=De(LN,s,ha(s.message)||ky(s.message)?{default:ha(s.message)?s.message:()=>s.message}:null);return o.appContext=i,Ay(o,n),NN(s).appendChild(n.firstElementChild),o.component},DN=()=>document.createElement("div"),xN=(s,n)=>{const i=DN();s.onVanish=()=>{Ay(null,i),jl.delete(l)},s.onAction=f=>{const m=jl.get(l);let u;s.showInput?u={value:l.inputValue,action:f}:u=f,s.callback?s.callback(u,o.proxy):f==="cancel"||f==="close"?s.distinguishCancelAndClose&&f!=="cancel"?m.reject("close"):m.reject("cancel"):m.resolve(u)};const o=MN(s,i,n),l=o.proxy;for(const f in s)zu(s,f)&&!zu(l.$props,f)&&(f==="closeIcon"&&da(s[f])?l[f]=Wl(s[f]):l[f]=s[f]);return l.visible=true,l};function Ra(s,n=null){if(!ir)return Promise.reject();let i;return er(s)||ky(s)?s={message:s}:i=s.callback,new Promise((o,l)=>{const f=xN(s,n??Ra._context);jl.set(f,{options:s,callback:i,resolve:o,reject:l})})}const BN=["alert","confirm","prompt"],PN={alert:{closeOnPressEscape:false,closeOnClickModal:false},confirm:{showCancelButton:true},prompt:{showCancelButton:true,showInput:true}};BN.forEach(s=>{Ra[s]=UN(s)});function UN(s){return(n,i,o,l)=>{let f="";return da(i)?(o=i,f=""):jy(i)?f="":f=i,Ra(Object.assign({title:f,message:n,type:"",...PN[s]},o,{boxType:s}),l)}}Ra.close=()=>{jl.forEach((s,n)=>{n.doClose()}),jl.clear()};Ra._context=null;const Tr=Ra;Tr.install=s=>{Tr._context=s._context,s.config.globalProperties.$msgbox=Tr,s.config.globalProperties.$messageBox=Tr,s.config.globalProperties.$alert=Tr.alert,s.config.globalProperties.$confirm=Tr.confirm,s.config.globalProperties.$prompt=Tr.prompt};const Ll=Tr,FN={name:"import"},GN={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",style:{height:"24px"}};function HN(s,n,i,o,l,f){return ne(),ve("svg",GN,n[0]||(n[0]=[de("path",{fill:"currentColor",d:"M263 383C258.3 387.7 256 393.8 256 400s2.344 12.28 7.031 16.97c9.375 9.375 24.56 9.375 33.94 0l80-80c9.375-9.375 9.375-24.56 0-33.94l-80-80c-9.375-9.375-24.56-9.375-33.94 0s-9.375 24.56 0 33.94L302.1 296H24C10.75 296 0 306.8 0 320s10.75 24 24 24h278.1L263 383zM493.3 93.38l-74.63-74.64C406.6 6.742 390.3 0 373.4 0H192C156.7 0 127.1 28.66 128 64l.0078 168c.002 13.26 10.75 24 24 24s24-10.75 23.1-24L176 64.13c0-8.836 7.162-16 16-16h160L352 128c0 17.67 14.33 32 32 32h79.1v288c0 8.836-7.164 16-16 16H192c-8.838 0-16-7.164-16-16l-.002-40C176 394.7 165.3 384 152 384s-24 10.75-23.1 24L128 448c.002 35.34 28.65 64 64 64H448c35.2 0 64-28.8 64-64V138.6C512 121.7 505.3 105.4 493.3 93.38z"},null,-1)]))}const VN=rr(FN,[["render",HN]]),WN={},zN={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 384 512",style:{height:"24px"},fill:"currentColor"};function jN(s,n){return ne(),ve("svg",zN,n[0]||(n[0]=[de("path",{d:"M320 464c8.8 0 16-7.2 16-16V160H256c-17.7 0-32-14.3-32-32V48H64c-8.8 0-16 7.2-16 16V448c0 8.8 7.2 16 16 16H320zM0 64C0 28.7 28.7 0 64 0H229.5c17 0 33.3 6.7 45.3 18.7l90.5 90.5c12 12 18.7 28.3 18.7 45.3V448c0 35.3-28.7 64-64 64H64c-35.3 0-64-28.7-64-64V64z"},null,-1)]))}const XN=rr(WN,[["render",jN]]);/*! pako 2.1.0 https://github.com/nodeca/pako @license (MIT AND Zlib) */const KN=4,xT=0,BT=1,YN=2;function Ia(s){let n=s.length;for(;--n>=0;)s[n]=0}const qN=0,fR=1,JN=2,ZN=3,QN=258,om=29,cc=256,Xl=cc+1+om,ua=30,am=19,mR=2*Xl+1,ho=15,np=16,eM=7,lm=256,ER=16,vR=17,bR=18,bf=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),Fu=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),tM=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),TR=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),sM=512,qn=new Array((Xl+2)*2);Ia(qn);const Pl=new Array(ua*2);Ia(Pl);const Kl=new Array(sM);Ia(Kl);const Yl=new Array(QN-ZN+1);Ia(Yl);const cm=new Array(om);Ia(cm);const Qu=new Array(ua);Ia(Qu);function rp(s,n,i,o,l){this.static_tree=s,this.extra_bits=n,this.extra_base=i,this.elems=o,this.max_length=l,this.has_stree=s&&s.length}let SR,$R,yR;function op(s,n){this.dyn_tree=s,this.max_code=0,this.stat_desc=n}const RR=s=>s<256?Kl[s]:Kl[256+(s>>>7)],ql=(s,n)=>{s.pending_buf[s.pending++]=n&255,s.pending_buf[s.pending++]=n>>>8&255},di=(s,n,i)=>{s.bi_valid>np-i?(s.bi_buf|=n<<s.bi_valid&65535,ql(s,s.bi_buf),s.bi_buf=n>>np-s.bi_valid,s.bi_valid+=i-np):(s.bi_buf|=n<<s.bi_valid&65535,s.bi_valid+=i)},An=(s,n,i)=>{di(s,i[n*2],i[n*2+1])},IR=(s,n)=>{let i=0;do i|=s&1,s>>>=1,i<<=1;while(--n>0);return i>>>1},iM=s=>{s.bi_valid===16?(ql(s,s.bi_buf),s.bi_buf=0,s.bi_valid=0):s.bi_valid>=8&&(s.pending_buf[s.pending++]=s.bi_buf&255,s.bi_buf>>=8,s.bi_valid-=8)},nM=(s,n)=>{const i=n.dyn_tree,o=n.max_code,l=n.stat_desc.static_tree,f=n.stat_desc.has_stree,m=n.stat_desc.extra_bits,u=n.stat_desc.extra_base,_=n.stat_desc.max_length;let c,h,p,T,$,S,y=0;for(T=0;T<=ho;T++)s.bl_count[T]=0;for(i[s.heap[s.heap_max]*2+1]=0,c=s.heap_max+1;c<mR;c++)h=s.heap[c],T=i[i[h*2+1]*2+1]+1,T>_&&(T=_,y++),i[h*2+1]=T,!(h>o)&&(s.bl_count[T]++,$=0,h>=u&&($=m[h-u]),S=i[h*2],s.opt_len+=S*(T+$),f&&(s.static_len+=S*(l[h*2+1]+$)));if(y!==0){do{for(T=_-1;s.bl_count[T]===0;)T--;s.bl_count[T]--,s.bl_count[T+1]+=2,s.bl_count[_]--,y-=2}while(y>0);for(T=_;T!==0;T--)for(h=s.bl_count[T];h!==0;)p=s.heap[--c],!(p>o)&&(i[p*2+1]!==T&&(s.opt_len+=(T-i[p*2+1])*i[p*2],i[p*2+1]=T),h--)}},CR=(s,n,i)=>{const o=new Array(ho+1);let l=0,f,m;for(f=1;f<=ho;f++)l=l+i[f-1]<<1,o[f]=l;for(m=0;m<=n;m++){let u=s[m*2+1];u!==0&&(s[m*2]=IR(o[u]++,u))}},rM=()=>{let s,n,i,o,l;const f=new Array(ho+1);for(i=0,o=0;o<om-1;o++)for(cm[o]=i,s=0;s<1<<bf[o];s++)Yl[i++]=o;for(Yl[i-1]=o,l=0,o=0;o<16;o++)for(Qu[o]=l,s=0;s<1<<Fu[o];s++)Kl[l++]=o;for(l>>=7;o<ua;o++)for(Qu[o]=l<<7,s=0;s<1<<Fu[o]-7;s++)Kl[256+l++]=o;for(n=0;n<=ho;n++)f[n]=0;for(s=0;s<=143;)qn[s*2+1]=8,s++,f[8]++;for(;s<=255;)qn[s*2+1]=9,s++,f[9]++;for(;s<=279;)qn[s*2+1]=7,s++,f[7]++;for(;s<=287;)qn[s*2+1]=8,s++,f[8]++;for(CR(qn,Xl+1,f),s=0;s<ua;s++)Pl[s*2+1]=5,Pl[s*2]=IR(s,5);SR=new rp(qn,bf,cc+1,Xl,ho),$R=new rp(Pl,Fu,0,ua,ho),yR=new rp(new Array(0),tM,0,am,eM)},OR=s=>{let n;for(n=0;n<Xl;n++)s.dyn_ltree[n*2]=0;for(n=0;n<ua;n++)s.dyn_dtree[n*2]=0;for(n=0;n<am;n++)s.bl_tree[n*2]=0;s.dyn_ltree[lm*2]=1,s.opt_len=s.static_len=0,s.sym_next=s.matches=0},wR=s=>{s.bi_valid>8?ql(s,s.bi_buf):s.bi_valid>0&&(s.pending_buf[s.pending++]=s.bi_buf),s.bi_buf=0,s.bi_valid=0},PT=(s,n,i,o)=>{const l=n*2,f=i*2;return s[l]<s[f]||s[l]===s[f]&&o[n]<=o[i]},ap=(s,n,i)=>{const o=s.heap[i];let l=i<<1;for(;l<=s.heap_len&&(l<s.heap_len&&PT(n,s.heap[l+1],s.heap[l],s.depth)&&l++,!PT(n,o,s.heap[l],s.depth));)s.heap[i]=s.heap[l],i=l,l<<=1;s.heap[i]=o},UT=(s,n,i)=>{let o,l,f=0,m,u;if(s.sym_next!==0)do o=s.pending_buf[s.sym_buf+f++]&255,o+=(s.pending_buf[s.sym_buf+f++]&255)<<8,l=s.pending_buf[s.sym_buf+f++],o===0?An(s,l,n):(m=Yl[l],An(s,m+cc+1,n),u=bf[m],u!==0&&(l-=cm[m],di(s,l,u)),o--,m=RR(o),An(s,m,i),u=Fu[m],u!==0&&(o-=Qu[m],di(s,o,u)));while(f<s.sym_next);An(s,lm,n)},Tf=(s,n)=>{const i=n.dyn_tree,o=n.stat_desc.static_tree,l=n.stat_desc.has_stree,f=n.stat_desc.elems;let m,u,_=-1,c;for(s.heap_len=0,s.heap_max=mR,m=0;m<f;m++)i[m*2]!==0?(s.heap[++s.heap_len]=_=m,s.depth[m]=0):i[m*2+1]=0;for(;s.heap_len<2;)c=s.heap[++s.heap_len]=_<2?++_:0,i[c*2]=1,s.depth[c]=0,s.opt_len--,l&&(s.static_len-=o[c*2+1]);for(n.max_code=_,m=s.heap_len>>1;m>=1;m--)ap(s,i,m);c=f;do m=s.heap[1],s.heap[1]=s.heap[s.heap_len--],ap(s,i,1),u=s.heap[1],s.heap[--s.heap_max]=m,s.heap[--s.heap_max]=u,i[c*2]=i[m*2]+i[u*2],s.depth[c]=(s.depth[m]>=s.depth[u]?s.depth[m]:s.depth[u])+1,i[m*2+1]=i[u*2+1]=c,s.heap[1]=c++,ap(s,i,1);while(s.heap_len>=2);s.heap[--s.heap_max]=s.heap[1],nM(s,n),CR(i,_,s.bl_count)},FT=(s,n,i)=>{let o,l=-1,f,m=n[0*2+1],u=0,_=7,c=4;for(m===0&&(_=138,c=3),n[(i+1)*2+1]=65535,o=0;o<=i;o++)f=m,m=n[(o+1)*2+1],!(++u<_&&f===m)&&(u<c?s.bl_tree[f*2]+=u:f!==0?(f!==l&&s.bl_tree[f*2]++,s.bl_tree[ER*2]++):u<=10?s.bl_tree[vR*2]++:s.bl_tree[bR*2]++,u=0,l=f,m===0?(_=138,c=3):f===m?(_=6,c=3):(_=7,c=4))},GT=(s,n,i)=>{let o,l=-1,f,m=n[0*2+1],u=0,_=7,c=4;for(m===0&&(_=138,c=3),o=0;o<=i;o++)if(f=m,m=n[(o+1)*2+1],!(++u<_&&f===m)){if(u<c)do An(s,f,s.bl_tree);while(--u!==0);else f!==0?(f!==l&&(An(s,f,s.bl_tree),u--),An(s,ER,s.bl_tree),di(s,u-3,2)):u<=10?(An(s,vR,s.bl_tree),di(s,u-3,3)):(An(s,bR,s.bl_tree),di(s,u-11,7));u=0,l=f,m===0?(_=138,c=3):f===m?(_=6,c=3):(_=7,c=4)}},oM=s=>{let n;for(FT(s,s.dyn_ltree,s.l_desc.max_code),FT(s,s.dyn_dtree,s.d_desc.max_code),Tf(s,s.bl_desc),n=am-1;n>=3&&s.bl_tree[TR[n]*2+1]===0;n--);return s.opt_len+=3*(n+1)+5+5+4,n},aM=(s,n,i,o)=>{let l;for(di(s,n-257,5),di(s,i-1,5),di(s,o-4,4),l=0;l<o;l++)di(s,s.bl_tree[TR[l]*2+1],3);GT(s,s.dyn_ltree,n-1),GT(s,s.dyn_dtree,i-1)},lM=s=>{let n=4093624447,i;for(i=0;i<=31;i++,n>>>=1)if(n&1&&s.dyn_ltree[i*2]!==0)return xT;if(s.dyn_ltree[9*2]!==0||s.dyn_ltree[10*2]!==0||s.dyn_ltree[13*2]!==0)return BT;for(i=32;i<cc;i++)if(s.dyn_ltree[i*2]!==0)return BT;return xT};let HT=false;const cM=s=>{HT||(rM(),HT=true),s.l_desc=new op(s.dyn_ltree,SR),s.d_desc=new op(s.dyn_dtree,$R),s.bl_desc=new op(s.bl_tree,yR),s.bi_buf=0,s.bi_valid=0,OR(s)},kR=(s,n,i,o)=>{di(s,(qN<<1)+(o?1:0),3),wR(s),ql(s,i),ql(s,~i),i&&s.pending_buf.set(s.window.subarray(n,n+i),s.pending),s.pending+=i},uM=s=>{di(s,fR<<1,3),An(s,lm,qn),iM(s)},hM=(s,n,i,o)=>{let l,f,m=0;s.level>0?(s.strm.data_type===YN&&(s.strm.data_type=lM(s)),Tf(s,s.l_desc),Tf(s,s.d_desc),m=oM(s),l=s.opt_len+3+7>>>3,f=s.static_len+3+7>>>3,f<=l&&(l=f)):l=f=i+5,i+4<=l&&n!==-1?kR(s,n,i,o):s.strategy===KN||f===l?(di(s,(fR<<1)+(o?1:0),3),UT(s,qn,Pl)):(di(s,(JN<<1)+(o?1:0),3),aM(s,s.l_desc.max_code+1,s.d_desc.max_code+1,m+1),UT(s,s.dyn_ltree,s.dyn_dtree)),OR(s),o&&wR(s)},dM=(s,n,i)=>(s.pending_buf[s.sym_buf+s.sym_next++]=n,s.pending_buf[s.sym_buf+s.sym_next++]=n>>8,s.pending_buf[s.sym_buf+s.sym_next++]=i,n===0?s.dyn_ltree[i*2]++:(s.matches++,n--,s.dyn_ltree[(Yl[i]+cc+1)*2]++,s.dyn_dtree[RR(n)*2]++),s.sym_next===s.sym_end);var _M=cM,pM=kR,gM=hM,fM=dM,mM=uM,EM={_tr_init:_M,_tr_stored_block:pM,_tr_flush_block:gM,_tr_tally:fM,_tr_align:mM};const vM=(s,n,i,o)=>{let l=s&65535|0,f=s>>>16&65535|0,m=0;for(;i!==0;){m=i>2e3?2e3:i,i-=m;do l=l+n[o++]|0,f=f+l|0;while(--m);l%=65521,f%=65521}return l|f<<16|0};var Jl=vM;const bM=()=>{let s,n=[];for(var i=0;i<256;i++){s=i;for(var o=0;o<8;o++)s=s&1?3988292384^s>>>1:s>>>1;n[i]=s}return n},TM=new Uint32Array(bM()),SM=(s,n,i,o)=>{const l=TM,f=o+i;s^=-1;for(let m=o;m<f;m++)s=s>>>8^l[(s^n[m])&255];return s^-1};var ys=SM,mo={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},uh={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:$M,_tr_stored_block:Sf,_tr_flush_block:yM,_tr_tally:Or,_tr_align:RM}=EM,{Z_NO_FLUSH:wr,Z_PARTIAL_FLUSH:IM,Z_FULL_FLUSH:CM,Z_FINISH:Vi,Z_BLOCK:VT,Z_OK:Ms,Z_STREAM_END:WT,Z_STREAM_ERROR:Ln,Z_DATA_ERROR:OM,Z_BUF_ERROR:lp,Z_DEFAULT_COMPRESSION:wM,Z_FILTERED:kM,Z_HUFFMAN_ONLY:ku,Z_RLE:AM,Z_FIXED:LM,Z_DEFAULT_STRATEGY:NM,Z_UNKNOWN:MM,Z_DEFLATED:hh}=uh,DM=9,xM=15,BM=8,PM=29,UM=256,$f=UM+1+PM,FM=30,GM=19,HM=2*$f+1,VM=15,Tt=3,Rr=258,Nn=Rr+Tt+1,WM=32,_a=42,um=57,yf=69,Rf=73,If=91,Cf=103,_o=113,Nl=666,Zs=1,Ca=2,Eo=3,Oa=4,zM=3,po=(s,n)=>(s.msg=mo[n],n),zT=s=>s*2-(s>4?9:0),$r=s=>{let n=s.length;for(;--n>=0;)s[n]=0},jM=s=>{let n,i,o,l=s.w_size;n=s.hash_size,o=n;do i=s.head[--o],s.head[o]=i>=l?i-l:0;while(--n);n=l,o=n;do i=s.prev[--o],s.prev[o]=i>=l?i-l:0;while(--n)};let XM=(s,n,i)=>(n<<s.hash_shift^i)&s.hash_mask,kr=XM;const Ai=s=>{const n=s.state;let i=n.pending;i>s.avail_out&&(i=s.avail_out),i!==0&&(s.output.set(n.pending_buf.subarray(n.pending_out,n.pending_out+i),s.next_out),s.next_out+=i,n.pending_out+=i,s.total_out+=i,s.avail_out-=i,n.pending-=i,n.pending===0&&(n.pending_out=0))},Li=(s,n)=>{yM(s,s.block_start>=0?s.block_start:-1,s.strstart-s.block_start,n),s.block_start=s.strstart,Ai(s.strm)},Nt=(s,n)=>{s.pending_buf[s.pending++]=n},kl=(s,n)=>{s.pending_buf[s.pending++]=n>>>8&255,s.pending_buf[s.pending++]=n&255},Of=(s,n,i,o)=>{let l=s.avail_in;return l>o&&(l=o),l===0?0:(s.avail_in-=l,n.set(s.input.subarray(s.next_in,s.next_in+l),i),s.state.wrap===1?s.adler=Jl(s.adler,n,l,i):s.state.wrap===2&&(s.adler=ys(s.adler,n,l,i)),s.next_in+=l,s.total_in+=l,l)},AR=(s,n)=>{let i=s.max_chain_length,o=s.strstart,l,f,m=s.prev_length,u=s.nice_match;const _=s.strstart>s.w_size-Nn?s.strstart-(s.w_size-Nn):0,c=s.window,h=s.w_mask,p=s.prev,T=s.strstart+Rr;let $=c[o+m-1],S=c[o+m];s.prev_length>=s.good_match&&(i>>=2),u>s.lookahead&&(u=s.lookahead);do if(l=n,!(c[l+m]!==S||c[l+m-1]!==$||c[l]!==c[o]||c[++l]!==c[o+1])){o+=2,l++;do;while(c[++o]===c[++l]&&c[++o]===c[++l]&&c[++o]===c[++l]&&c[++o]===c[++l]&&c[++o]===c[++l]&&c[++o]===c[++l]&&c[++o]===c[++l]&&c[++o]===c[++l]&&o<T);if(f=Rr-(T-o),o=T-Rr,f>m){if(s.match_start=n,m=f,f>=u)break;$=c[o+m-1],S=c[o+m]}}while((n=p[n&h])>_&&--i!==0);return m<=s.lookahead?m:s.lookahead},pa=s=>{const n=s.w_size;let i,o,l;do{if(o=s.window_size-s.lookahead-s.strstart,s.strstart>=n+(n-Nn)&&(s.window.set(s.window.subarray(n,n+n-o),0),s.match_start-=n,s.strstart-=n,s.block_start-=n,s.insert>s.strstart&&(s.insert=s.strstart),jM(s),o+=n),s.strm.avail_in===0)break;if(i=Of(s.strm,s.window,s.strstart+s.lookahead,o),s.lookahead+=i,s.lookahead+s.insert>=Tt)for(l=s.strstart-s.insert,s.ins_h=s.window[l],s.ins_h=kr(s,s.ins_h,s.window[l+1]);s.insert&&(s.ins_h=kr(s,s.ins_h,s.window[l+Tt-1]),s.prev[l&s.w_mask]=s.head[s.ins_h],s.head[s.ins_h]=l,l++,s.insert--,!(s.lookahead+s.insert<Tt)););}while(s.lookahead<Nn&&s.strm.avail_in!==0)},LR=(s,n)=>{let i=s.pending_buf_size-5>s.w_size?s.w_size:s.pending_buf_size-5,o,l,f,m=0,u=s.strm.avail_in;do{if(o=65535,f=s.bi_valid+42>>3,s.strm.avail_out<f||(f=s.strm.avail_out-f,l=s.strstart-s.block_start,o>l+s.strm.avail_in&&(o=l+s.strm.avail_in),o>f&&(o=f),o<i&&(o===0&&n!==Vi||n===wr||o!==l+s.strm.avail_in)))break;m=n===Vi&&o===l+s.strm.avail_in?1:0,Sf(s,0,0,m),s.pending_buf[s.pending-4]=o,s.pending_buf[s.pending-3]=o>>8,s.pending_buf[s.pending-2]=~o,s.pending_buf[s.pending-1]=~o>>8,Ai(s.strm),l&&(l>o&&(l=o),s.strm.output.set(s.window.subarray(s.block_start,s.block_start+l),s.strm.next_out),s.strm.next_out+=l,s.strm.avail_out-=l,s.strm.total_out+=l,s.block_start+=l,o-=l),o&&(Of(s.strm,s.strm.output,s.strm.next_out,o),s.strm.next_out+=o,s.strm.avail_out-=o,s.strm.total_out+=o)}while(m===0);return u-=s.strm.avail_in,u&&(u>=s.w_size?(s.matches=2,s.window.set(s.strm.input.subarray(s.strm.next_in-s.w_size,s.strm.next_in),0),s.strstart=s.w_size,s.insert=s.strstart):(s.window_size-s.strstart<=u&&(s.strstart-=s.w_size,s.window.set(s.window.subarray(s.w_size,s.w_size+s.strstart),0),s.matches<2&&s.matches++,s.insert>s.strstart&&(s.insert=s.strstart)),s.window.set(s.strm.input.subarray(s.strm.next_in-u,s.strm.next_in),s.strstart),s.strstart+=u,s.insert+=u>s.w_size-s.insert?s.w_size-s.insert:u),s.block_start=s.strstart),s.high_water<s.strstart&&(s.high_water=s.strstart),m?Oa:n!==wr&&n!==Vi&&s.strm.avail_in===0&&s.strstart===s.block_start?Ca:(f=s.window_size-s.strstart,s.strm.avail_in>f&&s.block_start>=s.w_size&&(s.block_start-=s.w_size,s.strstart-=s.w_size,s.window.set(s.window.subarray(s.w_size,s.w_size+s.strstart),0),s.matches<2&&s.matches++,f+=s.w_size,s.insert>s.strstart&&(s.insert=s.strstart)),f>s.strm.avail_in&&(f=s.strm.avail_in),f&&(Of(s.strm,s.window,s.strstart,f),s.strstart+=f,s.insert+=f>s.w_size-s.insert?s.w_size-s.insert:f),s.high_water<s.strstart&&(s.high_water=s.strstart),f=s.bi_valid+42>>3,f=s.pending_buf_size-f>65535?65535:s.pending_buf_size-f,i=f>s.w_size?s.w_size:f,l=s.strstart-s.block_start,(l>=i||(l||n===Vi)&&n!==wr&&s.strm.avail_in===0&&l<=f)&&(o=l>f?f:l,m=n===Vi&&s.strm.avail_in===0&&o===l?1:0,Sf(s,s.block_start,o,m),s.block_start+=o,Ai(s.strm)),m?Eo:Zs)},cp=(s,n)=>{let i,o;for(;;){if(s.lookahead<Nn){if(pa(s),s.lookahead<Nn&&n===wr)return Zs;if(s.lookahead===0)break}if(i=0,s.lookahead>=Tt&&(s.ins_h=kr(s,s.ins_h,s.window[s.strstart+Tt-1]),i=s.prev[s.strstart&s.w_mask]=s.head[s.ins_h],s.head[s.ins_h]=s.strstart),i!==0&&s.strstart-i<=s.w_size-Nn&&(s.match_length=AR(s,i)),s.match_length>=Tt)if(o=Or(s,s.strstart-s.match_start,s.match_length-Tt),s.lookahead-=s.match_length,s.match_length<=s.max_lazy_match&&s.lookahead>=Tt){s.match_length--;do s.strstart++,s.ins_h=kr(s,s.ins_h,s.window[s.strstart+Tt-1]),i=s.prev[s.strstart&s.w_mask]=s.head[s.ins_h],s.head[s.ins_h]=s.strstart;while(--s.match_length!==0);s.strstart++}else s.strstart+=s.match_length,s.match_length=0,s.ins_h=s.window[s.strstart],s.ins_h=kr(s,s.ins_h,s.window[s.strstart+1]);else o=Or(s,0,s.window[s.strstart]),s.lookahead--,s.strstart++;if(o&&(Li(s,false),s.strm.avail_out===0))return Zs}return s.insert=s.strstart<Tt-1?s.strstart:Tt-1,n===Vi?(Li(s,true),s.strm.avail_out===0?Eo:Oa):s.sym_next&&(Li(s,false),s.strm.avail_out===0)?Zs:Ca},oa=(s,n)=>{let i,o,l;for(;;){if(s.lookahead<Nn){if(pa(s),s.lookahead<Nn&&n===wr)return Zs;if(s.lookahead===0)break}if(i=0,s.lookahead>=Tt&&(s.ins_h=kr(s,s.ins_h,s.window[s.strstart+Tt-1]),i=s.prev[s.strstart&s.w_mask]=s.head[s.ins_h],s.head[s.ins_h]=s.strstart),s.prev_length=s.match_length,s.prev_match=s.match_start,s.match_length=Tt-1,i!==0&&s.prev_length<s.max_lazy_match&&s.strstart-i<=s.w_size-Nn&&(s.match_length=AR(s,i),s.match_length<=5&&(s.strategy===kM||s.match_length===Tt&&s.strstart-s.match_start>4096)&&(s.match_length=Tt-1)),s.prev_length>=Tt&&s.match_length<=s.prev_length){l=s.strstart+s.lookahead-Tt,o=Or(s,s.strstart-1-s.prev_match,s.prev_length-Tt),s.lookahead-=s.prev_length-1,s.prev_length-=2;do++s.strstart<=l&&(s.ins_h=kr(s,s.ins_h,s.window[s.strstart+Tt-1]),i=s.prev[s.strstart&s.w_mask]=s.head[s.ins_h],s.head[s.ins_h]=s.strstart);while(--s.prev_length!==0);if(s.match_available=0,s.match_length=Tt-1,s.strstart++,o&&(Li(s,false),s.strm.avail_out===0))return Zs}else if(s.match_available){if(o=Or(s,0,s.window[s.strstart-1]),o&&Li(s,false),s.strstart++,s.lookahead--,s.strm.avail_out===0)return Zs}else s.match_available=1,s.strstart++,s.lookahead--}return s.match_available&&(o=Or(s,0,s.window[s.strstart-1]),s.match_available=0),s.insert=s.strstart<Tt-1?s.strstart:Tt-1,n===Vi?(Li(s,true),s.strm.avail_out===0?Eo:Oa):s.sym_next&&(Li(s,false),s.strm.avail_out===0)?Zs:Ca},KM=(s,n)=>{let i,o,l,f;const m=s.window;for(;;){if(s.lookahead<=Rr){if(pa(s),s.lookahead<=Rr&&n===wr)return Zs;if(s.lookahead===0)break}if(s.match_length=0,s.lookahead>=Tt&&s.strstart>0&&(l=s.strstart-1,o=m[l],o===m[++l]&&o===m[++l]&&o===m[++l])){f=s.strstart+Rr;do;while(o===m[++l]&&o===m[++l]&&o===m[++l]&&o===m[++l]&&o===m[++l]&&o===m[++l]&&o===m[++l]&&o===m[++l]&&l<f);s.match_length=Rr-(f-l),s.match_length>s.lookahead&&(s.match_length=s.lookahead)}if(s.match_length>=Tt?(i=Or(s,1,s.match_length-Tt),s.lookahead-=s.match_length,s.strstart+=s.match_length,s.match_length=0):(i=Or(s,0,s.window[s.strstart]),s.lookahead--,s.strstart++),i&&(Li(s,false),s.strm.avail_out===0))return Zs}return s.insert=0,n===Vi?(Li(s,true),s.strm.avail_out===0?Eo:Oa):s.sym_next&&(Li(s,false),s.strm.avail_out===0)?Zs:Ca},YM=(s,n)=>{let i;for(;;){if(s.lookahead===0&&(pa(s),s.lookahead===0)){if(n===wr)return Zs;break}if(s.match_length=0,i=Or(s,0,s.window[s.strstart]),s.lookahead--,s.strstart++,i&&(Li(s,false),s.strm.avail_out===0))return Zs}return s.insert=0,n===Vi?(Li(s,true),s.strm.avail_out===0?Eo:Oa):s.sym_next&&(Li(s,false),s.strm.avail_out===0)?Zs:Ca};function wn(s,n,i,o,l){this.good_length=s,this.max_lazy=n,this.nice_length=i,this.max_chain=o,this.func=l}const Ml=[new wn(0,0,0,0,LR),new wn(4,4,8,4,cp),new wn(4,5,16,8,cp),new wn(4,6,32,32,cp),new wn(4,4,16,16,oa),new wn(8,16,32,32,oa),new wn(8,16,128,128,oa),new wn(8,32,128,256,oa),new wn(32,128,258,1024,oa),new wn(32,258,258,4096,oa)],qM=s=>{s.window_size=2*s.w_size,$r(s.head),s.max_lazy_match=Ml[s.level].max_lazy,s.good_match=Ml[s.level].good_length,s.nice_match=Ml[s.level].nice_length,s.max_chain_length=Ml[s.level].max_chain,s.strstart=0,s.block_start=0,s.lookahead=0,s.insert=0,s.match_length=s.prev_length=Tt-1,s.match_available=0,s.ins_h=0};function JM(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=hh,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(HM*2),this.dyn_dtree=new Uint16Array((2*FM+1)*2),this.bl_tree=new Uint16Array((2*GM+1)*2),$r(this.dyn_ltree),$r(this.dyn_dtree),$r(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(VM+1),this.heap=new Uint16Array(2*$f+1),$r(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*$f+1),$r(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const uc=s=>{if(!s)return 1;const n=s.state;return!n||n.strm!==s||n.status!==_a&&n.status!==um&&n.status!==yf&&n.status!==Rf&&n.status!==If&&n.status!==Cf&&n.status!==_o&&n.status!==Nl?1:0},NR=s=>{if(uc(s))return po(s,Ln);s.total_in=s.total_out=0,s.data_type=MM;const n=s.state;return n.pending=0,n.pending_out=0,n.wrap<0&&(n.wrap=-n.wrap),n.status=n.wrap===2?um:n.wrap?_a:_o,s.adler=n.wrap===2?0:1,n.last_flush=-2,$M(n),Ms},MR=s=>{const n=NR(s);return n===Ms&&qM(s.state),n},ZM=(s,n)=>uc(s)||s.state.wrap!==2?Ln:(s.state.gzhead=n,Ms),DR=(s,n,i,o,l,f)=>{if(!s)return Ln;let m=1;if(n===wM&&(n=6),o<0?(m=0,o=-o):o>15&&(m=2,o-=16),l<1||l>DM||i!==hh||o<8||o>15||n<0||n>9||f<0||f>LM||o===8&&m!==1)return po(s,Ln);o===8&&(o=9);const u=new JM;return s.state=u,u.strm=s,u.status=_a,u.wrap=m,u.gzhead=null,u.w_bits=o,u.w_size=1<<u.w_bits,u.w_mask=u.w_size-1,u.hash_bits=l+7,u.hash_size=1<<u.hash_bits,u.hash_mask=u.hash_size-1,u.hash_shift=~~((u.hash_bits+Tt-1)/Tt),u.window=new Uint8Array(u.w_size*2),u.head=new Uint16Array(u.hash_size),u.prev=new Uint16Array(u.w_size),u.lit_bufsize=1<<l+6,u.pending_buf_size=u.lit_bufsize*4,u.pending_buf=new Uint8Array(u.pending_buf_size),u.sym_buf=u.lit_bufsize,u.sym_end=(u.lit_bufsize-1)*3,u.level=n,u.strategy=f,u.method=i,MR(s)},QM=(s,n)=>DR(s,n,hh,xM,BM,NM),eD=(s,n)=>{if(uc(s)||n>VT||n<0)return s?po(s,Ln):Ln;const i=s.state;if(!s.output||s.avail_in!==0&&!s.input||i.status===Nl&&n!==Vi)return po(s,s.avail_out===0?lp:Ln);const o=i.last_flush;if(i.last_flush=n,i.pending!==0){if(Ai(s),s.avail_out===0)return i.last_flush=-1,Ms}else if(s.avail_in===0&&zT(n)<=zT(o)&&n!==Vi)return po(s,lp);if(i.status===Nl&&s.avail_in!==0)return po(s,lp);if(i.status===_a&&i.wrap===0&&(i.status=_o),i.status===_a){let l=hh+(i.w_bits-8<<4)<<8,f=-1;if(i.strategy>=ku||i.level<2?f=0:i.level<6?f=1:i.level===6?f=2:f=3,l|=f<<6,i.strstart!==0&&(l|=WM),l+=31-l%31,kl(i,l),i.strstart!==0&&(kl(i,s.adler>>>16),kl(i,s.adler&65535)),s.adler=1,i.status=_o,Ai(s),i.pending!==0)return i.last_flush=-1,Ms}if(i.status===um){if(s.adler=0,Nt(i,31),Nt(i,139),Nt(i,8),i.gzhead)Nt(i,(i.gzhead.text?1:0)+(i.gzhead.hcrc?2:0)+(i.gzhead.extra?4:0)+(i.gzhead.name?8:0)+(i.gzhead.comment?16:0)),Nt(i,i.gzhead.time&255),Nt(i,i.gzhead.time>>8&255),Nt(i,i.gzhead.time>>16&255),Nt(i,i.gzhead.time>>24&255),Nt(i,i.level===9?2:i.strategy>=ku||i.level<2?4:0),Nt(i,i.gzhead.os&255),i.gzhead.extra&&i.gzhead.extra.length&&(Nt(i,i.gzhead.extra.length&255),Nt(i,i.gzhead.extra.length>>8&255)),i.gzhead.hcrc&&(s.adler=ys(s.adler,i.pending_buf,i.pending,0)),i.gzindex=0,i.status=yf;else if(Nt(i,0),Nt(i,0),Nt(i,0),Nt(i,0),Nt(i,0),Nt(i,i.level===9?2:i.strategy>=ku||i.level<2?4:0),Nt(i,zM),i.status=_o,Ai(s),i.pending!==0)return i.last_flush=-1,Ms}if(i.status===yf){if(i.gzhead.extra){let l=i.pending,f=(i.gzhead.extra.length&65535)-i.gzindex;for(;i.pending+f>i.pending_buf_size;){let u=i.pending_buf_size-i.pending;if(i.pending_buf.set(i.gzhead.extra.subarray(i.gzindex,i.gzindex+u),i.pending),i.pending=i.pending_buf_size,i.gzhead.hcrc&&i.pending>l&&(s.adler=ys(s.adler,i.pending_buf,i.pending-l,l)),i.gzindex+=u,Ai(s),i.pending!==0)return i.last_flush=-1,Ms;l=0,f-=u}let m=new Uint8Array(i.gzhead.extra);i.pending_buf.set(m.subarray(i.gzindex,i.gzindex+f),i.pending),i.pending+=f,i.gzhead.hcrc&&i.pending>l&&(s.adler=ys(s.adler,i.pending_buf,i.pending-l,l)),i.gzindex=0}i.status=Rf}if(i.status===Rf){if(i.gzhead.name){let l=i.pending,f;do{if(i.pending===i.pending_buf_size){if(i.gzhead.hcrc&&i.pending>l&&(s.adler=ys(s.adler,i.pending_buf,i.pending-l,l)),Ai(s),i.pending!==0)return i.last_flush=-1,Ms;l=0}i.gzindex<i.gzhead.name.length?f=i.gzhead.name.charCodeAt(i.gzindex++)&255:f=0,Nt(i,f)}while(f!==0);i.gzhead.hcrc&&i.pending>l&&(s.adler=ys(s.adler,i.pending_buf,i.pending-l,l)),i.gzindex=0}i.status=If}if(i.status===If){if(i.gzhead.comment){let l=i.pending,f;do{if(i.pending===i.pending_buf_size){if(i.gzhead.hcrc&&i.pending>l&&(s.adler=ys(s.adler,i.pending_buf,i.pending-l,l)),Ai(s),i.pending!==0)return i.last_flush=-1,Ms;l=0}i.gzindex<i.gzhead.comment.length?f=i.gzhead.comment.charCodeAt(i.gzindex++)&255:f=0,Nt(i,f)}while(f!==0);i.gzhead.hcrc&&i.pending>l&&(s.adler=ys(s.adler,i.pending_buf,i.pending-l,l))}i.status=Cf}if(i.status===Cf){if(i.gzhead.hcrc){if(i.pending+2>i.pending_buf_size&&(Ai(s),i.pending!==0))return i.last_flush=-1,Ms;Nt(i,s.adler&255),Nt(i,s.adler>>8&255),s.adler=0}if(i.status=_o,Ai(s),i.pending!==0)return i.last_flush=-1,Ms}if(s.avail_in!==0||i.lookahead!==0||n!==wr&&i.status!==Nl){let l=i.level===0?LR(i,n):i.strategy===ku?YM(i,n):i.strategy===AM?KM(i,n):Ml[i.level].func(i,n);if((l===Eo||l===Oa)&&(i.status=Nl),l===Zs||l===Eo)return s.avail_out===0&&(i.last_flush=-1),Ms;if(l===Ca&&(n===IM?RM(i):n!==VT&&(Sf(i,0,0,false),n===CM&&($r(i.head),i.lookahead===0&&(i.strstart=0,i.block_start=0,i.insert=0))),Ai(s),s.avail_out===0))return i.last_flush=-1,Ms}return n!==Vi?Ms:i.wrap<=0?WT:(i.wrap===2?(Nt(i,s.adler&255),Nt(i,s.adler>>8&255),Nt(i,s.adler>>16&255),Nt(i,s.adler>>24&255),Nt(i,s.total_in&255),Nt(i,s.total_in>>8&255),Nt(i,s.total_in>>16&255),Nt(i,s.total_in>>24&255)):(kl(i,s.adler>>>16),kl(i,s.adler&65535)),Ai(s),i.wrap>0&&(i.wrap=-i.wrap),i.pending!==0?Ms:WT)},tD=s=>{if(uc(s))return Ln;const n=s.state.status;return s.state=null,n===_o?po(s,OM):Ms},sD=(s,n)=>{let i=n.length;if(uc(s))return Ln;const o=s.state,l=o.wrap;if(l===2||l===1&&o.status!==_a||o.lookahead)return Ln;if(l===1&&(s.adler=Jl(s.adler,n,i,0)),o.wrap=0,i>=o.w_size){l===0&&($r(o.head),o.strstart=0,o.block_start=0,o.insert=0);let _=new Uint8Array(o.w_size);_.set(n.subarray(i-o.w_size,i),0),n=_,i=o.w_size}const f=s.avail_in,m=s.next_in,u=s.input;for(s.avail_in=i,s.next_in=0,s.input=n,pa(o);o.lookahead>=Tt;){let _=o.strstart,c=o.lookahead-(Tt-1);do o.ins_h=kr(o,o.ins_h,o.window[_+Tt-1]),o.prev[_&o.w_mask]=o.head[o.ins_h],o.head[o.ins_h]=_,_++;while(--c);o.strstart=_,o.lookahead=Tt-1,pa(o)}return o.strstart+=o.lookahead,o.block_start=o.strstart,o.insert=o.lookahead,o.lookahead=0,o.match_length=o.prev_length=Tt-1,o.match_available=0,s.next_in=m,s.input=u,s.avail_in=f,o.wrap=l,Ms};var iD=QM,nD=DR,rD=MR,oD=NR,aD=ZM,lD=eD,cD=tD,uD=sD,hD="pako deflate (from Nodeca project)",Ul={deflateInit:iD,deflateInit2:nD,deflateReset:rD,deflateResetKeep:oD,deflateSetHeader:aD,deflate:lD,deflateEnd:cD,deflateSetDictionary:uD,deflateInfo:hD};const dD=(s,n)=>Object.prototype.hasOwnProperty.call(s,n);var _D=function(s){const n=Array.prototype.slice.call(arguments,1);for(;n.length;){const i=n.shift();if(i){if(typeof i!="object")throw new TypeError(i+"must be non-object");for(const o in i)dD(i,o)&&(s[o]=i[o])}}return s},pD=s=>{let n=0;for(let o=0,l=s.length;o<l;o++)n+=s[o].length;const i=new Uint8Array(n);for(let o=0,l=0,f=s.length;o<f;o++){let m=s[o];i.set(m,l),l+=m.length}return i},dh={assign:_D,flattenChunks:pD};let xR=true;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{xR=false}const Zl=new Uint8Array(256);for(let s=0;s<256;s++)Zl[s]=s>=252?6:s>=248?5:s>=240?4:s>=224?3:s>=192?2:1;Zl[254]=Zl[254]=1;var gD=s=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(s);let n,i,o,l,f,m=s.length,u=0;for(l=0;l<m;l++)i=s.charCodeAt(l),(i&64512)===55296&&l+1<m&&(o=s.charCodeAt(l+1),(o&64512)===56320&&(i=65536+(i-55296<<10)+(o-56320),l++)),u+=i<128?1:i<2048?2:i<65536?3:4;for(n=new Uint8Array(u),f=0,l=0;f<u;l++)i=s.charCodeAt(l),(i&64512)===55296&&l+1<m&&(o=s.charCodeAt(l+1),(o&64512)===56320&&(i=65536+(i-55296<<10)+(o-56320),l++)),i<128?n[f++]=i:i<2048?(n[f++]=192|i>>>6,n[f++]=128|i&63):i<65536?(n[f++]=224|i>>>12,n[f++]=128|i>>>6&63,n[f++]=128|i&63):(n[f++]=240|i>>>18,n[f++]=128|i>>>12&63,n[f++]=128|i>>>6&63,n[f++]=128|i&63);return n};const fD=(s,n)=>{if(n<65534&&s.subarray&&xR)return String.fromCharCode.apply(null,s.length===n?s:s.subarray(0,n));let i="";for(let o=0;o<n;o++)i+=String.fromCharCode(s[o]);return i};var mD=(s,n)=>{const i=n||s.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(s.subarray(0,n));let o,l;const f=new Array(i*2);for(l=0,o=0;o<i;){let m=s[o++];if(m<128){f[l++]=m;continue}let u=Zl[m];if(u>4){f[l++]=65533,o+=u-1;continue}for(m&=u===2?31:u===3?15:7;u>1&&o<i;)m=m<<6|s[o++]&63,u--;if(u>1){f[l++]=65533;continue}m<65536?f[l++]=m:(m-=65536,f[l++]=55296|m>>10&1023,f[l++]=56320|m&1023)}return fD(f,l)},ED=(s,n)=>{n=n||s.length,n>s.length&&(n=s.length);let i=n-1;for(;i>=0&&(s[i]&192)===128;)i--;return i<0||i===0?n:i+Zl[s[i]]>n?i:n},Ql={string2buf:gD,buf2string:mD,utf8border:ED};function vD(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var BR=vD;const PR=Object.prototype.toString,{Z_NO_FLUSH:bD,Z_SYNC_FLUSH:TD,Z_FULL_FLUSH:SD,Z_FINISH:$D,Z_OK:eh,Z_STREAM_END:yD,Z_DEFAULT_COMPRESSION:RD,Z_DEFAULT_STRATEGY:ID,Z_DEFLATED:CD}=uh;function _h(s){this.options=dh.assign({level:RD,method:CD,chunkSize:16384,windowBits:15,memLevel:8,strategy:ID},s||{});let n=this.options;n.raw&&n.windowBits>0?n.windowBits=-n.windowBits:n.gzip&&n.windowBits>0&&n.windowBits<16&&(n.windowBits+=16),this.err=0,this.msg="",this.ended=false,this.chunks=[],this.strm=new BR,this.strm.avail_out=0;let i=Ul.deflateInit2(this.strm,n.level,n.method,n.windowBits,n.memLevel,n.strategy);if(i!==eh)throw new Error(mo[i]);if(n.header&&Ul.deflateSetHeader(this.strm,n.header),n.dictionary){let o;if(typeof n.dictionary=="string"?o=Ql.string2buf(n.dictionary):PR.call(n.dictionary)==="[object ArrayBuffer]"?o=new Uint8Array(n.dictionary):o=n.dictionary,i=Ul.deflateSetDictionary(this.strm,o),i!==eh)throw new Error(mo[i]);this._dict_set=true}}_h.prototype.push=function(s,n){const i=this.strm,o=this.options.chunkSize;let l,f;if(this.ended)return false;for(n===~~n?f=n:f=n===true?$D:bD,typeof s=="string"?i.input=Ql.string2buf(s):PR.call(s)==="[object ArrayBuffer]"?i.input=new Uint8Array(s):i.input=s,i.next_in=0,i.avail_in=i.input.length;;){if(i.avail_out===0&&(i.output=new Uint8Array(o),i.next_out=0,i.avail_out=o),(f===TD||f===SD)&&i.avail_out<=6){this.onData(i.output.subarray(0,i.next_out)),i.avail_out=0;continue}if(l=Ul.deflate(i,f),l===yD)return i.next_out>0&&this.onData(i.output.subarray(0,i.next_out)),l=Ul.deflateEnd(this.strm),this.onEnd(l),this.ended=true,l===eh;if(i.avail_out===0){this.onData(i.output);continue}if(f>0&&i.next_out>0){this.onData(i.output.subarray(0,i.next_out)),i.avail_out=0;continue}if(i.avail_in===0)break}return true};_h.prototype.onData=function(s){this.chunks.push(s)};_h.prototype.onEnd=function(s){s===eh&&(this.result=dh.flattenChunks(this.chunks)),this.chunks=[],this.err=s,this.msg=this.strm.msg};function OD(s,n){const i=new _h(n);if(i.push(s,true),i.err)throw i.msg||mo[i.err];return i.result}function wD(s,n){return n=n||{},n.gzip=true,OD(s,n)}var kD=wD,AD={gzip:kD};const Au=16209,LD=16191;var ND=function(n,i){let o,l,f,m,u,_,c,h,p,T,$,S,y,g,E,v,b,R,O,w,L,I,k,x;const P=n.state;o=n.next_in,k=n.input,l=o+(n.avail_in-5),f=n.next_out,x=n.output,m=f-(i-n.avail_out),u=f+(n.avail_out-257),_=P.dmax,c=P.wsize,h=P.whave,p=P.wnext,T=P.window,$=P.hold,S=P.bits,y=P.lencode,g=P.distcode,E=(1<<P.lenbits)-1,v=(1<<P.distbits)-1;e:do{S<15&&($+=k[o++]<<S,S+=8,$+=k[o++]<<S,S+=8),b=y[$&E];t:for(;;){if(R=b>>>24,$>>>=R,S-=R,R=b>>>16&255,R===0)x[f++]=b&65535;else if(R&16){O=b&65535,R&=15,R&&(S<R&&($+=k[o++]<<S,S+=8),O+=$&(1<<R)-1,$>>>=R,S-=R),S<15&&($+=k[o++]<<S,S+=8,$+=k[o++]<<S,S+=8),b=g[$&v];s:for(;;){if(R=b>>>24,$>>>=R,S-=R,R=b>>>16&255,R&16){if(w=b&65535,R&=15,S<R&&($+=k[o++]<<S,S+=8,S<R&&($+=k[o++]<<S,S+=8)),w+=$&(1<<R)-1,w>_){n.msg="invalid distance too far back",P.mode=Au;break e}if($>>>=R,S-=R,R=f-m,w>R){if(R=w-R,R>h&&P.sane){n.msg="invalid distance too far back",P.mode=Au;break e}if(L=0,I=T,p===0){if(L+=c-R,R<O){O-=R;do x[f++]=T[L++];while(--R);L=f-w,I=x}}else if(p<R){if(L+=c+p-R,R-=p,R<O){O-=R;do x[f++]=T[L++];while(--R);if(L=0,p<O){R=p,O-=R;do x[f++]=T[L++];while(--R);L=f-w,I=x}}}else if(L+=p-R,R<O){O-=R;do x[f++]=T[L++];while(--R);L=f-w,I=x}for(;O>2;)x[f++]=I[L++],x[f++]=I[L++],x[f++]=I[L++],O-=3;O&&(x[f++]=I[L++],O>1&&(x[f++]=I[L++]))}else{L=f-w;do x[f++]=x[L++],x[f++]=x[L++],x[f++]=x[L++],O-=3;while(O>2);O&&(x[f++]=x[L++],O>1&&(x[f++]=x[L++]))}}else if(R&64){n.msg="invalid distance code",P.mode=Au;break e}else{b=g[(b&65535)+($&(1<<R)-1)];continue s}break}}else if(R&64)if(R&32){P.mode=LD;break e}else{n.msg="invalid literal/length code",P.mode=Au;break e}else{b=y[(b&65535)+($&(1<<R)-1)];continue t}break}}while(o<l&&f<u);O=S>>3,o-=O,S-=O<<3,$&=(1<<S)-1,n.next_in=o,n.next_out=f,n.avail_in=o<l?5+(l-o):5-(o-l),n.avail_out=f<u?257+(u-f):257-(f-u),P.hold=$,P.bits=S};const aa=15,jT=852,XT=592,KT=0,up=1,YT=2,MD=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),DD=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),xD=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),BD=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),PD=(s,n,i,o,l,f,m,u)=>{const _=u.bits;let c=0,h=0,p=0,T=0,$=0,S=0,y=0,g=0,E=0,v=0,b,R,O,w,L,I=null,k;const x=new Uint16Array(aa+1),P=new Uint16Array(aa+1);let F=null,X,W,z;for(c=0;c<=aa;c++)x[c]=0;for(h=0;h<o;h++)x[n[i+h]]++;for($=_,T=aa;T>=1&&x[T]===0;T--);if($>T&&($=T),T===0)return l[f++]=1<<24|64<<16|0,l[f++]=1<<24|64<<16|0,u.bits=1,0;for(p=1;p<T&&x[p]===0;p++);for($<p&&($=p),g=1,c=1;c<=aa;c++)if(g<<=1,g-=x[c],g<0)return-1;if(g>0&&(s===KT||T!==1))return-1;for(P[1]=0,c=1;c<aa;c++)P[c+1]=P[c]+x[c];for(h=0;h<o;h++)n[i+h]!==0&&(m[P[n[i+h]]++]=h);if(s===KT?(I=F=m,k=20):s===up?(I=MD,F=DD,k=257):(I=xD,F=BD,k=0),v=0,h=0,c=p,L=f,S=$,y=0,O=-1,E=1<<$,w=E-1,s===up&&E>jT||s===YT&&E>XT)return 1;for(;;){X=c-y,m[h]+1<k?(W=0,z=m[h]):m[h]>=k?(W=F[m[h]-k],z=I[m[h]-k]):(W=96,z=0),b=1<<c-y,R=1<<S,p=R;do R-=b,l[L+(v>>y)+R]=X<<24|W<<16|z|0;while(R!==0);for(b=1<<c-1;v&b;)b>>=1;if(b!==0?(v&=b-1,v+=b):v=0,h++,--x[c]===0){if(c===T)break;c=n[i+m[h]]}if(c>$&&(v&w)!==O){for(y===0&&(y=$),L+=p,S=c-y,g=1<<S;S+y<T&&(g-=x[S+y],!(g<=0));)S++,g<<=1;if(E+=1<<S,s===up&&E>jT||s===YT&&E>XT)return 1;O=v&w,l[O]=$<<24|S<<16|L-f|0}}return v!==0&&(l[L+v]=c-y<<24|64<<16|0),u.bits=$,0};var Fl=PD;const UD=0,UR=1,FR=2,{Z_FINISH:qT,Z_BLOCK:FD,Z_TREES:Lu,Z_OK:vo,Z_STREAM_END:GD,Z_NEED_DICT:HD,Z_STREAM_ERROR:ji,Z_DATA_ERROR:GR,Z_MEM_ERROR:HR,Z_BUF_ERROR:VD,Z_DEFLATED:JT}=uh,ph=16180,ZT=16181,QT=16182,eS=16183,tS=16184,sS=16185,iS=16186,nS=16187,rS=16188,oS=16189,th=16190,Yn=16191,hp=16192,aS=16193,dp=16194,lS=16195,cS=16196,uS=16197,hS=16198,Nu=16199,Mu=16200,dS=16201,_S=16202,pS=16203,gS=16204,fS=16205,_p=16206,mS=16207,ES=16208,Yt=16209,VR=16210,WR=16211,WD=852,zD=592,jD=15,XD=jD,vS=s=>(s>>>24&255)+(s>>>8&65280)+((s&65280)<<8)+((s&255)<<24);function KD(){this.strm=null,this.mode=0,this.last=false,this.wrap=0,this.havedict=false,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const So=s=>{if(!s)return 1;const n=s.state;return!n||n.strm!==s||n.mode<ph||n.mode>WR?1:0},zR=s=>{if(So(s))return ji;const n=s.state;return s.total_in=s.total_out=n.total=0,s.msg="",n.wrap&&(s.adler=n.wrap&1),n.mode=ph,n.last=0,n.havedict=0,n.flags=-1,n.dmax=32768,n.head=null,n.hold=0,n.bits=0,n.lencode=n.lendyn=new Int32Array(WD),n.distcode=n.distdyn=new Int32Array(zD),n.sane=1,n.back=-1,vo},jR=s=>{if(So(s))return ji;const n=s.state;return n.wsize=0,n.whave=0,n.wnext=0,zR(s)},XR=(s,n)=>{let i;if(So(s))return ji;const o=s.state;return n<0?(i=0,n=-n):(i=(n>>4)+5,n<48&&(n&=15)),n&&(n<8||n>15)?ji:(o.window!==null&&o.wbits!==n&&(o.window=null),o.wrap=i,o.wbits=n,jR(s))},KR=(s,n)=>{if(!s)return ji;const i=new KD;s.state=i,i.strm=s,i.window=null,i.mode=ph;const o=XR(s,n);return o!==vo&&(s.state=null),o},YD=s=>KR(s,XD);let bS=true,pp,gp;const qD=s=>{if(bS){pp=new Int32Array(512),gp=new Int32Array(32);let n=0;for(;n<144;)s.lens[n++]=8;for(;n<256;)s.lens[n++]=9;for(;n<280;)s.lens[n++]=7;for(;n<288;)s.lens[n++]=8;for(Fl(UR,s.lens,0,288,pp,0,s.work,{bits:9}),n=0;n<32;)s.lens[n++]=5;Fl(FR,s.lens,0,32,gp,0,s.work,{bits:5}),bS=false}s.lencode=pp,s.lenbits=9,s.distcode=gp,s.distbits=5},YR=(s,n,i,o)=>{let l;const f=s.state;return f.window===null&&(f.wsize=1<<f.wbits,f.wnext=0,f.whave=0,f.window=new Uint8Array(f.wsize)),o>=f.wsize?(f.window.set(n.subarray(i-f.wsize,i),0),f.wnext=0,f.whave=f.wsize):(l=f.wsize-f.wnext,l>o&&(l=o),f.window.set(n.subarray(i-o,i-o+l),f.wnext),o-=l,o?(f.window.set(n.subarray(i-o,i),0),f.wnext=o,f.whave=f.wsize):(f.wnext+=l,f.wnext===f.wsize&&(f.wnext=0),f.whave<f.wsize&&(f.whave+=l))),0},JD=(s,n)=>{let i,o,l,f,m,u,_,c,h,p,T,$,S,y,g=0,E,v,b,R,O,w,L,I;const k=new Uint8Array(4);let x,P;const F=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(So(s)||!s.output||!s.input&&s.avail_in!==0)return ji;i=s.state,i.mode===Yn&&(i.mode=hp),m=s.next_out,l=s.output,_=s.avail_out,f=s.next_in,o=s.input,u=s.avail_in,c=i.hold,h=i.bits,p=u,T=_,I=vo;e:for(;;)switch(i.mode){case ph:if(i.wrap===0){i.mode=hp;break}for(;h<16;){if(u===0)break e;u--,c+=o[f++]<<h,h+=8}if(i.wrap&2&&c===35615){i.wbits===0&&(i.wbits=15),i.check=0,k[0]=c&255,k[1]=c>>>8&255,i.check=ys(i.check,k,2,0),c=0,h=0,i.mode=ZT;break}if(i.head&&(i.head.done=false),!(i.wrap&1)||(((c&255)<<8)+(c>>8))%31){s.msg="incorrect header check",i.mode=Yt;break}if((c&15)!==JT){s.msg="unknown compression method",i.mode=Yt;break}if(c>>>=4,h-=4,L=(c&15)+8,i.wbits===0&&(i.wbits=L),L>15||L>i.wbits){s.msg="invalid window size",i.mode=Yt;break}i.dmax=1<<i.wbits,i.flags=0,s.adler=i.check=1,i.mode=c&512?oS:Yn,c=0,h=0;break;case ZT:for(;h<16;){if(u===0)break e;u--,c+=o[f++]<<h,h+=8}if(i.flags=c,(i.flags&255)!==JT){s.msg="unknown compression method",i.mode=Yt;break}if(i.flags&57344){s.msg="unknown header flags set",i.mode=Yt;break}i.head&&(i.head.text=c>>8&1),i.flags&512&&i.wrap&4&&(k[0]=c&255,k[1]=c>>>8&255,i.check=ys(i.check,k,2,0)),c=0,h=0,i.mode=QT;case QT:for(;h<32;){if(u===0)break e;u--,c+=o[f++]<<h,h+=8}i.head&&(i.head.time=c),i.flags&512&&i.wrap&4&&(k[0]=c&255,k[1]=c>>>8&255,k[2]=c>>>16&255,k[3]=c>>>24&255,i.check=ys(i.check,k,4,0)),c=0,h=0,i.mode=eS;case eS:for(;h<16;){if(u===0)break e;u--,c+=o[f++]<<h,h+=8}i.head&&(i.head.xflags=c&255,i.head.os=c>>8),i.flags&512&&i.wrap&4&&(k[0]=c&255,k[1]=c>>>8&255,i.check=ys(i.check,k,2,0)),c=0,h=0,i.mode=tS;case tS:if(i.flags&1024){for(;h<16;){if(u===0)break e;u--,c+=o[f++]<<h,h+=8}i.length=c,i.head&&(i.head.extra_len=c),i.flags&512&&i.wrap&4&&(k[0]=c&255,k[1]=c>>>8&255,i.check=ys(i.check,k,2,0)),c=0,h=0}else i.head&&(i.head.extra=null);i.mode=sS;case sS:if(i.flags&1024&&($=i.length,$>u&&($=u),$&&(i.head&&(L=i.head.extra_len-i.length,i.head.extra||(i.head.extra=new Uint8Array(i.head.extra_len)),i.head.extra.set(o.subarray(f,f+$),L)),i.flags&512&&i.wrap&4&&(i.check=ys(i.check,o,$,f)),u-=$,f+=$,i.length-=$),i.length))break e;i.length=0,i.mode=iS;case iS:if(i.flags&2048){if(u===0)break e;$=0;do L=o[f+$++],i.head&&L&&i.length<65536&&(i.head.name+=String.fromCharCode(L));while(L&&$<u);if(i.flags&512&&i.wrap&4&&(i.check=ys(i.check,o,$,f)),u-=$,f+=$,L)break e}else i.head&&(i.head.name=null);i.length=0,i.mode=nS;case nS:if(i.flags&4096){if(u===0)break e;$=0;do L=o[f+$++],i.head&&L&&i.length<65536&&(i.head.comment+=String.fromCharCode(L));while(L&&$<u);if(i.flags&512&&i.wrap&4&&(i.check=ys(i.check,o,$,f)),u-=$,f+=$,L)break e}else i.head&&(i.head.comment=null);i.mode=rS;case rS:if(i.flags&512){for(;h<16;){if(u===0)break e;u--,c+=o[f++]<<h,h+=8}if(i.wrap&4&&c!==(i.check&65535)){s.msg="header crc mismatch",i.mode=Yt;break}c=0,h=0}i.head&&(i.head.hcrc=i.flags>>9&1,i.head.done=true),s.adler=i.check=0,i.mode=Yn;break;case oS:for(;h<32;){if(u===0)break e;u--,c+=o[f++]<<h,h+=8}s.adler=i.check=vS(c),c=0,h=0,i.mode=th;case th:if(i.havedict===0)return s.next_out=m,s.avail_out=_,s.next_in=f,s.avail_in=u,i.hold=c,i.bits=h,HD;s.adler=i.check=1,i.mode=Yn;case Yn:if(n===FD||n===Lu)break e;case hp:if(i.last){c>>>=h&7,h-=h&7,i.mode=_p;break}for(;h<3;){if(u===0)break e;u--,c+=o[f++]<<h,h+=8}switch(i.last=c&1,c>>>=1,h-=1,c&3){case 0:i.mode=aS;break;case 1:if(qD(i),i.mode=Nu,n===Lu){c>>>=2,h-=2;break e}break;case 2:i.mode=cS;break;case 3:s.msg="invalid block type",i.mode=Yt}c>>>=2,h-=2;break;case aS:for(c>>>=h&7,h-=h&7;h<32;){if(u===0)break e;u--,c+=o[f++]<<h,h+=8}if((c&65535)!==(c>>>16^65535)){s.msg="invalid stored block lengths",i.mode=Yt;break}if(i.length=c&65535,c=0,h=0,i.mode=dp,n===Lu)break e;case dp:i.mode=lS;case lS:if($=i.length,$){if($>u&&($=u),$>_&&($=_),$===0)break e;l.set(o.subarray(f,f+$),m),u-=$,f+=$,_-=$,m+=$,i.length-=$;break}i.mode=Yn;break;case cS:for(;h<14;){if(u===0)break e;u--,c+=o[f++]<<h,h+=8}if(i.nlen=(c&31)+257,c>>>=5,h-=5,i.ndist=(c&31)+1,c>>>=5,h-=5,i.ncode=(c&15)+4,c>>>=4,h-=4,i.nlen>286||i.ndist>30){s.msg="too many length or distance symbols",i.mode=Yt;break}i.have=0,i.mode=uS;case uS:for(;i.have<i.ncode;){for(;h<3;){if(u===0)break e;u--,c+=o[f++]<<h,h+=8}i.lens[F[i.have++]]=c&7,c>>>=3,h-=3}for(;i.have<19;)i.lens[F[i.have++]]=0;if(i.lencode=i.lendyn,i.lenbits=7,x={bits:i.lenbits},I=Fl(UD,i.lens,0,19,i.lencode,0,i.work,x),i.lenbits=x.bits,I){s.msg="invalid code lengths set",i.mode=Yt;break}i.have=0,i.mode=hS;case hS:for(;i.have<i.nlen+i.ndist;){for(;g=i.lencode[c&(1<<i.lenbits)-1],E=g>>>24,v=g>>>16&255,b=g&65535,!(E<=h);){if(u===0)break e;u--,c+=o[f++]<<h,h+=8}if(b<16)c>>>=E,h-=E,i.lens[i.have++]=b;else{if(b===16){for(P=E+2;h<P;){if(u===0)break e;u--,c+=o[f++]<<h,h+=8}if(c>>>=E,h-=E,i.have===0){s.msg="invalid bit length repeat",i.mode=Yt;break}L=i.lens[i.have-1],$=3+(c&3),c>>>=2,h-=2}else if(b===17){for(P=E+3;h<P;){if(u===0)break e;u--,c+=o[f++]<<h,h+=8}c>>>=E,h-=E,L=0,$=3+(c&7),c>>>=3,h-=3}else{for(P=E+7;h<P;){if(u===0)break e;u--,c+=o[f++]<<h,h+=8}c>>>=E,h-=E,L=0,$=11+(c&127),c>>>=7,h-=7}if(i.have+$>i.nlen+i.ndist){s.msg="invalid bit length repeat",i.mode=Yt;break}for(;$--;)i.lens[i.have++]=L}}if(i.mode===Yt)break;if(i.lens[256]===0){s.msg="invalid code -- missing end-of-block",i.mode=Yt;break}if(i.lenbits=9,x={bits:i.lenbits},I=Fl(UR,i.lens,0,i.nlen,i.lencode,0,i.work,x),i.lenbits=x.bits,I){s.msg="invalid literal/lengths set",i.mode=Yt;break}if(i.distbits=6,i.distcode=i.distdyn,x={bits:i.distbits},I=Fl(FR,i.lens,i.nlen,i.ndist,i.distcode,0,i.work,x),i.distbits=x.bits,I){s.msg="invalid distances set",i.mode=Yt;break}if(i.mode=Nu,n===Lu)break e;case Nu:i.mode=Mu;case Mu:if(u>=6&&_>=258){s.next_out=m,s.avail_out=_,s.next_in=f,s.avail_in=u,i.hold=c,i.bits=h,ND(s,T),m=s.next_out,l=s.output,_=s.avail_out,f=s.next_in,o=s.input,u=s.avail_in,c=i.hold,h=i.bits,i.mode===Yn&&(i.back=-1);break}for(i.back=0;g=i.lencode[c&(1<<i.lenbits)-1],E=g>>>24,v=g>>>16&255,b=g&65535,!(E<=h);){if(u===0)break e;u--,c+=o[f++]<<h,h+=8}if(v&&!(v&240)){for(R=E,O=v,w=b;g=i.lencode[w+((c&(1<<R+O)-1)>>R)],E=g>>>24,v=g>>>16&255,b=g&65535,!(R+E<=h);){if(u===0)break e;u--,c+=o[f++]<<h,h+=8}c>>>=R,h-=R,i.back+=R}if(c>>>=E,h-=E,i.back+=E,i.length=b,v===0){i.mode=fS;break}if(v&32){i.back=-1,i.mode=Yn;break}if(v&64){s.msg="invalid literal/length code",i.mode=Yt;break}i.extra=v&15,i.mode=dS;case dS:if(i.extra){for(P=i.extra;h<P;){if(u===0)break e;u--,c+=o[f++]<<h,h+=8}i.length+=c&(1<<i.extra)-1,c>>>=i.extra,h-=i.extra,i.back+=i.extra}i.was=i.length,i.mode=_S;case _S:for(;g=i.distcode[c&(1<<i.distbits)-1],E=g>>>24,v=g>>>16&255,b=g&65535,!(E<=h);){if(u===0)break e;u--,c+=o[f++]<<h,h+=8}if(!(v&240)){for(R=E,O=v,w=b;g=i.distcode[w+((c&(1<<R+O)-1)>>R)],E=g>>>24,v=g>>>16&255,b=g&65535,!(R+E<=h);){if(u===0)break e;u--,c+=o[f++]<<h,h+=8}c>>>=R,h-=R,i.back+=R}if(c>>>=E,h-=E,i.back+=E,v&64){s.msg="invalid distance code",i.mode=Yt;break}i.offset=b,i.extra=v&15,i.mode=pS;case pS:if(i.extra){for(P=i.extra;h<P;){if(u===0)break e;u--,c+=o[f++]<<h,h+=8}i.offset+=c&(1<<i.extra)-1,c>>>=i.extra,h-=i.extra,i.back+=i.extra}if(i.offset>i.dmax){s.msg="invalid distance too far back",i.mode=Yt;break}i.mode=gS;case gS:if(_===0)break e;if($=T-_,i.offset>$){if($=i.offset-$,$>i.whave&&i.sane){s.msg="invalid distance too far back",i.mode=Yt;break}$>i.wnext?($-=i.wnext,S=i.wsize-$):S=i.wnext-$,$>i.length&&($=i.length),y=i.window}else y=l,S=m-i.offset,$=i.length;$>_&&($=_),_-=$,i.length-=$;do l[m++]=y[S++];while(--$);i.length===0&&(i.mode=Mu);break;case fS:if(_===0)break e;l[m++]=i.length,_--,i.mode=Mu;break;case _p:if(i.wrap){for(;h<32;){if(u===0)break e;u--,c|=o[f++]<<h,h+=8}if(T-=_,s.total_out+=T,i.total+=T,i.wrap&4&&T&&(s.adler=i.check=i.flags?ys(i.check,l,T,m-T):Jl(i.check,l,T,m-T)),T=_,i.wrap&4&&(i.flags?c:vS(c))!==i.check){s.msg="incorrect data check",i.mode=Yt;break}c=0,h=0}i.mode=mS;case mS:if(i.wrap&&i.flags){for(;h<32;){if(u===0)break e;u--,c+=o[f++]<<h,h+=8}if(i.wrap&4&&c!==(i.total&4294967295)){s.msg="incorrect length check",i.mode=Yt;break}c=0,h=0}i.mode=ES;case ES:I=GD;break e;case Yt:I=GR;break e;case VR:return HR;case WR:default:return ji}return s.next_out=m,s.avail_out=_,s.next_in=f,s.avail_in=u,i.hold=c,i.bits=h,(i.wsize||T!==s.avail_out&&i.mode<Yt&&(i.mode<_p||n!==qT))&&YR(s,s.output,s.next_out,T-s.avail_out),p-=s.avail_in,T-=s.avail_out,s.total_in+=p,s.total_out+=T,i.total+=T,i.wrap&4&&T&&(s.adler=i.check=i.flags?ys(i.check,l,T,s.next_out-T):Jl(i.check,l,T,s.next_out-T)),s.data_type=i.bits+(i.last?64:0)+(i.mode===Yn?128:0)+(i.mode===Nu||i.mode===dp?256:0),(p===0&&T===0||n===qT)&&I===vo&&(I=VD),I},ZD=s=>{if(So(s))return ji;let n=s.state;return n.window&&(n.window=null),s.state=null,vo},QD=(s,n)=>{if(So(s))return ji;const i=s.state;return i.wrap&2?(i.head=n,n.done=false,vo):ji},e1=(s,n)=>{const i=n.length;let o,l,f;return So(s)||(o=s.state,o.wrap!==0&&o.mode!==th)?ji:o.mode===th&&(l=1,l=Jl(l,n,i,0),l!==o.check)?GR:(f=YR(s,n,i,i),f?(o.mode=VR,HR):(o.havedict=1,vo))};var t1=jR,s1=XR,i1=zR,n1=YD,r1=KR,o1=JD,a1=ZD,l1=QD,c1=e1,u1="pako inflate (from Nodeca project)",Jn={inflateReset:t1,inflateReset2:s1,inflateResetKeep:i1,inflateInit:n1,inflateInit2:r1,inflate:o1,inflateEnd:a1,inflateGetHeader:l1,inflateSetDictionary:c1,inflateInfo:u1};function h1(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=false}var d1=h1;const qR=Object.prototype.toString,{Z_NO_FLUSH:_1,Z_FINISH:p1,Z_OK:ec,Z_STREAM_END:fp,Z_NEED_DICT:mp,Z_STREAM_ERROR:g1,Z_DATA_ERROR:TS,Z_MEM_ERROR:f1}=uh;function gh(s){this.options=dh.assign({chunkSize:1024*64,windowBits:15,to:""},s||{});const n=this.options;n.raw&&n.windowBits>=0&&n.windowBits<16&&(n.windowBits=-n.windowBits,n.windowBits===0&&(n.windowBits=-15)),n.windowBits>=0&&n.windowBits<16&&!(s&&s.windowBits)&&(n.windowBits+=32),n.windowBits>15&&n.windowBits<48&&(n.windowBits&15||(n.windowBits|=15)),this.err=0,this.msg="",this.ended=false,this.chunks=[],this.strm=new BR,this.strm.avail_out=0;let i=Jn.inflateInit2(this.strm,n.windowBits);if(i!==ec)throw new Error(mo[i]);if(this.header=new d1,Jn.inflateGetHeader(this.strm,this.header),n.dictionary&&(typeof n.dictionary=="string"?n.dictionary=Ql.string2buf(n.dictionary):qR.call(n.dictionary)==="[object ArrayBuffer]"&&(n.dictionary=new Uint8Array(n.dictionary)),n.raw&&(i=Jn.inflateSetDictionary(this.strm,n.dictionary),i!==ec)))throw new Error(mo[i])}gh.prototype.push=function(s,n){const i=this.strm,o=this.options.chunkSize,l=this.options.dictionary;let f,m,u;if(this.ended)return false;for(n===~~n?m=n:m=n===true?p1:_1,qR.call(s)==="[object ArrayBuffer]"?i.input=new Uint8Array(s):i.input=s,i.next_in=0,i.avail_in=i.input.length;;){for(i.avail_out===0&&(i.output=new Uint8Array(o),i.next_out=0,i.avail_out=o),f=Jn.inflate(i,m),f===mp&&l&&(f=Jn.inflateSetDictionary(i,l),f===ec?f=Jn.inflate(i,m):f===TS&&(f=mp));i.avail_in>0&&f===fp&&i.state.wrap>0&&s[i.next_in]!==0;)Jn.inflateReset(i),f=Jn.inflate(i,m);switch(f){case g1:case TS:case mp:case f1:return this.onEnd(f),this.ended=true,false}if(u=i.avail_out,i.next_out&&(i.avail_out===0||f===fp))if(this.options.to==="string"){let _=Ql.utf8border(i.output,i.next_out),c=i.next_out-_,h=Ql.buf2string(i.output,_);i.next_out=c,i.avail_out=o-c,c&&i.output.set(i.output.subarray(_,_+c),0),this.onData(h)}else this.onData(i.output.length===i.next_out?i.output:i.output.subarray(0,i.next_out));if(!(f===ec&&u===0)){if(f===fp)return f=Jn.inflateEnd(this.strm),this.onEnd(f),this.ended=true,true;if(i.avail_in===0)break}}return true};gh.prototype.onData=function(s){this.chunks.push(s)};gh.prototype.onEnd=function(s){s===ec&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=dh.flattenChunks(this.chunks)),this.chunks=[],this.err=s,this.msg=this.strm.msg};function m1(s,n){const i=new gh(n);if(i.push(s),i.err)throw i.msg||mo[i.err];return i.result}var E1=m1,v1={ungzip:E1};const{gzip:b1}=AD,{ungzip:T1}=v1;var S1=b1,$1=T1;function y1(s){let n=new Uint8Array(s.length);for(let i=0;i<s.length;i++)n[i]=s.charCodeAt(i);return n.buffer}const R1=`{
  "name": "koishi-plugin-blockly-null",
  "description": "Use blockly to develop a simple koishi plugin",
  "version": "1.2.14",
  "main": "lib/index.js",
  "typings": "lib/index.d.ts",
  "repository": {
    "type": "git",
    "url": "https://github.com/yexiaoquan/koishi-plugin-blockly-null"
  },
  "homepage": "https://blockly.koishi.chat",
  "files": [
    "lib",
    "dist",
    "media"
  ],
  "license": "AGPL-3.0",
  "scripts": {
    "docs:dev": "vitepress dev docs --open",
    "docs:build": "vitepress build docs",
    "docs:serve": "vitepress serve docs",
    "test": "yakumo mocha -r esbuild-register -r yml-register --exit"
  },
  "keywords": [
    "chatbot",
    "koishi",
    "plugin",
    "blockly",
    "lowcode",
    "program",
    "develop",
    "flowgraph",
    "dataflow",
    "visualization"
  ],
  "koishi": {
    "browser": true,
    "public": [
      "dist"
    ],
    "description": {
      "zh": "Blockly的fork版,多了一些奇怪的块"
    },
    "service": {
      "required": [
        "database",
        "console",
        "puppeteer"
      ]
    }
  },
  "peerDependencies": {
    "@koishijs/plugin-console": "^5.7.7",
    "koishi": "^4.12.8"
  },
  "devDependencies": {
    "@baklavajs/themes": "^2.0.1-next.0",
    "@highlightjs/vue-plugin": "^2.1.2",
    "@koishijs/client": "^5.7.6",
    "@koishijs/plugin-console": "^5.7.6",
    "@koishijs/vitepress": "^1.9.5",
    "@mit-app-inventor/blockly-block-lexical-variables": "^0.0.13",
    "@types/node": "^18.16.8",
    "@types/pako": "^2.0.0",
    "@types/semver": "^7.5.0",
    "@types/uuid": "^9.0.1",
    "baklavajs": "2.0.2-beta.3",
    "blockly": "9.2.1",
    "chai": "^4.3.7",
    "element-plus": "^2.3.4",
    "highlight.js": "^11.8.0",
    "koishi": "^4.11.6",
    "mocha": "^10.2.0",
    "pako": "^2.1.0",
    "sass": "^1.62.1",
    "semver": "^7.5.0",
    "typescript": "^4.9.5",
    "uuid": "^9.0.0",
    "vitepress": "1.0.0-alpha.26",
    "xterm": "^5.1.0",
    "yakumo-mocha": "^0.3.1"
  },
  "dependencies": {
    "jsonpath-plus": "^7.2.0",
    "uuid": "^9.0.0"
  }
}
`,I1=JSON.parse(R1),JR=1,wf=I1.version??"0.0.0";function C1(s,n,i){const l=encodeURI(JSON.stringify({version:JR,plugin_version:wf,vendors:[],body:i,name:s,uuid:n})),f=btoa(String.fromCharCode.apply(null,S1(l)));let m=`插件名称: ${s}
`;return m+=`导出时间: ${new Date().toLocaleString()}
`,m+=`-=-=-=-=--=-=-=-=- BEGIN KOISHI BLOCKLY BLOCK V1 -=-=--=-=-=--=-=--=-=-=-
`,m+=`${f.replace(/(.{64})/g,`$1
`)}
`,m+=`-=-=--=-=-=--=-=-=-=- END KOISHI BLOCKLY BLOCK V1 -=-=--=-=-=--=-=--=-=-=-
`,m.replace(`

`,`
`)}function O1(s){var l;const n=(l=s.match(/[=–-]+\s+BEGIN KOISHI BLOCKLY BLOCK V1\s+[=–-]+\n([\s\S]+)\n[=–-]+\s+END KOISHI BLOCKLY BLOCK V1\s+[=–-]+/))==null?void 0:l[1].replace(/[\r\n\t ]/g,"");if(!n)return null;const i=$1(y1(atob(n)),{to:"string"});if(!i)return null;const o=JSON.parse(decodeURI(i));return o||null}const w1=`export const name = "{{name}}"
export async function apply(ctx){
{{apply}}
}
`;var Ep={exports:{}},vp={exports:{}},bp={exports:{}},Tp={exports:{}},SS;function hm(){return SS||(SS=1,function(s,n){(function(i,o){s.exports=o()})(Ni,function(){var i={},o=function(e,t,r,a){e=e+" was deprecated in "+t+" and will be deleted in "+r+".",a&&(e+=`
Use `+a+" instead."),console.warn(e)},l=function(e,t){f(),Pc=setTimeout(function(){t&&t.handleRightClick(e)},h0)},f=function(){Pc&&(clearTimeout(Pc),Pc=0)},m=function(){Bc=null},u=function(e){return!e.type.startsWith("pointer")||e instanceof PointerEvent&&c(e)},_=function(e){return`${e.pointerId}`},c=function(e){const t=_(e);return Bc?Bc===t:e.type==="pointerdown"?(Bc=t,true):false},h=function(e){if(o("setClientFromTouch()","version 9","version 10"),e.type.startsWith("touch")&&e.changedTouches){const t=e.changedTouches[0];e.clientX=t.clientX,e.clientY=t.clientY}},p=function(e){return o("isMouseOrTouchEvent()","version 9","version 10"),e.type.startsWith("touch")||e.type.startsWith("mouse")||e.type.startsWith("pointer")},T=function(e){return o("isTouchEvent()","version 9","version 10"),e.type.startsWith("touch")||e.type.startsWith("pointer")},$=function(e){o("splitEventByTouches()","version 9","version 10");const t=[];if(e.changedTouches)for(let r=0;r<e.changedTouches.length;r++)t[r]={type:e.type,changedTouches:[e.changedTouches[r]],target:e.target,stopPropagation(){e.stopPropagation()},preventDefault(){e.preventDefault()}};else t.push(e);return t},S=function(e,t,r,a,d,C){function D(Y){(d||u(Y))&&(r?a.call(r,Y):a(Y))}if(C!==void 0&&o("The opt_noPreventDefault argument of conditionalBind","version 9","version 10"),C=[],t in Vr)for(let Y=0;Y<Vr[t].length;Y++){const pe=Vr[t][Y];e.addEventListener(pe,D,false),C.push([e,pe,D])}else e.addEventListener(t,D,false),C.push([e,t,D]);return C},y=function(e,t,r,a){function d(D){r?a.call(r,D):a(D)}const C=[];if(t in Vr)for(let D=0;D<Vr[t].length;D++){const Y=Vr[t][D];e.addEventListener(Y,d,false),C.push([e,Y,d])}else e.addEventListener(t,d,false),C.push([e,t,d]);return C},g=function(e){const t=e[e.length-1][2];for(;e.length;){const r=e.pop();r[0].removeEventListener(r[1],r[2],false)}return t},E=function(e){if(e.target instanceof HTMLElement){if(e.target.isContentEditable||e.target.getAttribute("data-is-text-input")==="true")return true;if(e.target instanceof HTMLInputElement)return e=e.target,e.type==="text"||e.type==="number"||e.type==="email"||e.type==="password"||e.type==="search"||e.type==="tel"||e.type==="url";if(e.target instanceof HTMLTextAreaElement)return true}return false},v=function(e){return e.ctrlKey&&pd?true:e.button===2},b=function(e,t,r){const a=t.createSVGPoint();return a.x=e.clientX,a.y=e.clientY,r||(r=t.getScreenCTM().inverse()),a.matrixTransform(r)},R=function(e){switch(e.deltaMode){default:return{x:e.deltaX,y:e.deltaY};case 1:return{x:e.deltaX*hv,y:e.deltaY*hv};case 2:return{x:e.deltaX*dv,y:e.deltaY*dv}}},O=function(e){return No[e]||null},w=function(){const e=[];for(const t in No)e.push(No[t]);return e},L=function(e){No[e.id]=e},I=function(e){delete No[e.id]},k=function(){return _v},x=function(e){_v=e},P=function(){return fd},F=function(e){fd=e},X=function(){return pv},W=function(e){pv=e},z=function(e){for(;e.options.parentWorkspace;)e=e.options.parentWorkspace;const t=e.getParentSvg(),r=e.getCachedParentSvgSize();var a=t.parentElement;if(a instanceof HTMLElement){var d=a.offsetWidth;a=a.offsetHeight,r.width!==d&&(t.setAttribute("width",d+"px"),e.setCachedParentSvgSize(d,null)),r.height!==a&&(t.setAttribute("height",a+"px"),e.setCachedParentSvgSize(null,a)),e.resize()}},j=function(e,t){const r=Object.create(null),a=e.getDescendants(true);t&&(e=e.getNextBlock())&&(e=a.indexOf(e),a.splice(e,a.length-e));for(let d=0,C;C=a[d];d++)r[C.type]?r[C.type]++:r[C.type]=1;return r},J=function(e){return function(){this.jsonInit(e)}},M=function(e){md.defineBlocksWithJsonArrayInternal(e)},U=function(e){K(V(e))},V=function(e){const t={};for(let r=0;r<e.length;r++){const a=e[r];if(!a){console.warn(`Block definition #${r} in JSON array is ${a}. Skipping`);continue}const d=a.type;d?t[d]={init:J(a)}:console.warn(`Block definition #${r} in JSON array is missing a type attribute. Skipping.`)}return t},K=function(e){for(const t of Object.keys(e)){const r=e[t];t in oi&&console.warn(`Block definiton "${t}" overwrites previous definition.`),oi[t]=r}},H=function(e,t,r){e=document.createElementNS(Mo,String(e));for(const a in t)e.setAttribute(a,`${t[a]}`);return r&&r.appendChild(e),e},ie=function(e,t){return t=t.split(" "),t.every(r=>e.classList.contains(r))?false:(e.classList.add(...t),true)},Ie=function(e,t){e.classList.remove(...t.split(" "))},he=function(e,t){return t=t.split(" "),t.every(r=>!e.classList.contains(r))?false:(e.classList.remove(...t),true)},st=function(e,t){return e.classList.contains(t)},B=function(e){return e&&e.parentNode?e.parentNode.removeChild(e):null},te=function(e,t){const r=t.nextSibling;if(t=t.parentNode,!t)throw Error("Reference node has no parent.");r?t.insertBefore(e,r):t.appendChild(e)},le=function(e,t){return!!(e.compareDocumentPosition(t)&bn.DOCUMENT_POSITION_CONTAINED_BY)},ae=function(e,t){e.style.transform=t,e.style["-webkit-transform"]=t},Me=function(){Ed++,Qi||(Qi=Object.create(null))},Se=function(){Ed--,Ed||(Qi=null)},nt=function(e){const t=e.textContent+`
`+e.className.baseVal;let r;if(Qi&&(r=Qi[t]))return r;try{r=e.getComputedTextLength()}catch{return 8*e.textContent.length}return Qi&&(Qi[t]=r),r},St=function(e,t,r,a){return Ut(e,t+"pt",r,a)},Ut=function(e,t,r,a){const d=e.textContent;e=d+`
`+e.className.baseVal;var C;return Qi&&(C=Qi[e])||(Hc||(C=document.createElement("canvas"),C.className="blocklyComputeCanvas",document.body.appendChild(C),Hc=C.getContext("2d")),Hc.font=r+" "+t+" "+a,C=d?Hc.measureText(d).width:0,Qi&&(Qi[e]=C)),C},Jt=function(e,t,r,a){const d=document.createElement("span");d.style.font=r+" "+t+" "+a,d.textContent=e,e=document.createElement("div"),e.style.width="1px",e.style.height="0",t=document.createElement("div"),t.setAttribute("style","position: fixed; top: 0; left: 0; display: flex;"),t.appendChild(d),t.appendChild(e),document.body.appendChild(t),r={height:0,baseline:0};try{t.style.alignItems="baseline",r.baseline=e.offsetTop-d.offsetTop,t.style.alignItems="flex-end",r.height=e.offsetTop-d.offsetTop}finally{document.body.removeChild(t)}return r},We=function(e){return e*Math.PI/180},Is=function(e){return 180*e/Math.PI},Cs=function(e,t,r){if(r<e){const a=r;r=e,e=a}return Math.max(e,Math.min(t,r))},Os=function(e){return gv.getSizeInternal(e)},xs=function(e){if(At(e,"display")!=="none")return Ws(e);const t=e.style,r=t.display,a=t.visibility,d=t.position;t.visibility="hidden",t.position="absolute",t.display="inline";const C=e.offsetWidth;return e=e.offsetHeight,t.display=r,t.position=d,t.visibility=a,new Ss(C,e)},Ws=function(e){return new Ss(e.offsetWidth,e.offsetHeight)},At=function(e,t){return e=window.getComputedStyle(e),e[t]||e.getPropertyValue(t)},be=function(e,t){return o("Blockly.utils.style.getCascadedStyle","version 9","version 10"),e.currentStyle?e.currentStyle[t]:""},qe=function(e){const t=new Oe(0,0);e=e.getBoundingClientRect();var r=document.documentElement;return r=new Oe(window.pageXOffset||r.scrollLeft,window.pageYOffset||r.scrollTop),t.x=e.left+r.x,t.y=e.top+r.y,t},ut=function(){const e=document.body,t=document.documentElement;return new Oe(e.scrollLeft||t.scrollLeft,e.scrollTop||t.scrollTop)},jt=function(e){const t=parseFloat(At(e,"borderLeftWidth")),r=parseFloat(At(e,"borderRightWidth")),a=parseFloat(At(e,"borderTopWidth"));return e=parseFloat(At(e,"borderBottomWidth")),new ts(a,e,t,r)},Ee=function(e,t,r){e=fi(e,t,r),t.scrollLeft=e.x,t.scrollTop=e.y},fi=function(e,t,r){var a=qe(e),d=qe(t),C=jt(t);const D=a.x-d.x-C.left;return a=a.y-d.y-C.top,d=Ws(e),e=t.clientWidth-d.width,d=t.clientHeight-d.height,C=t.scrollLeft,t=t.scrollTop,r?(C+=D-e/2,t+=a-d/2):(C+=Math.min(D,Math.max(D-e,0)),t+=Math.min(a,Math.max(a-d,0))),new Oe(C,t)},fs=function(){yt||(yt=document.createElement("div"),yt.className="blocklyDropDownDiv",(X()||document.body).appendChild(yt),Bo=document.createElement("div"),Bo.className="blocklyDropDownContent",yt.appendChild(Bo),jr=document.createElement("div"),jr.className="blocklyDropDownArrow",yt.appendChild(jr),yt.style.opacity="0",yt.style.transition="transform "+zc+"s, opacity "+zc+"s",yt.addEventListener("focusin",function(){ie(yt,"blocklyFocused")}),yt.addEventListener("focusout",function(){he(yt,"blocklyFocused")}))},ws=function(e){Td=e},Ot=function(){return ur},xi=function(){return Bo},as=function(){Bo.textContent="",Bo.style.width=""},N=function(e,t){yt.style.backgroundColor=e,yt.style.borderColor=t},G=function(e,t,r,a){return Ue(oe(t),e,r,a)},Z=function(e,t,r){return Ev=true,Ue(ce(e),e,t,r)},oe=function(e){var t=e.getSvgRoot();const r=e.workspace.scale,a=e.height*r;return e=e.width*r,t=qe(t),new ts(t.y,t.y+a,t.x,t.x+e)},ce=function(e){return e=e.getScaledBBox(),new ts(e.top,e.bottom,e.left,e.right)},Ue=function(e,t,r,a){const d=e.left+(e.right-e.left)/2,C=e.bottom;e=e.top,a&&(e+=a),a=t.getSourceBlock();let D=a.workspace;for(;D.options.parentWorkspace;)D=D.options.parentWorkspace;return ws(D.getParentSvg().parentNode),ti(t,a.RTL,d,C,d,e,r)},ti=function(e,t,r,a,d,C,D){return ur=e,zr=D||null,yt.style.direction=t?"rtl":"ltr",e=k(),Do=e.getRenderer().getClassName(),xo=e.getTheme().getClassName(),Do&&ie(yt,Do),xo&&ie(yt,xo),Ge(r,a,d,C)},Yi=function(e,t,r,a){return e=fe(e,r.left,r.right,a.width),{initialX:e.divX,initialY:t,finalX:e.divX,finalY:t+vd,arrowX:e.arrowX,arrowY:-9,arrowAtTop:true,arrowVisible:true}},qi=function(e,t,r,a){return e=fe(e,r.left,r.right,a.width),{initialX:e.divX,initialY:t-a.height,finalX:e.divX,finalY:t-a.height-vd,arrowX:e.arrowX,arrowY:a.height-2*fv-Wc/2,arrowAtTop:false,arrowVisible:true}},q=function(e,t,r){return e=fe(e,t.left,t.right,r.width),{initialX:e.divX,initialY:0,finalX:e.divX,finalY:0,arrowAtTop:null,arrowX:null,arrowY:null,arrowVisible:false}},fe=function(e,t,r,a){return t=Cs(t,e-a/2,r-a),e=e-Wc/2-t,r=mv,e=Cs(r,e,a-r-Wc),{arrowX:e,divX:t}},ke=function(){return!!ur},et=function(e,t){return ur===e?(t?Lt():Ht(),true):false},Ht=function(){yt.style.transform="translate(0, 0)",yt.style.opacity="0",bd=setTimeout(function(){Lt()},1e3*zc),zr&&(zr(),zr=null)},Lt=function(){ke()&&(bd&&clearTimeout(bd),yt.style.transform="",yt.style.left="",yt.style.top="",yt.style.opacity="0",yt.style.display="none",yt.style.backgroundColor="",yt.style.borderColor="",zr&&(zr(),zr=null),as(),ur=null,Do&&(he(yt,Do),Do=""),xo&&(he(yt,xo),xo=""),k().markFocused())},Ge=function(e,t,r,a){e=Sd.getPositionMetrics(e,t,r,a),e.arrowVisible?(jr.style.display="",jr.style.transform="translate("+e.arrowX+"px,"+e.arrowY+"px) rotate(45deg)",jr.setAttribute("class",e.arrowAtTop?"blocklyDropDownArrow blocklyArrowTop":"blocklyDropDownArrow blocklyArrowBottom")):jr.style.display="none",t=Math.floor(e.initialX),r=Math.floor(e.initialY),a=Math.floor(e.finalX);const d=Math.floor(e.finalY);return yt.style.left=t+"px",yt.style.top=r+"px",yt.style.display="block",yt.style.opacity="1",yt.style.transform="translate("+(a-t)+"px,"+(d-r)+"px)",!!e.arrowAtTop},Be=function(){if(ur){var e=ur.getSourceBlock();e=Ev?ce(ur):oe(e);const t=e.left+(e.right-e.left)/2;Ge(t,e.bottom,t,e.top)}else Ht()},$e=function(e,t,r,a){if(!(e instanceof Te)&&typeof e!="string"||String(e).trim()==="")throw Error('Invalid type "'+e+'". The type must be a non-empty string or a Blockly.registry.Type.');if(e=String(e).toLowerCase(),typeof t!="string"||t.trim()==="")throw Error('Invalid name "'+t+'". The name must be a non-empty string.');const d=t.toLowerCase();if(!r)throw Error("Can not register a null value");let C=hr[e],D=jc[e];if(C||(C=hr[e]=Object.create(null),D=jc[e]=Object.create(null)),_s(e,r),!a&&C[d])throw Error('Name "'+d+'" with type "'+e+'" already registered.');C[d]=r,D[d]=t},_s=function(e,t){switch(e){case String(Te.FIELD):if(typeof t.fromJson!="function")throw Error('Type "'+e+'" must have a fromJson function')}},Vt=function(e,t){e=String(e).toLowerCase(),t=t.toLowerCase();const r=hr[e];r&&r[t]?(delete hr[e][t],delete jc[e][t]):console.warn("Unable to unregister ["+t+"]["+e+"] from the registry.")},or=function(e,t,r){e=String(e).toLowerCase(),t=t.toLowerCase();const a=hr[e];if(!a||!a[t]){if(t="Unable to find ["+t+"]["+e+"] in the registry.",r)throw Error(t+" You must require or register a "+e+" plugin.");return console.warn(t),null}return a[t]},$o=function(e,t){return e=String(e).toLowerCase(),t=t.toLowerCase(),(e=hr[e])?!!e[t]:false},pn=function(e,t,r){return or(e,t,r)},yo=function(e,t,r){return or(e,t,r)},Mr=function(e,t,r){e=String(e).toLowerCase();var a=hr[e];if(!a){if(a=`Unable to find [${e}] in the registry.`,r)throw Error(`${a} You must require or register a ${e} plugin.`);return console.warn(a),null}if(!t)return a;e=jc[e],r=Object.create(null),t=Object.keys(a);for(let d=0;d<t.length;d++){const C=t[d];r[e[C]]=a[C]}return r},si=function(e,t,r){return t=t.plugins[e.toString()]||Un,typeof t=="function"?t:pn(e,t,r)},Dr=function(){return"blockly-"+(p0++).toString(36)},mi=function(){return bv.genUid()},Bs=function(e){Ga=e},Ps=function(){return Ga},Pe=function(e){Rd.fireInternal(e)},Ih=function(e){ls()&&(Ho.length||setTimeout(fc,0),Ho.push(e))},fc=function(){const e=Ei(Ho,true);Ho.length=0;for(let t=0,r;r=e[t];t++){if(!r.workspaceId)continue;const a=O(r.workspaceId);a&&a.fireChangeListener(r)}},Ei=function(e,t){e=e.slice(),t||e.reverse();const r=[],a=Object.create(null);for(let D=0,Y;Y=e[D];D++)if(!Y.isNull()){var d=[Y.isUiEvent?Va:Y.type,Y.blockId,Y.workspaceId].join(" "),C=a[d];const pe=C?C.event:null;C?Y.type===js&&C.index===D-1?(d=Y,pe.newParentId=d.newParentId,pe.newInputName=d.newInputName,pe.newCoordinate=d.newCoordinate,C.index=D):Y.type===bs&&Y.element===pe.element&&Y.name===pe.name?pe.newValue=Y.newValue:Y.type===Kr?(C=Y,pe.viewTop=C.viewTop,pe.viewLeft=C.viewLeft,pe.scale=C.scale,pe.oldScale=C.oldScale):(Y.type!==_r||pe.type!==Fn)&&(a[d]={event:Y,index:D},r.push(Y)):(a[d]={event:Y,index:D},r.push(Y))}e=r.filter(function(D){return!D.isNull()}),t||e.reverse();for(let D=1,Y;Y=e[D];D++)Y.type===bs&&Y.element==="mutation"&&e.unshift(e.splice(D,1)[0]);return e},Ro=function(){for(let e=0,t;t=Ho[e];e++)t.recordUndo=false},Zt=function(){$d++},ss=function(){$d--},ls=function(){return $d===0},Ft=function(){return Tv},He=function(e){Rd.setGroupInternal(e)},Ch=function(e){Tv=typeof e=="boolean"?e?mi():"":e},ye=function(e){const t=[];e=e.getDescendants(false);for(let r=0,a;a=e[r];r++)t[r]=a.id;return t},Xe=function(e,t){var r=Re(e.type);if(!r)throw Error("Unknown event type.");return ft(r)?r.fromJson(e,t):(r=new r,r.fromJson(e),r.workspaceId=t.id,r)},ft=function(e){return Object.getOwnPropertyDescriptors(e).fromJson&&typeof e.fromJson=="function"},Re=function(e){const t=pn(Te.EVENT,e);if(!t)throw Error(`Event type ${e} not found in registry.`);return t},Qt=function(e){if((e.type===js||e.type===ks)&&e.workspaceId){var t=O(e.workspaceId);if(!e.blockId)throw Error("Encountered a blockEvent without a proper blockId");if(e=t.getBlockById(e.blockId)){const r=Ga;try{Ga=false;const a=e.getParent();if(a&&a.isEnabled()){const d=e.getDescendants(false);for(let C=0,D;D=d[C];C++)D.setEnabled(true)}else if((e.outputConnection||e.previousConnection)&&!t.isDragging())do e.setEnabled(false),e=e.getNextBlock();while(e)}finally{Ga=r}}}},vi=function(e){({document:qr=qr,DOMParser:tu=tu,XMLSerializer:su=su}=e)},gn=function(){return o("Blockly.utils.xml.getDocument","version 9","version 10"),qr},Io=function(e){o("Blockly.utils.xml.setDocument","version 9","version 10"),qr=e},ot=function(e){return qr.createElementNS(Id,e)},ms=function(e){return qr.createTextNode(e)},ka=function(e){return new tu().parseFromString(e,"text/xml")},Aa=function(e){return new su().serializeToString(e)},xr=function(e,t){Sv(e,t)},Oh=function(e){Sv=e},La=function(e,t){Rv.confirmInternal(e,t)},wh=function(e,t){$v(e,t)},kh=function(e){$v=e},ar=function(e,t,r){yv(e,t,r)},mc=function(e){yv=e},ii=function(e){e=e.getAllBlocks(false);const t=new Set;for(let r=0;r<e.length;r++){const a=e[r].getVarModels();if(a)for(let d=0;d<a.length;d++){const C=a[d];C.getId()&&t.add(C)}}return Array.from(t.values())},Ah=function(e){e=e.getAllBlocks(false);const t=new Set;for(let a=0,d;d=e[a];a++){var r=d.getDeveloperVariables;if(r){r=r();for(let C=0;C<r.length;C++)t.add(r[C])}}return Array.from(t.values())},Br=function(e){let t=[];const r=document.createElement("button");return r.setAttribute("text","%{BKY_NEW_VARIABLE}"),r.setAttribute("callbackKey","CREATE_VARIABLE"),e.registerButtonCallback("CREATE_VARIABLE",function(a){fn(a.getTargetWorkspace())}),t.push(r),e=at(e),t=t.concat(e)},at=function(e){e=e.getVariablesOfType("");const t=[];if(0<e.length){var r=e[e.length-1];if(oi.variables_set){var a=ot("block");a.setAttribute("type","variables_set"),a.setAttribute("gap",oi.math_change?"8":"24"),a.appendChild(Fe(r)),t.push(a)}if(oi.math_change&&(a=ot("block"),a.setAttribute("type","math_change"),a.setAttribute("gap",oi.variables_get?"20":"8"),a.appendChild(Fe(r)),r=zs('<value name="DELTA"><shadow type="math_number"><field name="NUM">1</field></shadow></value>'),a.appendChild(r),t.push(a)),oi.variables_get){e.sort(Ja.compareByName);for(let d=0,C;C=e[d];d++)r=ot("block"),r.setAttribute("type","variables_get"),r.setAttribute("gap","8"),r.appendChild(Fe(C)),t.push(r)}}return t},Na=function(e){return wd.generateUniqueNameInternal(e)},Es=function(e){return Mt(nu.charAt(0),e.getAllVariableNames())},Mt=function(e,t){if(!t.length)return e;const r=nu;let a="",d=r.indexOf(e);for(;;){let C=false;for(let D=0;D<t.length;D++)if(t[D].toLowerCase()===e){C=true;break}if(!C)break;d++,d===r.length&&(d=0,a=`${Number(a)+1}`),e=r.charAt(d)+a}return e},fn=function(e,t,r){function a(C){Pr(Je.NEW_VARIABLE_TITLE,C,function(D){if(D){const Y=Ae(D,e);if(Y){let pe;Y.type===d?pe=Je.VARIABLE_ALREADY_EXISTS.replace("%1",Y.name):(pe=Je.VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE,pe=pe.replace("%1",Y.name).replace("%2",Y.type)),xr(pe,function(){a(D)})}else e.createVariable(D,d),t&&t(D)}else t&&t(null)})}const d=r||"";a("")},mn=function(e,t,r){function a(d){const C=Je.RENAME_VARIABLE_TITLE.replace("%1",t.name);Pr(C,d,function(D){if(D){var Y=Ma(D,t.type,e);Y?(Y=Je.VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE.replace("%1",Y.name).replace("%2",Y.type),xr(Y,function(){a(D)})):(e.renameVariableById(t.getId(),D),r&&r(D))}else r&&r(null)})}a("")},Pr=function(e,t,r){ar(e,t,function(a){a&&(a=a.replace(/[\s\xa0]+/g," ").trim(),a===Je.RENAME_VARIABLE||a===Je.NEW_VARIABLE)&&(a=null),r(a)})},Ma=function(e,t,r){r=r.getVariableMap().getAllVariables(),e=e.toLowerCase();for(let a=0,d;d=r[a];a++)if(d.name.toLowerCase()===e&&d.type!==t)return d;return null},Ae=function(e,t){t=t.getVariableMap().getAllVariables(),e=e.toLowerCase();for(let r=0,a;a=t[r];r++)if(a.name.toLowerCase()===e)return a;return null},Fe=function(e){const t=ot("field");return t.setAttribute("name","VAR"),t.setAttribute("id",e.getId()),t.setAttribute("variabletype",e.type),e=ms(e.name),t.appendChild(e),t},ht=function(e,t,r,a){let d=$t(e,t,r,a);return d||(d=Ts(e,t,r,a)),d},$t=function(e,t,r,a){const d=e.getPotentialVariableMap();let C=null;if(t&&(C=e.getVariableById(t),!C&&d&&(C=d.getVariableById(t)),C))return C;if(r){if(a===void 0)throw Error("Tried to look up a variable by name without a type");C=e.getVariable(r,a),!C&&d&&(C=d.getVariable(r,a))}return C},Ts=function(e,t,r,a){const d=e.getPotentialVariableMap();return r||(r=Na(e.isFlyout?e.targetWorkspace:e)),d?d.createVariable(r,a,t):e.createVariable(r,a,t)},bi=function(e,t){e=e.getAllVariables();const r=[];if(t.length!==e.length)for(let a=0;a<e.length;a++){const d=e[a];t.indexOf(d)===-1&&r.push(d)}return r},Ti=function(e){if(Ad)throw Error("CSS already injected");Ld+=`
`+e},Ec=function(e,t){Ad||(Ad=true,e&&(e=t.replace(/[\\/]$/,""),t=Ld.replace(/<<<PATH>>>/g,e),Ld="",e=document.createElement("style"),e.id="blockly-common-style",t=document.createTextNode(t),e.appendChild(t),document.head.insertBefore(e,document.head.firstChild)))},Ji=function(e){const t=new Oe(0,0);var r=e.x&&e.getAttribute("x");const a=e.y&&e.getAttribute("y");return r&&(t.x=parseInt(r)),a&&(t.y=parseInt(a)),(r=(r=e.getAttribute("transform"))&&r.match(Iv))&&(t.x+=Number(r[1]),r[3]&&(t.y+=Number(r[3]))),(e=e.getAttribute("style"))&&-1<e.indexOf("translate")&&(e=e.match(Cv))&&(t.x+=Number(e[1]),e[3]&&(t.y+=Number(e[3]))),t},vc=function(e){let t=0,r=0;for(;e;){const a=Ji(e);if(t+=a.x,r+=a.y,(" "+(e.getAttribute("class")||"")+" ").indexOf(" injectionDiv ")!==-1)break;e=e.parentNode}return new Oe(t,r)},wm=function(){return o("Blockly.utils.svgMath.is3dSupported","version 9","version 10"),true},Lh=function(){const e=ut();return new ts(e.y,document.documentElement.clientHeight+e.y,e.x,document.documentElement.clientWidth+e.x)},Nh=function(){const e=document.documentElement,t=window;return new Oe(t.pageXOffset||e.scrollLeft,t.pageYOffset||e.scrollTop)},km=function(e,t){var r=t.x;t=t.y;const a=e.getInjectionDiv().getBoundingClientRect();return r=new Oe(r-a.left,t-a.top),t=e.getOriginOffsetInPixels(),Oe.difference(r,t).scale(1/e.scale)},WI=function(e,t){const r=ot("xml");var a=Am(ii(e));a.hasChildNodes()&&r.appendChild(a),a=e.getTopComments(true);for(let d=0;d<a.length;d++)r.appendChild(a[d].toXmlWithXY(t));for(e=e.getTopBlocks(true),a=0;a<e.length;a++)r.appendChild(bc(e[a],t));return r},Am=function(e){const t=ot("variables");for(let r=0;r<e.length;r++){const a=e[r],d=ot("variable");d.appendChild(ms(a.name)),a.type&&d.setAttribute("type",a.type),d.id=a.getId(),t.appendChild(d)}return t},bc=function(e,t){if(e.isInsertionMarker()&&(e=e.getChildren(false)[0],!e))return new DocumentFragment;let r=0;e.workspace.RTL&&(r=e.workspace.getWidth()),t=Ur(e,t);const a=e.getRelativeToSurfaceXY();return t.setAttribute("x",Math.round(e.workspace.RTL?r-a.x:a.x)),t.setAttribute("y",Math.round(a.y)),t},zI=function(e){if(e.isSerializable()){const t=ot("field");return t.setAttribute("name",e.name||""),e.toXml(t)}return null},jI=function(e,t){for(let r=0;r<e.inputList.length;r++){const a=e.inputList[r];for(let d=0;d<a.fieldRow.length;d++){const C=zI(a.fieldRow[d]);C&&t.appendChild(C)}}},Ur=function(e,t){if(e.isInsertionMarker())return(t=e.getChildren(false)[0])?Ur(t):new DocumentFragment;const r=ot(e.isShadow()?"shadow":"block");if(r.setAttribute("type",e.type),t||r.setAttribute("id",e.id),e.mutationToDom){var a=e.mutationToDom();a&&(a.hasChildNodes()||a.hasAttributes())&&r.appendChild(a)}if(jI(e,r),a=e.getCommentText()){var d=e.commentModel.size,C=e.commentModel.pinned,D=ot("comment");D.appendChild(ms(a)),D.setAttribute("pinned",C),D.setAttribute("h",d.height),D.setAttribute("w",d.width),r.appendChild(D)}for(e.data&&(a=ot("data"),a.appendChild(ms(e.data)),r.appendChild(a)),a=0;a<e.inputList.length;a++){d=e.inputList[a];var Y=void 0;if(C=true,d.type!==lt.DUMMY){D=d.connection.targetBlock(),d.type===lt.VALUE?Y=ot("value"):d.type===lt.STATEMENT&&(Y=ot("statement"));const we=d.connection.getShadowDom();!we||D&&D.isShadow()||Y.appendChild(Lm(we,t)),D&&(D=Ur(D,t),D.nodeType===bn.ELEMENT_NODE&&(Y.appendChild(D),C=false)),Y.setAttribute("name",d.name),C||r.appendChild(Y)}}e.inputsInline!==void 0&&e.inputsInline!==e.inputsInlineDefault&&r.setAttribute("inline",e.inputsInline.toString()),e.isCollapsed()&&r.setAttribute("collapsed","true"),e.isEnabled()||r.setAttribute("disabled","true"),e.isDeletable()||e.isShadow()||r.setAttribute("deletable","false"),e.isMovable()||e.isShadow()||r.setAttribute("movable","false"),e.isEditable()||r.setAttribute("editable","false"),Y=e.getNextBlock();let pe;return Y&&(a=Ur(Y,t),a.nodeType===bn.ELEMENT_NODE&&(pe=ot("next"),pe.appendChild(a),r.appendChild(pe))),e=e.nextConnection&&e.nextConnection.getShadowDom(),!e||Y&&Y.isShadow()||pe.appendChild(Lm(e,t)),r},Lm=function(e,t){let r=e=e.cloneNode(true),a;for(;r;)if(t&&r.nodeName==="shadow"&&r.removeAttribute("id"),r.firstChild)r=r.firstChild;else{for(;r&&!r.nextSibling;){a=r,r=r.parentNode;let d;a.nodeType===bn.TEXT_NODE&&a.data.trim()===""&&((d=r)==null?void 0:d.firstChild)!==a&&B(a)}r&&(a=r,r=r.nextSibling,a.nodeType===bn.TEXT_NODE&&a.data.trim()===""&&B(a))}return e},Bi=function(e){return Aa(e).replace(/<(\w+)([^<]*)\/>/g,"<$1$2></$1>")},XI=function(e){e=Bi(e).split("<");let t="";for(let r=1;r<e.length;r++){const a=e[r];a[0]==="/"&&(t=t.substring(2)),e[r]=t+"<"+a,a[0]!=="/"&&a.slice(-2)!=="/>"&&(t+="  ")}return e=e.join(`
`),e=e.replace(/(<(\w+)\b[^>]*>[^\n]*)\n *<\/\2>/g,"$1</$2>"),e.replace(/^\n/,"")},zs=function(e){const t=ka(e);if(!t||!t.documentElement||t.getElementsByTagName("parsererror").length)throw Error("textToDom was unable to parse: "+e);return t.documentElement},KI=function(e,t){return t.setResizesEnabled(false),t.clear(),e=Da(e,t),t.setResizesEnabled(true),e},Da=function(e,t){let r=0;t.RTL&&(r=t.getWidth());const a=[];Me();const d=Ft();d||He(true),t.setResizesEnabled&&t.setResizesEnabled(false);let C=true;try{for(let D=0,Y;Y=e.childNodes[D];D++){const pe=Y.nodeName.toLowerCase(),we=Y;if(pe==="block"||pe==="shadow"&&!Ps()){const Et=Co(we,t);a.push(Et.id);const zt=we.hasAttribute("x")?parseInt(we.getAttribute("x")):10,Oi=we.hasAttribute("y")?parseInt(we.getAttribute("y")):10;isNaN(zt)||isNaN(Oi)||Et.moveBy(t.RTL?r-zt:zt,Oi),C=false}else{if(pe==="shadow")throw TypeError("Shadow block cannot be a top-level block.");if(pe==="comment")t.rendered?Fs.fromXmlRendered(we,t,r):$n.fromXml(we,t);else if(pe==="variables"){if(C)Nm(we,t);else throw Error("'variables' tag must exist once before block and shadow tag elements in the workspace XML, but it was found in another location.");C=false}}}}finally{d||He(false),Se()}return t.setResizesEnabled&&t.setResizesEnabled(true),Pe(new(Re(Go))(t)),a},YI=function(e,t){if(!t.getBlocksBoundingBox)return Da(e,t);var r=t.getBlocksBoundingBox();if(e=Da(e,t),r&&r.top!==r.bottom){var a=r.bottom;r=t.RTL?r.right:r.left;var d=1/0;let C=-1/0,D=1/0;for(let Y=0;Y<e.length;Y++){const pe=t.getBlockById(e[Y]).getRelativeToSurfaceXY();pe.y<D&&(D=pe.y),pe.x<d&&(d=pe.x),pe.x>C&&(C=pe.x)}for(a=a-D+10,r=t.RTL?r-C:r-d,d=0;d<e.length;d++)t.getBlockById(e[d]).moveBy(r,a)}return e},Co=function(e,t){Zt();var r=t.getAllVariables();let a;try{if(a=Mh(e,t),t.rendered){const d=a,C=a.getDescendants(false);d.setConnectionTracking(false);for(let D=C.length-1;0<=D;D--)C[D].initSvg();for(let D=C.length-1;0<=D;D--)C[D].render(false);setTimeout(function(){d.disposed||d.setConnectionTracking(true)},1),d.updateDisabled(),t.resizeContents()}else{const d=a.getDescendants(false);for(let C=d.length-1;0<=C;C--)d[C].initModel()}}finally{ss()}if(ls()){for(e=bi(t,r),t=0;t<e.length;t++)r=e[t],Pe(new(Re(Xr))(r));Pe(new(Re(ks))(a))}return a},Nm=function(e,t){for(let r=0;r<e.children.length;r++){const a=e.children[r],d=a.getAttribute("type"),C=a.getAttribute("id");t.createVariable(a.textContent,d,C)}},qI=function(e){const t={mutation:[],comment:[],data:[],field:[],input:[],next:[]};for(let r=0;r<e.children.length;r++){const a=e.children[r];if(a.nodeType!==bn.TEXT_NODE)switch(a.nodeName.toLowerCase()){case"mutation":t.mutation.push(a);break;case"comment":t.comment.push(a);break;case"data":t.data.push(a);break;case"title":case"field":t.field.push(a);break;case"value":case"statement":t.input.push(a);break;case"next":t.next.push(a);break;default:console.warn("Ignoring unknown tag: "+a.nodeName)}}return t},JI=function(e,t){let r=false;for(let a=0;a<e.length;a++){const d=e[a];t.domToMutation&&(t.domToMutation(d),t.initSvg&&(r=true))}return r},ZI=function(e,t){for(let a=0;a<e.length;a++){var r=e[a];const d=r.textContent,C=r.getAttribute("pinned")==="true",D=parseInt(r.getAttribute("w"));if(r=parseInt(r.getAttribute("h")),t.setCommentText(d),t.commentModel.pinned=C,isNaN(D)||isNaN(r)||(t.commentModel.size=new Ss(D,r)),C&&t.getCommentIcon&&!t.isInFlyout){const Y=t;setTimeout(function(){Y.getCommentIcon().setVisible(true)},1)}}},QI=function(e,t){for(let r=0;r<e.length;r++)t.data=e[r].textContent},eC=function(e,t){for(let r=0;r<e.length;r++){const a=e[r],d=a.getAttribute("name");iC(t,d,a)}},Mm=function(e){const t={childBlockElement:null,childShadowElement:null};for(let r=0;r<e.childNodes.length;r++){const a=e.childNodes[r];a.nodeType===bn.ELEMENT_NODE&&(a.nodeName.toLowerCase()==="block"?t.childBlockElement=a:a.nodeName.toLowerCase()==="shadow"&&(t.childShadowElement=a))}return t},tC=function(e,t,r,a){for(let C=0;C<e.length;C++){var d=e[C];const D=d.getAttribute("name"),Y=r.getInput(D);if(!Y){console.warn("Ignoring non-existent input "+D+" in block "+a);break}if(d=Mm(d),d.childBlockElement){if(!Y.connection)throw TypeError("Input connection does not exist.");Mh(d.childBlockElement,t,Y.connection,false)}if(d.childShadowElement){let pe;(pe=Y.connection)==null||pe.setShadowDom(d.childShadowElement)}}},sC=function(e,t,r){for(let a=0;a<e.length;a++){const d=Mm(e[a]);if(d.childBlockElement){if(!r.nextConnection)throw TypeError("Next statement does not exist.");if(r.nextConnection.isConnected())throw TypeError("Next statement is already connected.");Mh(d.childBlockElement,t,r.nextConnection,true)}d.childShadowElement&&r.nextConnection&&r.nextConnection.setShadowDom(d.childShadowElement)}},Mh=function(e,t,r,a){const d=e.getAttribute("type");if(!d)throw TypeError("Block type unspecified: "+e.outerHTML);var C=e.getAttribute("id");C=t.newBlock(d,C);const D=qI(e),Y=JI(D.mutation,C);if(ZI(D.comment,C),QI(D.data,C),r)if(a)if(C.previousConnection)r.connect(C.previousConnection);else throw TypeError("Next block does not have previous statement.");else if(C.outputConnection)r.connect(C.outputConnection);else if(C.previousConnection)r.connect(C.previousConnection);else throw TypeError("Child block does not have output or previous statement.");if(eC(D.field,C),tC(D.input,t,C,d),sC(D.next,t,C),Y&&C.initSvg(),(t=e.getAttribute("inline"))&&C.setInputsInline(t==="true"),(t=e.getAttribute("disabled"))&&C.setEnabled(t!=="true"&&t!=="disabled"),(t=e.getAttribute("deletable"))&&C.setDeletable(t==="true"),(t=e.getAttribute("movable"))&&C.setMovable(t==="true"),(t=e.getAttribute("editable"))&&C.setEditable(t==="true"),(t=e.getAttribute("collapsed"))&&C.setCollapsed(t==="true"),e.nodeName.toLowerCase()==="shadow"){for(e=C.getChildren(false),t=0;t<e.length;t++)if(!e[t].isShadow())throw TypeError("Shadow block not allowed non-shadow child.");if(C.getVarModels().length)throw TypeError("Shadow blocks cannot have variable references.");C.setShadow(true)}return C},iC=function(e,t,r){const a=e.getField(t);a?a.fromXml(r):console.warn("Ignoring non-existent field "+t+" in block "+e.type)},nC=function(e){for(let t=0;t<e.childNodes.length;t++){const r=e.childNodes[t];if(r.nodeName.toLowerCase()==="next"){e.removeChild(r);break}}},rC=function(e,t){return o("Blockly.utils.string.startsWith()","April 2022","April 2023","Use built-in string.startsWith"),e.startsWith(t)},Tc=function(e){return e.length?e.reduce(function(t,r){return t.length<r.length?t:r}).length:0},Dm=function(e,t){if(!e.length)return 0;if(e.length===1)return e[0].length;let r=0;t=t||Tc(e);let a;for(a=0;a<t;a++){for(var d=e[0][a],C=1;C<e.length;C++)if(d!==e[C][a])return r;d===" "&&(r=a+1)}for(d=1;d<e.length;d++)if((C=e[d][a])&&C!==" ")return r;return t},xm=function(e,t){if(!e.length)return 0;if(e.length===1)return e[0].length;let r=0;t=t||Tc(e);let a;for(a=0;a<t;a++){for(var d=e[0].substr(-a-1,1),C=1;C<e.length;C++)if(d!==e[C].substr(-a-1,1))return r;d===" "&&(r=a+1)}for(d=1;d<e.length;d++)if((C=e[d].charAt(e[d].length-a-1))&&C!==" ")return r;return t},Bm=function(e,t){e=e.split(`
`);for(let r=0;r<e.length;r++)e[r]=oC(e[r],t);return e.join(`
`)},oC=function(e,t){if(e.length<=t)return e;const r=e.trim().split(/\s+/);for(var a=0;a<r.length;a++)r[a].length>t&&(t=r[a].length);var d=-1/0;let C,D=1;do{a=d,C=e,e=[],d=r.length/D;let Y=1;for(let pe=0;pe<r.length-1;pe++)Y<(pe+1.5)/d?(Y++,e[pe]=true):e[pe]=false;e=Pm(r,e,t),d=Dh(r,e,t),e=aC(r,e),D++}while(d>a);return C},Dh=function(e,t,r){const a=[0],d=[];for(var C=0;C<e.length;C++)a[a.length-1]+=e[C].length,t[C]===true?(a.push(0),d.push(e[C].charAt(e[C].length-1))):t[C]===false&&a[a.length-1]++;for(e=Math.max(...a),t=0,C=0;C<a.length;C++)t-=2*Math.pow(Math.abs(r-a[C]),1.5),t-=Math.pow(e-a[C],1.5),".?!".indexOf(d[C])!==-1?t+=r/3:",;)]}".indexOf(d[C])!==-1&&(t+=r/4);return 1<a.length&&a[a.length-1]<=a[a.length-2]&&(t+=.5),t},Pm=function(e,t,r){let a=Dh(e,t,r),d;for(let C=0;C<t.length-1;C++){if(t[C]===t[C+1])continue;const D=[].concat(t);D[C]=!D[C],D[C+1]=!D[C+1];const Y=Dh(e,D,r);Y>a&&(a=Y,d=D)}return d?Pm(e,d,r):t},aC=function(e,t){const r=[];for(let a=0;a<e.length;a++)r.push(e[a]),t[a]!==void 0&&r.push(t[a]?`
`:" ");return r.join("")},Um=function(e){return/^\s*-?\d+(\.\d+)?\s*$/.test(e)},lC=function(e){ou=e},cC=function(){return ou},uC=function(){return Qa},hC=function(){return us},xa=function(e){if(e=Fm(e)){for(e=e.tooltip;typeof e=="function";)e=e();if(typeof e!="string")throw Error("Tooltip function must return a string.");return e}return""},Fm=function(e){for(;e&&e.tooltip;){if(typeof e.tooltip=="string"||typeof e.tooltip=="function")return e;e=e.tooltip}return null},Gm=function(){us||(us=document.createElement("div"),us.className="blocklyTooltipDiv",(X()||document.body).appendChild(us))},Sc=function(e){e.mouseOverWrapper_=y(e,"pointerover",null,dC),e.mouseOutWrapper_=y(e,"pointerout",null,_C),e.addEventListener("pointermove",Hm,false)},$c=function(e){e&&(g(e.mouseOverWrapper_),g(e.mouseOutWrapper_),e.removeEventListener("pointermove",Hm))},dC=function(e){Wo||(e=Fm(e.currentTarget),Ui!==e&&(Fr(),tl=null,Ui=e),clearTimeout(wv))},_C=function(e){Wo||(wv=setTimeout(function(){tl=Ui=null,Fr()},1),clearTimeout(el))},Hm=function(e){if(Ui&&Ui.tooltip&&!Wo)if(Qa){const t=Md-e.pageX;e=Dd-e.pageY,Math.sqrt(t*t+e*e)>kv&&Fr()}else tl!==Ui&&(clearTimeout(el),Md=e.pageX,Dd=e.pageY,el=setTimeout(mC,Av))},Vm=function(){tl=Ui=null,Fr()},Fr=function(){Qa&&(Qa=false,us&&(us.style.display="none")),el&&clearTimeout(el)},Wm=function(){Fr(),Wo=true},zm=function(){Wo=false},pC=function(){us&&Ui&&(typeof ou=="function"?ou(us,Ui):gC())},gC=function(){var e=xa(Ui);e=Bm(e,Ov),e=e.split(`
`);for(let t=0;t<e.length;t++){const r=document.createElement("div");r.appendChild(document.createTextNode(e[t])),us.appendChild(r)}},fC=function(e){const t=document.documentElement.clientWidth,r=document.documentElement.clientHeight;let a=Md;a=e?a-(xd+us.offsetWidth):a+xd;let d=Dd+Bd;return d+us.offsetHeight>r+window.scrollY&&(d-=us.offsetHeight+2*Bd),e?a=Math.max(au-window.scrollX,a):a+us.offsetWidth>t+window.scrollX-2*au&&(a=t-us.offsetWidth-2*au),{x:a,y:d}},mC=function(){if(!Wo&&(tl=Ui,us)){us.textContent="",pC();var e=Ui.RTL;us.style.direction=e?"rtl":"ltr",us.style.display="block",Qa=true;var{x:t,y:r}=fC(e);us.style.left=t+"px",us.style.top=r+"px"}},jm=function(){return Pd},EC=function(e){Pd=e},Xm=function(){return Ud},vC=function(e){Ud=e},Gr=function(e){e=String(e).toLowerCase().trim();var t=Lv[e];if(t||(t=e.substring(0,2)==="0x"?"#"+e.substring(2):e,t=t[0]==="#"?t:"#"+t,/^#[0-9a-f]{6}$/.test(t)))return t;if(/^#[0-9a-f]{3}$/.test(t))return["#",t[1],t[1],t[2],t[2],t[3],t[3]].join("");var r=e.match(/^(?:rgb)?\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)$/);return r&&(e=Number(r[1]),t=Number(r[2]),r=Number(r[3]),0<=e&&256>e&&0<=t&&256>t&&0<=r&&256>r)?yc(e,t,r):null},yc=function(e,t,r){return t=e<<16|t<<8|r,16>e?"#"+(16777216|t).toString(16).substr(1):"#"+t.toString(16)},xh=function(e){return e=Gr(e),e?(e=parseInt(e.substr(1),16),[e>>16,e>>8&255,e&255]):[0,0,0]},Bh=function(e,t,r){let a=0,d=0,C=0;if(t===0)C=d=a=r;else{const D=Math.floor(e/60),Y=e/60-D;e=r*(1-t);const pe=r*(1-t*Y);switch(t=r*(1-t*(1-Y)),D){case 1:a=pe,d=r,C=e;break;case 2:a=e,d=r,C=t;break;case 3:a=e,d=pe,C=r;break;case 4:a=t,d=e,C=r;break;case 5:a=r,d=e,C=pe;break;case 6:case 0:a=r,d=t,C=e}}return yc(Math.floor(a),Math.floor(d),Math.floor(C))},Oo=function(e,t,r){return e=Gr(e),!e||(t=Gr(t),!t)?null:(e=xh(e),t=xh(t),yc(Math.round(t[0]+r*(e[0]-t[0])),Math.round(t[1]+r*(e[1]-t[1])),Math.round(t[2]+r*(e[2]-t[2]))))},Ph=function(e){return Bh(e,Pd,255*Ud)},Uh=function(e,t){const r=[];var a=e.split("");a.push("");var d=0;e=[];let C=null;for(let pe=0;pe<a.length;pe++){var D=a[pe];if(d===0)D==="%"?((d=e.join(""))&&r.push(d),e.length=0,d=1):e.push(D);else if(d===1)D==="%"?(e.push(D),d=0):t&&"0"<=D&&"9">=D?(d=2,C=D,(D=e.join(""))&&r.push(D),e.length=0):D==="{"?d=3:(e.push("%",D),d=0);else if(d===2)if("0"<=D&&"9">=D)C+=D;else{var Y=void 0;r.push(parseInt((Y=C)!=null?Y:"",10)),pe--,d=0}else d===3&&(D===""?(e.splice(0,0,"%{"),pe--,d=0):D!=="}"?e.push(D):(d=e.join(""),/[A-Z]\w*/i.test(d)?(D=d.toUpperCase(),(D=D.startsWith("BKY_")?D.substring(4):null)&&D in Je?(d=Je[D],typeof d=="string"?Array.prototype.push.apply(r,Uh(d,t)):t?r.push(String(d)):r.push(d)):r.push("%{"+d+"}")):r.push("%{"+d+"}"),d=e.length=0))}for((t=e.join(""))&&r.push(t),Y=[],e.length=0,a=0;a<r.length;a++)typeof r[a]=="string"?e.push(r[a]):((t=e.join(""))&&Y.push(t),e.length=0,Y.push(r[a]));return(t=e.join(""))&&Y.push(t),e.length=0,Y},Fh=function(e){return Uh(e,true)},es=function(e){return typeof e!="string"?e:(e=Uh(e,false),e.length?String(e[0]):"")},Rc=function(e){let t=true;const r=Je,a=e.match(/%{BKY_[A-Z]\w*}/ig);if(a)for(let d=0;d<a.length;d++){const C=a[d].toUpperCase();r[C.slice(6,-1)]===void 0&&(console.warn("No message string for "+a[d]+" in "+e),t=false)}return t},wo=function(e){const t=typeof e=="string"?es(e):e;var r=Number(t);if(!isNaN(r)&&0<=r&&360>=r)return{hue:r,hex:Bh(r,jm(),255*Xm())};if(r=Gr(t))return{hue:null,hex:r};throw r='Invalid colour: "'+t+'"',e!==t&&(r+=' (from "'+e+'")'),Error(r)},ko=function(){return sn},bC=function(e){sn=e},Km=function(){sn||(sn=document.createElement("div"),sn.className="blocklyWidgetDiv",(X()||document.body).appendChild(sn))},Gh=function(e,t,r){En(),lu=e,cu=r,(e=sn)&&(e.style.direction=t?"rtl":"ltr",e.style.display="block",t=k(),zo=t.getRenderer().getClassName(),jo=t.getTheme().getClassName(),zo&&ie(e,zo),jo&&ie(e,jo))},En=function(){if(Ym()){lu=null;var e=sn;e&&(e.style.display="none",e.style.left="",e.style.top="",cu&&cu(),cu=null,e.textContent="",zo&&(he(e,zo),zo=""),jo&&(he(e,jo),jo=""),k().markFocused())}},Ym=function(){return!!lu},Hh=function(e){lu===e&&En()},qm=function(e,t,r){sn.style.left=e+"px",sn.style.top=t+"px",sn.style.height=r+"px"},Jm=function(e,t,r,a){const d=SC(e,t,r);e=TC(e,t,r,a),0>d?qm(e,0,r.height+d):qm(e,d,r.height)},TC=function(e,t,r,a){return a?Math.min(Math.max(t.right-r.width,e.left),e.right-r.width):Math.max(Math.min(t.left,e.right-r.width),e.left)},SC=function(e,t,r){return t.bottom+r.height>=e.bottom?t.top-r.height:t.bottom},Pi=function(e,t){$e(Te.FIELD,e,t)},$C=function(e){Vt(Te.FIELD,e)},Vh=function(e){return Nv.fromJsonInternal(e)},yC=function(e){const t=yo(Te.FIELD,e.type);if(t){if(typeof t.fromJson!="function")throw new TypeError("returned Field was not a IRegistrableField");return t.fromJson(e)}return console.warn("Blockly could not create a field of type "+e.type+". The field is probably not being registered. This could be because the file is not loaded, the field does not register itself (Issue #1584), or the registration is not being reached."),null},vn=function(e,t){e.setAttribute(v0,t)},Xt=function(e,t,r){Array.isArray(r)&&(r=r.join(" ")),e.setAttribute(E0+t,`${r}`)},RC=function(e){return e!==pt.SKIP_SETUP},IC=function(e){let t=false;const r=e.map(([D,Y])=>typeof D=="string"?[es(D),Y]:(t=true,[D.alt!==null?Object.assign({},D,{alt:es(D.alt)}):Object.assign({},D),Y]));if(t||2>e.length)return{options:r};var a=r.map(([D])=>D),d=Tc(a);e=Dm(a,d);const C=xm(a,d);return!e&&!C||d<=e+C?{options:r}:(d=e?a[0].substring(0,e-1):void 0,a=C?a[0].substr(1-C):void 0,{options:CC(r,e,C),prefix:d,suffix:a})},CC=function(e,t,r){return e.map(([a,d])=>[a.substring(t,a.length-r),d])},Zm=function(e){if(!Array.isArray(e))throw TypeError("FieldDropdown options must be an array.");if(!e.length)throw TypeError("FieldDropdown options must not be an empty array.");let t=false;for(let r=0;r<e.length;r++){const a=e[r];Array.isArray(a)?typeof a[1]!="string"?(t=true,console.error("Invalid option["+r+"]: Each FieldDropdown option id must be a string. Found "+a[1]+" in: ",a)):a[0]&&typeof a[0]!="string"&&typeof a[0].src!="string"&&(t=true,console.error("Invalid option["+r+"]: Each FieldDropdown option must have a string label or image description. Found"+a[0]+" in: ",a)):(t=true,console.error("Invalid option["+r+"]: Each FieldDropdown option must be an array. Found: ",a))}if(t)throw TypeError("Found invalid FieldDropdown options.")},OC=function(e,t){o("Blockly.utils.object.inherits","version 9","version 10"),e.superClass_=t.prototype,Object.setPrototypeOf(e,t),e.prototype=Object.create(t.prototype),e.prototype.constructor=e},wC=function(e,t){o("Blockly.utils.object.mixin","May 2022","May 2023","Object.assign");for(const r in t)e[r]=t[r]},lr=function(e,t){for(const r in t)e[r]=t[r]!==null&&typeof t[r]=="object"?lr(e[r]||Object.create(null),t[r]):t[r];return e},kC=function(e){return o("Blockly.utils.object.values","version 9","version 10","Object.values"),Object.values(e)},Ic=function(e){return e?((e instanceof Element||typeof e=="string")&&(e=eE(e),e=NC(e)),AC(e),e):null},AC=function(e){const t=e.kind;if(e=e.contents,t&&t!==Dv&&t!==zd)throw Error("Invalid toolbox kind "+t+". Please supply either "+Dv+" or "+zd);if(!e)throw Error("Toolbox must have a contents attribute.")},Cc=function(e){return e?e.contents?e.contents:Array.isArray(e)&&0<e.length&&!e[0].nodeType?e:jh(e):[]},Wh=function(e){return xv.hasCategoriesInternal(e)},LC=function(e){if(!e)return false;const t=e.kind;return t?t===zd:!!e.contents.filter(function(r){return r.kind.toUpperCase()==="CATEGORY"}).length},zh=function(e){return e&&e.contents?!!e.contents.filter(function(t){return t.kind.toUpperCase()==="CATEGORY"}).length:false},NC=function(e){const t={contents:jh(e)};return e instanceof Node&&Qm(e,t),t},jh=function(e){const t=[];let r=e.childNodes;r||(r=e);for(let a=0,d;d=r[a];a++){if(!d.tagName)continue;e={};const C=d.tagName.toUpperCase();e.kind=C,C==="BLOCK"?e.blockxml=d:d.childNodes&&0<d.childNodes.length&&(e.contents=jh(d)),Qm(d,e),t.push(e)}return t},Qm=function(e,t){for(let r=0;r<e.attributes.length;r++){const a=e.attributes[r];-1<a.nodeName.indexOf("css-")?(t.cssconfig=t.cssconfig||{},t.cssconfig[a.nodeName.replace("css-","")]=a.value):t[a.nodeName]=a.value}},eE=function(e){let t=null;if(e)if(typeof e=="string"){if(t=zs(e),t.nodeName.toLowerCase()!=="xml")throw TypeError("Toolbox should be an <xml> document.")}else e instanceof Element&&(t=e);return t},Oc=function(e,t){if(typeof e!="string"||e.trim()==="")throw Error('Error: Invalid extension name "'+e+'"');if(Xo[e])throw Error('Error: Extension "'+e+'" is already registered.');if(typeof t!="function")throw Error('Error: Extension "'+e+'" must be a function');Xo[e]=t},MC=function(e,t){if(!t||typeof t!="object")throw Error('Error: Mixin "'+e+'" must be a object');Oc(e,function(){this.mixin(t)})},DC=function(e,t,r,a){const d='Error when registering mutator "'+e+'": ';iE(d,t);const C=sE(t,d);if(r&&typeof r!="function")throw Error(d+'Extension "'+e+'" is not a function');Oc(e,function(){C&&this.setMutator(new i.Mutator$$module$build$src$core$mutator(a||[],this)),this.mixin(t),r&&r.apply(this)})},xC=function(e){tE(e)?delete Xo[e]:console.warn('No extension mapping for name "'+e+'" found to unregister')},tE=function(e){return!!Xo[e]},Xh=function(e,t,r){const a=Xo[e];if(typeof a!="function")throw Error('Error: Extension "'+e+'" not found.');let d;if(r?BC(e,t):d=Yh(t),a.apply(t),r)iE('Error after applying mutator "'+e+'": ',t);else if(!FC(d,t))throw Error('Error when applying extension "'+e+'": mutation properties changed when applying a non-mutator extension.')},BC=function(e,t){if(Yh(t).length)throw Error('Error: tried to apply mutation "'+e+'" to a block that already has mutator functions.  Block id: '+t.id)},PC=function(e,t){return Kh(e.mutationToDom,e.domToMutation,t+" mutationToDom/domToMutation")},UC=function(e,t){return Kh(e.saveExtraState,e.loadExtraState,t+" saveExtraState/loadExtraState")},sE=function(e,t){return Kh(e.compose,e.decompose,t+" compose/decompose")},Kh=function(e,t,r){if(e&&t){if(typeof e!="function"||typeof t!="function")throw Error(r+" must be a function");return true}if(!e&&!t)return false;throw Error(r+"Must have both or neither functions")},iE=function(e,t){const r=PC(t,e),a=UC(t,e);if(!r&&!a)throw Error(e+"Mutations must contain either XML hooks, or JSON hooks, or both");sE(t,e)},Yh=function(e){const t=[];return e.domToMutation!==void 0&&t.push(e.domToMutation),e.mutationToDom!==void 0&&t.push(e.mutationToDom),e.saveExtraState!==void 0&&t.push(e.saveExtraState),e.loadExtraState!==void 0&&t.push(e.loadExtraState),e.compose!==void 0&&t.push(e.compose),e.decompose!==void 0&&t.push(e.decompose),t},FC=function(e,t){if(t=Yh(t),t.length!==e.length)return false;for(let r=0;r<t.length;r++)if(e[r]!==t[r])return false;return true},wc=function(e){if(typeof document!="object")throw Error("runAfterPageLoad() requires browser document.");if(document.readyState==="complete")e();else{const t=setInterval(function(){document.readyState==="complete"&&(clearInterval(t),e())},10)}},GC=function(e,t){const r=[];return typeof document=="object"&&wc(function(){for(const a in t)Rc(t[a])}),function(){this.type&&r.indexOf(this.type)===-1&&(HC(this,e,t),r.push(this.type)),this.setTooltip(function(){var a=String(this.getFieldValue(e));let d=t[a];return d===null?r.indexOf(this.type)===-1&&(a="No tooltip mapping for value "+a+" of field "+e,this.type!==null&&(a+=" of block type "+this.type),console.warn(a+".")):d=es(d),d}.bind(this))}},HC=function(e,t,r){var a=e.getField(t);if(a instanceof rn&&!a.isOptionListDynamic()){a=a.getOptions();for(let d=0;d<a.length;d++){const C=a[d][1];r[C]===null&&console.warn("No tooltip mapping for value "+C+" of field "+t+" of block type "+e.type)}}},VC=function(e,t){return typeof document=="object"&&wc(function(){Rc(e)}),function(){this.setTooltip(function(){const r=this.getField(t);return es(e).replace("%1",r?r.getText():"")}.bind(this))}},WC=function(){const e=this.tooltip;this.setTooltip(function(){const t=this.getParent();return t&&t.getInputsInline()&&t.tooltip||e}.bind(this))},ni=function(e,t){return t=e.indexOf(t),t===-1?false:(e.splice(t,1),true)},Ve=function(e,t){return" "+e+","+t+" "},Si=function(e,t){return" "+e+t.join("")},Us=function(e,t){return" M "+e+","+t+" "},Wt=function(e,t){return" m "+e+","+t+" "},Dn=function(e,t){return" l "+e+","+t+" "},Ba=function(e){return" l"+e.join("")},Ne=function(e,t){return" "+e+" "+t+" "},cs=function(e,t,r,a){return e+" "+r+" "+r+" "+t+a},zC=function(e){return o("Blockly.utils.getRelativeXY","December 2021","December 2022","Blockly.utils.svgMath.getRelativeXY"),Ji(e)},jC=function(e){return o("Blockly.utils.getInjectionDivXY_","December 2021","December 2022","Blockly.utils.svgMath.getInjectionDivXY"),vc(e)},XC=function(e){return o("Blockly.utils.tokenizeInterpolation","December 2021","December 2022","Blockly.utils.parsing.tokenizeInterpolation"),Fh(e)},KC=function(e){return o("Blockly.utils.replaceMessageReferences","December 2021","December 2022","Blockly.utils.parsing.replaceMessageReferences"),es(e)},YC=function(e){return o("Blockly.utils.checkMessageReferences","December 2021","December 2022","Blockly.utils.parsing.checkMessageReferences"),Rc(e)},qC=function(){return o("Blockly.utils.is3dSupported","December 2021","December 2022","Blockly.utils.svgMath.is3dSupported"),wm()},JC=function(){return o("Blockly.utils.getViewportBBox","December 2021","December 2022","Blockly.utils.svgMath.getViewportBBox"),Lh()},ZC=function(e,t){return o("Blockly.utils.arrayRemove","December 2021","December 2022","Blockly.array.removeElem"),ni(e,t)},QC=function(){return o("Blockly.utils.getDocumentScroll","December 2021","December 2022","Blockly.utils.svgMath.getDocumentScroll"),Nh()},eO=function(e,t){return o("Blockly.utils.getBlockTypeCounts","December 2021","December 2022","Blockly.common.getBlockTypeCounts"),j(e,t)},tO=function(e,t){return o("Blockly.utils.screenToWsCoordinates","December 2021","December 2022","Blockly.utils.svgMath.screenToWsCoordinates"),km(e,t)},sO=function(e){return o("Blockly.utils.parseBlockColour","December 2021","December 2022","Blockly.utils.parsing.parseBlockColour"),wo(e)},iO=function(e){o("Blockly.utils.runAfterPageLoad","December 2021","December 2022"),wc(e)},qh=function(e,t){$e(Te.SERIALIZER,e,t)},nO=function(e){Vt(Te.SERIALIZER,e)},xn=function(e,{addCoordinates:t=false,addInputBlocks:r=true,addNextBlocks:a=true,doFullSerialization:d=true}={}){if(e.isInsertionMarker())return null;const C={type:e.type,id:e.id};return t&&oO(e,C),rO(e,C),aO(e,C),lO(e,C),cO(e,C,d),r&&uO(e,C,d),a&&hO(e,C,d),C},rO=function(e,t){e.isCollapsed()&&(t.collapsed=true),e.isEnabled()||(t.enabled=false),e.inputsInline!==void 0&&e.inputsInline!==e.inputsInlineDefault&&(t.inline=e.inputsInline),e.data&&(t.data=e.data)},oO=function(e,t){const r=e.workspace;e=e.getRelativeToSurfaceXY(),t.x=Math.round(r.RTL?r.getWidth()-e.x:e.x),t.y=Math.round(e.y)},aO=function(e,t){e.saveExtraState?(e=e.saveExtraState(),e!==null&&(t.extraState=e)):e.mutationToDom&&(e=e.mutationToDom(),e!==null&&(t.extraState=Bi(e).replace(' xmlns="https://developers.google.com/blockly/xml"',"")))},lO=function(e,t){e.getCommentText()&&(t.icons={comment:{text:e.getCommentText(),pinned:e.commentModel.pinned,height:Math.round(e.commentModel.size.height),width:Math.round(e.commentModel.size.width)}})},cO=function(e,t,r){const a=Object.create(null);for(let d=0;d<e.inputList.length;d++){const C=e.inputList[d];for(let D=0;D<C.fieldRow.length;D++){const Y=C.fieldRow[D];Y.isSerializable()&&(a[Y.name]=Y.saveState(r))}}Object.keys(a).length&&(t.fields=a)},uO=function(e,t,r){const a=Object.create(null);for(let d=0;d<e.inputList.length;d++){const C=e.inputList[d];if(C.type===lt.DUMMY)continue;const D=nE(C.connection,r);D&&(a[C.name]=D)}Object.keys(a).length&&(t.inputs=a)},hO=function(e,t,r){e.nextConnection&&(e=nE(e.nextConnection,r))&&(t.next=e)},nE=function(e,t){const r=e.getShadowState(true);if(e=e.targetBlock(),!r&&!e)return null;const a=Object.create(null);return r&&(a.shadow=r),e&&!e.isShadow()&&(a.block=xn(e,{doFullSerialization:t})),a},Hr=function(e,t,{recordUndo:r=false}={}){return Jh(e,t,{recordUndo:r})},Jh=function(e,t,{parentConnection:r,isShadow:a=false,recordUndo:d=false}={}){const C=Ps();Bs(d),(d=Ft())||He(true),Zt();const D=rE(e,t,{parentConnection:r,isShadow:a});return ss(),Pe(new(Re(ks))(D)),He(d),Bs(C),t.rendered&&setTimeout(()=>{D.disposed||D.setConnectionTracking(true)},1),D},rE=function(e,t,{parentConnection:r,isShadow:a=false}={}){if(!e.type)throw new Uv(e);const d=t.newBlock(e.type,e.id);return d.setShadow(a),dO(d,e),_O(d,e),pO(d,e),gO(r,d,e),fO(d,e),mO(d,e),EO(d,e),vO(d,e),bO(d,t.rendered),d},dO=function(e,t){let r=t.x===void 0?0:t.x;t=t.y===void 0?0:t.y;const a=e.workspace;r=a.RTL?a.getWidth()-r:r,e.moveBy(r,t)},_O=function(e,t){t.collapsed&&e.setCollapsed(true),t.enabled===false&&e.setEnabled(false),t.inline!==void 0&&e.setInputsInline(t.inline),t.data!==void 0&&(e.data=t.data)},pO=function(e,t){t.extraState&&(e.loadExtraState?e.loadExtraState(t.extraState):e.domToMutation&&e.domToMutation(zs(t.extraState)))},gO=function(e,t,r){if(e){if(e.getSourceBlock().isShadow()&&!t.isShadow())throw new Gv(r);if(e.type===lt.VALUE){var a=t.outputConnection;if(!a)throw new al("output",t,r)}else if(a=t.previousConnection,!a)throw new al("previous",t,r);if(!e.connect(a)){const d=t.workspace.connectionChecker;throw new Fv(d.getErrorMessage(d.canConnectWithReason(a,e,false),a,e),e.type===lt.VALUE?"output connection":"previous connection",t,r)}}},fO=function(e,t){t.icons&&(t=t.icons.comment)&&(e.setCommentText(t.text),"pinned"in t&&(e.commentModel.pinned=t.pinned),"width"in t&&"height"in t&&(e.commentModel.size=new Ss(t.width,t.height)),t.pinned&&e.rendered&&!e.isInFlyout&&setTimeout(()=>e.getCommentIcon().setVisible(true),1))},mO=function(e,t){if(t.fields){var r=Object.keys(t.fields);for(let a=0;a<r.length;a++){const d=r[a],C=t.fields[d],D=e.getField(d);D?D.loadState(C):console.warn(`Ignoring non-existant field ${d} in block ${e.type}`)}}},EO=function(e,t){if(t.inputs){var r=Object.keys(t.inputs);for(let a=0;a<r.length;a++){const d=r[a],C=e.getInput(d);if(!C||!C.connection)throw new al(d,e,t);oE(C.connection,t.inputs[d])}}},vO=function(e,t){if(t.next){if(!e.nextConnection)throw new al("next",e,t);oE(e.nextConnection,t.next)}},oE=function(e,t){t.shadow&&e.setShadowState(t.shadow),t.block&&rE(t.block,e.getSourceBlock().workspace,{parentConnection:e})},bO=function(e,t){if(t)for(e.setConnectionTracking(false),e.initSvg(),e.render(false),e=e.getIcons(),t=0;t<e.length;t++)e[t].computeIconLocation();else e.initModel()},TO=function(e,t){if(!e||!t)throw Error("Cannot connect null connections.");e.targetConnection=t,t.targetConnection=e},SO=function(e,t){let r=null;t=t.outputConnection;const a=t.getConnectionChecker();for(let d=0,C;C=e.inputList[d];d++){const D=C.connection;if(D&&a.canConnect(t,D,false)){if(r)return null;r=D}}return r},$O=function(e,t){let r;for(;r=SO(e,t);)if(e=r.targetBlock(),!e||e.isShadow())return r;return null},kc=function(e){let t=e.outputConnection;return(!t||e.previousConnection&&e.previousConnection.isConnected())&&(t=e.previousConnection),t},aE=function(e){const t=e.workspace;var r=e.getSvgRoot();t.getAudioManager().play("delete");const a=t.getSvgXY(r);r=r.cloneNode(true),r.setAttribute("transform","translate("+a.x+","+a.y+")"),t.getParentSvg().appendChild(r),lE(r,{x:a.x,y:a.y,width:e.width,height:e.height},t.RTL,new Date,t.scale)},lE=function(e,t,r,a,d){const C=(new Date().getTime()-a.getTime())/150;1<C?B(e):(e.setAttribute("transform","translate("+(t.x+(r?-1:1)*t.width*d/2*C)+","+(t.y+t.height*d*C)+") scale("+(1-C)*d+")"),setTimeout(lE,10,e,t,r,a,d))},cE=function(e){const t=e.workspace,r=t.scale;if(t.getAudioManager().play("click"),!(1>r)){var a=t.getSvgXY(e.getSvgRoot());e.outputConnection?(a.x+=(e.RTL?3:-3)*r,a.y+=13*r):e.previousConnection&&(a.x+=(e.RTL?-23:23)*r,a.y+=3*r),e=H(ee.CIRCLE,{cx:a.x,cy:a.y,r:0,fill:"none",stroke:"#888","stroke-width":10},t.getParentSvg()),uE(e,new Date,r)}},uE=function(e,t,r){const a=(new Date().getTime()-t.getTime())/150;1<a?B(e):(e.setAttribute("r",(25*a*r).toString()),e.style.opacity=(1-a).toString(),_u=setTimeout(uE,10,e,t,r))},hE=function(e){if(Pa(),e.workspace.getAudioManager().play("disconnect"),!(1>e.workspace.scale)){var t=e.getHeightWidth().height;t=Math.atan(10/t)/Math.PI*180,e.RTL||(t*=-1),hl=e.getSvgRoot(),dE(hl,t,new Date)}},dE=function(e,t,r){const a=(new Date().getTime()-r.getTime())/200;let d="";1>=a&&(d=`skewX(${Math.round(Math.sin(a*Math.PI*3)*(1-a)*t)})`,_u=setTimeout(dE,10,e,t,r)),e.skew_=d,e.setAttribute("transform",e.translate_+e.skew_)},Pa=function(){if(hl){_u&&clearTimeout(_u);const e=hl;e.skew_="",e.setAttribute("transform",e.translate_),hl=null}},Ua=function(e){Zd.copyInternal(e)},yO=function(e){Wn=e.toCopyData()},Zh=function(){if(!Wn)return null;let e=Wn.source;return e.isFlyout&&(e=e.targetWorkspace),Wn.typeCounts&&e.isCapacityAvailable(Wn.typeCounts)?e.paste(Wn.saveInfo):null},Ac=function(e){return Zd.duplicateInternal(e)},RO=function(e){const t=Wn;Ua(e);let r,a,d;return e=(d=(r=e.toCopyData())==null||(a=r.source)==null?void 0:a.paste(Wn.saveInfo))!=null?d:null,Wn=t,e},_E=function(){return pl},pE=function(e){pl=e},Lc=function(e,t,r){if(Gh(Qd,r,gE),t.length){var a=IO(t,r);gl=a,CO(a,e,r),setTimeout(function(){a.focus()},1),pl=null}else Nc()},IO=function(e,t){const r=new Fd;r.setRole(ci.MENU);for(let a=0;a<e.length;a++){const d=e[a],C=new Gd(d.text);C.setRightToLeft(t),C.setRole(ci.MENUITEM),r.addChild(C),C.setEnabled(d.enabled),d.enabled&&C.onAction(function(){Nc(),d.callback(d.scope)},{})}return r},CO=function(e,t,r){const a=Lh();t=new ts(t.clientY+a.top,t.clientY+a.top,t.clientX+a.left,t.clientX+a.left),OO(e);const d=e.getSize();r&&(t.left+=d.width,t.right+=d.width,a.left+=d.width,a.right+=d.width),Jm(a,t,d,r),e.focus()},OO=function(e){var t=ko();if(!t)throw Error("Attempting to create a context menu when widget div is null");t=e.render(t),ie(t,"blocklyContextMenu"),S(t,"contextmenu",null,wO),e.focus()},wO=function(e){e.preventDefault(),e.stopPropagation()},Nc=function(){Hh(Qd),pl=null},gE=function(){gl&&(gl.dispose(),gl=null)},kO=function(e,t){return()=>{Zt();let r;try{r=Co(t,e.workspace);const a=e.getRelativeToSurfaceXY();a.x=e.RTL?a.x-i.config$$module$build$src$core$config.snapRadius:a.x+i.config$$module$build$src$core$config.snapRadius,a.y+=2*i.config$$module$build$src$core$config.snapRadius,r.moveBy(a.x,a.y)}finally{ss()}ls()&&!r.isShadow()&&Pe(new(Re(ks))(r)),r.select()}},fE=function(e){return{text:Je.REMOVE_COMMENT,enabled:true,callback:function(){He(true),e.dispose(),He(false)}}},mE=function(e){return{text:Je.DUPLICATE_COMMENT,enabled:true,callback:function(){Ac(e)}}},AO=function(e,t){const r={enabled:true};return r.text=Je.ADD_COMMENT,r.callback=function(){const a=new Fs(e,Je.WORKSPACE_COMMENT_DEFAULT_TEXT,Fs.DEFAULT_SIZE,Fs.DEFAULT_SIZE);var d=e.getInjectionDiv().getBoundingClientRect();d=new Oe(t.clientX-d.left,t.clientY-d.top);const C=e.getOriginOffsetInPixels();d=Oe.difference(d,C),d.scale(1/e.scale),a.moveBy(d.x,d.y),e.rendered&&(a.initSvg(),a.render(),a.select())},r},Qh=function(e,t,r,a,d,C){const D=C.scrollbar&&C.scrollbar.canScrollVertically();return e.horizontal===Jo.LEFT?(r=d.absoluteMetrics.left+r,D&&C.RTL&&(r+=Kt.scrollbarThickness)):(r=d.absoluteMetrics.left+d.viewMetrics.width-t.width-r,D&&!C.RTL&&(r-=Kt.scrollbarThickness)),e.vertical===zn.TOP?e=d.absoluteMetrics.top+a:(e=d.absoluteMetrics.top+d.viewMetrics.height-t.height-a,C.scrollbar&&C.scrollbar.canScrollHorizontally()&&(e-=Kt.scrollbarThickness)),new ts(e,e+t.height,r,r+t.width)},ed=function(e,t){return{horizontal:t.toolboxMetrics.position===it.LEFT||e.horizontalLayout&&!e.RTL?Jo.RIGHT:Jo.LEFT,vertical:t.toolboxMetrics.position===it.BOTTOM?zn.TOP:zn.BOTTOM}},td=function(e,t,r,a){const d=e.left,C=e.right-e.left,D=e.bottom-e.top;for(let Y=0;Y<a.length;Y++){const pe=a[Y];e.intersects(pe)&&(e=r===fr.UP?pe.top-D-t:pe.bottom+t,e=new ts(e,e+D,d,d+C),Y=-1)}return e},EE=function(){wt.registry.register({name:Rn.ESCAPE,preconditionFn(e){return!e.options.readOnly},callback(e){return e.hideChaff(),true},keyCodes:[xe.ESC]})},vE=function(){wt.registry.register({name:Rn.DELETE,preconditionFn(e){const t=P();return!e.options.readOnly&&t!=null&&t.isDeletable()},callback(e,t){return t.preventDefault(),yn.inProgress()?false:(P().checkAndDelete(),true)},keyCodes:[xe.DELETE,xe.BACKSPACE]})},bE=function(){const e=wt.registry.createSerializedKey(xe.C,[xe.CTRL]),t=wt.registry.createSerializedKey(xe.C,[xe.ALT]),r=wt.registry.createSerializedKey(xe.C,[xe.META]);wt.registry.register({name:Rn.COPY,preconditionFn(a){const d=P();return!a.options.readOnly&&!yn.inProgress()&&d!=null&&d.isDeletable()&&d.isMovable()},callback(a,d){return d.preventDefault(),a.hideChaff(),Ua(P()),true},keyCodes:[e,t,r]})},TE=function(){const e=wt.registry.createSerializedKey(xe.X,[xe.CTRL]),t=wt.registry.createSerializedKey(xe.X,[xe.ALT]),r=wt.registry.createSerializedKey(xe.X,[xe.META]);wt.registry.register({name:Rn.CUT,preconditionFn(a){const d=P();return!a.options.readOnly&&!yn.inProgress()&&d!=null&&d instanceof Fi&&d.isDeletable()&&d.isMovable()&&!d.workspace.isFlyout},callback(){const a=P();return a?(Ua(a),a.checkAndDelete(),true):false},keyCodes:[e,t,r]})},SE=function(){const e=wt.registry.createSerializedKey(xe.V,[xe.CTRL]),t=wt.registry.createSerializedKey(xe.V,[xe.ALT]),r=wt.registry.createSerializedKey(xe.V,[xe.META]);wt.registry.register({name:Rn.PASTE,preconditionFn(a){return!a.options.readOnly&&!yn.inProgress()},callback(){return!!Zh()},keyCodes:[e,t,r]})},$E=function(){const e=wt.registry.createSerializedKey(xe.Z,[xe.CTRL]),t=wt.registry.createSerializedKey(xe.Z,[xe.ALT]),r=wt.registry.createSerializedKey(xe.Z,[xe.META]);wt.registry.register({name:Rn.UNDO,preconditionFn(a){return!a.options.readOnly&&!yn.inProgress()},callback(a){return a.hideChaff(),a.undo(false),true},keyCodes:[e,t,r]})},yE=function(){const e=wt.registry.createSerializedKey(xe.Z,[xe.SHIFT,xe.CTRL]),t=wt.registry.createSerializedKey(xe.Z,[xe.SHIFT,xe.ALT]),r=wt.registry.createSerializedKey(xe.Z,[xe.SHIFT,xe.META]),a=wt.registry.createSerializedKey(xe.Y,[xe.CTRL]);wt.registry.register({name:Rn.REDO,preconditionFn(d){return!yn.inProgress()&&!d.options.readOnly},callback(d){return d.hideChaff(),d.undo(true),true},keyCodes:[e,t,r,a]})},RE=function(){EE(),vE(),bE(),TE(),SE(),$E(),yE()},Ao=function(e){return e.startPublishing!==void 0&&e.stopPublishing!==void 0},LO=function(e){return e.doProcedureUpdate!==void 0},cr=function(e){for(const t of e.getAllBlocks(false))LO(t)&&t.doProcedureUpdate()},sd=function(e){const t=e.getBlocksByType("procedures_defnoreturn",false).map(function(r){return r.getProcedureDef()});return e=e.getBlocksByType("procedures_defreturn",false).map(function(r){return r.getProcedureDef()}),t.sort(IE),e.sort(IE),[t,e]},IE=function(e,t){return e[0].localeCompare(t[0],void 0,{sensitivity:"base"})},CE=function(e,t){if(t.isInFlyout)return e;for(e=e||Je.UNNAMED_KEY||"unnamed";!NO(e,t.workspace,t);){const r=e.match(/^(.*?)(\d+)$/);e=r?r[1]+(parseInt(r[2])+1):e+"2"}return e},NO=function(e,t,r){return!OE(e,t,r)},OE=function(e,t,r){t=t.getAllBlocks(false);for(let d=0;d<t.length;d++)if(t[d]!==r){var a=t[d];if(a.getProcedureDef&&(a=a.getProcedureDef(),Gi.equals(a[0],e)))return true}return false},MO=function(e){var t=this.getSourceBlock();if(!t)throw new hs;e=e.trim();const r=CE(e,t),a=this.getValue();if(a!==e&&a!==r)for(e=t.workspace.getAllBlocks(false),t=0;t<e.length;t++){const d=e[t];d.renameProcedure&&d.renameProcedure(a,r)}return r},id=function(e){function t(C,D){for(let pe=0;pe<C.length;pe++){var Y=C[pe][0];const we=C[pe][1],Et=ot("block");Et.setAttribute("type",D),Et.setAttribute("gap","16");const zt=ot("mutation");for(zt.setAttribute("name",Y),Et.appendChild(zt),Y=0;Y<we.length;Y++){const Oi=ot("arg");Oi.setAttribute("name",we[Y]),zt.appendChild(Oi)}r.push(Et)}}const r=[];if(oi.procedures_defnoreturn){var a=ot("block");a.setAttribute("type","procedures_defnoreturn"),a.setAttribute("gap","16");var d=ot("field");d.setAttribute("name","NAME"),d.appendChild(ms(Je.PROCEDURES_DEFNORETURN_PROCEDURE)),a.appendChild(d),r.push(a)}return oi.procedures_defreturn&&(a=ot("block"),a.setAttribute("type","procedures_defreturn"),a.setAttribute("gap","16"),d=ot("field"),d.setAttribute("name","NAME"),d.appendChild(ms(Je.PROCEDURES_DEFRETURN_PROCEDURE)),a.appendChild(d),r.push(a)),oi.procedures_ifreturn&&(a=ot("block"),a.setAttribute("type","procedures_ifreturn"),a.setAttribute("gap","16"),r.push(a)),r.length&&r[r.length-1].setAttribute("gap","24"),e=sd(e),t(e[0],"procedures_callnoreturn"),t(e[1],"procedures_callreturn"),r},wE=function(e){var t=[],r=e.getBlocksByType("procedures_mutatorarg",false);for(let C=0,D;D=r[C];C++)t.push(D.getFieldValue("NAME"));r=ot("xml");const a=ot("block");a.setAttribute("type","procedures_mutatorarg");const d=ot("field");d.setAttribute("name","NAME"),t=Mt(p_,t),t=ms(t),d.appendChild(t),a.appendChild(d),r.appendChild(a),e.updateToolbox(r)},kE=function(e){if(e.type===Fn&&e.bubbleType==="mutator"&&e.isOpen&&e.blockId){e=O(e.workspaceId).getBlockById(e.blockId);var t=e.type;(t==="procedures_defnoreturn"||t==="procedures_defreturn")&&(e=e.mutator.getWorkspace(),wE(e),e.addChangeListener(DO))}},DO=function(e){(e.type===ks||e.type===Sn||e.type===bs)&&(e=O(e.workspaceId),wE(e))},AE=function(e,t){const r=[];t=t.getAllBlocks(false);for(let d=0;d<t.length;d++){var a=t[d];a.getProcedureCall&&(a=a.getProcedureCall())&&Gi.equals(a,e)&&r.push(t[d])}return r},xO=function(e){const t=Ps();var r=e.getProcedureDef()[0];const a=e.mutationToDom(true);e=AE(r,e.workspace);for(let C=0,D;D=e[C];C++){r=(r=D.mutationToDom())&&Bi(r),D.domToMutation&&D.domToMutation(a);var d=D.mutationToDom();d=d&&Bi(d),r!==d&&(Bs(false),Pe(new(Re(bs))(D,"mutation",null,r,d)),Bs(t))}},BO=function(e,t){t=t.getAllBlocks(false);for(let a=0;a<t.length;a++){var r=t[a];if(r.getProcedureDef&&(r=r.getProcedureDef())&&Gi.equals(r[0],e))return t[a]}return null},LE=function(e){return e.isDynamic},Mc=function(){return db},PO=function(){o("Blockly.blockRendering.debug.stopDebugger()","version 8","version 10","the debug renderer in @blockly/dev-tools (See https://www.npmjs.com/package/@blockly/dev-tools.)"),db=false},Fa=function(e,t){$e(Te.RENDERER,e,t)},UO=function(e){Vt(Te.RENDERER,e)},FO=function(){o("Blockly.blockRendering.stopDebugger()","September 2021","September 2022","the debug renderer in @blockly/dev-tools (See https://www.npmjs.com/package/@blockly/dev-tools.)"),PO()},NE=function(e,t,r){return e=new(pn(Te.RENDERER,e))(e),e.init(t,r),e},ME=function(e){fn(e.getTargetWorkspace(),void 0,"String")},DE=function(e){fn(e.getTargetWorkspace(),void 0,"Number")},xE=function(e){fn(e.getTargetWorkspace(),void 0,"Colour")},nd=function(e){let t=[],r=document.createElement("button");return r.setAttribute("text",Je.NEW_STRING_VARIABLE),r.setAttribute("callbackKey","CREATE_VARIABLE_STRING"),t.push(r),r=document.createElement("button"),r.setAttribute("text",Je.NEW_NUMBER_VARIABLE),r.setAttribute("callbackKey","CREATE_VARIABLE_NUMBER"),t.push(r),r=document.createElement("button"),r.setAttribute("text",Je.NEW_COLOUR_VARIABLE),r.setAttribute("callbackKey","CREATE_VARIABLE_COLOUR"),t.push(r),e.registerButtonCallback("CREATE_VARIABLE_STRING",ME),e.registerButtonCallback("CREATE_VARIABLE_NUMBER",DE),e.registerButtonCallback("CREATE_VARIABLE_COLOUR",xE),e=BE(e),t=t.concat(e)},BE=function(e){e=e.getAllVariables();const t=[];if(0<e.length){if(oi.variables_set_dynamic){var r=e[e.length-1];const a=ot("block");a.setAttribute("type","variables_set_dynamic"),a.setAttribute("gap","24"),a.appendChild(Fe(r)),t.push(a)}if(oi.variables_get_dynamic){e.sort(Ja.compareByName);for(let a=0,d;d=e[a];a++)r=ot("block"),r.setAttribute("type","variables_get_dynamic"),r.setAttribute("gap","8"),r.appendChild(Fe(d)),t.push(r)}}return t},GO=function(e){e.resizeContents()},HO=function(e){const t=Object.create(null),r=Mr(Te.SERIALIZER,true);for(const a in r){let d;const C=(d=r[a])==null?void 0:d.save(e);C&&(t[a]=C)}return t},VO=function(e,t,{recordUndo:r=false}={}){var a=Mr(Te.SERIALIZER,true);if(a){a=Object.entries(a).sort((C,D)=>D[1].priority-C[1].priority);var d=Ps();Bs(r),(r=Ft())||He(true),Me(),t instanceof ln&&t.setResizesEnabled(false);for(const[,C]of a.reverse()){let D;(D=C)==null||D.clear(t)}for(let[C,D]of a.reverse())if(e[C]){let Y;(Y=D)==null||Y.load(e[C],t)}t instanceof ln&&t.setResizesEnabled(true),Se(),Pe(new(Re(Go))(t)),He(r),Bs(d)}},rd=function(e){const t={id:e.getId(),name:e.getName(),returnTypes:e.getReturnTypes()};return e.getParameters().length&&(t.parameters=e.getParameters().map(r=>od(r))),t},od=function(e){const t={id:e.getId(),name:e.getName()};return e.getTypes().length&&(t.types=e.getTypes()),t},ad=function(e,t,r,a){if(e=new e(a,r.name,r.id).setReturnTypes(r.returnTypes),!r.parameters)return e;for(const[d,C]of r.parameters.entries())e.insertParameter(ld(t,C,a),d);return e},ld=function(e,t,r){return e=new e(r,t.name,t.id),t.types&&e.setTypes(t.types),e},Dc=function(e,t,r){const a=r.getBoundingRectangle(),d=a.right-a.left,C=Cs(t.top,a.top,t.top+t.height-(a.bottom-a.top))-a.top;let D=t.left;return t=t.left+t.width-d,e.RTL?D=Math.min(t,D):t=Math.max(D,t),(e=Cs(D,a.left,t)-a.left)||C?(r.moveBy(e,C),true):false},PE=function(e){return t=>{var r=e.getMetricsManager();if(r.hasFixedEdges()&&!e.isDragging()){var a;if(yd.indexOf((a=t.type)!=null?a:"")!==-1){a=r.getScrollMetrics(true);const d=WO(e,t);d&&(r=Ft(),He(t.group),Dc(e,a,d)&&!t.group&&console.warn("Moved object in bounds but there was no event group. This may break undo."),r!==null&&He(r))}else t.type===Kr&&t.scale&&t.oldScale&&t.scale>t.oldScale&&cd(e)}}},WO=function(e,t){let r=null;switch(t.type){case ks:case js:(r=e.getBlockById(t.blockId))&&(r=r.getRootBlock());break;case Yr:case Gn:r=e.getCommentById(t.commentId)}return r},cd=function(e){var t=e.getMetricsManager();if(t.hasFixedEdges()&&!e.isDragging()){t=t.getScrollMetrics(true);var r=e.getTopBoundedElements();for(let a=0,d;d=r[a];a++)Dc(e,t,d)}},zO=function(e,t){if(typeof e=="string"&&(e=document.getElementById(e)||document.querySelector(e)),!e||!le(document,e))throw Error("Error: container is not in current document.");t=new on(t||{});const r=document.createElement("div");r.className="injectionDiv",r.tabIndex=0,Xt(r,Gt.LABEL,Je.WORKSPACE_ARIA_LABEL),e.appendChild(r),e=jO(r,t);const a=new Xb(r),d=new jb(r),C=XO(e,t,a,d);return KO(C),x(C),z(C),r.addEventListener("focusin",function(){x(C)}),C},jO=function(e,t){e.setAttribute("dir","LTR"),Ec(t.hasCss,t.pathToMedia),e=H(ee.SVG,{xmlns:Mo,"xmlns:html":Zi,"xmlns:xlink":ai,version:"1.1",class:"blocklySvg",tabindex:"0"},e);const r=H(ee.DEFS,{},e),a=String(Math.random()).substring(2);return t.gridPattern=__.createDom(a,t.gridOptions,r),e},XO=function(e,t,r,a){t.parentWorkspace=null,t=new ln(t,r,a),r=t.options,t.scale=r.zoomOptions.startScale,e.appendChild(t.createDom("blocklyMainBackground")),a=t.getInjectionDiv();var d=t.getRenderer().getClassName();return d&&ie(a,d),(d=t.getTheme().getClassName())&&ie(a,d),!r.hasCategories&&r.languageTree&&(a=t.addFlyout(ee.SVG),te(a,e)),r.hasTrashcan&&t.addTrashcan(),r.zoomOptions&&r.zoomOptions.controls&&t.addZoomControls(),t.getThemeManager().subscribe(e,"workspaceBackgroundColour","background-color"),t.translate(0,0),t.addChangeListener(PE(t)),z(t),Km(),fs(),Gm(),t},KO=function(e){const t=e.options;var r=e.getParentSvg();if(S(r.parentNode,"contextmenu",null,function(a){E(a)||a.preventDefault()}),r=S(window,"resize",null,function(){e.hideChaff(true),z(e),cd(e)}),e.setResizeHandlerWrapper(r),qO(),t.languageTree){r=e.getToolbox();const a=e.getFlyout(true);r?r.init():a&&(a.init(e),a.show(t.languageTree),typeof a.scrollToStart=="function"&&a.scrollToStart())}t.hasTrashcan&&e.trashcan.init(),t.zoomOptions&&t.zoomOptions.controls&&e.zoomControls_.init(),t.moveOptions&&t.moveOptions.scrollbars?(e.scrollbar=new w_(e,t.moveOptions.scrollbars===true||!!t.moveOptions.scrollbars.horizontal,t.moveOptions.scrollbars===true||!!t.moveOptions.scrollbars.vertical,"blocklyMainWorkspaceScrollbar"),e.scrollbar.resize()):e.setMetrics({x:.5,y:.5}),t.hasSounds&&JO(t.pathToMedia,e)},YO=function(e){const t=k();t&&!(E(e)||t.rendered&&!t.isVisible())&&wt.registry.onKeyDown(t,e)},qO=function(){Kb||(S(document,"scroll",null,function(){const e=w();for(let t=0,r;r=e[t];t++)r instanceof ln&&r.updateInverseScreenCTM()}),S(document,"keydown",null,YO),y(document,"touchend",null,f),y(document,"touchcancel",null,f),Lo&&S(window,"orientationchange",document,function(){z(k())})),Kb=true},JO=function(e,t){function r(){for(;d.length;)g(d.pop());a.preload()}const a=t.getAudioManager();a.load([e+"click.mp3",e+"click.wav",e+"click.ogg"],"click"),a.load([e+"disconnect.wav",e+"disconnect.mp3",e+"disconnect.ogg"],"disconnect"),a.load([e+"delete.mp3",e+"delete.ogg",e+"delete.wav"],"delete");const d=[];d.push(S(document,"pointermove",null,r,true)),d.push(S(document,"touchstart",null,r,true))},UE=function(e,t,r){if(e=e.getProcedureMap().get(t),!e)throw Error("Cannot rename the parameter of a procedure that does not exist in the procedure map");return e.getParameters().find(a=>a.getId()===r)},FE=function(){It.registry.register({displayText(){return Je.UNDO},preconditionFn(e){return 0<e.workspace.getUndoStack().length?"enabled":"disabled"},callback(e){e.workspace.undo(false)},scopeType:It.ScopeType.WORKSPACE,id:"undoWorkspace",weight:1})},GE=function(){It.registry.register({displayText(){return Je.REDO},preconditionFn(e){return 0<e.workspace.getRedoStack().length?"enabled":"disabled"},callback(e){e.workspace.undo(true)},scopeType:It.ScopeType.WORKSPACE,id:"redoWorkspace",weight:2})},HE=function(){It.registry.register({displayText(){return Je.CLEAN_UP},preconditionFn(e){return e.workspace.isMovable()?1<e.workspace.getTopBlocks(false).length?"enabled":"disabled":"hidden"},callback(e){e.workspace.cleanUp()},scopeType:It.ScopeType.WORKSPACE,id:"cleanWorkspace",weight:3})},VE=function(e,t){function r(C){d--,C.setCollapsed(e),d===0&&He(false)}let a=0,d=0;He(true);for(let C=0;C<t.length;C++){let D=t[C];for(;D;)d++,setTimeout(r.bind(null,D),a),D=D.getNextBlock(),a+=10}},WE=function(){It.registry.register({displayText(){return Je.COLLAPSE_ALL},preconditionFn(e){if(e.workspace.options.collapse){e=e.workspace.getTopBlocks(false);for(let t=0;t<e.length;t++){let r=e[t];for(;r;){if(!r.isCollapsed())return"enabled";r=r.getNextBlock()}}return"disabled"}return"hidden"},callback(e){VE(true,e.workspace.getTopBlocks(true))},scopeType:It.ScopeType.WORKSPACE,id:"collapseWorkspace",weight:4})},zE=function(){It.registry.register({displayText(){return Je.EXPAND_ALL},preconditionFn(e){if(e.workspace.options.collapse){e=e.workspace.getTopBlocks(false);for(let t=0;t<e.length;t++){let r=e[t];for(;r;){if(r.isCollapsed())return"enabled";r=r.getNextBlock()}}return"disabled"}return"hidden"},callback(e){VE(false,e.workspace.getTopBlocks(true))},scopeType:It.ScopeType.WORKSPACE,id:"expandWorkspace",weight:5})},jE=function(e,t){if(e.isDeletable())Array.prototype.push.apply(t,e.getDescendants(false));else{e=e.getChildren(false);for(let r=0;r<e.length;r++)jE(e[r],t)}},ud=function(e){const t=[];e=e.getTopBlocks(true);for(let r=0;r<e.length;r++)jE(e[r],t);return t},xc=function(e,t){He(t);const r=e.shift();r&&(r.isDeadOrDying()?xc(e,t):(r.dispose(false,true),setTimeout(xc,10,e,t))),He(false)},XE=function(){It.registry.register({displayText(e){return e.workspace?(e=ud(e.workspace).length,e===1?Je.DELETE_BLOCK:Je.DELETE_X_BLOCKS.replace("%1",String(e))):""},preconditionFn(e){return e.workspace&&0<ud(e.workspace).length?"enabled":"disabled"},callback(e){if(e.workspace){e.workspace.cancelCurrentGesture();var t=ud(e.workspace),r=mi();2>t.length?xc(t,r):La(Je.DELETE_ALL_BLOCKS.replace("%1",String(t.length)),function(a){a&&xc(t,r)})}},scopeType:It.ScopeType.WORKSPACE,id:"workspaceDelete",weight:6})},ZO=function(){FE(),GE(),HE(),WE(),zE(),XE()},KE=function(){It.registry.register({displayText(){return Je.DUPLICATE_BLOCK},preconditionFn(e){return e=e.block,!e.isInFlyout&&e.isDeletable()&&e.isMovable()?e.isDuplicatable()?"enabled":"disabled":"hidden"},callback(e){e.block&&Ac(e.block)},scopeType:It.ScopeType.BLOCK,id:"blockDuplicate",weight:1})},YE=function(){It.registry.register({displayText(e){return e.block.getCommentIcon()?Je.REMOVE_COMMENT:Je.ADD_COMMENT},preconditionFn(e){return e=e.block,!e.isInFlyout&&e.workspace.options.comments&&!e.isCollapsed()&&e.isEditable()?"enabled":"hidden"},callback(e){e=e.block,e.getCommentIcon()?e.setCommentText(null):e.setCommentText("")},scopeType:It.ScopeType.BLOCK,id:"blockComment",weight:2})},qE=function(){It.registry.register({displayText(e){return e.block.getInputsInline()?Je.EXTERNAL_INPUTS:Je.INLINE_INPUTS},preconditionFn(e){if(e=e.block,!e.isInFlyout&&e.isMovable()&&!e.isCollapsed()){for(let t=1;t<e.inputList.length;t++)if(e.inputList[t-1].type!==lt.STATEMENT&&e.inputList[t].type!==lt.STATEMENT)return"enabled"}return"hidden"},callback(e){e.block.setInputsInline(!e.block.getInputsInline())},scopeType:It.ScopeType.BLOCK,id:"blockInline",weight:3})},JE=function(){It.registry.register({displayText(e){return e.block.isCollapsed()?Je.EXPAND_BLOCK:Je.COLLAPSE_BLOCK},preconditionFn(e){return e=e.block,!e.isInFlyout&&e.isMovable()&&e.workspace.options.collapse?"enabled":"hidden"},callback(e){e.block.setCollapsed(!e.block.isCollapsed())},scopeType:It.ScopeType.BLOCK,id:"blockCollapseExpand",weight:4})},ZE=function(){It.registry.register({displayText(e){return e.block.isEnabled()?Je.DISABLE_BLOCK:Je.ENABLE_BLOCK},preconditionFn(e){return e=e.block,!e.isInFlyout&&e.workspace.options.disable&&e.isEditable()?e.getInheritedDisabled()?"disabled":"enabled":"hidden"},callback(e){e=e.block;const t=Ft();t||He(true),e.setEnabled(!e.isEnabled()),t||He(false)},scopeType:It.ScopeType.BLOCK,id:"blockDisable",weight:5})},QE=function(){It.registry.register({displayText(e){var t=e.block;return e=t.getDescendants(false).length,(t=t.getNextBlock())&&(e-=t.getDescendants(false).length),e===1?Je.DELETE_BLOCK:Je.DELETE_X_BLOCKS.replace("%1",String(e))},preconditionFn(e){return!e.block.isInFlyout&&e.block.isDeletable()?"enabled":"hidden"},callback(e){e.block&&e.block.checkAndDelete()},scopeType:It.ScopeType.BLOCK,id:"blockDelete",weight:6})},ev=function(){It.registry.register({displayText(){return Je.HELP},preconditionFn(e){return e=e.block,(typeof e.helpUrl=="function"?e.helpUrl():e.helpUrl)?"enabled":"hidden"},callback(e){e.block.showHelp()},scopeType:It.ScopeType.BLOCK,id:"blockHelp",weight:7})},QO=function(){KE(),YE(),qE(),JE(),ZE(),QE(),ev()},tv=function(){ZO(),QO()},e0=function(e){const t=[];e=e.getDescendants(false);for(let r=0,a;a=e[r];r++){const d=a.getIcons();for(let C=0;C<d.length;C++){const D={location:d[C].getIconLocation(),icon:d[C]};t.push(D)}}return t},t0=function(e){k().hideChaff(e)},s0=function(e){o("Blockly.resizeSvgContents","December 2021","December 2022","Blockly.WorkspaceSvg.resizeSvgContents"),GO(e)},i0=function(e){o("Blockly.copy","December 2021","December 2022","Blockly.clipboard.copy"),Ua(e)},n0=function(){return o("Blockly.paste","December 2021","December 2022","Blockly.clipboard.paste"),!!Zh()},r0=function(e){o("Blockly.duplicate","December 2021","December 2022","Blockly.clipboard.duplicate"),Ac(e)},o0=function(e){return o("Blockly.isNumber","December 2021","December 2022","Blockly.utils.string.isNumber"),Um(e)},a0=function(e){return o("Blockly.hueToHex","December 2021","December 2022","Blockly.utils.colour.hueToHex"),Ph(e)},l0=function(e,t,r,a){return o("Blockly.bindEvent_","December 2021","December 2022","Blockly.browserEvents.bind"),y(e,t,r,a)},c0=function(e){return o("Blockly.unbindEvent_","December 2021","December 2022","Blockly.browserEvents.unbind"),g(e)},u0=function(e,t,r,a,d,C){return o("Blockly.bindEventWithChecks_","December 2021","December 2022","Blockly.browserEvents.conditionalBind"),S(e,t,r,a,d)},ze=ze||{};ze.scope={},ze.ASSUME_ES5=false,ze.ASSUME_NO_NATIVE_MAP=false,ze.ASSUME_NO_NATIVE_SET=false,ze.SIMPLE_FROUND_POLYFILL=false,ze.ISOLATE_POLYFILLS=false,ze.FORCE_POLYFILL_PROMISE=false,ze.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=false,ze.defineProperty=ze.ASSUME_ES5||typeof Object.defineProperties=="function"?Object.defineProperty:function(e,t,r){return e==Array.prototype||e==Object.prototype||(e[t]=r.value),e},ze.getGlobal=function(e){e=[typeof globalThis=="object"&&globalThis,e,typeof window=="object"&&window,typeof self=="object"&&self,typeof Ni=="object"&&Ni];for(var t=0;t<e.length;++t){var r=e[t];if(r&&r.Math==Math)return r}throw Error("Cannot find global object")},ze.global=ze.getGlobal(this),ze.IS_SYMBOL_NATIVE=typeof Symbol=="function"&&typeof Symbol("x")=="symbol",ze.TRUST_ES6_POLYFILLS=!ze.ISOLATE_POLYFILLS||ze.IS_SYMBOL_NATIVE,ze.polyfills={},ze.propertyToPolyfillSymbol={},ze.POLYFILL_PREFIX="$jscp$",ze.polyfill=function(e,t,r,a){t&&(ze.ISOLATE_POLYFILLS?ze.polyfillIsolated(e,t,r,a):ze.polyfillUnisolated(e,t,r,a))},ze.polyfillUnisolated=function(e,t,r,a){for(r=ze.global,e=e.split("."),a=0;a<e.length-1;a++){var d=e[a];if(!(d in r))return;r=r[d]}e=e[e.length-1],a=r[e],t=t(a),t!=a&&t!=null&&ze.defineProperty(r,e,{configurable:true,writable:true,value:t})},ze.polyfillIsolated=function(e,t,r,a){var d=e.split(".");e=d.length===1,a=d[0],a=!e&&a in ze.polyfills?ze.polyfills:ze.global;for(var C=0;C<d.length-1;C++){var D=d[C];if(!(D in a))return;a=a[D]}d=d[d.length-1],r=ze.IS_SYMBOL_NATIVE&&r==="es6"?a[d]:null,t=t(r),t!=null&&(e?ze.defineProperty(ze.polyfills,d,{configurable:true,writable:true,value:t}):t!==r&&(ze.propertyToPolyfillSymbol[d]===void 0&&(r=1e9*Math.random()>>>0,ze.propertyToPolyfillSymbol[d]=ze.IS_SYMBOL_NATIVE?ze.global.Symbol(d):ze.POLYFILL_PREFIX+r+"$"+d),ze.defineProperty(a,ze.propertyToPolyfillSymbol[d],{configurable:true,writable:true,value:t})))},ze.polyfill("globalThis",function(e){return e||ze.global},"es_2020","es3"),ze.polyfill("Object.getOwnPropertyDescriptors",function(e){return e||function(t){for(var r={},a=Reflect.ownKeys(t),d=0;d<a.length;d++)r[a[d]]=Object.getOwnPropertyDescriptor(t,a[d]);return r}},"es8","es5"),ze.arrayIteratorImpl=function(e){var t=0;return function(){return t<e.length?{done:false,value:e[t++]}:{done:true}}},ze.arrayIterator=function(e){return{next:ze.arrayIteratorImpl(e)}},ze.initSymbol=function(){},ze.iteratorPrototype=function(e){return e={next:e},e[Symbol.iterator]=function(){return this},e},ze.iteratorFromArray=function(e,t){e instanceof String&&(e+="");var r=0,a=false,d={next:function(){if(!a&&r<e.length){var C=r++;return{value:t(C,e[C]),done:false}}return a=true,{done:true,value:void 0}}};return d[Symbol.iterator]=function(){return d},d},ze.polyfill("Array.prototype.values",function(e){return e||function(){return ze.iteratorFromArray(this,function(t,r){return r})}},"es8","es3"),ze.owns=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},ze.polyfill("Object.values",function(e){return e||function(t){var r=[],a;for(a in t)ze.owns(t,a)&&r.push(t[a]);return r}},"es8","es3"),ze.polyfill("Array.prototype.flat",function(e){return e||function(t){t=t===void 0?1:t;for(var r=[],a=0;a<this.length;a++){var d=this[a];Array.isArray(d)&&0<t?(d=Array.prototype.flat.call(d,t-1),r.push.apply(r,d)):r.push(d)}return r}},"es9","es5"),ze.polyfill("Object.entries",function(e){return e||function(t){var r=[],a;for(a in t)ze.owns(t,a)&&r.push([a,t[a]]);return r}},"es8","es3");var ri=ri||{};ri.global=globalThis||root,ri.define=function(e,t){return t},ri.DEBUG=false,ri.DISALLOW_TEST_ONLY_CODE=!ri.DEBUG,ri.provide=function(e){},ri.module=function(e){},ri.module.get=function(e){},ri.module.declareLegacyNamespace=function(){},ri.setTestOnly=function(e){if(ri.DISALLOW_TEST_ONLY_CODE)throw e=e||"",Error("Importing test-only code into non-debug environment"+(e?": "+e:"."))},ri.require=function(e){},ri.requireType=function(e){};var vs={};vs.warn=o;var h0=750,sv="ontouchstart"in globalThis||!!(globalThis.document&&document.documentElement&&"ontouchstart"in document.documentElement)||!(!globalThis.navigator||!globalThis.navigator.maxTouchPoints&&!globalThis.navigator.msMaxTouchPoints),Bc=null,Vr={mousedown:["pointerdown"],mouseenter:["pointerenter"],mouseleave:["pointerleave"],mousemove:["pointermove"],mouseout:["pointerout"],mouseover:["pointerover"],mouseup:["pointerup","pointercancel"],touchend:["pointerup"],touchcancel:["pointercancel"]},Pc=0,$i={};$i.TOUCH_ENABLED=sv,$i.TOUCH_MAP=Vr,$i.checkTouchIdentifier=c,$i.clearTouchIdentifier=m,$i.getTouchIdentifierFromEvent=_,$i.isMouseOrTouchEvent=p,$i.isTouchEvent=T,$i.longStart=l,$i.longStop=f,$i.setClientFromTouch=h,$i.shouldHandleEvent=u,$i.splitEventByTouches=$;var hd,iv,nv,rv,Uc,Fc,dd,ov,av,lv;(function(e){function t(a){return r.indexOf(a.toUpperCase())!==-1}hd=e;const r=hd.toUpperCase();iv=t("JavaFX"),nv=t("WebKit"),rv=t("Gecko")&&!nv,Uc=t("Android"),e=globalThis.navigator&&globalThis.navigator.maxTouchPoints,Fc=t("iPad")||t("Macintosh")&&0<e,dd=t("iPhone")&&!Fc,ov=t("Macintosh"),av=Fc||Uc&&!t("Mobile")||t("Silk"),lv=!av&&(dd||Uc)})(globalThis.navigator&&globalThis.navigator.userAgent||"");var d0=hd,cv=iv,_d=rv,Gc=Uc,Lo=Fc,uv=dd,pd=ov,gd=lv,Bn={};Bn.ANDROID=Gc,Bn.GECKO=_d,Bn.IPAD=Lo,Bn.IPHONE=uv,Bn.JavaFx=cv,Bn.MAC=pd,Bn.MOBILE=gd,Bn.raw=d0;var hv=40,dv=125,Pn={};Pn.bind=y,Pn.conditionalBind=S,Pn.getScrollDeltaPixels=R,Pn.isRightButton=v,Pn.isTargetInput=E,Pn.mouseToSvg=b,Pn.unbind=g;var oi=Object.create(null),No,_v,fd,pv,Wr,md;No=Object.create(null),fd=null,Wr=[],md={defineBlocksWithJsonArrayInternal:U},i.module$build$src$core$common={},i.module$build$src$core$common.TEST_ONLY=md,i.module$build$src$core$common.createBlockDefinitionsFromJsonArray=V,i.module$build$src$core$common.defineBlocks=K,i.module$build$src$core$common.defineBlocksWithJsonArray=M,i.module$build$src$core$common.draggingConnections=Wr,i.module$build$src$core$common.getAllWorkspaces=w,i.module$build$src$core$common.getBlockTypeCounts=j,i.module$build$src$core$common.getMainWorkspace=k,i.module$build$src$core$common.getParentContainer=X,i.module$build$src$core$common.getSelected=P,i.module$build$src$core$common.getWorkspaceById=O,i.module$build$src$core$common.registerWorkspace=L,i.module$build$src$core$common.setMainWorkspace=x,i.module$build$src$core$common.setParentContainer=W,i.module$build$src$core$common.setSelected=F,i.module$build$src$core$common.svgResize=z,i.module$build$src$core$common.unregisterWorkpace=I;var Mo="http://www.w3.org/2000/svg",Zi="http://www.w3.org/1999/xhtml",ai="http://www.w3.org/1999/xlink",bn;(function(e){e[e.ELEMENT_NODE=1]="ELEMENT_NODE",e[e.TEXT_NODE=3]="TEXT_NODE",e[e.COMMENT_NODE=8]="COMMENT_NODE",e[e.DOCUMENT_POSITION_CONTAINED_BY=16]="DOCUMENT_POSITION_CONTAINED_BY"})(bn||(bn={}));var Qi=null,Ed=0,Hc=null,ps={};ps.HTML_NS=Zi,ps.NodeType=bn,ps.SVG_NS=Mo,ps.XLINK_NS=ai,ps.addClass=ie,ps.containsNode=le,ps.createSvgElement=H,ps.getFastTextWidth=St,ps.getFastTextWidthWithSizeString=Ut,ps.getTextWidth=nt,ps.hasClass=st,ps.insertAfter=te,ps.measureFontMetrics=Jt,ps.removeClass=he,ps.removeClasses=Ie,ps.removeNode=B,ps.setCssTransform=ae,ps.startTextWidthCache=Me,ps.stopTextWidthCache=Se;var Vc={};Vc.clamp=Cs,Vc.toDegrees=Is,Vc.toRadians=We;var ts=class{constructor(e,t,r,a){this.top=e,this.bottom=t,this.left=r,this.right=a}contains(e,t){return e>=this.left&&e<=this.right&&t>=this.top&&t<=this.bottom}intersects(e){return!(this.left>e.right||this.right<e.left||this.top>e.bottom||this.bottom<e.top)}},Oe=class{constructor(e,t){this.x=e,this.y=t}clone(){return new Oe(this.x,this.y)}scale(e){return this.x*=e,this.y*=e,this}translate(e,t){return this.x+=e,this.y+=t,this}static equals(e,t){return e===t?true:e&&t?e.x===t.x&&e.y===t.y:false}static distance(e,t){const r=e.x-t.x;return e=e.y-t.y,Math.sqrt(r*r+e*e)}static magnitude(e){return Math.sqrt(e.x*e.x+e.y*e.y)}static difference(e,t){return new Oe(e.x-t.x,e.y-t.y)}static sum(e,t){return new Oe(e.x+t.x,e.y+t.y)}},Ss=class{constructor(e,t){this.width=e,this.height=t}static equals(e,t){return e===t?true:e&&t?e.width===t.width&&e.height===t.height:false}},gv={getSizeInternal:xs},Tn={};Tn.TEST_ONLY=gv,Tn.getBorderBox=jt,Tn.getCascadedStyle=be,Tn.getComputedStyle=At,Tn.getContainerOffsetToScrollInto=fi,Tn.getPageOffset=qe,Tn.getSize=Os,Tn.getViewportPageOffset=ut,Tn.scrollIntoContainerView=Ee;var Wc=16,fv=1,mv=12,vd=16,zc=.25,bd=null,zr=null,Do="",xo="",yt,Bo,jr,Td=null,ur=null,Ev=null,Sd={getBoundsInfo:function(){const e=qe(Td),t=Os(Td);return{left:e.x,right:e.x+t.width,top:e.y,bottom:e.y+t.height,width:t.width,height:t.height}},getPositionMetrics:function(e,t,r,a){const d=Sd.getBoundsInfo(),C=Os(yt);return t+C.height<d.bottom?Yi(e,t,d,C):a-C.height>d.top?qi(r,a,d,C):t+C.height<document.documentElement.clientHeight?Yi(e,t,d,C):a-C.height>document.documentElement.clientTop?qi(r,a,d,C):q(e,d,C)}},is={};is.ANIMATION_TIME=zc,is.ARROW_HORIZONTAL_PADDING=mv,is.ARROW_SIZE=Wc,is.BORDER_SIZE=fv,is.PADDING_Y=vd,is.TEST_ONLY=Sd,is.clearContent=as,is.createDom=fs,is.getContentDiv=xi,is.getOwner=Ot,is.getPositionX=fe,is.hide=Ht,is.hideIfOwner=et,is.hideWithoutAnimation=Lt,is.isVisible=ke,is.repositionForWindowResize=Be,is.setBoundsElement=ws,is.setColour=N,is.show=ti,is.showPositionedByBlock=G,is.showPositionedByField=Z;var hr=Object.create(null),_0={typeMap:hr},jc=Object.create(null),Un="default",Te=class{constructor(e){this.name=e}toString(){return this.name}};Te.CONNECTION_CHECKER=new Te("connectionChecker"),Te.CURSOR=new Te("cursor"),Te.EVENT=new Te("event"),Te.FIELD=new Te("field"),Te.RENDERER=new Te("renderer"),Te.TOOLBOX=new Te("toolbox"),Te.THEME=new Te("theme"),Te.TOOLBOX_ITEM=new Te("toolboxItem"),Te.FLYOUTS_VERTICAL_TOOLBOX=new Te("flyoutsVerticalToolbox"),Te.FLYOUTS_HORIZONTAL_TOOLBOX=new Te("flyoutsHorizontalToolbox"),Te.METRICS_MANAGER=new Te("metricsManager"),Te.BLOCK_DRAGGER=new Te("blockDragger"),Te.SERIALIZER=new Te("serializer");var en={};en.DEFAULT=Un,en.TEST_ONLY=_0,en.Type=Te,en.getAllItems=Mr,en.getClass=pn,en.getClassFromOptions=si,en.getObject=yo,en.hasItem=$o,en.register=$e,en.unregister=Vt;var vv="!#$%()*+,-./:;=?@[]^_`{|}~ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",bv={genUid:()=>{const e=vv.length,t=[];for(let r=0;20>r;r++)t[r]=vv.charAt(Math.random()*e);return t.join("")}},p0=0,Xc={};Xc.TEST_ONLY=bv,Xc.genUid=mi,Xc.getNextUniqueId=Dr;var Tv="",Ga=true,$d=0,ks="create",Sn="delete",bs="change",js="move",Xr="var_create",Po="var_delete",Ha="var_rename",Va="ui",Uo="drag",dr="selected",_r="click",Wa="marker_move",Fn="bubble_open",za="trashcan_open",ja="toolbox_item_select",Xa="theme_change",Kr="viewport_change",Yr="comment_create",Fo="comment_delete",Ka="comment_change",Gn="comment_move",Go="finished_loading",Kc="procedure_create",Ya="procedure_delete",Yc="procedure_rename",qc="procedure_enable",Jc="procedure_change_return",Zc="procedure_parameter_create",Qc="procedure_parameter_delete",eu="procedure_parameter_rename",yd=[ks,js,Yr,Gn],Ho=[],Rd={FIRE_QUEUE:Ho,fireNow:fc,fireInternal:Ih,setGroupInternal:Ch},Qe={};Qe.BLOCK_CHANGE=bs,Qe.BLOCK_CREATE=ks,Qe.BLOCK_DELETE=Sn,Qe.BLOCK_DRAG=Uo,Qe.BLOCK_MOVE=js,Qe.BUBBLE_OPEN=Fn,Qe.BUMP_EVENTS=yd,Qe.CHANGE=bs,Qe.CLICK=_r,Qe.COMMENT_CHANGE=Ka,Qe.COMMENT_CREATE=Yr,Qe.COMMENT_DELETE=Fo,Qe.COMMENT_MOVE=Gn,Qe.CREATE=ks,Qe.DELETE=Sn,Qe.FINISHED_LOADING=Go,Qe.MARKER_MOVE=Wa,Qe.MOVE=js,Qe.PROCEDURE_CHANGE_RETURN=Jc,Qe.PROCEDURE_CREATE=Kc,Qe.PROCEDURE_DELETE=Ya,Qe.PROCEDURE_ENABLE=qc,Qe.PROCEDURE_PARAMETER_CREATE=Zc,Qe.PROCEDURE_PARAMETER_DELETE=Qc,Qe.PROCEDURE_PARAMETER_RENAME=eu,Qe.PROCEDURE_RENAME=Yc,Qe.SELECTED=dr,Qe.TEST_ONLY=Rd,Qe.THEME_CHANGE=Xa,Qe.TOOLBOX_ITEM_SELECT=ja,Qe.TRASHCAN_OPEN=za,Qe.UI=Va,Qe.VAR_CREATE=Xr,Qe.VAR_DELETE=Po,Qe.VAR_RENAME=Ha,Qe.VIEWPORT_CHANGE=Kr,Qe.clearPendingUndo=Ro,Qe.disable=Zt,Qe.disableOrphans=Qt,Qe.enable=ss,Qe.filter=Ei,Qe.fire=Pe,Qe.fromJson=Xe,Qe.get=Re,Qe.getDescendantIds=ye,Qe.getGroup=Ft,Qe.getRecordUndo=Ps,Qe.isEnabled=ls,Qe.setGroup=He,Qe.setRecordUndo=Bs;var lt;(function(e){e[e.VALUE=1]="VALUE",e[e.STATEMENT=3]="STATEMENT",e[e.DUMMY=5]="DUMMY"})(lt||(lt={})),i.module$build$src$core$input_types={},i.module$build$src$core$input_types.inputTypes=lt;var qr,tu,su,Id;({document:qr,DOMParser:tu,XMLSerializer:su}=globalThis),Id="https://developers.google.com/blockly/xml",i.module$build$src$core$utils$xml={},i.module$build$src$core$utils$xml.NAME_SPACE=Id,i.module$build$src$core$utils$xml.createElement=ot,i.module$build$src$core$utils$xml.createTextNode=ms,i.module$build$src$core$utils$xml.domToText=Aa,i.module$build$src$core$utils$xml.getDocument=gn,i.module$build$src$core$utils$xml.injectDependencies=vi,i.module$build$src$core$utils$xml.setDocument=Io,i.module$build$src$core$utils$xml.textToDomDocument=ka;var Sv=function(e,t){window.alert(e),t&&t()},$v=function(e,t){t(window.confirm(e))},yv=function(e,t,r){r(window.prompt(e,t))},Rv={confirmInternal:wh},li={};li.TEST_ONLY=Rv,li.alert=xr,li.confirm=La,li.prompt=ar,li.setAlert=Oh,li.setConfirm=kh,li.setPrompt=mc;var Je,Cd;Je=Object.create(null),Cd=function(e){Object.keys(e).forEach(function(t){Je[t]=e[t]})},i.module$build$src$core$msg={},i.module$build$src$core$msg.Msg=Je,i.module$build$src$core$msg.setLocale=Cd;var Jr=class{constructor(){this.workspaceId=void 0,this.isUiEvent=false,this.type="",this.group=Ft(),this.recordUndo=Ps()}toJson(){return{type:this.type,group:this.group}}fromJson(e){this.isBlank=false,this.group=e.group||""}static fromJson(e,t,r){return o("Blockly.Events.Abstract.prototype.fromJson","version 9","version 10","Blockly.Events.fromJson"),r.isBlank=false,r.group=e.group||"",r.workspaceId=t.id,r}isNull(){return false}run(e){}getEventWorkspace_(){let e;if(this.workspaceId&&(e=O(this.workspaceId)),!e)throw Error("Workspace is null. Event must have been generated from real Blockly events.");return e}},qa=class extends Jr{constructor(e){super(),this.isBlank=typeof e>"u",e&&(this.varId=e.getId(),this.workspaceId=e.workspace.id)}toJson(){const e=super.toJson();if(!this.varId)throw Error("The var ID is undefined. Either pass a variable to the constructor, or call fromJson");return e.varId=this.varId,e}fromJson(e){o("Blockly.Events.VarBase.prototype.fromJson","version 9","version 10","Blockly.Events.fromJson"),super.fromJson(e),this.varId=e.varId}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new qa),t.varId=e.varId,t}},Od=class extends qa{constructor(e){super(e),this.type=Xr,e&&(this.varType=e.type,this.varName=e.name)}toJson(){const e=super.toJson();if(!this.varType)throw Error("The var type is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.varName)throw Error("The var name is undefined. Either pass a variable to the constructor, or call fromJson");return e.varType=this.varType,e.varName=this.varName,e}fromJson(e){o("Blockly.Events.VarCreate.prototype.fromJson","version 9","version 10","Blockly.Events.fromJson"),super.fromJson(e),this.varType=e.varType,this.varName=e.varName}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new Od),t.varType=e.varType,t.varName=e.varName,t}run(e){const t=this.getEventWorkspace_();if(!this.varId)throw Error("The var ID is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.varName)throw Error("The var name is undefined. Either pass a variable to the constructor, or call fromJson");e?t.createVariable(this.varName,this.varType,this.varId):t.deleteVariableById(this.varId)}};$e(Te.EVENT,Xr,Od);var Ja=class{constructor(e,t,r,a){this.workspace=e,this.name=t,this.type=r||"",this.id_=a||mi()}getId(){return this.id_}static compareByName(e,t){return e.name.localeCompare(t.name,void 0,{sensitivity:"base"})}},iu,nu,wd;iu="VARIABLE",nu="ijkmnopqrstuvwxyzabcdefgh",wd={generateUniqueNameInternal:Es},i.module$build$src$core$variables={},i.module$build$src$core$variables.CATEGORY_NAME=iu,i.module$build$src$core$variables.TEST_ONLY=wd,i.module$build$src$core$variables.VAR_LETTER_OPTIONS=nu,i.module$build$src$core$variables.allDeveloperVariables=Ah,i.module$build$src$core$variables.allUsedVarModels=ii,i.module$build$src$core$variables.createVariableButtonHandler=fn,i.module$build$src$core$variables.flyoutCategory=Br,i.module$build$src$core$variables.flyoutCategoryBlocks=at,i.module$build$src$core$variables.generateUniqueName=Na,i.module$build$src$core$variables.generateUniqueNameFromOptions=Mt,i.module$build$src$core$variables.generateVariableFieldDom=Fe,i.module$build$src$core$variables.getAddedVariables=bi,i.module$build$src$core$variables.getOrCreateVariablePackage=ht,i.module$build$src$core$variables.getVariable=$t,i.module$build$src$core$variables.nameUsedWithAnyType=Ae,i.module$build$src$core$variables.promptName=Pr,i.module$build$src$core$variables.renameVariable=mn;var $n=class{constructor(e,t,r,a,d){this.workspace=e,this.editable_=this.movable_=this.deletable_=true,this.disposed_=false,this.isComment=true,this.id=d&&!e.getCommentById(d)?d:mi(),e.addTopComment(this),this.xy_=new Oe(0,0),this.height_=r,this.width_=a,this.RTL=e.RTL,this.content_=t,$n.fireCreateEvent(this)}dispose(){this.disposed_||(ls()&&Pe(new(Re(Fo))(this)),this.workspace.removeTopComment(this),this.disposed_=true)}getHeight(){return this.height_}setHeight(e){this.height_=e}getWidth(){return this.width_}setWidth(e){this.width_=e}getXY(){return new Oe(this.xy_.x,this.xy_.y)}moveBy(e,t){const r=new(Re(Gn))(this);this.xy_.translate(e,t),r.recordNew(),Pe(r)}isDeletable(){return this.deletable_&&!(this.workspace&&this.workspace.options.readOnly)}setDeletable(e){this.deletable_=e}isMovable(){return this.movable_&&!(this.workspace&&this.workspace.options.readOnly)}setMovable(e){this.movable_=e}isEditable(){return this.editable_&&!(this.workspace&&this.workspace.options.readOnly)}setEditable(e){this.editable_=e}getContent(){return this.content_}setContent(e){this.content_!==e&&(Pe(new(Re(Ka))(this,this.content_,e)),this.content_=e)}toXmlWithXY(e){return e=this.toXml(e),e.setAttribute("x",`${Math.round(this.xy_.x)}`),e.setAttribute("y",`${Math.round(this.xy_.y)}`),e.setAttribute("h",`${this.height_}`),e.setAttribute("w",`${this.width_}`),e}toXml(e){const t=ot("comment");return e||(t.id=this.id),t.textContent=this.getContent(),t}static fireCreateEvent(e){if(ls()){const t=Ft();t||He(true);try{Pe(new(Re(Yr))(e))}finally{t||He(false)}}}static fromXml(e,t){var r=$n.parseAttributes(e);return t=new $n(t,r.content,r.h,r.w,r.id),r=e.getAttribute("x"),e=e.getAttribute("y"),r=r?parseInt(r,10):NaN,e=e?parseInt(e,10):NaN,isNaN(r)||isNaN(e)||t.moveBy(r,e),$n.fireCreateEvent(t),t}static parseAttributes(e){const t=e.getAttribute("h"),r=e.getAttribute("w"),a=e.getAttribute("x"),d=e.getAttribute("y"),C=e.getAttribute("id");if(!C)throw Error("No ID present in XML comment definition.");let D;return{id:C,h:t?parseInt(t):100,w:r?parseInt(r):100,x:a?parseInt(a):NaN,y:d?parseInt(d):NaN,content:(D=e.textContent)!=null?D:""}}},tn=class extends Jr{constructor(e){super(),this.isBlank=true,this.recordUndo=false,this.isUiEvent=true,this.isBlank=typeof e>"u",this.workspaceId=e||""}},kd=class extends tn{constructor(e,t,r){super(r),this.type=dr,this.oldElementId=e??void 0,this.newElementId=t??void 0}toJson(){const e=super.toJson();return e.oldElementId=this.oldElementId,e.newElementId=this.newElementId,e}fromJson(e){o("Blockly.Events.Selected.prototype.fromJson","version 9","version 10","Blockly.Events.fromJson"),super.fromJson(e),this.oldElementId=e.oldElementId,this.newElementId=e.newElementId}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new kd),t.oldElementId=e.oldElementId,t.newElementId=e.newElementId,t}};$e(Te.EVENT,dr,kd);var Ad=false,Ld=`
.blocklySvg {
  background-color: #fff;
  outline: none;
  overflow: hidden;  /* IE overflows by default. */
  position: absolute;
  display: block;
}

.blocklyWidgetDiv {
  display: none;
  position: absolute;
  z-index: 99999;  /* big value for bootstrap3 compatibility */
}

.injectionDiv {
  height: 100%;
  position: relative;
  overflow: hidden;  /* So blocks in drag surface disappear at edges */
  touch-action: none;
}

.blocklyNonSelectable {
  user-select: none;
  -ms-user-select: none;
  -webkit-user-select: none;
}

.blocklyWsDragSurface {
  display: none;
  position: absolute;
  top: 0;
  left: 0;
}

/* Added as a separate rule with multiple classes to make it more specific
   than a bootstrap rule that selects svg:root. See issue #1275 for context.
*/
.blocklyWsDragSurface.blocklyOverflowVisible {
  overflow: visible;
}

.blocklyBlockDragSurface {
  display: none;
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  overflow: visible !important;
  z-index: 50;  /* Display below toolbox, but above everything else. */
}

.blocklyBlockCanvas.blocklyCanvasTransitioning,
.blocklyBubbleCanvas.blocklyCanvasTransitioning {
  transition: transform .5s;
}

.blocklyTooltipDiv {
  background-color: #ffffc7;
  border: 1px solid #ddc;
  box-shadow: 4px 4px 20px 1px rgba(0,0,0,.15);
  color: #000;
  display: none;
  font: 9pt sans-serif;
  opacity: .9;
  padding: 2px;
  position: absolute;
  z-index: 100000;  /* big value for bootstrap3 compatibility */
}

.blocklyDropDownDiv {
  position: absolute;
  left: 0;
  top: 0;
  z-index: 1000;
  display: none;
  border: 1px solid;
  border-color: #dadce0;
  background-color: #fff;
  border-radius: 2px;
  padding: 4px;
  box-shadow: 0 0 3px 1px rgba(0,0,0,.3);
}

.blocklyDropDownDiv.blocklyFocused {
  box-shadow: 0 0 6px 1px rgba(0,0,0,.3);
}

.blocklyDropDownContent {
  max-height: 300px;  /* @todo: spec for maximum height. */
  overflow: auto;
  overflow-x: hidden;
  position: relative;
}

.blocklyDropDownArrow {
  position: absolute;
  left: 0;
  top: 0;
  width: 16px;
  height: 16px;
  z-index: -1;
  background-color: inherit;
  border-color: inherit;
}

.blocklyDropDownButton {
  display: inline-block;
  float: left;
  padding: 0;
  margin: 4px;
  border-radius: 4px;
  outline: none;
  border: 1px solid;
  transition: box-shadow .1s;
  cursor: pointer;
}

.blocklyArrowTop {
  border-top: 1px solid;
  border-left: 1px solid;
  border-top-left-radius: 4px;
  border-color: inherit;
}

.blocklyArrowBottom {
  border-bottom: 1px solid;
  border-right: 1px solid;
  border-bottom-right-radius: 4px;
  border-color: inherit;
}

.blocklyResizeSE {
  cursor: se-resize;
  fill: #aaa;
}

.blocklyResizeSW {
  cursor: sw-resize;
  fill: #aaa;
}

.blocklyResizeLine {
  stroke: #515A5A;
  stroke-width: 1;
}

.blocklyHighlightedConnectionPath {
  fill: none;
  stroke: #fc3;
  stroke-width: 4px;
}

.blocklyPathLight {
  fill: none;
  stroke-linecap: round;
  stroke-width: 1;
}

.blocklySelected>.blocklyPathLight {
  display: none;
}

.blocklyDraggable {
  /* backup for browsers (e.g. IE11) that don't support grab */
  cursor: url("<<<PATH>>>/handopen.cur"), auto;
  cursor: grab;
  cursor: -webkit-grab;
}

  /* backup for browsers (e.g. IE11) that don't support grabbing */
.blocklyDragging {
  /* backup for browsers (e.g. IE11) that don't support grabbing */
  cursor: url("<<<PATH>>>/handclosed.cur"), auto;
  cursor: grabbing;
  cursor: -webkit-grabbing;
}

  /* Changes cursor on mouse down. Not effective in Firefox because of
     https://bugzilla.mozilla.org/show_bug.cgi?id=771241 */
.blocklyDraggable:active {
  /* backup for browsers (e.g. IE11) that don't support grabbing */
  cursor: url("<<<PATH>>>/handclosed.cur"), auto;
  cursor: grabbing;
  cursor: -webkit-grabbing;
}

/* Change the cursor on the whole drag surface in case the mouse gets
   ahead of block during a drag. This way the cursor is still a closed hand.
  */
.blocklyBlockDragSurface .blocklyDraggable {
  /* backup for browsers (e.g. IE11) that don't support grabbing */
  cursor: url("<<<PATH>>>/handclosed.cur"), auto;
  cursor: grabbing;
  cursor: -webkit-grabbing;
}

.blocklyDragging.blocklyDraggingDelete {
  cursor: url("<<<PATH>>>/handdelete.cur"), auto;
}

.blocklyDragging>.blocklyPath,
.blocklyDragging>.blocklyPathLight {
  fill-opacity: .8;
  stroke-opacity: .8;
}

.blocklyDragging>.blocklyPathDark {
  display: none;
}

.blocklyDisabled>.blocklyPath {
  fill-opacity: .5;
  stroke-opacity: .5;
}

.blocklyDisabled>.blocklyPathLight,
.blocklyDisabled>.blocklyPathDark {
  display: none;
}

.blocklyInsertionMarker>.blocklyPath,
.blocklyInsertionMarker>.blocklyPathLight,
.blocklyInsertionMarker>.blocklyPathDark {
  fill-opacity: .2;
  stroke: none;
}

.blocklyMultilineText {
  font-family: monospace;
}

.blocklyNonEditableText>text {
  pointer-events: none;
}

.blocklyFlyout {
  position: absolute;
  z-index: 20;
}

.blocklyText text {
  cursor: default;
}

/*
  Don't allow users to select text.  It gets annoying when trying to
  drag a block and selected text moves instead.
*/
.blocklySvg text,
.blocklyBlockDragSurface text {
  user-select: none;
  -ms-user-select: none;
  -webkit-user-select: none;
  cursor: inherit;
}

.blocklyHidden {
  display: none;
}

.blocklyFieldDropdown:not(.blocklyHidden) {
  display: block;
}

.blocklyIconGroup {
  cursor: default;
}

.blocklyIconGroup:not(:hover),
.blocklyIconGroupReadonly {
  opacity: .6;
}

.blocklyIconShape {
  fill: #00f;
  stroke: #fff;
  stroke-width: 1px;
}

.blocklyIconSymbol {
  fill: #fff;
}

.blocklyMinimalBody {
  margin: 0;
  padding: 0;
}

.blocklyHtmlInput {
  border: none;
  border-radius: 4px;
  height: 100%;
  margin: 0;
  outline: none;
  padding: 0;
  width: 100%;
  text-align: center;
  display: block;
  box-sizing: border-box;
}

/* Edge and IE introduce a close icon when the input value is longer than a
   certain length. This affects our sizing calculations of the text input.
   Hiding the close icon to avoid that. */
.blocklyHtmlInput::-ms-clear {
  display: none;
}

.blocklyMainBackground {
  stroke-width: 1;
  stroke: #c6c6c6;  /* Equates to #ddd due to border being off-pixel. */
}

.blocklyMutatorBackground {
  fill: #fff;
  stroke: #ddd;
  stroke-width: 1;
}

.blocklyFlyoutBackground {
  fill: #ddd;
  fill-opacity: .8;
}

.blocklyMainWorkspaceScrollbar {
  z-index: 20;
}

.blocklyFlyoutScrollbar {
  z-index: 30;
}

.blocklyScrollbarHorizontal,
.blocklyScrollbarVertical {
  position: absolute;
  outline: none;
}

.blocklyScrollbarBackground {
  opacity: 0;
}

.blocklyScrollbarHandle {
  fill: #ccc;
}

.blocklyScrollbarBackground:hover+.blocklyScrollbarHandle,
.blocklyScrollbarHandle:hover {
  fill: #bbb;
}

/* Darken flyout scrollbars due to being on a grey background. */
/* By contrast, workspace scrollbars are on a white background. */
.blocklyFlyout .blocklyScrollbarHandle {
  fill: #bbb;
}

.blocklyFlyout .blocklyScrollbarBackground:hover+.blocklyScrollbarHandle,
.blocklyFlyout .blocklyScrollbarHandle:hover {
  fill: #aaa;
}

.blocklyInvalidInput {
  background: #faa;
}

.blocklyVerticalMarker {
  stroke-width: 3px;
  fill: rgba(255,255,255,.5);
  pointer-events: none;
}

.blocklyComputeCanvas {
  position: absolute;
  width: 0;
  height: 0;
}

.blocklyNoPointerEvents {
  pointer-events: none;
}

.blocklyContextMenu {
  border-radius: 4px;
  max-height: 100%;
}

.blocklyDropdownMenu {
  border-radius: 2px;
  padding: 0 !important;
}

.blocklyDropdownMenu .blocklyMenuItem {
  /* 28px on the left for icon or checkbox. */
  padding-left: 28px;
}

/* BiDi override for the resting state. */
.blocklyDropdownMenu .blocklyMenuItemRtl {
  /* Flip left/right padding for BiDi. */
  padding-left: 5px;
  padding-right: 28px;
}

.blocklyWidgetDiv .blocklyMenu {
  background: #fff;
  border: 1px solid transparent;
  box-shadow: 0 0 3px 1px rgba(0,0,0,.3);
  font: normal 13px Arial, sans-serif;
  margin: 0;
  outline: none;
  padding: 4px 0;
  position: absolute;
  overflow-y: auto;
  overflow-x: hidden;
  max-height: 100%;
  z-index: 20000;  /* Arbitrary, but some apps depend on it... */
}

.blocklyWidgetDiv .blocklyMenu.blocklyFocused {
  box-shadow: 0 0 6px 1px rgba(0,0,0,.3);
}

.blocklyDropDownDiv .blocklyMenu {
  background: inherit;  /* Compatibility with gapi, reset from goog-menu */
  border: inherit;  /* Compatibility with gapi, reset from goog-menu */
  font: normal 13px "Helvetica Neue", Helvetica, sans-serif;
  outline: none;
  position: relative;  /* Compatibility with gapi, reset from goog-menu */
  z-index: 20000;  /* Arbitrary, but some apps depend on it... */
}

/* State: resting. */
.blocklyMenuItem {
  border: none;
  color: #000;
  cursor: pointer;
  list-style: none;
  margin: 0;
  /* 7em on the right for shortcut. */
  min-width: 7em;
  padding: 6px 15px;
  white-space: nowrap;
}

/* State: disabled. */
.blocklyMenuItemDisabled {
  color: #ccc;
  cursor: inherit;
}

/* State: hover. */
.blocklyMenuItemHighlight {
  background-color: rgba(0,0,0,.1);
}

/* State: selected/checked. */
.blocklyMenuItemCheckbox {
  height: 16px;
  position: absolute;
  width: 16px;
}

.blocklyMenuItemSelected .blocklyMenuItemCheckbox {
  background: url(<<<PATH>>>/sprites.png) no-repeat -48px -16px;
  float: left;
  margin-left: -24px;
  position: static;  /* Scroll with the menu. */
}

.blocklyMenuItemRtl .blocklyMenuItemCheckbox {
  float: right;
  margin-right: -24px;
}
`,Nd={};Nd.inject=Ec,Nd.register=Ti;var ee=class{constructor(e){this.tagName=e}toString(){return this.tagName}};ee.ANIMATE=new ee("animate"),ee.CIRCLE=new ee("circle"),ee.CLIPPATH=new ee("clipPath"),ee.DEFS=new ee("defs"),ee.FECOMPOSITE=new ee("feComposite"),ee.FECOMPONENTTRANSFER=new ee("feComponentTransfer"),ee.FEFLOOD=new ee("feFlood"),ee.FEFUNCA=new ee("feFuncA"),ee.FEGAUSSIANBLUR=new ee("feGaussianBlur"),ee.FEPOINTLIGHT=new ee("fePointLight"),ee.FESPECULARLIGHTING=new ee("feSpecularLighting"),ee.FILTER=new ee("filter"),ee.FOREIGNOBJECT=new ee("foreignObject"),ee.G=new ee("g"),ee.IMAGE=new ee("image"),ee.LINE=new ee("line"),ee.PATH=new ee("path"),ee.PATTERN=new ee("pattern"),ee.POLYGON=new ee("polygon"),ee.RECT=new ee("rect"),ee.SVG=new ee("svg"),ee.TEXT=new ee("text"),ee.TSPAN=new ee("tspan");var Iv=/translate\(\s*([-+\d.e]+)([ ,]\s*([-+\d.e]+)\s*)?/,Cv=/transform:\s*translate(?:3d)?\(\s*([-+\d.e]+)\s*px([ ,]\s*([-+\d.e]+)\s*px)?/,g0={XY_REGEX:Iv,XY_STYLE_REGEX:Cv},pr={};pr.TEST_ONLY=g0,pr.getDocumentScroll=Nh,pr.getInjectionDivXY=vc,pr.getRelativeXY=Ji,pr.getViewportBBox=Lh,pr.is3dSupported=wm,pr.screenToWsCoordinates=km;var As=8,ru=3,f0=2,Fs=class extends $n{constructor(e,t,r,a,d){super(e,t,r,a,d),this.onMouseMoveWrapper_=this.onMouseUpWrapper_=null,this.eventsInit_=false,this.deleteIconBorder_=this.deleteGroup_=this.resizeGroup_=this.foreignObject_=this.svgHandleTarget_=this.svgRectTarget_=this.textarea_=null,this.rendered_=this.autoLayout_=this.focused_=false,this.svgGroup_=H(ee.G,{class:"blocklyComment"}),this.svgGroup_.translate_="",this.workspace=e,this.svgRect_=H(ee.RECT,{class:"blocklyCommentRect",x:0,y:0,rx:ru,ry:ru}),this.svgGroup_.appendChild(this.svgRect_),this.useDragSurface_=!!e.getBlockDragSurface(),this.render()}dispose(){this.disposed_||(P()===this&&(this.unselect(),this.workspace.cancelCurrentGesture()),ls()&&Pe(new(Re(Fo))(this)),B(this.svgGroup_),this.disposeInternal_(),Zt(),super.dispose(),ss())}initSvg(e){if(!this.workspace.rendered)throw TypeError("Workspace is headless.");this.workspace.options.readOnly||this.eventsInit_||(S(this.svgRectTarget_,"pointerdown",this,this.pathMouseDown_),S(this.svgHandleTarget_,"pointerdown",this,this.pathMouseDown_)),this.eventsInit_=true,this.updateMovable(),this.getSvgRoot().parentNode||this.workspace.getBubbleCanvas().appendChild(this.getSvgRoot()),!e&&this.textarea_&&this.textarea_.select()}pathMouseDown_(e){const t=this.workspace.getGesture(e);t&&t.handleBubbleStart(e,this)}showContextMenu(e){throw Error("The implementation of showContextMenu should be monkey-patched in by blockly.ts")}select(){if(P()!==this){var e=null;if(P()){e=P().id,Zt();try{P().unselect()}finally{ss()}}e=new(Re(dr))(e,this.id,this.workspace.id),Pe(e),F(this),this.addSelect()}}unselect(){if(P()===this){var e=new(Re(dr))(this.id,null,this.workspace.id);Pe(e),F(null),this.removeSelect(),this.blurFocus()}}addSelect(){ie(this.svgGroup_,"blocklySelected"),this.setFocus()}removeSelect(){ie(this.svgGroup_,"blocklySelected"),this.blurFocus()}addFocus(){ie(this.svgGroup_,"blocklyFocused")}removeFocus(){he(this.svgGroup_,"blocklyFocused")}getRelativeToSurfaceXY(){let e=0,t=0;const r=this.useDragSurface_?this.workspace.getBlockDragSurface().getGroup():null;let a=this.getSvgRoot();if(a)do{var d=Ji(a);e+=d.x,t+=d.y,this.useDragSurface_&&this.workspace.getBlockDragSurface().getCurrentBlock()===a&&(d=this.workspace.getBlockDragSurface().getSurfaceTranslation(),e+=d.x,t+=d.y),a=a.parentNode}while(a&&a!==this.workspace.getBubbleCanvas()&&a!==r);return this.xy_=new Oe(e,t)}moveBy(e,t){const r=new(Re(Gn))(this),a=this.getRelativeToSurfaceXY();this.translate(a.x+e,a.y+t),this.xy_=new Oe(a.x+e,a.y+t),r.recordNew(),Pe(r),this.workspace.resizeContents()}translate(e,t){this.xy_=new Oe(e,t),this.getSvgRoot().setAttribute("transform","translate("+e+","+t+")")}moveToDragSurface(){if(this.useDragSurface_){var e=this.getRelativeToSurfaceXY();this.clearTransformAttributes_(),this.workspace.getBlockDragSurface().translateSurface(e.x,e.y),this.workspace.getBlockDragSurface().setBlocksAndShow(this.getSvgRoot())}}moveDuringDrag(e,t){e?e.translateSurface(t.x,t.y):(this.svgGroup_.translate_="translate("+t.x+","+t.y+")",this.svgGroup_.setAttribute("transform",this.svgGroup_.translate_+this.svgGroup_.skew_))}moveTo(e,t){this.translate(e,t)}clearTransformAttributes_(){this.getSvgRoot().removeAttribute("transform")}getBoundingRectangle(){var e=this.getRelativeToSurfaceXY();const t=this.getHeightWidth(),r=e.y,a=e.y+t.height;let d;return this.RTL?(d=e.x-t.width,e=e.x):(d=e.x,e=e.x+t.width),new ts(r,a,d,e)}updateMovable(){this.isMovable()?ie(this.svgGroup_,"blocklyDraggable"):he(this.svgGroup_,"blocklyDraggable")}setMovable(e){super.setMovable(e),this.updateMovable()}setEditable(e){super.setEditable(e),this.textarea_&&(this.textarea_.readOnly=!e)}setDragging(e){e?(e=this.getSvgRoot(),e.translate_="",e.skew_="",ie(this.svgGroup_,"blocklyDragging")):he(this.svgGroup_,"blocklyDragging")}getSvgRoot(){return this.svgGroup_}getContent(){return this.textarea_?this.textarea_.value:this.content_}setContent(e){super.setContent(e),this.textarea_&&(this.textarea_.value=e)}setDeleteStyle(e){e?ie(this.svgGroup_,"blocklyDraggingDelete"):he(this.svgGroup_,"blocklyDraggingDelete")}setAutoLayout(e){}toXmlWithXY(e){let t=0;this.workspace.RTL&&(t=this.workspace.getWidth()),e=this.toXml(e);const r=this.getRelativeToSurfaceXY();return e.setAttribute("x",Math.round(this.workspace.RTL?t-r.x:r.x)),e.setAttribute("y",Math.round(r.y)),e.setAttribute("h",this.getHeight()),e.setAttribute("w",this.getWidth()),e}toCopyData(){return{saveInfo:this.toXmlWithXY(),source:this.workspace,typeCounts:null}}getHeightWidth(){return{width:this.getWidth(),height:this.getHeight()}}render(){if(!this.rendered_){var e=this.getHeightWidth();this.createEditor_(),this.svgGroup_.appendChild(this.foreignObject_),this.svgHandleTarget_=H(ee.RECT,{class:"blocklyCommentHandleTarget",x:0,y:0}),this.svgGroup_.appendChild(this.svgHandleTarget_),this.svgRectTarget_=H(ee.RECT,{class:"blocklyCommentTarget",x:0,y:0,rx:ru,ry:ru}),this.svgGroup_.appendChild(this.svgRectTarget_),this.addResizeDom_(),this.isDeletable()&&this.addDeleteDom_(),this.setSize_(e.width,e.height),this.textarea_.value=this.content_,this.rendered_=true,this.resizeGroup_&&S(this.resizeGroup_,"pointerdown",this,this.resizeMouseDown_),this.isDeletable()&&(S(this.deleteGroup_,"pointerdown",this,this.deleteMouseDown_),S(this.deleteGroup_,"pointerout",this,this.deleteMouseOut_),S(this.deleteGroup_,"pointerup",this,this.deleteMouseUp_))}}createEditor_(){this.foreignObject_=H(ee.FOREIGNOBJECT,{x:0,y:Fs.TOP_OFFSET,class:"blocklyCommentForeignObject"});const e=document.createElementNS(Zi,"body");e.setAttribute("xmlns",Zi),e.className="blocklyMinimalBody";const t=document.createElementNS(Zi,"textarea");return t.className="blocklyCommentTextarea",t.setAttribute("dir",this.RTL?"RTL":"LTR"),t.readOnly=!this.isEditable(),e.appendChild(t),this.textarea_=t,this.foreignObject_.appendChild(e),S(t,"wheel",this,function(r){r.stopPropagation()}),S(t,"change",this,function(r){this.setContent(t.value)}),this.foreignObject_}addResizeDom_(){this.resizeGroup_=H(ee.G,{class:this.RTL?"blocklyResizeSW":"blocklyResizeSE"},this.svgGroup_),H(ee.POLYGON,{points:"0,x x,x x,0".replace(/x/g,As.toString())},this.resizeGroup_),H(ee.LINE,{class:"blocklyResizeLine",x1:As/3,y1:As-1,x2:As-1,y2:As/3},this.resizeGroup_),H(ee.LINE,{class:"blocklyResizeLine",x1:2*As/3,y1:As-1,x2:As-1,y2:2*As/3},this.resizeGroup_)}addDeleteDom_(){this.deleteGroup_=H(ee.G,{class:"blocklyCommentDeleteIcon"},this.svgGroup_),this.deleteIconBorder_=H(ee.CIRCLE,{class:"blocklyDeleteIconShape",r:"7",cx:"7.5",cy:"7.5"},this.deleteGroup_),H(ee.LINE,{x1:"5",y1:"10",x2:"10",y2:"5",stroke:"#fff","stroke-width":"2"},this.deleteGroup_),H(ee.LINE,{x1:"5",y1:"5",x2:"10",y2:"10",stroke:"#fff","stroke-width":"2"},this.deleteGroup_)}resizeMouseDown_(e){this.unbindDragEvents_(),v(e)||(this.workspace.startDrag(e,new Oe(this.workspace.RTL?-this.width_:this.width_,this.height_)),this.onMouseUpWrapper_=S(document,"pointerup",this,this.resizeMouseUp_),this.onMouseMoveWrapper_=S(document,"pointermove",this,this.resizeMouseMove_),this.workspace.hideChaff()),e.stopPropagation()}deleteMouseDown_(e){this.deleteIconBorder_&&ie(this.deleteIconBorder_,"blocklyDeleteIconHighlighted"),e.stopPropagation()}deleteMouseOut_(e){this.deleteIconBorder_&&he(this.deleteIconBorder_,"blocklyDeleteIconHighlighted")}deleteMouseUp_(e){this.dispose(),e.stopPropagation()}unbindDragEvents_(){this.onMouseUpWrapper_&&(g(this.onMouseUpWrapper_),this.onMouseUpWrapper_=null),this.onMouseMoveWrapper_&&(g(this.onMouseMoveWrapper_),this.onMouseMoveWrapper_=null)}resizeMouseUp_(e){m(),this.unbindDragEvents_()}resizeMouseMove_(e){this.autoLayout_=false,e=this.workspace.moveDrag(e),this.setSize_(this.RTL?-e.x:e.x,e.y)}resizeComment_(){const e=this.getHeightWidth(),t=Fs.TOP_OFFSET,r=2*f0;this.foreignObject_.setAttribute("width",e.width),this.foreignObject_.setAttribute("height",(e.height-t).toString()),this.RTL&&this.foreignObject_.setAttribute("x",(-e.width).toString()),this.textarea_.style.width=e.width-r+"px",this.textarea_.style.height=e.height-r-t+"px"}setSize_(e,t){e=Math.max(e,45),t=Math.max(t,20+Fs.TOP_OFFSET),this.width_=e,this.height_=t,this.svgRect_.setAttribute("width",e),this.svgRect_.setAttribute("height",t),this.svgRectTarget_.setAttribute("width",e),this.svgRectTarget_.setAttribute("height",t),this.svgHandleTarget_.setAttribute("width",e),this.svgHandleTarget_.setAttribute("height",Fs.TOP_OFFSET),this.RTL&&(this.svgRect_.setAttribute("transform","scale(-1 1)"),this.svgRectTarget_.setAttribute("transform","scale(-1 1)")),this.resizeGroup_&&(this.RTL?(this.resizeGroup_.setAttribute("transform","translate("+(-e+As)+","+(t-As)+") scale(-1 1)"),this.deleteGroup_.setAttribute("transform","translate("+(-e+As)+","+-As+") scale(-1 1)")):(this.resizeGroup_.setAttribute("transform","translate("+(e-As)+","+(t-As)+")"),this.deleteGroup_.setAttribute("transform","translate("+(e-As)+","+-As+")"))),this.resizeComment_()}disposeInternal_(){this.svgHandleTarget_=this.svgRectTarget_=this.foreignObject_=this.textarea_=null,this.disposed_=true}setFocus(){this.focused_=true,setTimeout(()=>{this.disposed_||(this.textarea_.focus(),this.addFocus(),this.svgRectTarget_&&ie(this.svgRectTarget_,"blocklyCommentTargetFocused"),this.svgHandleTarget_&&ie(this.svgHandleTarget_,"blocklyCommentHandleTargetFocused"))},0)}blurFocus(){this.focused_=false,setTimeout(()=>{this.disposed_||(this.textarea_.blur(),this.removeFocus(),this.svgRectTarget_&&he(this.svgRectTarget_,"blocklyCommentTargetFocused"),this.svgHandleTarget_&&he(this.svgHandleTarget_,"blocklyCommentHandleTargetFocused"))},0)}static fromXmlRendered(e,t,r){Zt();let a;try{const d=$n.parseAttributes(e);if(a=new Fs(t,d.content,d.h,d.w,d.id),t.rendered&&(a.initSvg(true),a.render()),!isNaN(d.x)&&!isNaN(d.y))if(t.RTL){const C=r||t.getWidth();a.moveBy(C-d.x,d.y)}else a.moveBy(d.x,d.y)}finally{ss()}return $n.fireCreateEvent(a),a}};Fs.DEFAULT_SIZE=100,Fs.TOP_OFFSET=10,Ti(`
.blocklyCommentForeignObject {
  position: relative;
  z-index: 0;
}

.blocklyCommentRect {
  fill: #E7DE8E;
  stroke: #bcA903;
  stroke-width: 1px;
}

.blocklyCommentTarget {
  fill: transparent;
  stroke: #bcA903;
}

.blocklyCommentTargetFocused {
  fill: none;
}

.blocklyCommentHandleTarget {
  fill: none;
}

.blocklyCommentHandleTargetFocused {
  fill: transparent;
}

.blocklyFocused>.blocklyCommentRect {
  fill: #B9B272;
  stroke: #B9B272;
}

.blocklySelected>.blocklyCommentTarget {
  stroke: #fc3;
  stroke-width: 3px;
}

.blocklyCommentDeleteIcon {
  cursor: pointer;
  fill: #000;
  display: none;
}

.blocklySelected > .blocklyCommentDeleteIcon {
  display: block;
}

.blocklyDeleteIconShape {
  fill: #000;
  stroke: #000;
  stroke-width: 1px;
}

.blocklyDeleteIconShape.blocklyDeleteIconHighlighted {
  stroke: #fc3;
}
`),i.module$build$src$core$xml={},i.module$build$src$core$xml.appendDomToWorkspace=YI,i.module$build$src$core$xml.blockToDom=Ur,i.module$build$src$core$xml.blockToDomWithXY=bc,i.module$build$src$core$xml.clearWorkspaceAndLoadFromXml=KI,i.module$build$src$core$xml.deleteNext=nC,i.module$build$src$core$xml.domToBlock=Co,i.module$build$src$core$xml.domToPrettyText=XI,i.module$build$src$core$xml.domToText=Bi,i.module$build$src$core$xml.domToVariables=Nm,i.module$build$src$core$xml.domToWorkspace=Da,i.module$build$src$core$xml.textToDom=zs,i.module$build$src$core$xml.variablesToDom=Am,i.module$build$src$core$xml.workspaceToDom=WI;var Vo=class extends Jr{constructor(e){super(),this.isBlank=!e,e&&(this.blockId=e.id,this.workspaceId=e.workspace.id)}toJson(){const e=super.toJson();if(!this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");return e.blockId=this.blockId,e}fromJson(e){o("Blockly.Events.BlockBase.prototype.fromJson","version 9","version 10","Blockly.Events.fromJson"),super.fromJson(e),this.blockId=e.blockId}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new Vo),t.blockId=e.blockId,t}},Zr=class extends Vo{constructor(e,t,r,a,d){super(e),this.type=bs,e&&(this.element=t,this.name=r||void 0,this.oldValue=a,this.newValue=d)}toJson(){const e=super.toJson();if(!this.element)throw Error("The changed element is undefined. Either pass an element to the constructor, or call fromJson");return e.element=this.element,e.name=this.name,e.oldValue=this.oldValue,e.newValue=this.newValue,e}fromJson(e){o("Blockly.Events.BlockChange.prototype.fromJson","version 9","version 10","Blockly.Events.fromJson"),super.fromJson(e),this.element=e.element,this.name=e.name,this.oldValue=e.oldValue,this.newValue=e.newValue}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new Zr),t.element=e.element,t.name=e.name,t.oldValue=e.oldValue,t.newValue=e.newValue,t}isNull(){return this.oldValue===this.newValue}run(e){var t=this.getEventWorkspace_();if(!this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");if(t=t.getBlockById(this.blockId),!t)throw Error("The associated block is undefined. Either pass a block to the constructor, or call fromJson");switch(t.mutator&&t.mutator.setVisible(false),e=e?this.newValue:this.oldValue,this.element){case"field":(t=t.getField(this.name))?t.setValue(e):console.warn("Can't set non-existent field: "+this.name);break;case"comment":t.setCommentText(e||null);break;case"collapsed":t.setCollapsed(!!e);break;case"disabled":t.setEnabled(!e);break;case"inline":t.setInputsInline(!!e);break;case"mutation":const r=Zr.getExtraBlockState_(t);t.loadExtraState?t.loadExtraState(JSON.parse(e||"{}")):t.domToMutation&&t.domToMutation(zs(e||"<mutation/>")),Pe(new Zr(t,"mutation",null,r,e));break;default:console.warn("Unknown change type: "+this.element)}}static getExtraBlockState_(e){return e.saveExtraState?(e=e.saveExtraState())?JSON.stringify(e):"":e.mutationToDom&&(e=e.mutationToDom())?Bi(e):""}};$e(Te.EVENT,bs,Zr);var Za=class{constructor(e){this.workspace=e,this.cursorSvg_=this.cursor_=null,this.markers=new Map,this.markerSvg_=null}registerMarker(e,t){this.markers.has(e)&&this.unregisterMarker(e),t.setDrawer(this.workspace.getRenderer().makeMarkerDrawer(this.workspace,t)),this.setMarkerSvg(t.getDrawer().createDom()),this.markers.set(e,t)}unregisterMarker(e){const t=this.markers.get(e);if(t)t.dispose(),this.markers.delete(e);else throw Error("Marker with ID "+e+" does not exist. Can only unregister markers that exist.")}getCursor(){return this.cursor_}getMarker(e){return this.markers.get(e)||null}setCursor(e){this.cursor_&&this.cursor_.getDrawer()&&this.cursor_.getDrawer().dispose(),(this.cursor_=e)&&(e=this.workspace.getRenderer().makeMarkerDrawer(this.workspace,this.cursor_),this.cursor_.setDrawer(e),this.setCursorSvg(this.cursor_.getDrawer().createDom()))}setCursorSvg(e){e?(this.workspace.getBlockCanvas().appendChild(e),this.cursorSvg_=e):this.cursorSvg_=null}setMarkerSvg(e){e?this.workspace.getBlockCanvas()&&(this.cursorSvg_?this.workspace.getBlockCanvas().insertBefore(e,this.cursorSvg_):this.workspace.getBlockCanvas().appendChild(e)):this.markerSvg_=null}updateMarkers(){this.workspace.keyboardAccessibilityMode&&this.cursorSvg_&&this.workspace.getCursor().draw()}dispose(){const e=Object.keys(this.markers);for(let t=0,r;r=e[t];t++)this.unregisterMarker(r);this.markers.clear(),this.cursor_&&(this.cursor_.dispose(),this.cursor_=null)}};Za.LOCAL_MARKER="local_marker_1",i.module$build$src$core$utils$string={},i.module$build$src$core$utils$string.commonWordPrefix=Dm,i.module$build$src$core$utils$string.commonWordSuffix=xm,i.module$build$src$core$utils$string.isNumber=Um,i.module$build$src$core$utils$string.shortestStringLength=Tc,i.module$build$src$core$utils$string.startsWith=rC,i.module$build$src$core$utils$string.wrap=Bm;var ou=void 0,Qa=false,Wo=false,Ov=50,wv=0,el=0,Md=0,Dd=0,Ui=null,tl=null,xd=0,Bd=10,kv=10,Av=750,au=5,us=null,ns={};ns.HOVER_MS=Av,ns.LIMIT=Ov,ns.MARGINS=au,ns.OFFSET_X=xd,ns.OFFSET_Y=Bd,ns.RADIUS_OK=kv,ns.bindMouseEvents=Sc,ns.block=Wm,ns.createDom=Gm,ns.dispose=Vm,ns.getCustomTooltip=cC,ns.getDiv=hC,ns.getTooltipOfObject=xa,ns.hide=Fr,ns.isVisible=uC,ns.setCustomTooltip=lC,ns.unbindMouseEvents=$c,ns.unblock=zm;var Pd=.45,Ud=.65,Lv={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00"},Gs={};Gs.blend=Oo,Gs.getHsvSaturation=jm,Gs.getHsvValue=Xm,Gs.hexToRgb=xh,Gs.hsvToHex=Bh,Gs.hueToHex=Ph,Gs.names=Lv,Gs.parse=Gr,Gs.rgbToHex=yc,Gs.setHsvSaturation=EC,Gs.setHsvValue=vC;var sl={};sl.checkMessageReferences=Rc,sl.parseBlockColour=wo,sl.replaceMessageReferences=es,sl.tokenizeInterpolation=Fh;var m0=class{},lu=null,cu=null,zo="",jo="",sn,nn={};nn.createDom=Km,nn.getDiv=ko,nn.hide=En,nn.hideIfOwner=Hh,nn.isVisible=Ym,nn.positionWithAnchor=Jm,nn.show=Gh,nn.testOnly_setDiv=bC;var pt=class{constructor(e,t,r){this.DEFAULT_VALUE=null,this.name=void 0,this.constants_=this.mouseDownWrapper_=this.textContent_=this.textElement_=this.borderRect_=this.fieldGroup_=this.markerSvg_=this.cursorSvg_=this.tooltip_=this.validator_=null,this.disposed=false,this.maxDisplayLength=50,this.sourceBlock_=null,this.enabled_=this.visible_=this.isDirty_=true,this.suffixField=this.prefixField=this.clickTarget_=null,this.EDITABLE=true,this.SERIALIZABLE=false,this.CURSOR="",this.value_="DEFAULT_VALUE"in new.target.prototype?new.target.prototype.DEFAULT_VALUE:this.DEFAULT_VALUE,this.size_=new Ss(0,0),e!==pt.SKIP_SETUP&&(r&&this.configure_(r),this.setValue(e),t&&this.setValidator(t))}configure_(e){e.tooltip&&this.setTooltip(es(e.tooltip))}setSourceBlock(e){if(this.sourceBlock_)throw Error("Field already bound to a block");this.sourceBlock_=e}getConstants(){return!this.constants_&&this.sourceBlock_&&!this.sourceBlock_.isDeadOrDying()&&this.sourceBlock_.workspace.rendered&&(this.constants_=this.sourceBlock_.workspace.getRenderer().getConstants()),this.constants_}getSourceBlock(){return this.sourceBlock_}init(){this.fieldGroup_||(this.fieldGroup_=H(ee.G,{}),this.isVisible()||(this.fieldGroup_.style.display="none"),this.sourceBlock_.getSvgRoot().appendChild(this.fieldGroup_),this.initView(),this.updateEditable(),this.setTooltip(this.tooltip_),this.bindEvents_(),this.initModel())}initView(){this.createBorderRect_(),this.createTextElement_()}initModel(){}createBorderRect_(){this.borderRect_=H(ee.RECT,{rx:this.getConstants().FIELD_BORDER_RECT_RADIUS,ry:this.getConstants().FIELD_BORDER_RECT_RADIUS,x:0,y:0,height:this.size_.height,width:this.size_.width,class:"blocklyFieldRect"},this.fieldGroup_)}createTextElement_(){this.textElement_=H(ee.TEXT,{class:"blocklyText"},this.fieldGroup_),this.getConstants().FIELD_TEXT_BASELINE_CENTER&&this.textElement_.setAttribute("dominant-baseline","central"),this.textContent_=document.createTextNode(""),this.textElement_.appendChild(this.textContent_)}bindEvents_(){const e=this.getClickTarget_();if(!e)throw Error("A click target has not been set.");Sc(e),this.mouseDownWrapper_=S(e,"pointerdown",this,this.onMouseDown_)}fromXml(e){this.setValue(e.textContent)}toXml(e){return e.textContent=this.getValue(),e}saveState(e){return e=this.saveLegacyState(pt),e!==null?e:this.getValue()}loadState(e){this.loadLegacyState(pt,e)||this.setValue(e)}saveLegacyState(e){return e.prototype.saveState===this.saveState&&e.prototype.toXml!==this.toXml?(e=ot("field"),e.setAttribute("name",this.name||""),Bi(this.toXml(e)).replace(' xmlns="https://developers.google.com/blockly/xml"',"")):null}loadLegacyState(e,t){return e.prototype.loadState===this.loadState&&e.prototype.fromXml!==this.fromXml?(this.fromXml(zs(t)),true):false}dispose(){et(this),Hh(this),$c(this.getClickTarget_()),this.mouseDownWrapper_&&g(this.mouseDownWrapper_),B(this.fieldGroup_),this.disposed=true}updateEditable(){const e=this.fieldGroup_,t=this.getSourceBlock();this.EDITABLE&&e&&t&&(this.enabled_&&t.isEditable()?(ie(e,"blocklyEditableText"),he(e,"blocklyNonEditableText"),e.style.cursor=this.CURSOR):(ie(e,"blocklyNonEditableText"),he(e,"blocklyEditableText"),e.style.cursor=""))}setEnabled(e){this.enabled_=e,this.updateEditable()}isEnabled(){return this.enabled_}isClickable(){return this.enabled_&&!!this.sourceBlock_&&this.sourceBlock_.isEditable()&&this.showEditor_!==pt.prototype.showEditor_}isCurrentlyEditable(){return this.enabled_&&this.EDITABLE&&!!this.sourceBlock_&&this.sourceBlock_.isEditable()}isSerializable(){let e=false;return this.name&&(this.SERIALIZABLE?e=true:this.EDITABLE&&(console.warn("Detected an editable field that was not serializable. Please define SERIALIZABLE property as true on all editable custom fields. Proceeding with serialization."),e=true)),e}isVisible(){return this.visible_}setVisible(e){if(this.visible_!==e){this.visible_=e;var t=this.fieldGroup_;t&&(t.style.display=e?"block":"none")}}setValidator(e){this.validator_=e}getValidator(){return this.validator_}getSvgRoot(){return this.fieldGroup_}getBorderRect(){if(!this.borderRect_)throw Error(`The border rectangle is ${this.borderRect_}.`);return this.borderRect_}getTextElement(){if(!this.textElement_)throw Error(`The text element is ${this.textElement_}.`);return this.textElement_}getTextContent(){if(!this.textContent_)throw Error(`The text content is ${this.textContent_}.`);return this.textContent_}applyColour(){}render_(){this.textContent_&&(this.textContent_.nodeValue=this.getDisplayText_()),this.updateSize_()}showEditor(e){this.isClickable()&&this.showEditor_(e)}showEditor_(e){}updateSize_(e){const t=this.getConstants();e=e!==void 0?e:this.borderRect_?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0;let r=2*e,a=t.FIELD_TEXT_HEIGHT,d=0;this.textElement_&&(d=St(this.textElement_,t.FIELD_TEXT_FONTSIZE,t.FIELD_TEXT_FONTWEIGHT,t.FIELD_TEXT_FONTFAMILY),r+=d),this.borderRect_&&(a=Math.max(a,t.FIELD_BORDER_RECT_HEIGHT)),this.size_.height=a,this.size_.width=r,this.positionTextElement_(e,d),this.positionBorderRect_()}positionTextElement_(e,t){if(this.textElement_){var r=this.getConstants(),a=this.size_.height/2,d;this.textElement_.setAttribute("x",`${(d=this.getSourceBlock())!=null&&d.RTL?this.size_.width-t-e:e}`),this.textElement_.setAttribute("y",`${r.FIELD_TEXT_BASELINE_CENTER?a:a-r.FIELD_TEXT_HEIGHT/2+r.FIELD_TEXT_BASELINE}`)}}positionBorderRect_(){this.borderRect_&&(this.borderRect_.setAttribute("width",`${this.size_.width}`),this.borderRect_.setAttribute("height",`${this.size_.height}`),this.borderRect_.setAttribute("rx",`${this.getConstants().FIELD_BORDER_RECT_RADIUS}`),this.borderRect_.setAttribute("ry",`${this.getConstants().FIELD_BORDER_RECT_RADIUS}`))}getSize(){return this.isVisible()?(this.isDirty_?(this.render_(),this.isDirty_=false):this.visible_&&this.size_.width===0&&(this.render_(),this.size_.width!==0&&console.warn("Deprecated use of setting size_.width to 0 to rerender a field. Set field.isDirty_ to true instead.")),this.size_):new Ss(0,0)}getScaledBBox(){let e;var t=this.getSourceBlock();if(!t)throw new hs;if(this.borderRect_){var r=this.borderRect_.getBoundingClientRect();e=qe(this.borderRect_),t=r.width,r=r.height}else{r=this.sourceBlock_.getHeightWidth();const a=t.workspace.scale;e=this.getAbsoluteXY_(),t=(r.width+1)*a,r=(r.height+1)*a,_d?(e.x+=1.5*a,e.y+=1.5*a):(e.x-=.5*a,e.y-=.5*a)}return new ts(e.y,e.y+r,e.x,e.x+t)}getDisplayText_(){let e=this.getText();return e?(e.length>this.maxDisplayLength&&(e=e.substring(0,this.maxDisplayLength-2)+"…"),e=e.replace(/\s/g,pt.NBSP),this.sourceBlock_&&this.sourceBlock_.RTL&&(e+="‏"),e):pt.NBSP}getText(){const e=this.getText_();return String(e!==null?e:this.getValue())}getText_(){return null}markDirty(){this.isDirty_=true,this.constants_=null}forceRerender(){this.isDirty_=true,this.sourceBlock_&&this.sourceBlock_.rendered&&(this.sourceBlock_.render(),this.sourceBlock_.bumpNeighbours(),this.updateMarkers_())}setValue(e){if(e!==null){var t=this.doClassValidation_(e);if(e=this.processValidation_(e,t),!(e instanceof Error)){if((t=this.getValidator())&&(t=t.call(this,e),e=this.processValidation_(e,t),e instanceof Error))return;if(t=this.sourceBlock_,!t||!t.disposed){var r=this.getValue();r===e?this.doValueUpdate_(e):(this.doValueUpdate_(e),t&&ls()&&Pe(new(Re(bs))(t,"field",this.name||null,r,e)),this.isDirty_&&this.forceRerender())}}}}processValidation_(e,t){return t===null?(this.doValueInvalid_(e),this.isDirty_&&this.forceRerender(),Error()):(t!==void 0&&(e=t),e)}getValue(){return this.value_}doClassValidation_(e){return e??null}doValueUpdate_(e){this.value_=e,this.isDirty_=true}doValueInvalid_(e){}onMouseDown_(e){this.sourceBlock_&&!this.sourceBlock_.isDeadOrDying()&&(e=this.sourceBlock_.workspace.getGesture(e))&&e.setStartField(this)}setTooltip(e){e||e===""||(e=this.sourceBlock_);const t=this.getClickTarget_();t?t.tooltip=e:this.tooltip_=e}getTooltip(){const e=this.getClickTarget_();return xa(e||{tooltip:this.tooltip_})}getClickTarget_(){return this.clickTarget_||this.getSvgRoot()}getAbsoluteXY_(){return qe(this.getClickTarget_())}referencesVariables(){return false}refreshVariableName(){}getParentInput(){let e=null;const t=this.getSourceBlock();if(!t)throw new hs;const r=t.inputList;for(let a=0;a<t.inputList.length;a++){const d=r[a],C=d.fieldRow;for(let D=0;D<C.length;D++)if(C[D]===this){e=d;break}}return e}getFlipRtl(){return false}isTabNavigable(){return false}onShortcut(e){return false}setCursorSvg(e){if(e){if(!this.fieldGroup_)throw Error(`The field group is ${this.fieldGroup_}.`);this.fieldGroup_.appendChild(e),this.cursorSvg_=e}else this.cursorSvg_=null}setMarkerSvg(e){if(e){if(!this.fieldGroup_)throw Error(`The field group is ${this.fieldGroup_}.`);this.fieldGroup_.appendChild(e),this.markerSvg_=e}else this.markerSvg_=null}updateMarkers_(){var e=this.getSourceBlock();if(!e)throw new hs;e=e.workspace,e.keyboardAccessibilityMode&&this.cursorSvg_&&e.getCursor().draw(),e.keyboardAccessibilityMode&&this.markerSvg_&&e.getMarker(Za.LOCAL_MARKER).draw()}};pt.NBSP=" ",pt.SKIP_SETUP=new m0;var hs=class extends Error{constructor(){super("The field has not yet been attached to its input. Call appendField to attach it.")}},Nv={fromJsonInternal:yC},il={};il.TEST_ONLY=Nv,il.fromJson=Vh,il.register=Pi,il.unregister=$C;var E0="aria-",v0="role",ci;(function(e){e.GRID="grid",e.GRIDCELL="gridcell",e.GROUP="group",e.LISTBOX="listbox",e.MENU="menu",e.MENUITEM="menuitem",e.MENUITEMCHECKBOX="menuitemcheckbox",e.OPTION="option",e.PRESENTATION="presentation",e.ROW="row",e.TREE="tree",e.TREEITEM="treeitem"})(ci||(ci={}));var Gt;(function(e){e.ACTIVEDESCENDANT="activedescendant",e.COLCOUNT="colcount",e.DISABLED="disabled",e.EXPANDED="expanded",e.INVALID="invalid",e.LABEL="label",e.LABELLEDBY="labelledby",e.LEVEL="level",e.ORIENTATION="orientation",e.POSINSET="posinset",e.ROWCOUNT="rowcount",e.SELECTED="selected",e.SETSIZE="setsize",e.VALUEMAX="valuemax",e.VALUEMIN="valuemin"})(Gt||(Gt={}));var nl={};nl.Role=ci,nl.State=Gt,nl.setRole=vn,nl.setState=Xt;var xe;(function(e){e[e.WIN_KEY_FF_LINUX=0]="WIN_KEY_FF_LINUX",e[e.MAC_ENTER=3]="MAC_ENTER",e[e.BACKSPACE=8]="BACKSPACE",e[e.TAB=9]="TAB",e[e.NUM_CENTER=12]="NUM_CENTER",e[e.ENTER=13]="ENTER",e[e.SHIFT=16]="SHIFT",e[e.CTRL=17]="CTRL",e[e.ALT=18]="ALT",e[e.PAUSE=19]="PAUSE",e[e.CAPS_LOCK=20]="CAPS_LOCK",e[e.ESC=27]="ESC",e[e.SPACE=32]="SPACE",e[e.PAGE_UP=33]="PAGE_UP",e[e.PAGE_DOWN=34]="PAGE_DOWN",e[e.END=35]="END",e[e.HOME=36]="HOME",e[e.LEFT=37]="LEFT",e[e.UP=38]="UP",e[e.RIGHT=39]="RIGHT",e[e.DOWN=40]="DOWN",e[e.PLUS_SIGN=43]="PLUS_SIGN",e[e.PRINT_SCREEN=44]="PRINT_SCREEN",e[e.INSERT=45]="INSERT",e[e.DELETE=46]="DELETE",e[e.ZERO=48]="ZERO",e[e.ONE=49]="ONE",e[e.TWO=50]="TWO",e[e.THREE=51]="THREE",e[e.FOUR=52]="FOUR",e[e.FIVE=53]="FIVE",e[e.SIX=54]="SIX",e[e.SEVEN=55]="SEVEN",e[e.EIGHT=56]="EIGHT",e[e.NINE=57]="NINE",e[e.FF_SEMICOLON=59]="FF_SEMICOLON",e[e.FF_EQUALS=61]="FF_EQUALS",e[e.FF_DASH=173]="FF_DASH",e[e.FF_HASH=163]="FF_HASH",e[e.QUESTION_MARK=63]="QUESTION_MARK",e[e.AT_SIGN=64]="AT_SIGN",e[e.A=65]="A",e[e.B=66]="B",e[e.C=67]="C",e[e.D=68]="D",e[e.E=69]="E",e[e.F=70]="F",e[e.G=71]="G",e[e.H=72]="H",e[e.I=73]="I",e[e.J=74]="J",e[e.K=75]="K",e[e.L=76]="L",e[e.M=77]="M",e[e.N=78]="N",e[e.O=79]="O",e[e.P=80]="P",e[e.Q=81]="Q",e[e.R=82]="R",e[e.S=83]="S",e[e.T=84]="T",e[e.U=85]="U",e[e.V=86]="V",e[e.W=87]="W",e[e.X=88]="X",e[e.Y=89]="Y",e[e.Z=90]="Z",e[e.META=91]="META",e[e.WIN_KEY_RIGHT=92]="WIN_KEY_RIGHT",e[e.CONTEXT_MENU=93]="CONTEXT_MENU",e[e.NUM_ZERO=96]="NUM_ZERO",e[e.NUM_ONE=97]="NUM_ONE",e[e.NUM_TWO=98]="NUM_TWO",e[e.NUM_THREE=99]="NUM_THREE",e[e.NUM_FOUR=100]="NUM_FOUR",e[e.NUM_FIVE=101]="NUM_FIVE",e[e.NUM_SIX=102]="NUM_SIX",e[e.NUM_SEVEN=103]="NUM_SEVEN",e[e.NUM_EIGHT=104]="NUM_EIGHT",e[e.NUM_NINE=105]="NUM_NINE",e[e.NUM_MULTIPLY=106]="NUM_MULTIPLY",e[e.NUM_PLUS=107]="NUM_PLUS",e[e.NUM_MINUS=109]="NUM_MINUS",e[e.NUM_PERIOD=110]="NUM_PERIOD",e[e.NUM_DIVISION=111]="NUM_DIVISION",e[e.F1=112]="F1",e[e.F2=113]="F2",e[e.F3=114]="F3",e[e.F4=115]="F4",e[e.F5=116]="F5",e[e.F6=117]="F6",e[e.F7=118]="F7",e[e.F8=119]="F8",e[e.F9=120]="F9",e[e.F10=121]="F10",e[e.F11=122]="F11",e[e.F12=123]="F12",e[e.NUMLOCK=144]="NUMLOCK",e[e.SCROLL_LOCK=145]="SCROLL_LOCK",e[e.FIRST_MEDIA_KEY=166]="FIRST_MEDIA_KEY",e[e.LAST_MEDIA_KEY=183]="LAST_MEDIA_KEY",e[e.SEMICOLON=186]="SEMICOLON",e[e.DASH=189]="DASH",e[e.EQUALS=187]="EQUALS",e[e.COMMA=188]="COMMA",e[e.PERIOD=190]="PERIOD",e[e.SLASH=191]="SLASH",e[e.APOSTROPHE=192]="APOSTROPHE",e[e.TILDE=192]="TILDE",e[e.SINGLE_QUOTE=222]="SINGLE_QUOTE",e[e.OPEN_SQUARE_BRACKET=219]="OPEN_SQUARE_BRACKET",e[e.BACKSLASH=220]="BACKSLASH",e[e.CLOSE_SQUARE_BRACKET=221]="CLOSE_SQUARE_BRACKET",e[e.WIN_KEY=224]="WIN_KEY",e[e.MAC_FF_META=224]="MAC_FF_META",e[e.MAC_WK_CMD_LEFT=91]="MAC_WK_CMD_LEFT",e[e.MAC_WK_CMD_RIGHT=93]="MAC_WK_CMD_RIGHT",e[e.WIN_IME=229]="WIN_IME",e[e.VK_NONAME=252]="VK_NONAME",e[e.PHANTOM=255]="PHANTOM"})(xe||(xe={}));var Fd=class{constructor(){this.menuItems=[],this.roleName=this.element=this.onKeyDownHandler=this.mouseLeaveHandler=this.mouseEnterHandler=this.clickHandler=this.mouseOverHandler=this.highlightedItem=this.openingCoords=null}addChild(e){this.menuItems.push(e)}render(e){const t=document.createElement("div");t.className="blocklyMenu goog-menu blocklyNonSelectable",t.tabIndex=0,this.roleName&&vn(t,this.roleName),this.element=t;for(let r=0,a;a=this.menuItems[r];r++)t.appendChild(a.createDom());return this.mouseOverHandler=S(t,"pointerover",this,this.handleMouseOver,true),this.clickHandler=S(t,"pointerdown",this,this.handleClick,true),this.mouseEnterHandler=S(t,"pointerenter",this,this.handleMouseEnter,true),this.mouseLeaveHandler=S(t,"pointerleave",this,this.handleMouseLeave,true),this.onKeyDownHandler=S(t,"keydown",this,this.handleKeyEvent),e.appendChild(t),t}getElement(){return this.element}focus(){const e=this.getElement();e&&(e.focus({preventScroll:true}),ie(e,"blocklyFocused"))}blur(){const e=this.getElement();e&&(e.blur(),he(e,"blocklyFocused"))}setRole(e){this.roleName=e}dispose(){this.mouseOverHandler&&(g(this.mouseOverHandler),this.mouseOverHandler=null),this.clickHandler&&(g(this.clickHandler),this.clickHandler=null),this.mouseEnterHandler&&(g(this.mouseEnterHandler),this.mouseEnterHandler=null),this.mouseLeaveHandler&&(g(this.mouseLeaveHandler),this.mouseLeaveHandler=null),this.onKeyDownHandler&&(g(this.onKeyDownHandler),this.onKeyDownHandler=null);for(let e=0,t;t=this.menuItems[e];e++)t.dispose();this.element=null}getMenuItem(e){const t=this.getElement();for(;e&&e!==t;){if(e.classList.contains("blocklyMenuItem")){for(let r=0,a;a=this.menuItems[r];r++)if(a.getElement()===e)return a}e=e.parentElement}return null}setHighlighted(e){var t=this.highlightedItem;t&&(t.setHighlighted(false),this.highlightedItem=null),e&&(e.setHighlighted(true),this.highlightedItem=e,t=this.getElement(),Ee(e.getElement(),t),Xt(t,Gt.ACTIVEDESCENDANT,e.getId()))}highlightNext(){const e=this.highlightedItem?this.menuItems.indexOf(this.highlightedItem):-1;this.highlightHelper(e,1)}highlightPrevious(){const e=this.highlightedItem?this.menuItems.indexOf(this.highlightedItem):-1;this.highlightHelper(0>e?this.menuItems.length:e,-1)}highlightFirst(){this.highlightHelper(-1,1)}highlightLast(){this.highlightHelper(this.menuItems.length,-1)}highlightHelper(e,t){e+=t;let r;for(;r=this.menuItems[e];){if(r.isEnabled()){this.setHighlighted(r);break}e+=t}}handleMouseOver(e){(e=this.getMenuItem(e.target))&&(e.isEnabled()?this.highlightedItem!==e&&this.setHighlighted(e):this.setHighlighted(null))}handleClick(e){const t=this.openingCoords;if(this.openingCoords=null,t&&typeof e.clientX=="number"){const r=new Oe(e.clientX,e.clientY);if(1>Oe.distance(t,r))return}(e=this.getMenuItem(e.target))&&e.performAction()}handleMouseEnter(e){this.focus()}handleMouseLeave(e){this.getElement()&&(this.blur(),this.setHighlighted(null))}handleKeyEvent(e){if(this.menuItems.length&&!(e.shiftKey||e.ctrlKey||e.metaKey||e.altKey)){var t=this.highlightedItem;switch(e.keyCode){case xe.ENTER:case xe.SPACE:t&&t.performAction();break;case xe.UP:this.highlightPrevious();break;case xe.DOWN:this.highlightNext();break;case xe.PAGE_UP:case xe.HOME:this.highlightFirst();break;case xe.PAGE_DOWN:case xe.END:this.highlightLast();break;default:return}e.preventDefault(),e.stopPropagation()}}getSize(){const e=this.getElement(),t=Os(e);return t.height=e.scrollHeight,t}},Gd=class{constructor(e,t){this.content=e,this.opt_value=t,this.enabled=true,this.element=null,this.rightToLeft=false,this.roleName=null,this.highlight=this.checked=this.checkable=false,this.actionHandler=null}createDom(){const e=document.createElement("div");e.id=Dr(),this.element=e,e.className="blocklyMenuItem goog-menuitem "+(this.enabled?"":"blocklyMenuItemDisabled goog-menuitem-disabled ")+(this.checked?"blocklyMenuItemSelected goog-option-selected ":"")+(this.highlight?"blocklyMenuItemHighlight goog-menuitem-highlight ":"")+(this.rightToLeft?"blocklyMenuItemRtl goog-menuitem-rtl ":"");const t=document.createElement("div");if(t.className="blocklyMenuItemContent goog-menuitem-content",this.checkable){var r=document.createElement("div");r.className="blocklyMenuItemCheckbox goog-menuitem-checkbox",t.appendChild(r)}return r=this.content,typeof this.content=="string"&&(r=document.createTextNode(this.content)),t.appendChild(r),e.appendChild(t),this.roleName&&vn(e,this.roleName),Xt(e,Gt.SELECTED,this.checkable&&this.checked||false),Xt(e,Gt.DISABLED,!this.enabled),e}dispose(){this.element=null}getElement(){return this.element}getId(){return this.element.id}getValue(){let e;return(e=this.opt_value)!=null?e:null}setRightToLeft(e){this.rightToLeft=e}setRole(e){this.roleName=e}setCheckable(e){this.checkable=e}setChecked(e){this.checked=e}setHighlighted(e){this.highlight=e;const t=this.getElement();t&&this.isEnabled()&&(e?(ie(t,"blocklyMenuItemHighlight"),ie(t,"goog-menuitem-highlight")):(he(t,"blocklyMenuItemHighlight"),he(t,"goog-menuitem-highlight")))}isEnabled(){return this.enabled}setEnabled(e){this.enabled=e}performAction(){this.isEnabled()&&this.actionHandler&&this.actionHandler(this)}onAction(e,t){this.actionHandler=e.bind(t)}},rn=class extends pt{constructor(e,t,r){super(pt.SKIP_SETUP),this.svgArrow_=this.arrow_=this.imageElement_=this.menu_=this.selectedMenuItem_=null,this.SERIALIZABLE=true,this.CURSOR="default",this.clickTarget_=this.suffixField=this.prefixField=this.generatedOptions_=null,RC(e)&&(Array.isArray(e)?(Zm(e),e=IC(e),this.menuGenerator_=e.options,this.prefixField=e.prefix||null,this.suffixField=e.suffix||null):this.menuGenerator_=e,this.selectedOption_=this.getOptions(false)[0],r&&this.configure_(r),this.setValue(this.selectedOption_[1]),t&&this.setValidator(t))}fromXml(e){this.isOptionListDynamic()&&this.getOptions(false),this.setValue(e.textContent)}loadState(e){this.loadLegacyState(rn,e)||(this.isOptionListDynamic()&&this.getOptions(false),this.setValue(e))}initView(){this.shouldAddBorderRect_()?this.createBorderRect_():this.clickTarget_=this.sourceBlock_.getSvgRoot(),this.createTextElement_(),this.imageElement_=H(ee.IMAGE,{},this.fieldGroup_),this.getConstants().FIELD_DROPDOWN_SVG_ARROW?this.createSVGArrow_():this.createTextArrow_(),this.borderRect_&&ie(this.borderRect_,"blocklyDropdownRect")}shouldAddBorderRect_(){let e;return!this.getConstants().FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW||this.getConstants().FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW&&!((e=this.getSourceBlock())!=null&&e.isShadow())}createTextArrow_(){this.arrow_=H(ee.TSPAN,{},this.textElement_);let e;this.arrow_.appendChild(document.createTextNode((e=this.getSourceBlock())!=null&&e.RTL?rn.ARROW_CHAR+" ":" "+rn.ARROW_CHAR));let t;(t=this.getSourceBlock())!=null&&t.RTL?this.getTextElement().insertBefore(this.arrow_,this.textContent_):this.getTextElement().appendChild(this.arrow_)}createSVGArrow_(){this.svgArrow_=H(ee.IMAGE,{height:this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE+"px",width:this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE+"px"},this.fieldGroup_),this.svgArrow_.setAttributeNS(ai,"xlink:href",this.getConstants().FIELD_DROPDOWN_SVG_ARROW_DATAURI)}showEditor_(e){var t=this.getSourceBlock();if(!t)throw new hs;this.dropdownCreate_(),this.menu_.openingCoords=e&&typeof e.clientX=="number"?new Oe(e.clientX,e.clientY):null,as(),e=this.menu_.render(xi()),ie(e,"blocklyDropdownMenu"),this.getConstants().FIELD_DROPDOWN_COLOURED_DIV&&(e=t.isShadow()?t.getParent().getColour():t.getColour(),t=t.isShadow()?t.getParent().style.colourTertiary:this.sourceBlock_.style.colourTertiary,N(e,t)),Z(this,this.dropdownDispose_.bind(this)),this.menu_.focus(),this.selectedMenuItem_&&this.menu_.setHighlighted(this.selectedMenuItem_),this.applyColour()}dropdownCreate_(){const e=this.getSourceBlock();if(!e)throw new hs;const t=new Fd;t.setRole(ci.LISTBOX),this.menu_=t;const r=this.getOptions(false);this.selectedMenuItem_=null;for(let d=0;d<r.length;d++){const[C,D]=r[d];if(typeof C=="object"){var a=new Image(C.width,C.height);a.src=C.src,a.alt=C.alt||""}else a=C;a=new Gd(a,D),a.setRole(ci.OPTION),a.setRightToLeft(e.RTL),a.setCheckable(true),t.addChild(a),a.setChecked(D===this.value_),D===this.value_&&(this.selectedMenuItem_=a),a.onAction(this.handleMenuActionEvent_,this)}}dropdownDispose_(){this.menu_&&this.menu_.dispose(),this.selectedMenuItem_=this.menu_=null,this.applyColour()}handleMenuActionEvent_(e){et(this,true),this.onItemSelected_(this.menu_,e)}onItemSelected_(e,t){this.setValue(t.getValue())}isOptionListDynamic(){return typeof this.menuGenerator_=="function"}getOptions(e){if(!this.menuGenerator_)throw TypeError("A menu generator was never defined.");return Array.isArray(this.menuGenerator_)?this.menuGenerator_:e&&this.generatedOptions_?this.generatedOptions_:(this.generatedOptions_=this.menuGenerator_(),Zm(this.generatedOptions_),this.generatedOptions_)}doClassValidation_(e){return this.getOptions(true).some(t=>t[1]===e)?e:(this.sourceBlock_&&console.warn("Cannot set the dropdown's value to an unavailable option. Block type: "+this.sourceBlock_.type+", Field name: "+this.name+", Value: "+e),null)}doValueUpdate_(e){super.doValueUpdate_(e),e=this.getOptions(true);for(let t=0,r;r=e[t];t++)r[1]===this.value_&&(this.selectedOption_=r)}applyColour(){const e=this.sourceBlock_.style;this.borderRect_&&(this.borderRect_.setAttribute("stroke",e.colourTertiary),this.menu_?this.borderRect_.setAttribute("fill",e.colourTertiary):this.borderRect_.setAttribute("fill","transparent")),this.sourceBlock_&&this.arrow_&&(this.sourceBlock_.isShadow()?this.arrow_.style.fill=e.colourSecondary:this.arrow_.style.fill=e.colourPrimary)}render_(){this.getTextContent().nodeValue="",this.imageElement_.style.display="none";const e=this.selectedOption_&&this.selectedOption_[0];e&&typeof e=="object"?this.renderSelectedImage_(e):this.renderSelectedText_(),this.positionBorderRect_()}renderSelectedImage_(e){const t=this.getSourceBlock();if(!t)throw new hs;this.imageElement_.style.display="",this.imageElement_.setAttributeNS(ai,"xlink:href",e.src),this.imageElement_.setAttribute("height",`${e.height}`),this.imageElement_.setAttribute("width",`${e.width}`);const r=Number(e.height);e=Number(e.width);var a=!!this.borderRect_;const d=Math.max(a?this.getConstants().FIELD_DROPDOWN_BORDER_RECT_HEIGHT:0,r+T0);a=a?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0;let C;C=this.svgArrow_?this.positionSVGArrow_(e+a,d/2-this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE/2):St(this.arrow_,this.getConstants().FIELD_TEXT_FONTSIZE,this.getConstants().FIELD_TEXT_FONTWEIGHT,this.getConstants().FIELD_TEXT_FONTFAMILY),this.size_.width=e+C+2*a,this.size_.height=d;let D=0;t.RTL?this.imageElement_.setAttribute("x",(a+C).toString()):(D=e+C,this.getTextElement().setAttribute("text-anchor","end"),this.imageElement_.setAttribute("x",a.toString())),this.imageElement_.setAttribute("y",(d/2-r/2).toString()),this.positionTextElement_(D+a,e+C)}renderSelectedText_(){this.getTextContent().nodeValue=this.getDisplayText_();var e=this.getTextElement();ie(e,"blocklyDropdownText"),e.setAttribute("text-anchor","start");var t=!!this.borderRect_;e=Math.max(t?this.getConstants().FIELD_DROPDOWN_BORDER_RECT_HEIGHT:0,this.getConstants().FIELD_TEXT_HEIGHT);const r=St(this.getTextElement(),this.getConstants().FIELD_TEXT_FONTSIZE,this.getConstants().FIELD_TEXT_FONTWEIGHT,this.getConstants().FIELD_TEXT_FONTFAMILY);t=t?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0;let a=0;this.svgArrow_&&(a=this.positionSVGArrow_(r+t,e/2-this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE/2)),this.size_.width=r+a+2*t,this.size_.height=e,this.positionTextElement_(t,r)}positionSVGArrow_(e,t){if(!this.svgArrow_)return 0;const r=this.getSourceBlock();if(!r)throw new hs;const a=this.borderRect_?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0,d=this.getConstants().FIELD_DROPDOWN_SVG_ARROW_PADDING,C=this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE;return this.svgArrow_.setAttribute("transform","translate("+(r.RTL?a:e+d)+","+t+")"),C+d}getText_(){if(!this.selectedOption_)return null;const e=this.selectedOption_[0];return typeof e=="object"?e.alt:e}static fromJson(e){if(!e.options)throw Error("options are required for the dropdown field. The options property must be assigned an array of [humanReadableValue, languageNeutralValue] tuples.");return new this(e.options,void 0,e)}};rn.CHECKMARK_OVERHANG=25,rn.MAX_MENU_HEIGHT_VH=.45,rn.ARROW_CHAR="▾";var b0=5,T0=2*b0;Pi("field_dropdown",rn),i.module$build$src$core$field_dropdown={},i.module$build$src$core$field_dropdown.FieldDropdown=rn;var Hd=class extends tn{constructor(e,t,r){super(e?e.workspace.id:void 0),this.type=Fn,e&&(this.blockId=e.id,this.isOpen=t,this.bubbleType=r)}toJson(){const e=super.toJson();if(this.isOpen===void 0)throw Error("Whether this event is for opening the bubble is undefined. Either pass the value to the constructor, or call fromJson");if(!this.bubbleType)throw Error("The type of bubble is undefined. Either pass the value to the constructor, or call fromJson");return e.isOpen=this.isOpen,e.bubbleType=this.bubbleType,e.blockId=this.blockId||"",e}fromJson(e){o("Blockly.Events.BubbleOpen.prototype.fromJson","version 9","version 10","Blockly.Events.fromJson"),super.fromJson(e),this.isOpen=e.isOpen,this.bubbleType=e.bubbleType,this.blockId=e.blockId}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new Hd),t.isOpen=e.isOpen,t.bubbleType=e.bubbleType,t.blockId=e.blockId,t}},Vd;(function(e){e.MUTATOR="mutator",e.COMMENT="comment",e.WARNING="warning"})(Vd||(Vd={})),$e(Te.EVENT,Fn,Hd);var Kt=class{constructor(e,t,r,a,d){this.workspace=e,this.horizontal=t,this.oldHostMetrics=null,this.ratio=1,this.origin=new Oe(0,0),this.startDragHandle=this.handlePosition=this.handleLength=this.scrollbarLength=this.startDragMouse=0,this.containerVisible=this.isHandleVisible=true,this.position=new Oe(0,0),this.onMouseMoveWrapper_=this.onMouseUpWrapper_=null,this.pair=r||false,this.margin=d!==void 0?d:Kt.DEFAULT_SCROLLBAR_MARGIN,e="blocklyScrollbar"+(this.horizontal?"Horizontal":"Vertical"),a&&(e+=" "+a),this.outerSvg=H(ee.SVG,{class:e}),a=H(ee.G,{},this.outerSvg),this.svgBackground=H(ee.RECT,{class:"blocklyScrollbarBackground"},a),e=Math.floor((Kt.scrollbarThickness-5)/2),this.svgHandle=H(ee.RECT,{class:"blocklyScrollbarHandle",rx:e,ry:e},a),this.workspace.getThemeManager().subscribe(this.svgHandle,"scrollbarColour","fill"),this.workspace.getThemeManager().subscribe(this.svgHandle,"scrollbarOpacity","fill-opacity"),te(this.outerSvg,this.workspace.getParentSvg()),this.setInitialThickness(),t?(this.lengthAttribute_="width",this.positionAttribute_="x"):(this.lengthAttribute_="height",this.positionAttribute_="y"),this.onMouseDownBarWrapper_=S(this.svgBackground,"pointerdown",this,this.onMouseDownBar),this.onMouseDownHandleWrapper_=S(this.svgHandle,"pointerdown",this,this.onMouseDownHandle)}setInitialThickness(){const e=Kt.scrollbarThickness;this.horizontal?(this.svgBackground.setAttribute("height",String(e)),this.outerSvg.setAttribute("height",String(e)),this.svgHandle.setAttribute("height",String(e-5)),this.svgHandle.setAttribute("y","2.5")):(this.svgBackground.setAttribute("width",String(e)),this.outerSvg.setAttribute("width",String(e)),this.svgHandle.setAttribute("width",String(e-5)),this.svgHandle.setAttribute("x","2.5"))}dispose(){this.cleanUp(),g(this.onMouseDownBarWrapper_),g(this.onMouseDownHandleWrapper_),B(this.outerSvg),this.workspace.getThemeManager().unsubscribe(this.svgHandle)}constrainHandleLength(e){return e=0>=e||isNaN(e)?0:Math.min(e,this.scrollbarLength)}setHandleLength(e){this.handleLength=e,this.svgHandle.setAttribute(this.lengthAttribute_,String(this.handleLength))}constrainHandlePosition(e){return e=0>=e||isNaN(e)?0:Math.min(e,this.scrollbarLength-this.handleLength)}setHandlePosition(e){this.handlePosition=e,this.svgHandle.setAttribute(this.positionAttribute_,String(this.handlePosition))}setScrollbarLength(e){this.scrollbarLength=e,this.outerSvg.setAttribute(this.lengthAttribute_,String(this.scrollbarLength)),this.svgBackground.setAttribute(this.lengthAttribute_,String(this.scrollbarLength))}setPosition(e,t){this.position.x=e,this.position.y=t,ae(this.outerSvg,"translate("+(this.position.x+this.origin.x)+"px,"+(this.position.y+this.origin.y)+"px)")}resize(e){!e&&(e=this.workspace.getMetrics(),!e)||this.oldHostMetrics&&Kt.metricsAreEquivalent(e,this.oldHostMetrics)||(this.horizontal?this.resizeHorizontal(e):this.resizeVertical(e),this.oldHostMetrics=e,this.updateMetrics())}requiresViewResize(e){return this.oldHostMetrics?this.oldHostMetrics.viewWidth!==e.viewWidth||this.oldHostMetrics.viewHeight!==e.viewHeight||this.oldHostMetrics.absoluteLeft!==e.absoluteLeft||this.oldHostMetrics.absoluteTop!==e.absoluteTop:true}resizeHorizontal(e){this.requiresViewResize(e)?this.resizeViewHorizontal(e):this.resizeContentHorizontal(e)}resizeViewHorizontal(e){var t=e.viewWidth-2*this.margin;this.pair&&(t-=Kt.scrollbarThickness),this.setScrollbarLength(Math.max(0,t)),t=e.absoluteLeft+this.margin,this.pair&&this.workspace.RTL&&(t+=Kt.scrollbarThickness),this.setPosition(t,e.absoluteTop+e.viewHeight-Kt.scrollbarThickness-this.margin),this.resizeContentHorizontal(e)}resizeContentHorizontal(e){if(e.viewWidth>=e.scrollWidth)this.setHandleLength(this.scrollbarLength),this.setHandlePosition(0),this.pair||this.setVisible(false);else{this.pair||this.setVisible(true);var t=this.scrollbarLength*e.viewWidth/e.scrollWidth;t=this.constrainHandleLength(t),this.setHandleLength(t),t=e.scrollWidth-e.viewWidth;var r=this.scrollbarLength-this.handleLength;e=(e.viewLeft-e.scrollLeft)/t*r,e=this.constrainHandlePosition(e),this.setHandlePosition(e),this.ratio=r/t}}resizeVertical(e){this.requiresViewResize(e)?this.resizeViewVertical(e):this.resizeContentVertical(e)}resizeViewVertical(e){let t=e.viewHeight-2*this.margin;this.pair&&(t-=Kt.scrollbarThickness),this.setScrollbarLength(Math.max(0,t)),this.setPosition(this.workspace.RTL?e.absoluteLeft+this.margin:e.absoluteLeft+e.viewWidth-Kt.scrollbarThickness-this.margin,e.absoluteTop+this.margin),this.resizeContentVertical(e)}resizeContentVertical(e){if(e.viewHeight>=e.scrollHeight)this.setHandleLength(this.scrollbarLength),this.setHandlePosition(0),this.pair||this.setVisible(false);else{this.pair||this.setVisible(true);var t=this.scrollbarLength*e.viewHeight/e.scrollHeight;t=this.constrainHandleLength(t),this.setHandleLength(t),t=e.scrollHeight-e.viewHeight;var r=this.scrollbarLength-this.handleLength;e=(e.viewTop-e.scrollTop)/t*r,e=this.constrainHandlePosition(e),this.setHandlePosition(e),this.ratio=r/t}}isVisible(){return this.isHandleVisible}setContainerVisible(e){const t=e!==this.containerVisible;this.containerVisible=e,t&&this.updateDisplay_()}setVisible(e){const t=e!==this.isVisible();if(this.pair)throw Error("Unable to toggle visibility of paired scrollbars.");this.isHandleVisible=e,t&&this.updateDisplay_()}updateDisplay_(){this.containerVisible&&this.isVisible()?this.outerSvg.setAttribute("display","block"):this.outerSvg.setAttribute("display","none")}onMouseDownBar(e){if(this.workspace.markFocused(),m(),this.cleanUp(),v(e))e.stopPropagation();else{var t=b(e,this.workspace.getParentSvg(),this.workspace.getInverseScreenCTM());t=this.horizontal?t.x:t.y;var r=vc(this.svgHandle);r=this.horizontal?r.x:r.y;var a=this.handlePosition,d=.95*this.handleLength;t<=r?a-=d:t>=r+this.handleLength&&(a+=d),this.setHandlePosition(this.constrainHandlePosition(a)),this.updateMetrics(),e.stopPropagation(),e.preventDefault()}}onMouseDownHandle(e){this.workspace.markFocused(),this.cleanUp(),v(e)?e.stopPropagation():(this.startDragHandle=this.handlePosition,this.workspace.setupDragSurface(),this.startDragMouse=this.horizontal?e.clientX:e.clientY,this.onMouseUpWrapper_=S(document,"pointerup",this,this.onMouseUpHandle),this.onMouseMoveWrapper_=S(document,"pointermove",this,this.onMouseMoveHandle),e.stopPropagation(),e.preventDefault())}onMouseMoveHandle(e){this.setHandlePosition(this.constrainHandlePosition(this.startDragHandle+((this.horizontal?e.clientX:e.clientY)-this.startDragMouse))),this.updateMetrics()}onMouseUpHandle(){this.workspace.resetDragSurface(),m(),this.cleanUp()}cleanUp(){this.workspace.hideChaff(true),this.onMouseUpWrapper_&&(g(this.onMouseUpWrapper_),this.onMouseUpWrapper_=null),this.onMouseMoveWrapper_&&(g(this.onMouseMoveWrapper_),this.onMouseMoveWrapper_=null)}getRatio_(){let e=this.handlePosition/(this.scrollbarLength-this.handleLength);return isNaN(e)&&(e=0),e}updateMetrics(){const e=this.getRatio_();this.horizontal?this.workspace.setMetrics({x:e}):this.workspace.setMetrics({y:e})}set(e,t){this.setHandlePosition(this.constrainHandlePosition(e*this.ratio)),(t||t===void 0)&&this.updateMetrics()}setOrigin(e,t){this.origin=new Oe(e,t)}static metricsAreEquivalent(e,t){return e.viewWidth===t.viewWidth&&e.viewHeight===t.viewHeight&&e.viewLeft===t.viewLeft&&e.viewTop===t.viewTop&&e.absoluteTop===t.absoluteTop&&e.absoluteLeft===t.absoluteLeft&&e.scrollWidth===t.scrollWidth&&e.scrollHeight===t.scrollHeight&&e.scrollLeft===t.scrollLeft&&e.scrollTop===t.scrollTop}};Kt.scrollbarThickness=sv?25:15,Kt.DEFAULT_SCROLLBAR_MARGIN=.5;var rt=class{constructor(e,t,r,a,d,C){this.resizeGroup=this.bubbleBack=this.bubbleArrow=this.bubbleGroup=null,this.height=this.width=this.relativeTop=this.relativeLeft=0,this.autoLayout=true,this.onMouseDownResizeWrapper=this.onMouseDownBubbleWrapper=this.moveCallback=this.resizeCallback=null,this.rendered=this.disposed=false,this.workspace_=e,this.content_=t,this.shape_=r,r=rt.ARROW_ANGLE,this.workspace_.RTL&&(r=-r),this.arrowRadians=We(r),e.getBubbleCanvas().appendChild(this.createDom(t,!(!d||!C))),this.setAnchorLocation(a),d&&C||(e=this.content_.getBBox(),d=e.width+2*rt.BORDER_WIDTH,C=e.height+2*rt.BORDER_WIDTH),this.setBubbleSize(d,C),this.positionBubble(),this.renderArrow(),this.rendered=true}createDom(e,t){this.bubbleGroup=H(ee.G,{});var r={filter:"url(#"+this.workspace_.getRenderer().getConstants().embossFilterId+")"};return cv&&(r={}),r=H(ee.G,r,this.bubbleGroup),this.bubbleArrow=H(ee.PATH,{},r),this.bubbleBack=H(ee.RECT,{class:"blocklyDraggable",x:0,y:0,rx:rt.BORDER_WIDTH,ry:rt.BORDER_WIDTH},r),t?(this.resizeGroup=H(ee.G,{class:this.workspace_.RTL?"blocklyResizeSW":"blocklyResizeSE"},this.bubbleGroup),t=2*rt.BORDER_WIDTH,H(ee.POLYGON,{points:"0,x x,x x,0".replace(/x/g,t.toString())},this.resizeGroup),H(ee.LINE,{class:"blocklyResizeLine",x1:t/3,y1:t-1,x2:t-1,y2:t/3},this.resizeGroup),H(ee.LINE,{class:"blocklyResizeLine",x1:2*t/3,y1:t-1,x2:t-1,y2:2*t/3},this.resizeGroup)):this.resizeGroup=null,this.workspace_.options.readOnly||(this.onMouseDownBubbleWrapper=S(this.bubbleBack,"pointerdown",this,this.bubbleMouseDown),this.resizeGroup&&(this.onMouseDownResizeWrapper=S(this.resizeGroup,"pointerdown",this,this.resizeMouseDown))),this.bubbleGroup.appendChild(e),this.bubbleGroup}getSvgRoot(){return this.bubbleGroup}setSvgId(e){let t;(t=this.bubbleGroup)==null||t.setAttribute("data-block-id",e)}bubbleMouseDown(e){const t=this.workspace_.getGesture(e);t&&t.handleBubbleStart(e,this)}showContextMenu(e){}isDeletable(){return false}setDeleteStyle(e){}resizeMouseDown(e){this.promote(),rt.unbindDragEvents(),v(e)||(this.workspace_.startDrag(e,new Oe(this.workspace_.RTL?-this.width:this.width,this.height)),rt.onMouseUpWrapper=S(document,"pointerup",this,rt.bubbleMouseUp),rt.onMouseMoveWrapper=S(document,"pointermove",this,this.resizeMouseMove),this.workspace_.hideChaff()),e.stopPropagation()}resizeMouseMove(e){this.autoLayout=false,e=this.workspace_.moveDrag(e),this.setBubbleSize(this.workspace_.RTL?-e.x:e.x,e.y),this.workspace_.RTL&&this.positionBubble()}registerResizeEvent(e){this.resizeCallback=e}registerMoveEvent(e){this.moveCallback=e}promote(){let e;const t=(e=this.bubbleGroup)==null?void 0:e.parentNode;return(t==null?void 0:t.lastChild)!==this.bubbleGroup&&this.bubbleGroup?(t==null||t.appendChild(this.bubbleGroup),true):false}setAnchorLocation(e){this.anchorXY=e,this.rendered&&this.positionBubble()}layoutBubble(){var e=this.workspace_.getMetricsManager().getViewMetrics(true),t=this.getOptimalRelativeLeft(e),r=this.getOptimalRelativeTop(e),a=this.shape_.getBBox();const d={x:t,y:-this.height-this.workspace_.getRenderer().getConstants().MIN_BLOCK_HEIGHT},C={x:-this.width-30,y:r};r={x:a.width,y:r};var D={x:t,y:a.height};t=a.width<a.height?r:D,a=a.width<a.height?D:r,r=this.getOverlap(d,e),D=this.getOverlap(C,e);const Y=this.getOverlap(t,e);e=this.getOverlap(a,e),e=Math.max(r,D,Y,e),r===e?(this.relativeLeft=d.x,this.relativeTop=d.y):D===e?(this.relativeLeft=C.x,this.relativeTop=C.y):Y===e?(this.relativeLeft=t.x,this.relativeTop=t.y):(this.relativeLeft=a.x,this.relativeTop=a.y)}getOverlap(e,t){var r=this.workspace_.RTL?this.anchorXY.x-e.x-this.width:e.x+this.anchorXY.x;return e=e.y+this.anchorXY.y,Math.max(0,Math.min(1,(Math.min(r+this.width,t.left+t.width)-Math.max(r,t.left))*(Math.min(e+this.height,t.top+t.height)-Math.max(e,t.top))/(this.width*this.height)))}getOptimalRelativeLeft(e){let t=-this.width/4;if(this.width>e.width)return t;if(this.workspace_.RTL){var r=this.anchorXY.x-t,a=e.left+e.width;e=e.left+Kt.scrollbarThickness/this.workspace_.scale,r-this.width<e?t=-(e-this.anchorXY.x+this.width):r>a&&(t=-(a-this.anchorXY.x))}else{r=t+this.anchorXY.x,a=r+this.width;const d=e.left;e=e.left+e.width-Kt.scrollbarThickness/this.workspace_.scale,r<d?t=d-this.anchorXY.x:a>e&&(t=e-this.anchorXY.x-this.width)}return t}getOptimalRelativeTop(e){let t=-this.height/4;if(this.height>e.height)return t;const r=this.anchorXY.y+t,a=r+this.height,d=e.top;e=e.top+e.height-Kt.scrollbarThickness/this.workspace_.scale;const C=this.anchorXY.y;return r<d?t=d-C:a>e&&(t=e-C-this.height),t}positionBubble(){let e=this.anchorXY.x;e=this.workspace_.RTL?e-(this.relativeLeft+this.width):e+this.relativeLeft,this.moveTo(e,this.relativeTop+this.anchorXY.y)}moveTo(e,t){let r;(r=this.bubbleGroup)==null||r.setAttribute("transform","translate("+e+","+t+")")}setDragging(e){!e&&this.moveCallback&&this.moveCallback()}getBubbleSize(){return new Ss(this.width,this.height)}setBubbleSize(e,t){const r=2*rt.BORDER_WIDTH;e=Math.max(e,r+45),t=Math.max(t,r+20),this.width=e,this.height=t;let a;(a=this.bubbleBack)==null||a.setAttribute("width",e.toString());let d;(d=this.bubbleBack)==null||d.setAttribute("height",t.toString()),this.resizeGroup&&(this.workspace_.RTL?this.resizeGroup.setAttribute("transform","translate("+2*rt.BORDER_WIDTH+","+(t-r)+") scale(-1 1)"):this.resizeGroup.setAttribute("transform","translate("+(e-r)+","+(t-r)+")")),this.autoLayout&&this.layoutBubble(),this.positionBubble(),this.renderArrow(),this.resizeCallback&&this.resizeCallback()}renderArrow(){const e=[];var t=this.width/2,r=this.height/2,a=-this.relativeLeft,d=-this.relativeTop;if(t===a&&r===d)e.push("M "+t+","+r);else{d-=r,a-=t,this.workspace_.RTL&&(a*=-1);var C=Math.sqrt(d*d+a*a),D=Math.acos(a/C);0>d&&(D=2*Math.PI-D);var Y=D+Math.PI/2;Y>2*Math.PI&&(Y-=2*Math.PI);var pe=Math.sin(Y);const zt=Math.cos(Y);var we=this.getBubbleSize();Y=(we.width+we.height)/rt.ARROW_THICKNESS,Y=Math.min(Y,we.width,we.height)/4,we=1-rt.ANCHOR_RADIUS/C,a=t+we*a,d=r+we*d,we=t+Y*zt;const Oi=r+Y*pe;t-=Y*zt,r-=Y*pe,pe=D+this.arrowRadians,pe>2*Math.PI&&(pe-=2*Math.PI),D=Math.sin(pe)*C/rt.ARROW_BEND,C=Math.cos(pe)*C/rt.ARROW_BEND,e.push("M"+we+","+Oi),e.push("C"+(we+C)+","+(Oi+D)+" "+a+","+d+" "+a+","+d),e.push("C"+a+","+d+" "+(t+C)+","+(r+D)+" "+t+","+r)}e.push("z");let Et;(Et=this.bubbleArrow)==null||Et.setAttribute("d",e.join(" "))}setColour(e){let t;(t=this.bubbleBack)==null||t.setAttribute("fill",e);let r;(r=this.bubbleArrow)==null||r.setAttribute("fill",e)}dispose(){this.onMouseDownBubbleWrapper&&g(this.onMouseDownBubbleWrapper),this.onMouseDownResizeWrapper&&g(this.onMouseDownResizeWrapper),rt.unbindDragEvents(),B(this.bubbleGroup),this.disposed=true}moveDuringDrag(e,t){e?e.translateSurface(t.x,t.y):this.moveTo(t.x,t.y),this.relativeLeft=this.workspace_.RTL?this.anchorXY.x-t.x-this.width:t.x-this.anchorXY.x,this.relativeTop=t.y-this.anchorXY.y,this.renderArrow()}getRelativeToSurfaceXY(){return new Oe(this.workspace_.RTL?-this.relativeLeft+this.anchorXY.x-this.width:this.anchorXY.x+this.relativeLeft,this.anchorXY.y+this.relativeTop)}setAutoLayout(e){this.autoLayout=e}static unbindDragEvents(){rt.onMouseUpWrapper&&(g(rt.onMouseUpWrapper),rt.onMouseUpWrapper=null),rt.onMouseMoveWrapper&&(g(rt.onMouseMoveWrapper),rt.onMouseMoveWrapper=null)}static bubbleMouseUp(e){m(),rt.unbindDragEvents()}static textToDom(e){const t=H(ee.TEXT,{class:"blocklyText blocklyBubbleText blocklyNoPointerEvents",y:rt.BORDER_WIDTH});e=e.split(`
`);for(let r=0;r<e.length;r++){const a=H(ee.TSPAN,{dy:"1em",x:rt.BORDER_WIDTH},t),d=document.createTextNode(e[r]);a.appendChild(d)}return t}static createNonEditableBubble(e,t,r){if(r=new rt(t.workspace,e,t.pathObject.svgPath,r,null,null),r.setSvgId(t.id),t.RTL){t=e.getBBox().width;for(let a=0,d;d=e.childNodes[a];a++)d.setAttribute("text-anchor","end"),d.setAttribute("x",(t+rt.BORDER_WIDTH).toString())}return r}};rt.BORDER_WIDTH=6,rt.ARROW_THICKNESS=5,rt.ARROW_ANGLE=20,rt.ARROW_BEND=4,rt.ANCHOR_RADIUS=8,rt.onMouseUpWrapper=null,rt.onMouseMoveWrapper=null;var Wd,Mv;Wd=28,i.config$$module$build$src$core$config={dragRadius:5,flyoutDragRadius:10,snapRadius:Wd,connectingSnapRadius:Wd,currentConnectionPreference:8,bumpDelay:250},Mv={},Mv.config=i.config$$module$build$src$core$config;var uu=class{constructor(e){this.iconGroup_=null,this.collapseHidden=true,this.SIZE=17,this.iconXY_=this.bubble_=null,e||o("Calling the Icon constructor with a null block","version 9","version 10","a non-null block"),this.block_=e}createIcon(){this.iconGroup_||(this.iconGroup_=H(ee.G,{class:"blocklyIconGroup"}),this.getBlock().isInFlyout&&ie(this.iconGroup_,"blocklyIconGroupReadonly"),this.drawIcon_(this.iconGroup_),this.getBlock().getSvgRoot().appendChild(this.iconGroup_),S(this.iconGroup_,"pointerup",this,this.iconClick_),this.updateEditable())}dispose(){B(this.iconGroup_),this.setVisible(false)}updateEditable(){}isVisible(){return!!this.bubble_}iconClick_(e){this.getBlock().workspace.isDragging()||this.getBlock().isInFlyout||v(e)||this.setVisible(!this.isVisible())}applyColour(){this.bubble_&&this.isVisible()&&this.bubble_.setColour(this.getBlock().style.colourPrimary)}setIconLocation(e){this.iconXY_=e,this.bubble_&&this.isVisible()&&this.bubble_.setAnchorLocation(e)}computeIconLocation(){var e=this.getBlock().getRelativeToSurfaceXY();const t=Ji(this.iconGroup_);e=new Oe(e.x+t.x+this.SIZE/2,e.y+t.y+this.SIZE/2),Oe.equals(this.getIconLocation(),e)||this.setIconLocation(e)}getIconLocation(){return this.iconXY_}getCorrectedSize(){return new Ss(this.SIZE,this.SIZE-2)}drawIcon_(e){}setVisible(e){}getBlock(){if(!this.block_)throw Error("Block is not set for this icon.");return this.block_}},rl={};rl.deepMerge=lr,rl.inherits=OC,rl.mixin=wC,rl.values=kC;var Qr=class{constructor(e,t,r,a){this.name=e,this.startHats=false,this.blockStyles=t||Object.create(null),this.categoryStyles=r||Object.create(null),this.componentStyles=a||Object.create(null),this.fontStyle=Object.create(null),$e(Te.THEME,e,this)}getClassName(){return this.name+"-theme"}setBlockStyle(e,t){this.blockStyles[e]=t}setCategoryStyle(e,t){this.categoryStyles[e]=t}getComponentStyle(e){return(e=this.componentStyles[e])&&typeof e=="string"&&this.getComponentStyle(e)?this.getComponentStyle(e):e?String(e):null}setComponentStyle(e,t){this.componentStyles[e]=t}setFontStyle(e){this.fontStyle=e}setStartHats(e){this.startHats=e}static defineTheme(e,t){e=e.toLowerCase();const r=new Qr(e);let a=t.base;if(a){if(typeof a=="string"){let d;a=(d=yo(Te.THEME,a))!=null?d:void 0}a instanceof Qr&&(lr(r,a),r.name=e)}return lr(r.blockStyles,t.blockStyles),lr(r.categoryStyles,t.categoryStyles),lr(r.componentStyles,t.componentStyles),lr(r.fontStyle,t.fontStyle),t.startHats!==null&&(r.startHats=t.startHats),r}},S0={colour_blocks:{colourPrimary:"20"},list_blocks:{colourPrimary:"260"},logic_blocks:{colourPrimary:"210"},loop_blocks:{colourPrimary:"120"},math_blocks:{colourPrimary:"230"},procedure_blocks:{colourPrimary:"290"},text_blocks:{colourPrimary:"160"},variable_blocks:{colourPrimary:"330"},variable_dynamic_blocks:{colourPrimary:"310"},hat_blocks:{colourPrimary:"330",hat:"cap"}},$0={colour_category:{colour:"20"},list_category:{colour:"260"},logic_category:{colour:"210"},loop_category:{colour:"120"},math_category:{colour:"230"},procedure_category:{colour:"290"},text_category:{colour:"160"},variable_category:{colour:"330"},variable_dynamic_category:{colour:"310"}},hu=new Qr("classic",S0,$0),zd="categoryToolbox",Dv="flyoutToolbox",it;(function(e){e[e.TOP=0]="TOP",e[e.BOTTOM=1]="BOTTOM",e[e.LEFT=2]="LEFT",e[e.RIGHT=3]="RIGHT"})(it||(it={}));var xv={hasCategoriesInternal:LC},gr={};gr.Position=it,gr.TEST_ONLY=xv,gr.convertFlyoutDefToJsonArray=Cc,gr.convertToolboxDefToJson=Ic,gr.hasCategories=Wh,gr.isCategoryCollapsible=zh,gr.parseToolboxTree=eE;var on=class{constructor(e){this.gridPattern=null,this.getMetrics=this.setMetrics=void 0;let t=null,r=false;var a=false,d=false,C=false,D=false,Y=false;const pe=!!e.readOnly;if(!pe){var we;t=Ic((we=e.toolbox)!=null?we:null),r=Wh(t),a=e.trashcan,a=a===void 0?r:a,d=e.collapse,d=d===void 0?r:d,C=e.comments,C=C===void 0?r:C,D=e.disable,D=D===void 0?r:D,Y=e.sounds,Y=Y===void 0?true:Y}we=e.maxTrashcanContents,a?we===void 0&&(we=32):we=0;const Et=!!e.rtl;let zt=e.horizontalLayout;zt===void 0&&(zt=false);var Oi=e.toolboxPosition!=="end";Oi=zt?Oi?it.TOP:it.BOTTOM:Oi===Et?it.RIGHT:it.LEFT;let K_=e.css;K_===void 0&&(K_=true);let Y_="https://blockly-demo.appspot.com/static/media/";e.media?Y_=e.media.endsWith("/")?e.media:e.media+"/":"path"in e&&(o("path","Nov 2014","Jul 2023","media"),Y_=e.path+"media/");const tT=e.oneBasedIndex,iw=e.renderer||"geras",nw=e.plugins||{};let q_=e.modalInputs;q_===void 0&&(q_=true),this.RTL=Et,this.oneBasedIndex=tT===void 0?true:tT,this.collapse=d,this.comments=C,this.disable=D,this.readOnly=pe,this.maxBlocks=e.maxBlocks||1/0;let sT;this.maxInstances=(sT=e.maxInstances)!=null?sT:null,this.modalInputs=q_,this.pathToMedia=Y_,this.hasCategories=r,this.moveOptions=on.parseMoveOptions_(e,r),this.hasScrollbars=!!this.moveOptions.scrollbars,this.hasTrashcan=a,this.maxTrashcanContents=we,this.hasSounds=Y,this.hasCss=K_,this.horizontalLayout=zt,this.languageTree=t,this.gridOptions=on.parseGridOptions_(e),this.zoomOptions=on.parseZoomOptions_(e),this.toolboxPosition=Oi,this.theme=on.parseThemeOptions_(e),this.renderer=iw;let iT;this.rendererOverrides=(iT=e.rendererOverrides)!=null?iT:null;let nT;this.parentWorkspace=(nT=e.parentWorkspace)!=null?nT:null,this.plugins=nw}static parseMoveOptions_(e,t){const r=e.move||{},a={};return r.scrollbars===void 0&&e.scrollbars===void 0?a.scrollbars=t:typeof r.scrollbars=="object"?(a.scrollbars={horizontal:!!r.scrollbars.horizontal,vertical:!!r.scrollbars.vertical},a.scrollbars.horizontal&&a.scrollbars.vertical?a.scrollbars=true:a.scrollbars.horizontal||a.scrollbars.vertical||(a.scrollbars=false)):a.scrollbars=!!r.scrollbars||!!e.scrollbars,a.wheel=a.scrollbars&&r.wheel!==void 0?!!r.wheel:typeof a.scrollbars=="object",a.drag=a.scrollbars?r.drag===void 0?true:!!r.drag:false,a}static parseZoomOptions_(e){e=e.zoom||{};const t={};return t.controls=e.controls===void 0?false:!!e.controls,t.wheel=e.wheel===void 0?false:!!e.wheel,t.startScale=e.startScale===void 0?1:Number(e.startScale),t.maxScale=e.maxScale===void 0?3:Number(e.maxScale),t.minScale=e.minScale===void 0?.3:Number(e.minScale),t.scaleSpeed=e.scaleSpeed===void 0?1.2:Number(e.scaleSpeed),t.pinch=e.pinch===void 0?t.wheel||t.controls:!!e.pinch,t}static parseGridOptions_(e){e=e.grid||{};const t={};return t.spacing=Number(e.spacing)||0,t.colour=e.colour||"#888",t.length=e.length===void 0?1:Number(e.length),t.snap=0<t.spacing&&!!e.snap,t}static parseThemeOptions_(e){return e=e.theme||hu,typeof e=="string"?yo(Te.THEME,e):e instanceof Qr?e:Qr.defineTheme(e.name||"builtin"+Dr(),e)}},Bv;i.Mutator$$module$build$src$core$mutator=class extends uu{constructor(e,t){t||o("Calling the Mutator constructor without passing the block it is attached to","version 9","version 10","the constructor by passing the list of subblocks and the block instance to attach the mutator to"),super(t??null),this.workspace_=null,this.workspaceHeight=this.workspaceWidth=0,this.updateWorkspacePid=this.sourceListener=this.rootBlock=this.svgDialog=null,this.quarkNames=e}setBlock(e){this.block_=e}getWorkspace(){return this.workspace_}drawIcon_(e){H(ee.RECT,{class:"blocklyIconShape",rx:"4",ry:"4",height:"16",width:"16"},e),H(ee.PATH,{class:"blocklyIconSymbol",d:"m4.203,7.296 0,1.368 -0.92,0.677 -0.11,0.41 0.9,1.559 0.41,0.11 1.043,-0.457 1.187,0.683 0.127,1.134 0.3,0.3 1.8,0 0.3,-0.299 0.127,-1.138 1.185,-0.682 1.046,0.458 0.409,-0.11 0.9,-1.559 -0.11,-0.41 -0.92,-0.677 0,-1.366 0.92,-0.677 0.11,-0.41 -0.9,-1.559 -0.409,-0.109 -1.046,0.458 -1.185,-0.682 -0.127,-1.138 -0.3,-0.299 -1.8,0 -0.3,0.3 -0.126,1.135 -1.187,0.682 -1.043,-0.457 -0.41,0.11 -0.899,1.559 0.108,0.409z"},e),H(ee.CIRCLE,{class:"blocklyIconShape",r:"2.7",cx:"8",cy:"8"},e)}iconClick_(e){this.getBlock().isEditable()&&super.iconClick_(e)}createEditor(){if(this.svgDialog=H(ee.SVG,{x:rt.BORDER_WIDTH,y:rt.BORDER_WIDTH}),this.quarkNames.length){var e=ot("xml");for(let a=0,d;d=this.quarkNames[a];a++){var t=ot("block");t.setAttribute("type",d),e.appendChild(t)}}else e=null;var r=this.getBlock();return t=new on({disable:false,parentWorkspace:r.workspace,media:r.workspace.options.pathToMedia,rtl:r.RTL,horizontalLayout:false,renderer:r.workspace.options.renderer,rendererOverrides:r.workspace.options.rendererOverrides}),t.toolboxPosition=r.RTL?it.RIGHT:it.LEFT,(r=!!e)&&(t.languageTree=Ic(e)),this.workspace_=this.newWorkspaceSvg(t),this.workspace_.internalIsMutator=true,this.workspace_.addChangeListener(Qt),e=r?this.workspace_.addFlyout(ee.G):null,t=this.workspace_.createDom("blocklyMutatorBackground"),e&&t.insertBefore(e,this.workspace_.svgBlockCanvas_),this.svgDialog.appendChild(t),this.svgDialog}newWorkspaceSvg(e){throw Error("The implementation of newWorkspaceSvg should be monkey-patched in by blockly.ts")}updateEditable(){super.updateEditable(),this.getBlock().isInFlyout||(this.getBlock().isEditable()?this.iconGroup_&&he(this.iconGroup_,"blocklyIconGroupReadonly"):(this.setVisible(false),this.iconGroup_&&ie(this.iconGroup_,"blocklyIconGroupReadonly")))}resizeBubble(){if(this.workspace_){var e=2*rt.BORDER_WIDTH,t=this.workspace_.getCanvas(),r=t.getBBox(),a=r.width+r.x,d=r.height+3*e,C=this.workspace_.getFlyout();if(C){const D=C.getWorkspace().getMetricsManager().getScrollMetrics();d=Math.max(d,D.height+20),a+=C.getWidth()}(C=this.getBlock().RTL)&&(a=-r.x),a+=3*e,(Math.abs(this.workspaceWidth-a)>e||Math.abs(this.workspaceHeight-d)>e)&&(this.workspaceWidth=a,this.workspaceHeight=d,this.bubble_.setBubbleSize(a+e,d+e),this.svgDialog.setAttribute("width",`${a}`),this.svgDialog.setAttribute("height",`${d}`),this.workspace_.setCachedParentSvgSize(a,d)),C&&t.setAttribute("transform",`translate(${this.workspaceWidth}, 0)`),this.workspace_.resize()}}onBubbleMove(){this.workspace_&&this.workspace_.recordDragTargets()}setVisible(e){if(e!==this.isVisible()){var t=this.getBlock();if(Pe(new(Re(Fn))(t,e,"mutator")),e){this.bubble_=new rt(t.workspace,this.createEditor(),t.pathObject.svgPath,this.iconXY_,null,null),e=this.workspace_,this.bubble_.setSvgId(t.id),this.bubble_.registerMoveEvent(this.onBubbleMove.bind(this));var r=e.options.languageTree,a=e.getFlyout();r&&(a.init(e),a.show(r)),this.rootBlock=t.decompose(e),r=this.rootBlock.getDescendants(false);for(let d=0,C;C=r[d];d++)C.render();if(this.rootBlock.setMovable(false),this.rootBlock.setDeletable(false),a?(r=2*a.CORNER_RADIUS,a=this.rootBlock.RTL?a.getWidth()+r:r):a=r=16,t.RTL&&(a=-a),this.rootBlock.moveBy(a,r),t.saveConnections){const d=this.rootBlock;t.saveConnections(d),this.sourceListener=()=>{const C=this.getBlock();C.saveConnections&&C.saveConnections(d)},t.workspace.addChangeListener(this.sourceListener)}this.resizeBubble(),e.addChangeListener(this.workspaceChanged.bind(this)),this.updateWorkspace(),this.applyColour()}else this.svgDialog=null,this.workspace_.dispose(),this.rootBlock=this.workspace_=null,(a=this.bubble_)==null||a.dispose(),this.bubble_=null,this.workspaceHeight=this.workspaceWidth=0,this.sourceListener&&(t.workspace.removeChangeListener(this.sourceListener),this.sourceListener=null)}}workspaceChanged(e){this.shouldIgnoreMutatorEvent_(e)||this.updateWorkspacePid||(this.updateWorkspacePid=setTimeout(()=>{this.updateWorkspacePid=null,this.updateWorkspace()},0))}shouldIgnoreMutatorEvent_(e){return e.isUiEvent||e.type===ks||e.type===bs&&e.element==="disabled"}updateWorkspace(){if(!this.workspace_.isDragging()){var e=this.workspace_.getTopBlocks(false);for(let a=0,d;d=e[a];a++){var t=d.getRelativeToSurfaceXY();if(20>t.y&&d.moveBy(0,20-t.y),d.RTL){var r=-20;const C=this.workspace_.getFlyout();C&&(r-=C.getWidth()),t.x>r&&d.moveBy(r-t.x,0)}else 20>t.x&&d.moveBy(20-t.x,0)}}if(this.rootBlock&&this.rootBlock.workspace===this.workspace_){(e=Ft())||He(true);const a=this.getBlock();if(t=Zr.getExtraBlockState_(a),r=a.rendered,a.rendered=false,a.compose(this.rootBlock),a.rendered=r,a.initSvg(),a.rendered&&a.render(),r=Zr.getExtraBlockState_(a),t!==r){Pe(new(Re(bs))(a,"mutation",null,t,r));const d=Ft();setTimeout(function(){const C=Ft();He(d),a.bumpNeighbours(),He(C)},i.config$$module$build$src$core$config.bumpDelay)}this.workspace_.isDragging()||setTimeout(()=>this.resizeBubble(),0),He(e)}}dispose(){this.getBlock().mutator=null,super.dispose()}updateBlockStyle(){var e=this.workspace_;if(e&&e.getAllBlocks(false)){const t=e.getAllBlocks(false);for(let r=0,a;a=t[r];r++)a.setStyle(a.getStyleName());if(e=e.getFlyout()){e=e.getWorkspace().getAllBlocks(false);for(let r=0,a;a=e[r];r++)a.setStyle(a.getStyleName())}}}static reconnect(e,t,r){if(!e||!e.getSourceBlock().workspace)return false;r=t.getInput(r).connection;const a=e.targetBlock();return a&&a!==t||!r||r.targetConnection===e?false:(r.isConnected()&&r.disconnect(),r.connect(e),true)}static findParentWs(e){let t=null;if(e&&e.options){const r=e.options.parentWorkspace;e.isFlyout?r&&r.options&&(t=r.options.parentWorkspace):r&&(t=r)}return t}},Bv={},Bv.Mutator=i.Mutator$$module$build$src$core$mutator;var Xo=Object.create(null),y0={allExtensions:Xo};Oc("parent_tooltip_when_inline",WC),i.module$build$src$core$extensions={},i.module$build$src$core$extensions.TEST_ONLY=y0,i.module$build$src$core$extensions.apply=Xh,i.module$build$src$core$extensions.buildTooltipForDropdown=GC,i.module$build$src$core$extensions.buildTooltipWithFieldText=VC,i.module$build$src$core$extensions.isRegistered=tE,i.module$build$src$core$extensions.register=Oc,i.module$build$src$core$extensions.registerMixin=MC,i.module$build$src$core$extensions.registerMutator=DC,i.module$build$src$core$extensions.runAfterPageLoad=wc,i.module$build$src$core$extensions.unregister=xC;var Pv={};Pv.removeElem=ni;var Hn={};Hn.arc=cs,Hn.curve=Si,Hn.line=Ba,Hn.lineOnAxis=Ne,Hn.lineTo=Dn,Hn.moveBy=Wt,Hn.moveTo=Us,Hn.point=Ve;var mt={};mt.Coordinate=Oe,mt.KeyCodes=xe,mt.Rect=ts,mt.Size=Ss,mt.Svg=ee,mt.aria=nl,mt.array=Pv,mt.arrayRemove=ZC,mt.browserEvents=Pn,mt.checkMessageReferences=YC,mt.colour=Gs,mt.deprecation=vs,mt.dom=ps,mt.extensions=i.module$build$src$core$extensions,mt.getBlockTypeCounts=eO,mt.getDocumentScroll=QC,mt.getInjectionDivXY_=jC,mt.getRelativeXY=zC,mt.getViewportBBox=JC,mt.idGenerator=Xc,mt.is3dSupported=qC,mt.math=Vc,mt.object=rl,mt.parseBlockColour=sO,mt.parsing=sl,mt.replaceMessageReferences=KC,mt.runAfterPageLoad=iO,mt.screenToWsCoordinates=tO,mt.string=i.module$build$src$core$utils$string,mt.style=Tn,mt.svgMath=pr,mt.svgPaths=Hn,mt.tokenizeInterpolation=XC,mt.toolbox=gr,mt.userAgent=Bn,mt.xml=i.module$build$src$core$utils$xml;var jd=class extends tn{constructor(e,t){super(t),this.type=za,this.isOpen=e}toJson(){const e=super.toJson();if(this.isOpen===void 0)throw Error("Whether this is already open or not is undefined. Either pass a value to the constructor, or call fromJson");return e.isOpen=this.isOpen,e}fromJson(e){o("Blockly.Events.TrashcanOpen.prototype.fromJson","version 9","version 10","Blockly.Events.fromJson"),super.fromJson(e),this.isOpen=e.isOpen}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new jd),t.isOpen=e.isOpen,t}};$e(Te.EVENT,za,jd);var Vn=class{constructor(e){this.name_=e}toString(){return this.name_}};Vn.POSITIONABLE=new Vn("positionable"),Vn.DRAG_TARGET=new Vn("drag_target"),Vn.DELETE_AREA=new Vn("delete_area"),Vn.AUTOHIDEABLE=new Vn("autohideable");var $s=class{constructor(){this.componentData=new Map,this.capabilityToComponentIds=new Map}addComponent(e,t){const r=e.component.id;if(!t&&this.componentData.has(r)){var a;throw Error('Plugin "'+r+'" with capabilities "'+((a=this.componentData.get(r))==null?void 0:a.capabilities)+'" already added.')}for(this.componentData.set(r,e),t=[],a=0;a<e.capabilities.length;a++){const d=String(e.capabilities[a]).toLowerCase();if(t.push(d),this.capabilityToComponentIds.has(d)){let C;(C=this.capabilityToComponentIds.get(d))==null||C.push(r)}else this.capabilityToComponentIds.set(d,[r])}this.componentData.get(r).capabilities=t}removeComponent(e){const t=this.componentData.get(e);if(t){for(let r=0;r<t.capabilities.length;r++){const a=String(t.capabilities[r]).toLowerCase();ni(this.capabilityToComponentIds.get(a),e)}this.componentData.delete(e)}}addCapability(e,t){if(!this.getComponent(e))throw Error('Cannot add capability, "'+t+'". Plugin "'+e+'" has not been added to the ComponentManager');if(this.hasCapability(e,t))console.warn('Plugin "'+e+'already has capability "'+t+'"');else{t=String(t).toLowerCase();var r;(r=this.componentData.get(e))==null||r.capabilities.push(t);var a;(a=this.capabilityToComponentIds.get(t))==null||a.push(e)}}removeCapability(e,t){if(!this.getComponent(e))throw Error('Cannot remove capability, "'+t+'". Plugin "'+e+'" has not been added to the ComponentManager');this.hasCapability(e,t)?(t=String(t).toLowerCase(),ni(this.componentData.get(e).capabilities,t),ni(this.capabilityToComponentIds.get(t),e)):console.warn('Plugin "'+e+`doesn't have capability "`+t+'" to remove')}hasCapability(e,t){return t=String(t).toLowerCase(),this.componentData.has(e)&&this.componentData.get(e).capabilities.indexOf(t)!==-1}getComponent(e){let t;return(t=this.componentData.get(e))==null?void 0:t.component}getComponents(e,t){if(e=String(e).toLowerCase(),e=this.capabilityToComponentIds.get(e),!e)return[];const r=[];if(t){const a=[];e.forEach(d=>{a.push(this.componentData.get(d))}),a.sort(function(d,C){return d.weight-C.weight}),a.forEach(function(d){r.push(d.component)})}else e.forEach(a=>{r.push(this.componentData.get(a).component)});return r}};$s.Capability=Vn;var ol=class extends Error{},Uv=class extends ol{constructor(e){super("Expected to find a 'type' property, defining the block type"),this.state=e}},al=class extends ol{constructor(e,t,r){super(`The block ${t.toDevString()} is missing a(n) ${e}
connection`),this.block=t,this.state=r}},Fv=class extends ol{constructor(e,t,r,a){super(`The block ${r.toDevString()} could not connect its
${t} to its parent, because: ${e}`),this.childBlock=r,this.childState=a}},Gv=class extends ol{constructor(e){super(`Encountered a real block which is defined as a child of a shadow
block. It is an invariant of Blockly that shadow blocks only have shadow
children`),this.state=e}},Ko={};Ko.BadConnectionCheck=Fv,Ko.DeserializationError=ol,Ko.MissingBlockType=Uv,Ko.MissingConnection=al,Ko.RealChildOfShadow=Gv;var Hv=100,Vv=75,Wv=50,du={};du.BLOCKS=Wv,du.PROCEDURES=Vv,du.VARIABLES=Hv;var Xd={};Xd.register=qh,Xd.unregister=nO;var zv=class{constructor(){this.priority=Wv}save(e){const t=[];for(const r of e.getTopBlocks(false))(e=xn(r,{addCoordinates:true,doFullSerialization:false}))&&t.push(e);return t.length?{languageVersion:0,blocks:t}:null}load(e,t){e=e.blocks;for(const r of e)Hr(r,t,{recordUndo:Ps()})}clear(e){for(const t of e.getTopBlocks(false))t.dispose(false)}};qh("blocks",new zv);var ll={};ll.BlockSerializer=zv,ll.append=Hr,ll.appendInternal=Jh,ll.save=xn;var Kd=class extends Vo{constructor(e){super(e),this.type=ks,e&&(e.isShadow()&&(this.recordUndo=false),this.xml=bc(e),this.ids=ye(e),this.json=xn(e,{addCoordinates:true}))}toJson(){const e=super.toJson();if(!this.xml)throw Error("The block XML is undefined. Either pass a block to the constructor, or call fromJson");if(!this.ids)throw Error("The block IDs are undefined. Either pass a block to the constructor, or call fromJson");if(!this.json)throw Error("The block JSON is undefined. Either pass a block to the constructor, or call fromJson");return e.xml=Bi(this.xml),e.ids=this.ids,e.json=this.json,this.recordUndo||(e.recordUndo=this.recordUndo),e}fromJson(e){o("Blockly.Events.BlockCreate.prototype.fromJson","version 9","version 10","Blockly.Events.fromJson"),super.fromJson(e),this.xml=zs(e.xml),this.ids=e.ids,this.json=e.json,e.recordUndo!==void 0&&(this.recordUndo=e.recordUndo)}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new Kd),t.xml=zs(e.xml),t.ids=e.ids,t.json=e.json,e.recordUndo!==void 0&&(t.recordUndo=e.recordUndo),t}run(e){const t=this.getEventWorkspace_();if(!this.json)throw Error("The block JSON is undefined. Either pass a block to the constructor, or call fromJson");if(!this.ids)throw Error("The block IDs are undefined. Either pass a block to the constructor, or call fromJson");if(e)Hr(this.json,t);else for(e=0;e<this.ids.length;e++){const r=this.ids[e],a=t.getBlockById(r);a?a.dispose(false):r===this.blockId&&console.warn("Can't uncreate non-existent block: "+r)}}};$e(Te.EVENT,ks,Kd);var Yd=class extends Vo{constructor(e){if(super(e),this.type=Sn,e){if(e.getParent())throw Error("Connected blocks cannot be deleted.");e.isShadow()&&(this.recordUndo=false),this.oldXml=bc(e),this.ids=ye(e),this.wasShadow=e.isShadow(),this.oldJson=xn(e,{addCoordinates:true})}}toJson(){const e=super.toJson();if(!this.oldXml)throw Error("The old block XML is undefined. Either pass a block to the constructor, or call fromJson");if(!this.ids)throw Error("The block IDs are undefined. Either pass a block to the constructor, or call fromJson");if(this.wasShadow===void 0)throw Error("Whether the block was a shadow is undefined. Either pass a block to the constructor, or call fromJson");if(!this.oldJson)throw Error("The old block JSON is undefined. Either pass a block to the constructor, or call fromJson");return e.oldXml=Bi(this.oldXml),e.ids=this.ids,e.wasShadow=this.wasShadow,e.oldJson=this.oldJson,this.recordUndo||(e.recordUndo=this.recordUndo),e}fromJson(e){o("Blockly.Events.BlockDelete.prototype.fromJson","version 9","version 10","Blockly.Events.fromJson"),super.fromJson(e),this.oldXml=zs(e.oldXml),this.ids=e.ids,this.wasShadow=e.wasShadow||this.oldXml.tagName.toLowerCase()==="shadow",this.oldJson=e.oldJson,e.recordUndo!==void 0&&(this.recordUndo=e.recordUndo)}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new Yd),t.oldXml=zs(e.oldXml),t.ids=e.ids,t.wasShadow=e.wasShadow||t.oldXml.tagName.toLowerCase()==="shadow",t.oldJson=e.oldJson,e.recordUndo!==void 0&&(t.recordUndo=e.recordUndo),t}run(e){const t=this.getEventWorkspace_();if(!this.ids)throw Error("The block IDs are undefined. Either pass a block to the constructor, or call fromJson");if(!this.oldJson)throw Error("The old block JSON is undefined. Either pass a block to the constructor, or call fromJson");if(e)for(e=0;e<this.ids.length;e++){const r=this.ids[e],a=t.getBlockById(r);a?a.dispose(false):r===this.blockId&&console.warn("Can't delete non-existent block: "+r)}else Hr(this.oldJson,t)}};$e(Te.EVENT,Sn,Yd);var Le;(function(e){e[e.INPUT_VALUE=1]="INPUT_VALUE",e[e.OUTPUT_VALUE=2]="OUTPUT_VALUE",e[e.NEXT_STATEMENT=3]="NEXT_STATEMENT",e[e.PREVIOUS_STATEMENT=4]="PREVIOUS_STATEMENT"})(Le||(Le={})),i.module$build$src$core$connection_type={},i.module$build$src$core$connection_type.ConnectionType=Le;var Rt=class{constructor(e,t){this.type=t,this.targetConnection=null,this.disposed=false,this.shadowDom_=this.check_=null,this.y=this.x=0,this.shadowState_=null,this.sourceBlock_=e}connect_(e){const t=Le.INPUT_VALUE,r=this.getSourceBlock();var a=e.getSourceBlock();e.isConnected()&&e.disconnect();let d;if(this.isConnected()){const D=this.stashShadowState_(),Y=this.targetBlock();Y.isShadow()?Y.dispose(false):(this.disconnect(),d=Y),this.applyShadowState_(D)}let C;ls()&&(C=new(Re(js))(a)),TO(this,e),a.setParent(r),C&&(C.recordNew(),Pe(C)),d&&(e=this.type===t?d.outputConnection:d.previousConnection,(a=Rt.getConnectionForOrphanedConnection(a,e))?e.connect(a):e.onFailedConnect(this))}dispose(){if(this.isConnected()){this.setShadowStateInternal_();const e=this.targetBlock();e&&e.unplug()}this.disposed=true}getSourceBlock(){return this.sourceBlock_}isSuperior(){return this.type===Le.INPUT_VALUE||this.type===Le.NEXT_STATEMENT}isConnected(){return!!this.targetConnection}getConnectionChecker(){return this.sourceBlock_.workspace.connectionChecker}onFailedConnect(e){}connect(e){if(this.targetConnection===e)return true;if(this.getConnectionChecker().canConnect(this,e,false)){const t=Ft();t||He(true),this.isSuperior()?this.connect_(e):e.connect_(this),t||He(false)}return this.isConnected()}disconnect(){var e=this.targetConnection;if(!e)throw Error("Source connection not connected.");if(e.targetConnection!==this)throw Error("Target connection not connected to source connection.");let t,r;this.isSuperior()?(t=this.sourceBlock_,r=e.getSourceBlock(),e=this):(t=e.getSourceBlock(),r=this.sourceBlock_);const a=Ft();a||He(true),this.disconnectInternal_(t,r),r.isShadow()||e.respawnShadow_(),a||He(false)}disconnectInternal_(e,t){let r;ls()&&(r=new(Re(js))(t)),(e=this.targetConnection)&&(e.targetConnection=null),this.targetConnection=null,t.setParent(null),r&&(r.recordNew(),Pe(r))}respawnShadow_(){this.createShadowBlock_(true)}targetBlock(){if(this.isConnected()){let e,t;return(t=(e=this.targetConnection)==null?void 0:e.getSourceBlock())!=null?t:null}return null}onCheckChanged_(){!this.isConnected()||this.targetConnection&&this.getConnectionChecker().canConnect(this,this.targetConnection,false)||(this.isSuperior()?this.targetBlock():this.sourceBlock_).unplug()}setCheck(e){return e?(Array.isArray(e)||(e=[e]),this.check_=e,this.onCheckChanged_()):this.check_=null,this}getCheck(){return this.check_}setShadowDom(e){this.setShadowStateInternal_({shadowDom:e})}getShadowDom(e){return e&&this.targetBlock().isShadow()?Ur(this.targetBlock()):this.shadowDom_}setShadowState(e){this.setShadowStateInternal_({shadowState:e})}getShadowState(e){return e&&this.targetBlock()&&this.targetBlock().isShadow()?xn(this.targetBlock()):this.shadowState_}neighbours(e){return[]}getParentInput(){let e=null;const t=this.sourceBlock_.inputList;for(let r=0;r<t.length;r++)if(t[r].connection===this){e=t[r];break}return e}toString(){const e=this.sourceBlock_;if(!e)return"Orphan Connection";if(e.outputConnection===this)var t="Output Connection of ";else if(e.previousConnection===this)t="Previous Connection of ";else if(e.nextConnection===this)t="Next Connection of ";else{t=null;for(let r=0,a;a=e.inputList[r];r++)if(a.connection===this){t=a;break}if(t)t='Input "'+t.name+'" connection on ';else return console.warn("Connection not actually connected to sourceBlock_"),"Orphan Connection"}return t+e.toDevString()}stashShadowState_(){const e=this.getShadowDom(true),t=this.getShadowState(true);return this.shadowState_=this.shadowDom_=null,{shadowDom:e,shadowState:t}}applyShadowState_({shadowDom:e,shadowState:t}){this.shadowDom_=e,this.shadowState_=t}setShadowStateInternal_({shadowDom:e=null,shadowState:t=null}={}){this.shadowDom_=e,this.shadowState_=t,(e=this.targetBlock())?e.isShadow()?(e.dispose(false),this.respawnShadow_(),this.targetBlock()&&this.targetBlock().isShadow()&&this.serializeShadow_(this.targetBlock())):(e=this.createShadowBlock_(false),this.serializeShadow_(e),e&&e.dispose(false)):(this.respawnShadow_(),this.targetBlock()&&this.targetBlock().isShadow()&&this.serializeShadow_(this.targetBlock()))}createShadowBlock_(e){var t=this.getSourceBlock();const r=this.getShadowState(),a=this.getShadowDom();if(t.isDeadOrDying()||!r&&!a)return null;if(r)return t=Jh(r,t.workspace,{parentConnection:e?this:void 0,isShadow:true,recordUndo:false});if(a){if(t=Co(a,t.workspace),e)if(this.type===Le.INPUT_VALUE){if(!t.outputConnection)throw Error("Shadow block is missing an output connection");if(!this.connect(t.outputConnection))throw Error("Could not connect shadow block to connection")}else if(this.type===Le.NEXT_STATEMENT){if(!t.previousConnection)throw Error("Shadow block is missing previous connection");if(!this.connect(t.previousConnection))throw Error("Could not connect shadow block to connection")}else throw Error("Cannot connect a shadow block to a previous/output connection");return t}return null}serializeShadow_(e){e&&(this.shadowDom_=Ur(e),this.shadowState_=xn(e))}static getConnectionForOrphanedConnection(e,t){if(t.type===Le.OUTPUT_VALUE)return $O(e,t.getSourceBlock());e=e.lastConnectionInStack(true);const r=t.getConnectionChecker();return e&&r.canConnect(t,e,false)?e:null}};Rt.CAN_CONNECT=0,Rt.REASON_SELF_CONNECTION=1,Rt.REASON_WRONG_TYPE=2,Rt.REASON_TARGET_NULL=3,Rt.REASON_CHECKS_FAILED=4,Rt.REASON_DIFFERENT_WORKSPACES=5,Rt.REASON_SHADOW_PARENT=6,Rt.REASON_DRAG_CHECKS_FAILED=7,Rt.REASON_PREVIOUS_AND_OUTPUT=8;var cl="_TEMP_COLLAPSED_INPUT",ul="_TEMP_COLLAPSED_FIELD",qd={};qd.COLLAPSED_FIELD_NAME=ul,qd.COLLAPSED_INPUT_NAME=cl,i.FieldLabel$$module$build$src$core$field_label=class extends pt{constructor(e,t,r){super(pt.SKIP_SETUP),this.class_=null,this.EDITABLE=false,e!==pt.SKIP_SETUP&&(r?this.configure_(r):this.class_=t||null,this.setValue(e))}configure_(e){super.configure_(e),e.class&&(this.class_=e.class)}initView(){this.createTextElement_(),this.class_&&ie(this.getTextElement(),this.class_)}doClassValidation_(e){return e==null?null:String(e)}setClass(e){this.textElement_&&(this.class_&&he(this.textElement_,this.class_),e&&ie(this.textElement_,e)),this.class_=e}static fromJson(e){return new this(es(e.text),void 0,e)}},Pi("field_label",i.FieldLabel$$module$build$src$core$field_label),i.FieldLabel$$module$build$src$core$field_label.prototype.DEFAULT_VALUE="",i.FieldLabel$$module$build$src$core$field_label;var Yo=class{constructor(e,t,r,a){if(this.type=e,this.name=t,this.connection=a,this.fieldRow=[],this.align=i.Align$$module$build$src$core$input.LEFT,this.visible=true,e!==lt.DUMMY&&!t)throw Error("Value inputs and statement inputs must have non-empty name.");this.sourceBlock=r}getSourceBlock(){return this.sourceBlock}appendField(e,t){return this.insertFieldAt(this.fieldRow.length,e,t),this}insertFieldAt(e,t,r){if(0>e||e>this.fieldRow.length)throw Error("index "+e+" out of bounds.");return(t||t===""&&r)&&(typeof t=="string"&&(t=Vh({type:"field_label",text:t})),t.setSourceBlock(this.sourceBlock),this.sourceBlock.rendered&&(t.init(),t.applyColour()),t.name=r,t.setVisible(this.isVisible()),t.prefixField&&(e=this.insertFieldAt(e,t.prefixField)),this.fieldRow.splice(e,0,t),e++,t.suffixField&&(e=this.insertFieldAt(e,t.suffixField)),this.sourceBlock.rendered&&(this.sourceBlock.render(),this.sourceBlock.bumpNeighbours())),e}removeField(e,t){for(let r=0,a;a=this.fieldRow[r];r++)if(a.name===e)return a.dispose(),this.fieldRow.splice(r,1),this.sourceBlock.rendered&&(this.sourceBlock.render(),this.sourceBlock.bumpNeighbours()),true;if(t)return false;throw Error('Field "'+e+'" not found.')}isVisible(){return this.visible}setVisible(e){let t=[];if(this.visible===e)return t;this.visible=e;for(let a=0,d;d=this.fieldRow[a];a++)d.setVisible(e);if(this.connection){var r=this.connection;e?t=r.startTrackingAll():r.stopTrackingAll(),(r=r.targetBlock())&&(r.getSvgRoot().style.display=e?"block":"none")}return t}markDirty(){for(let e=0,t;t=this.fieldRow[e];e++)t.markDirty()}setCheck(e){if(!this.connection)throw Error("This input does not have a connection.");return this.connection.setCheck(e),this}setAlign(e){return this.align=e,this.sourceBlock.rendered&&this.sourceBlock.render(),this}setShadowDom(e){if(!this.connection)throw Error("This input does not have a connection.");return this.connection.setShadowDom(e),this}getShadowDom(){if(!this.connection)throw Error("This input does not have a connection.");return this.connection.getShadowDom()}init(){if(this.sourceBlock.workspace.rendered)for(let e=0;e<this.fieldRow.length;e++)this.fieldRow[e].init()}dispose(){for(let e=0,t;t=this.fieldRow[e];e++)t.dispose();this.connection&&this.connection.dispose()}},Jd;(function(e){e=e.Align||(e.Align={}),e[e.LEFT=-1]="LEFT",e[e.CENTRE=0]="CENTRE",e[e.RIGHT=1]="RIGHT"})(Yo||(Yo={})),i.Align$$module$build$src$core$input=Yo.Align,Jd={},Jd.Align=i.Align$$module$build$src$core$input,Jd.Input=Yo;var ge=class{constructor(e,t,r){if(this.wsCoordinate_=null,!t)throw Error("Cannot create a node without a location.");this.type_=e,this.isConnection_=ge.isConnectionType_(e),this.location_=t,this.processParams_(r||null)}processParams_(e){e&&e.wsCoordinate&&(this.wsCoordinate_=e.wsCoordinate)}getLocation(){return this.location_}getType(){return this.type_}getWsCoordinate(){return this.wsCoordinate_}isConnection(){return this.isConnection_}findNextForInput_(){var e=this.location_.getParentInput();const t=e.getSourceBlock();for(e=t.inputList.indexOf(e),e+=1;e<t.inputList.length;e++){const r=t.inputList[e],a=r.fieldRow;for(let d=0;d<a.length;d++){const C=a[d];if(C.isClickable()||ge.NAVIGATE_ALL_FIELDS)return ge.createFieldNode(C)}if(r.connection)return ge.createInputNode(r)}return null}findNextForField_(){var e=this.location_,t=e.getParentInput();const r=e.getSourceBlock();if(!r)throw Error("The current AST location is not associated with a block");var a=r.inputList.indexOf(t);for(e=t.fieldRow.indexOf(e)+1;a<r.inputList.length;a++){t=r.inputList[a];const d=t.fieldRow;for(;e<d.length;){if(d[e].isClickable()||ge.NAVIGATE_ALL_FIELDS)return ge.createFieldNode(d[e]);e++}if(e=0,t.connection)return ge.createInputNode(t)}return null}findPrevForInput_(){const e=this.location_.getParentInput(),t=e.getSourceBlock();for(var r=t.inputList.indexOf(e);0<=r;r--){var a=t.inputList[r];if(a.connection&&a!==e)return ge.createInputNode(a);a=a.fieldRow;for(let d=a.length-1;0<=d;d--){const C=a[d];if(C.isClickable()||ge.NAVIGATE_ALL_FIELDS)return ge.createFieldNode(C)}}return null}findPrevForField_(){var e=this.location_;const t=e.getParentInput(),r=e.getSourceBlock();if(!r)throw Error("The current AST location is not associated with a block");var a=r.inputList.indexOf(t);for(e=t.fieldRow.indexOf(e)-1;0<=a;a--){var d=r.inputList[a];if(d.connection&&d!==t)return ge.createInputNode(d);for(d=d.fieldRow;-1<e;){if(d[e].isClickable()||ge.NAVIGATE_ALL_FIELDS)return ge.createFieldNode(d[e]);e--}0<=a-1&&(e=r.inputList[a-1].fieldRow.length-1)}return null}navigateBetweenStacks_(e){var t=this.getLocation();if(t.getSourceBlock){var r=t.getSourceBlock();r&&(t=r)}if(!t||t.isDeadOrDying())return null;r=t.getRootBlock(),t=r.workspace.getTopBlocks(true);for(let a=0;a<t.length;a++)if(r.id===t[a].id)return e=a+(e?1:-1),e===-1||e===t.length?null:ge.createStackNode(t[e]);throw Error("Couldn't find "+(e?"next":"previous")+" stack?!")}findTopASTNodeForBlock_(e){const t=kc(e);return t?ge.createConnectionNode(t):ge.createBlockNode(e)}getOutAstNodeForBlock_(e){if(!e)return null;e=e.getTopStackBlock();const t=kc(e);return t&&t.targetConnection&&t.targetConnection.getParentInput()?ge.createInputNode(t.targetConnection.getParentInput()):ge.createStackNode(e)}findFirstFieldOrInput_(e){e=e.inputList;for(let t=0;t<e.length;t++){const r=e[t],a=r.fieldRow;for(let d=0;d<a.length;d++){const C=a[d];if(C.isClickable()||ge.NAVIGATE_ALL_FIELDS)return ge.createFieldNode(C)}if(r.connection)return ge.createInputNode(r)}return null}getSourceBlock(){return this.getType()===ge.types.BLOCK?this.getLocation():this.getType()===ge.types.STACK?this.getLocation():this.getType()===ge.types.WORKSPACE?null:this.getLocation().getSourceBlock()}next(){switch(this.type_){case ge.types.STACK:return this.navigateBetweenStacks_(true);case ge.types.OUTPUT:return ge.createBlockNode(this.location_.getSourceBlock());case ge.types.FIELD:return this.findNextForField_();case ge.types.INPUT:return this.findNextForInput_();case ge.types.BLOCK:return ge.createConnectionNode(this.location_.nextConnection);case ge.types.PREVIOUS:return ge.createBlockNode(this.location_.getSourceBlock());case ge.types.NEXT:return ge.createConnectionNode(this.location_.targetConnection)}return null}in(){switch(this.type_){case ge.types.WORKSPACE:const e=this.location_.getTopBlocks(true);if(0<e.length)return ge.createStackNode(e[0]);break;case ge.types.STACK:return this.findTopASTNodeForBlock_(this.location_);case ge.types.BLOCK:return this.findFirstFieldOrInput_(this.location_);case ge.types.INPUT:return ge.createConnectionNode(this.location_.targetConnection)}return null}prev(){switch(this.type_){case ge.types.STACK:return this.navigateBetweenStacks_(false);case ge.types.FIELD:return this.findPrevForField_();case ge.types.INPUT:return this.findPrevForInput_();case ge.types.BLOCK:var e=kc(this.location_);return ge.createConnectionNode(e);case ge.types.PREVIOUS:if((e=this.location_.targetConnection)&&!e.getParentInput())return ge.createConnectionNode(e);break;case ge.types.NEXT:return ge.createBlockNode(this.location_.getSourceBlock())}return null}out(){switch(this.type_){case ge.types.STACK:var e=this.location_,t=e.getRelativeToSurfaceXY();return t=new Oe(t.x,t.y+ge.DEFAULT_OFFSET_Y),ge.createWorkspaceNode(e.workspace,t);case ge.types.OUTPUT:return e=this.location_,(t=e.targetConnection)?ge.createConnectionNode(t):ge.createStackNode(e.getSourceBlock());case ge.types.FIELD:if(e=this.location_.getSourceBlock(),!e)throw Error("The current AST location is not associated with a block");return ge.createBlockNode(e);case ge.types.INPUT:return ge.createBlockNode(this.location_.getSourceBlock());case ge.types.BLOCK:return this.getOutAstNodeForBlock_(this.location_);case ge.types.PREVIOUS:return this.getOutAstNodeForBlock_(this.location_.getSourceBlock());case ge.types.NEXT:return this.getOutAstNodeForBlock_(this.location_.getSourceBlock())}return null}static isConnectionType_(e){switch(e){case ge.types.PREVIOUS:case ge.types.NEXT:case ge.types.INPUT:case ge.types.OUTPUT:return true}return false}static createFieldNode(e){return e?new ge(ge.types.FIELD,e):null}static createConnectionNode(e){if(!e)return null;const t=e.type;return t===Le.INPUT_VALUE||t===Le.NEXT_STATEMENT&&e.getParentInput()?ge.createInputNode(e.getParentInput()):t===Le.NEXT_STATEMENT?new ge(ge.types.NEXT,e):t===Le.OUTPUT_VALUE?new ge(ge.types.OUTPUT,e):t===Le.PREVIOUS_STATEMENT?new ge(ge.types.PREVIOUS,e):null}static createInputNode(e){return e&&e.connection?new ge(ge.types.INPUT,e.connection):null}static createBlockNode(e){return e?new ge(ge.types.BLOCK,e):null}static createStackNode(e){return e?new ge(ge.types.STACK,e):null}static createWorkspaceNode(e,t){return t&&e?new ge(ge.types.WORKSPACE,e,{wsCoordinate:t}):null}static createTopNode(e){const t=kc(e);return t?ge.createConnectionNode(t):ge.createBlockNode(e)}};ge.NAVIGATE_ALL_FIELDS=false,ge.DEFAULT_OFFSET_Y=-20,function(e){e=e.types||(e.types={}),e.FIELD="field",e.BLOCK="block",e.INPUT="input",e.OUTPUT="output",e.NEXT="next",e.PREVIOUS="previous",e.STACK="stack",e.WORKSPACE="workspace"}(ge||(ge={}));var qo=class{constructor(e,t,r){if(this.data=null,this.disposed=false,this.hue_=null,this.colour_="#000000",this.styleName_="",this.loadExtraState=this.saveExtraState=this.domToMutation=this.mutationToDom=this.destroy=this.init=void 0,this.suppressPrefixSuffix=false,this.decompose=this.compose=this.getDeveloperVariables=void 0,this.previousConnection=this.nextConnection=this.outputConnection=null,this.inputList=[],this.inputsInline=void 0,this.disabled=false,this.tooltip="",this.contextMenu=true,this.parentBlock_=null,this.childBlocks_=[],this.editable_=this.movable_=this.deletable_=true,this.collapsed_=this.isShadow_=false,this.outputShape_=null,this.disposing=false,this.comment=null,this.isInsertionMarker_=false,this.hat=void 0,this.onchangeWrapper_=this.helpUrl=this.rendered=null,this.statementInputCount=0,this.workspace=e,this.id=r&&!e.getBlockById(r)?r:mi(),e.setBlockById(this.id,this),this.commentModel={text:null,pinned:false,size:new Ss(160,80)},this.xy_=new Oe(0,0),this.isInFlyout=e.isFlyout,this.isInMutator=e.isMutator,this.RTL=e.RTL,t){if(this.type=t,r=oi[t],!r||typeof r!="object")throw TypeError("Invalid block definition for type: "+t);Object.assign(this,r)}e.addTopBlock(this),e.addTypedBlock(this),new.target===qo&&this.doInit_()}doInit_(){const e=Ft();e||He(true);const t=Ps();try{typeof this.init=="function"&&(Bs(false),this.init(),Bs(t)),ls()&&Pe(new(Re(ks))(this))}finally{e||He(false),Bs(t)}this.inputsInlineDefault=this.inputsInline,typeof this.onchange=="function"&&this.setOnChange(this.onchange)}dispose(e){if(!this.isDeadOrDying()){this.onchangeWrapper_&&this.workspace.removeChangeListener(this.onchangeWrapper_),this.unplug(e),ls()&&Pe(new(Re(Sn))(this)),Zt();try{this.workspace.removeTopBlock(this),this.workspace.removeTypedBlock(this),this.workspace.removeBlockById(this.id),this.disposing=true;for(let r=this.childBlocks_.length-1;0<=r;r--)this.childBlocks_[r].dispose(false);for(let r=0,a;a=this.inputList[r];r++)a.dispose();this.inputList.length=0;const t=this.getConnections_(true);for(let r=0,a;a=t[r];r++)a.dispose()}finally{ss(),typeof this.destroy=="function"&&this.destroy(),this.disposed=true}}}isDeadOrDying(){return this.disposing||this.disposed}initModel(){for(let e=0,t;t=this.inputList[e];e++)for(let r=0,a;a=t.fieldRow[r];r++)a.initModel&&a.initModel()}unplug(e){this.outputConnection&&this.unplugFromRow_(e),this.previousConnection&&this.unplugFromStack_(e)}unplugFromRow_(e){let t=null;this.outputConnection.isConnected()&&(t=this.outputConnection.targetConnection,this.outputConnection.disconnect()),t&&e&&(e=this.getOnlyValueConnection_())&&e.isConnected()&&!e.targetBlock().isShadow()&&(e=e.targetConnection,e==null||e.disconnect(),this.workspace.connectionChecker.canConnect(e,t,false)?t.connect(e):e==null||e.onFailedConnect(t))}getOnlyValueConnection_(){let e=null;for(let t=0;t<this.inputList.length;t++){const r=this.inputList[t].connection;if(r&&r.type===Le.INPUT_VALUE&&r.targetConnection){if(e)return null;e=r}}return e}unplugFromStack_(e){let t=null;this.previousConnection.isConnected()&&(t=this.previousConnection.targetConnection,this.previousConnection.disconnect());const r=this.getNextBlock();e&&r&&!r.isShadow()&&(e=this.nextConnection.targetConnection,e==null||e.disconnect(),t&&this.workspace.connectionChecker.canConnect(t,e,false)&&t.connect(e))}getConnections_(e){e=[],this.outputConnection&&e.push(this.outputConnection),this.previousConnection&&e.push(this.previousConnection),this.nextConnection&&e.push(this.nextConnection);for(let t=0,r;r=this.inputList[t];t++)r.connection&&e.push(r.connection);return e}lastConnectionInStack(e){let t=this.nextConnection;for(;t;){const r=t.targetBlock();if(!r||e&&r.isShadow())return t;t=r.nextConnection}return null}bumpNeighbours(){}getParent(){return this.parentBlock_}getInputWithBlock(e){for(let t=0,r;r=this.inputList[t];t++)if(r.connection&&r.connection.targetBlock()===e)return r;return null}getSurroundParent(){let e=this,t;do if(t=e,e=e.getParent(),!e)return null;while(e.getNextBlock()===t);return e}getNextBlock(){return this.nextConnection&&this.nextConnection.targetBlock()}getPreviousBlock(){return this.previousConnection&&this.previousConnection.targetBlock()}getFirstStatementConnection(){for(let e=0,t;t=this.inputList[e];e++)if(t.connection&&t.connection.type===Le.NEXT_STATEMENT)return t.connection;return null}getRootBlock(){let e,t=this;do e=t,t=e.parentBlock_;while(t);return e}getTopStackBlock(){let e=this,t;do t=e.getPreviousBlock();while(t&&t.getNextBlock()===e&&(e=t));return e}getChildren(e){if(!e)return this.childBlocks_;e=[];for(let r=0,a;a=this.inputList[r];r++)if(a.connection){var t=a.connection.targetBlock();t&&e.push(t)}return(t=this.getNextBlock())&&e.push(t),e}setParent(e){if(e!==this.parentBlock_){var t=this.previousConnection&&this.previousConnection.targetBlock()||this.outputConnection&&this.outputConnection.targetBlock(),r=!!t;if(r&&e&&t!==e)throw Error("Block connected to superior one that is not new parent.");if(!r&&e)throw Error("Block not connected to new parent.");if(r&&!e)throw Error("Cannot set parent to null while block is still connected to superior block.");this.parentBlock_?ni(this.parentBlock_.childBlocks_,this):this.workspace.removeTopBlock(this),(this.parentBlock_=e)?e.childBlocks_.push(this):this.workspace.addTopBlock(this)}}getDescendants(e){const t=[this],r=this.getChildren(e);for(let a,d=0;a=r[d];d++)t.push(...a.getDescendants(e));return t}isDeletable(){return this.deletable_&&!this.isShadow_&&!this.isDeadOrDying()&&!this.workspace.options.readOnly}setDeletable(e){this.deletable_=e}isMovable(){return this.movable_&&!this.isShadow_&&!this.isDeadOrDying()&&!this.workspace.options.readOnly}setMovable(e){this.movable_=e}isDuplicatable(){return this.workspace.hasBlockLimits()?this.workspace.isCapacityAvailable(j(this,true)):true}isShadow(){return this.isShadow_}setShadow(e){this.isShadow_=e}isInsertionMarker(){return this.isInsertionMarker_}setInsertionMarker(e){this.isInsertionMarker_=e}isEditable(){return this.editable_&&!this.isDeadOrDying()&&!this.workspace.options.readOnly}setEditable(e){this.editable_=e;for(let t=0,r;r=this.inputList[t];t++)for(let a=0,d;d=r.fieldRow[a];a++)d.updateEditable()}isDisposed(){return this.disposed}getMatchingConnection(e,t){const r=this.getConnections_(true);if(e=e.getConnections_(true),r.length!==e.length)throw Error("Connection lists did not match in length.");for(let a=0;a<e.length;a++)if(e[a]===t)return r[a];return null}setHelpUrl(e){this.helpUrl=e}setTooltip(e){this.tooltip=e}getTooltip(){return xa(this)}getColour(){return this.colour_}getStyleName(){return this.styleName_}getHue(){return this.hue_}setColour(e){e=wo(e),this.hue_=e.hue,this.colour_=e.hex}setStyle(e){this.styleName_=e}setOnChange(e){if(e&&typeof e!="function")throw Error("onchange must be a function.");this.onchangeWrapper_&&this.workspace.removeChangeListener(this.onchangeWrapper_),this.onchange=e,this.onchangeWrapper_=e.bind(this),this.workspace.addChangeListener(this.onchangeWrapper_)}getField(e){if(typeof e!="string")throw TypeError("Block.prototype.getField expects a string with the field name but received "+(e===void 0?"nothing":e+" of type "+typeof e)+" instead");for(let t=0,r;r=this.inputList[t];t++)for(let a=0,d;d=r.fieldRow[a];a++)if(d.name===e)return d;return null}getVars(){const e=[];for(let t=0,r;r=this.inputList[t];t++)for(let a=0,d;d=r.fieldRow[a];a++)d.referencesVariables()&&e.push(d.getValue());return e}getVarModels(){const e=[];for(let t=0,r;r=this.inputList[t];t++)for(let a=0,d;d=r.fieldRow[a];a++)if(d.referencesVariables()){const C=this.workspace.getVariableById(d.getValue());C&&e.push(C)}return e}updateVarName(e){for(let t=0,r;r=this.inputList[t];t++)for(let a=0,d;d=r.fieldRow[a];a++)d.referencesVariables()&&e.getId()===d.getValue()&&d.refreshVariableName()}renameVarById(e,t){for(let r=0,a;a=this.inputList[r];r++)for(let d=0,C;C=a.fieldRow[d];d++)C.referencesVariables()&&e===C.getValue()&&C.setValue(t)}getFieldValue(e){return(e=this.getField(e))?e.getValue():null}setFieldValue(e,t){const r=this.getField(t);if(!r)throw Error('Field "'+t+'" not found.');r.setValue(e)}setPreviousStatement(e,t){if(e)t===void 0&&(t=null),this.previousConnection||(this.previousConnection=this.makeConnection_(Le.PREVIOUS_STATEMENT)),this.previousConnection.setCheck(t);else if(this.previousConnection){if(this.previousConnection.isConnected())throw Error("Must disconnect previous statement before removing connection.");this.previousConnection.dispose(),this.previousConnection=null}}setNextStatement(e,t){if(e)t===void 0&&(t=null),this.nextConnection||(this.nextConnection=this.makeConnection_(Le.NEXT_STATEMENT)),this.nextConnection.setCheck(t);else if(this.nextConnection){if(this.nextConnection.isConnected())throw Error("Must disconnect next statement before removing connection.");this.nextConnection.dispose(),this.nextConnection=null}}setOutput(e,t){if(e)t===void 0&&(t=null),this.outputConnection||(this.outputConnection=this.makeConnection_(Le.OUTPUT_VALUE)),this.outputConnection.setCheck(t);else if(this.outputConnection){if(this.outputConnection.isConnected())throw Error("Must disconnect output value before removing connection.");this.outputConnection.dispose(),this.outputConnection=null}}setInputsInline(e){this.inputsInline!==e&&(Pe(new(Re(bs))(this,"inline",null,this.inputsInline,e)),this.inputsInline=e)}getInputsInline(){if(this.inputsInline!==void 0)return this.inputsInline;for(var e=1;e<this.inputList.length;e++)if(this.inputList[e-1].type===lt.DUMMY&&this.inputList[e].type===lt.DUMMY)return false;for(e=1;e<this.inputList.length;e++)if(this.inputList[e-1].type===lt.VALUE&&this.inputList[e].type===lt.DUMMY)return true;return false}setOutputShape(e){this.outputShape_=e}getOutputShape(){return this.outputShape_}isEnabled(){return!this.disabled}setEnabled(e){if(this.isEnabled()!==e){const t=this.disabled;this.disabled=!e,Pe(new(Re(bs))(this,"disabled",null,t,!e))}}getInheritedDisabled(){let e=this.getSurroundParent();for(;e;){if(e.disabled)return true;e=e.getSurroundParent()}return false}isCollapsed(){return this.collapsed_}setCollapsed(e){this.collapsed_!==e&&(Pe(new(Re(bs))(this,"collapsed",null,this.collapsed_,e)),this.collapsed_=e)}toString(e,t){function r(we){let Et=we.getCheck();return!Et&&we.targetConnection&&(Et=we.targetConnection.getCheck()),!!Et&&(Et.indexOf("Boolean")!==-1||Et.indexOf("Number")!==-1)}function a(){let we,Et;D&&D.getType()===((we=Y)==null?void 0:we.getType())&&D.getLocation()===((Et=Y)==null?void 0:Et.getLocation())&&(D=null)}var d=[];t=t||"?";const C=ge.NAVIGATE_ALL_FIELDS;ge.NAVIGATE_ALL_FIELDS=true;let D=ge.createBlockNode(this);const Y=D;for(;D;){switch(D.getType()){case ge.types.INPUT:var pe=D.getLocation();D.in()?r(pe)&&d.push("("):d.push(t);break;case ge.types.FIELD:pe=D.getLocation(),pe.name!==ul&&d.push(pe.getText())}if(pe=D,D=pe.in()||pe.next(),!D){for(D=pe.out(),a();D&&!D.next();)D=D.out(),a(),D&&D.getType()===ge.types.INPUT&&r(D.getLocation())&&d.push(")");D&&(D=D.next())}}for(ge.NAVIGATE_ALL_FIELDS=C,t=2;t<d.length;t++)d[t-2]==="("&&d[t]===")"&&(d[t-2]=d[t-1],d.splice(t-1,2));return d=d.reduce(function(we,Et){return we+(we.substr(-1)==="("||Et===")"?"":" ")+Et},""),d=d.trim()||"???",e&&d.length>e&&(d=d.substring(0,e-3)+"..."),d}appendValueInput(e){return this.appendInput_(lt.VALUE,e)}appendStatementInput(e){return this.appendInput_(lt.STATEMENT,e)}appendDummyInput(e){return this.appendInput_(lt.DUMMY,e||"")}jsonInit(e){var t=e.type?'Block "'+e.type+'": ':"";if(e.output&&e.previousStatement)throw Error(t+"Must not have both an output and a previousStatement.");if(e.style&&e.style.hat&&(this.hat=e.style.hat,e.style=null),e.style&&e.colour)throw Error(t+"Must not have both a colour and a style.");e.style?this.jsonInitStyle_(e,t):this.jsonInitColour_(e,t);for(var r=0;e["message"+r]!==void 0;)this.interpolate_(e["message"+r],e["args"+r]||[],e["lastDummyAlign"+r],t),r++;if(e.inputsInline!==void 0&&this.setInputsInline(e.inputsInline),e.output!==void 0&&this.setOutput(true,e.output),e.outputShape!==void 0&&this.setOutputShape(e.outputShape),e.previousStatement!==void 0&&this.setPreviousStatement(true,e.previousStatement),e.nextStatement!==void 0&&this.setNextStatement(true,e.nextStatement),e.tooltip!==void 0&&(r=es(e.tooltip),this.setTooltip(r)),e.enableContextMenu!==void 0&&(this.contextMenu=!!e.enableContextMenu),e.suppressPrefixSuffix!==void 0&&(this.suppressPrefixSuffix=!!e.suppressPrefixSuffix),e.helpUrl!==void 0&&(r=es(e.helpUrl),this.setHelpUrl(r)),typeof e.extensions=="string"&&(console.warn(t+"JSON attribute 'extensions' should be an array of strings. Found raw string in JSON for '"+e.type+"' block."),e.extensions=[e.extensions]),e.mutator!==void 0&&Xh(e.mutator,this,true),e=e.extensions,Array.isArray(e))for(t=0;t<e.length;t++)Xh(e[t],this,false)}jsonInitColour_(e,t){if("colour"in e)if(e.colour===void 0)console.warn(t+"Undefined colour value.");else{e=e.colour;try{this.setColour(e)}catch{console.warn(t+"Illegal colour value: ",e)}}}jsonInitStyle_(e,t){e=e.style;try{this.setStyle(e)}catch{console.warn(t+"Style does not exist: ",e)}}mixin(e,t){if(t!==void 0&&typeof t!="boolean")throw Error("opt_disableCheck must be a boolean if provided");if(!t){t=[];for(const r in e)this[r]!==void 0&&t.push(r);if(t.length)throw Error("Mixin will overwrite block members: "+JSON.stringify(t))}Object.assign(this,e)}interpolate_(e,t,r,a){e=Fh(e),this.validateTokens_(e,t.length),t=this.interpolateArguments_(e,t,r),r=[];for(let d=0,C;C=t[d];d++)if(this.isInputKeyword_(C.type)){if(e=this.inputFromJson_(C,a)){for(let D=0,Y;Y=r[D];D++)e.appendField(Y[0],Y[1]);r.length=0}}else(e=this.fieldFromJson_(C))&&r.push([e,C.name])}validateTokens_(e,t){const r=[];let a=0;for(let d=0;d<e.length;d++){const C=e[d];if(typeof C=="number"){if(1>C||C>t)throw Error('Block "'+this.type+'": Message index %'+C+" out of range.");if(r[C])throw Error('Block "'+this.type+'": Message index %'+C+" duplicated.");r[C]=true,a++}}if(a!==t)throw Error('Block "'+this.type+'": Message does not reference all '+t+" arg(s).")}interpolateArguments_(e,t,r){const a=[];for(let d=0;d<e.length;d++){let C=e[d];typeof C=="number"&&(C=t[C-1]),!(typeof C=="string"&&(C=this.stringToFieldJson_(C),!C))&&a.push(C)}return(e=a.length)&&!this.isInputKeyword_(a[e-1].type)&&(e={type:"input_dummy"},r&&(e.align=r),a.push(e)),a}fieldFromJson_(e){const t=Vh(e);return!t&&e.alt?typeof e.alt=="string"?(e=this.stringToFieldJson_(e.alt))?this.fieldFromJson_(e):null:this.fieldFromJson_(e.alt):t}inputFromJson_(e,t){var r={LEFT:i.Align$$module$build$src$core$input.LEFT,RIGHT:i.Align$$module$build$src$core$input.RIGHT,CENTRE:i.Align$$module$build$src$core$input.CENTRE,CENTER:i.Align$$module$build$src$core$input.CENTRE};let a=null;switch(e.type){case"input_value":a=this.appendValueInput(e.name);break;case"input_statement":a=this.appendStatementInput(e.name);break;case"input_dummy":a=this.appendDummyInput(e.name)}return a?(e.check&&a.setCheck(e.check),e.align&&(r=r[e.align.toUpperCase()],r===void 0?console.warn(t+"Illegal align value: ",e.align):a.setAlign(r)),a):null}isInputKeyword_(e){return e==="input_value"||e==="input_statement"||e==="input_dummy"}stringToFieldJson_(e){return(e=e.trim())?{type:"field_label",text:e}:null}appendInput_(e,t){let r=null;return(e===lt.VALUE||e===lt.STATEMENT)&&(r=this.makeConnection_(e)),e===lt.STATEMENT&&this.statementInputCount++,e=new Yo(e,t,this,r),this.inputList.push(e),e}moveInputBefore(e,t){if(e!==t){var r=-1,a=t?-1:this.inputList.length;for(let d=0,C;C=this.inputList[d];d++)if(C.name===e){if(r=d,a!==-1)break}else if(t&&C.name===t&&(a=d,r!==-1))break;if(r===-1)throw Error('Named input "'+e+'" not found.');if(a===-1)throw Error('Reference input "'+t+'" not found.');this.moveNumberedInputBefore(r,a)}}moveNumberedInputBefore(e,t){if(e===t)throw Error("Can't move input to itself.");if(e>=this.inputList.length)throw RangeError("Input index "+e+" out of bounds.");if(t>this.inputList.length)throw RangeError("Reference input "+t+" out of bounds.");const r=this.inputList[e];this.inputList.splice(e,1),e<t&&t--,this.inputList.splice(t,0,r)}removeInput(e,t){for(let r=0,a;a=this.inputList[r];r++)if(a.name===e)return a.type===lt.STATEMENT&&this.statementInputCount--,a.dispose(),this.inputList.splice(r,1),true;if(t)return false;throw Error("Input not found: "+e)}getInput(e){for(let t=0,r;r=this.inputList[t];t++)if(r.name===e)return r;return null}getInputTargetBlock(e){return(e=this.getInput(e))&&e.connection&&e.connection.targetBlock()}getCommentText(){return this.commentModel.text}setCommentText(e){this.commentModel.text!==e&&(Pe(new(Re(bs))(this,"comment",null,this.commentModel.text,e)),this.comment=this.commentModel.text=e)}setWarningText(e,t){}setMutator(e){}getRelativeToSurfaceXY(){return this.xy_}moveBy(e,t){if(this.parentBlock_)throw Error("Block has parent.");const r=new(Re(js))(this);this.xy_.translate(e,t),r.recordNew(),Pe(r)}makeConnection_(e){return new Rt(this,e)}allInputsFilled(e){if(e===void 0&&(e=true),!e&&this.isShadow())return false;for(let r=0,a;a=this.inputList[r];r++)if(a.connection){var t=a.connection.targetBlock();if(!t||!t.allInputsFilled(e))return false}return(t=this.getNextBlock())?t.allInputsFilled(e):true}toDevString(){let e=this.type?'"'+this.type+'" block':"Block";return this.id&&(e+=' (id="'+this.id+'")'),e}};qo.COLLAPSED_INPUT_NAME=cl,qo.COLLAPSED_FIELD_NAME=ul;var _u=null,hl=null,dl={};dl.connectionUiEffect=cE,dl.disconnectUiEffect=hE,dl.disconnectUiStop=Pa,dl.disposeUiEffect=aE;var jv=class extends uu{constructor(e){super(e),this.cachedText="",this.paragraphElement_=this.textarea_=this.foreignObject=this.onInputWrapper=this.onChangeWrapper=this.onWheelWrapper=this.onMouseUpWrapper=null,this.model=e.commentModel;let t;this.model.text=(t=this.model.text)!=null?t:"",this.createIcon()}drawIcon_(e){H(ee.CIRCLE,{class:"blocklyIconShape",r:"8",cx:"8",cy:"8"},e),H(ee.PATH,{class:"blocklyIconSymbol",d:"m6.8,10h2c0.003,-0.617 0.271,-0.962 0.633,-1.266 2.875,-2.4050.607,-5.534 -3.765,-3.874v1.7c3.12,-1.657 3.698,0.118 2.336,1.25-1.201,0.998 -1.201,1.528 -1.204,2.19z"},e),H(ee.RECT,{class:"blocklyIconSymbol",x:"6.8",y:"10.78",height:"2",width:"2"},e)}createEditor(){this.foreignObject=H(ee.FOREIGNOBJECT,{x:rt.BORDER_WIDTH,y:rt.BORDER_WIDTH});const e=document.createElementNS(Zi,"body");e.setAttribute("xmlns",Zi),e.className="blocklyMinimalBody";const t=this.textarea_=document.createElementNS(Zi,"textarea");t.className="blocklyCommentTextarea",t.setAttribute("dir",this.getBlock().RTL?"RTL":"LTR");let r;return t.value=(r=this.model.text)!=null?r:"",this.resizeTextarea(),e.appendChild(t),this.foreignObject.appendChild(e),this.onMouseUpWrapper=S(t,"focus",this,this.startEdit,true),this.onWheelWrapper=S(t,"wheel",this,function(a){a.stopPropagation()}),this.onChangeWrapper=S(t,"change",this,function(a){this.cachedText!==this.model.text&&Pe(new(Re(bs))(this.getBlock(),"comment",null,this.cachedText,this.model.text))}),this.onInputWrapper=S(t,"input",this,function(a){this.model.text=t.value}),setTimeout(t.focus.bind(t),0),this.foreignObject}updateEditable(){super.updateEditable(),this.isVisible()&&(this.disposeBubble(),this.createBubble())}onBubbleResize(){this.isVisible()&&this.bubble_&&(this.model.size=this.bubble_.getBubbleSize(),this.resizeTextarea())}resizeTextarea(){if(this.textarea_&&this.foreignObject){var e=this.model.size,t=2*rt.BORDER_WIDTH,r=e.width-t;e=e.height-t,this.foreignObject.setAttribute("width",`${r}`),this.foreignObject.setAttribute("height",`${e}`),this.textarea_.style.width=r-4+"px",this.textarea_.style.height=e-4+"px"}}setVisible(e){e!==this.isVisible()&&(Pe(new(Re(Fn))(this.getBlock(),e,"comment")),(this.model.pinned=e)?this.createBubble():this.disposeBubble())}createBubble(){this.getBlock().isEditable()?this.createEditableBubble():this.createNonEditableBubble()}createEditableBubble(){const e=this.getBlock();this.bubble_=new rt(e.workspace,this.createEditor(),e.pathObject.svgPath,this.iconXY_,this.model.size.width,this.model.size.height),this.bubble_.setSvgId(e.id),this.bubble_.registerResizeEvent(this.onBubbleResize.bind(this)),this.applyColour()}createNonEditableBubble(){let e;this.paragraphElement_=rt.textToDom((e=this.model.text)!=null?e:""),this.bubble_=rt.createNonEditableBubble(this.paragraphElement_,this.getBlock(),this.iconXY_),this.applyColour()}disposeBubble(){this.onMouseUpWrapper&&(g(this.onMouseUpWrapper),this.onMouseUpWrapper=null),this.onWheelWrapper&&(g(this.onWheelWrapper),this.onWheelWrapper=null),this.onChangeWrapper&&(g(this.onChangeWrapper),this.onChangeWrapper=null),this.onInputWrapper&&(g(this.onInputWrapper),this.onInputWrapper=null),this.bubble_&&(this.bubble_.dispose(),this.bubble_=null),this.paragraphElement_=this.foreignObject=this.textarea_=null}startEdit(e){let t;(t=this.bubble_)!=null&&t.promote()&&this.textarea_.focus(),this.cachedText=this.model.text}getBubbleSize(){return this.model.size}setBubbleSize(e,t){this.bubble_?this.bubble_.setBubbleSize(e,t):(this.model.size.width=e,this.model.size.height=t)}updateText(){if(this.textarea_){let e;this.textarea_.value=(e=this.model.text)!=null?e:""}else this.paragraphElement_&&(this.paragraphElement_.firstChild.textContent=this.model.text)}dispose(){this.getBlock().comment=null,super.dispose()}};Ti(`
.blocklyCommentTextarea {
  background-color: #fef49c;
  border: 0;
  display: block;
  margin: 0;
  outline: 0;
  padding: 3px;
  resize: none;
  text-overflow: hidden;
}
`);var Wn=null,Zd={duplicateInternal:RO,copyInternal:yO},_l={};_l.TEST_ONLY=Zd,_l.copy=Ua,_l.duplicate=Ac,_l.paste=Zh;var pl,Qd,gl;pl=null,Qd={},gl=null,i.module$build$src$core$contextmenu={},i.module$build$src$core$contextmenu.callbackFactory=kO,i.module$build$src$core$contextmenu.commentDeleteOption=fE,i.module$build$src$core$contextmenu.commentDuplicateOption=mE,i.module$build$src$core$contextmenu.dispose=gE,i.module$build$src$core$contextmenu.getCurrentBlock=_E,i.module$build$src$core$contextmenu.hide=Nc,i.module$build$src$core$contextmenu.setCurrentBlock=pE,i.module$build$src$core$contextmenu.show=Lc,i.module$build$src$core$contextmenu.workspaceCommentOption=AO;var It=class{constructor(){this.registry_=new Map,this.reset()}reset(){this.registry_.clear()}register(e){if(this.registry_.has(e.id))throw Error('Menu item with ID "'+e.id+'" is already registered.');this.registry_.set(e.id,e)}unregister(e){if(!this.registry_.has(e))throw Error('Menu item with ID "'+e+'" not found.');this.registry_.delete(e)}getItem(e){let t;return(t=this.registry_.get(e))!=null?t:null}getContextMenuOptions(e,t){const r=[];for(const d of this.registry_.values())if(e===d.scopeType){var a=d.preconditionFn(t);a!=="hidden"&&(a={text:typeof d.displayText=="function"?d.displayText(t):d.displayText,enabled:a==="enabled",callback:d.callback,scope:t,weight:d.weight},r.push(a))}return r.sort(function(d,C){return d.weight-C.weight}),r}};(function(e){var t=e.ScopeType||(e.ScopeType={});t.BLOCK="block",t.WORKSPACE="workspace",e.registry=new e})(It||(It={})),It.ScopeType;var Xv=30,Kv=true,eo=[];eo[Le.INPUT_VALUE]=Le.OUTPUT_VALUE,eo[Le.OUTPUT_VALUE]=Le.INPUT_VALUE,eo[Le.NEXT_STATEMENT]=Le.PREVIOUS_STATEMENT,eo[Le.PREVIOUS_STATEMENT]=Le.NEXT_STATEMENT;var e_="RENAME_VARIABLE_ID",t_="DELETE_VARIABLE_ID",Yv=class{constructor(){this.drawer_=this.curNode_=this.colour=null,this.type="marker"}setDrawer(e){this.drawer_=e}getDrawer(){return this.drawer_}getCurNode(){return this.curNode_}setCurNode(e){const t=this.curNode_;this.curNode_=e,this.drawer_&&this.drawer_.draw(t,this.curNode_)}draw(){this.drawer_&&this.drawer_.draw(this.curNode_,this.curNode_)}hide(){this.drawer_&&this.drawer_.hide()}dispose(){this.getDrawer()&&this.getDrawer().dispose()}},s_=class extends Yv{constructor(){super(),this.type="cursor"}next(){var e=this.getCurNode();if(!e)return null;for(e=e.next();e&&e.next()&&(e.getType()===ge.types.NEXT||e.getType()===ge.types.BLOCK);)e=e.next();return e&&this.setCurNode(e),e}in(){var e=this.getCurNode();if(!e)return null;(e.getType()===ge.types.PREVIOUS||e.getType()===ge.types.OUTPUT)&&(e=e.next());let t,r;return(e=(r=(t=e)==null?void 0:t.in())!=null?r:null)&&this.setCurNode(e),e}prev(){var e=this.getCurNode();if(!e)return null;for(e=e.prev();e&&e.prev()&&(e.getType()===ge.types.NEXT||e.getType()===ge.types.BLOCK);)e=e.prev();return e&&this.setCurNode(e),e}out(){var e=this.getCurNode();return e?((e=e.out())&&e.getType()===ge.types.BLOCK&&(e=e.prev()||e),e&&this.setCurNode(e),e):null}};$e(Te.CURSOR,Un,s_);var fl=class extends s_{constructor(){super()}next(){var e=this.getCurNode();return e?((e=this.getNextNode_(e,this.validNode_))&&this.setCurNode(e),e):null}in(){return this.next()}prev(){var e=this.getCurNode();return e?((e=this.getPreviousNode_(e,this.validNode_))&&this.setCurNode(e),e):null}out(){return this.prev()}getNextNode_(e,t){if(!e)return null;const r=e.in()||e.next();return t(r)?r:r?this.getNextNode_(r,t):(e=this.findSiblingOrParent_(e.out()),t(e)?e:e?this.getNextNode_(e,t):null)}getPreviousNode_(e,t){if(!e)return null;let r=e.prev();return r=r?this.getRightMostChild_(r):e.out(),t(r)?r:r?this.getPreviousNode_(r,t):null}validNode_(e){let t=false;return e=e&&e.getType(),(e===ge.types.OUTPUT||e===ge.types.INPUT||e===ge.types.FIELD||e===ge.types.NEXT||e===ge.types.PREVIOUS||e===ge.types.WORKSPACE)&&(t=true),t}findSiblingOrParent_(e){if(!e)return null;const t=e.next();return t||this.findSiblingOrParent_(e.out())}getRightMostChild_(e){if(!e.in())return e;for(e=e.in();e&&e.next();)e=e.next();return this.getRightMostChild_(e)}};fl.registrationName="basicCursor",$e(Te.CURSOR,fl.registrationName,fl);var qv=class extends fl{validNode_(e){let t=false;const r=e&&e.getType();return e&&(e=e.getLocation(),r===ge.types.FIELD&&e&&e.isTabNavigable()&&e.isClickable()&&(t=true)),t}},i_=10,Xs=class extends Rt{constructor(e,t){super(e,t),this.targetConnection=this.highlightPath=null,this.db_=e.workspace.connectionDBList[t],this.dbOpposite_=e.workspace.connectionDBList[eo[t]],this.offsetInBlock_=new Oe(0,0),this.trackedState_=Xs.TrackedState.WILL_TRACK}dispose(){super.dispose(),this.trackedState_===Xs.TrackedState.TRACKED&&this.db_.removeConnection(this,this.y)}getSourceBlock(){return super.getSourceBlock()}targetBlock(){return super.targetBlock()}distanceFrom(e){const t=this.x-e.x;return e=this.y-e.y,Math.sqrt(t*t+e*e)}bumpAwayFrom(e){if(!this.sourceBlock_.workspace.isDragging()){var t=this.sourceBlock_.getRootBlock();if(!t.isInFlyout){var r=false;if(!t.isMovable()){if(t=e.getSourceBlock().getRootBlock(),!t.isMovable())return;e=this,r=true}var a=P()==t;a||t.addSelect();var d=e.x+i.config$$module$build$src$core$config.snapRadius+Math.floor(Math.random()*i_)-this.x,C=e.y+i.config$$module$build$src$core$config.snapRadius+Math.floor(Math.random()*i_)-this.y;r&&(C=-C),t.RTL&&(d=e.x-i.config$$module$build$src$core$config.snapRadius-Math.floor(Math.random()*i_)-this.x),t.moveBy(d,C),a||t.removeSelect()}}}moveTo(e,t){this.trackedState_===Xs.TrackedState.WILL_TRACK?(this.db_.addConnection(this,t),this.trackedState_=Xs.TrackedState.TRACKED):this.trackedState_===Xs.TrackedState.TRACKED&&(this.db_.removeConnection(this,this.y),this.db_.addConnection(this,t)),this.x=e,this.y=t}moveBy(e,t){this.moveTo(this.x+e,this.y+t)}moveToOffset(e){this.moveTo(e.x+this.offsetInBlock_.x,e.y+this.offsetInBlock_.y)}setOffsetInBlock(e,t){this.offsetInBlock_.x=e,this.offsetInBlock_.y=t}getOffsetInBlock(){return this.offsetInBlock_}tighten(){const e=this.targetConnection.x-this.x,t=this.targetConnection.y-this.y;if(e!==0||t!==0){const a=this.targetBlock();var r=a.getSvgRoot();if(!r)throw Error("block is not rendered.");r=Ji(r),a.getSvgRoot().setAttribute("transform","translate("+(r.x-e)+","+(r.y-t)+")"),a.moveConnections(-e,-t)}}closest(e,t){return this.dbOpposite_.searchForClosest(this,e,t)}highlight(){if(!this.highlightPath){var e=this.sourceBlock_.workspace.getRenderer().getConstants(),t=e.shapeFor(this);this.type===Le.INPUT_VALUE||this.type===Le.OUTPUT_VALUE?(e=e.TAB_OFFSET_FROM_TOP,t=Wt(0,-e)+Ne("v",e)+t.pathDown+Ne("v",e)):(e=e.NOTCH_OFFSET_LEFT-e.CORNER_RADIUS,t=Wt(-e,0)+Ne("h",e)+t.pathLeft+Ne("h",e)),e=this.sourceBlock_.getRelativeToSurfaceXY(),this.highlightPath=H(ee.PATH,{class:"blocklyHighlightedConnectionPath",d:t,transform:"translate("+(this.x-e.x)+","+(this.y-e.y)+")"+(this.sourceBlock_.RTL?" scale(-1 1)":"")},this.sourceBlock_.getSvgRoot())}}unhighlight(){this.highlightPath&&(B(this.highlightPath),this.highlightPath=null)}setTracking(e){e&&this.trackedState_===Xs.TrackedState.TRACKED||!e&&this.trackedState_===Xs.TrackedState.UNTRACKED||this.sourceBlock_.isInFlyout||(e?(this.db_.addConnection(this,this.y),this.trackedState_=Xs.TrackedState.TRACKED):(this.trackedState_===Xs.TrackedState.TRACKED&&this.db_.removeConnection(this,this.y),this.trackedState_=Xs.TrackedState.UNTRACKED))}stopTrackingAll(){if(this.setTracking(false),this.targetConnection){const r=this.targetBlock().getDescendants(false);for(let a=0;a<r.length;a++){var e=r[a],t=e.getConnections_(true);for(let d=0;d<t.length;d++)t[d].setTracking(false);for(e=e.getIcons(),t=0;t<e.length;t++)e[t].setVisible(false)}}}startTrackingAll(){this.setTracking(true);let e=[];if(this.type!==Le.INPUT_VALUE&&this.type!==Le.NEXT_STATEMENT)return e;const t=this.targetBlock();if(t){let r;t.isCollapsed()?(r=[],t.outputConnection&&r.push(t.outputConnection),t.nextConnection&&r.push(t.nextConnection),t.previousConnection&&r.push(t.previousConnection)):r=t.getConnections_(true);for(let a=0;a<r.length;a++)e.push(...r[a].startTrackingAll());e.length||(e=[t])}return e}onFailedConnect(e){const t=this.getSourceBlock();if(Ps()){const r=Ft();setTimeout(function(){t.isDisposed()||t.getParent()||(He(r),this.bumpAwayFrom(e),He(false))}.bind(this),i.config$$module$build$src$core$config.bumpDelay)}}disconnectInternal_(e,t){super.disconnectInternal_(e,t),e.rendered&&e.render(),t.rendered&&(t.updateDisabled(),t.render(),t.getSvgRoot().style.display="block")}respawnShadow_(){super.respawnShadow_();var e=this.targetBlock();e&&(e.initSvg(),e.render(false),e=this.getSourceBlock(),e.rendered&&e.render())}neighbours(e){return this.dbOpposite_.getNeighbours(this,e)}connect_(e){super.connect_(e);var t=this.getSourceBlock();e=e.getSourceBlock();const r=t.rendered,a=e.rendered;r&&t.updateDisabled(),a&&e.updateDisabled(),r&&a&&(this.type===Le.NEXT_STATEMENT||this.type===Le.PREVIOUS_STATEMENT?e.render():t.render()),(t=t.getInputWithBlock(e))&&(t=t.isVisible(),e.getSvgRoot().style.display=t?"block":"none")}onCheckChanged_(){!this.isConnected()||this.targetConnection&&this.getConnectionChecker().canConnect(this,this.targetConnection,false)||((this.isSuperior()?this.targetBlock():this.sourceBlock_).unplug(),this.sourceBlock_.bumpNeighbours())}};(function(e){e=e.TrackedState||(e.TrackedState={}),e[e.WILL_TRACK=-1]="WILL_TRACK",e[e.UNTRACKED=0]="UNTRACKED",e[e.TRACKED=1]="TRACKED"})(Xs||(Xs={})),Xs.TrackedState;var Jv=class extends uu{constructor(e){super(e),this.paragraphElement=null,this.collapseHidden=false,this.createIcon(),this.text=Object.create(null)}drawIcon_(e){H(ee.PATH,{class:"blocklyIconShape",d:"M2,15Q-1,15 0.5,12L6.5,1.7Q8,-1 9.5,1.7L15.5,12Q17,15 14,15z"},e),H(ee.PATH,{class:"blocklyIconSymbol",d:"m7,4.8v3.16l0.27,2.27h1.46l0.27,-2.27v-3.16z"},e),H(ee.RECT,{class:"blocklyIconSymbol",x:"7",y:"11",height:"2",width:"2"},e)}setVisible(e){e!==this.isVisible()&&(Pe(new(Re(Fn))(this.getBlock(),e,"warning")),e?this.createBubble():this.disposeBubble())}createBubble(){this.paragraphElement=rt.textToDom(this.getText()),this.bubble_=rt.createNonEditableBubble(this.paragraphElement,this.getBlock(),this.iconXY_),this.applyColour()}disposeBubble(){this.bubble_&&(this.bubble_.dispose(),this.bubble_=null),this.paragraphElement=null}setText(e,t){this.text[t]!==e&&(e?this.text[t]=e:delete this.text[t],this.isVisible()&&(this.setVisible(false),this.setVisible(true)))}getText(){const e=[];for(const t in this.text)e.push(this.text[t]);return e.join(`
`)}dispose(){this.getBlock().warning=null,super.dispose()}},Fi=class extends qo{constructor(e,t,r){super(e,t,r),this.renderingDebugger=null,this.width=this.height=0,this.warningTextDb=new Map,this.warning=this.commentIcon_=this.mutator=null,this.eventsInit_=this.renderIsInProgress_=this.rendered=false,this.workspace=e,this.decompose=this.decompose,this.compose=this.compose,this.saveConnections=this.saveConnections,this.customContextMenu=this.customContextMenu,this.svgGroup_=H(ee.G,{}),this.svgGroup_.translate_="",this.style=e.getRenderer().getConstants().getBlockStyle(null),this.pathObject=e.getRenderer().makePathObject(this.svgGroup_,this.style),this.useDragSurface_=!!e.getBlockDragSurface(),e=this.pathObject.svgPath,e.tooltip=this,Sc(e),this.svgGroup_.setAttribute("data-id",this.id),this.doInit_()}initSvg(){if(!this.workspace.rendered)throw TypeError("Workspace is headless.");for(let t=0,r;r=this.inputList[t];t++)r.init();var e=this.getIcons();for(let t=0;t<e.length;t++)e[t].createIcon();this.applyColour(),this.pathObject.updateMovable(this.isMovable()),e=this.getSvgRoot(),this.workspace.options.readOnly||this.eventsInit_||!e||S(e,"pointerdown",this,this.onMouseDown_),this.eventsInit_=true,e.parentNode||this.workspace.getCanvas().appendChild(e)}getColourSecondary(){return this.style.colourSecondary}getColourTertiary(){return this.style.colourTertiary}select(){if(this.isShadow()&&this.getParent())this.getParent().select();else if(P()!==this){var e=null;if(P()){e=P().id,Zt();try{P().unselect()}finally{ss()}}e=new(Re(dr))(e,this.id,this.workspace.id),Pe(e),F(this),this.addSelect()}}unselect(){if(P()===this){var e=new(Re(dr))(this.id,null,this.workspace.id);e.workspaceId=this.workspace.id,Pe(e),F(null),this.removeSelect()}}getIcons(){const e=[];return this.mutator&&e.push(this.mutator),this.commentIcon_&&e.push(this.commentIcon_),this.warning&&e.push(this.warning),e}setParent(e){const t=this.parentBlock_;if(e!==t){Me(),super.setParent(e),Se();var r=this.getSvgRoot();if(!this.workspace.isClearing&&r){var a=this.getRelativeToSurfaceXY();e?(e.getSvgRoot().appendChild(r),e=this.getRelativeToSurfaceXY(),this.moveConnections(e.x-a.x,e.y-a.y)):t&&(this.workspace.getCanvas().appendChild(r),this.translate(a.x,a.y)),this.applyColour()}}}getRelativeToSurfaceXY(){let e=0,t=0;const r=this.useDragSurface_?this.workspace.getBlockDragSurface().getGroup():null;let a=this.getSvgRoot();if(a)do{var d=Ji(a);e+=d.x,t+=d.y,this.useDragSurface_&&this.workspace.getBlockDragSurface().getCurrentBlock()===a&&(d=this.workspace.getBlockDragSurface().getSurfaceTranslation(),e+=d.x,t+=d.y),a=a.parentNode}while(a&&a!==this.workspace.getCanvas()&&a!==r);return new Oe(e,t)}moveBy(e,t){if(this.parentBlock_)throw Error("Block has parent.");const r=ls();let a=null;r&&(a=new(Re(js))(this));const d=this.getRelativeToSurfaceXY();this.translate(d.x+e,d.y+t),this.moveConnections(e,t),r&&a&&(a.recordNew(),Pe(a)),this.workspace.resizeContents()}translate(e,t){this.getSvgRoot().setAttribute("transform","translate("+e+","+t+")")}moveToDragSurface(){if(this.useDragSurface_){var e=this.getRelativeToSurfaceXY();this.clearTransformAttributes_(),this.workspace.getBlockDragSurface().translateSurface(e.x,e.y),(e=this.getSvgRoot())&&this.workspace.getBlockDragSurface().setBlocksAndShow(e)}}moveTo(e){const t=this.getRelativeToSurfaceXY();this.moveBy(e.x-t.x,e.y-t.y)}moveOffDragSurface(e){this.useDragSurface_&&(this.translate(e.x,e.y),this.workspace.getBlockDragSurface().clearAndHide(this.workspace.getCanvas()))}moveDuringDrag(e){this.useDragSurface_?this.workspace.getBlockDragSurface().translateSurface(e.x,e.y):(this.svgGroup_.translate_="translate("+e.x+","+e.y+")",this.svgGroup_.setAttribute("transform",this.svgGroup_.translate_+this.svgGroup_.skew_))}clearTransformAttributes_(){this.getSvgRoot().removeAttribute("transform")}snapToGrid(){if(!(this.isDeadOrDying()||this.workspace.isDragging()||this.getParent()||this.isInFlyout)){var e=this.workspace.getGrid();if(e&&e.shouldSnap()){var t=e.getSpacing(),r=t/2,a=this.getRelativeToSurfaceXY();e=Math.round(Math.round((a.x-r)/t)*t+r-a.x),t=Math.round(Math.round((a.y-r)/t)*t+r-a.y),(e||t)&&this.moveBy(e,t)}}}getBoundingRectangle(){const e=this.getRelativeToSurfaceXY(),t=this.getHeightWidth();let r,a;return this.RTL?(r=e.x-t.width,a=e.x):(r=e.x,a=e.x+t.width),new ts(e.y,e.y+t.height,r,a)}markDirty(){this.pathObject.constants=this.workspace.getRenderer().getConstants();for(let e=0,t;t=this.inputList[e];e++)t.markDirty()}setCollapsed(e){this.collapsed_!==e&&(super.setCollapsed(e),e?this.rendered&&this.render():this.updateCollapsed_())}updateCollapsed_(){var e=this.isCollapsed();const t=cl,r=ul;for(let d=0,C;C=this.inputList[d];d++)C.name!==t&&C.setVisible(!e);if(e){e=this.getIcons();for(let d=0,C;C=e[d];d++)C.setVisible(false);e=this.toString(Xv);var a=this.getField(r);a?a.setValue(e):(this.getInput(t)||this.appendDummyInput(t)).appendField(new i.FieldLabel$$module$build$src$core$field_label(e),r)}else this.updateDisabled(),this.removeInput(t)}tab(e,t){const r=new qv;r.setCurNode(ge.createFieldNode(e)),e=r.getCurNode(),t?r.next():r.prev(),(t=r.getCurNode())&&t!==e&&(t.getLocation().showEditor(),this.workspace.keyboardAccessibilityMode&&this.workspace.getCursor().setCurNode(t))}onMouseDown_(e){const t=this.workspace.getGesture(e);t&&t.handleBlockStart(e,this)}showHelp(){const e=typeof this.helpUrl=="function"?this.helpUrl():this.helpUrl;e&&window.open(e)}generateContextMenu(){if(this.workspace.options.readOnly||!this.contextMenu)return null;const e=It.registry.getContextMenuOptions(It.ScopeType.BLOCK,{block:this});return this.customContextMenu&&this.customContextMenu(e),e}showContextMenu(e){const t=this.generateContextMenu();t&&t.length&&(Lc(e,t,this.RTL),pE(this))}moveConnections(e,t){if(this.rendered){for(var r=this.getConnections_(false),a=0;a<r.length;a++)r[a].moveBy(e,t);for(r=this.getIcons(),a=0;a<r.length;a++)r[a].computeIconLocation();for(r=0;r<this.childBlocks_.length;r++)this.childBlocks_[r].moveConnections(e,t)}}setDragging(e){if(e){var t=this.getSvgRoot();t.translate_="",t.skew_="",Wr.push(...this.getConnections_(true)),ie(this.svgGroup_,"blocklyDragging")}else Wr.length=0,he(this.svgGroup_,"blocklyDragging");for(t=0;t<this.childBlocks_.length;t++)this.childBlocks_[t].setDragging(e)}setMovable(e){super.setMovable(e),this.pathObject.updateMovable(e)}setEditable(e){super.setEditable(e),e=this.getIcons();for(let t=0;t<e.length;t++)e[t].updateEditable()}setShadow(e){super.setShadow(e),this.applyColour()}setInsertionMarker(e){this.isInsertionMarker_!==e&&(this.isInsertionMarker_=e)&&(this.setColour(this.workspace.getRenderer().getConstants().INSERTION_MARKER_COLOUR),this.pathObject.updateInsertionMarker(true))}getSvgRoot(){return this.svgGroup_}dispose(e,t){if(!this.isDeadOrDying()){Vm(),$c(this.pathObject.svgPath),Me();var r=this.workspace;P()===this&&(this.unselect(),this.workspace.cancelCurrentGesture()),_E()===this&&Nc(),t&&this.rendered&&(this.unplug(e),aE(this)),this.rendered=false;for(var a of this.warningTextDb.values())clearTimeout(a);for(this.warningTextDb.clear(),t=this.getIcons(),a=0;a<t.length;a++)t[a].dispose();P()===this&&F(null),super.dispose(!!e),B(this.svgGroup_),r.resizeContents(),this.svgGroup_=null,Se()}}checkAndDelete(){this.workspace.isFlyout||(He(true),this.workspace.hideChaff(),this.outputConnection?this.dispose(false,true):this.dispose(true,true),He(false))}toCopyData(){return this.isInsertionMarker_?null:{saveInfo:xn(this,{addCoordinates:true,addNextBlocks:false}),source:this.workspace,typeCounts:j(this,true)}}applyColour(){this.pathObject.applyColour(this);const e=this.getIcons();for(let t=0;t<e.length;t++)e[t].applyColour();for(let t=0,r;r=this.inputList[t];t++)for(let a=0,d;d=r.fieldRow[a];a++)d.applyColour()}updateDisabled(){const e=this.getChildren(false);if(this.applyColour(),!this.isCollapsed())for(let t=0,r;r=e[t];t++)r.rendered&&r.updateDisabled()}getCommentIcon(){return this.commentIcon_}setCommentText(e){this.commentModel.text!==e&&(super.setCommentText(e),e=e!==null,!!this.commentIcon_===e?this.commentIcon_.updateText():(e?this.comment=this.commentIcon_=new jv(this):(this.commentIcon_.dispose(),this.comment=this.commentIcon_=null),this.rendered&&(this.render(),this.bumpNeighbours())))}setWarningText(e,t){const r=t||"";if(r)this.warningTextDb.has(r)&&(clearTimeout(this.warningTextDb.get(r)),this.warningTextDb.delete(r));else{for(var a of this.warningTextDb.values())clearTimeout(a);this.warningTextDb.clear()}if(this.workspace.isDragging())this.warningTextDb.set(r,setTimeout(()=>{this.isDeadOrDying()||(this.warningTextDb.delete(r),this.setWarningText(e,r))},100));else{if(this.isInFlyout&&(e=null),t=false,typeof e=="string"){a=this.getSurroundParent();let d=null;for(;a;)a.isCollapsed()&&(d=a),a=a.getSurroundParent();d&&d.setWarningText(Je.COLLAPSED_WARNINGS_WARNING,Fi.COLLAPSED_WARNING_ID),this.warning||(this.warning=new Jv(this),t=true),this.warning.setText(e,r)}else this.warning&&!r?(this.warning.dispose(),t=true):this.warning&&(t=this.warning.getText(),this.warning.setText("",r),(a=this.warning.getText())||this.warning.dispose(),t=t!==a);t&&this.rendered&&(this.render(),this.bumpNeighbours())}}setMutator(e){this.mutator&&this.mutator!==e&&this.mutator.dispose(),e&&(e.setBlock(this),this.mutator=e,e.createIcon()),this.rendered&&(this.render(),this.bumpNeighbours())}setEnabled(e){this.isEnabled()!==e&&(super.setEnabled(e),this.rendered&&!this.getInheritedDisabled()&&this.updateDisabled())}setHighlighted(e){this.rendered&&this.pathObject.updateHighlighted(e)}addSelect(){this.pathObject.updateSelected(true)}removeSelect(){this.pathObject.updateSelected(false)}setDeleteStyle(e){this.pathObject.updateDraggingDelete(e)}getColour(){return this.style.colourPrimary}setColour(e){super.setColour(e),e=this.workspace.getRenderer().getConstants().getBlockStyleForColour(this.colour_),this.pathObject.setStyle(e.style),this.style=e.style,this.styleName_=e.name,this.applyColour()}setStyle(e){const t=this.workspace.getRenderer().getConstants().getBlockStyle(e);if(this.styleName_=e,t)this.hat=t.hat,this.pathObject.setStyle(t),this.colour_=t.colourPrimary,this.style=t,this.applyColour();else throw Error("Invalid style name: "+e)}bringToFront(){let e=this;do{const t=e.getSvgRoot(),r=t.parentNode,a=r.childNodes;a[a.length-1]!==t&&r.appendChild(t),e=e.getParent()}while(e)}setPreviousStatement(e,t){super.setPreviousStatement(e,t),this.rendered&&(this.render(),this.bumpNeighbours())}setNextStatement(e,t){super.setNextStatement(e,t),this.rendered&&(this.render(),this.bumpNeighbours())}setOutput(e,t){super.setOutput(e,t),this.rendered&&(this.render(),this.bumpNeighbours())}setInputsInline(e){super.setInputsInline(e),this.rendered&&(this.render(),this.bumpNeighbours())}removeInput(e,t){return e=super.removeInput(e,t),this.rendered&&(this.render(),this.bumpNeighbours()),e}moveNumberedInputBefore(e,t){super.moveNumberedInputBefore(e,t),this.rendered&&(this.render(),this.bumpNeighbours())}appendInput_(e,t){return e=super.appendInput_(e,t),this.rendered&&(this.render(),this.bumpNeighbours()),e}setConnectionTracking(e){if(this.previousConnection&&this.previousConnection.setTracking(e),this.outputConnection&&this.outputConnection.setTracking(e),this.nextConnection){this.nextConnection.setTracking(e);var t=this.nextConnection.targetBlock();t&&t.setConnectionTracking(e)}if(!this.collapsed_)for(t=0;t<this.inputList.length;t++){var r=this.inputList[t].connection;r&&(r.setTracking(e),(r=r.targetBlock())&&r.setConnectionTracking(e))}}getConnections_(e){const t=[];if((e||this.rendered)&&(this.outputConnection&&t.push(this.outputConnection),this.previousConnection&&t.push(this.previousConnection),this.nextConnection&&t.push(this.nextConnection),e||!this.collapsed_))for(let r=0,a;a=this.inputList[r];r++)a.connection&&t.push(a.connection);return t}lastConnectionInStack(e){return super.lastConnectionInStack(e)}getMatchingConnection(e,t){return super.getMatchingConnection(e,t)}makeConnection_(e){return new Xs(this,e)}getNextBlock(){return super.getNextBlock()}getPreviousBlock(){return super.getPreviousBlock()}bumpNeighbours(){this.getRootBlock().bumpNeighboursInternal()}bumpNeighboursInternal(){const e=this.getRootBlock();if(!(this.isDeadOrDying()||this.workspace.isDragging()||e.isInFlyout))for(const t of this.getConnections_(false)){if(t.isSuperior()){let r;(r=t.targetBlock())==null||r.bumpNeighboursInternal()}for(const r of t.neighbours(i.config$$module$build$src$core$config.snapRadius))r.getSourceBlock().getRootBlock()!==e&&(t.isConnected()&&r.isConnected()||(t.isSuperior()?r.bumpAwayFrom(t):t.bumpAwayFrom(r)))}}scheduleSnapAndBump(){const e=Ft();setTimeout(()=>{He(e),this.snapToGrid(),He(false)},i.config$$module$build$src$core$config.bumpDelay/2),setTimeout(()=>{He(e),this.bumpNeighbours(),He(false)},i.config$$module$build$src$core$config.bumpDelay)}positionNearConnection(e,t){e.type!==Le.NEXT_STATEMENT&&e.type!==Le.INPUT_VALUE||this.moveBy(t.x-e.x,t.y-e.y)}getFirstStatementConnection(){return super.getFirstStatementConnection()}getChildren(e){return super.getChildren(e)}render(e){if(!this.renderIsInProgress_){this.renderIsInProgress_=true;try{if(this.rendered=true,Me(),this.isCollapsed()&&this.updateCollapsed_(),this.workspace.getRenderer().render(this),this.updateConnectionLocations_(),e!==false){const t=this.getParent();t?t.render(true):this.workspace.resizeContents()}Se(),this.updateMarkers_()}finally{this.renderIsInProgress_=false}}}updateMarkers_(){this.workspace.keyboardAccessibilityMode&&this.pathObject.cursorSvg&&this.workspace.getCursor().draw(),this.workspace.keyboardAccessibilityMode&&this.pathObject.markerSvg&&this.workspace.getMarker(Za.LOCAL_MARKER).draw()}updateConnectionLocations_(){const e=this.getRelativeToSurfaceXY();this.previousConnection&&this.previousConnection.moveToOffset(e),this.outputConnection&&this.outputConnection.moveToOffset(e);for(let t=0;t<this.inputList.length;t++){const r=this.inputList[t].connection;r&&(r.moveToOffset(e),r.isConnected()&&r.tighten())}this.nextConnection&&(this.nextConnection.moveToOffset(e),this.nextConnection.isConnected()&&this.nextConnection.tighten())}setCursorSvg(e){this.pathObject.setCursorSvg(e)}setMarkerSvg(e){this.pathObject.setMarkerSvg(e)}getHeightWidth(){let e=this.height,t=this.width;var r=this.getNextBlock();if(r){r=r.getHeightWidth();const a=this.workspace.getRenderer().getConstants().NOTCH_HEIGHT;e+=r.height-a,t=Math.max(t,r.width)}return{height:e,width:t}}fadeForReplacement(e){this.pathObject.updateReplacementFade(e)}highlightShapeForInput(e,t){this.pathObject.updateShapeForInputHighlight(e,t)}};Fi.INLINE=-1,Fi.COLLAPSED_WARNING_ID="TEMP_COLLAPSED_WARNING_";var Zv=class{constructor(){}onDragEnter(e){}onDragOver(e){}onDragExit(e){}onDrop(e){}getClientRect(){return null}shouldPreventMove(e){return false}},pu=class extends Zv{constructor(){super(),this.wouldDelete_=false}wouldDelete(e,t){return e instanceof Fi?(e=!e.getParent()&&e.isDeletable(),this.updateWouldDelete_(e&&!t)):this.updateWouldDelete_(e.isDeletable()),this.wouldDelete_}updateWouldDelete_(e){this.wouldDelete_=e}},zn;(function(e){e[e.TOP=0]="TOP",e[e.BOTTOM=1]="BOTTOM"})(zn||(zn={}));var Jo;(function(e){e[e.LEFT=0]="LEFT",e[e.RIGHT=1]="RIGHT"})(Jo||(Jo={}));var fr;(function(e){e[e.UP=0]="UP",e[e.DOWN=1]="DOWN"})(fr||(fr={}));var to={};to.bumpDirection=fr,to.bumpPositionRect=td,to.getCornerOppositeToolbox=ed,to.getStartPositionRect=Qh,to.horizontalPosition=Jo,to.verticalPosition=zn;var Ks={width:96,height:124,url:"sprites.png"},Qv=class extends pu{constructor(e){super(),this.workspace=e,this.id="trashcan",this.contents_=[],this.flyout=null,this.isLidOpen=false,this.minOpenness_=0,this.lidTask_=this.svgLid_=this.svgGroup_=null,this.top_=this.left_=this.lidOpen_=0,this.initialized_=false,0>=this.workspace.options.maxTrashcanContents||(e=new on({scrollbars:true,parentWorkspace:this.workspace,rtl:this.workspace.RTL,oneBasedIndex:this.workspace.options.oneBasedIndex,renderer:this.workspace.options.renderer,rendererOverrides:this.workspace.options.rendererOverrides,move:{scrollbars:true}}),this.workspace.horizontalLayout?(e.toolboxPosition=this.workspace.toolboxPosition===it.TOP?it.BOTTOM:it.TOP,this.flyout=new(si(Te.FLYOUTS_HORIZONTAL_TOOLBOX,this.workspace.options,true))(e)):(e.toolboxPosition=this.workspace.toolboxPosition===it.RIGHT?it.LEFT:it.RIGHT,this.flyout=new(si(Te.FLYOUTS_VERTICAL_TOOLBOX,this.workspace.options,true))(e)),this.workspace.addChangeListener(this.onDelete_.bind(this)))}createDom(){this.svgGroup_=H(ee.G,{class:"blocklyTrash"});let e;const t=String(Math.random()).substring(2);e=H(ee.CLIPPATH,{id:"blocklyTrashBodyClipPath"+t},this.svgGroup_),H(ee.RECT,{width:Zo,height:gu,y:Qo},e);const r=H(ee.IMAGE,{width:Ks.width,x:-n_,height:Ks.height,y:-r_,"clip-path":"url(#blocklyTrashBodyClipPath"+t+")"},this.svgGroup_);return r.setAttributeNS(ai,"xlink:href",this.workspace.options.pathToMedia+Ks.url),e=H(ee.CLIPPATH,{id:"blocklyTrashLidClipPath"+t},this.svgGroup_),H(ee.RECT,{width:Zo,height:Qo},e),this.svgLid_=H(ee.IMAGE,{width:Ks.width,x:-n_,height:Ks.height,y:-r_,"clip-path":"url(#blocklyTrashLidClipPath"+t+")"},this.svgGroup_),this.svgLid_.setAttributeNS(ai,"xlink:href",this.workspace.options.pathToMedia+Ks.url),y(this.svgGroup_,"pointerdown",this,this.blockMouseDownWhenOpenable_),y(this.svgGroup_,"pointerup",this,this.click),y(r,"pointerover",this,this.mouseOver_),y(r,"pointerout",this,this.mouseOut_),this.animateLid_(),this.svgGroup_}init(){0<this.workspace.options.maxTrashcanContents&&(te(this.flyout.createDom(ee.SVG),this.workspace.getParentSvg()),this.flyout.init(this.workspace)),this.workspace.getComponentManager().addComponent({component:this,weight:1,capabilities:[$s.Capability.AUTOHIDEABLE,$s.Capability.DELETE_AREA,$s.Capability.DRAG_TARGET,$s.Capability.POSITIONABLE]}),this.initialized_=true,this.setLidOpen(false)}dispose(){this.workspace.getComponentManager().removeComponent("trashcan"),this.svgGroup_&&(B(this.svgGroup_),this.svgGroup_=null),this.svgLid_=null,this.lidTask_&&clearTimeout(this.lidTask_)}hasContents_(){return!!this.contents_.length}contentsIsOpen(){return!!this.flyout&&this.flyout.isVisible()}openFlyout(){if(!this.contentsIsOpen()){var e=this.contents_.map(function(r){return JSON.parse(r)}),t=this.workspace.getParentSvg().style;t.cursor="wait",setTimeout(()=>{let r;(r=this.flyout)==null||r.show(e),t.cursor=""},10),this.fireUiEvent_(true)}}closeFlyout(){if(this.contentsIsOpen()){var e;(e=this.flyout)==null||e.hide(),this.fireUiEvent_(false),this.workspace.recordDragTargets()}}autoHide(e){!e&&this.flyout&&this.closeFlyout()}emptyContents(){this.hasContents_()&&(this.contents_.length=0,this.setMinOpenness_(0),this.closeFlyout())}position(e,t){if(this.initialized_){var r=ed(this.workspace,e);e=Qh(r,new Ss(Zo,gu+Qo),R0,eb,e,this.workspace),t=td(e,eb,r.vertical===zn.TOP?fr.DOWN:fr.UP,t),this.top_=t.top,this.left_=t.left;var a;(a=this.svgGroup_)==null||a.setAttribute("transform","translate("+this.left_+","+this.top_+")")}}getBoundingRectangle(){return new ts(this.top_,this.top_+gu+Qo,this.left_,this.left_+Zo)}getClientRect(){if(!this.svgGroup_)return null;var e=this.svgGroup_.getBoundingClientRect();const t=e.top+r_-fu;return e=e.left+n_-fu,new ts(t,t+Qo+gu+2*fu,e,e+Zo+2*fu)}onDragOver(e){this.setLidOpen(this.wouldDelete_)}onDragExit(e){this.setLidOpen(false)}onDrop(e){setTimeout(this.setLidOpen.bind(this,false),100)}setLidOpen(e){this.isLidOpen!==e&&(this.lidTask_&&clearTimeout(this.lidTask_),this.isLidOpen=e,this.animateLid_())}animateLid_(){const e=O0;var t=1/(e+1);this.lidOpen_+=this.isLidOpen?t:-t,this.lidOpen_=Math.min(Math.max(this.lidOpen_,this.minOpenness_),1),this.setLidAngle_(this.lidOpen_*sb),t=tb+this.lidOpen_*(w0-tb),this.svgGroup_&&(this.svgGroup_.style.opacity=t.toString()),this.lidOpen_>this.minOpenness_&&1>this.lidOpen_&&(this.lidTask_=setTimeout(this.animateLid_.bind(this),C0/e))}setLidAngle_(e){const t=this.workspace.toolboxPosition===it.RIGHT||this.workspace.horizontalLayout&&this.workspace.RTL;let r;(r=this.svgLid_)==null||r.setAttribute("transform","rotate("+(t?-e:e)+","+(t?4:Zo-4)+","+(Qo-2)+")")}setMinOpenness_(e){this.minOpenness_=e,this.isLidOpen||this.setLidAngle_(e*sb)}closeLid(){this.setLidOpen(false)}click(){this.hasContents_()&&this.openFlyout()}fireUiEvent_(e){e=new(Re(za))(e,this.workspace.id),Pe(e)}blockMouseDownWhenOpenable_(e){!this.contentsIsOpen()&&this.hasContents_()&&e.stopPropagation()}mouseOver_(){this.hasContents_()&&this.setLidOpen(true)}mouseOut_(){this.setLidOpen(false)}onDelete_(e){if(!(0>=this.workspace.options.maxTrashcanContents||e.type!==Sn||e.type!==Sn||e.wasShadow)){if(!e.oldJson)throw Error("Encountered a delete event without proper oldJson");if(e=JSON.stringify(this.cleanBlockJson_(e.oldJson)),this.contents_.indexOf(e)===-1){for(this.contents_.unshift(e);this.contents_.length>this.workspace.options.maxTrashcanContents;)this.contents_.pop();this.setMinOpenness_(I0)}}}cleanBlockJson_(e){function t(r){if(r){if(delete r.id,delete r.x,delete r.y,delete r.enabled,r.icons&&r.icons.comment){var a=r.icons.comment;delete a.height,delete a.width,delete a.pinned}a=r.inputs;for(var d in a){var C=a[d];const D=C.block;C=C.shadow,D&&t(D),C&&t(C)}r.next&&(d=r.next,r=d.block,d=d.shadow,r&&t(r),d&&t(d))}}return e=JSON.parse(JSON.stringify(e)),t(e),Object.assign({},{kind:"BLOCK"},e)}},Zo=47,gu=44,Qo=16,eb=20,R0=20,fu=10,n_=0,r_=32,I0=.1,C0=80,O0=4,tb=.4,w0=.8,sb=45,o_=class extends tn{constructor(e,t,r){super(r),this.type=ja,this.oldItem=e??void 0,this.newItem=t??void 0}toJson(){const e=super.toJson();return e.oldItem=this.oldItem,e.newItem=this.newItem,e}fromJson(e){o("Blockly.Events.ToolboxItemSelect.prototype.fromJson","version 9","version 10","Blockly.Events.fromJson"),super.fromJson(e),this.oldItem=e.oldItem,this.newItem=e.newItem}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new o_),t.oldItem=e.oldItem,t.newItem=e.newItem,t}};$e(Te.EVENT,ja,o_);var a_=class{constructor(e,t,r){this.id_=e.toolboxitemid||Dr(),this.level_=(this.parent_=r||null)?this.parent_.getLevel()+1:0,this.toolboxItemDef_=e,this.parentToolbox_=t,this.workspace_=this.parentToolbox_.getWorkspace()}init(){}getDiv(){return null}getClickTarget(){return null}getId(){return this.id_}getParent(){return null}getLevel(){return this.level_}isSelectable(){return false}isCollapsible(){return false}dispose(){}setVisible_(e){}},an=class extends a_{constructor(e,t,r){super(e,t,r),this.colour_=this.name_="",this.labelDom_=this.iconDom_=this.rowContents_=this.rowDiv_=this.htmlDiv_=null,this.isDisabled_=this.isHidden_=false,this.flyoutItems_=[],this.cssConfig_=this.makeDefaultCssConfig_()}init(){this.parseCategoryDef_(this.toolboxItemDef_),this.parseContents_(this.toolboxItemDef_),this.createDom_(),this.toolboxItemDef_.hidden==="true"&&this.hide()}makeDefaultCssConfig_(){return{container:"blocklyToolboxCategory",row:"blocklyTreeRow",rowcontentcontainer:"blocklyTreeRowContentContainer",icon:"blocklyTreeIcon",label:"blocklyTreeLabel",contents:"blocklyToolboxContents",selected:"blocklyTreeSelected",openicon:"blocklyTreeIconOpen",closedicon:"blocklyTreeIconClosed"}}parseContents_(e){if("custom"in e)this.flyoutItems_=e.custom;else if(e=e.contents)for(let t=0;t<e.length;t++){const r=e[t];Array.isArray(this.flyoutItems_)&&this.flyoutItems_.push(r)}}parseCategoryDef_(e){this.name_="name"in e?es(e.name):"",this.colour_=this.getColour_(e),Object.assign(this.cssConfig_,e.cssconfig||e.cssConfig)}createDom_(){this.htmlDiv_=this.createContainer_(),vn(this.htmlDiv_,ci.TREEITEM),Xt(this.htmlDiv_,Gt.SELECTED,false),Xt(this.htmlDiv_,Gt.LEVEL,this.level_),this.rowDiv_=this.createRowContainer_(),this.rowDiv_.style.pointerEvents="auto",this.htmlDiv_.appendChild(this.rowDiv_),this.rowContents_=this.createRowContentsContainer_(),this.rowContents_.style.pointerEvents="none",this.rowDiv_.appendChild(this.rowContents_),this.iconDom_=this.createIconDom_(),vn(this.iconDom_,ci.PRESENTATION),this.rowContents_.appendChild(this.iconDom_),this.labelDom_=this.createLabelDom_(this.name_),this.rowContents_.appendChild(this.labelDom_);const e=this.labelDom_.getAttribute("id");return e&&Xt(this.htmlDiv_,Gt.LABELLEDBY,e),this.addColourBorder_(this.colour_),this.htmlDiv_}createContainer_(){const e=document.createElement("div"),t=this.cssConfig_.container;return t&&ie(e,t),e}createRowContainer_(){const e=document.createElement("div");var t=this.cssConfig_.row;return t&&ie(e,t),t=`${an.nestedPadding*this.getLevel()}px`,this.workspace_.RTL?e.style.paddingRight=t:e.style.paddingLeft=t,e}createRowContentsContainer_(){const e=document.createElement("div"),t=this.cssConfig_.rowcontentcontainer;return t&&ie(e,t),e}createIconDom_(){const e=document.createElement("span");if(!this.parentToolbox_.isHorizontal()){const t=this.cssConfig_.icon;t&&ie(e,t)}return e.style.display="inline-block",e}createLabelDom_(e){const t=document.createElement("span");return t.setAttribute("id",this.getId()+".label"),t.textContent=e,(e=this.cssConfig_.label)&&ie(t,e),t}refreshTheme(){this.colour_=this.getColour_(this.toolboxItemDef_),this.addColourBorder_(this.colour_)}addColourBorder_(e){e&&(e=an.borderWidth+"px solid "+(e||"#ddd"),this.workspace_.RTL?this.rowDiv_.style.borderRight=e:this.rowDiv_.style.borderLeft=e)}getColour_(e){const t=e.categorystyle||e.categoryStyle;if((e=e.colour)&&t)console.warn('Toolbox category "'+this.name_+'" must not have both a style and a colour');else{if(t)return this.getColourfromStyle_(t);if(e)return this.parseColour_(e)}return""}getColourfromStyle_(e){var t=this.workspace_.getTheme();if(e&&t){if((t=t.categoryStyles[e])&&t.colour)return this.parseColour_(t.colour);console.warn('Style "'+e+'" must exist and contain a colour value')}return""}getClickTarget(){return this.rowDiv_}parseColour_(e){if(e=es(e),e==null||e==="")return"";var t=Number(e);return isNaN(t)?(t=Gr(e))?t:(console.warn('Toolbox category "'+this.name_+'" has unrecognized colour attribute: '+e),""):Ph(t)}openIcon_(e){if(e){var t=this.cssConfig_.closedicon;t&&Ie(e,t),(t=this.cssConfig_.openicon)&&ie(e,t)}}closeIcon_(e){if(e){var t=this.cssConfig_.openicon;t&&Ie(e,t),(t=this.cssConfig_.closedicon)&&ie(e,t)}}setVisible_(e){this.htmlDiv_.style.display=e?"block":"none",this.isHidden_=!e,this.parentToolbox_.getSelectedItem()===this&&this.parentToolbox_.clearSelection()}hide(){this.setVisible_(false)}show(){this.setVisible_(true)}isVisible(){return!this.isHidden_&&this.allAncestorsExpanded_()}allAncestorsExpanded_(){let e=this;for(;e.getParent();)if(e=e.getParent(),!e.isExpanded())return false;return true}isSelectable(){return this.isVisible()&&!this.isDisabled_}onClick(e){}setSelected(e){if(this.rowDiv_){var t=this.cssConfig_.selected;if(e){const r=this.parseColour_(an.defaultBackgroundColour);this.rowDiv_.style.backgroundColor=this.colour_||r,t&&ie(this.rowDiv_,t)}else this.rowDiv_.style.backgroundColor="",t&&he(this.rowDiv_,t);Xt(this.htmlDiv_,Gt.SELECTED,e)}}setDisabled(e){this.isDisabled_=e,this.getDiv().setAttribute("disabled",`${e}`),e?this.getDiv().setAttribute("disabled","true"):this.getDiv().removeAttribute("disabled")}getName(){return this.name_}getParent(){return this.parent_}getDiv(){return this.htmlDiv_}getContents(){return this.flyoutItems_}updateFlyoutContents(e){this.flyoutItems_=[],this.toolboxItemDef_=typeof e=="string"?{kind:this.toolboxItemDef_.kind,custom:e,id:this.toolboxItemDef_.id,categorystyle:this.toolboxItemDef_.categorystyle,colour:this.toolboxItemDef_.colour,cssconfig:this.toolboxItemDef_.cssconfig,hidden:this.toolboxItemDef_.hidden}:{kind:this.toolboxItemDef_.kind,name:"name"in this.toolboxItemDef_?this.toolboxItemDef_.name:"",contents:Cc(e),id:this.toolboxItemDef_.id,categorystyle:this.toolboxItemDef_.categorystyle,colour:this.toolboxItemDef_.colour,cssconfig:this.toolboxItemDef_.cssconfig,hidden:this.toolboxItemDef_.hidden},this.parseContents_(this.toolboxItemDef_)}dispose(){B(this.htmlDiv_)}};an.registrationName="category",an.nestedPadding=19,an.borderWidth=8,an.defaultBackgroundColour="#57e",Ti(`
.blocklyTreeRow:not(.blocklyTreeSelected):hover {
  background-color: rgba(255, 255, 255, .2);
}

.blocklyToolboxDiv[layout="h"] .blocklyToolboxCategory {
  margin: 1px 5px 1px 0;
}

.blocklyToolboxDiv[dir="RTL"][layout="h"] .blocklyToolboxCategory {
  margin: 1px 0 1px 5px;
}

.blocklyTreeRow {
  height: 22px;
  line-height: 22px;
  margin-bottom: 3px;
  padding-right: 8px;
  white-space: nowrap;
}

.blocklyToolboxDiv[dir="RTL"] .blocklyTreeRow {
  margin-left: 8px;
  padding-right: 0;
}

.blocklyTreeIcon {
  background-image: url(<<<PATH>>>/sprites.png);
  height: 16px;
  vertical-align: middle;
  visibility: hidden;
  width: 16px;
}

.blocklyTreeIconClosed {
  background-position: -32px -1px;
}

.blocklyToolboxDiv[dir="RTL"] .blocklyTreeIconClosed {
  background-position: 0 -1px;
}

.blocklyTreeSelected>.blocklyTreeIconClosed {
  background-position: -32px -17px;
}

.blocklyToolboxDiv[dir="RTL"] .blocklyTreeSelected>.blocklyTreeIconClosed {
  background-position: 0 -17px;
}

.blocklyTreeIconOpen {
  background-position: -16px -1px;
}

.blocklyTreeSelected>.blocklyTreeIconOpen {
  background-position: -16px -17px;
}

.blocklyTreeLabel {
  cursor: default;
  font: 16px sans-serif;
  padding: 0 3px;
  vertical-align: middle;
}

.blocklyToolboxDelete .blocklyTreeLabel {
  cursor: url("<<<PATH>>>/handdelete.cur"), auto;
}

.blocklyTreeSelected .blocklyTreeLabel {
  color: #fff;
}
`),$e(Te.TOOLBOX_ITEM,an.registrationName,an);var ml=class extends a_{constructor(e,t){super(e,t),this.cssConfig_={container:"blocklyTreeSeparator"},this.htmlDiv_=null,Object.assign(this.cssConfig_,e.cssconfig||e.cssConfig)}init(){this.createDom_()}createDom_(){const e=document.createElement("div"),t=this.cssConfig_.container;return t&&ie(e,t),this.htmlDiv_=e}getDiv(){return this.htmlDiv_}dispose(){B(this.htmlDiv_)}};ml.registrationName="sep",Ti(`
.blocklyTreeSeparator {
  border-bottom: solid #e5e5e5 1px;
  height: 0;
  margin: 5px 0;
}

.blocklyToolboxDiv[layout="h"] .blocklyTreeSeparator {
  border-right: solid #e5e5e5 1px;
  border-bottom: none;
  height: auto;
  margin: 0 5px 0 5px;
  padding: 5px 0;
  width: 0;
}
`),$e(Te.TOOLBOX_ITEM,ml.registrationName,ml);var ea=class extends an{constructor(e,t,r){super(e,t,r),this.subcategoriesDiv_=null,this.expanded_=false,this.toolboxItems_=[]}makeDefaultCssConfig_(){const e=super.makeDefaultCssConfig_();return e.contents="blocklyToolboxContents",e}parseContents_(e){const t=e.contents;let r=true;if(e.custom)this.flyoutItems_=e.custom;else if(t)for(e=0;e<t.length;e++){const a=t[e];!$o(Te.TOOLBOX_ITEM,a.kind)||a.kind.toLowerCase()===ml.registrationName&&r?(this.flyoutItems_.push(a),r=true):(this.createToolboxItem_(a),r=false)}}createToolboxItem_(e){let t=e.kind;t.toUpperCase()==="CATEGORY"&&zh(e)&&(t=ea.registrationName),e=new(pn(Te.TOOLBOX_ITEM,t))(e,this.parentToolbox_,this),this.toolboxItems_.push(e)}init(){super.init(),this.setExpanded(this.toolboxItemDef_.expanded==="true"||this.toolboxItemDef_.expanded)}createDom_(){super.createDom_();const e=this.getChildToolboxItems();return this.subcategoriesDiv_=this.createSubCategoriesDom_(e),vn(this.subcategoriesDiv_,ci.GROUP),this.htmlDiv_.appendChild(this.subcategoriesDiv_),this.htmlDiv_}createIconDom_(){const e=document.createElement("span");if(!this.parentToolbox_.isHorizontal()){const t=this.cssConfig_.icon;t&&ie(e,t),e.style.visibility="visible"}return e.style.display="inline-block",e}createSubCategoriesDom_(e){const t=document.createElement("div");var r=this.cssConfig_.contents;for(r&&ie(t,r),r=0;r<e.length;r++){const a=e[r];a.init();const d=a.getDiv();if(t.appendChild(d),a.getClickTarget){let C;(C=a.getClickTarget())==null||C.setAttribute("id",a.getId())}}return t}setExpanded(e){this.expanded_!==e&&((this.expanded_=e)?(this.subcategoriesDiv_.style.display="block",this.openIcon_(this.iconDom_)):(this.subcategoriesDiv_.style.display="none",this.closeIcon_(this.iconDom_)),Xt(this.htmlDiv_,Gt.EXPANDED,e),this.parentToolbox_.handleToolboxItemResize())}setVisible_(e){this.htmlDiv_.style.display=e?"block":"none";const t=this.getChildToolboxItems();for(let r=0;r<t.length;r++)t[r].setVisible_(e);this.isHidden_=!e,this.parentToolbox_.getSelectedItem()===this&&this.parentToolbox_.clearSelection()}isExpanded(){return this.expanded_}isCollapsible(){return true}onClick(e){this.toggleExpanded()}toggleExpanded(){this.setExpanded(!this.expanded_)}getDiv(){return this.htmlDiv_}getChildToolboxItems(){return this.toolboxItems_}};ea.registrationName="collapsibleCategory",$e(Te.TOOLBOX_ITEM,ea.registrationName,ea);var ib=class extends pu{constructor(e){super(),this.id="toolbox",this.contentsDiv_=this.HtmlDiv=null,this.isVisible_=false,this.contents_=[],this.height_=this.width_=0,this.previouslySelectedItem_=this.selectedItem_=this.flyout_=null,this.boundEvents_=[],this.workspace_=e,this.toolboxDef_=e.options.languageTree||{contents:[]},this.horizontalLayout_=e.options.horizontalLayout,this.RTL=e.options.RTL,this.contentMap_=Object.create(null),this.toolboxPosition=e.options.toolboxPosition}onShortcut(e){return false}init(){var e=this.workspace_;const t=e.getParentSvg();this.flyout_=this.createFlyout_(),this.HtmlDiv=this.createDom_(this.workspace_),te(this.flyout_.createDom("svg"),t),this.setVisible(true),this.flyout_.init(e),this.render(this.toolboxDef_),e=e.getThemeManager(),e.subscribe(this.HtmlDiv,"toolboxBackgroundColour","background-color"),e.subscribe(this.HtmlDiv,"toolboxForegroundColour","color"),this.workspace_.getComponentManager().addComponent({component:this,weight:1,capabilities:[$s.Capability.AUTOHIDEABLE,$s.Capability.DELETE_AREA,$s.Capability.DRAG_TARGET]})}createDom_(e){e=e.getParentSvg();const t=this.createContainer_();return this.contentsDiv_=this.createContentsContainer_(),this.contentsDiv_.tabIndex=0,vn(this.contentsDiv_,ci.TREE),t.appendChild(this.contentsDiv_),e.parentNode.insertBefore(t,e),this.attachEvents_(t,this.contentsDiv_),t}createContainer_(){const e=document.createElement("div");return e.setAttribute("layout",this.isHorizontal()?"h":"v"),ie(e,"blocklyToolboxDiv"),ie(e,"blocklyNonSelectable"),e.setAttribute("dir",this.RTL?"RTL":"LTR"),e}createContentsContainer_(){const e=document.createElement("div");return ie(e,"blocklyToolboxContents"),this.isHorizontal()&&(e.style.flexDirection="row"),e}attachEvents_(e,t){e=S(e,"pointerdown",this,this.onClick_,false),this.boundEvents_.push(e),t=S(t,"keydown",this,this.onKeyDown_,false),this.boundEvents_.push(t)}onClick_(e){if(v(e)||e.target===this.HtmlDiv)k().hideChaff(false);else{var t=e.target.getAttribute("id");t&&(t=this.getToolboxItemById(t),t.isSelectable()&&(this.setSelectedItem(t),t.onClick(e))),k().hideChaff(true)}m()}onKeyDown_(e){let t=false;switch(e.keyCode){case xe.DOWN:t=this.selectNext_();break;case xe.UP:t=this.selectPrevious_();break;case xe.LEFT:t=this.selectParent_();break;case xe.RIGHT:t=this.selectChild_();break;case xe.ENTER:case xe.SPACE:this.selectedItem_&&this.selectedItem_.isCollapsible()&&(this.selectedItem_.toggleExpanded(),t=true);break;default:t=false}if(!t&&this.selectedItem_){const r=this.selectedItem_;r.onKeyDown&&(t=r.onKeyDown(e))}t&&e.preventDefault()}createFlyout_(){const e=this.workspace_,t=new on({parentWorkspace:e,rtl:e.RTL,oneBasedIndex:e.options.oneBasedIndex,horizontalLayout:e.horizontalLayout,renderer:e.options.renderer,rendererOverrides:e.options.rendererOverrides,move:{scrollbars:true}});return t.toolboxPosition=e.options.toolboxPosition,new(e.horizontalLayout?si(Te.FLYOUTS_HORIZONTAL_TOOLBOX,e.options,true):si(Te.FLYOUTS_VERTICAL_TOOLBOX,e.options,true))(t)}render(e){this.toolboxDef_=e;for(let t=0;t<this.contents_.length;t++){const r=this.contents_[t];r&&r.dispose()}this.contents_=[],this.contentMap_=Object.create(null),this.renderContents_(e.contents),this.position(),this.handleToolboxItemResize()}renderContents_(e){const t=document.createDocumentFragment();for(let r=0;r<e.length;r++)this.createToolboxItem_(e[r],t);this.contentsDiv_.appendChild(t)}createToolboxItem_(e,t){var r=e.kind;r.toUpperCase()==="CATEGORY"&&zh(e)&&(r=ea.registrationName),(r=pn(Te.TOOLBOX_ITEM,r.toLowerCase()))&&(e=new r(e,this),e.init(),this.addToolboxItem_(e),(r=e.getDiv())&&t.appendChild(r),e.getClickTarget()&&e.getClickTarget().setAttribute("id",e.getId()))}addToolboxItem_(e){if(this.contents_.push(e),this.contentMap_[e.getId()]=e,e.isCollapsible()){e=e.getChildToolboxItems();for(let t=0;t<e.length;t++)this.addToolboxItem_(e[t])}}getToolboxItems(){return this.contents_}addStyle(e){e&&this.HtmlDiv&&ie(this.HtmlDiv,e)}removeStyle(e){e&&this.HtmlDiv&&he(this.HtmlDiv,e)}getClientRect(){if(!this.HtmlDiv||!this.isVisible_)return null;var e=this.HtmlDiv.getBoundingClientRect();const t=e.top,r=t+e.height,a=e.left;return e=a+e.width,this.toolboxPosition===it.TOP?new ts(-1e7,r,-1e7,1e7):this.toolboxPosition===it.BOTTOM?new ts(t,1e7,-1e7,1e7):this.toolboxPosition===it.LEFT?new ts(-1e7,1e7,-1e7,e):new ts(-1e7,1e7,a,1e7)}wouldDelete(e,t){return e instanceof Fi?this.updateWouldDelete_(!e.getParent()&&e.isDeletable()):this.updateWouldDelete_(e.isDeletable()),this.wouldDelete_}onDragEnter(e){this.updateCursorDeleteStyle_(true)}onDragExit(e){this.updateCursorDeleteStyle_(false)}onDrop(e){this.updateCursorDeleteStyle_(false)}updateWouldDelete_(e){e!==this.wouldDelete_&&(this.updateCursorDeleteStyle_(false),this.wouldDelete_=e,this.updateCursorDeleteStyle_(true))}updateCursorDeleteStyle_(e){const t=this.wouldDelete_?"blocklyToolboxDelete":"blocklyToolboxGrab";e?this.addStyle(t):this.removeStyle(t)}getToolboxItemById(e){return this.contentMap_[e]||null}getWidth(){return this.width_}getHeight(){return this.height_}getFlyout(){return this.flyout_}getWorkspace(){return this.workspace_}getSelectedItem(){return this.selectedItem_}getPreviouslySelectedItem(){return this.previouslySelectedItem_}isHorizontal(){return this.horizontalLayout_}position(){const e=this.workspace_.getMetrics(),t=this.HtmlDiv;t&&(this.horizontalLayout_?(t.style.left="0",t.style.height="auto",t.style.width="100%",this.height_=t.offsetHeight,this.width_=e.viewWidth,this.toolboxPosition===it.TOP?t.style.top="0":t.style.bottom="0"):(this.toolboxPosition===it.RIGHT?t.style.right="0":t.style.left="0",t.style.height="100%",this.width_=t.offsetWidth,this.height_=e.viewHeight),this.flyout_.position())}handleToolboxItemResize(){const e=this.workspace_,t=this.HtmlDiv.getBoundingClientRect();e.translate(this.toolboxPosition===it.LEFT?e.scrollX+t.width:e.scrollX,this.toolboxPosition===it.TOP?e.scrollY+t.height:e.scrollY),z(e)}clearSelection(){this.setSelectedItem(null)}refreshTheme(){for(let e=0;e<this.contents_.length;e++){const t=this.contents_[e];t.refreshTheme&&t.refreshTheme()}}refreshSelection(){this.selectedItem_&&this.selectedItem_.isSelectable()&&this.selectedItem_.getContents().length&&this.flyout_.show(this.selectedItem_.getContents())}setVisible(e){this.isVisible_!==e&&(this.HtmlDiv.style.display=e?"block":"none",this.isVisible_=e,this.workspace_.recordDragTargets())}autoHide(e){!e&&this.flyout_&&this.flyout_.autoClose&&this.clearSelection()}setSelectedItem(e){const t=this.selectedItem_;!e&&!t||e&&!e.isSelectable()||(this.shouldDeselectItem_(t,e)&&t!==null&&this.deselectItem_(t),this.shouldSelectItem_(t,e)&&e!==null&&this.selectItem_(t,e),this.updateFlyout_(t,e),this.fireSelectEvent_(t,e))}shouldDeselectItem_(e,t){return e!==null&&(!e.isCollapsible()||e!==t)}shouldSelectItem_(e,t){return t!==null&&t!==e}deselectItem_(e){this.selectedItem_=null,this.previouslySelectedItem_=e,e.setSelected(false),Xt(this.contentsDiv_,Gt.ACTIVEDESCENDANT,"")}selectItem_(e,t){this.selectedItem_=t,this.previouslySelectedItem_=e,t.setSelected(true),Xt(this.contentsDiv_,Gt.ACTIVEDESCENDANT,t.getId())}selectItemByPosition(e){-1<e&&e<this.contents_.length&&(e=this.contents_[e],e.isSelectable()&&this.setSelectedItem(e))}updateFlyout_(e,t){t&&(e!==t||t.isCollapsible())&&t.getContents().length?(this.flyout_.show(t.getContents()),this.flyout_.scrollToStart()):this.flyout_.hide()}fireSelectEvent_(e,t){const r=e&&e.getName();let a=t&&t.getName();e===t&&(a=null),e=new(Re(ja))(r,a,this.workspace_.id),Pe(e)}selectParent_(){return this.selectedItem_?this.selectedItem_.isCollapsible()&&this.selectedItem_.isExpanded()?(this.selectedItem_.toggleExpanded(),true):this.selectedItem_.getParent()&&this.selectedItem_.getParent().isSelectable()?(this.setSelectedItem(this.selectedItem_.getParent()),true):false:false}selectChild_(){if(!this.selectedItem_||!this.selectedItem_.isCollapsible())return false;const e=this.selectedItem_;return e.isExpanded()?this.selectNext_():e.toggleExpanded(),true}selectNext_(){if(!this.selectedItem_)return false;let e=this.contents_.indexOf(this.selectedItem_)+1;if(-1<e&&e<this.contents_.length){let t=this.contents_[e];for(;t&&!t.isSelectable();)t=this.contents_[++e];if(t&&t.isSelectable())return this.setSelectedItem(t),true}return false}selectPrevious_(){if(!this.selectedItem_)return false;let e=this.contents_.indexOf(this.selectedItem_)-1;if(-1<e&&e<this.contents_.length){let t=this.contents_[e];for(;t&&!t.isSelectable();)t=this.contents_[--e];if(t&&t.isSelectable())return this.setSelectedItem(t),true}return false}dispose(){this.workspace_.getComponentManager().removeComponent("toolbox"),this.flyout_.dispose();for(var e=0;e<this.contents_.length;e++)this.contents_[e].dispose();for(e=0;e<this.boundEvents_.length;e++)g(this.boundEvents_[e]);this.boundEvents_=[],this.contents_=[],this.workspace_.getThemeManager().unsubscribe(this.HtmlDiv),B(this.HtmlDiv)}};Ti(`
.blocklyToolboxDelete {
  cursor: url("<<<PATH>>>/handdelete.cur"), auto;
}

.blocklyToolboxGrab {
  cursor: url("<<<PATH>>>/handclosed.cur"), auto;
  cursor: grabbing;
  cursor: -webkit-grabbing;
}

/* Category tree in Toolbox. */
.blocklyToolboxDiv {
  background-color: #ddd;
  overflow-x: visible;
  overflow-y: auto;
  padding: 4px 0 4px 0;
  position: absolute;
  z-index: 70;  /* so blocks go under toolbox when dragging */
  -webkit-tap-highlight-color: transparent;  /* issue #1345 */
}

.blocklyToolboxContents {
  display: flex;
  flex-wrap: wrap;
  flex-direction: column;
}

.blocklyToolboxContents:focus {
  outline: none;
}
`),$e(Te.TOOLBOX,Un,ib);var k0={colour_blocks:{colourPrimary:"#CF63CF",colourSecondary:"#C94FC9",colourTertiary:"#BD42BD"},list_blocks:{colourPrimary:"#9966FF",colourSecondary:"#855CD6",colourTertiary:"#774DCB"},logic_blocks:{colourPrimary:"#4C97FF",colourSecondary:"#4280D7",colourTertiary:"#3373CC"},loop_blocks:{colourPrimary:"#0fBD8C",colourSecondary:"#0DA57A",colourTertiary:"#0B8E69"},math_blocks:{colourPrimary:"#59C059",colourSecondary:"#46B946",colourTertiary:"#389438"},procedure_blocks:{colourPrimary:"#FF6680",colourSecondary:"#FF4D6A",colourTertiary:"#FF3355"},text_blocks:{colourPrimary:"#FFBF00",colourSecondary:"#E6AC00",colourTertiary:"#CC9900"},variable_blocks:{colourPrimary:"#FF8C1A",colourSecondary:"#FF8000",colourTertiary:"#DB6E00"},variable_dynamic_blocks:{colourPrimary:"#FF8C1A",colourSecondary:"#FF8000",colourTertiary:"#DB6E00"},hat_blocks:{colourPrimary:"#4C97FF",colourSecondary:"#4280D7",colourTertiary:"#3373CC",hat:"cap"}},A0={colour_category:{colour:"#CF63CF"},list_category:{colour:"#9966FF"},logic_category:{colour:"#4C97FF"},loop_category:{colour:"#0fBD8C"},math_category:{colour:"#59C059"},procedure_category:{colour:"#FF6680"},text_category:{colour:"#FFBF00"},variable_category:{colour:"#FF8C1A"},variable_dynamic_category:{colour:"#FF8C1A"}},L0=new Qr("zelos",k0,A0),l_={};l_.Classic=hu,l_.Zelos=L0;var c_=class extends tn{constructor(e,t,r){t=e?e.workspace.id:t,t===null&&(t=void 0),super(t),this.type=_r,this.blockId=e?e.id:void 0,this.targetType=r}toJson(){const e=super.toJson();if(!this.targetType)throw Error("The click target type is undefined. Either pass a block to the constructor, or call fromJson");return e.targetType=this.targetType,e.blockId=this.blockId,e}fromJson(e){o("Blockly.Events.Click.prototype.fromJson","version 9","version 10","Blockly.Events.fromJson"),super.fromJson(e),this.targetType=e.targetType,this.blockId=e.blockId}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new c_),t.targetType=e.targetType,t.blockId=e.blockId,t}},u_;(function(e){e.BLOCK="block",e.WORKSPACE="workspace",e.ZOOM_CONTROLS="zoom_controls"})(u_||(u_={})),$e(Te.EVENT,_r,c_);var nb=class{constructor(e,t){this.bubble=e,this.workspace=t,this.dragTarget_=null,this.wouldDeleteBubble_=false,this.startXY_=this.bubble.getRelativeToSurfaceXY(),this.dragSurface_=t.getBlockDragSurface()}startBubbleDrag(){Ft()||He(true),this.workspace.setResizesEnabled(false),this.bubble.setAutoLayout(false),this.dragSurface_&&(this.bubble.moveTo(0,0),this.dragSurface_.translateSurface(this.startXY_.x,this.startXY_.y),this.dragSurface_.setBlocksAndShow(this.bubble.getSvgRoot())),this.bubble.setDragging&&this.bubble.setDragging(true)}dragBubble(e,t){t=this.pixelsToWorkspaceUnits_(t),t=Oe.sum(this.startXY_,t),this.bubble.moveDuringDrag(this.dragSurface_,t),t=this.dragTarget_,this.dragTarget_=this.workspace.getDragTarget(e),e=this.wouldDeleteBubble_,this.wouldDeleteBubble_=this.shouldDelete_(this.dragTarget_),e!==this.wouldDeleteBubble_&&this.updateCursorDuringBubbleDrag_(),this.dragTarget_!==t&&(t&&t.onDragExit(this.bubble),this.dragTarget_&&this.dragTarget_.onDragEnter(this.bubble)),this.dragTarget_&&this.dragTarget_.onDragOver(this.bubble)}shouldDelete_(e){return e&&this.workspace.getComponentManager().hasCapability(e.id,$s.Capability.DELETE_AREA)?e.wouldDelete(this.bubble,false):false}updateCursorDuringBubbleDrag_(){this.bubble.setDeleteStyle(this.wouldDeleteBubble_)}endBubbleDrag(e,t){this.dragBubble(e,t),this.dragTarget_&&this.dragTarget_.shouldPreventMove(this.bubble)?e=this.startXY_:(e=this.pixelsToWorkspaceUnits_(t),e=Oe.sum(this.startXY_,e)),this.bubble.moveTo(e.x,e.y),this.dragTarget_&&this.dragTarget_.onDrop(this.bubble),this.wouldDeleteBubble_?(this.fireMoveEvent_(),this.bubble.dispose()):(this.dragSurface_&&this.dragSurface_.clearAndHide(this.workspace.getBubbleCanvas()),this.bubble.setDragging&&this.bubble.setDragging(false),this.fireMoveEvent_()),this.workspace.setResizesEnabled(true),He(false)}fireMoveEvent_(){if(this.bubble instanceof Fs){const e=new(Re(Gn))(this.bubble);e.setOldCoordinate(this.startXY_),e.recordNew(),Pe(e)}}pixelsToWorkspaceUnits_(e){return e=new Oe(e.x/this.workspace.scale,e.y/this.workspace.scale),this.workspace.isMutator&&e.scale(1/this.workspace.options.parentWorkspace.scale),e}},rb=class{constructor(e){this.workspace=e,this.horizontalScrollEnabled_=this.workspace.isMovableHorizontally(),this.verticalScrollEnabled_=this.workspace.isMovableVertically(),this.startScrollXY_=new Oe(e.scrollX,e.scrollY)}dispose(){this.workspace=null}startDrag(){P()&&P().unselect(),this.workspace.setupDragSurface()}endDrag(e){this.drag(e),this.workspace.resetDragSurface()}drag(e){if(e=Oe.sum(this.startScrollXY_,e),this.horizontalScrollEnabled_&&this.verticalScrollEnabled_)this.workspace.scroll(e.x,e.y);else if(this.horizontalScrollEnabled_)this.workspace.scroll(e.x,this.workspace.scrollY);else if(this.verticalScrollEnabled_)this.workspace.scroll(this.workspace.scrollX,e.y);else throw new TypeError("Invalid state.")}},N0=5,M0=6,yn=class{constructor(e,t){this.creatorWorkspace=t,this.mouseDownXY_=new Oe(0,0),this.startWorkspace_=this.targetBlock_=this.startBlock_=this.startField_=this.startBubble_=null,this.hasExceededDragRadius_=false,this.flyout_=this.workspaceDragger_=this.blockDragger_=this.bubbleDragger_=this.onUpWrapper_=this.onMoveWrapper_=null,this.isMultiTouch_=this.isEnding_=this.hasStarted_=this.calledUpdateIsDragging_=false,this.cachedPoints=new Map,this.startDistance_=this.previousScale_=0,this.currentDropdownOwner=this.isPinchZoomEnabled_=this.onStartWrapper_=null,this.mostRecentEvent_=e,this.currentDragDeltaXY_=new Oe(0,0),this.healStack_=!Kv}dispose(){m(),zm(),this.creatorWorkspace.clearGesture(),this.onMoveWrapper_&&g(this.onMoveWrapper_),this.onUpWrapper_&&g(this.onUpWrapper_),this.blockDragger_&&this.blockDragger_.dispose(),this.workspaceDragger_&&this.workspaceDragger_.dispose(),this.onStartWrapper_&&g(this.onStartWrapper_)}updateFromEvent_(e){const t=new Oe(e.clientX,e.clientY);this.updateDragDelta_(t)&&(this.updateIsDragging_(),f()),this.mostRecentEvent_=e}updateDragDelta_(e){return this.currentDragDeltaXY_=Oe.difference(e,this.mouseDownXY_),this.hasExceededDragRadius_?false:this.hasExceededDragRadius_=Oe.magnitude(this.currentDragDeltaXY_)>(this.flyout_?i.config$$module$build$src$core$config.flyoutDragRadius:i.config$$module$build$src$core$config.dragRadius)}updateIsDraggingFromFlyout_(){let e;if(!this.targetBlock_||(e=this.flyout_)==null||!e.isBlockCreatable(this.targetBlock_))return false;if(!this.flyout_.targetWorkspace)throw Error(`Cannot update dragging from the flyout because the ' +
          'flyout's target workspace is undefined`);return!this.flyout_.isScrollable()||this.flyout_.isDragTowardWorkspace(this.currentDragDeltaXY_)?(this.startWorkspace_=this.flyout_.targetWorkspace,this.startWorkspace_.updateScreenCalculationsIfScrolled(),Ft()||He(true),this.startBlock_=null,this.targetBlock_=this.flyout_.createBlock(this.targetBlock_),this.targetBlock_.select(),true):false}updateIsDraggingBubble_(){return this.startBubble_?(this.startDraggingBubble_(),true):false}updateIsDraggingBlock_(){if(!this.targetBlock_)return false;if(this.flyout_){if(this.updateIsDraggingFromFlyout_())return this.startDraggingBlock_(),true}else if(this.targetBlock_.isMovable())return this.startDraggingBlock_(),true;return false}updateIsDraggingWorkspace_(){if(!this.startWorkspace_)throw Error("Cannot update dragging the workspace because the start workspace is undefined");(this.flyout_?this.flyout_.isScrollable():this.startWorkspace_&&this.startWorkspace_.isDraggable())&&(this.workspaceDragger_=new rb(this.startWorkspace_),this.workspaceDragger_.startDrag())}updateIsDragging_(){if(this.calledUpdateIsDragging_)throw Error("updateIsDragging_ should only be called once per gesture.");this.calledUpdateIsDragging_=true,this.updateIsDraggingBubble_()||this.updateIsDraggingBlock_()||this.updateIsDraggingWorkspace_()}startDraggingBlock_(){this.blockDragger_=new(si(Te.BLOCK_DRAGGER,this.creatorWorkspace.options,true))(this.targetBlock_,this.startWorkspace_),this.blockDragger_.startDrag(this.currentDragDeltaXY_,this.healStack_),this.blockDragger_.drag(this.mostRecentEvent_,this.currentDragDeltaXY_)}startDraggingBubble_(){if(!this.startBubble_)throw Error("Cannot update dragging the bubble because the start bubble is undefined");if(!this.startWorkspace_)throw Error("Cannot update dragging the bubble because the start workspace is undefined");this.bubbleDragger_=new nb(this.startBubble_,this.startWorkspace_),this.bubbleDragger_.startBubbleDrag(),this.bubbleDragger_.dragBubble(this.mostRecentEvent_,this.currentDragDeltaXY_)}doStart(e){if(!this.startWorkspace_)throw Error("Cannot start the touch gesture becauase the start workspace is undefined");this.isPinchZoomEnabled_=this.startWorkspace_.options.zoomOptions&&this.startWorkspace_.options.zoomOptions.pinch,E(e)?this.cancel():(this.hasStarted_=true,Pa(),this.startWorkspace_.updateScreenCalculationsIfScrolled(),this.startWorkspace_.isMutator&&this.startWorkspace_.resize(),this.currentDropdownOwner=Ot(),this.startWorkspace_.hideChaff(!!this.flyout_),this.startWorkspace_.markFocused(),this.mostRecentEvent_=e,Wm(),this.targetBlock_&&this.targetBlock_.select(),v(e)?this.handleRightClick(e):(e.type.toLowerCase()==="pointerdown"&&e.pointerType!=="mouse"&&l(e,this),this.mouseDownXY_=new Oe(e.clientX,e.clientY),this.healStack_=e.altKey||e.ctrlKey||e.metaKey,this.bindMouseEvents(e),this.isEnding_||this.handleTouchStart(e)))}bindMouseEvents(e){this.onStartWrapper_=S(document,"pointerdown",null,this.handleStart.bind(this),true),this.onMoveWrapper_=S(document,"pointermove",null,this.handleMove.bind(this),true),this.onUpWrapper_=S(document,"pointerup",null,this.handleUp.bind(this),true),e.preventDefault(),e.stopPropagation()}handleStart(e){this.isDragging()||(this.handleTouchStart(e),this.isMultiTouch()&&f())}handleMove(e){this.isDragging()&&u(e)||!this.isMultiTouch()?(this.updateFromEvent_(e),this.workspaceDragger_?this.workspaceDragger_.drag(this.currentDragDeltaXY_):this.blockDragger_?this.blockDragger_.drag(this.mostRecentEvent_,this.currentDragDeltaXY_):this.bubbleDragger_&&this.bubbleDragger_.dragBubble(this.mostRecentEvent_,this.currentDragDeltaXY_),e.preventDefault(),e.stopPropagation()):this.isMultiTouch()&&(this.handleTouchMove(e),f())}handleUp(e){if(this.isDragging()||this.handleTouchEnd(e),!this.isMultiTouch()||this.isDragging()){if(!u(e))return;if(this.updateFromEvent_(e),f(),this.isEnding_){console.log("Trying to end a gesture recursively.");return}this.isEnding_=true,this.bubbleDragger_?this.bubbleDragger_.endBubbleDrag(e,this.currentDragDeltaXY_):this.blockDragger_?this.blockDragger_.endDrag(e,this.currentDragDeltaXY_):this.workspaceDragger_?this.workspaceDragger_.endDrag(this.currentDragDeltaXY_):this.isBubbleClick_()?this.doBubbleClick_():this.isFieldClick_()?this.doFieldClick_():this.isBlockClick_()?this.doBlockClick_():this.isWorkspaceClick_()&&this.doWorkspaceClick_(e)}e.preventDefault(),e.stopPropagation(),this.dispose()}handleTouchStart(e){var t=_(e);this.cachedPoints.set(t,this.getTouchPoint(e));var r=Array.from(this.cachedPoints.keys());r.length===2&&(t=this.cachedPoints.get(r[0]),r=this.cachedPoints.get(r[1]),this.startDistance_=Oe.distance(t,r),this.isMultiTouch_=true,e.preventDefault())}handleTouchMove(e){const t=_(e);this.cachedPoints.set(t,this.getTouchPoint(e)),this.isPinchZoomEnabled_&&this.cachedPoints.size===2?this.handlePinch_(e):this.handleMove(e)}handlePinch_(e){var t=Array.from(this.cachedPoints.keys()),r=this.cachedPoints.get(t[0]);if(t=this.cachedPoints.get(t[1]),r=Oe.distance(r,t)/this.startDistance_,0<this.previousScale_&&1/0>this.previousScale_){if(t=r-this.previousScale_,t=0<t?t*N0:t*M0,!this.startWorkspace_)throw Error("Cannot handle a pinch because the start workspace is undefined");const a=this.startWorkspace_,d=b(e,a.getParentSvg(),a.getInverseScreenCTM());a.zoom(d.x,d.y,t)}this.previousScale_=r,e.preventDefault()}handleTouchEnd(e){e=_(e),this.cachedPoints.has(e)&&this.cachedPoints.delete(e),2>this.cachedPoints.size&&(this.cachedPoints.clear(),this.previousScale_=0)}getTouchPoint(e){return this.startWorkspace_?new Oe(e.pageX,e.pageY):null}isMultiTouch(){return this.isMultiTouch_}cancel(){this.isEnding_||(f(),this.bubbleDragger_?this.bubbleDragger_.endBubbleDrag(this.mostRecentEvent_,this.currentDragDeltaXY_):this.blockDragger_?this.blockDragger_.endDrag(this.mostRecentEvent_,this.currentDragDeltaXY_):this.workspaceDragger_&&this.workspaceDragger_.endDrag(this.currentDragDeltaXY_),this.dispose())}handleRightClick(e){this.targetBlock_?(this.bringBlockToFront_(),this.targetBlock_.workspace.hideChaff(!!this.flyout_),this.targetBlock_.showContextMenu(e)):this.startBubble_?this.startBubble_.showContextMenu(e):this.startWorkspace_&&!this.flyout_&&(this.startWorkspace_.hideChaff(),this.startWorkspace_.showContextMenu(e)),e.preventDefault(),e.stopPropagation(),this.dispose()}handleWsStart(e,t){if(this.hasStarted_)throw Error("Tried to call gesture.handleWsStart, but the gesture had already been started.");this.setStartWorkspace_(t),this.mostRecentEvent_=e,this.doStart(e)}fireWorkspaceClick_(e){Pe(new(Re(_r))(null,e.id,"workspace"))}handleFlyoutStart(e,t){if(this.hasStarted_)throw Error("Tried to call gesture.handleFlyoutStart, but the gesture had already been started.");this.setStartFlyout_(t),this.handleWsStart(e,t.getWorkspace())}handleBlockStart(e,t){if(this.hasStarted_)throw Error("Tried to call gesture.handleBlockStart, but the gesture had already been started.");this.setStartBlock(t),this.mostRecentEvent_=e}handleBubbleStart(e,t){if(this.hasStarted_)throw Error("Tried to call gesture.handleBubbleStart, but the gesture had already been started.");this.setStartBubble(t),this.mostRecentEvent_=e}doBubbleClick_(){this.startBubble_ instanceof Fs&&(this.startBubble_.setFocus(),this.startBubble_.select())}doFieldClick_(){if(!this.startField_)throw Error("Cannot do a field click because the start field is undefined");this.currentDropdownOwner!==this.startField_&&this.startField_.showEditor(this.mostRecentEvent_),this.bringBlockToFront_()}doBlockClick_(){if(this.flyout_&&this.flyout_.autoClose){if(!this.targetBlock_)throw Error("Cannot do a block click because the target block is undefined");this.targetBlock_.isEnabled()&&(Ft()||He(true),this.flyout_.createBlock(this.targetBlock_).scheduleSnapAndBump())}else{if(!this.startWorkspace_)throw Error("Cannot do a block click because the start workspace is undefined");const e=new(Re(_r))(this.startBlock_,this.startWorkspace_.id,"block");Pe(e)}this.bringBlockToFront_(),He(false)}doWorkspaceClick_(e){e=this.creatorWorkspace,P()&&P().unselect(),this.fireWorkspaceClick_(this.startWorkspace_||e)}bringBlockToFront_(){this.targetBlock_&&!this.flyout_&&this.targetBlock_.bringToFront()}setStartField(e){if(this.hasStarted_)throw Error("Tried to call gesture.setStartField, but the gesture had already been started.");this.startField_||(this.startField_=e)}setStartBubble(e){this.startBubble_||(this.startBubble_=e)}setStartBlock(e){this.startBlock_||this.startBubble_||(this.startBlock_=e,e.isInFlyout&&e!==e.getRootBlock()?this.setTargetBlock_(e.getRootBlock()):this.setTargetBlock_(e))}setTargetBlock_(e){e.isShadow()?this.setTargetBlock_(e.getParent()):this.targetBlock_=e}setStartWorkspace_(e){this.startWorkspace_||(this.startWorkspace_=e)}setStartFlyout_(e){this.flyout_||(this.flyout_=e)}isBubbleClick_(){return!!this.startBubble_&&!this.hasExceededDragRadius_}isBlockClick_(){return!!this.startBlock_&&!this.hasExceededDragRadius_&&!this.isFieldClick_()}isFieldClick_(){return(this.startField_?this.startField_.isClickable():false)&&!this.hasExceededDragRadius_&&(!this.flyout_||!this.flyout_.autoClose)}isWorkspaceClick_(){return!this.startBlock_&&!this.startBubble_&&!this.startField_&&!this.hasExceededDragRadius_}isDragging(){return!!this.workspaceDragger_||!!this.blockDragger_||!!this.bubbleDragger_}hasStarted(){return this.hasStarted_}getInsertionMarkers(){return this.blockDragger_?this.blockDragger_.getInsertionMarkers():[]}getCurrentDragger(){let e,t;return(t=(e=this.blockDragger_)!=null?e:this.workspaceDragger_)!=null?t:this.bubbleDragger_}static inProgress(){const e=w();for(let t=0,r;r=e[t];t++)if(r.currentGesture_)return true;return false}},wt=class{constructor(){this.shortcuts=new Map,this.keyMap=new Map,this.reset()}reset(){this.shortcuts.clear(),this.keyMap.clear()}register(e,t){if(this.shortcuts.get(e.name)&&!t)throw Error(`Shortcut named "${e.name}" already exists.`);if(this.shortcuts.set(e.name,e),(t=e.keyCodes)&&0<t.length)for(let r=0;r<t.length;r++)this.addKeyMapping(t[r],e.name,!!e.allowCollision)}unregister(e){return this.shortcuts.get(e)?(this.removeAllKeyMappings(e),this.shortcuts.delete(e),true):(console.warn(`Keyboard shortcut named "${e}" not found.`),false)}addKeyMapping(e,t,r){e=String(e);const a=this.keyMap.get(e);if(a&&!r)throw Error(`Shortcut named "${t}" collides with shortcuts "${a}"`);a&&r?a.unshift(t):this.keyMap.set(e,[t])}removeKeyMapping(e,t,r){const a=this.keyMap.get(e);if(!a)return r||console.warn(`No keyboard shortcut named "${t}" registered with key code "${e}"`),false;const d=a.indexOf(t);return-1<d?(a.splice(d,1),a.length===0&&this.keyMap.delete(e),true):(r||console.warn(`No keyboard shortcut named "${t}" registered with key code "${e}"`),false)}removeAllKeyMappings(e){for(const t of this.keyMap.keys())this.removeKeyMapping(t,e,true)}setKeyMap(e){this.keyMap.clear();for(const t in e)this.keyMap.set(t,e[t])}getKeyMap(){const e=Object.create(null);for(const[t,r]of this.keyMap)e[t]=r;return e}getRegistry(){const e=Object.create(null);for(const[t,r]of this.shortcuts)e[t]=r;return lr(Object.create(null),e)}onKeyDown(e,t){var r=this.serializeKeyEvent_(t);if(r=this.getShortcutNamesByKeyCode(r),!r)return false;for(let a=0,d;d=r[a];a++){const C=this.shortcuts.get(d);let D,Y;if((D=C)==null||!D.preconditionFn||(Y=C)!=null&&Y.preconditionFn(e)){let pe,we;if((pe=C)!=null&&pe.callback&&((we=C)!=null&&we.callback(e,t,C)))return true}}return false}getShortcutNamesByKeyCode(e){return this.keyMap.get(e)||[]}getKeyCodesByShortcutName(e){const t=[];for(const[r,a]of this.keyMap)-1<a.indexOf(e)&&t.push(r);return t}serializeKeyEvent_(e){let t="";for(const r in wt.modifierKeys)e.getModifierState(r)&&(t!==""&&(t+="+"),t+=r);return t!==""&&e.keyCode?t=t+"+"+e.keyCode:e.keyCode&&(t=e.keyCode.toString()),t}checkModifiers_(e){for(let t=0,r;r=e[t];t++)if(!(r in wt.modifierKeys))throw Error(r+" is not a valid modifier key.")}createSerializedKey(e,t){let r="";if(t){this.checkModifiers_(t);for(const a in wt.modifierKeys)-1<t.indexOf(wt.modifierKeys[a])&&(r!==""&&(r+="+"),r+=a)}return r!==""&&e?r=r+"+"+e:e&&(r=e.toString()),r}};wt.registry=new wt,function(e){e=e.modifierKeys||(e.modifierKeys={}),e[e.Shift=16]="Shift",e[e.Control=17]="Control",e[e.Alt=18]="Alt",e[e.Meta=91]="Meta"}(wt||(wt={}));var Rn;(function(e){e.ESCAPE="escape",e.DELETE="delete",e.COPY="copy",e.CUT="cut",e.PASTE="paste",e.UNDO="undo",e.REDO="redo"})(Rn||(Rn={})),RE();var In={};In.names=Rn,In.registerCopy=bE,In.registerCut=TE,In.registerDefaultShortcuts=RE,In.registerDelete=vE,In.registerEscape=EE,In.registerPaste=SE,In.registerRedo=yE,In.registerUndo=$E;var h_=class extends tn{constructor(e,t){super(t),this.type=Xa,this.themeName=e}toJson(){const e=super.toJson();if(!this.themeName)throw Error("The theme name is undefined. Either pass a theme name to the constructor, or call fromJson");return e.themeName=this.themeName,e}fromJson(e){o("Blockly.Events.ThemeChange.prototype.fromJson","version 9","version 10","Blockly.Events.fromJson"),super.fromJson(e),this.themeName=e.themeName}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new h_),t.themeName=e.themeName,t}};$e(Te.EVENT,Xa,h_);var d_=class extends tn{constructor(e,t,r,a,d){super(a),this.type=Kr,this.viewTop=e,this.viewLeft=t,this.scale=r,this.oldScale=d}toJson(){const e=super.toJson();if(this.viewTop===void 0)throw Error("The view top is undefined. Either pass a value to the constructor, or call fromJson");if(this.viewLeft===void 0)throw Error("The view left is undefined. Either pass a value to the constructor, or call fromJson");if(this.scale===void 0)throw Error("The scale is undefined. Either pass a value to the constructor, or call fromJson");if(this.oldScale===void 0)throw Error("The old scale is undefined. Either pass a value to the constructor, or call fromJson");return e.viewTop=this.viewTop,e.viewLeft=this.viewLeft,e.scale=this.scale,e.oldScale=this.oldScale,e}fromJson(e){o("Blockly.Events.Viewport.prototype.fromJson","version 9","version 10","Blockly.Events.fromJson"),super.fromJson(e),this.viewTop=e.viewTop,this.viewLeft=e.viewLeft,this.scale=e.scale,this.oldScale=e.oldScale}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new d_),t.viewTop=e.viewTop,t.viewLeft=e.viewLeft,t.scale=e.scale,t.oldScale=e.oldScale,t}};$e(Te.EVENT,Kr,d_);var ta=class{constructor(e){this.connectionChecker=e,this.connections_=[]}addConnection(e,t){t=this.calculateIndexForYPos_(t),this.connections_.splice(t,0,e)}findIndexOfConnection_(e,t){if(!this.connections_.length)return-1;const r=this.calculateIndexForYPos_(t);if(r>=this.connections_.length)return-1;t=e.y;let a=r;for(;0<=a&&this.connections_[a].y===t;){if(this.connections_[a]===e)return a;a--}for(a=r;a<this.connections_.length&&this.connections_[a].y===t;){if(this.connections_[a]===e)return a;a++}return-1}calculateIndexForYPos_(e){if(!this.connections_.length)return 0;let t=0,r=this.connections_.length;for(;t<r;){const a=Math.floor((t+r)/2);if(this.connections_[a].y<e)t=a+1;else if(this.connections_[a].y>e)r=a;else{t=a;break}}return t}removeConnection(e,t){if(e=this.findIndexOfConnection_(e,t),e===-1)throw Error("Unable to find connection in connectionDB.");this.connections_.splice(e,1)}getNeighbours(e,t){function r(we){const Et=d-a[we].x,zt=C-a[we].y;return Math.sqrt(Et*Et+zt*zt)<=t&&pe.push(a[we]),zt<t}const a=this.connections_,d=e.x,C=e.y;e=0;let D=a.length-2,Y=D;for(;e<Y;)a[Y].y<C?e=Y:D=Y,Y=Math.floor((e+D)/2);const pe=[];if(D=e=Y,a.length){for(;0<=e&&r(e);)e--;do D++;while(D<a.length&&r(D))}return pe}isInYRange_(e,t,r){return Math.abs(this.connections_[e].y-t)<=r}searchForClosest(e,t,r){if(!this.connections_.length)return{connection:null,radius:t};const a=e.y,d=e.x;e.x=d+r.x,e.y=a+r.y;var C=this.calculateIndexForYPos_(e.y);r=null;let D=t,Y,pe=C-1;for(;0<=pe&&this.isInYRange_(pe,e.y,t);)Y=this.connections_[pe],this.connectionChecker.canConnect(e,Y,true,D)&&(r=Y,D=Y.distanceFrom(e)),pe--;for(;C<this.connections_.length&&this.isInYRange_(C,e.y,t);)Y=this.connections_[C],this.connectionChecker.canConnect(e,Y,true,D)&&(r=Y,D=Y.distanceFrom(e)),C++;return e.x=d,e.y=a,{connection:r,radius:D}}static init(e){const t=[];return t[Le.INPUT_VALUE]=new ta(e),t[Le.OUTPUT_VALUE]=new ta(e),t[Le.NEXT_STATEMENT]=new ta(e),t[Le.PREVIOUS_STATEMENT]=new ta(e),t}},__=class{constructor(e,t){this.pattern=e;let r;this.spacing=(r=t.spacing)!=null?r:0;let a;this.length=(a=t.length)!=null?a:1,this.line2=(this.line1=e.firstChild)&&this.line1.nextSibling;let d;this.snapToGrid=(d=t.snap)!=null?d:false}shouldSnap(){return this.snapToGrid}getSpacing(){return this.spacing}getPatternId(){return this.pattern.id}update(e){var t=this.spacing*e||100;this.pattern.setAttribute("width",t.toString()),this.pattern.setAttribute("height",t.toString()),t=Math.floor(this.spacing/2)+.5;let r=t-this.length/2,a=t+this.length/2;t*=e,r*=e,a*=e,this.setLineAttributes(this.line1,e,r,a,t,t),this.setLineAttributes(this.line2,e,t,t,r,a)}setLineAttributes(e,t,r,a,d,C){e&&(e.setAttribute("stroke-width",t.toString()),e.setAttribute("x1",r.toString()),e.setAttribute("y1",d.toString()),e.setAttribute("x2",a.toString()),e.setAttribute("y2",C.toString()))}moveTo(e,t){this.pattern.setAttribute("x",e.toString()),this.pattern.setAttribute("y",t.toString())}static createDom(e,t,r){e=H(ee.PATTERN,{id:"blocklyGridPattern"+e,patternUnits:"userSpaceOnUse"},r);let a,d;if(0<((a=t.length)!=null?a:1)&&0<((d=t.spacing)!=null?d:0)){H(ee.LINE,{stroke:t.colour},e);let C;(C=t.length)!=null&&C&&H(ee.LINE,{stroke:t.colour},e)}else H(ee.LINE,{},e);return e}},Gi=class{constructor(e,t){this.db=new Map,this.dbReverse=new Set,this.variableMap_=null,this.variablePrefix_=t||"",this.reservedWords=new Set(e?e.split(","):[])}reset(){this.db.clear(),this.dbReverse.clear(),this.variableMap_=null}setVariableMap(e){this.variableMap_=e}getNameForUserVariable_(e){return this.variableMap_?(e=this.variableMap_.getVariableById(e))?e.name:null:(console.warn(`Deprecated call to Names.prototype.getName without defining a variable map. To fix, add the following code in your generator's init() function:
Blockly.YourGeneratorName.nameDB_.setVariableMap(workspace.getVariableMap());`),null)}populateVariables(e){e=ii(e);for(let t=0;t<e.length;t++)this.getName(e[t].getId(),i.NameType$$module$build$src$core$names.VARIABLE)}populateProcedures(e){throw Error("The implementation of populateProcedures should be monkey-patched in by blockly.ts")}getName(e,t){let r=e;t===i.NameType$$module$build$src$core$names.VARIABLE&&(e=this.getNameForUserVariable_(e))&&(r=e),e=r.toLowerCase();const a=t===i.NameType$$module$build$src$core$names.VARIABLE||t===i.NameType$$module$build$src$core$names.DEVELOPER_VARIABLE?this.variablePrefix_:"";this.db.has(t)||this.db.set(t,new Map);const d=this.db.get(t);return d.has(e)?a+d.get(e):(t=this.getDistinctName(r,t),d.set(e,t.substr(a.length)),t)}getUserNames(e){let t;return(e=(t=this.db.get(e))==null?void 0:t.keys())?Array.from(e):[]}getDistinctName(e,t){e=this.safeName_(e);let r="";for(;this.dbReverse.has(e+r)||this.reservedWords.has(e+r);)r=r?r+1:2;return e+=r,this.dbReverse.add(e),(t===i.NameType$$module$build$src$core$names.VARIABLE||t===i.NameType$$module$build$src$core$names.DEVELOPER_VARIABLE?this.variablePrefix_:"")+e}safeName_(e){return e?(e=encodeURI(e.replace(/ /g,"_")).replace(/[^\w]/g,"_"),"0123456789".indexOf(e[0])!==-1&&(e="my_"+e)):e=Je.UNNAMED_KEY||"unnamed",e}static equals(e,t){return e.toLowerCase()===t.toLowerCase()}};(function(e){e=e.NameType||(e.NameType={}),e.DEVELOPER_VARIABLE="DEVELOPER_VARIABLE",e.VARIABLE="VARIABLE",e.PROCEDURE="PROCEDURE"})(Gi||(Gi={})),i.NameType$$module$build$src$core$names=Gi.NameType,Gi.DEVELOPER_VARIABLE_TYPE=i.NameType$$module$build$src$core$names.DEVELOPER_VARIABLE,i.module$build$src$core$names={},i.module$build$src$core$names.NameType=i.NameType$$module$build$src$core$names,i.module$build$src$core$names.Names=Gi;var ob=class extends Map{constructor(e){super(),this.workspace=e}set(e,t){return this.get(e)===t?this:(super.set(e,t),Pe(new(Re(Kc))(this.workspace,t)),Ao(t)&&t.startPublishing(),this)}delete(e){const t=this.get(e);return e=super.delete(e),e&&(cr(this.workspace),Pe(new(Re(Ya))(this.workspace,t)),Ao(t)&&t.stopPublishing(),e)}clear(){if(this.size){for(const e of this.keys()){const t=this.get(e);super.delete(e),Pe(new(Re(Ya))(this.workspace,t))}cr(this.workspace)}}add(e){return this.set(e.getId(),e)}getProcedures(){return[...this.values()]}},El=class{constructor(e,t,r){this.workspace=e,this.parameters=[],this.returnTypes=null,this.enabled=true,this.shouldFireEvents=false,this.id=r??mi(),this.name=t}setName(e){if(e===this.name)return this;const t=this.name;return this.name=e,cr(this.workspace),this.shouldFireEvents&&Pe(new(Re(Yc))(this.workspace,this,t)),this}insertParameter(e,t){return this.parameters[t]&&this.parameters[t].getId()===e.getId()?this:(this.parameters.splice(t,0,e),e.setProcedureModel(this),Ao(e)&&(this.shouldFireEvents?e.startPublishing():e.stopPublishing()),cr(this.workspace),this.shouldFireEvents&&Pe(new(Re(Zc))(this.workspace,this,e,t)),this)}deleteParameter(e){if(!this.parameters[e])return this;const t=this.parameters[e];return this.parameters.splice(e,1),cr(this.workspace),Ao(t)&&t.stopPublishing(),this.shouldFireEvents&&Pe(new(Re(Qc))(this.workspace,this,t,e)),this}setReturnTypes(e){if(e&&e.length)throw Error("The built-in ProcedureModel does not support typing. You need to implement your own custom ProcedureModel.");if(!!e==!!this.returnTypes)return this;const t=this.returnTypes;return this.returnTypes=e,cr(this.workspace),this.shouldFireEvents&&Pe(new(Re(Jc))(this.workspace,this,t)),this}setEnabled(e){return e===this.enabled?this:(this.enabled=e,cr(this.workspace),this.shouldFireEvents&&Pe(new(Re(qc))(this.workspace,this)),this)}getId(){return this.id}getName(){return this.name}getParameter(e){return this.parameters[e]}getParameters(){return[...this.parameters]}getReturnTypes(){return this.returnTypes}getEnabled(){return this.enabled}startPublishing(){this.shouldFireEvents=true;for(const e of this.parameters)Ao(e)&&e.startPublishing()}stopPublishing(){this.shouldFireEvents=false;for(const e of this.parameters)Ao(e)&&e.stopPublishing()}},sa=class{constructor(e,t,r){this.workspace=e,this.shouldFireEvents=false,this.procedureModel=null,this.id=r??mi();let a;this.variable=(a=this.workspace.getVariable(t))!=null?a:e.createVariable(t)}setName(e){if(e===this.variable.name)return this;const t=this.variable.name;let r;return this.variable=(r=this.workspace.getVariable(e))!=null?r:this.workspace.createVariable(e),cr(this.workspace),this.shouldFireEvents&&Pe(new(Re(eu))(this.workspace,this.procedureModel,this,t)),this}setTypes(e){throw Error("The built-in ParameterModel does not support typing. You need to implement your own custom ParameterModel.")}getName(){return this.variable.name}getTypes(){return[]}getId(){return this.id}getVariableModel(){return this.variable}startPublishing(){this.shouldFireEvents=true}stopPublishing(){this.shouldFireEvents=false}setProcedureModel(e){return this.procedureModel=e,this}},mu,p_;mu="PROCEDURE",p_="x",i.module$build$src$core$procedures={},i.module$build$src$core$procedures.CATEGORY_NAME=mu,i.module$build$src$core$procedures.DEFAULT_ARG=p_,i.module$build$src$core$procedures.ObservableParameterModel=sa,i.module$build$src$core$procedures.ObservableProcedureMap=ob,i.module$build$src$core$procedures.ObservableProcedureModel=El,i.module$build$src$core$procedures.allProcedures=sd,i.module$build$src$core$procedures.findLegalName=CE,i.module$build$src$core$procedures.flyoutCategory=id,i.module$build$src$core$procedures.getCallers=AE,i.module$build$src$core$procedures.getDefinition=BO,i.module$build$src$core$procedures.isNameUsed=OE,i.module$build$src$core$procedures.mutateCallers=xO,i.module$build$src$core$procedures.mutatorOpenListener=kE,i.module$build$src$core$procedures.rename=MO;var D0=class{constructor(){this.NONE=0,this.FIELD=1,this.HAT=2,this.ICON=4,this.SPACER=8,this.BETWEEN_ROW_SPACER=16,this.IN_ROW_SPACER=32,this.EXTERNAL_VALUE_INPUT=64,this.INPUT=128,this.INLINE_INPUT=256,this.STATEMENT_INPUT=512,this.CONNECTION=1024,this.PREVIOUS_CONNECTION=2048,this.NEXT_CONNECTION=4096,this.OUTPUT_CONNECTION=8192,this.CORNER=16384,this.LEFT_SQUARE_CORNER=32768,this.LEFT_ROUND_CORNER=65536,this.RIGHT_SQUARE_CORNER=131072,this.RIGHT_ROUND_CORNER=262144,this.JAGGED_EDGE=524288,this.ROW=1048576,this.TOP_ROW=2097152,this.BOTTOM_ROW=4194304,this.INPUT_ROW=8388608,this.LEFT_CORNER=this.LEFT_SQUARE_CORNER|this.LEFT_ROUND_CORNER,this.RIGHT_CORNER=this.RIGHT_SQUARE_CORNER|this.RIGHT_ROUND_CORNER,this.nextTypeValue_=16777216}getType(e){return Object.prototype.hasOwnProperty.call(this,e)||(this[e]=this.nextTypeValue_,this.nextTypeValue_<<=1),this[e]}isField(e){return e.type&this.FIELD}isHat(e){return e.type&this.HAT}isIcon(e){return e.type&this.ICON}isSpacer(e){return e.type&this.SPACER}isInRowSpacer(e){return e.type&this.IN_ROW_SPACER}isInput(e){return e.type&this.INPUT}isExternalInput(e){return e.type&this.EXTERNAL_VALUE_INPUT}isInlineInput(e){return e.type&this.INLINE_INPUT}isStatementInput(e){return e.type&this.STATEMENT_INPUT}isPreviousConnection(e){return e.type&this.PREVIOUS_CONNECTION}isNextConnection(e){return e.type&this.NEXT_CONNECTION}isPreviousOrNextConnection(e){return e.type&(this.PREVIOUS_CONNECTION|this.NEXT_CONNECTION)}isLeftRoundedCorner(e){return e.type&this.LEFT_ROUND_CORNER}isRightRoundedCorner(e){return e.type&this.RIGHT_ROUND_CORNER}isLeftSquareCorner(e){return e.type&this.LEFT_SQUARE_CORNER}isRightSquareCorner(e){return e.type&this.RIGHT_SQUARE_CORNER}isCorner(e){return e.type&this.CORNER}isJaggedEdge(e){return e.type&this.JAGGED_EDGE}isRow(e){return e.type&this.ROW}isBetweenRowSpacer(e){return e.type&this.BETWEEN_ROW_SPACER}isTopRow(e){return e.type&this.TOP_ROW}isBottomRow(e){return e.type&this.BOTTOM_ROW}isTopOrBottomRow(e){return e.type&(this.TOP_ROW|this.BOTTOM_ROW)}isInputRow(e){return e.type&this.INPUT_ROW}},Q=new D0,Cn=class{constructor(e){this.centerline=this.xPos=this.height=this.width=0,this.constants_=e,this.type=Q.NONE,this.notchOffset=this.constants_.NOTCH_OFFSET_LEFT}},vl=class{constructor(e){this.elements=[],this.xPos=this.yPos=this.widthWithConnectedBlocks=this.minWidth=this.minHeight=this.width=this.height=0,this.hasStatement=this.hasExternalInput=false,this.statementEdge=0,this.hasJaggedEdge=this.hasDummyInput=this.hasInlineInput=false,this.align=null,this.constants_=e,this.type=Q.ROW,this.notchOffset=this.constants_.NOTCH_OFFSET_LEFT}getLastInput(){for(let e=this.elements.length-1;0<=e;e--){const t=this.elements[e];if(Q.isInput(t))return t}return null}measure(){throw Error("Unexpected attempt to measure a base Row.")}startsWithElemSpacer(){return true}endsWithElemSpacer(){return true}getFirstSpacer(){for(let e=0;e<this.elements.length;e++){const t=this.elements[e];if(Q.isSpacer(t))return t}return null}getLastSpacer(){for(let e=this.elements.length-1;0<=e;e--){const t=this.elements[e];if(Q.isSpacer(t))return t}return null}},g_=class extends vl{constructor(e){super(e),this.hasNextConnection=false,this.connection=null,this.baseline=this.descenderHeight=0,this.type|=Q.BOTTOM_ROW}hasLeftSquareCorner(e){return!!e.outputConnection||!!e.getNextBlock()}hasRightSquareCorner(e){return true}measure(){let e=0,t=0,r=0;for(let a=0;a<this.elements.length;a++){const d=this.elements[a];t+=d.width,Q.isSpacer(d)||(Q.isNextConnection(d)?r=Math.max(r,d.height):e=Math.max(e,d.height))}this.width=Math.max(this.minWidth,t),this.height=Math.max(this.minHeight,e)+r,this.descenderHeight=r,this.widthWithConnectedBlocks=this.width}startsWithElemSpacer(){return false}endsWithElemSpacer(){return false}},so=class extends Cn{constructor(e,t){super(e),this.connectionModel=t,this.shape=this.constants_.shapeFor(t),this.isDynamicShape="isDynamic"in this.shape&&this.shape.isDynamic,this.type|=Q.CONNECTION}},jn=class extends so{constructor(e,t){super(e,t.connection),this.input=t,this.connectionOffsetY=this.connectionOffsetX=0,this.type|=Q.INPUT,this.align=t.align,(this.connectedBlock=t.connection&&t.connection.targetBlock()?t.connection.targetBlock():null)?(e=this.connectedBlock.getHeightWidth(),this.connectedBlockWidth=e.width,this.connectedBlockHeight=e.height):this.connectedBlockHeight=this.connectedBlockWidth=0}},Eu=class extends jn{constructor(e,t){super(e,t),this.height=0,this.type|=Q.EXTERNAL_VALUE_INPUT,this.height=this.connectedBlock?this.connectedBlockHeight-this.constants_.TAB_OFFSET_FROM_TOP-this.constants_.MEDIUM_PADDING:this.shape.height,this.width=this.shape.width+this.constants_.EXTERNAL_VALUE_INPUT_PADDING,this.connectionOffsetY=this.constants_.TAB_OFFSET_FROM_TOP,this.connectionHeight=this.shape.height,this.connectionWidth=this.shape.width}},io=class extends Cn{constructor(e,t,r){super(e),this.field=t,this.parentInput=r,this.isEditable=t.EDITABLE,this.flipRtl=t.getFlipRtl(),this.type|=Q.FIELD,e=this.field.getSize(),this.height=e.height,this.width=e.width}},f_=class extends Cn{constructor(e){super(e),this.type|=Q.HAT,this.height=this.constants_.START_HAT.height,this.width=this.constants_.START_HAT.width,this.ascenderHeight=this.height}},ab=class extends Cn{constructor(e,t){super(e),this.icon=t,this.flipRtl=false,this.isVisible=t.isVisible(),this.type|=Q.ICON,e=t.getCorrectedSize(),this.height=e.height,this.width=e.width}},yi=class extends Cn{constructor(e,t){super(e),this.type=this.type|Q.SPACER|Q.IN_ROW_SPACER,this.width=t,this.height=this.constants_.SPACER_DEFAULT_HEIGHT}},m_=class extends jn{constructor(e,t){super(e,t),this.type|=Q.INLINE_INPUT,this.connectedBlock?(this.width=this.connectedBlockWidth,this.height=this.connectedBlockHeight):(this.height=this.constants_.EMPTY_INLINE_INPUT_HEIGHT,this.width=this.constants_.EMPTY_INLINE_INPUT_PADDING),this.connectionHeight=this.isDynamicShape?this.shape.height(this.height):this.shape.height,this.connectionWidth=this.isDynamicShape?this.shape.width(this.height):this.shape.width,this.connectedBlock||(this.width+=this.connectionWidth*(this.isDynamicShape?2:1)),this.connectionOffsetY="connectionOffsetY"in this.shape?this.shape.connectionOffsetY(this.connectionHeight):this.constants_.TAB_OFFSET_FROM_TOP,this.connectionOffsetX="connectionOffsetX"in this.shape?this.shape.connectionOffsetX(this.connectionWidth):0}},bl=class extends jn{constructor(e,t){super(e,t),this.type|=Q.STATEMENT_INPUT,this.height=this.connectedBlock?this.connectedBlockHeight+this.constants_.STATEMENT_BOTTOM_SPACER:this.constants_.EMPTY_STATEMENT_INPUT_HEIGHT,this.width=this.constants_.STATEMENT_INPUT_NOTCH_OFFSET+this.shape.width}},E_=class extends vl{constructor(e){super(e),this.connectedBlockWidths=0,this.type|=Q.INPUT_ROW}measure(){this.width=this.minWidth,this.height=this.minHeight;let e=0;for(let t=0;t<this.elements.length;t++){const r=this.elements[t];this.width+=r.width,Q.isInput(r)&&r instanceof jn&&(Q.isStatementInput(r)&&r instanceof bl?e+=r.connectedBlockWidth:Q.isExternalInput(r)&&r instanceof Eu&&r.connectedBlockWidth!==0&&(e+=r.connectedBlockWidth-r.connectionWidth)),Q.isSpacer(r)||(this.height=Math.max(this.height,r.height))}this.connectedBlockWidths=e,this.widthWithConnectedBlocks=this.width+e}endsWithElemSpacer(){return!this.hasExternalInput&&!this.hasStatement}},lb=class extends Cn{constructor(e){super(e),this.type|=Q.JAGGED_EDGE,this.height=this.constants_.JAGGED_TEETH.height,this.width=this.constants_.JAGGED_TEETH.width}},cb=class extends so{constructor(e,t){super(e,t),this.type|=Q.NEXT_CONNECTION,this.height=this.shape.height,this.width=this.shape.width}},ub=class extends so{constructor(e,t){super(e,t),this.connectionOffsetX=0,this.type|=Q.OUTPUT_CONNECTION,this.height=this.isDynamicShape?0:this.shape.height,this.startX=this.width=this.isDynamicShape?0:this.shape.width,this.connectionOffsetY=this.constants_.TAB_OFFSET_FROM_TOP}},hb=class extends so{constructor(e,t){super(e,t),this.type|=Q.PREVIOUS_CONNECTION,this.height=this.shape.height,this.width=this.shape.width}},Tl=class extends Cn{constructor(e,t){super(e),this.type=(t&&t!=="left"?Q.RIGHT_ROUND_CORNER:Q.LEFT_ROUND_CORNER)|Q.CORNER,this.width=this.constants_.CORNER_RADIUS,this.height=this.constants_.CORNER_RADIUS/2}},v_=class extends vl{constructor(e,t,r){super(e),this.height=t,this.width=r,this.precedesStatement=this.followsStatement=false,this.widthWithConnectedBlocks=0,this.type=this.type|Q.SPACER|Q.BETWEEN_ROW_SPACER,this.elements=[new yi(this.constants_,r)]}measure(){}},Sl=class extends Cn{constructor(e,t){super(e),this.type=(t&&t!=="left"?Q.RIGHT_SQUARE_CORNER:Q.LEFT_SQUARE_CORNER)|Q.CORNER,this.width=this.height=this.constants_.NO_PADDING}},b_=class extends vl{constructor(e){super(e),this.ascenderHeight=this.capline=0,this.hasPreviousConnection=false,this.connection=null,this.type|=Q.TOP_ROW}hasLeftSquareCorner(e){const t=(e.hat?e.hat==="cap":this.constants_.ADD_START_HATS)&&!e.outputConnection&&!e.previousConnection,r=e.getPreviousBlock();return!!e.outputConnection||t||(r?r.getNextBlock()===e:false)}hasRightSquareCorner(e){return true}measure(){let e=0,t=0,r=0;for(let a=0;a<this.elements.length;a++){const d=this.elements[a];t+=d.width,Q.isSpacer(d)||(Q.isHat(d)&&d instanceof f_?r=Math.max(r,d.ascenderHeight):e=Math.max(e,d.height))}this.width=Math.max(this.minWidth,t),this.height=Math.max(this.minHeight,e)+r,this.capline=this.ascenderHeight=r,this.widthWithConnectedBlocks=this.width}startsWithElemSpacer(){return false}endsWithElemSpacer(){return false}},$l=class{constructor(){this.NO_PADDING=0,this.SMALL_PADDING=3,this.MEDIUM_PADDING=5,this.MEDIUM_LARGE_PADDING=8,this.LARGE_PADDING=10,this.TAB_HEIGHT=15,this.TAB_OFFSET_FROM_TOP=5,this.TAB_VERTICAL_OVERLAP=2.5,this.TAB_WIDTH=8,this.NOTCH_WIDTH=15,this.NOTCH_HEIGHT=4,this.MIN_BLOCK_WIDTH=12,this.EMPTY_BLOCK_SPACER_HEIGHT=16,this.CORNER_RADIUS=8,this.NOTCH_OFFSET_LEFT=15,this.STATEMENT_BOTTOM_SPACER=0,this.STATEMENT_INPUT_PADDING_LEFT=20,this.BETWEEN_STATEMENT_PADDING_Y=4,this.ADD_START_HATS=false,this.START_HAT_HEIGHT=15,this.START_HAT_WIDTH=100,this.SPACER_DEFAULT_HEIGHT=15,this.MIN_BLOCK_HEIGHT=24,this.EMPTY_INLINE_INPUT_PADDING=14.5,this.EXTERNAL_VALUE_INPUT_PADDING=2,this.JAGGED_TEETH_HEIGHT=12,this.JAGGED_TEETH_WIDTH=6,this.FIELD_TEXT_FONTSIZE=11,this.FIELD_TEXT_FONTWEIGHT="normal",this.FIELD_TEXT_FONTFAMILY="sans-serif",this.FIELD_TEXT_BASELINE=this.FIELD_TEXT_HEIGHT=-1,this.FIELD_BORDER_RECT_RADIUS=4,this.FIELD_BORDER_RECT_HEIGHT=16,this.FIELD_BORDER_RECT_X_PADDING=5,this.FIELD_BORDER_RECT_Y_PADDING=3,this.FIELD_BORDER_RECT_COLOUR="#fff",this.FIELD_DROPDOWN_SVG_ARROW=this.FIELD_DROPDOWN_COLOURED_DIV=this.FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW=false,this.FIELD_DROPDOWN_SVG_ARROW_SIZE=12,this.FIELD_COLOUR_FULL_BLOCK=this.FIELD_TEXTINPUT_BOX_SHADOW=false,this.FIELD_COLOUR_DEFAULT_WIDTH=26,this.defs_=null,this.embossFilterId="",this.embossFilter_=null,this.disabledPatternId="",this.disabledPattern_=null,this.debugFilterId="",this.cssNode_=this.debugFilter_=null,this.CURSOR_COLOUR="#cc0a0a",this.MARKER_COLOUR="#4286f4",this.CURSOR_WS_WIDTH=100,this.WS_CURSOR_HEIGHT=5,this.CURSOR_STACK_PADDING=10,this.CURSOR_BLOCK_PADDING=2,this.CURSOR_STROKE_WIDTH=4,this.FULL_BLOCK_FIELDS=false,this.INSERTION_MARKER_COLOUR="#000000",this.INSERTION_MARKER_OPACITY=.2,this.SHAPES={PUZZLE:1,NOTCH:2},this.TALL_INPUT_FIELD_OFFSET_Y=this.MEDIUM_PADDING,this.DUMMY_INPUT_SHADOW_MIN_HEIGHT=this.DUMMY_INPUT_MIN_HEIGHT=this.TAB_HEIGHT,this.STATEMENT_INPUT_NOTCH_OFFSET=this.NOTCH_OFFSET_LEFT,this.TOP_ROW_MIN_HEIGHT=this.MEDIUM_PADDING,this.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT=this.LARGE_PADDING,this.BOTTOM_ROW_MIN_HEIGHT=this.MEDIUM_PADDING,this.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT=this.LARGE_PADDING,this.EMPTY_INLINE_INPUT_HEIGHT=this.TAB_HEIGHT+11,this.EMPTY_STATEMENT_INPUT_HEIGHT=this.MIN_BLOCK_HEIGHT,this.START_POINT=Wt(0,0),this.FIELD_TEXT_BASELINE_CENTER=true,this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT=this.FIELD_BORDER_RECT_HEIGHT,this.FIELD_DROPDOWN_SVG_ARROW_PADDING=this.FIELD_BORDER_RECT_X_PADDING,this.FIELD_DROPDOWN_SVG_ARROW_DATAURI="data:image/svg+xml;base64,PHN2ZyBpZD0iTGF5ZXJfMSIgZGF0YS1uYW1lPSJMYXllciAxIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMi43MSIgaGVpZ2h0PSI4Ljc5IiB2aWV3Qm94PSIwIDAgMTIuNzEgOC43OSI+PHRpdGxlPmRyb3Bkb3duLWFycm93PC90aXRsZT48ZyBvcGFjaXR5PSIwLjEiPjxwYXRoIGQ9Ik0xMi43MSwyLjQ0QTIuNDEsMi40MSwwLDAsMSwxMiw0LjE2TDguMDgsOC4wOGEyLjQ1LDIuNDUsMCwwLDEtMy40NSwwTDAuNzIsNC4xNkEyLjQyLDIuNDIsMCwwLDEsMCwyLjQ0LDIuNDgsMi40OCwwLDAsMSwuNzEuNzFDMSwwLjQ3LDEuNDMsMCw2LjM2LDBTMTEuNzUsMC40NiwxMiwuNzFBMi40NCwyLjQ0LDAsMCwxLDEyLjcxLDIuNDRaIiBmaWxsPSIjMjMxZjIwIi8+PC9nPjxwYXRoIGQ9Ik02LjM2LDcuNzlhMS40MywxLjQzLDAsMCwxLTEtLjQyTDEuNDIsMy40NWExLjQ0LDEuNDQsMCwwLDEsMC0yYzAuNTYtLjU2LDkuMzEtMC41Niw5Ljg3LDBhMS40NCwxLjQ0LDAsMCwxLDAsMkw3LjM3LDcuMzdBMS40MywxLjQzLDAsMCwxLDYuMzYsNy43OVoiIGZpbGw9IiNmZmYiLz48L3N2Zz4=",this.FIELD_COLOUR_DEFAULT_HEIGHT=this.FIELD_BORDER_RECT_HEIGHT,this.FIELD_CHECKBOX_X_OFFSET=this.FIELD_BORDER_RECT_X_PADDING-3,this.randomIdentifier=String(Math.random()).substring(2)}init(){this.JAGGED_TEETH=this.makeJaggedTeeth(),this.NOTCH=this.makeNotch(),this.START_HAT=this.makeStartHat(),this.PUZZLE_TAB=this.makePuzzleTab(),this.INSIDE_CORNERS=this.makeInsideCorners(),this.OUTSIDE_CORNERS=this.makeOutsideCorners()}setTheme(e){this.blockStyles=Object.create(null);const t=e.blockStyles;for(const r in t)this.blockStyles[r]=this.validatedBlockStyle_(t[r]);this.setDynamicProperties_(e)}setDynamicProperties_(e){this.setFontConstants_(e),this.setComponentConstants_(e),this.ADD_START_HATS=e.startHats!==void 0?e.startHats:this.ADD_START_HATS}setFontConstants_(e){e.fontStyle&&e.fontStyle.family&&(this.FIELD_TEXT_FONTFAMILY=e.fontStyle.family),e.fontStyle&&e.fontStyle.weight&&(this.FIELD_TEXT_FONTWEIGHT=e.fontStyle.weight),e.fontStyle&&e.fontStyle.size&&(this.FIELD_TEXT_FONTSIZE=e.fontStyle.size),e=Jt("Hg",this.FIELD_TEXT_FONTSIZE+"pt",this.FIELD_TEXT_FONTWEIGHT,this.FIELD_TEXT_FONTFAMILY),this.FIELD_TEXT_HEIGHT=e.height,this.FIELD_TEXT_BASELINE=e.baseline}setComponentConstants_(e){this.CURSOR_COLOUR=e.getComponentStyle("cursorColour")||this.CURSOR_COLOUR,this.MARKER_COLOUR=e.getComponentStyle("markerColour")||this.MARKER_COLOUR,this.INSERTION_MARKER_COLOUR=e.getComponentStyle("insertionMarkerColour")||this.INSERTION_MARKER_COLOUR,this.INSERTION_MARKER_OPACITY=Number(e.getComponentStyle("insertionMarkerOpacity"))||this.INSERTION_MARKER_OPACITY}getBlockStyleForColour(e){const t="auto_"+e;return this.blockStyles[t]||(this.blockStyles[t]=this.createBlockStyle_(e)),{style:this.blockStyles[t],name:t}}getBlockStyle(e){return this.blockStyles[e||""]||(e&&e.indexOf("auto_")===0?this.getBlockStyleForColour(e.substring(5)).style:this.createBlockStyle_("#000000"))}createBlockStyle_(e){return this.validatedBlockStyle_({colourPrimary:e})}validatedBlockStyle_(e){const t={};return e&&Object.assign(t,e),e=wo(t.colourPrimary||"#000"),t.colourPrimary=e.hex,t.colourSecondary=t.colourSecondary?wo(t.colourSecondary).hex:this.generateSecondaryColour_(t.colourPrimary),t.colourTertiary=t.colourTertiary?wo(t.colourTertiary).hex:this.generateTertiaryColour_(t.colourPrimary),t.hat=t.hat||"",t}generateSecondaryColour_(e){return Oo("#fff",e,.6)||e}generateTertiaryColour_(e){return Oo("#fff",e,.3)||e}dispose(){this.embossFilter_&&B(this.embossFilter_),this.disabledPattern_&&B(this.disabledPattern_),this.debugFilter_&&B(this.debugFilter_),this.cssNode_=null}makeJaggedTeeth(){const e=this.JAGGED_TEETH_HEIGHT,t=this.JAGGED_TEETH_WIDTH,r=Ba([Ve(t,e/4),Ve(2*-t,e/2),Ve(t,e/4)]);return{height:e,width:t,path:r}}makeStartHat(){const e=this.START_HAT_HEIGHT,t=this.START_HAT_WIDTH,r=Si("c",[Ve(30,-e),Ve(70,-e),Ve(t,0)]);return{height:e,width:t,path:r}}makePuzzleTab(){function e(C){C=C?-1:1;const D=-C;var Y=r/2;const pe=Y+2.5,we=Y+.5,Et=Ve(-t,C*Y);return Y=Ve(t,C*Y),Si("c",[Ve(0,C*pe),Ve(-t,D*we),Et])+Si("s",[Ve(t,2.5*D),Y])}const t=this.TAB_WIDTH,r=this.TAB_HEIGHT,a=e(true),d=e(false);return{type:this.SHAPES.PUZZLE,width:t,height:r,pathDown:d,pathUp:a}}makeNotch(){function e(D){return Ba([Ve(D*a,r),Ve(3*D,0),Ve(D*a,-r)])}const t=this.NOTCH_WIDTH,r=this.NOTCH_HEIGHT,a=(t-3)/2,d=e(1),C=e(-1);return{type:this.SHAPES.NOTCH,width:t,height:r,pathLeft:d,pathRight:C}}makeInsideCorners(){const e=this.CORNER_RADIUS,t=cs("a","0 0,0",e,Ve(-e,e)),r=cs("a","0 0,0",e,Ve(e,e));return{width:e,height:e,pathTop:t,pathBottom:r}}makeOutsideCorners(){const e=this.CORNER_RADIUS,t=Wt(0,e)+cs("a","0 0,1",e,Ve(e,-e)),r=cs("a","0 0,1",e,Ve(e,e)),a=cs("a","0 0,1",e,Ve(-e,-e)),d=cs("a","0 0,1",e,Ve(-e,e));return{topLeft:t,topRight:r,bottomRight:d,bottomLeft:a,rightHeight:e}}shapeFor(e){switch(e.type){case Le.INPUT_VALUE:case Le.OUTPUT_VALUE:return this.PUZZLE_TAB;case Le.PREVIOUS_STATEMENT:case Le.NEXT_STATEMENT:return this.NOTCH;default:throw Error("Unknown connection type")}}createDom(e,t,r){this.injectCSS_(t,r),this.defs_=H(ee.DEFS,{},e),e=H(ee.FILTER,{id:"blocklyEmbossFilter"+this.randomIdentifier},this.defs_),H(ee.FEGAUSSIANBLUR,{in:"SourceAlpha",stdDeviation:1,result:"blur"},e),t=H(ee.FESPECULARLIGHTING,{in:"blur",surfaceScale:1,specularConstant:.5,specularExponent:10,"lighting-color":"white",result:"specOut"},e),H(ee.FEPOINTLIGHT,{x:-5e3,y:-1e4,z:2e4},t),H(ee.FECOMPOSITE,{in:"specOut",in2:"SourceAlpha",operator:"in",result:"specOut"},e),H(ee.FECOMPOSITE,{in:"SourceGraphic",in2:"specOut",operator:"arithmetic",k1:0,k2:1,k3:1,k4:0},e),this.embossFilterId=e.id,this.embossFilter_=e,e=H(ee.PATTERN,{id:"blocklyDisabledPattern"+this.randomIdentifier,patternUnits:"userSpaceOnUse",width:10,height:10},this.defs_),H(ee.RECT,{width:10,height:10,fill:"#aaa"},e),H(ee.PATH,{d:"M 0 0 L 10 10 M 10 0 L 0 10",stroke:"#cc0"},e),this.disabledPatternId=e.id,this.disabledPattern_=e,this.createDebugFilter()}createDebugFilter(){if(!this.debugFilter_){const e=H(ee.FILTER,{id:"blocklyDebugFilter"+this.randomIdentifier,height:"160%",width:"180%",y:"-30%",x:"-40%"},this.defs_),t=H(ee.FECOMPONENTTRANSFER,{result:"outBlur"},e);H(ee.FEFUNCA,{type:"table",tableValues:"0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"},t),H(ee.FEFLOOD,{"flood-color":"#ff0000","flood-opacity":.5,result:"outColor"},e),H(ee.FECOMPOSITE,{in:"outColor",in2:"outBlur",operator:"in",result:"outGlow"},e),this.debugFilterId=e.id,this.debugFilter_=e}}injectCSS_(e,t){t=this.getCSS_(t),e="blockly-renderer-style-"+e,this.cssNode_=document.getElementById(e);const r=t.join(`
`);this.cssNode_?this.cssNode_.firstChild.textContent=r:(t=document.createElement("style"),t.id=e,e=document.createTextNode(r),t.appendChild(e),document.head.insertBefore(t,document.head.firstChild),this.cssNode_=t)}getCSS_(e){return[`${e} .blocklyText, `,`${e} .blocklyFlyoutLabelText {`,`font: ${this.FIELD_TEXT_FONTWEIGHT} ${this.FIELD_TEXT_FONTSIZE}pt ${this.FIELD_TEXT_FONTFAMILY};`,"}",`${e} .blocklyText {`,"fill: #fff;","}",`${e} .blocklyNonEditableText>rect,`,`${e} .blocklyEditableText>rect {`,`fill: ${this.FIELD_BORDER_RECT_COLOUR};`,"fill-opacity: .6;","stroke: none;","}",`${e} .blocklyNonEditableText>text,`,`${e} .blocklyEditableText>text {`,"fill: #000;","}",`${e} .blocklyFlyoutLabelText {`,"fill: #000;","}",`${e} .blocklyText.blocklyBubbleText {`,"fill: #000;","}",`${e} .blocklyEditableText:not(.editing):hover>rect {`,"stroke: #fff;","stroke-width: 2;","}",`${e} .blocklyHtmlInput {`,`font-family: ${this.FIELD_TEXT_FONTFAMILY};`,`font-weight: ${this.FIELD_TEXT_FONTWEIGHT};`,"}",`${e} .blocklySelected>.blocklyPath {`,"stroke: #fc3;","stroke-width: 3px;","}",`${e} .blocklyHighlightedConnectionPath {`,"stroke: #fc3;","}",`${e} .blocklyReplaceable .blocklyPath {`,"fill-opacity: .5;","}",`${e} .blocklyReplaceable .blocklyPathLight,`,`${e} .blocklyReplaceable .blocklyPathDark {`,"display: none;","}",`${e} .blocklyInsertionMarker>.blocklyPath {`,`fill-opacity: ${this.INSERTION_MARKER_OPACITY};`,"stroke: none;","}"]}},db=false,Ri=class{constructor(e){this.constants=e,this.debugElements_=[],this.svgRoot_=null,this.randomColour_=""}clearElems(){for(let e=0;e<this.debugElements_.length;e++)B(this.debugElements_[e]);this.debugElements_=[]}drawSpacerRow(e,t,r){if(Ri.config.rowSpacers){var a=Math.abs(e.height),d=0>e.height;d&&(t-=a),this.debugElements_.push(H(ee.RECT,{class:"rowSpacerRect blockRenderDebug",x:r?-(e.xPos+e.width):e.xPos,y:t,width:e.width,height:a,stroke:d?"black":"blue",fill:"blue","fill-opacity":"0.5","stroke-width":"1px"},this.svgRoot_))}}drawSpacerElem(e,t,r){if(Ri.config.elemSpacers){t=Math.abs(e.width);var a=0>e.width,d=a?e.xPos-t:e.xPos;r&&(d=-(d+t)),this.debugElements_.push(H(ee.RECT,{class:"elemSpacerRect blockRenderDebug",x:d,y:e.centerline-e.height/2,width:t,height:e.height,stroke:"pink",fill:a?"black":"pink","fill-opacity":"0.5","stroke-width":"1px"},this.svgRoot_))}}drawRenderedElem(e,t){if(Ri.config.elems){let r=e.xPos;t&&(r=-(r+e.width)),t=e.centerline-e.height/2,this.debugElements_.push(H(ee.RECT,{class:"rowRenderingRect blockRenderDebug",x:r,y:t,width:e.width,height:e.height,stroke:"black",fill:"none","stroke-width":"1px"},this.svgRoot_)),Q.isField(e)&&e instanceof io&&e.field instanceof i.FieldLabel$$module$build$src$core$field_label&&this.debugElements_.push(H(ee.RECT,{class:"rowRenderingRect blockRenderDebug",x:r,y:t+this.constants.FIELD_TEXT_BASELINE,width:e.width,height:"0.1px",stroke:"red",fill:"none","stroke-width":"0.5px"},this.svgRoot_))}Q.isInput(e)&&e instanceof jn&&Ri.config.connections&&this.drawConnection(e.connectionModel)}drawConnection(e){if(Ri.config.connections){var t="",r=0,a="";e.type===Le.INPUT_VALUE?(r=4,t="magenta",a="none"):e.type===Le.OUTPUT_VALUE?(r=2,a=t="magenta"):e.type===Le.NEXT_STATEMENT?(r=4,t="goldenrod",a="none"):e.type===Le.PREVIOUS_STATEMENT&&(r=2,a=t="goldenrod"),this.debugElements_.push(H(ee.CIRCLE,{class:"blockRenderDebug",cx:e.getOffsetInBlock().x,cy:e.getOffsetInBlock().y,r,fill:a,stroke:t},this.svgRoot_))}}drawRenderedRow(e,t,r){Ri.config.rows&&(this.debugElements_.push(H(ee.RECT,{class:"elemRenderingRect blockRenderDebug",x:r?-(e.xPos+e.width):e.xPos,y:e.yPos,width:e.width,height:e.height,stroke:"red",fill:"none","stroke-width":"1px"},this.svgRoot_)),Q.isTopOrBottomRow(e)||Ri.config.connectedBlockBounds&&this.debugElements_.push(H(ee.RECT,{class:"connectedBlockWidth blockRenderDebug",x:r?-(e.xPos+e.widthWithConnectedBlocks):e.xPos,y:e.yPos,width:e.widthWithConnectedBlocks,height:e.height,stroke:this.randomColour_,fill:"none","stroke-width":"1px","stroke-dasharray":"3,3"},this.svgRoot_)))}drawRowWithElements(e,t,r){for(let a=0;a<e.elements.length;a++){const d=e.elements[a];d?Q.isSpacer(d)?this.drawSpacerElem(d,e.height,r):this.drawRenderedElem(d,r):console.warn("A row has an undefined or null element.",e,d)}this.drawRenderedRow(e,t,r)}drawBoundingBox(e){if(Ri.config.blockBounds){var t=e.RTL?-e.width:0;this.debugElements_.push(H(ee.RECT,{class:"blockBoundingBox blockRenderDebug",x:t,y:0,width:e.width,height:e.height,stroke:"black",fill:"none","stroke-width":"1px","stroke-dasharray":"5,5"},this.svgRoot_)),Ri.config.connectedBlockBounds&&(t=e.RTL?-e.widthWithChildren:0,this.debugElements_.push(H(ee.RECT,{class:"blockRenderDebug",x:t,y:0,width:e.widthWithChildren,height:e.height,stroke:"#DF57BC",fill:"none","stroke-width":"1px","stroke-dasharray":"3,3"},this.svgRoot_)))}}drawDebug(e,t){this.clearElems(),this.svgRoot_=e.getSvgRoot(),this.randomColour_="#"+Math.floor(16777215*Math.random()).toString(16);let r=0;for(let a=0;a<t.rows.length;a++){const d=t.rows[a];Q.isBetweenRowSpacer(d)?this.drawSpacerRow(d,r,t.RTL):this.drawRowWithElements(d,r,t.RTL),r+=d.height}e.previousConnection&&this.drawConnection(e.previousConnection),e.nextConnection&&this.drawConnection(e.nextConnection),e.outputConnection&&this.drawConnection(e.outputConnection),t.rightSide&&this.drawRenderedElem(t.rightSide,t.RTL),this.drawBoundingBox(t),this.drawRender(e.pathObject.svgPath)}drawRender(e){Ri.config.render&&(e.setAttribute("filter","url(#"+this.constants.debugFilterId+")"),setTimeout(function(){e.setAttribute("filter","")},100))}};Ri.config={rowSpacers:true,elemSpacers:true,rows:true,elems:true,connections:true,blockBounds:true,connectedBlockBounds:true,render:true};var yl=class{constructor(e,t){this.inlinePath_=this.outlinePath_="",this.block_=e,this.info_=t,this.topLeft_=e.getRelativeToSurfaceXY(),this.constants_=t.getRenderer().getConstants()}draw(){if(this.hideHiddenIcons_(),this.drawOutline_(),this.drawInternals_(),this.block_.pathObject.setPath(this.outlinePath_+`
`+this.inlinePath_),this.info_.RTL&&this.block_.pathObject.flipRTL(),Mc()){let e;(e=this.block_.renderingDebugger)==null||e.drawDebug(this.block_,this.info_)}this.recordSizeOnBlock_()}recordSizeOnBlock_(){this.block_.height=this.info_.height,this.block_.width=this.info_.widthWithChildren}hideHiddenIcons_(){for(let e=0,t;t=this.info_.hiddenIcons[e];e++){let r;(r=t.icon.iconGroup_)==null||r.setAttribute("display","none")}}drawOutline_(){this.drawTop_();for(let e=1;e<this.info_.rows.length-1;e++){const t=this.info_.rows[e];t.hasJaggedEdge?this.drawJaggedEdge_(t):t.hasStatement?this.drawStatementInput_(t):t.hasExternalInput?this.drawValueInput_(t):this.drawRightSideRow_(t)}this.drawBottom_(),this.drawLeft_()}drawTop_(){const e=this.info_.topRow,t=e.elements;this.positionPreviousConnection_(),this.outlinePath_+=Wt(e.xPos,this.info_.startY);for(let r=0,a;a=t[r];r++)Q.isLeftRoundedCorner(a)?this.outlinePath_+=this.constants_.OUTSIDE_CORNERS.topLeft:Q.isRightRoundedCorner(a)?this.outlinePath_+=this.constants_.OUTSIDE_CORNERS.topRight:Q.isPreviousConnection(a)&&a instanceof so?this.outlinePath_+=a.shape.pathLeft:Q.isHat(a)?this.outlinePath_+=this.constants_.START_HAT.path:Q.isSpacer(a)&&(this.outlinePath_+=Ne("h",a.width));this.outlinePath_+=Ne("v",e.height)}drawJaggedEdge_(e){this.outlinePath_+=this.constants_.JAGGED_TEETH.path+Ne("v",e.height-this.constants_.JAGGED_TEETH.height)}drawValueInput_(e){const t=e.getLastInput();this.positionExternalValueConnection_(e);const r=LE(t.shape)?t.shape.pathDown(t.height):t.shape.pathDown;this.outlinePath_+=Ne("H",t.xPos+t.width)+r+Ne("v",e.height-t.connectionHeight)}drawStatementInput_(e){var t=e.getLastInput();if(t){var r=t.xPos+t.notchOffset+t.shape.width;t=t.shape.pathRight+Ne("h",-(t.notchOffset-this.constants_.INSIDE_CORNERS.width))+this.constants_.INSIDE_CORNERS.pathTop;var a=e.height-2*this.constants_.INSIDE_CORNERS.height;this.outlinePath_+=Ne("H",r)+t+Ne("v",a)+this.constants_.INSIDE_CORNERS.pathBottom+Ne("H",e.xPos+e.width),this.positionStatementInputConnection_(e)}}drawRightSideRow_(e){this.outlinePath_+=Ne("V",e.yPos+e.height)}drawBottom_(){const e=this.info_.bottomRow,t=e.elements;this.positionNextConnection_();let r=0,a="";for(let d=t.length-1,C;C=t[d];d--)Q.isNextConnection(C)&&C instanceof so?a+=C.shape.pathRight:Q.isLeftSquareCorner(C)?a+=Ne("H",e.xPos):Q.isLeftRoundedCorner(C)?a+=this.constants_.OUTSIDE_CORNERS.bottomLeft:Q.isRightRoundedCorner(C)?(a+=this.constants_.OUTSIDE_CORNERS.bottomRight,r=this.constants_.OUTSIDE_CORNERS.rightHeight):Q.isSpacer(C)&&(a+=Ne("h",-1*C.width));this.outlinePath_+=Ne("V",e.baseline-r),this.outlinePath_+=a}drawLeft_(){var e=this.info_.outputConnection;if(this.positionOutputConnection_(),e){const t=e.connectionOffsetY+e.height;e=LE(e.shape)?e.shape.pathUp(e.height):e.shape.pathUp,this.outlinePath_+=Ne("V",t)+e}this.outlinePath_+="z"}drawInternals_(){for(let e=0,t;t=this.info_.rows[e];e++)for(let r=0,a;a=t.elements[r];r++)Q.isInlineInput(a)?this.drawInlineInput_(a):(Q.isIcon(a)||Q.isField(a))&&this.layoutField_(a)}layoutField_(e){const t=Q.isField(e)?e.field.getSvgRoot():e.icon.iconGroup_,r=e.centerline-e.height/2;let a=e.xPos,d="";this.info_.RTL&&(a=-(a+e.width),e.flipRtl&&(a+=e.width,d="scale(-1 1)")),Q.isIcon(e)?(t.setAttribute("display","block"),t.setAttribute("transform","translate("+a+","+r+")"),e.icon.computeIconLocation()):t.setAttribute("transform","translate("+a+","+r+")"+d),this.info_.isInsertionMarker&&t.setAttribute("display","none")}drawInlineInput_(e){const t=e.width,r=e.height,a=e.connectionOffsetY,d=e.connectionHeight+a;this.inlinePath_+=Us(e.xPos+e.connectionWidth,e.centerline-r/2)+Ne("v",a)+e.shape.pathDown+Ne("v",r-d)+Ne("h",t-e.connectionWidth)+Ne("v",-r)+"z",this.positionInlineInputConnection_(e)}positionInlineInputConnection_(e){const t=e.centerline-e.height/2;if(e.connectionModel){let r=e.xPos+e.connectionWidth+e.connectionOffsetX;this.info_.RTL&&(r*=-1),e.connectionModel.setOffsetInBlock(r,t+e.connectionOffsetY)}}positionStatementInputConnection_(e){const t=e.getLastInput();if(t!=null&&t.connectionModel){let r=e.xPos+e.statementEdge+t.notchOffset;this.info_.RTL&&(r*=-1),t.connectionModel.setOffsetInBlock(r,e.yPos)}}positionExternalValueConnection_(e){const t=e.getLastInput();if(t&&t.connectionModel){let r=e.xPos+e.width;this.info_.RTL&&(r*=-1),t.connectionModel.setOffsetInBlock(r,e.yPos)}}positionPreviousConnection_(){const e=this.info_.topRow;if(e.connection){const t=e.xPos+e.notchOffset;e.connection.connectionModel.setOffsetInBlock(this.info_.RTL?-t:t,0)}}positionNextConnection_(){const e=this.info_.bottomRow;if(e.connection){const t=e.connection,r=t.xPos;t.connectionModel.setOffsetInBlock(this.info_.RTL?-r:r,e.baseline)}}positionOutputConnection_(){if(this.info_.outputConnection){const e=this.info_.startX+this.info_.outputConnection.connectionOffsetX;this.block_.outputConnection.setOffsetInBlock(this.info_.RTL?-e:e,this.info_.outputConnection.connectionOffsetY)}}},ia=class{constructor(e,t){this.statementEdge=this.width=this.widthWithChildren=this.height=0,this.rows=[],this.inputRows=[],this.hiddenIcons=[],this.startY=this.startX=0,this.renderer_=e,this.block_=t,this.constants_=this.renderer_.getConstants(),this.outputConnection=t.outputConnection?new ub(this.constants_,t.outputConnection):null,this.isInline=t.getInputsInline()&&!t.isCollapsed(),this.isCollapsed=t.isCollapsed(),this.isInsertionMarker=t.isInsertionMarker(),this.RTL=t.RTL,this.topRow=new b_(this.constants_),this.bottomRow=new g_(this.constants_)}getRenderer(){return this.renderer_}measure(){this.createRows_(),this.addElemSpacing_(),this.addRowSpacing_(),this.computeBounds_(),this.alignRowElements_(),this.finalize_()}createRows_(){this.populateTopRow_(),this.rows.push(this.topRow);let e=new E_(this.constants_);this.inputRows.push(e);var t=this.block_.getIcons();for(let r=0,a;a=t[r];r++){const d=new ab(this.constants_,a);this.isCollapsed&&a.collapseHidden?this.hiddenIcons.push(d):e.elements.push(d)}t=void 0;for(let r=0,a;a=this.block_.inputList[r];r++)if(a.isVisible()){this.shouldStartNewRow_(a,t)&&(this.rows.push(e),e=new E_(this.constants_),this.inputRows.push(e));for(let d=0,C;C=a.fieldRow[d];d++)e.elements.push(new io(this.constants_,C,a));this.addInput_(a,e),t=a}this.isCollapsed&&(e.hasJaggedEdge=true,e.elements.push(new lb(this.constants_))),(e.elements.length||e.hasDummyInput)&&this.rows.push(e),this.populateBottomRow_(),this.rows.push(this.bottomRow)}populateTopRow_(){var e=!!this.block_.previousConnection;const t=(this.block_.hat?this.block_.hat==="cap":this.constants_.ADD_START_HATS)&&!this.outputConnection&&!e;let r=this.topRow.hasLeftSquareCorner(this.block_)?Sl:Tl;this.topRow.elements.push(new r(this.constants_)),t?(e=new f_(this.constants_),this.topRow.elements.push(e),this.topRow.capline=e.ascenderHeight):e&&(this.topRow.hasPreviousConnection=true,this.topRow.connection=new hb(this.constants_,this.block_.previousConnection),this.topRow.elements.push(this.topRow.connection)),this.block_.inputList.length&&this.block_.inputList[0].type===lt.STATEMENT&&!this.block_.isCollapsed()?this.topRow.minHeight=this.constants_.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT:this.topRow.minHeight=this.constants_.TOP_ROW_MIN_HEIGHT,r=this.topRow.hasRightSquareCorner(this.block_)?Sl:Tl,this.topRow.elements.push(new r(this.constants_,"right"))}populateBottomRow_(){this.bottomRow.hasNextConnection=!!this.block_.nextConnection,this.bottomRow.minHeight=this.block_.inputList.length&&this.block_.inputList[this.block_.inputList.length-1].type===lt.STATEMENT?this.constants_.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT:this.constants_.BOTTOM_ROW_MIN_HEIGHT,this.bottomRow.hasLeftSquareCorner(this.block_)?this.bottomRow.elements.push(new Sl(this.constants_)):this.bottomRow.elements.push(new Tl(this.constants_)),this.bottomRow.hasNextConnection&&(this.bottomRow.connection=new cb(this.constants_,this.block_.nextConnection),this.bottomRow.elements.push(this.bottomRow.connection)),this.bottomRow.hasRightSquareCorner(this.block_)?this.bottomRow.elements.push(new Sl(this.constants_,"right")):this.bottomRow.elements.push(new Tl(this.constants_,"right"))}addInput_(e,t){this.isInline&&e.type===lt.VALUE?(t.elements.push(new m_(this.constants_,e)),t.hasInlineInput=true):e.type===lt.STATEMENT?(t.elements.push(new bl(this.constants_,e)),t.hasStatement=true):e.type===lt.VALUE?(t.elements.push(new Eu(this.constants_,e)),t.hasExternalInput=true):e.type===lt.DUMMY&&(t.minHeight=Math.max(t.minHeight,e.getSourceBlock()&&e.getSourceBlock().isShadow()?this.constants_.DUMMY_INPUT_SHADOW_MIN_HEIGHT:this.constants_.DUMMY_INPUT_MIN_HEIGHT),t.hasDummyInput=true),t.align===null&&(t.align=e.align)}shouldStartNewRow_(e,t){return t?e.type===lt.STATEMENT||t.type===lt.STATEMENT?true:e.type===lt.VALUE||e.type===lt.DUMMY?!this.isInline:false:false}addElemSpacing_(){for(let e=0,t;t=this.rows[e];e++){const r=t.elements;if(t.elements=[],t.startsWithElemSpacer()&&t.elements.push(new yi(this.constants_,this.getInRowSpacing_(null,r[0]))),r.length){for(let a=0;a<r.length-1;a++){t.elements.push(r[a]);const d=this.getInRowSpacing_(r[a],r[a+1]);t.elements.push(new yi(this.constants_,d))}t.elements.push(r[r.length-1]),t.endsWithElemSpacer()&&t.elements.push(new yi(this.constants_,this.getInRowSpacing_(r[r.length-1],null)))}}}getInRowSpacing_(e,t){if(!e&&t&&Q.isStatementInput(t))return this.constants_.STATEMENT_INPUT_PADDING_LEFT;if(e&&Q.isInput(e)&&!t){if(Q.isExternalInput(e))return this.constants_.NO_PADDING;if(Q.isInlineInput(e))return this.constants_.LARGE_PADDING;if(Q.isStatementInput(e))return this.constants_.NO_PADDING}return e&&Q.isLeftSquareCorner(e)&&t&&(Q.isPreviousConnection(t)||Q.isNextConnection(t))?t.notchOffset:e&&Q.isLeftRoundedCorner(e)&&t&&(Q.isPreviousConnection(t)||Q.isNextConnection(t))?t.notchOffset-this.constants_.CORNER_RADIUS:this.constants_.MEDIUM_PADDING}computeBounds_(){let e=0,t=0,r=0;for(let d=0,C;C=this.rows[d];d++){if(C.measure(),t=Math.max(t,C.width),C.hasStatement){var a=C.getLastInput();let D,Y;a=C.width-((Y=(D=a)==null?void 0:D.width)!=null?Y:0),e=Math.max(e,a)}r=Math.max(r,C.widthWithConnectedBlocks)}this.statementEdge=e,this.width=t;for(let d=0,C;C=this.rows[d];d++)C.hasStatement&&(C.statementEdge=this.statementEdge);this.widthWithChildren=Math.max(t,r),this.outputConnection&&(this.startX=this.outputConnection.width,this.width+=this.outputConnection.width,this.widthWithChildren+=this.outputConnection.width)}alignRowElements_(){for(let t=0,r;r=this.rows[t];t++)if(r.hasStatement)this.alignStatementRow_(r);else{var e=r.width;e=this.getDesiredRowWidth_(r)-e,0<e&&this.addAlignmentPadding_(r,e),Q.isTopOrBottomRow(r)&&(r.widthWithConnectedBlocks=r.width)}}getDesiredRowWidth_(e){return this.width-this.startX}addAlignmentPadding_(e,t){const r=e.getFirstSpacer(),a=e.getLastSpacer();if((e.hasExternalInput||e.hasStatement)&&(e.widthWithConnectedBlocks+=t),e.align===i.Align$$module$build$src$core$input.LEFT&&a)a.width+=t;else if(e.align===i.Align$$module$build$src$core$input.CENTRE&&r&&a)r.width+=t/2,a.width+=t/2;else if(e.align===i.Align$$module$build$src$core$input.RIGHT&&r)r.width+=t;else if(a)a.width+=t;else return;e.width+=t}alignStatementRow_(e){const t=e.getLastInput();if(t){var r=e.width-t.width,a=this.statementEdge;r=a-r,0<r&&this.addAlignmentPadding_(e,r),r=e.width,a=this.getDesiredRowWidth_(e),t.width+=a-r,t.height=Math.max(t.height,e.height),e.width+=a-r,e.widthWithConnectedBlocks=Math.max(e.width,this.statementEdge+e.connectedBlockWidths)}}addRowSpacing_(){const e=this.rows;this.rows=[];for(let t=0;t<e.length;t++)this.rows.push(e[t]),t!==e.length-1&&this.rows.push(this.makeSpacerRow_(e[t],e[t+1]))}makeSpacerRow_(e,t){var r=this.getSpacerRowHeight_(e,t);const a=this.getSpacerRowWidth_(e,t);return r=new v_(this.constants_,r,a),e.hasStatement&&(r.followsStatement=true),t.hasStatement&&(r.precedesStatement=true),r}getSpacerRowWidth_(e,t){return this.width-this.startX}getSpacerRowHeight_(e,t){return this.constants_.MEDIUM_PADDING}getElemCenterline_(e,t){return Q.isSpacer(t)?e.yPos+t.height/2:Q.isBottomRow(e)?(e=e.yPos+e.height-e.descenderHeight,Q.isNextConnection(t)?e+t.height/2:e-t.height/2):Q.isTopRow(e)?Q.isHat(t)?e.capline-t.height/2:e.capline+t.height/2:e.yPos+e.height/2}recordElemPositions_(e){let t=e.xPos;for(let r=0,a;a=e.elements[r];r++)Q.isSpacer(a)&&(a.height=e.height),a.xPos=t,a.centerline=this.getElemCenterline_(e,a),t+=a.width}finalize_(){let e=0,t=0;for(let r=0,a;a=this.rows[r];r++)a.yPos=t,a.xPos=this.startX,t+=a.height,e=Math.max(e,a.widthWithConnectedBlocks),this.recordElemPositions_(a);if(this.outputConnection&&this.block_.nextConnection){const r=this.block_.nextConnection.targetBlock();r&&(e=Math.max(e,r.getHeightWidth().width))}this.widthWithChildren=e+this.startX,this.height=t,this.startY=this.topRow.capline,this.bottomRow.baseline=t-this.bottomRow.descenderHeight}},T_=class extends tn{constructor(e,t,r,a){let d=e?e.workspace.id:void 0;a&&a.getType()===ge.types.WORKSPACE&&(d=a.getLocation().id),super(d),this.type=Wa,this.blockId=e==null?void 0:e.id,this.oldNode=r||void 0,this.newNode=a,this.isCursor=t}toJson(){const e=super.toJson();if(this.isCursor===void 0)throw Error("Whether this is a cursor event or not is undefined. Either pass a value to the constructor, or call fromJson");if(!this.newNode)throw Error("The new node is undefined. Either pass a node to the constructor, or call fromJson");return e.isCursor=this.isCursor,e.blockId=this.blockId,e.oldNode=this.oldNode,e.newNode=this.newNode,e}fromJson(e){o("Blockly.Events.MarkerMove.prototype.fromJson","version 9","version 10","Blockly.Events.fromJson"),super.fromJson(e),this.isCursor=e.isCursor,this.blockId=e.blockId,this.oldNode=e.oldNode,this.newNode=e.newNode}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new T_),t.isCursor=e.isCursor,t.blockId=e.blockId,t.oldNode=e.oldNode,t.newNode=e.newNode,t}};$e(Te.EVENT,Wa,T_);var x0="blocklyCursor",B0="blocklyMarker",P0=.75,S_=class{constructor(e,t,r){this.workspace=e,this.marker=r,this.markerSvgRect_=this.markerSvgLine_=this.markerInput_=this.markerBlock_=this.svgGroup_=this.markerSvg_=this.currentMarkerSvg=this.parent_=null,this.constants_=t,e=this.isCursor()?this.constants_.CURSOR_COLOUR:this.constants_.MARKER_COLOUR,this.colour_=r.colour||e}getSvgRoot(){return this.svgGroup_}getMarker(){return this.marker}isCursor(){return this.marker.type==="cursor"}createDom(){const e=this.isCursor()?x0:B0;return this.svgGroup_=H(ee.G,{class:e}),this.createDomInternal_(),this.svgGroup_}setParent_(e){this.isCursor()?(this.parent_&&this.parent_.setCursorSvg(null),e.setCursorSvg(this.getSvgRoot())):(this.parent_&&this.parent_.setMarkerSvg(null),e.setMarkerSvg(this.getSvgRoot())),this.parent_=e}draw(e,t){if(t){this.constants_=this.workspace.getRenderer().getConstants();var r=this.isCursor()?this.constants_.CURSOR_COLOUR:this.constants_.MARKER_COLOUR;this.colour_=this.marker.colour||r,this.applyColour_(t),this.showAtLocation_(t),this.fireMarkerEvent_(e,t),e=this.currentMarkerSvg.childNodes[0],e!==void 0&&e.beginElement&&e.beginElement()}else this.hide()}showAtLocation_(e){const t=e.getLocation().type;e.getType()===ge.types.BLOCK?this.showWithBlock_(e):e.getType()===ge.types.OUTPUT?this.showWithOutput_(e):t===Le.INPUT_VALUE?this.showWithInput_(e):t===Le.NEXT_STATEMENT?this.showWithNext_(e):e.getType()===ge.types.PREVIOUS?this.showWithPrevious_(e):e.getType()===ge.types.FIELD?this.showWithField_(e):e.getType()===ge.types.WORKSPACE?this.showWithCoordinates_(e):e.getType()===ge.types.STACK&&this.showWithStack_(e)}showWithBlockPrevOutput_(e){e=e.getSourceBlock();const t=e.width;var r=e.height,a=r*P0;const d=this.constants_.CURSOR_BLOCK_PADDING;e.previousConnection?(r=this.constants_.shapeFor(e.previousConnection),this.positionPrevious_(t,d,a,r)):e.outputConnection?(a=this.constants_.shapeFor(e.outputConnection),this.positionOutput_(t,r,a)):this.positionBlock_(t,d,a),this.setParent_(e),this.showCurrent_()}showWithBlock_(e){this.showWithBlockPrevOutput_(e)}showWithPrevious_(e){this.showWithBlockPrevOutput_(e)}showWithOutput_(e){this.showWithBlockPrevOutput_(e)}showWithCoordinates_(e){var t=e.getWsCoordinate();e=t.x,t=t.y,this.workspace.RTL&&(e-=this.constants_.CURSOR_WS_WIDTH),this.positionLine_(e,t,this.constants_.CURSOR_WS_WIDTH),this.setParent_(this.workspace),this.showCurrent_()}showWithField_(e){e=e.getLocation();const t=e.getSize().width,r=e.getSize().height;this.positionRect_(0,0,t,r),this.setParent_(e),this.showCurrent_()}showWithInput_(e){e=e.getLocation();const t=e.getSourceBlock();this.positionInput_(e),this.setParent_(t),this.showCurrent_()}showWithNext_(e){var t=e.getLocation();e=t.getSourceBlock();let r=0;t=t.getOffsetInBlock().y;const a=e.getHeightWidth().width;this.workspace.RTL&&(r=-a),this.positionLine_(r,t,a),this.setParent_(e),this.showCurrent_()}showWithStack_(e){e=e.getLocation();var t=e.getHeightWidth();const r=t.width+this.constants_.CURSOR_STACK_PADDING;t=t.height+this.constants_.CURSOR_STACK_PADDING;const a=-this.constants_.CURSOR_STACK_PADDING/2,d=-this.constants_.CURSOR_STACK_PADDING/2;let C=a;this.workspace.RTL&&(C=-(r+a)),this.positionRect_(C,d,r,t),this.setParent_(e),this.showCurrent_()}showCurrent_(){this.hide(),this.currentMarkerSvg&&(this.currentMarkerSvg.style.display="")}positionBlock_(e,t,r){if(e=Wt(-t,r)+Ne("V",-t)+Ne("H",e+2*t)+Ne("V",r),!this.markerBlock_)throw Error("createDom should be called before positioning the marker");this.markerBlock_.setAttribute("d",e),this.workspace.RTL&&this.flipRtl_(this.markerBlock_),this.currentMarkerSvg=this.markerBlock_}positionInput_(e){const t=e.getOffsetInBlock().x,r=e.getOffsetInBlock().y;e=Us(0,0)+this.constants_.shapeFor(e).pathDown,this.markerInput_.setAttribute("d",e),this.markerInput_.setAttribute("transform","translate("+t+","+r+")"+(this.workspace.RTL?" scale(-1 1)":"")),this.currentMarkerSvg=this.markerInput_}positionLine_(e,t,r){if(!this.markerSvgLine_)throw Error("createDom should be called before positioning the line");this.markerSvgLine_.setAttribute("x",`${e}`),this.markerSvgLine_.setAttribute("y",`${t}`),this.markerSvgLine_.setAttribute("width",`${r}`),this.currentMarkerSvg=this.markerSvgLine_}positionOutput_(e,t,r){if(!this.markerBlock_)throw Error("createDom should be called before positioning the output");e=Wt(e,0)+Ne("h",-(e-r.width))+Ne("v",this.constants_.TAB_OFFSET_FROM_TOP)+r.pathDown+Ne("V",t)+Ne("H",e),this.markerBlock_.setAttribute("d",e),this.workspace.RTL&&this.flipRtl_(this.markerBlock_),this.currentMarkerSvg=this.markerBlock_}positionPrevious_(e,t,r,a){if(!this.markerBlock_)throw Error("createDom should be called before positioning the previous connection marker");e=Wt(-t,r)+Ne("V",-t)+Ne("H",this.constants_.NOTCH_OFFSET_LEFT)+a.pathLeft+Ne("H",e+2*t)+Ne("V",r),this.markerBlock_.setAttribute("d",e),this.workspace.RTL&&this.flipRtl_(this.markerBlock_),this.currentMarkerSvg=this.markerBlock_}positionRect_(e,t,r,a){if(!this.markerSvgRect_)throw Error("createDom should be called before positioning the rect");this.markerSvgRect_.setAttribute("x",`${e}`),this.markerSvgRect_.setAttribute("y",`${t}`),this.markerSvgRect_.setAttribute("width",`${r}`),this.markerSvgRect_.setAttribute("height",`${a}`),this.currentMarkerSvg=this.markerSvgRect_}flipRtl_(e){e.setAttribute("transform","scale(-1 1)")}hide(){if(!(this.markerSvgLine_&&this.markerSvgRect_&&this.markerInput_&&this.markerBlock_))throw Error("createDom should be called before hiding the marker");this.markerSvgLine_.style.display="none",this.markerSvgRect_.style.display="none",this.markerInput_.style.display="none",this.markerBlock_.style.display="none"}fireMarkerEvent_(e,t){const r=t.getSourceBlock();e=new(Re(Wa))(r,this.isCursor(),e,t),Pe(e)}getBlinkProperties_(){return{attributeType:"XML",attributeName:"fill",dur:"1s",values:this.colour_+";transparent;transparent;",repeatCount:"indefinite"}}createDomInternal_(){if(this.markerSvg_=H(ee.G,{width:this.constants_.CURSOR_WS_WIDTH,height:this.constants_.WS_CURSOR_HEIGHT},this.svgGroup_),this.markerSvgLine_=H(ee.RECT,{width:this.constants_.CURSOR_WS_WIDTH,height:this.constants_.WS_CURSOR_HEIGHT,style:"display: none"},this.markerSvg_),this.markerSvgRect_=H(ee.RECT,{class:"blocklyVerticalMarker",rx:10,ry:10,style:"display: none"},this.markerSvg_),this.markerInput_=H(ee.PATH,{transform:"",style:"display: none"},this.markerSvg_),this.markerBlock_=H(ee.PATH,{transform:"",style:"display: none",fill:"none","stroke-width":this.constants_.CURSOR_STROKE_WIDTH},this.markerSvg_),this.isCursor()){const e=this.getBlinkProperties_();H(ee.ANIMATE,e,this.markerSvgLine_),H(ee.ANIMATE,e,this.markerInput_),H(ee.ANIMATE,Object.assign({},e,{attributeName:"stroke"}),this.markerBlock_)}return this.markerSvg_}applyColour_(e){if(!(this.markerSvgLine_&&this.markerSvgRect_&&this.markerInput_&&this.markerBlock_))throw Error("createDom should be called before applying color to the markerj");this.markerSvgLine_.setAttribute("fill",this.colour_),this.markerSvgRect_.setAttribute("stroke",this.colour_),this.markerInput_.setAttribute("fill",this.colour_),this.markerBlock_.setAttribute("stroke",this.colour_),this.isCursor()&&(e=this.colour_+";transparent;transparent;",this.markerSvgLine_.firstElementChild.setAttribute("values",e),this.markerInput_.firstElementChild.setAttribute("values",e),this.markerBlock_.firstElementChild.setAttribute("values",e))}dispose(){this.svgGroup_&&B(this.svgGroup_)}},vu=class{constructor(e,t,r){this.markerSvg=this.cursorSvg=null,this.constants=r,this.style=t,this.svgRoot=e,this.svgPath=H(ee.PATH,{class:"blocklyPath"},this.svgRoot)}setPath(e){this.svgPath.setAttribute("d",e)}flipRTL(){this.svgPath.setAttribute("transform","scale(-1 1)")}setCursorSvg(e){e?(this.svgRoot.appendChild(e),this.cursorSvg=e):this.cursorSvg=null}setMarkerSvg(e){e?(this.cursorSvg?this.svgRoot.insertBefore(e,this.cursorSvg):this.svgRoot.appendChild(e),this.markerSvg=e):this.markerSvg=null}applyColour(e){this.svgPath.setAttribute("stroke",this.style.colourTertiary),this.svgPath.setAttribute("fill",this.style.colourPrimary),this.updateShadow_(e.isShadow()),this.updateDisabled_(!e.isEnabled()||e.getInheritedDisabled())}setStyle(e){this.style=e}setClass_(e,t){e&&(t?ie(this.svgRoot,e):he(this.svgRoot,e))}updateHighlighted(e){e?this.svgPath.setAttribute("filter","url(#"+this.constants.embossFilterId+")"):this.svgPath.setAttribute("filter","none")}updateShadow_(e){e&&(this.svgPath.setAttribute("stroke","none"),this.svgPath.setAttribute("fill",this.style.colourSecondary))}updateDisabled_(e){this.setClass_("blocklyDisabled",e),e&&this.svgPath.setAttribute("fill","url(#"+this.constants.disabledPatternId+")")}updateSelected(e){this.setClass_("blocklySelected",e)}updateDraggingDelete(e){this.setClass_("blocklyDraggingDelete",e)}updateInsertionMarker(e){this.setClass_("blocklyInsertionMarker",e)}updateMovable(e){this.setClass_("blocklyDraggable",e)}updateReplacementFade(e){this.setClass_("blocklyReplaceable",e)}updateShapeForInputHighlight(e,t){}},_b="The insertion marker manager tried to create a marker but the result is missing %1. If you are using a mutator, make sure your domToMutation method is properly defined.",Ii=class{constructor(e){this.activeCandidate=this.lastMarker=this.lastOnStack=null,this.wouldDeleteBlock=false,this.fadedBlock=this.highlightedBlock=this.markerConnection=null,F(e),this.topBlock=e,this.workspace=e.workspace,this.firstMarker=this.createMarkerBlock(this.topBlock),this.availableConnections=this.initAvailableConnections()}dispose(){this.availableConnections.length=0,Zt();try{this.firstMarker&&this.firstMarker.dispose(),this.lastMarker&&this.lastMarker.dispose()}finally{ss()}}updateAvailableConnections(){this.availableConnections=this.initAvailableConnections()}wouldConnectBlock(){return!!this.activeCandidate}applyConnections(){if(this.activeCandidate){Zt(),this.hidePreview(),ss();var{local:e,closest:t}=this.activeCandidate;if(e.connect(t),this.topBlock.rendered){const r=e.isSuperior()?t:e;cE(r.getSourceBlock()),this.topBlock.getRootBlock().bringToFront()}}}update(e,t){const r=this.getCandidate(e);((this.wouldDeleteBlock=this.shouldDelete(!!r,t))||this.shouldUpdatePreviews(r,e))&&(Zt(),this.maybeHidePreview(r),this.maybeShowPreview(r),ss())}createMarkerBlock(e){var t=e.type;Zt();let r;try{if(r=this.workspace.newBlock(t),r.setInsertionMarker(true),e.saveExtraState){var a=e.saveExtraState();a&&r.loadExtraState&&r.loadExtraState(a)}else if(e.mutationToDom){const d=e.mutationToDom();d&&r.domToMutation&&r.domToMutation(d)}for(t=0;t<e.inputList.length;t++){const d=e.inputList[t];if(d.name===cl)continue;const C=r.inputList[t];if(!C)throw Error(_b.replace("%1","an input"));for(a=0;a<d.fieldRow.length;a++){const D=d.fieldRow[a],Y=C.fieldRow[a];if(!Y)throw Error(_b.replace("%1","a field"));Y.setValue(D.getValue())}}r.setCollapsed(e.isCollapsed()),r.setInputsInline(e.getInputsInline()),r.initSvg(),r.getSvgRoot().setAttribute("visibility","hidden")}finally{ss()}return r}initAvailableConnections(){const e=this.topBlock.getConnections_(false),t=this.topBlock.lastConnectionInStack(true);if(t&&t!==this.topBlock.nextConnection){if(e.push(t),this.lastOnStack=t,this.lastMarker){Zt();try{this.lastMarker.dispose()}finally{ss()}}this.lastMarker=this.createMarkerBlock(t.getSourceBlock())}return e}shouldUpdatePreviews(e,t){if(!e)return!!this.activeCandidate;if(!this.activeCandidate)return true;const{local:r,closest:a}=this.activeCandidate;if(a===e.closest&&r===e.local)return false;const d=r.x+t.x-a.x;return t=r.y+t.y-a.y,e.radius<Math.sqrt(d*d+t*t)-i.config$$module$build$src$core$config.currentConnectionPreference}getCandidate(e){this.markerConnection&&this.markerConnection.isConnected()||this.updateAvailableConnections();let t=this.getStartRadius(),r=null;for(let a=0;a<this.availableConnections.length;a++){const d=this.availableConnections[a],C=d.closest(t,e);C.connection&&(r={closest:C.connection,local:d,radius:C.radius},t=C.radius)}return r}getStartRadius(){return this.activeCandidate?i.config$$module$build$src$core$config.connectingSnapRadius:i.config$$module$build$src$core$config.snapRadius}shouldDelete(e,t){return t&&this.workspace.getComponentManager().hasCapability(t.id,$s.Capability.DELETE_AREA)?t.wouldDelete(this.topBlock,e):false}maybeShowPreview(e){if(!this.wouldDeleteBlock&&e){var t=e.closest,r;t===((r=this.activeCandidate)==null?void 0:r.closest)||t.getSourceBlock().isInsertionMarker()?console.log("Trying to connect to an insertion marker"):(this.activeCandidate=e,this.showPreview(this.activeCandidate))}}showPreview(e){const t=this.workspace.getRenderer();switch(t.getConnectionPreviewMethod(e.closest,e.local,this.topBlock)){case Ii.PREVIEW_TYPE.INPUT_OUTLINE:this.showInsertionInputOutline(e);break;case Ii.PREVIEW_TYPE.INSERTION_MARKER:this.showInsertionMarker(e);break;case Ii.PREVIEW_TYPE.REPLACEMENT_FADE:this.showReplacementFade(e)}t.shouldHighlightConnection(e.closest)&&e.closest.highlight()}maybeHidePreview(e){if(!e)this.hidePreview();else if(this.activeCandidate){const t=this.activeCandidate.local!==e.local;(this.activeCandidate.closest!==e.closest||t||this.wouldDeleteBlock)&&this.hidePreview()}this.activeCandidate=this.markerConnection=null}hidePreview(){let e;const t=(e=this.activeCandidate)==null?void 0:e.closest;t&&t.targetBlock()&&this.workspace.getRenderer().shouldHighlightConnection(t)&&t.unhighlight(),this.hideReplacementFade(),this.hideInsertionInputOutline(),this.hideInsertionMarker()}showInsertionMarker(e){const{local:t,closest:r}=e;let a=(e=this.lastOnStack&&t===this.lastOnStack)?this.lastMarker:this.firstMarker;if(!a)throw Error("Cannot show the insertion marker because there is no insertion marker block");let d;try{d=a.getMatchingConnection(t.getSourceBlock(),t)}catch{if(this.firstMarker=this.createMarkerBlock(this.topBlock),a=e?this.lastMarker:this.firstMarker,!a)throw Error("Cannot show the insertion marker because there is no insertion marker block");d=a.getMatchingConnection(t.getSourceBlock(),t)}if(!d)throw Error("Cannot show the insertion marker because there is no associated connection");if(d===this.markerConnection)throw Error("Made it to showInsertionMarker_ even though the marker isn't changing");a.render(),a.rendered=true,a.getSvgRoot().setAttribute("visibility","visible"),d&&r&&a.positionNearConnection(d,r),r&&d.connect(r),this.markerConnection=d}hideInsertionMarker(){if(this.markerConnection){var e=this.markerConnection,t=e.getSourceBlock(),r=t.previousConnection,a=t.outputConnection,d=e===t.nextConnection;if(a=e.type===Le.INPUT_VALUE&&!(a&&a.targetConnection),d&&(!r||!r.targetConnection)||a?e.targetBlock().unplug(false):e.type!==Le.NEXT_STATEMENT||d?t.unplug(true):((d=e.targetConnection)&&d.getSourceBlock().unplug(false),r=r?r.targetConnection:null,t.unplug(true),r&&d&&r.connect(d)),e.targetConnection)throw Error("markerConnection still connected at the end of disconnectInsertionMarker");this.markerConnection=null,(e=t.getSvgRoot())&&e.setAttribute("visibility","hidden")}}showInsertionInputOutline(e){e=e.closest,this.highlightedBlock=e.getSourceBlock(),this.highlightedBlock.highlightShapeForInput(e,true)}hideInsertionInputOutline(){if(this.highlightedBlock){if(!this.activeCandidate)throw Error("Cannot hide the insertion marker outline because there is no active candidate");this.highlightedBlock.highlightShapeForInput(this.activeCandidate.closest,false),this.highlightedBlock=null}}showReplacementFade(e){if(this.fadedBlock=e.closest.targetBlock(),!this.fadedBlock)throw Error("Cannot show the replacement fade because the closest connection does not have a target block");this.fadedBlock.fadeForReplacement(true)}hideReplacementFade(){this.fadedBlock&&(this.fadedBlock.fadeForReplacement(false),this.fadedBlock=null)}getInsertionMarkers(){const e=[];return this.firstMarker&&e.push(this.firstMarker),this.lastMarker&&e.push(this.lastMarker),e}};(function(e){e=e.PREVIEW_TYPE||(e.PREVIEW_TYPE={}),e[e.INSERTION_MARKER=0]="INSERTION_MARKER",e[e.INPUT_OUTLINE=1]="INPUT_OUTLINE",e[e.REPLACEMENT_FADE=2]="REPLACEMENT_FADE"})(Ii||(Ii={})),Ii.PREVIEW_TYPE;var Rl=class{constructor(e){this.overrides=null,this.name=e}getClassName(){return this.name+"-renderer"}init(e,t){this.constants_=this.makeConstants_(),t&&(this.overrides=t,Object.assign(this.constants_,t)),this.constants_.setTheme(e),this.constants_.init()}createDom(e,t){this.constants_.createDom(e,this.name+"-"+t.name,"."+this.getClassName()+"."+t.getClassName())}refreshDom(e,t){const r=this.getConstants();r.dispose(),this.constants_=this.makeConstants_(),this.overrides&&Object.assign(this.constants_,this.overrides),this.constants_.randomIdentifier=r.randomIdentifier,this.constants_.setTheme(t),this.constants_.init(),this.createDom(e,t)}dispose(){this.constants_&&this.constants_.dispose()}makeConstants_(){return new $l}makeRenderInfo_(e){return new ia(this,e)}makeDrawer_(e,t){return new yl(e,t)}makeDebugger_(){return new Ri(this.getConstants())}makeMarkerDrawer(e,t){return new S_(e,this.getConstants(),t)}makePathObject(e,t){return new vu(e,t,this.constants_)}getConstants(){return this.constants_}shouldHighlightConnection(e){return true}orphanCanConnectAtEnd(e,t,r){return!!Rt.getConnectionForOrphanedConnection(e,r===Le.OUTPUT_VALUE?t.outputConnection:t.previousConnection)}getConnectionPreviewMethod(e,t,r){return t.type===Le.OUTPUT_VALUE||t.type===Le.PREVIOUS_STATEMENT?!e.isConnected()||this.orphanCanConnectAtEnd(r,e.targetBlock(),t.type)?Ii.PREVIEW_TYPE.INSERTION_MARKER:Ii.PREVIEW_TYPE.REPLACEMENT_FADE:Ii.PREVIEW_TYPE.INSERTION_MARKER}render(e){Mc()&&!e.renderingDebugger&&(e.renderingDebugger=this.makeDebugger_());const t=this.makeRenderInfo_(e);t.measure(),this.makeDrawer_(e,t).draw()}},Ct={};Ct.BottomRow=g_,Ct.Connection=so,Ct.ConstantProvider=$l,Ct.Debug=Ri,Ct.Drawer=yl,Ct.ExternalValueInput=Eu,Ct.Field=io,Ct.Hat=f_,Ct.Icon=ab,Ct.InRowSpacer=yi,Ct.InlineInput=m_,Ct.InputConnection=jn,Ct.InputRow=E_,Ct.JaggedEdge=lb,Ct.MarkerSvg=S_,Ct.Measurable=Cn,Ct.NextConnection=cb,Ct.OutputConnection=ub,Ct.PathObject=vu,Ct.PreviousConnection=hb,Ct.RenderInfo=ia,Ct.Renderer=Rl,Ct.RoundCorner=Tl,Ct.Row=vl,Ct.SpacerRow=v_,Ct.SquareCorner=Sl,Ct.StatementInput=bl,Ct.TopRow=b_,Ct.Types=Q,Ct.init=NE,Ct.register=Fa,Ct.stopDebugger=FO,Ct.unregister=UO;var pb=class{constructor(e,t){this.workspace=e,this.theme=t,this.subscribedWorkspaces_=[],this.componentDB=new Map}getTheme(){return this.theme}setTheme(e){var t=this.theme;this.theme=e,(e=this.workspace.getInjectionDiv())&&(t&&(t=t.getClassName())&&he(e,t),(t=this.theme.getClassName())&&ie(e,t));for(let r=0,a;a=this.subscribedWorkspaces_[r];r++)a.refreshTheme();for(const[r,a]of this.componentDB)for(const d of a){e=d.element,t=d.propertyName;const C=this.theme&&this.theme.getComponentStyle(r);e.style[t]=C||""}for(const r of this.subscribedWorkspaces_)r.hideChaff()}subscribeWorkspace(e){this.subscribedWorkspaces_.push(e)}unsubscribeWorkspace(e){if(!ni(this.subscribedWorkspaces_,e))throw Error("Cannot unsubscribe a workspace that hasn't been subscribed.")}subscribe(e,t,r){this.componentDB.has(t)||this.componentDB.set(t,[]),this.componentDB.get(t).push({element:e,propertyName:r}),t=this.theme&&this.theme.getComponentStyle(t),e.style[r]=t||""}unsubscribe(e){if(e)for(const[t,r]of this.componentDB){for(let a=r.length-1;0<=a;a--)r[a].element===e&&r.splice(a,1);r.length||this.componentDB.delete(t)}}dispose(){this.subscribedWorkspaces_=this.theme=this.owner_=null,this.componentDB.clear()}},$_="VARIABLE_DYNAMIC",mr={};mr.CATEGORY_NAME=$_,mr.flyoutCategory=nd,mr.flyoutCategoryBlocks=BE,mr.onCreateVariableButtonClick_Colour=xE,mr.onCreateVariableButtonClick_Number=DE,mr.onCreateVariableButtonClick_String=ME;var gb=class{canConnect(e,t,r,a){return this.canConnectWithReason(e,t,r,a)===Rt.CAN_CONNECT}canConnectWithReason(e,t,r,a){const d=this.doSafetyChecks(e,t);return d!==Rt.CAN_CONNECT?d:this.doTypeChecks(e,t)?r&&!this.doDragChecks(e,t,a||0)?Rt.REASON_DRAG_CHECKS_FAILED:Rt.CAN_CONNECT:Rt.REASON_CHECKS_FAILED}getErrorMessage(e,t,r){switch(e){case Rt.REASON_SELF_CONNECTION:return"Attempted to connect a block to itself.";case Rt.REASON_DIFFERENT_WORKSPACES:return"Blocks not on same workspace.";case Rt.REASON_WRONG_TYPE:return"Attempt to connect incompatible types.";case Rt.REASON_TARGET_NULL:return"Target connection is null.";case Rt.REASON_CHECKS_FAILED:return"Connection checks failed. "+(t+" expected "+t.getCheck()+", found "+r.getCheck());case Rt.REASON_SHADOW_PARENT:return"Connecting non-shadow to shadow block.";case Rt.REASON_DRAG_CHECKS_FAILED:return"Drag checks failed.";case Rt.REASON_PREVIOUS_AND_OUTPUT:return"Block would have an output and a previous connection.";default:return"Unknown connection failure: this should never happen!"}}doSafetyChecks(e,t){if(!e||!t)return Rt.REASON_TARGET_NULL;let r,a,d;return e.isSuperior()?(r=e.getSourceBlock(),a=t.getSourceBlock(),d=t):(a=e.getSourceBlock(),r=t.getSourceBlock(),d=e,e=t),r===a?Rt.REASON_SELF_CONNECTION:d.type!==eo[e.type]?Rt.REASON_WRONG_TYPE:r.workspace!==a.workspace?Rt.REASON_DIFFERENT_WORKSPACES:r.isShadow()&&!a.isShadow()?Rt.REASON_SHADOW_PARENT:d.type===Le.OUTPUT_VALUE&&a.previousConnection&&a.previousConnection.isConnected()||d.type===Le.PREVIOUS_STATEMENT&&a.outputConnection&&a.outputConnection.isConnected()?Rt.REASON_PREVIOUS_AND_OUTPUT:Rt.CAN_CONNECT}doTypeChecks(e,t){if(e=e.getCheck(),t=t.getCheck(),!e||!t)return true;for(let r=0;r<e.length;r++)if(t.indexOf(e[r])!==-1)return true;return false}doDragChecks(e,t,r){if(e.distanceFrom(t)>r||t.getSourceBlock().isInsertionMarker())return false;switch(t.type){case Le.PREVIOUS_STATEMENT:return this.canConnectToPrevious_(e,t);case Le.OUTPUT_VALUE:if(t.isConnected()&&!t.targetBlock().isInsertionMarker()||e.isConnected())return false;break;case Le.INPUT_VALUE:if(t.isConnected()&&!t.targetBlock().isMovable()&&!t.targetBlock().isShadow())return false;break;case Le.NEXT_STATEMENT:if(t.isConnected()&&!e.getSourceBlock().nextConnection&&!t.targetBlock().isShadow()&&t.targetBlock().nextConnection)return false;break;default:return false}return Wr.indexOf(t)===-1}canConnectToPrevious_(e,t){return e.targetConnection||Wr.indexOf(t)!==-1?false:t.targetConnection?(e=t.targetBlock(),e.isInsertionMarker()?!e.getPreviousBlock():false):true}};$e(Te.CONNECTION_CHECKER,Un,gb);var y_=class extends qa{constructor(e){super(e),this.type=Po,e&&(this.varType=e.type,this.varName=e.name)}toJson(){const e=super.toJson();if(!this.varType)throw Error("The var type is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.varName)throw Error("The var name is undefined. Either pass a variable to the constructor, or call fromJson");return e.varType=this.varType,e.varName=this.varName,e}fromJson(e){o("Blockly.Events.VarDelete.prototype.fromJson","version 9","version 10","Blockly.Events.fromJson"),super.fromJson(e),this.varType=e.varType,this.varName=e.varName}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new y_),t.varType=e.varType,t.varName=e.varName,t}run(e){const t=this.getEventWorkspace_();if(!this.varId)throw Error("The var ID is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.varName)throw Error("The var name is undefined. Either pass a variable to the constructor, or call fromJson");e?t.deleteVariableById(this.varId):t.createVariable(this.varName,this.varType,this.varId)}};$e(Te.EVENT,Po,y_);var R_=class extends qa{constructor(e,t){super(e),this.type=Ha,e&&(this.oldName=e.name,this.newName=typeof t>"u"?"":t)}toJson(){const e=super.toJson();if(!this.oldName)throw Error("The old var name is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.newName)throw Error("The new var name is undefined. Either pass a value to the constructor, or call fromJson");return e.oldName=this.oldName,e.newName=this.newName,e}fromJson(e){o("Blockly.Events.VarRename.prototype.fromJson","version 9","version 10","Blockly.Events.fromJson"),super.fromJson(e),this.oldName=e.oldName,this.newName=e.newName}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new R_),t.oldName=e.oldName,t.newName=e.newName,t}run(e){const t=this.getEventWorkspace_();if(!this.varId)throw Error("The var ID is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.oldName)throw Error("The old var name is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.newName)throw Error("The new var name is undefined. Either pass a value to the constructor, or call fromJson");e?t.renameVariableById(this.varId,this.newName):t.renameVariableById(this.varId,this.oldName)}};$e(Te.EVENT,Ha,R_);var I_=class{constructor(e){this.workspace=e,this.variableMap=new Map}clear(){this.variableMap.clear()}renameVariable(e,t){if(e.name!==t){var r=this.getVariable(t,e.type),a=this.workspace.getAllBlocks(false);He(true);try{r&&r.getId()!==e.getId()?this.renameVariableWithConflict_(e,t,r,a):this.renameVariableAndUses_(e,t,a)}finally{He(false)}}}renameVariableById(e,t){const r=this.getVariableById(e);if(!r)throw Error("Tried to rename a variable that didn't exist. ID: "+e);this.renameVariable(r,t)}renameVariableAndUses_(e,t,r){for(Pe(new(Re(Ha))(e,t)),e.name=t,t=0;t<r.length;t++)r[t].updateVarName(e)}renameVariableWithConflict_(e,t,r,a){const d=e.type;for(t!==r.name&&this.renameVariableAndUses_(r,t,a),t=0;t<a.length;t++)a[t].renameVarById(e.getId(),r.getId());Pe(new(Re(Po))(e)),ni(this.variableMap.get(d),e)}createVariable(e,t,r){var a=this.getVariable(e,t);if(a){if(r&&a.getId()!==r)throw Error('Variable "'+e+'" is already in use and its id is "'+a.getId()+'" which conflicts with the passed in id, "'+r+'".');return a}if(r&&this.getVariableById(r))throw Error('Variable id, "'+r+'", is already in use.');return a=r||mi(),t=t||"",a=new Ja(this.workspace,e,t,a),e=this.variableMap.get(t)||[],e.push(a),this.variableMap.delete(t),this.variableMap.set(t,e),Pe(new(Re(Xr))(a)),a}deleteVariable(e){const t=e.getId(),r=this.variableMap.get(e.type);if(r){for(let a=0;a<r.length;a++)if(r[a].getId()===t){r.splice(a,1),Pe(new(Re(Po))(e));break}}}deleteVariableById(e){const t=this.getVariableById(e);if(t){var r=t.name;const a=this.getVariableUsesById(e);for(let d=0,C;C=a[d];d++)if(C.type==="procedures_defnoreturn"||C.type==="procedures_defreturn"){e=String(C.getFieldValue("NAME")),r=Je.CANNOT_DELETE_VARIABLE_PROCEDURE.replace("%1",r).replace("%2",e),xr(r);return}1<a.length?(r=Je.DELETE_VARIABLE_CONFIRMATION.replace("%1",String(a.length)).replace("%2",r),La(r,d=>{d&&t&&this.deleteVariableInternal(t,a)})):this.deleteVariableInternal(t,a)}else console.warn("Can't delete non-existent variable: "+e)}deleteVariableInternal(e,t){const r=Ft();r||He(true);try{for(let a=0;a<t.length;a++)t[a].dispose(true);this.deleteVariable(e)}finally{r||He(false)}}getVariable(e,t){if(t=this.variableMap.get(t||"")){for(let r=0,a;a=t[r];r++)if(Gi.equals(a.name,e))return a}return null}getVariableById(e){for(const[,t]of this.variableMap)for(const r of t)if(r.getId()===e)return r;return null}getVariablesOfType(e){return(e=this.variableMap.get(e||""))?e.slice():[]}getVariableTypes(e){const t=new Set(this.variableMap.keys());if(e&&e.getPotentialVariableMap())for(const r of e.getPotentialVariableMap().variableMap.keys())t.add(r);return t.has("")||t.add(""),Array.from(t.values())}getAllVariables(){let e=[];for(const t of this.variableMap.values())e=e.concat(t);return e}getAllVariableNames(){return Array.from(this.variableMap.values()).flat().map(e=>e.name)}getVariableUsesById(e){const t=[],r=this.workspace.getAllBlocks(false);for(let a=0;a<r.length;a++){const d=r[a].getVarModels();if(d)for(let C=0;C<d.length;C++)d[C].getId()===e&&t.push(r[a])}return t}},Xn=class{get isFlyout(){return this.internalIsFlyout}get isMutator(){return this.internalIsMutator}constructor(e){this.isClearing=this.internalIsMutator=this.internalIsFlyout=this.rendered=false,this.MAX_UNDO=1024,this.connectionDBList=[],this.topBlocks=[],this.topComments=[],this.commentDB=new Map,this.listeners=[],this.undoStack_=[],this.redoStack_=[],this.blockDB=new Map,this.typedBlocksDB=new Map,this.procedureMap=new ob(this),this.potentialVariableMap=null,this.id=mi(),L(this),this.options=e||new on({}),this.RTL=!!this.options.RTL,this.horizontalLayout=!!this.options.horizontalLayout,this.toolboxPosition=this.options.toolboxPosition,this.connectionChecker=new(si(Te.CONNECTION_CHECKER,this.options,true))(this),this.variableMap=new I_(this)}dispose(){this.listeners.length=0,this.clear(),I(this)}sortObjects_(e,t){return e=e.getRelativeToSurfaceXY(),t=t.getRelativeToSurfaceXY(),e.y+Xn.prototype.sortObjects_.offset*e.x-(t.y+Xn.prototype.sortObjects_.offset*t.x)}addTopBlock(e){this.topBlocks.push(e)}removeTopBlock(e){if(!ni(this.topBlocks,e))throw Error("Block not present in workspace's list of top-most blocks.")}getTopBlocks(e){const t=[].concat(this.topBlocks);return e&&1<t.length&&(this.sortObjects_.offset=Math.sin(We(Xn.SCAN_ANGLE)),this.RTL&&(this.sortObjects_.offset*=-1),t.sort(this.sortObjects_)),t}addTypedBlock(e){this.typedBlocksDB.has(e.type)||this.typedBlocksDB.set(e.type,[]),this.typedBlocksDB.get(e.type).push(e)}removeTypedBlock(e){ni(this.typedBlocksDB.get(e.type),e),this.typedBlocksDB.get(e.type).length||this.typedBlocksDB.delete(e.type)}getBlocksByType(e,t){return this.typedBlocksDB.has(e)?(e=this.typedBlocksDB.get(e).slice(0),t&&e&&1<e.length&&(this.sortObjects_.offset=Math.sin(We(Xn.SCAN_ANGLE)),this.RTL&&(this.sortObjects_.offset*=-1),e.sort(this.sortObjects_)),e.filter(function(r){return!r.isInsertionMarker()})):[]}addTopComment(e){this.topComments.push(e),this.commentDB.has(e.id)&&console.warn('Overriding an existing comment on this workspace, with id "'+e.id+'"'),this.commentDB.set(e.id,e)}removeTopComment(e){if(!ni(this.topComments,e))throw Error("Comment not present in workspace's list of top-most comments.");this.commentDB.delete(e.id)}getTopComments(e){const t=[].concat(this.topComments);return e&&1<t.length&&(this.sortObjects_.offset=Math.sin(We(Xn.SCAN_ANGLE)),this.RTL&&(this.sortObjects_.offset*=-1),t.sort(this.sortObjects_)),t}getAllBlocks(e){if(e){var t=this.getTopBlocks(true);e=[];for(let r=0;r<t.length;r++)e.push(...t[r].getDescendants(true))}else for(e=this.getTopBlocks(false),t=0;t<e.length;t++)e.push(...e[t].getChildren(false));return e.filter(function(r){return!r.isInsertionMarker()})}clear(){this.isClearing=true;try{const e=Ft();for(e||He(true);this.topBlocks.length;)this.topBlocks[0].dispose(false);for(;this.topComments.length;)this.topComments[this.topComments.length-1].dispose();e||He(false),this.variableMap.clear(),this.potentialVariableMap&&this.potentialVariableMap.clear()}finally{this.isClearing=false}}renameVariableById(e,t){this.variableMap.renameVariableById(e,t)}createVariable(e,t,r){return this.variableMap.createVariable(e,t,r)}getVariableUsesById(e){return this.variableMap.getVariableUsesById(e)}deleteVariableById(e){this.variableMap.deleteVariableById(e)}getVariable(e,t){return this.variableMap.getVariable(e,t)}getVariableById(e){return this.variableMap.getVariableById(e)}getVariablesOfType(e){return this.variableMap.getVariablesOfType(e)}getVariableTypes(){return this.variableMap.getVariableTypes(this)}getAllVariables(){return this.variableMap.getAllVariables()}getAllVariableNames(){return this.variableMap.getAllVariableNames()}getWidth(){return 0}newBlock(e,t){throw Error("The implementation of newBlock should be monkey-patched in by blockly.ts")}remainingCapacity(){return isNaN(this.options.maxBlocks)?1/0:this.options.maxBlocks-this.getAllBlocks(false).length}remainingCapacityOfType(e){return this.options.maxInstances?(this.options.maxInstances[e]!==void 0?this.options.maxInstances[e]:1/0)-this.getBlocksByType(e,false).length:1/0}isCapacityAvailable(e){if(!this.hasBlockLimits())return true;let t=0;for(const r in e){if(e[r]>this.remainingCapacityOfType(r))return false;t+=e[r]}return!(t>this.remainingCapacity())}hasBlockLimits(){return this.options.maxBlocks!==1/0||!!this.options.maxInstances}getUndoStack(){return this.undoStack_}getRedoStack(){return this.redoStack_}undo(e){var t=e?this.redoStack_:this.undoStack_,r=e?this.undoStack_:this.redoStack_;const a=t.pop();if(a){for(var d=[a];t.length&&a.group&&a.group===t[t.length-1].group;)d.push(t.pop());for(t=0;t<d.length;t++)r.push(d[t]);d=Ei(d,e),Bs(false);try{for(r=0;r<d.length;r++)d[r].run(e)}finally{Bs(true)}}}clearUndo(){this.undoStack_.length=0,this.redoStack_.length=0,Ro()}addChangeListener(e){return this.listeners.push(e),e}removeChangeListener(e){ni(this.listeners,e)}fireChangeListener(e){if(e.recordUndo)for(this.undoStack_.push(e),this.redoStack_.length=0;this.undoStack_.length>this.MAX_UNDO&&0<=this.MAX_UNDO;)this.undoStack_.shift();for(let t=0;t<this.listeners.length;t++)(0,this.listeners[t])(e)}getBlockById(e){return this.blockDB.get(e)||null}setBlockById(e,t){this.blockDB.set(e,t)}removeBlockById(e){this.blockDB.delete(e)}getCommentById(e){let t;return(t=this.commentDB.get(e))!=null?t:null}allInputsFilled(e){const t=this.getTopBlocks(false);for(let r=0;r<t.length;r++)if(!t[r].allInputsFilled(e))return false;return true}getPotentialVariableMap(){return this.potentialVariableMap}createPotentialVariableMap(){this.potentialVariableMap=new I_(this)}getVariableMap(){return this.variableMap}setVariableMap(e){this.variableMap=e}getProcedureMap(){return this.procedureMap}static getById(e){return O(e)}static getAll(){return w()}};Xn.SCAN_ANGLE=3;var U0=100,fb=class{constructor(e){this.parentWorkspace=e,this.sounds=new Map,this.lastSound_=null}dispose(){this.sounds.clear()}load(e,t){if(e.length){try{var r=new globalThis.Audio}catch{return}for(let d=0;d<e.length;d++){const C=e[d],D=C.match(/\.(\w+)$/);if(D&&r.canPlayType("audio/"+D[1])){var a=new globalThis.Audio(C);break}}a&&this.sounds.set(t,a)}}preload(){for(const e of this.sounds.values()){e.volume=.01;const t=e.play();if(t!==void 0?t.then(e.pause).catch(function(){}):e.pause(),Lo||uv)break}}play(e,t){var r=this.sounds.get(e);r?(e=new Date,this.lastSound_!==null&&e.getTime()-this.lastSound_.getTime()<U0||(this.lastSound_=e,r=Lo||Gc?r:r.cloneNode(),r.volume=t===void 0?1:t,r.play())):this.parentWorkspace&&this.parentWorkspace.getAudioManager().play(e,t)}},mb=class{constructor(e){this.workspace=e,this.id="zoomControls",this.zoomResetGroup=this.zoomOutGroup=this.zoomInGroup=this.onZoomOutWrapper=this.onZoomInWrapper=this.onZoomResetWrapper=null,this.HEIGHT=this.WIDTH=32,this.SMALL_SPACING=2,this.LARGE_SPACING=11,this.MARGIN_HORIZONTAL=this.MARGIN_VERTICAL=20,this.svgGroup=null,this.top=this.left=0,this.initialized=false}createDom(){this.svgGroup=H(ee.G,{});const e=String(Math.random()).substring(2);return this.createZoomOutSvg(e),this.createZoomInSvg(e),this.workspace.isMovable()&&this.createZoomResetSvg(e),this.svgGroup}init(){this.workspace.getComponentManager().addComponent({component:this,weight:2,capabilities:[$s.Capability.POSITIONABLE]}),this.initialized=true}dispose(){this.workspace.getComponentManager().removeComponent("zoomControls"),this.svgGroup&&B(this.svgGroup),this.onZoomResetWrapper&&g(this.onZoomResetWrapper),this.onZoomInWrapper&&g(this.onZoomInWrapper),this.onZoomOutWrapper&&g(this.onZoomOutWrapper)}getBoundingRectangle(){let e=this.SMALL_SPACING+2*this.HEIGHT;return this.zoomResetGroup&&(e+=this.LARGE_SPACING+this.HEIGHT),new ts(this.top,this.top+e,this.left,this.left+this.WIDTH)}position(e,t){if(this.initialized){var r=ed(this.workspace,e),a=this.SMALL_SPACING+2*this.HEIGHT;if(this.zoomResetGroup&&(a+=this.LARGE_SPACING+this.HEIGHT),e=Qh(r,new Ss(this.WIDTH,a),this.MARGIN_HORIZONTAL,this.MARGIN_VERTICAL,e,this.workspace),r=r.vertical,t=td(e,this.MARGIN_VERTICAL,r===zn.TOP?fr.DOWN:fr.UP,t),r===zn.TOP){var d=this.SMALL_SPACING+this.HEIGHT,C;(C=this.zoomInGroup)==null||C.setAttribute("transform","translate(0, "+d+")"),this.zoomResetGroup&&this.zoomResetGroup.setAttribute("transform","translate(0, "+(d+this.LARGE_SPACING+this.HEIGHT)+")")}else{C=this.zoomResetGroup?this.LARGE_SPACING+this.HEIGHT:0;let Y;(Y=this.zoomInGroup)==null||Y.setAttribute("transform","translate(0, "+C+")"),C=C+this.SMALL_SPACING+this.HEIGHT,(d=this.zoomOutGroup)==null||d.setAttribute("transform","translate(0, "+C+")")}this.top=t.top,this.left=t.left;var D;(D=this.svgGroup)==null||D.setAttribute("transform","translate("+this.left+","+this.top+")")}}createZoomOutSvg(e){this.zoomOutGroup=H(ee.G,{class:"blocklyZoom"},this.svgGroup);const t=H(ee.CLIPPATH,{id:"blocklyZoomoutClipPath"+e},this.zoomOutGroup);H(ee.RECT,{width:32,height:32},t),H(ee.IMAGE,{width:Ks.width,height:Ks.height,x:-64,y:-92,"clip-path":"url(#blocklyZoomoutClipPath"+e+")"},this.zoomOutGroup).setAttributeNS(ai,"xlink:href",this.workspace.options.pathToMedia+Ks.url),this.onZoomOutWrapper=S(this.zoomOutGroup,"pointerdown",null,this.zoom.bind(this,-1))}createZoomInSvg(e){this.zoomInGroup=H(ee.G,{class:"blocklyZoom"},this.svgGroup);const t=H(ee.CLIPPATH,{id:"blocklyZoominClipPath"+e},this.zoomInGroup);H(ee.RECT,{width:32,height:32},t),H(ee.IMAGE,{width:Ks.width,height:Ks.height,x:-32,y:-92,"clip-path":"url(#blocklyZoominClipPath"+e+")"},this.zoomInGroup).setAttributeNS(ai,"xlink:href",this.workspace.options.pathToMedia+Ks.url),this.onZoomInWrapper=S(this.zoomInGroup,"pointerdown",null,this.zoom.bind(this,1))}zoom(e,t){this.workspace.markFocused(),this.workspace.zoomCenter(e),this.fireZoomEvent(),m(),t.stopPropagation(),t.preventDefault()}createZoomResetSvg(e){this.zoomResetGroup=H(ee.G,{class:"blocklyZoom"},this.svgGroup);const t=H(ee.CLIPPATH,{id:"blocklyZoomresetClipPath"+e},this.zoomResetGroup);H(ee.RECT,{width:32,height:32},t),H(ee.IMAGE,{width:Ks.width,height:Ks.height,y:-92,"clip-path":"url(#blocklyZoomresetClipPath"+e+")"},this.zoomResetGroup).setAttributeNS(ai,"xlink:href",this.workspace.options.pathToMedia+Ks.url),this.onZoomResetWrapper=S(this.zoomResetGroup,"pointerdown",null,this.resetZoom.bind(this))}resetZoom(e){this.workspace.markFocused();const t=Math.log(this.workspace.options.zoomOptions.startScale/this.workspace.scale)/Math.log(this.workspace.options.zoomOptions.scaleSpeed);this.workspace.beginCanvasTransition(),this.workspace.zoomCenter(t),this.workspace.scrollCenter(),setTimeout(this.workspace.endCanvasTransition.bind(this.workspace),500),this.fireZoomEvent(),m(),e.stopPropagation(),e.preventDefault()}fireZoomEvent(){const e=new(Re(_r))(null,this.workspace.id,"zoom_controls");Pe(e)}};Ti(`
.blocklyZoom>image, .blocklyZoom>svg>image {
  opacity: .4;
}

.blocklyZoom>image:hover, .blocklyZoom>svg>image:hover {
  opacity: .6;
}

.blocklyZoom>image:active, .blocklyZoom>svg>image:active {
  opacity: .8;
}
`);var F0=20,ln=class extends Xn{constructor(e,t,r){super(e),this.resizeHandlerWrapper=null,this.resizesEnabled=this.isVisible_=this.rendered=true,this.startScrollY=this.startScrollX=this.scrollY=this.scrollX=0,this.dragDeltaXY=null,this.oldScale=this.scale=1,this.oldLeft=this.oldTop=0,this.workspaceDragSurface=this.blockDragSurface=this.currentGesture_=this.toolbox_=this.flyout=this.scrollbar=this.trashcan=null,this.isDragSurfaceActive=false,this.inverseScreenCTM=this.targetWorkspace=this.configureContextMenu=this.lastRecordedPageScroll=this.injectionDiv=null,this.inverseScreenCTMDirty=true,this.highlightedBlocks=[],this.toolboxCategoryCallbacks=new Map,this.flyoutButtonCallbacks=new Map,this.cachedParentSvg=null,this.keyboardAccessibilityMode=false,this.topBoundedElements=[],this.dragTargetAreas=[],this.zoomControls_=null,this.metricsManager=new(si(Te.METRICS_MANAGER,e,true))(this),this.getMetrics=e.getMetrics||this.metricsManager.getMetrics.bind(this.metricsManager),this.setMetrics=e.setMetrics||ln.setTopLevelWorkspaceMetrics_,this.componentManager=new $s,this.connectionDBList=ta.init(this.connectionChecker),t&&(this.blockDragSurface=t),r&&(this.workspaceDragSurface=r),this.useWorkspaceDragSurface=!!this.workspaceDragSurface,this.audioManager=new fb(e.parentWorkspace),this.grid=this.options.gridPattern?new __(this.options.gridPattern,e.gridOptions):null,this.markerManager=new Za(this),i.module$build$src$core$variables&&Br&&this.registerToolboxCategoryCallback(iu,Br),mr&&nd&&this.registerToolboxCategoryCallback($_,nd),i.module$build$src$core$procedures&&id&&(this.registerToolboxCategoryCallback(mu,id),this.addChangeListener(kE)),this.themeManager_=this.options.parentWorkspace?this.options.parentWorkspace.getThemeManager():new pb(this,this.options.theme||hu),this.themeManager_.subscribeWorkspace(this);let a;this.renderer=NE(this.options.renderer||"geras",this.getTheme(),(a=this.options.rendererOverrides)!=null?a:void 0),this.cachedParentSvgSize=new Ss(0,0)}getMarkerManager(){return this.markerManager}getMetricsManager(){return this.metricsManager}setMetricsManager(e){this.metricsManager=e,this.getMetrics=this.metricsManager.getMetrics.bind(this.metricsManager)}getComponentManager(){return this.componentManager}setCursorSvg(e){this.markerManager.setCursorSvg(e)}setMarkerSvg(e){this.markerManager.setMarkerSvg(e)}getMarker(e){return this.markerManager?this.markerManager.getMarker(e):null}getCursor(){return this.markerManager?this.markerManager.getCursor():null}getRenderer(){return this.renderer}getThemeManager(){return this.themeManager_}getTheme(){return this.themeManager_.getTheme()}setTheme(e){e||(e=hu),this.themeManager_.setTheme(e)}refreshTheme(){this.svgGroup_&&this.renderer.refreshDom(this.svgGroup_,this.getTheme()),this.updateBlockStyles_(this.getAllBlocks(false).filter(function(t){return!!t.getStyleName()})),this.refreshToolboxSelection(),this.toolbox_&&this.toolbox_.refreshTheme(),this.isVisible()&&this.setVisible(true);const e=new(Re(Xa))(this.getTheme().name,this.id);Pe(e)}updateBlockStyles_(e){for(let t=0,r;r=e[t];t++){const a=r.getStyleName();if(a){const d=r;d.setStyle(a),d.mutator&&d.mutator.updateBlockStyle()}}}getInverseScreenCTM(){if(this.inverseScreenCTMDirty){const e=this.getParentSvg().getScreenCTM();e&&(this.inverseScreenCTM=e.inverse(),this.inverseScreenCTMDirty=false)}return this.inverseScreenCTM}updateInverseScreenCTM(){this.inverseScreenCTMDirty=true}isVisible(){return this.isVisible_}getSvgXY(e){let t=0,r=0,a=1;(le(this.getCanvas(),e)||le(this.getBubbleCanvas(),e))&&(a=this.scale);do{const d=Ji(e);(e===this.getCanvas()||e===this.getBubbleCanvas())&&(a=1),t+=d.x*a,r+=d.y*a,e=e.parentNode}while(e&&e!==this.getParentSvg());return new Oe(t,r)}getCachedParentSvgSize(){const e=this.cachedParentSvgSize;return new Ss(e.width,e.height)}getOriginOffsetInPixels(){return vc(this.getCanvas())}getInjectionDiv(){if(!this.injectionDiv){let e=this.svgGroup_;for(;e;){if((" "+(e.getAttribute("class")||"")+" ").indexOf(" injectionDiv ")!==-1){this.injectionDiv=e;break}e=e.parentNode}}return this.injectionDiv}getBlockCanvas(){return this.svgBlockCanvas_}setResizeHandlerWrapper(e){this.resizeHandlerWrapper=e}createDom(e){return this.svgGroup_=H(ee.G,{class:"blocklyWorkspace"}),e&&(this.svgBackground_=H(ee.RECT,{height:"100%",width:"100%",class:e},this.svgGroup_),e==="blocklyMainBackground"&&this.grid?this.svgBackground_.style.fill="url(#"+this.grid.getPatternId()+")":this.themeManager_.subscribe(this.svgBackground_,"workspaceBackgroundColour","fill")),this.svgBlockCanvas_=H(ee.G,{class:"blocklyBlockCanvas"},this.svgGroup_),this.svgBubbleCanvas_=H(ee.G,{class:"blocklyBubbleCanvas"},this.svgGroup_),this.isFlyout||(S(this.svgGroup_,"pointerdown",this,this.onMouseDown_,false),document.body.addEventListener("wheel",function(){}),S(this.svgGroup_,"wheel",this,this.onMouseWheel_)),this.options.hasCategories&&(this.toolbox_=new(si(Te.TOOLBOX,this.options,true))(this)),this.grid&&this.grid.update(this.scale),this.recordDragTargets(),(e=si(Te.CURSOR,this.options))&&this.markerManager.setCursor(new e),this.renderer.createDom(this.svgGroup_,this.getTheme()),this.svgGroup_}dispose(){if(this.rendered=false,this.currentGesture_&&this.currentGesture_.cancel(),this.svgGroup_&&B(this.svgGroup_),this.toolbox_&&(this.toolbox_.dispose(),this.toolbox_=null),this.flyout&&(this.flyout.dispose(),this.flyout=null),this.trashcan&&(this.trashcan.dispose(),this.trashcan=null),this.scrollbar&&(this.scrollbar.dispose(),this.scrollbar=null),this.zoomControls_&&this.zoomControls_.dispose(),this.audioManager&&this.audioManager.dispose(),this.grid&&(this.grid=null),this.renderer.dispose(),this.markerManager&&this.markerManager.dispose(),super.dispose(),this.themeManager_&&(this.themeManager_.unsubscribeWorkspace(this),this.themeManager_.unsubscribe(this.svgBackground_),this.options.parentWorkspace||this.themeManager_.dispose()),this.connectionDBList.length=0,this.toolboxCategoryCallbacks.clear(),this.flyoutButtonCallbacks.clear(),!this.options.parentWorkspace){const e=this.getParentSvg();e&&e.parentNode&&B(e.parentNode)}this.resizeHandlerWrapper&&(g(this.resizeHandlerWrapper),this.resizeHandlerWrapper=null)}addTrashcan(){this.trashcan=ln.newTrashcan(this);const e=this.trashcan.createDom();this.svgGroup_.insertBefore(e,this.svgBlockCanvas_)}static newTrashcan(e){throw Error("The implementation of newTrashcan should be monkey-patched in by blockly.ts")}addZoomControls(){this.zoomControls_=new mb(this);const e=this.zoomControls_.createDom();this.svgGroup_.appendChild(e)}addFlyout(e){const t=new on({parentWorkspace:this,rtl:this.RTL,oneBasedIndex:this.options.oneBasedIndex,horizontalLayout:this.horizontalLayout,renderer:this.options.renderer,rendererOverrides:this.options.rendererOverrides,move:{scrollbars:true}});return t.toolboxPosition=this.options.toolboxPosition,this.flyout=this.horizontalLayout?new(si(Te.FLYOUTS_HORIZONTAL_TOOLBOX,this.options,true))(t):new(si(Te.FLYOUTS_VERTICAL_TOOLBOX,this.options,true))(t),this.flyout.autoClose=false,this.flyout.getWorkspace().setVisible(true),this.flyout.createDom(e)}getFlyout(e){return this.flyout||e?this.flyout:this.toolbox_?this.toolbox_.getFlyout():null}getToolbox(){return this.toolbox_}updateScreenCalculations_(){this.updateInverseScreenCTM(),this.recordDragTargets()}resizeContents(){this.resizesEnabled&&this.rendered&&(this.scrollbar&&this.scrollbar.resize(),this.updateInverseScreenCTM())}resize(){this.toolbox_&&this.toolbox_.position(),this.flyout&&this.flyout.position();const e=this.componentManager.getComponents($s.Capability.POSITIONABLE,true),t=this.getMetricsManager().getUiMetrics(),r=[];for(let a=0,d;d=e[a];a++){d.position(t,r);const C=d.getBoundingRectangle();C&&r.push(C)}this.scrollbar&&this.scrollbar.resize(),this.updateScreenCalculations_()}updateScreenCalculationsIfScrolled(){const e=Nh();Oe.equals(this.lastRecordedPageScroll,e)||(this.lastRecordedPageScroll=e,this.updateScreenCalculations_())}getCanvas(){return this.svgBlockCanvas_}setCachedParentSvgSize(e,t){const r=this.getParentSvg();e!=null&&(this.cachedParentSvgSize.width=e,r.setAttribute("data-cached-width",e.toString())),t!=null&&(this.cachedParentSvgSize.height=t,r.setAttribute("data-cached-height",t.toString()))}getBubbleCanvas(){return this.svgBubbleCanvas_}getParentSvg(){if(!this.cachedParentSvg){let e=this.svgGroup_;for(;e;){if(e.tagName==="svg"){this.cachedParentSvg=e;break}e=e.parentNode}}return this.cachedParentSvg}maybeFireViewportChangeEvent(){if(ls()){var e=this.scale,t=-this.scrollY,r=-this.scrollX;if(!(e===this.oldScale&&1>Math.abs(t-this.oldTop)&&1>Math.abs(r-this.oldLeft))){var a=new(Re(Kr))(t,r,e,this.id,this.oldScale);this.oldScale=e,this.oldTop=t,this.oldLeft=r,Pe(a)}}}translate(e,t){if(this.useWorkspaceDragSurface&&this.isDragSurfaceActive){var r;(r=this.workspaceDragSurface)==null||r.translateSurface(e,t)}else r="translate("+e+","+t+") scale("+this.scale+")",this.svgBlockCanvas_.setAttribute("transform",r),this.svgBubbleCanvas_.setAttribute("transform",r);this.blockDragSurface&&this.blockDragSurface.translateAndScaleGroup(e,t,this.scale),this.grid&&this.grid.moveTo(e,t),this.maybeFireViewportChangeEvent()}resetDragSurface(){if(this.useWorkspaceDragSurface){this.isDragSurfaceActive=false;var e=this.workspaceDragSurface.getSurfaceTranslation();this.workspaceDragSurface.clearAndHide(this.svgGroup_),e="translate("+e.x+","+e.y+") scale("+this.scale+")",this.svgBlockCanvas_.setAttribute("transform",e),this.svgBubbleCanvas_.setAttribute("transform",e)}}setupDragSurface(){if(this.useWorkspaceDragSurface&&!this.isDragSurfaceActive){this.isDragSurfaceActive=true;var e=this.svgBlockCanvas_.previousSibling,t,r=parseInt((t=this.getParentSvg().getAttribute("width"))!=null?t:"0"),a;t=parseInt((a=this.getParentSvg().getAttribute("height"))!=null?a:"0"),a=Ji(this.getCanvas()),this.workspaceDragSurface.setContentsAndShow(this.getCanvas(),this.getBubbleCanvas(),e,r,t,this.scale),this.workspaceDragSurface.translateSurface(a.x,a.y)}}getBlockDragSurface(){return this.blockDragSurface}getWidth(){const e=this.getMetrics();return e?e.viewWidth/this.scale:0}setVisible(e){if(this.isVisible_=e,this.svgGroup_)if(this.scrollbar&&this.scrollbar.setContainerVisible(e),this.getFlyout()&&this.getFlyout().setContainerVisible(e),this.getParentSvg().style.display=e?"block":"none",this.toolbox_&&this.toolbox_.setVisible(e),e){e=this.getAllBlocks(false);for(let t=e.length-1;0<=t;t--)e[t].markDirty();this.render(),this.toolbox_&&this.toolbox_.position()}else this.hideChaff(true)}render(){for(var e=this.getAllBlocks(false),t=e.length-1;0<=t;t--)e[t].render(false);if(this.currentGesture_)for(e=this.currentGesture_.getInsertionMarkers(),t=0;t<e.length;t++)e[t].render(false);this.markerManager.updateMarkers()}highlightBlock(e,t){if(t===void 0){for(let r=0,a;a=this.highlightedBlocks[r];r++)a.setHighlighted(false);this.highlightedBlocks.length=0}(e=e?this.getBlockById(e):null)&&((t=t===void 0||t)?this.highlightedBlocks.indexOf(e)===-1&&this.highlightedBlocks.push(e):ni(this.highlightedBlocks,e),e.setHighlighted(t))}paste(e){if(!this.rendered||!e.type&&!e.tagName)return null;this.currentGesture_&&this.currentGesture_.cancel();const t=Ft();return t||He(true),e=e.type?this.pasteBlock_(null,e):e.tagName.toLowerCase()==="comment"?this.pasteWorkspaceComment_(e):this.pasteBlock_(e,null),He(t),e}pasteBlock_(e,t){Zt();let r;try{let a=0,d=0;if(e){r=Co(e,this);let C;a=parseInt((C=e.getAttribute("x"))!=null?C:"0"),this.RTL&&(a=-a);let D;d=parseInt((D=e.getAttribute("y"))!=null?D:"0")}else t&&(r=Hr(t,this),a=t.x||10,this.RTL&&(a=this.getWidth()-a),d=t.y||10);if(!isNaN(a)&&!isNaN(d)){let C;do{C=false;const D=this.getAllBlocks(false);for(let Y=0,pe;pe=D[Y];Y++){const we=pe.getRelativeToSurfaceXY();if(1>=Math.abs(a-we.x)&&1>=Math.abs(d-we.y)){C=true;break}}if(!C){const Y=r.getConnections_(false);for(let pe=0,we;we=Y[pe];pe++)if(we.closest(i.config$$module$build$src$core$config.snapRadius,new Oe(a,d)).connection){C=true;break}}C&&(a=this.RTL?a-i.config$$module$build$src$core$config.snapRadius:a+i.config$$module$build$src$core$config.snapRadius,d+=2*i.config$$module$build$src$core$config.snapRadius)}while(C);r.moveTo(new Oe(a,d))}}finally{ss()}return ls()&&!r.isShadow()&&Pe(new(Re(ks))(r)),r.select(),r}pasteWorkspaceComment_(e){Zt();let t;try{t=Fs.fromXmlRendered(e,this);let r,a=parseInt((r=e.getAttribute("x"))!=null?r:"0"),d,C=parseInt((d=e.getAttribute("y"))!=null?d:"0");isNaN(a)||isNaN(C)||(this.RTL&&(a=-a),t.moveBy(a+50,C+50))}finally{ss()}return ls()&&$n.fireCreateEvent(t),t.select(),t}refreshToolboxSelection(){const e=this.isFlyout?this.targetWorkspace:this;e&&!e.currentGesture_&&e.toolbox_&&e.toolbox_.getFlyout()&&e.toolbox_.refreshSelection()}renameVariableById(e,t){super.renameVariableById(e,t),this.refreshToolboxSelection()}deleteVariableById(e){super.deleteVariableById(e),this.refreshToolboxSelection()}createVariable(e,t,r){return e=super.createVariable(e,t,r),this.refreshToolboxSelection(),e}recordDragTargets(){const e=this.componentManager.getComponents($s.Capability.DRAG_TARGET,true);this.dragTargetAreas=[];for(let t=0,r;r=e[t];t++){const a=r.getClientRect();a&&this.dragTargetAreas.push({component:r,clientRect:a})}}newBlock(e,t){throw Error("The implementation of newBlock should be monkey-patched in by blockly.ts")}getDragTarget(e){for(let t=0,r;r=this.dragTargetAreas[t];t++)if(r.clientRect.contains(e.clientX,e.clientY))return r.component;return null}onMouseDown_(e){const t=this.getGesture(e);t&&t.handleWsStart(e,this)}startDrag(e,t){e=b(e,this.getParentSvg(),this.getInverseScreenCTM()),e.x/=this.scale,e.y/=this.scale,this.dragDeltaXY=Oe.difference(t,e)}moveDrag(e){return e=b(e,this.getParentSvg(),this.getInverseScreenCTM()),e.x/=this.scale,e.y/=this.scale,Oe.sum(this.dragDeltaXY,e)}isDragging(){return this.currentGesture_!==null&&this.currentGesture_.isDragging()}isDraggable(){return this.options.moveOptions&&this.options.moveOptions.drag}isMovable(){return this.options.moveOptions&&!!this.options.moveOptions.scrollbars||this.options.moveOptions&&this.options.moveOptions.wheel||this.options.moveOptions&&this.options.moveOptions.drag||this.options.zoomOptions&&this.options.zoomOptions.wheel||this.options.zoomOptions&&this.options.zoomOptions.pinch}isMovableHorizontally(){const e=!!this.scrollbar;return this.isMovable()&&(!e||e&&this.scrollbar.canScrollHorizontally())}isMovableVertically(){const e=!!this.scrollbar;return this.isMovable()&&(!e||e&&this.scrollbar.canScrollVertically())}onMouseWheel_(e){if(yn.inProgress())e.preventDefault(),e.stopPropagation();else{var t=this.options.zoomOptions&&this.options.zoomOptions.wheel,r=this.options.moveOptions&&this.options.moveOptions.wheel;if(t||r){var a=R(e);if(pd)var d=e.metaKey;t&&(e.ctrlKey||d||!r)?(a=-a.y/50,t=b(e,this.getParentSvg(),this.getInverseScreenCTM()),this.zoom(t.x,t.y,a)):(t=this.scrollX-a.x,r=this.scrollY-a.y,e.shiftKey&&!a.x&&(t=this.scrollX-a.y,r=this.scrollY),this.scroll(t,r)),e.preventDefault()}}}getBlocksBoundingBox(){const e=this.getTopBoundedElements();if(!e.length)return new ts(0,0,0,0);const t=e[0].getBoundingRectangle();for(let a=1;a<e.length;a++){var r=e[a];r.isInsertionMarker&&r.isInsertionMarker()||(r=r.getBoundingRectangle(),r.top<t.top&&(t.top=r.top),r.bottom>t.bottom&&(t.bottom=r.bottom),r.left<t.left&&(t.left=r.left),r.right>t.right&&(t.right=r.right))}return t}cleanUp(){this.setResizesEnabled(false),He(true);const e=this.getTopBlocks(true);let t=0;for(let r=0,a;a=e[r];r++){if(!a.isMovable())continue;const d=a.getRelativeToSurfaceXY();a.moveBy(-d.x,t-d.y),a.snapToGrid(),t=a.getRelativeToSurfaceXY().y+a.getHeightWidth().height+this.renderer.getConstants().MIN_BLOCK_HEIGHT}He(false),this.setResizesEnabled(true)}showContextMenu(e){if(!this.options.readOnly&&!this.isFlyout){var t=It.registry.getContextMenuOptions(It.ScopeType.WORKSPACE,{workspace:this});this.configureContextMenu&&this.configureContextMenu(t,e),Lc(e,t,this.RTL)}}updateToolbox(e){if(e=Ic(e)){if(!this.options.languageTree)throw Error("Existing toolbox is null.  Can't create new toolbox.");if(Wh(e)){if(!this.toolbox_)throw Error("Existing toolbox has no categories.  Can't change mode.");this.options.languageTree=e,this.toolbox_.render(e)}else{if(!this.flyout)throw Error("Existing toolbox has categories.  Can't change mode.");this.options.languageTree=e,this.flyout.show(e)}}else if(this.options.languageTree)throw Error("Can't nullify an existing toolbox.")}markFocused(){this.options.parentWorkspace?this.options.parentWorkspace.markFocused():(x(this),this.setBrowserFocus())}setBrowserFocus(){document.activeElement&&document.activeElement instanceof HTMLElement&&document.activeElement.blur();try{this.getParentSvg().focus({preventScroll:true})}catch{try{this.getParentSvg().parentElement.setActive()}catch{this.getParentSvg().parentElement.focus({preventScroll:true})}}}zoom(e,t,r){r=Math.pow(this.options.zoomOptions.scaleSpeed,r);const a=this.scale*r;if(this.scale!==a){a>this.options.zoomOptions.maxScale?r=this.options.zoomOptions.maxScale/this.scale:a<this.options.zoomOptions.minScale&&(r=this.options.zoomOptions.minScale/this.scale);var d=this.getCanvas().getCTM(),C=this.getParentSvg().createSVGPoint();C.x=e,C.y=t,C=C.matrixTransform(d.inverse()),e=C.x,t=C.y,d=d.translate(e*(1-r),t*(1-r)).scale(r),this.scrollX=d.e,this.scrollY=d.f,this.setScale(a)}}zoomCenter(e){var t=this.getMetrics();let r;this.flyout?(r=t.svgWidth?t.svgWidth/2:0,t=t.svgHeight?t.svgHeight/2:0):(r=t.viewWidth/2+t.absoluteLeft,t=t.viewHeight/2+t.absoluteTop),this.zoom(r,t,e)}zoomToFit(){if(this.isMovable()){var e=this.getMetrics(),t=e.viewWidth;e=e.viewHeight;var r=this.getBlocksBoundingBox(),a=2*F0,d=r.right-r.left+a;if(r=r.bottom-r.top+a,d){this.flyout&&(this.horizontalLayout?(e+=this.flyout.getHeight(),r+=this.flyout.getHeight()/this.scale):(t+=this.flyout.getWidth(),d+=this.flyout.getWidth()/this.scale)),t/=d,e/=r,Zt();try{this.setScale(Math.min(t,e)),this.scrollCenter()}finally{ss()}this.maybeFireViewportChangeEvent()}}else console.warn("Tried to move a non-movable workspace. This could result in blocks becoming inaccessible.")}beginCanvasTransition(){ie(this.svgBlockCanvas_,"blocklyCanvasTransitioning"),ie(this.svgBubbleCanvas_,"blocklyCanvasTransitioning")}endCanvasTransition(){he(this.svgBlockCanvas_,"blocklyCanvasTransitioning"),he(this.svgBubbleCanvas_,"blocklyCanvasTransitioning")}scrollCenter(){if(this.isMovable()){var e=this.getMetrics(),t=(e.scrollWidth-e.viewWidth)/2,r=(e.scrollHeight-e.viewHeight)/2;t=-t-e.scrollLeft,r=-r-e.scrollTop,this.scroll(t,r)}else console.warn("Tried to move a non-movable workspace. This could result in blocks becoming inaccessible.")}centerOnBlock(e){if(this.isMovable()){if(e=e?this.getBlockById(e):null){var t=e.getRelativeToSurfaceXY(),r=e.getHeightWidth(),a=this.scale;e=(t.x+(this.RTL?-1:1)*r.width/2)*a,t=(t.y+r.height/2)*a,r=this.getMetrics(),this.scroll(-(e-r.viewWidth/2),-(t-r.viewHeight/2))}}else console.warn("Tried to move a non-movable workspace. This could result in blocks becoming inaccessible.")}setScale(e){this.options.zoomOptions.maxScale&&e>this.options.zoomOptions.maxScale?e=this.options.zoomOptions.maxScale:this.options.zoomOptions.minScale&&e<this.options.zoomOptions.minScale&&(e=this.options.zoomOptions.minScale),this.scale=e,this.hideChaff(false),(e=this.getFlyout(false))&&e.isVisible()&&(e.reflow(),this.recordDragTargets()),this.grid&&this.grid.update(this.scale),e=this.getMetrics(),this.scrollX-=e.absoluteLeft,this.scrollY-=e.absoluteTop,e.viewLeft+=e.absoluteLeft,e.viewTop+=e.absoluteTop,this.scroll(this.scrollX,this.scrollY),this.scrollbar&&(this.flyout?this.scrollbar.resizeView(e):this.scrollbar.resizeContent(e))}getScale(){return this.options.parentWorkspace?this.options.parentWorkspace.getScale():this.scale}scroll(e,t){this.hideChaff(true);const r=this.getMetrics();e=Math.min(e,-r.scrollLeft),t=Math.min(t,-r.scrollTop);const a=r.scrollTop+Math.max(0,r.scrollHeight-r.viewHeight);e=Math.max(e,-(r.scrollLeft+Math.max(0,r.scrollWidth-r.viewWidth))),t=Math.max(t,-a),this.scrollX=e,this.scrollY=t,this.scrollbar&&this.scrollbar.set(-(e+r.scrollLeft),-(t+r.scrollTop),false),e+=r.absoluteLeft,t+=r.absoluteTop,this.translate(e,t)}getBlockById(e){return super.getBlockById(e)}getAllBlocks(e){return super.getAllBlocks(e)}getTopBlocks(e){return super.getTopBlocks(e)}addTopBlock(e){this.addTopBoundedElement(e),super.addTopBlock(e)}removeTopBlock(e){this.removeTopBoundedElement(e),super.removeTopBlock(e)}addTopComment(e){this.addTopBoundedElement(e),super.addTopComment(e)}removeTopComment(e){this.removeTopBoundedElement(e),super.removeTopComment(e)}addTopBoundedElement(e){this.topBoundedElements.push(e)}removeTopBoundedElement(e){ni(this.topBoundedElements,e)}getTopBoundedElements(){return[].concat(this.topBoundedElements)}setResizesEnabled(e){const t=!this.resizesEnabled&&e;this.resizesEnabled=e,t&&this.resizeContents()}clear(){this.setResizesEnabled(false),super.clear(),this.topBoundedElements=[],this.setResizesEnabled(true)}registerButtonCallback(e,t){if(typeof t!="function")throw TypeError("Button callbacks must be functions.");this.flyoutButtonCallbacks.set(e,t)}getButtonCallback(e){let t;return(t=this.flyoutButtonCallbacks.get(e))!=null?t:null}removeButtonCallback(e){this.flyoutButtonCallbacks.delete(e)}registerToolboxCategoryCallback(e,t){if(typeof t!="function")throw TypeError("Toolbox category callbacks must be functions.");this.toolboxCategoryCallbacks.set(e,t)}getToolboxCategoryCallback(e){return this.toolboxCategoryCallbacks.get(e)||null}removeToolboxCategoryCallback(e){this.toolboxCategoryCallbacks.delete(e)}getGesture(e){const t=e.type==="pointerdown",r=this.currentGesture_;return r?t&&r.hasStarted()?(console.warn("Tried to start the same gesture twice."),r.cancel(),null):r:t?this.currentGesture_=new yn(e,this):null}clearGesture(){this.currentGesture_=null}cancelCurrentGesture(){this.currentGesture_&&this.currentGesture_.cancel()}getAudioManager(){return this.audioManager}getGrid(){return this.grid}hideChaff(e){Fr(),En(),Lt();const t=!!e;this.getComponentManager().getComponents($s.Capability.AUTOHIDEABLE,true).forEach(r=>r.autoHide(t))}static setTopLevelWorkspaceMetrics_(e){const t=this.getMetrics();typeof e.x=="number"&&(this.scrollX=-(t.scrollLeft+(t.scrollWidth-t.viewWidth)*e.x)),typeof e.y=="number"&&(this.scrollY=-(t.scrollTop+(t.scrollHeight-t.viewHeight)*e.y)),this.translate(this.scrollX+t.absoluteLeft,this.scrollY+t.absoluteTop)}},C_={};C_.load=VO,C_.save=HO;var Eb=class{constructor(){this.priority=Hv}save(e){const t=[];for(const r of e.getAllVariables())e={name:r.name,id:r.getId()},r.type&&(e.type=r.type),t.push(e);return t.length?t:null}load(e,t){for(const r of e)t.createVariable(r.name,r.type,r.id)}clear(e){e.getVariableMap().clear()}};qh("variables",new Eb);var vb={};vb.VariableSerializer=Eb;var bb=class{constructor(e,t){this.procedureModelClass=e,this.parameterModelClass=t,this.priority=Vv}save(e){return e.getProcedureMap().getProcedures().map(t=>rd(t))}load(e,t){const r=t.getProcedureMap();for(const a of e)r.add(ad(this.procedureModelClass,this.parameterModelClass,a,t))}clear(e){e.getProcedureMap().clear()}},G0=new bb(El,sa),no={};no.ProcedureSerializer=bb,no.loadParameter=ld,no.loadProcedure=ad,no.observableProcedureSerializer=G0,no.saveParameter=od,no.saveProcedure=rd;var H0={blocks:ll,exceptions:Ko,priorities:du,procedures:no,registry:Xd,variables:vb,workspaces:C_},Tb=class extends $l{constructor(){super(),this.GRID_UNIT=4,this.CURSOR_COLOUR="#ffa200",this.CURSOR_RADIUS=5,this.JAGGED_TEETH_WIDTH=this.JAGGED_TEETH_HEIGHT=0,this.START_HAT_HEIGHT=22,this.START_HAT_WIDTH=96,this.SHAPES={HEXAGONAL:1,ROUND:2,SQUARE:3,PUZZLE:4,NOTCH:5},this.SHAPE_IN_SHAPE_PADDING={1:{0:5*this.GRID_UNIT,1:2*this.GRID_UNIT,2:5*this.GRID_UNIT,3:5*this.GRID_UNIT},2:{0:3*this.GRID_UNIT,1:3*this.GRID_UNIT,2:1*this.GRID_UNIT,3:2*this.GRID_UNIT},3:{0:2*this.GRID_UNIT,1:2*this.GRID_UNIT,2:2*this.GRID_UNIT,3:2*this.GRID_UNIT}},this.FULL_BLOCK_FIELDS=true,this.FIELD_TEXT_FONTWEIGHT="bold",this.FIELD_TEXT_FONTFAMILY='"Helvetica Neue", "Segoe UI", Helvetica, sans-serif',this.FIELD_COLOUR_FULL_BLOCK=this.FIELD_TEXTINPUT_BOX_SHADOW=this.FIELD_DROPDOWN_SVG_ARROW=this.FIELD_DROPDOWN_COLOURED_DIV=this.FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW=true,this.SELECTED_GLOW_COLOUR="#fff200",this.SELECTED_GLOW_SIZE=.5,this.REPLACEMENT_GLOW_COLOUR="#fff200",this.REPLACEMENT_GLOW_SIZE=2,this.selectedGlowFilterId="",this.selectedGlowFilter_=null,this.replacementGlowFilterId="",this.SQUARED=this.ROUNDED=this.HEXAGONAL=this.replacementGlowFilter_=null,this.SMALL_PADDING=this.GRID_UNIT,this.MEDIUM_PADDING=2*this.GRID_UNIT,this.MEDIUM_LARGE_PADDING=3*this.GRID_UNIT,this.LARGE_PADDING=4*this.GRID_UNIT,this.CORNER_RADIUS=1*this.GRID_UNIT,this.NOTCH_WIDTH=9*this.GRID_UNIT,this.NOTCH_HEIGHT=2*this.GRID_UNIT,this.STATEMENT_INPUT_NOTCH_OFFSET=this.NOTCH_OFFSET_LEFT=3*this.GRID_UNIT,this.MIN_BLOCK_WIDTH=2*this.GRID_UNIT,this.MIN_BLOCK_HEIGHT=12*this.GRID_UNIT,this.EMPTY_STATEMENT_INPUT_HEIGHT=6*this.GRID_UNIT,this.TOP_ROW_MIN_HEIGHT=this.CORNER_RADIUS,this.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT=this.LARGE_PADDING,this.BOTTOM_ROW_MIN_HEIGHT=this.CORNER_RADIUS,this.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT=6*this.GRID_UNIT,this.STATEMENT_BOTTOM_SPACER=-this.NOTCH_HEIGHT,this.STATEMENT_INPUT_SPACER_MIN_WIDTH=40*this.GRID_UNIT,this.STATEMENT_INPUT_PADDING_LEFT=4*this.GRID_UNIT,this.EMPTY_INLINE_INPUT_PADDING=4*this.GRID_UNIT,this.EMPTY_INLINE_INPUT_HEIGHT=8*this.GRID_UNIT,this.DUMMY_INPUT_MIN_HEIGHT=8*this.GRID_UNIT,this.DUMMY_INPUT_SHADOW_MIN_HEIGHT=6*this.GRID_UNIT,this.CURSOR_WS_WIDTH=20*this.GRID_UNIT,this.FIELD_TEXT_FONTSIZE=3*this.GRID_UNIT,this.FIELD_BORDER_RECT_RADIUS=this.CORNER_RADIUS,this.FIELD_BORDER_RECT_X_PADDING=2*this.GRID_UNIT,this.FIELD_BORDER_RECT_Y_PADDING=1.625*this.GRID_UNIT,this.FIELD_BORDER_RECT_HEIGHT=8*this.GRID_UNIT,this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT=8*this.GRID_UNIT,this.FIELD_DROPDOWN_SVG_ARROW_PADDING=this.FIELD_BORDER_RECT_X_PADDING,this.FIELD_COLOUR_DEFAULT_WIDTH=2*this.GRID_UNIT,this.FIELD_COLOUR_DEFAULT_HEIGHT=4*this.GRID_UNIT,this.FIELD_CHECKBOX_X_OFFSET=1*this.GRID_UNIT,this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH=12*this.GRID_UNIT}setFontConstants_(e){super.setFontConstants_(e),this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT=this.FIELD_BORDER_RECT_HEIGHT=this.FIELD_TEXT_HEIGHT+2*this.FIELD_BORDER_RECT_Y_PADDING}init(){super.init(),this.HEXAGONAL=this.makeHexagonal(),this.ROUNDED=this.makeRounded(),this.SQUARED=this.makeSquared(),this.STATEMENT_INPUT_NOTCH_OFFSET=this.NOTCH_OFFSET_LEFT+this.INSIDE_CORNERS.rightWidth}setDynamicProperties_(e){super.setDynamicProperties_(e),this.SELECTED_GLOW_COLOUR=e.getComponentStyle("selectedGlowColour")||this.SELECTED_GLOW_COLOUR;const t=Number(e.getComponentStyle("selectedGlowSize"));this.SELECTED_GLOW_SIZE=t&&!isNaN(t)?t:this.SELECTED_GLOW_SIZE,this.REPLACEMENT_GLOW_COLOUR=e.getComponentStyle("replacementGlowColour")||this.REPLACEMENT_GLOW_COLOUR,this.REPLACEMENT_GLOW_SIZE=(e=Number(e.getComponentStyle("replacementGlowSize")))&&!isNaN(e)?e:this.REPLACEMENT_GLOW_SIZE}dispose(){super.dispose(),this.selectedGlowFilter_&&B(this.selectedGlowFilter_),this.replacementGlowFilter_&&B(this.replacementGlowFilter_)}makeStartHat(){const e=this.START_HAT_HEIGHT,t=this.START_HAT_WIDTH,r=Si("c",[Ve(25,-e),Ve(71,-e),Ve(t,0)]);return{height:e,width:t,path:r}}makeHexagonal(){function e(r,a,d){var C=r/2;return C=C>t?t:C,d=d?-1:1,r=(a?-1:1)*r/2,Dn(-d*C,r)+Dn(d*C,r)}const t=this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH;return{type:this.SHAPES.HEXAGONAL,isDynamic:true,width(r){return r/=2,r>t?t:r},height(r){return r},connectionOffsetY(r){return r/2},connectionOffsetX(r){return-r},pathDown(r){return e(r,false,false)},pathUp(r){return e(r,true,false)},pathRightDown(r){return e(r,false,true)},pathRightUp(r){return e(r,false,true)}}}makeRounded(){function e(a,d,C){const D=a>r?a-r:0;return a=(a>r?r:a)/2,cs("a","0 0,1",a,Ve((d?-1:1)*a,(d?-1:1)*a))+Ne("v",(C?1:-1)*D)+cs("a","0 0,1",a,Ve((d?1:-1)*a,(d?-1:1)*a))}const t=this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH,r=2*t;return{type:this.SHAPES.ROUND,isDynamic:true,width(a){return a/=2,a>t?t:a},height(a){return a},connectionOffsetY(a){return a/2},connectionOffsetX(a){return-a},pathDown(a){return e(a,false,false)},pathUp(a){return e(a,true,false)},pathRightDown(a){return e(a,false,true)},pathRightUp(a){return e(a,false,true)}}}makeSquared(){function e(r,a,d){return r-=2*t,cs("a","0 0,1",t,Ve((a?-1:1)*t,(a?-1:1)*t))+Ne("v",(d?1:-1)*r)+cs("a","0 0,1",t,Ve((a?1:-1)*t,(a?-1:1)*t))}const t=this.CORNER_RADIUS;return{type:this.SHAPES.SQUARE,isDynamic:true,width(r){return t},height(r){return r},connectionOffsetY(r){return r/2},connectionOffsetX(r){return-r},pathDown(r){return e(r,false,false)},pathUp(r){return e(r,true,false)},pathRightDown(r){return e(r,false,true)},pathRightUp(r){return e(r,false,true)}}}shapeFor(e){let t=e.getCheck();switch(!t&&e.targetConnection&&(t=e.targetConnection.getCheck()),e.type){case Le.INPUT_VALUE:case Le.OUTPUT_VALUE:if(e=e.getSourceBlock().getOutputShape(),e!==null)switch(e){case this.SHAPES.HEXAGONAL:return this.HEXAGONAL;case this.SHAPES.ROUND:return this.ROUNDED;case this.SHAPES.SQUARE:return this.SQUARED}return t&&t.indexOf("Boolean")!==-1?this.HEXAGONAL:t&&t.indexOf("Number")!==-1?this.ROUNDED:(t&&t.indexOf("String"),this.ROUNDED);case Le.PREVIOUS_STATEMENT:case Le.NEXT_STATEMENT:return this.NOTCH;default:throw Error("Unknown type")}}makeNotch(){function e(we){return Si("c",[Ve(we*d/2,0),Ve(we*d*3/4,D/2),Ve(we*d,D)])+Ba([Ve(we*d,C)])+Si("c",[Ve(we*d/4,D/2),Ve(we*d/2,D),Ve(we*d,D)])+Ne("h",we*a)+Si("c",[Ve(we*d/2,0),Ve(we*d*3/4,-(D/2)),Ve(we*d,-D)])+Ba([Ve(we*d,-C)])+Si("c",[Ve(we*d/4,-(D/2)),Ve(we*d/2,-D),Ve(we*d,-D)])}const t=this.NOTCH_WIDTH,r=this.NOTCH_HEIGHT,a=t/3,d=a/3,C=r/2,D=C/2,Y=e(1),pe=e(-1);return{type:this.SHAPES.NOTCH,width:t,height:r,pathLeft:Y,pathRight:pe}}makeInsideCorners(){const e=this.CORNER_RADIUS,t=cs("a","0 0,0",e,Ve(-e,e)),r=cs("a","0 0,1",e,Ve(-e,e)),a=cs("a","0 0,0",e,Ve(e,e)),d=cs("a","0 0,1",e,Ve(e,e));return{width:e,height:e,pathTop:t,pathBottom:a,rightWidth:e,rightHeight:e,pathTopRight:r,pathBottomRight:d}}generateSecondaryColour_(e){return Oo("#000",e,.15)||e}generateTertiaryColour_(e){return Oo("#000",e,.25)||e}createDom(e,t,r){super.createDom(e,t,r),e=H(ee.DEFS,{},e),t=H(ee.FILTER,{id:"blocklySelectedGlowFilter"+this.randomIdentifier,height:"160%",width:"180%",y:"-30%",x:"-40%"},e),H(ee.FEGAUSSIANBLUR,{in:"SourceGraphic",stdDeviation:this.SELECTED_GLOW_SIZE},t),r=H(ee.FECOMPONENTTRANSFER,{result:"outBlur"},t),H(ee.FEFUNCA,{type:"table",tableValues:"0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"},r),H(ee.FEFLOOD,{"flood-color":this.SELECTED_GLOW_COLOUR,"flood-opacity":1,result:"outColor"},t),H(ee.FECOMPOSITE,{in:"outColor",in2:"outBlur",operator:"in",result:"outGlow"},t),this.selectedGlowFilterId=t.id,this.selectedGlowFilter_=t,e=H(ee.FILTER,{id:"blocklyReplacementGlowFilter"+this.randomIdentifier,height:"160%",width:"180%",y:"-30%",x:"-40%"},e),H(ee.FEGAUSSIANBLUR,{in:"SourceGraphic",stdDeviation:this.REPLACEMENT_GLOW_SIZE},e),t=H(ee.FECOMPONENTTRANSFER,{result:"outBlur"},e),H(ee.FEFUNCA,{type:"table",tableValues:"0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"},t),H(ee.FEFLOOD,{"flood-color":this.REPLACEMENT_GLOW_COLOUR,"flood-opacity":1,result:"outColor"},e),H(ee.FECOMPOSITE,{in:"outColor",in2:"outBlur",operator:"in",result:"outGlow"},e),H(ee.FECOMPOSITE,{in:"SourceGraphic",in2:"outGlow",operator:"over"},e),this.replacementGlowFilterId=e.id,this.replacementGlowFilter_=e}getCSS_(e){return[`${e} .blocklyText,`,`${e} .blocklyFlyoutLabelText {`,`font: ${this.FIELD_TEXT_FONTWEIGHT} ${this.FIELD_TEXT_FONTSIZE}pt ${this.FIELD_TEXT_FONTFAMILY};`,"}",`${e} .blocklyText {`,"fill: #fff;","}",`${e} .blocklyNonEditableText>rect:not(.blocklyDropdownRect),`,`${e} .blocklyEditableText>rect:not(.blocklyDropdownRect) {`,`fill: ${this.FIELD_BORDER_RECT_COLOUR};`,"}",`${e} .blocklyNonEditableText>text,`,`${e} .blocklyEditableText>text,`,`${e} .blocklyNonEditableText>g>text,`,`${e} .blocklyEditableText>g>text {`,"fill: #575E75;","}",`${e} .blocklyFlyoutLabelText {`,"fill: #575E75;","}",`${e} .blocklyText.blocklyBubbleText {`,"fill: #575E75;","}",`${e} .blocklyDraggable:not(.blocklyDisabled)`," .blocklyEditableText:not(.editing):hover>rect,",`${e} .blocklyDraggable:not(.blocklyDisabled)`," .blocklyEditableText:not(.editing):hover>.blocklyPath {","stroke: #fff;","stroke-width: 2;","}",`${e} .blocklyHtmlInput {`,`font-family: ${this.FIELD_TEXT_FONTFAMILY};`,`font-weight: ${this.FIELD_TEXT_FONTWEIGHT};`,"color: #575E75;","}",`${e} .blocklyDropdownText {`,"fill: #fff !important;","}",`${e}.blocklyWidgetDiv .goog-menuitem,`,`${e}.blocklyDropDownDiv .goog-menuitem {`,`font-family: ${this.FIELD_TEXT_FONTFAMILY};`,"}",`${e}.blocklyDropDownDiv .goog-menuitem-content {`,"color: #fff;","}",`${e} .blocklyHighlightedConnectionPath {`,`stroke: ${this.SELECTED_GLOW_COLOUR};`,"}",`${e} .blocklyDisabled > .blocklyOutlinePath {`,`fill: url(#blocklyDisabledPattern${this.randomIdentifier})`,"}",`${e} .blocklyInsertionMarker>.blocklyPath {`,`fill-opacity: ${this.INSERTION_MARKER_OPACITY};`,"stroke: none;","}"]}},Sb=class extends yl{constructor(e,t){super(e,t)}draw(){const e=this.block_.pathObject;if(e.beginDrawing(),this.hideHiddenIcons_(),this.drawOutline_(),this.drawInternals_(),e.setPath(this.outlinePath_+`
`+this.inlinePath_),this.info_.RTL&&e.flipRTL(),Mc()){let t,r;(t=this.block_)==null||(r=t.renderingDebugger)==null||r.drawDebug(this.block_,this.info_)}this.recordSizeOnBlock_(),this.info_.outputConnection&&(e.outputShapeType=this.info_.outputConnection.shape.type),e.endDrawing()}drawOutline_(){this.info_.outputConnection&&this.info_.outputConnection.isDynamicShape&&!this.info_.hasStatementInput&&!this.info_.bottomRow.hasNextConnection?(this.drawFlatTop_(),this.drawRightDynamicConnection_(),this.drawFlatBottom_(),this.drawLeftDynamicConnection_()):super.drawOutline_()}drawLeft_(){this.info_.outputConnection&&this.info_.outputConnection.isDynamicShape?this.drawLeftDynamicConnection_():super.drawLeft_()}drawRightSideRow_(e){if(!(0>=e.height))if(Q.isSpacer(e)&&(e.precedesStatement||e.followsStatement)){var t=this.constants_.INSIDE_CORNERS.rightHeight;t=e.height-(e.precedesStatement?t:0),this.outlinePath_+=(e.followsStatement?this.constants_.INSIDE_CORNERS.pathBottomRight:"")+(0<t?Ne("V",e.yPos+t):"")+(e.precedesStatement?this.constants_.INSIDE_CORNERS.pathTopRight:"")}else this.outlinePath_+=Ne("V",e.yPos+e.height)}drawRightDynamicConnection_(){if(!this.info_.outputConnection)throw Error("Cannot draw the output connection of a block that doesn't have one");this.outlinePath_+=this.info_.outputConnection.shape.pathRightDown(this.info_.outputConnection.height)}drawLeftDynamicConnection_(){if(!this.info_.outputConnection)throw Error("Cannot draw the output connection of a block that doesn't have one");this.positionOutputConnection_(),this.outlinePath_+=this.info_.outputConnection.shape.pathUp(this.info_.outputConnection.height),this.outlinePath_+="z"}drawFlatTop_(){const e=this.info_.topRow;this.positionPreviousConnection_(),this.outlinePath_+=Wt(e.xPos,this.info_.startY),this.outlinePath_+=Ne("h",e.width)}drawFlatBottom_(){const e=this.info_.bottomRow;this.positionNextConnection_(),this.outlinePath_+=Ne("V",e.baseline),this.outlinePath_+=Ne("h",-e.width)}drawInlineInput_(e){this.positionInlineInputConnection_(e);const t=e.input.name;if(!e.connectedBlock&&!this.info_.isInsertionMarker){var r=e.width-2*e.connectionWidth;e=Us(e.xPos+e.connectionWidth,e.centerline-e.height/2)+Ne("h",r)+e.shape.pathRightDown(e.height)+Ne("h",-r)+e.shape.pathUp(e.height)+"z",this.block_.pathObject.setOutlinePath(t,e)}}drawStatementInput_(e){var t=e.getLastInput();const r=t.xPos+t.notchOffset+t.shape.width,a=t.shape.pathRight+Ne("h",-(t.notchOffset-this.constants_.INSIDE_CORNERS.width))+this.constants_.INSIDE_CORNERS.pathTop,d=e.height-2*this.constants_.INSIDE_CORNERS.height;t=this.constants_.INSIDE_CORNERS.pathBottom+Ne("h",t.notchOffset-this.constants_.INSIDE_CORNERS.width)+(t.connectedBottomNextConnection?"":t.shape.pathLeft),this.outlinePath_+=Ne("H",r)+a+Ne("v",d)+t+Ne("H",e.xPos+e.width),this.positionStatementInputConnection_(e)}};i.FieldImage$$module$build$src$core$field_image=class extends pt{constructor(e,t,r,a,d,C,D){if(super(pt.SKIP_SETUP),this.imageElement_=this.clickHandler_=null,this.flipRtl_=this.isDirty_=this.EDITABLE=false,this.altText_="",r=Number(es(r)),t=Number(es(t)),isNaN(r)||isNaN(t))throw Error("Height and width values of an image field must cast to numbers.");if(0>=r||0>=t)throw Error("Height and width values of an image field must be greater than 0.");this.size_=new Ss(t,r+i.FieldImage$$module$build$src$core$field_image.Y_PADDING),this.imageHeight_=r,typeof d=="function"&&(this.clickHandler_=d),e!==pt.SKIP_SETUP&&(D?this.configure_(D):(this.flipRtl_=!!C,this.altText_=es(a)||""),this.setValue(es(e)))}configure_(e){super.configure_(e),e.flipRtl&&(this.flipRtl_=e.flipRtl),e.alt&&(this.altText_=es(e.alt))}initView(){this.imageElement_=H(ee.IMAGE,{height:this.imageHeight_+"px",width:this.size_.width+"px",alt:this.altText_},this.fieldGroup_),this.imageElement_.setAttributeNS(ai,"xlink:href",this.value_),this.clickHandler_&&(this.imageElement_.style.cursor="pointer")}updateSize_(){}doClassValidation_(e){return typeof e!="string"?null:e}doValueUpdate_(e){this.value_=e,this.imageElement_&&this.imageElement_.setAttributeNS(ai,"xlink:href",String(this.value_))}getFlipRtl(){return this.flipRtl_}setAlt(e){e!==this.altText_&&(this.altText_=e||"",this.imageElement_&&this.imageElement_.setAttribute("alt",this.altText_))}showEditor_(){this.clickHandler_&&this.clickHandler_(this)}setOnClickHandler(e){this.clickHandler_=e}getText_(){return this.altText_}static fromJson(e){if(!e.src||!e.width||!e.height)throw Error("src, width, and height values for an image field arerequired. The width and height must be non-zero.");return new this(e.src,e.width,e.height,void 0,void 0,void 0,e)}},i.FieldImage$$module$build$src$core$field_image.Y_PADDING=1,Pi("field_image",i.FieldImage$$module$build$src$core$field_image),i.FieldImage$$module$build$src$core$field_image.prototype.DEFAULT_VALUE="",i.FieldImage$$module$build$src$core$field_image;var Il=class extends pt{constructor(e,t,r){super(pt.SKIP_SETUP),this.spellcheck_=true,this.htmlInput_=null,this.isTextValid_=this.isBeingEdited_=false,this.onKeyInputWrapper_=this.onKeyDownWrapper_=null,this.fullBlockClickTarget_=false,this.workspace_=null,this.SERIALIZABLE=true,this.CURSOR="text",e!==pt.SKIP_SETUP&&(r&&this.configure_(r),this.setValue(e),t&&this.setValidator(t))}configure_(e){super.configure_(e),e.spellcheck!==void 0&&(this.spellcheck_=e.spellcheck)}initView(){const e=this.getSourceBlock();if(!e)throw new hs;if(this.getConstants().FULL_BLOCK_FIELDS){let t=0,r=0;for(let a=0,d;d=e.inputList[a];a++){for(let C=0;d.fieldRow[C];C++)t++;d.connection&&r++}this.fullBlockClickTarget_=1>=t&&e.outputConnection&&!r}else this.fullBlockClickTarget_=false;this.fullBlockClickTarget_?this.clickTarget_=this.sourceBlock_.getSvgRoot():this.createBorderRect_(),this.createTextElement_()}doClassValidation_(e){return e==null?null:String(e)}doValueInvalid_(e){this.isBeingEdited_&&(this.isDirty_=true,this.isTextValid_=false,e=this.value_,this.value_=this.htmlInput_.getAttribute("data-untyped-default-value"),this.sourceBlock_&&ls()&&Pe(new(Re(bs))(this.sourceBlock_,"field",this.name||null,e,this.value_)))}doValueUpdate_(e){this.isTextValid_=this.isDirty_=true,this.value_=e}applyColour(){if(this.sourceBlock_&&this.getConstants().FULL_BLOCK_FIELDS){var e=this.sourceBlock_;this.borderRect_?this.borderRect_.setAttribute("stroke",e.style.colourTertiary):e.pathObject.svgPath.setAttribute("fill",this.getConstants().FIELD_BORDER_RECT_COLOUR)}}render_(){if(super.render_(),this.isBeingEdited_){this.resizeEditor_();const e=this.htmlInput_;this.isTextValid_?(he(e,"blocklyInvalidInput"),Xt(e,Gt.INVALID,false)):(ie(e,"blocklyInvalidInput"),Xt(e,Gt.INVALID,true))}}setSpellcheck(e){e!==this.spellcheck_&&(this.spellcheck_=e,this.htmlInput_&&this.htmlInput_.setAttribute("spellcheck",this.spellcheck_))}showEditor_(e,t){this.workspace_=this.sourceBlock_.workspace,e=t||false,!e&&this.workspace_.options.modalInputs&&(gd||Gc||Lo)?this.showPromptEditor_():this.showInlineEditor_(e)}showPromptEditor_(){ar(Je.CHANGE_VALUE_TITLE,this.getText(),e=>{e!==null&&this.setValue(this.getValueFromEditorText_(e))})}showInlineEditor_(e){const t=this.getSourceBlock();if(!t)throw new hs;Gh(this,t.RTL,this.widgetDispose_.bind(this)),this.htmlInput_=this.widgetCreate_(),this.isBeingEdited_=true,e||(this.htmlInput_.focus({preventScroll:true}),this.htmlInput_.select())}widgetCreate_(){var e=this.getSourceBlock();if(!e)throw new hs;He(true);const t=ko();var r=this.getClickTarget_();if(!r)throw Error("A click target has not been set.");ie(r,"editing"),r=document.createElement("input"),r.className="blocklyHtmlInput",r.setAttribute("spellcheck",this.spellcheck_);const a=this.workspace_.getScale();var d=this.getConstants().FIELD_TEXT_FONTSIZE*a+"pt";return t.style.fontSize=d,r.style.fontSize=d,d=Il.BORDERRADIUS*a+"px",this.fullBlockClickTarget_&&(d=this.getScaledBBox(),d=(d.bottom-d.top)/2+"px",e=e.getParent()?e.getParent().style.colourTertiary:this.sourceBlock_.style.colourTertiary,r.style.border=1*a+"px solid "+e,t.style.borderRadius=d,t.style.transition="box-shadow 0.25s ease 0s",this.getConstants().FIELD_TEXTINPUT_BOX_SHADOW&&(t.style.boxShadow="rgba(255, 255, 255, 0.3) 0 0 0 "+4*a+"px")),r.style.borderRadius=d,t.appendChild(r),r.value=r.defaultValue=this.getEditorText_(this.value_),r.setAttribute("data-untyped-default-value",this.value_),this.resizeEditor_(),this.bindInputEvents_(r),r}widgetDispose_(){this.isBeingEdited_=false,this.isTextValid_=true,this.forceRerender(),this.onFinishEditing_(this.value_),He(false),this.unbindInputEvents_();var e=ko().style;if(e.width="auto",e.height="auto",e.fontSize="",e.transition="",e.boxShadow="",this.htmlInput_=null,e=this.getClickTarget_(),!e)throw Error("A click target has not been set.");he(e,"editing")}onFinishEditing_(e){}bindInputEvents_(e){this.onKeyDownWrapper_=S(e,"keydown",this,this.onHtmlInputKeyDown_),this.onKeyInputWrapper_=S(e,"input",this,this.onHtmlInputChange_)}unbindInputEvents_(){this.onKeyDownWrapper_&&(g(this.onKeyDownWrapper_),this.onKeyDownWrapper_=null),this.onKeyInputWrapper_&&(g(this.onKeyInputWrapper_),this.onKeyInputWrapper_=null)}onHtmlInputKeyDown_(e){e.keyCode===xe.ENTER?(En(),Lt()):e.keyCode===xe.ESC?(this.setValue(this.htmlInput_.getAttribute("data-untyped-default-value")),En(),Lt()):e.keyCode===xe.TAB&&(En(),Lt(),this.sourceBlock_.tab(this,!e.shiftKey),e.preventDefault())}onHtmlInputChange_(e){this.setValue(this.getValueFromEditorText_(this.htmlInput_.value))}setEditorValue_(e){this.isDirty_=true,this.isBeingEdited_&&(this.htmlInput_.value=this.getEditorText_(e)),this.setValue(e)}resizeEditor_(){var e=this.getSourceBlock();if(!e)throw new hs;const t=ko(),r=this.getScaledBBox();t.style.width=r.right-r.left+"px",t.style.height=r.bottom-r.top+"px",e=new Oe(e.RTL?r.right-t.offsetWidth:r.left,r.top),t.style.left=e.x+"px",t.style.top=e.y+"px"}isTabNavigable(){return true}getText_(){return this.isBeingEdited_&&this.htmlInput_?this.htmlInput_.value:null}getEditorText_(e){return String(e)}getValueFromEditorText_(e){return e}};Il.BORDERRADIUS=4,i.FieldTextInput$$module$build$src$core$field_textinput=class extends Il{constructor(e,t,r){super(e,t,r)}static fromJson(e){return new this(es(e.text),void 0,e)}},Pi("field_input",i.FieldTextInput$$module$build$src$core$field_textinput),i.FieldTextInput$$module$build$src$core$field_textinput.prototype.DEFAULT_VALUE="",i.FieldTextInput$$module$build$src$core$field_textinput;var $b=class extends g_{constructor(e){super(e)}endsWithElemSpacer(){return false}hasLeftSquareCorner(e){return!!e.outputConnection}hasRightSquareCorner(e){return!!e.outputConnection&&!e.statementInputCount&&!e.nextConnection}},yb=class extends bl{constructor(e,t){if(super(e,t),this.connectedBottomNextConnection=false,this.connectedBlock){for(e=this.connectedBlock;t=e.getNextBlock();)e=t;e.nextConnection||(this.height=this.connectedBlockHeight,this.connectedBottomNextConnection=true)}}},Rb=class extends Cn{constructor(e){super(e),this.width=this.height=0,this.type|=Q.getType("RIGHT_CONNECTION")}},Ib=class extends b_{constructor(e){super(e)}endsWithElemSpacer(){return false}hasLeftSquareCorner(e){const t=(e.hat?e.hat==="cap":this.constants_.ADD_START_HATS)&&!e.outputConnection&&!e.previousConnection;return!!e.outputConnection||t}hasRightSquareCorner(e){return!!e.outputConnection&&!e.statementInputCount&&!e.nextConnection}},Cb=class extends ia{constructor(e,t){super(e,t),this.isInline=true,this.renderer_=e,this.constants_=this.renderer_.getConstants(),this.topRow=new Ib(this.constants_),this.bottomRow=new $b(this.constants_),this.isMultiRow=!t.getInputsInline()||t.isCollapsed(),this.hasStatementInput=0<t.statementInputCount,this.rightSide=this.outputConnection?new Rb(this.constants_):null,this.rightAlignedDummyInputs_=new WeakMap}getRenderer(){return this.renderer_}measure(){this.createRows_(),this.addElemSpacing_(),this.addRowSpacing_(),this.adjustXPosition_(),this.computeBounds_(),this.alignRowElements_(),this.finalize_()}shouldStartNewRow_(e,t){return t?e.type===lt.STATEMENT||t.type===lt.STATEMENT?true:e.type===lt.VALUE||e.type===lt.DUMMY?!this.isInline||this.isMultiRow:false:false}getDesiredRowWidth_(e){return e.hasStatement?this.width-this.startX-(this.constants_.INSIDE_CORNERS.rightWidth||0):super.getDesiredRowWidth_(e)}getInRowSpacing_(e,t){return e&&t||!this.outputConnection||!this.outputConnection.isDynamicShape||this.hasStatementInput||this.bottomRow.hasNextConnection?!e&&t&&Q.isStatementInput(t)?this.constants_.STATEMENT_INPUT_PADDING_LEFT:e&&Q.isLeftRoundedCorner(e)&&t&&(Q.isPreviousConnection(t)||Q.isNextConnection(t))?t.notchOffset-this.constants_.CORNER_RADIUS:e&&Q.isLeftSquareCorner(e)&&t&&Q.isHat(t)?this.constants_.NO_PADDING:this.constants_.MEDIUM_PADDING:this.constants_.NO_PADDING}getSpacerRowHeight_(e,t){if(Q.isTopRow(e)&&Q.isBottomRow(t))return this.constants_.EMPTY_BLOCK_SPACER_HEIGHT;const r=Q.isInputRow(e)&&e.hasStatement,a=Q.isInputRow(t)&&t.hasStatement;return a||r?(e=Math.max(this.constants_.NOTCH_HEIGHT,this.constants_.INSIDE_CORNERS.rightHeight||0),a&&r?Math.max(e,this.constants_.DUMMY_INPUT_MIN_HEIGHT):e):Q.isTopRow(e)?e.hasPreviousConnection||this.outputConnection&&!this.hasStatementInput?this.constants_.NO_PADDING:Math.abs(this.constants_.NOTCH_HEIGHT-this.constants_.CORNER_RADIUS):Q.isBottomRow(t)?this.outputConnection?!t.hasNextConnection&&this.hasStatementInput?Math.abs(this.constants_.NOTCH_HEIGHT-this.constants_.CORNER_RADIUS):this.constants_.NO_PADDING:Math.max(this.topRow.minHeight,Math.max(this.constants_.NOTCH_HEIGHT,this.constants_.CORNER_RADIUS))-this.constants_.CORNER_RADIUS:this.constants_.MEDIUM_PADDING}getSpacerRowWidth_(e,t){const r=this.width-this.startX;return Q.isInputRow(e)&&e.hasStatement||Q.isInputRow(t)&&t.hasStatement?Math.max(r,this.constants_.STATEMENT_INPUT_SPACER_MIN_WIDTH):r}getElemCenterline_(e,t){if(e.hasStatement&&!Q.isSpacer(t)&&!Q.isStatementInput(t))return e.yPos+this.constants_.EMPTY_STATEMENT_INPUT_HEIGHT/2;if(Q.isInlineInput(t)&&t instanceof jn){const r=t.connectedBlock;if(r&&r.outputConnection&&r.nextConnection)return e.yPos+r.height/2}return super.getElemCenterline_(e,t)}addInput_(e,t){if(e.type===lt.DUMMY&&t.hasDummyInput&&t.align===i.Align$$module$build$src$core$input.LEFT&&e.align===i.Align$$module$build$src$core$input.RIGHT)this.rightAlignedDummyInputs_.set(t,e);else if(e.type===lt.STATEMENT){t.elements.push(new yb(this.constants_,e)),t.hasStatement=true,t.align===null&&(t.align=e.align);return}super.addInput_(e,t)}addAlignmentPadding_(e,t){if(this.rightAlignedDummyInputs_.get(e)){let r;for(let a=0;a<e.elements.length;a++){const d=e.elements[a];if(Q.isSpacer(d)&&(r=d),Q.isField(d)&&d instanceof io&&d.parentInput===this.rightAlignedDummyInputs_.get(e))break}if(r){r.width+=t,e.width+=t;return}}super.addAlignmentPadding_(e,t)}adjustXPosition_(){const e=this.constants_.NOTCH_OFFSET_LEFT+this.constants_.NOTCH_WIDTH;let t=e;for(let d=2;d<this.rows.length-1;d+=2){var r=this.rows[d-1];const C=this.rows[d];var a=this.rows[d+1];if(r=d===2?!!this.topRow.hasPreviousConnection:!!r.followsStatement,a=d+2>=this.rows.length-1?!!this.bottomRow.hasNextConnection:!!a.precedesStatement,Q.isInputRow(C)&&C.hasStatement){C.measure();let D,Y;t=C.width-((Y=(D=C.getLastInput())==null?void 0:D.width)!=null?Y:0)+e}else if(r&&(d===2||a)&&Q.isInputRow(C)&&!C.hasStatement){a=C.xPos,r=null;for(let D=0;D<C.elements.length;D++){const Y=C.elements[D];Q.isSpacer(Y)&&(r=Y),r&&(Q.isField(Y)||Q.isInput(Y))&&a<t&&!(Q.isField(Y)&&Y instanceof io&&(Y.field instanceof i.FieldLabel$$module$build$src$core$field_label||Y.field instanceof i.FieldImage$$module$build$src$core$field_image))&&(r.width+=t-a),a+=Y.width}}}}finalizeOutputConnection_(){if(this.outputConnection&&this.outputConnection.isDynamicShape){var e=this.outputConnection.shape;if("isDynamic"in e&&e.isDynamic){for(var t=0,r=0;r<this.rows.length;r++){const a=this.rows[r];a.yPos=t,t+=a.height}this.height=t,r=this.bottomRow.hasNextConnection?this.height-this.bottomRow.descenderHeight:this.height,t=e.height(r),r=e.width(r),this.outputConnection.height=t,this.outputConnection.width=r,this.outputConnection.startX=r,this.outputConnection.connectionOffsetY=e.connectionOffsetY(t),this.outputConnection.connectionOffsetX=e.connectionOffsetX(r),e=0,this.hasStatementInput||this.bottomRow.hasNextConnection||(e=r,this.rightSide.height=t,this.rightSide.width=e,this.rightSide.centerline=t/2,this.rightSide.xPos=this.width+e),this.startX=r,this.width+=r+e,this.widthWithChildren+=r+e}}}finalizeHorizontalAlignment_(){if(this.outputConnection&&!this.hasStatementInput&&!this.bottomRow.hasNextConnection){for(var e=0,t=0;t<this.rows.length;t++){var r=this.rows[t];if(!Q.isInputRow(r))continue;e=r.elements[r.elements.length-2];let a=this.getNegativeSpacing_(r.elements[1]),d=this.getNegativeSpacing_(e);e=a+d;const C=this.constants_.MIN_BLOCK_WIDTH+2*this.outputConnection.width;this.width-e<C&&(e=this.width-C,a=e/2,d=e/2),r.elements.unshift(new yi(this.constants_,-a)),r.elements.push(new yi(this.constants_,-d))}if(e)for(this.width-=e,this.widthWithChildren-=e,this.rightSide.xPos-=e,t=0;t<this.rows.length;t++)r=this.rows[t],Q.isTopOrBottomRow(r)&&(r.elements[1].width-=e),r.width-=e,r.widthWithConnectedBlocks-=e}}getNegativeSpacing_(e){if(!e||!this.outputConnection)return 0;const t=this.outputConnection.width;var r=this.outputConnection.shape.type;const a=this.constants_;if(this.isMultiRow&&1<this.inputRows.length)switch(r){case a.SHAPES.ROUND:return r=this.constants_.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH,r=this.height/2>r?r:this.height/2,t-r*(1-Math.sin(Math.acos((r-this.constants_.SMALL_PADDING)/r)));default:return 0}if(Q.isInlineInput(e)&&e instanceof jn){const d=e.connectedBlock;return e=d?d.pathObject.outputShapeType:e.shape.type,e==null||d&&d.outputConnection&&(d.statementInputCount||d.nextConnection)||r===a.SHAPES.HEXAGONAL&&r!==e?0:t-this.constants_.SHAPE_IN_SHAPE_PADDING[r][e]}return Q.isField(e)&&e instanceof io?r===a.SHAPES.ROUND&&e.field instanceof i.FieldTextInput$$module$build$src$core$field_textinput?t-2.75*a.GRID_UNIT:t-this.constants_.SHAPE_IN_SHAPE_PADDING[r][0]:Q.isIcon(e)?this.constants_.SMALL_PADDING:0}finalizeVerticalAlignment_(){if(!this.outputConnection)for(let a=2;a<this.rows.length-1;a+=2){const d=this.rows[a-1],C=this.rows[a],D=this.rows[a+1];var e=a===2,t=a+2>=this.rows.length-1?!!this.bottomRow.hasNextConnection:!!D.precedesStatement;if(e?this.topRow.hasPreviousConnection:d.followsStatement){var r=C.elements[1];if(r=C.elements.length===3&&r instanceof io&&(r.field instanceof i.FieldLabel$$module$build$src$core$field_label||r.field instanceof i.FieldImage$$module$build$src$core$field_image),!e&&r)d.height-=this.constants_.SMALL_PADDING,D.height-=this.constants_.SMALL_PADDING,C.height-=this.constants_.MEDIUM_PADDING;else if(!e&&!t)d.height+=this.constants_.SMALL_PADDING;else if(t){for(e=false,t=0;t<C.elements.length;t++)if(r=C.elements[t],r instanceof jn&&Q.isInlineInput(r)&&r.connectedBlock&&!r.connectedBlock.isShadow()&&40<=r.connectedBlock.getHeightWidth().height){e=true;break}e&&(d.height-=this.constants_.SMALL_PADDING,D.height-=this.constants_.SMALL_PADDING)}}}}finalize_(){this.finalizeOutputConnection_(),this.finalizeHorizontalAlignment_(),this.finalizeVerticalAlignment_(),super.finalize_(),this.rightSide&&(this.widthWithChildren+=this.rightSide.width)}},Ob=class extends S_{constructor(e,t,r){super(e,t,r),this.markerCircle_=null}showWithInputOutput_(e){const t=e.getSourceBlock();e=e.getLocation().getOffsetInBlock(),this.positionCircle_(e.x,e.y),this.setParent_(t),this.showCurrent_()}showWithOutput_(e){this.showWithInputOutput_(e)}showWithInput_(e){this.showWithInputOutput_(e)}showWithBlock_(e){e=e.getLocation();const t=e.getHeightWidth();this.positionRect_(0,0,t.width,t.height),this.setParent_(e),this.showCurrent_()}positionCircle_(e,t){let r;(r=this.markerCircle_)==null||r.setAttribute("cx",e.toString());let a;(a=this.markerCircle_)==null||a.setAttribute("cy",t.toString()),this.currentMarkerSvg=this.markerCircle_}hide(){super.hide(),this.markerCircle_&&(this.markerCircle_.style.display="none")}createDomInternal_(){if(super.createDomInternal_(),this.markerCircle_=H(ee.CIRCLE,{r:this.constants_.CURSOR_RADIUS,style:"display: none","stroke-width":this.constants_.CURSOR_STROKE_WIDTH},this.markerSvg_),this.isCursor()){const e=this.getBlinkProperties_();H(ee.ANIMATE,e,this.markerCircle_)}return this.markerSvg_}applyColour_(e){super.applyColour_(e);let t;(t=this.markerCircle_)==null||t.setAttribute("fill",this.colour_);let r;if((r=this.markerCircle_)==null||r.setAttribute("stroke",this.colour_),this.isCursor()){e=this.colour_+";transparent;transparent;";let a;(a=this.markerCircle_)==null||a.firstElementChild.setAttribute("values",e)}}},wb=class extends vu{constructor(e,t,r){super(e,t,r),this.svgPathSelected_=null,this.outlines=new Map,this.remainingOutlines=new Set,this.outputShapeType=null,this.constants=r}setPath(e){super.setPath(e),this.svgPathSelected_&&this.svgPathSelected_.setAttribute("d",e)}applyColour(e){super.applyColour(e);const t=e.getParent();e.isShadow()&&t&&this.svgPath.setAttribute("stroke",t.style.colourTertiary);for(const r of this.outlines.values())r.setAttribute("fill",this.style.colourTertiary)}flipRTL(){super.flipRTL();for(const e of this.outlines.values())e.setAttribute("transform","scale(-1 1)")}updateSelected(e){this.setClass_("blocklySelected",e),e?this.svgPathSelected_||(this.svgPathSelected_=this.svgPath.cloneNode(true),this.svgPathSelected_.setAttribute("fill","none"),this.svgPathSelected_.setAttribute("filter","url(#"+this.constants.selectedGlowFilterId+")"),this.svgRoot.appendChild(this.svgPathSelected_)):this.svgPathSelected_&&(this.svgRoot.removeChild(this.svgPathSelected_),this.svgPathSelected_=null)}updateReplacementFade(e){this.setClass_("blocklyReplaceable",e),e?this.svgPath.setAttribute("filter","url(#"+this.constants.replacementGlowFilterId+")"):this.svgPath.removeAttribute("filter")}updateShapeForInputHighlight(e,t){e=e.getParentInput().name,(e=this.getOutlinePath_(e))&&(t?e.setAttribute("filter","url(#"+this.constants.replacementGlowFilterId+")"):e.removeAttribute("filter"))}beginDrawing(){this.remainingOutlines.clear();for(const e of this.outlines.keys())this.remainingOutlines.add(e)}endDrawing(){if(this.remainingOutlines.size)for(const e of this.remainingOutlines)this.removeOutlinePath_(e);this.remainingOutlines.clear()}setOutlinePath(e,t){e=this.getOutlinePath_(e),e.setAttribute("d",t),e.setAttribute("fill",this.style.colourTertiary)}getOutlinePath_(e){return this.outlines.has(e)||this.outlines.set(e,H(ee.PATH,{class:"blocklyOutlinePath",d:""},this.svgRoot)),this.remainingOutlines.delete(e),this.outlines.get(e)}removeOutlinePath_(e){let t,r;(t=this.outlines.get(e))==null||(r=t.parentNode)==null||r.removeChild(this.outlines.get(e)),this.outlines.delete(e)}},kb=class extends Rl{constructor(e){super(e)}makeConstants_(){return new Tb}makeRenderInfo_(e){return new Cb(this,e)}makeDrawer_(e,t){return new Sb(e,t)}makeMarkerDrawer(e,t){return new Ob(e,this.getConstants(),t)}makePathObject(e,t){return new wb(e,t,this.getConstants())}getConstants(){return this.constants_}shouldHighlightConnection(e){return e.type!==Le.INPUT_VALUE&&e.type!==Le.OUTPUT_VALUE}getConnectionPreviewMethod(e,t,r){return t.type===Le.OUTPUT_VALUE?e.isConnected()?Ii.PREVIEW_TYPE.REPLACEMENT_FADE:Ii.PREVIEW_TYPE.INPUT_OUTLINE:super.getConnectionPreviewMethod(e,t,r)}};Fa("zelos",kb);var cn={};cn.BottomRow=$b,cn.ConstantProvider=Tb,cn.Drawer=Sb,cn.MarkerSvg=Ob,cn.PathObject=wb,cn.RenderInfo=Cb,cn.Renderer=kb,cn.RightConnectionShape=Rb,cn.StatementInput=yb,cn.TopRow=Ib;var Ab=class extends ia{constructor(e,t){super(e,t)}getRenderer(){return this.renderer_}addElemSpacing_(){let e=false;for(var t=0;t<this.rows.length;t++)if(this.rows[t].hasExternalInput){e=true;break}for(t=0;t<this.rows.length;t++){const a=this.rows[t];var r=a.elements;if(a.elements=[],a.startsWithElemSpacer()&&a.elements.push(new yi(this.constants_,this.getInRowSpacing_(null,r[0]))),r.length){for(let d=0;d<r.length-1;d++){a.elements.push(r[d]);const C=this.getInRowSpacing_(r[d],r[d+1]);a.elements.push(new yi(this.constants_,C))}a.elements.push(r[r.length-1]),a.endsWithElemSpacer()&&(r=this.getInRowSpacing_(r[r.length-1],null),e&&a.hasDummyInput&&(r+=this.constants_.TAB_WIDTH),a.elements.push(new yi(this.constants_,r)))}}}getInRowSpacing_(e,t){if(!e)return t&&Q.isField(t)&&t.isEditable?this.constants_.MEDIUM_PADDING:t&&Q.isInlineInput(t)?this.constants_.MEDIUM_LARGE_PADDING:t&&Q.isStatementInput(t)?this.constants_.STATEMENT_INPUT_PADDING_LEFT:this.constants_.LARGE_PADDING;if(!Q.isInput(e)&&!t)return Q.isField(e)&&e.isEditable?this.constants_.MEDIUM_PADDING:Q.isIcon(e)?2*this.constants_.LARGE_PADDING+1:Q.isHat(e)?this.constants_.NO_PADDING:Q.isPreviousOrNextConnection(e)?this.constants_.LARGE_PADDING:Q.isLeftRoundedCorner(e)?this.constants_.MIN_BLOCK_WIDTH:Q.isJaggedEdge(e)?this.constants_.NO_PADDING:this.constants_.LARGE_PADDING;if(Q.isInput(e)&&!t){if(Q.isExternalInput(e))return this.constants_.NO_PADDING;if(Q.isInlineInput(e))return this.constants_.LARGE_PADDING;if(Q.isStatementInput(e))return this.constants_.NO_PADDING}if(!Q.isInput(e)&&t&&Q.isInput(t)){if(Q.isField(e)&&e.isEditable){if(Q.isInlineInput(t)||Q.isExternalInput(t))return this.constants_.SMALL_PADDING}else{if(Q.isInlineInput(t)||Q.isExternalInput(t))return this.constants_.MEDIUM_LARGE_PADDING;if(Q.isStatementInput(t))return this.constants_.LARGE_PADDING}return this.constants_.LARGE_PADDING-1}if(Q.isIcon(e)&&t&&!Q.isInput(t))return this.constants_.LARGE_PADDING;if(Q.isInlineInput(e)&&t&&Q.isField(t))return t.isEditable?this.constants_.MEDIUM_PADDING:this.constants_.LARGE_PADDING;if(Q.isLeftSquareCorner(e)&&t){if(Q.isHat(t))return this.constants_.NO_PADDING;if(Q.isPreviousConnection(t)||Q.isNextConnection(t))return t.notchOffset}return Q.isLeftRoundedCorner(e)&&t?t.notchOffset-this.constants_.CORNER_RADIUS:Q.isField(e)&&t&&Q.isField(t)&&e.isEditable===t.isEditable||t&&Q.isJaggedEdge(t)?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING}getSpacerRowHeight_(e,t){return Q.isTopRow(e)&&Q.isBottomRow(t)?this.constants_.EMPTY_BLOCK_SPACER_HEIGHT:Q.isTopRow(e)||Q.isBottomRow(t)?this.constants_.NO_PADDING:e.hasExternalInput&&t.hasExternalInput?this.constants_.LARGE_PADDING:!e.hasStatement&&t.hasStatement?this.constants_.BETWEEN_STATEMENT_PADDING_Y:e.hasStatement&&t.hasStatement||e.hasDummyInput||t.hasDummyInput?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING}getElemCenterline_(e,t){if(Q.isSpacer(t))return e.yPos+t.height/2;if(Q.isBottomRow(e))return e=e.yPos+e.height-e.descenderHeight,Q.isNextConnection(t)?e+t.height/2:e-t.height/2;if(Q.isTopRow(e))return Q.isHat(t)?e.capline-t.height/2:e.capline+t.height/2;let r=e.yPos;return r=Q.isField(t)&&e.hasStatement?r+(this.constants_.TALL_INPUT_FIELD_OFFSET_Y+t.height/2):r+e.height/2}finalize_(){let e=0,t=0;for(var r=0;r<this.rows.length;r++){const d=this.rows[r];d.yPos=t,d.xPos=this.startX,t+=d.height,e=Math.max(e,d.widthWithConnectedBlocks);var a=t-this.topRow.ascenderHeight;d===this.bottomRow&&a<this.constants_.MIN_BLOCK_HEIGHT&&(a=this.constants_.MIN_BLOCK_HEIGHT-a,this.bottomRow.height+=a,t+=a),this.recordElemPositions_(d)}this.outputConnection&&this.block_.nextConnection&&this.block_.nextConnection.isConnected()&&(r=this.block_.nextConnection.targetBlock())&&(e=Math.max(e,r.getHeightWidth().width)),this.bottomRow.baseline=t-this.bottomRow.descenderHeight,this.widthWithChildren=e+this.startX,this.height=t,this.startY=this.topRow.capline}},Lb=class extends Rl{constructor(e){super(e)}makeRenderInfo_(e){return new Ab(this,e)}};Fa("thrasos",Lb);var O_={};O_.RenderInfo=Ab,O_.Renderer=Lb;var Nb=class extends $l{constructor(){super()}},Mb=class extends yl{constructor(e,t){super(e,t)}},Db=class extends ia{constructor(e,t){super(e,t)}getRenderer(){return this.renderer_}},xb=class extends Rl{constructor(e){super(e)}makeConstants_(){return new Nb}makeRenderInfo_(e){return new Db(this,e)}makeDrawer_(e,t){return new Mb(e,t)}};Fa("minimalist",xb);var Cl={};Cl.ConstantProvider=Nb,Cl.Drawer=Mb,Cl.RenderInfo=Db,Cl.Renderer=xb;var Bb=class extends $l{constructor(){super(),this.FIELD_TEXT_BASELINE_CENTER=false,this.DARK_PATH_OFFSET=1,this.MAX_BOTTOM_WIDTH=30,this.STATEMENT_BOTTOM_SPACER=-this.NOTCH_HEIGHT/2}getCSS_(e){return super.getCSS_(e).concat([`${e} .blocklyInsertionMarker>.blocklyPathLight,`,`${e} .blocklyInsertionMarker>.blocklyPathDark {`,`fill-opacity: ${this.INSERTION_MARKER_OPACITY};`,"stroke: none;","}"])}},Pb=class{constructor(e){this.inlineSteps_=this.steps_="",this.info_=e,this.RTL_=this.info_.RTL,e=e.getRenderer(),this.constants_=e.getConstants(),this.highlightConstants_=e.getHighlightConstants(),this.highlightOffset_=this.highlightConstants_.OFFSET,this.outsideCornerPaths_=this.highlightConstants_.OUTSIDE_CORNER,this.insideCornerPaths_=this.highlightConstants_.INSIDE_CORNER,this.puzzleTabPaths_=this.highlightConstants_.PUZZLE_TAB,this.notchPaths_=this.highlightConstants_.NOTCH,this.startPaths_=this.highlightConstants_.START_HAT,this.jaggedTeethPaths_=this.highlightConstants_.JAGGED_TEETH}getPath(){return this.steps_+`
`+this.inlineSteps_}drawTopCorner(e){this.steps_+=Wt(e.xPos,this.info_.startY);for(let t=0,r;r=e.elements[t];t++)Q.isLeftSquareCorner(r)?this.steps_+=this.highlightConstants_.START_POINT:Q.isLeftRoundedCorner(r)?this.steps_+=this.outsideCornerPaths_.topLeft(this.RTL_):Q.isPreviousConnection(r)?this.steps_+=this.notchPaths_.pathLeft:Q.isHat(r)?this.steps_+=this.startPaths_.path(this.RTL_):Q.isSpacer(r)&&r.width!==0&&(this.steps_+=Ne("H",r.xPos+r.width-this.highlightOffset_));this.steps_+=Ne("H",e.xPos+e.width-this.highlightOffset_)}drawJaggedEdge_(e){this.info_.RTL&&(this.steps_+=this.jaggedTeethPaths_.pathLeft+Ne("v",e.height-this.jaggedTeethPaths_.height-this.highlightOffset_))}drawValueInput(e){const t=e.getLastInput();if(this.RTL_){const r=e.height-t.connectionHeight;this.steps_+=Us(t.xPos+t.width-this.highlightOffset_,e.yPos)+this.puzzleTabPaths_.pathDown(this.RTL_)+Ne("v",r)}else this.steps_+=Us(t.xPos+t.width,e.yPos)+this.puzzleTabPaths_.pathDown(this.RTL_)}drawStatementInput(e){const t=e.getLastInput();if(t)if(this.RTL_){const r=e.height-2*this.insideCornerPaths_.height;this.steps_+=Us(t.xPos,e.yPos)+this.insideCornerPaths_.pathTop(this.RTL_)+Ne("v",r)+this.insideCornerPaths_.pathBottom(this.RTL_)+Dn(e.width-t.xPos-this.insideCornerPaths_.width,0)}else this.steps_+=Us(t.xPos,e.yPos+e.height)+this.insideCornerPaths_.pathBottom(this.RTL_)+Dn(e.width-t.xPos-this.insideCornerPaths_.width,0)}drawRightSideRow(e){const t=e.xPos+e.width-this.highlightOffset_;e instanceof v_&&e.followsStatement&&(this.steps_+=Ne("H",t)),this.RTL_&&(this.steps_+=Ne("H",t),e.height>this.highlightOffset_&&(this.steps_+=Ne("V",e.yPos+e.height-this.highlightOffset_)))}drawBottomRow(e){if(this.RTL_)this.steps_+=Ne("V",e.baseline-this.highlightOffset_);else{const t=this.info_.bottomRow.elements[0];Q.isLeftSquareCorner(t)?this.steps_+=Us(e.xPos+this.highlightOffset_,e.baseline-this.highlightOffset_):Q.isLeftRoundedCorner(t)&&(this.steps_+=Us(e.xPos,e.baseline),this.steps_+=this.outsideCornerPaths_.bottomLeft())}}drawLeft(){var e=this.info_.outputConnection;e&&(e=e.connectionOffsetY+e.height,this.RTL_?this.steps_+=Us(this.info_.startX,e):(this.steps_+=Us(this.info_.startX+this.highlightOffset_,this.info_.bottomRow.baseline-this.highlightOffset_),this.steps_+=Ne("V",e)),this.steps_+=this.puzzleTabPaths_.pathUp(this.RTL_)),this.RTL_||(e=this.info_.topRow,Q.isLeftRoundedCorner(e.elements[0])?this.steps_+=Ne("V",this.outsideCornerPaths_.height):this.steps_+=Ne("V",e.capline+this.highlightOffset_))}drawInlineInput(e){const t=this.highlightOffset_,r=e.xPos+e.connectionWidth;var a=e.centerline-e.height/2;const d=e.width-e.connectionWidth,C=a+t;this.RTL_?(a=e.connectionOffsetY-t,e=e.height-(e.connectionOffsetY+e.connectionHeight)+t,this.inlineSteps_+=Us(r-t,C)+Ne("v",a)+this.puzzleTabPaths_.pathDown(this.RTL_)+Ne("v",e)+Ne("h",d)):this.inlineSteps_+=Us(e.xPos+e.width+t,C)+Ne("v",e.height)+Ne("h",-d)+Us(r,a+e.connectionOffsetY)+this.puzzleTabPaths_.pathDown(this.RTL_)}},Ub=class extends yl{constructor(e,t){super(e,t),this.highlighter_=new Pb(t)}draw(){this.hideHiddenIcons_(),this.drawOutline_(),this.drawInternals_();const e=this.block_.pathObject;if(e.setPath(this.outlinePath_+`
`+this.inlinePath_),e.setHighlightPath(this.highlighter_.getPath()),this.info_.RTL&&e.flipRTL(),Mc()){let t,r;(t=this.block_)==null||(r=t.renderingDebugger)==null||r.drawDebug(this.block_,this.info_)}this.recordSizeOnBlock_()}drawTop_(){this.highlighter_.drawTopCorner(this.info_.topRow),this.highlighter_.drawRightSideRow(this.info_.topRow),super.drawTop_()}drawJaggedEdge_(e){this.highlighter_.drawJaggedEdge_(e),super.drawJaggedEdge_(e)}drawValueInput_(e){this.highlighter_.drawValueInput(e),super.drawValueInput_(e)}drawStatementInput_(e){this.highlighter_.drawStatementInput(e),super.drawStatementInput_(e)}drawRightSideRow_(e){this.highlighter_.drawRightSideRow(e),this.outlinePath_+=Ne("H",e.xPos+e.width)+Ne("V",e.yPos+e.height)}drawBottom_(){this.highlighter_.drawBottomRow(this.info_.bottomRow),super.drawBottom_()}drawLeft_(){this.highlighter_.drawLeft(),super.drawLeft_()}drawInlineInput_(e){this.highlighter_.drawInlineInput(e),super.drawInlineInput_(e)}positionInlineInputConnection_(e){const t=e.centerline-e.height/2;if(e.connectionModel){let r=e.xPos+e.connectionWidth+this.constants_.DARK_PATH_OFFSET;this.info_.RTL&&(r*=-1),e.connectionModel.setOffsetInBlock(r,t+e.connectionOffsetY+this.constants_.DARK_PATH_OFFSET)}}positionStatementInputConnection_(e){const t=e.getLastInput();if(t!=null&&t.connectionModel){let r=e.xPos+e.statementEdge+t.notchOffset;r=this.info_.RTL?-1*r:r+this.constants_.DARK_PATH_OFFSET,t.connectionModel.setOffsetInBlock(r,e.yPos+this.constants_.DARK_PATH_OFFSET)}}positionExternalValueConnection_(e){const t=e.getLastInput();if(t&&t.connectionModel){let r=e.xPos+e.width+this.constants_.DARK_PATH_OFFSET;this.info_.RTL&&(r*=-1),t.connectionModel.setOffsetInBlock(r,e.yPos)}}positionNextConnection_(){const e=this.info_.bottomRow;if(e.connection){const t=e.connection,r=t.xPos;t.connectionModel.setOffsetInBlock((this.info_.RTL?-r:r)+this.constants_.DARK_PATH_OFFSET/2,e.baseline+this.constants_.DARK_PATH_OFFSET)}}},Fb=class{constructor(e){this.OFFSET=.5,this.constantProvider=e,this.START_POINT=Wt(this.OFFSET,this.OFFSET)}init(){this.INSIDE_CORNER=this.makeInsideCorner(),this.OUTSIDE_CORNER=this.makeOutsideCorner(),this.PUZZLE_TAB=this.makePuzzleTab(),this.NOTCH=this.makeNotch(),this.JAGGED_TEETH=this.makeJaggedTeeth(),this.START_HAT=this.makeStartHat()}makeInsideCorner(){const e=this.constantProvider.CORNER_RADIUS,t=this.OFFSET,r=(1-Math.SQRT1_2)*(e+t)-t,a=Wt(r,r)+cs("a","0 0,0",e,Ve(-r-t,e-r)),d=cs("a","0 0,0",e+t,Ve(e+t,e+t)),C=Wt(r,-r)+cs("a","0 0,0",e+t,Ve(e-r,r+t));return{width:e+t,height:e,pathTop(D){return D?a:""},pathBottom(D){return D?d:C}}}makeOutsideCorner(){const e=this.constantProvider.CORNER_RADIUS,t=this.OFFSET,r=(1-Math.SQRT1_2)*(e-t)+t,a=Wt(r,r)+cs("a","0 0,1",e-t,Ve(e-r,-r+t)),d=Wt(t,e)+cs("a","0 0,1",e-t,Ve(e,-e+t)),C=-r,D=Wt(r,C)+cs("a","0 0,1",e-t,Ve(-r+t,-C-e));return{height:e,topLeft(Y){return Y?a:d},bottomLeft(){return D}}}makePuzzleTab(){const e=this.constantProvider.TAB_WIDTH,t=this.constantProvider.TAB_HEIGHT,r=Wt(-2,-t+3.4)+Dn(-.45*e,-2.1),a=Ne("v",2.5)+Wt(.97*-e,2.5)+Si("q",[Ve(.05*-e,10),Ve(.3*e,9.5)])+Wt(.67*e,-1.9)+Ne("v",2.5),d=Ne("v",-1.5)+Wt(-.92*e,-.5)+Si("q",[Ve(-.19*e,-5.5),Ve(0,-11)])+Wt(.92*e,1),C=Wt(-5,t-.7)+Dn(.46*e,-2.1);return{width:e,height:t,pathUp(D){return D?r:d},pathDown(D){return D?a:C}}}makeNotch(){return{pathLeft:Ne("h",this.OFFSET)+this.constantProvider.NOTCH.pathLeft}}makeJaggedTeeth(){return{pathLeft:Dn(5.1,2.6)+Wt(-10.2,6.8)+Dn(5.1,2.6),height:12,width:10.2}}makeStartHat(){const e=this.constantProvider.START_HAT.height,t=Wt(25,-8.7)+Si("c",[Ve(29.7,-6.2),Ve(57.2,-.5),Ve(75,8.7)]),r=Si("c",[Ve(17.8,-9.2),Ve(45.3,-14.9),Ve(75,-8.7)])+Us(100.5,e+.5);return{path(a){return a?t:r}}}},Gb=class extends m_{constructor(e,t){super(e,t),this.constants_=e,this.connectedBlock&&(this.width+=this.constants_.DARK_PATH_OFFSET,this.height+=this.constants_.DARK_PATH_OFFSET)}},Hb=class extends bl{constructor(e,t){super(e,t),this.constants_=e,this.connectedBlock&&(this.height+=this.constants_.DARK_PATH_OFFSET)}},Vb=class extends ia{constructor(e,t){super(e,t),this.renderer_=e}getRenderer(){return this.renderer_}populateBottomRow_(){super.populateBottomRow_(),this.block_.inputList.length&&this.block_.inputList[this.block_.inputList.length-1].type===lt.STATEMENT||(this.bottomRow.minHeight=this.constants_.MEDIUM_PADDING-this.constants_.DARK_PATH_OFFSET)}addInput_(e,t){this.isInline&&e.type===lt.VALUE?(t.elements.push(new Gb(this.constants_,e)),t.hasInlineInput=true):e.type===lt.STATEMENT?(t.elements.push(new Hb(this.constants_,e)),t.hasStatement=true):e.type===lt.VALUE?(t.elements.push(new Eu(this.constants_,e)),t.hasExternalInput=true):e.type===lt.DUMMY&&(t.minHeight=Math.max(t.minHeight,this.constants_.DUMMY_INPUT_MIN_HEIGHT),t.hasDummyInput=true),this.isInline||t.align!==null||(t.align=e.align)}addElemSpacing_(){let e=false;for(let r=0,a;a=this.rows[r];r++)a.hasExternalInput&&(e=true);for(let r=0,a;a=this.rows[r];r++){var t=a.elements;if(a.elements=[],a.startsWithElemSpacer()&&a.elements.push(new yi(this.constants_,this.getInRowSpacing_(null,t[0]))),t.length){for(let d=0;d<t.length-1;d++){a.elements.push(t[d]);const C=this.getInRowSpacing_(t[d],t[d+1]);a.elements.push(new yi(this.constants_,C))}a.elements.push(t[t.length-1]),a.endsWithElemSpacer()&&(t=this.getInRowSpacing_(t[t.length-1],null),e&&a.hasDummyInput&&(t+=this.constants_.TAB_WIDTH),a.elements.push(new yi(this.constants_,t)))}}}getInRowSpacing_(e,t){if(!e)return t&&Q.isField(t)&&t.isEditable?this.constants_.MEDIUM_PADDING:t&&Q.isInlineInput(t)?this.constants_.MEDIUM_LARGE_PADDING:t&&Q.isStatementInput(t)?this.constants_.STATEMENT_INPUT_PADDING_LEFT:this.constants_.LARGE_PADDING;if(!Q.isInput(e)&&(!t||Q.isStatementInput(t)))return Q.isField(e)&&e.isEditable?this.constants_.MEDIUM_PADDING:Q.isIcon(e)?2*this.constants_.LARGE_PADDING+1:Q.isHat(e)?this.constants_.NO_PADDING:Q.isPreviousOrNextConnection(e)?this.constants_.LARGE_PADDING:Q.isLeftRoundedCorner(e)?this.constants_.MIN_BLOCK_WIDTH:Q.isJaggedEdge(e)?this.constants_.NO_PADDING:this.constants_.LARGE_PADDING;if(Q.isInput(e)&&!t){if(Q.isExternalInput(e))return this.constants_.NO_PADDING;if(Q.isInlineInput(e))return this.constants_.LARGE_PADDING;if(Q.isStatementInput(e))return this.constants_.NO_PADDING}if(!Q.isInput(e)&&t&&Q.isInput(t)){if(Q.isField(e)&&e.isEditable){if(Q.isInlineInput(t)||Q.isExternalInput(t))return this.constants_.SMALL_PADDING}else{if(Q.isInlineInput(t)||Q.isExternalInput(t))return this.constants_.MEDIUM_LARGE_PADDING;if(Q.isStatementInput(t))return this.constants_.LARGE_PADDING}return this.constants_.LARGE_PADDING-1}if(Q.isIcon(e)&&t&&!Q.isInput(t))return this.constants_.LARGE_PADDING;if(Q.isInlineInput(e)&&t&&Q.isField(t))return t.isEditable?this.constants_.MEDIUM_PADDING:this.constants_.LARGE_PADDING;if(Q.isLeftSquareCorner(e)&&t){if(Q.isHat(t))return this.constants_.NO_PADDING;if(Q.isPreviousConnection(t))return t.notchOffset;if(Q.isNextConnection(t))return t.notchOffset+(this.RTL?1:-1)*this.constants_.DARK_PATH_OFFSET/2}if(Q.isLeftRoundedCorner(e)&&t){if(Q.isPreviousConnection(t))return t.notchOffset-this.constants_.CORNER_RADIUS;if(Q.isNextConnection(t))return t.notchOffset-this.constants_.CORNER_RADIUS+(this.RTL?1:-1)*this.constants_.DARK_PATH_OFFSET/2}return Q.isField(e)&&t&&Q.isField(t)&&e.isEditable===t.isEditable||t&&Q.isJaggedEdge(t)?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING}getSpacerRowHeight_(e,t){return Q.isTopRow(e)&&Q.isBottomRow(t)?this.constants_.EMPTY_BLOCK_SPACER_HEIGHT:Q.isTopRow(e)||Q.isBottomRow(t)?this.constants_.NO_PADDING:e.hasExternalInput&&t.hasExternalInput?this.constants_.LARGE_PADDING:!e.hasStatement&&t.hasStatement?this.constants_.BETWEEN_STATEMENT_PADDING_Y:e.hasStatement&&t.hasStatement||!e.hasStatement&&t.hasDummyInput||e.hasDummyInput?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING}getElemCenterline_(e,t){if(Q.isSpacer(t))return e.yPos+t.height/2;if(Q.isBottomRow(e))return e=e.yPos+e.height-e.descenderHeight,Q.isNextConnection(t)?e+t.height/2:e-t.height/2;if(Q.isTopRow(e))return Q.isHat(t)?e.capline-t.height/2:e.capline+t.height/2;let r=e.yPos;return Q.isField(t)||Q.isIcon(t)?(r+=t.height/2,(e.hasInlineInput||e.hasStatement)&&t.height+this.constants_.TALL_INPUT_FIELD_OFFSET_Y<=e.height&&(r+=this.constants_.TALL_INPUT_FIELD_OFFSET_Y)):r=Q.isInlineInput(t)?r+t.height/2:r+e.height/2,r}alignRowElements_(){if(this.isInline){var e=0,t=new WeakMap,r=null;for(let a=this.rows.length-1,d;d=this.rows[a];a--)t.set(d,e),Q.isInputRow(d)&&(d.hasStatement&&this.alignStatementRow_(d),r&&r.hasStatement&&d.width<r.width?t.set(d,r.width):e=d.width,r=d);e=0;for(let a=0,d;d=this.rows[a];a++)d.hasStatement?e=this.getDesiredRowWidth_(d):Q.isSpacer(d)?d.width=Math.max(e,t.get(d)):(r=d.width,e=Math.max(e,t.get(d))-r,0<e&&this.addAlignmentPadding_(d,e),e=d.width)}else super.alignRowElements_()}getDesiredRowWidth_(e){return this.isInline&&e.hasStatement?this.statementEdge+this.constants_.MAX_BOTTOM_WIDTH+this.startX:super.getDesiredRowWidth_(e)}finalize_(){let e=0,t=0;for(let a=0,d;d=this.rows[a];a++){d.yPos=t,d.xPos=this.startX,t+=d.height,e=Math.max(e,d.widthWithConnectedBlocks);var r=t-this.topRow.ascenderHeight;d===this.bottomRow&&r<this.constants_.MIN_BLOCK_HEIGHT&&(r=this.constants_.MIN_BLOCK_HEIGHT-r,this.bottomRow.height+=r,t+=r),this.recordElemPositions_(d)}this.outputConnection&&this.block_.nextConnection&&this.block_.nextConnection.isConnected()&&(r=this.block_.nextConnection.targetBlock())&&(e=Math.max(e,r.getHeightWidth().width-this.constants_.DARK_PATH_OFFSET)),this.bottomRow.baseline=t-this.bottomRow.descenderHeight,this.widthWithChildren=e+this.startX+this.constants_.DARK_PATH_OFFSET,this.width+=this.constants_.DARK_PATH_OFFSET,this.height=t+this.constants_.DARK_PATH_OFFSET,this.startY=this.topRow.capline}},Wb=class extends vu{constructor(e,t,r){super(e,t,r),this.constants=r,this.colourDark="#000000",this.svgPathDark=H(ee.PATH,{class:"blocklyPathDark",transform:"translate(1,1)"}),this.svgRoot.insertBefore(this.svgPathDark,this.svgPath),this.svgPathLight=H(ee.PATH,{class:"blocklyPathLight"},this.svgRoot)}setPath(e){this.svgPath.setAttribute("d",e),this.svgPathDark.setAttribute("d",e)}setHighlightPath(e){this.svgPathLight.setAttribute("d",e)}flipRTL(){this.svgPath.setAttribute("transform","scale(-1 1)"),this.svgPathLight.setAttribute("transform","scale(-1 1)"),this.svgPathDark.setAttribute("transform","translate(1,1) scale(-1 1)")}applyColour(e){if(this.svgPathLight.style.display="",this.svgPathDark.style.display="",!this.style.colourTertiary)throw Error("The renderer did not properly initialize the tertiary colour of the block style");this.svgPathLight.setAttribute("stroke",this.style.colourTertiary),this.svgPathDark.setAttribute("fill",this.colourDark),super.applyColour(e),this.svgPath.setAttribute("stroke","none")}setStyle(e){this.style=e,this.colourDark=Oo("#000",this.style.colourPrimary,.2)||this.colourDark}updateHighlighted(e){e?(this.svgPath.setAttribute("filter","url(#"+this.constants.embossFilterId+")"),this.svgPathLight.style.display="none"):(this.svgPath.setAttribute("filter","none"),this.svgPathLight.style.display="inline")}updateShadow_(e){if(e){if(this.svgPathLight.style.display="none",!this.style.colourSecondary)throw Error("The renderer did not properly initialize the secondary colour of the block style block style");this.svgPathDark.setAttribute("fill",this.style.colourSecondary),this.svgPath.setAttribute("stroke","none"),this.svgPath.setAttribute("fill",this.style.colourSecondary)}}updateDisabled_(e){super.updateDisabled_(e),e&&this.svgPath.setAttribute("stroke","none")}},zb=class extends Rl{constructor(e){super(e),this.highlightConstants_=null}init(e,t){super.init(e,t),this.highlightConstants_=this.makeHighlightConstants_(),this.highlightConstants_.init()}refreshDom(e,t){super.refreshDom(e,t),this.getHighlightConstants().init()}makeConstants_(){return new Bb}makeRenderInfo_(e){return new Vb(this,e)}makeDrawer_(e,t){return new Ub(e,t)}makePathObject(e,t){return new Wb(e,t,this.getConstants())}makeHighlightConstants_(){return new Fb(this.getConstants())}getHighlightConstants(){if(!this.highlightConstants_)throw Error("Cannot access the highlight constants because init has not been called");return this.highlightConstants_}};Fa("geras",zb);var On={};On.ConstantProvider=Bb,On.Drawer=Ub,On.HighlightConstantProvider=Fb,On.Highlighter=Pb,On.InlineInput=Gb,On.PathObject=Wb,On.RenderInfo=Vb,On.Renderer=zb,On.StatementInput=Hb;var jb=class{constructor(e){this.container=e,this.previousSibling=null,this.createDom()}createDom(){this.SVG||(this.SVG=H(ee.SVG,{xmlns:Mo,"xmlns:html":Zi,"xmlns:xlink":ai,version:"1.1",class:"blocklyWsDragSurface blocklyOverflowVisible"}),this.container.appendChild(this.SVG))}translateSurface(e,t){e=Math.round(e),t=Math.round(t),this.SVG.style.display="block",ae(this.SVG,"translate3d("+e+"px, "+t+"px, 0)")}getSurfaceTranslation(){return Ji(this.SVG)}clearAndHide(e){if(!e)throw Error("Couldn't clear and hide the drag surface: missing new surface.");const t=this.SVG.childNodes[0],r=this.SVG.childNodes[1];if(!t||!r||!t.classList.contains("blocklyBlockCanvas")&&r.classList.contains("blocklyBubbleCanvas"))throw Error("Couldn't clear and hide the drag surface. A node was missing.");if(this.previousSibling!==null?te(t,this.previousSibling):e.insertBefore(t,e.firstChild),te(r,t),this.SVG.style.display="none",this.SVG.childNodes.length)throw Error("Drag surface was not cleared.");ae(this.SVG,""),this.previousSibling=null}setContentsAndShow(e,t,r,a,d,C){if(this.SVG.childNodes.length)throw Error("Already dragging a block.");this.previousSibling=r,e.setAttribute("transform","translate(0, 0) scale("+C+")"),t.setAttribute("transform","translate(0, 0) scale("+C+")"),this.SVG.setAttribute("width",String(a)),this.SVG.setAttribute("height",String(d)),this.SVG.appendChild(e),this.SVG.appendChild(t),this.SVG.style.display="block"}},Xb=class{constructor(e){this.container=e,this.scale=1,this.surfaceXY=new Oe(0,0),this.childSurfaceXY=new Oe(0,0),this.svg=H(ee.SVG,{xmlns:Mo,"xmlns:html":Zi,"xmlns:xlink":ai,version:"1.1",class:"blocklyBlockDragSurface"},this.container),this.dragGroup=H(ee.G,{},this.svg)}createDom(){o("BlockDragSurfaceSvg createDom","June 2022","June 2023")}setBlocksAndShow(e){if(this.dragGroup.childNodes.length)throw Error("Already dragging a block.");this.dragGroup.appendChild(e),this.svg.style.display="block",this.surfaceXY=new Oe(0,0)}translateAndScaleGroup(e,t,r){this.scale=r,e=Math.round(e),t=Math.round(t),this.childSurfaceXY.x=e,this.childSurfaceXY.y=t,this.dragGroup.setAttribute("transform","translate("+e+","+t+") scale("+r+")")}translateSurfaceInternal_(){const e=Math.round(this.surfaceXY.x),t=Math.round(this.surfaceXY.y);this.svg.style.display="block",ae(this.svg,"translate3d("+e+"px, "+t+"px, 0)")}translateBy(e,t){this.surfaceXY=new Oe(this.surfaceXY.x+e,this.surfaceXY.y+t),this.translateSurfaceInternal_()}translateSurface(e,t){this.surfaceXY=new Oe(e*this.scale,t*this.scale),this.translateSurfaceInternal_()}getSurfaceTranslation(){const e=Ji(this.svg);return new Oe(e.x/this.scale,e.y/this.scale)}getGroup(){return this.dragGroup}getSvgRoot(){return this.svg}getCurrentBlock(){return this.dragGroup.firstChild}getWsTranslation(){return this.childSurfaceXY.clone()}clearAndHide(e){const t=this.getCurrentBlock();if(t&&(e?e.appendChild(t):this.dragGroup.removeChild(t)),this.svg.style.display="none",this.dragGroup.childNodes.length)throw Error("Drag group was not cleared.");this.surfaceXY=new Oe(0,0)}},bu={};bu.bumpIntoBounds=Dc,bu.bumpIntoBoundsHandler=PE,bu.bumpTopObjectsIntoBounds=cd;var w_=class{constructor(e,t,r,a,d){this.workspace=e,this.oldHostMetrics_=this.corner_=this.vScroll=this.hScroll=null,t=t===void 0?true:t,r=r===void 0?true:r;const C=t&&r;t&&(this.hScroll=new Kt(e,true,C,a,d)),r&&(this.vScroll=new Kt(e,false,C,a,d)),C&&(this.corner_=H(ee.RECT,{height:Kt.scrollbarThickness,width:Kt.scrollbarThickness,class:"blocklyScrollbarBackground"}),te(this.corner_,e.getBubbleCanvas()))}dispose(){B(this.corner_),this.oldHostMetrics_=this.corner_=null,this.hScroll&&(this.hScroll.dispose(),this.hScroll=null),this.vScroll&&(this.vScroll.dispose(),this.vScroll=null)}resize(){const e=this.workspace.getMetrics();if(e){var t=false,r=false;if(this.oldHostMetrics_&&this.oldHostMetrics_.viewWidth===e.viewWidth&&this.oldHostMetrics_.viewHeight===e.viewHeight&&this.oldHostMetrics_.absoluteTop===e.absoluteTop&&this.oldHostMetrics_.absoluteLeft===e.absoluteLeft?(this.oldHostMetrics_&&this.oldHostMetrics_.scrollWidth===e.scrollWidth&&this.oldHostMetrics_.viewLeft===e.viewLeft&&this.oldHostMetrics_.scrollLeft===e.scrollLeft||(t=true),this.oldHostMetrics_&&this.oldHostMetrics_.scrollHeight===e.scrollHeight&&this.oldHostMetrics_.viewTop===e.viewTop&&this.oldHostMetrics_.scrollTop===e.scrollTop||(r=true)):r=t=true,t||r){try{Zt(),this.hScroll&&t&&this.hScroll.resize(e),this.vScroll&&r&&this.vScroll.resize(e)}finally{ss()}this.workspace.maybeFireViewportChangeEvent()}if(this.hScroll&&this.vScroll){if(!this.oldHostMetrics_||this.oldHostMetrics_.viewWidth!==e.viewWidth||this.oldHostMetrics_.absoluteLeft!==e.absoluteLeft){let a;(a=this.corner_)==null||a.setAttribute("x",String(this.vScroll.position.x))}if(!this.oldHostMetrics_||this.oldHostMetrics_.viewHeight!==e.viewHeight||this.oldHostMetrics_.absoluteTop!==e.absoluteTop){let a;(a=this.corner_)==null||a.setAttribute("y",String(this.hScroll.position.y))}}this.oldHostMetrics_=e}}canScrollHorizontally(){return!!this.hScroll}canScrollVertically(){return!!this.vScroll}setOrigin(e,t){this.hScroll&&this.hScroll.setOrigin(e,t),this.vScroll&&this.vScroll.setOrigin(e,t)}set(e,t,r){this.hScroll&&this.hScroll.set(e,false),this.vScroll&&this.vScroll.set(t,false),(r||r===void 0)&&(e={},this.hScroll&&(e.x=this.hScroll.getRatio_()),this.vScroll&&(e.y=this.vScroll.getRatio_()),this.workspace.setMetrics(e))}setX(e){this.hScroll&&this.hScroll.set(e,true)}setY(e){this.vScroll&&this.vScroll.set(e,true)}setContainerVisible(e){this.hScroll&&this.hScroll.setContainerVisible(e),this.vScroll&&this.vScroll.setContainerVisible(e)}isVisible(){let e=false;return this.hScroll&&(e=this.hScroll.isVisible()),this.vScroll&&(e=e||this.vScroll.isVisible()),e}resizeContent(e){this.hScroll&&this.hScroll.resizeContentHorizontal(e),this.vScroll&&this.vScroll.resizeContentVertical(e)}resizeView(e){this.hScroll&&this.hScroll.resizeViewHorizontal(e),this.vScroll&&this.vScroll.resizeViewVertical(e)}},Kb=false;i.CodeGenerator$$module$build$src$core$generator=class{constructor(e){this.FUNCTION_NAME_PLACEHOLDER_="{leCUI8hutHZI4480Dc}",this.STATEMENT_SUFFIX=this.STATEMENT_PREFIX=this.INFINITE_LOOP_TRAP=null,this.INDENT="  ",this.COMMENT_WRAP=60,this.ORDER_OVERRIDES=[],this.isInitialized=null,this.RESERVED_WORDS_="",this.definitions_=Object.create(null),this.functionNames_=Object.create(null),this.nameDB_=void 0,this.name_=e,this.FUNCTION_NAME_PLACEHOLDER_REGEXP_=new RegExp(this.FUNCTION_NAME_PLACEHOLDER_,"g")}workspaceToCode(e){e||(console.warn("No workspace specified in workspaceToCode call.  Guessing."),e=k());var t=[];this.init(e),e=e.getTopBlocks(true);for(let r=0,a;a=e[r];r++){let d=this.blockToCode(a);Array.isArray(d)&&(d=d[0]),d&&(a.outputConnection&&(d=this.scrubNakedValue(d),this.STATEMENT_PREFIX&&!a.suppressPrefixSuffix&&(d=this.injectId(this.STATEMENT_PREFIX,a)+d),this.STATEMENT_SUFFIX&&!a.suppressPrefixSuffix&&(d+=this.injectId(this.STATEMENT_SUFFIX,a))),t.push(d))}return t=t.join(`
`),t=this.finish(t),t=t.replace(/^\s+\n/,""),t=t.replace(/\n\s+$/,`
`),t=t.replace(/[ \t]+\n/g,`
`)}prefixLines(e,t){return t+e.replace(/(?!\n$)\n/g,`
`+t)}allNestedComments(e){const t=[];e=e.getDescendants(true);for(let r=0;r<e.length;r++){const a=e[r].getCommentText();a&&t.push(a)}return t.length&&t.push(""),t.join(`
`)}blockToCode(e,t){if(this.isInitialized===false&&console.warn("CodeGenerator init was not called before blockToCode was called."),!e)return"";if(!e.isEnabled())return t?"":this.blockToCode(e.getNextBlock());if(e.isInsertionMarker())return t?"":this.blockToCode(e.getChildren(false)[0]);var r=this[e.type];if(typeof r!="function")throw Error('Language "'+this.name_+'" does not know how to generate code for block type "'+e.type+'".');if(r=r.call(e,e),Array.isArray(r)){if(!e.outputConnection)throw TypeError("Expecting string from statement block: "+e.type);return[this.scrub_(e,r[0],t),r[1]]}if(typeof r=="string")return this.STATEMENT_PREFIX&&!e.suppressPrefixSuffix&&(r=this.injectId(this.STATEMENT_PREFIX,e)+r),this.STATEMENT_SUFFIX&&!e.suppressPrefixSuffix&&(r+=this.injectId(this.STATEMENT_SUFFIX,e)),this.scrub_(e,r,t);if(r===null)return"";throw SyntaxError("Invalid code generated: "+r)}valueToCode(e,t,r){if(isNaN(r))throw TypeError("Expecting valid order from block: "+e.type);var a=e.getInputTargetBlock(t);if(!a||(t=this.blockToCode(a),t===""))return"";if(!Array.isArray(t))throw TypeError("Expecting tuple from value block: "+a.type);if(e=t[0],t=t[1],isNaN(t))throw TypeError("Expecting valid order from value block: "+a.type);if(!e)return"";a=false;var d=Math.floor(r);const C=Math.floor(t);if(d<=C&&(d!==C||d!==0&&d!==99)){for(a=true,d=0;d<this.ORDER_OVERRIDES.length;d++)if(this.ORDER_OVERRIDES[d][0]===r&&this.ORDER_OVERRIDES[d][1]===t){a=false;break}}return a&&(e="("+e+")"),e}statementToCode(e,t){if(e=e.getInputTargetBlock(t),t=this.blockToCode(e),typeof t!="string")throw TypeError("Expecting code from statement block: "+(e&&e.type));return t&&(t=this.prefixLines(t,this.INDENT)),t}addLoopTrap(e,t){return this.INFINITE_LOOP_TRAP&&(e=this.prefixLines(this.injectId(this.INFINITE_LOOP_TRAP,t),this.INDENT)+e),this.STATEMENT_SUFFIX&&!t.suppressPrefixSuffix&&(e=this.prefixLines(this.injectId(this.STATEMENT_SUFFIX,t),this.INDENT)+e),this.STATEMENT_PREFIX&&!t.suppressPrefixSuffix&&(e+=this.prefixLines(this.injectId(this.STATEMENT_PREFIX,t),this.INDENT)),e}injectId(e,t){return t=t.id.replace(/\$/g,"$$$$"),e.replace(/%1/g,"'"+t+"'")}addReservedWords(e){this.RESERVED_WORDS_+=e+","}provideFunction_(e,t){if(!this.definitions_[e]){const r=this.nameDB_.getDistinctName(e,i.NameType$$module$build$src$core$names.PROCEDURE);this.functionNames_[e]=r,Array.isArray(t)&&(t=t.join(`
`)),t=t.trim().replace(this.FUNCTION_NAME_PLACEHOLDER_REGEXP_,r);let a;for(;a!==t;)a=t,t=t.replace(/^(( {2})*) {2}/gm,"$1\0");t=t.replace(/\0/g,this.INDENT),this.definitions_[e]=t}return this.functionNames_[e]}init(e){this.definitions_=Object.create(null),this.functionNames_=Object.create(null)}scrub_(e,t,r){return t}finish(e){return this.definitions_=Object.create(null),this.functionNames_=Object.create(null),e}scrubNakedValue(e){return e}},Object.defineProperties(i.CodeGenerator$$module$build$src$core$generator.prototype,{variableDB_:{get(){return o("variableDB_","version 9","version 10","nameDB_"),this.nameDB_},set(e){o("variableDB_","version 9","version 10","nameDB_"),this.nameDB_=e}}}),i.CodeGenerator$$module$build$src$core$generator;var na=class{constructor(e,t,r,a){this.workspace=e,this.targetWorkspace=t,this.isLabel_=a,this.onMouseUpWrapper_=null,this.height=this.width=0,this.svgText_=this.svgGroup_=null,this.text_=r.text,this.position_=new Oe(0,0),this.callbackKey_=r.callbackKey||r.callbackkey,this.cssClass_=r["web-class"]||null,this.info=r}createDom(){var e=this.isLabel_?"blocklyFlyoutLabel":"blocklyFlyoutButton";this.cssClass_&&(e+=" "+this.cssClass_),this.svgGroup_=H(ee.G,{class:e},this.workspace.getCanvas());let t;this.isLabel_||(t=H(ee.RECT,{class:"blocklyFlyoutButtonShadow",rx:4,ry:4,x:1,y:1},this.svgGroup_)),e=H(ee.RECT,{class:this.isLabel_?"blocklyFlyoutLabelBackground":"blocklyFlyoutButtonBackground",rx:4,ry:4},this.svgGroup_);const r=H(ee.TEXT,{class:this.isLabel_?"blocklyFlyoutLabelText":"blocklyText",x:0,y:0,"text-anchor":"middle"},this.svgGroup_);var a=es(this.text_);this.workspace.RTL&&(a+="‏"),r.textContent=a,this.isLabel_&&(this.svgText_=r,this.workspace.getThemeManager().subscribe(this.svgText_,"flyoutForegroundColour","fill"));const d=At(r,"fontSize"),C=At(r,"fontWeight"),D=At(r,"fontFamily");if(this.width=Ut(r,d,C,D),a=Jt(a,d,C,D),this.height=a.height,!this.isLabel_){this.width+=2*na.TEXT_MARGIN_X,this.height+=2*na.TEXT_MARGIN_Y;let Y;(Y=t)==null||Y.setAttribute("width",this.width.toString());let pe;(pe=t)==null||pe.setAttribute("height",this.height.toString())}return e.setAttribute("width",this.width.toString()),e.setAttribute("height",this.height.toString()),r.setAttribute("x",(this.width/2).toString()),r.setAttribute("y",(this.height/2-a.height/2+a.baseline).toString()),this.updateTransform_(),this.onMouseUpWrapper_=S(this.svgGroup_,"pointerup",this,this.onMouseUp_),this.svgGroup_}show(){this.updateTransform_(),this.svgGroup_.setAttribute("display","block")}updateTransform_(){this.svgGroup_.setAttribute("transform","translate("+this.position_.x+","+this.position_.y+")")}moveTo(e,t){this.position_.x=e,this.position_.y=t,this.updateTransform_()}isLabel(){return this.isLabel_}getPosition(){return this.position_}getButtonText(){return this.text_}getTargetWorkspace(){return this.targetWorkspace}dispose(){this.onMouseUpWrapper_&&g(this.onMouseUpWrapper_),this.svgGroup_&&B(this.svgGroup_),this.svgText_&&this.workspace.getThemeManager().unsubscribe(this.svgText_)}onMouseUp_(e){(e=this.targetWorkspace.getGesture(e))&&e.cancel(),this.isLabel_&&this.callbackKey_?console.warn("Labels should not have callbacks. Label text: "+this.text_):this.isLabel_||this.callbackKey_&&this.targetWorkspace.getButtonCallback(this.callbackKey_)?this.isLabel_||(e=this.targetWorkspace.getButtonCallback(this.callbackKey_))&&e(this):console.warn("Buttons should have callbacks. Button text: "+this.text_)}};na.TEXT_MARGIN_X=5,na.TEXT_MARGIN_Y=2,Ti(`
.blocklyFlyoutButton {
  fill: #888;
  cursor: default;
}

.blocklyFlyoutButtonShadow {
  fill: #666;
}

.blocklyFlyoutButton:hover {
  fill: #aaa;
}

.blocklyFlyoutLabel {
  cursor: default;
}

.blocklyFlyoutLabelBackground {
  opacity: 0;
}
`);var k_=class{constructor(e){this.workspace_=e}getDimensionsPx_(e){let t=0,r=0;return e&&(t=e.getWidth(),r=e.getHeight()),new Ss(t,r)}getFlyoutMetrics(e){return e=this.getDimensionsPx_(this.workspace_.getFlyout(e)),{width:e.width,height:e.height,position:this.workspace_.toolboxPosition}}getToolboxMetrics(){const e=this.getDimensionsPx_(this.workspace_.getToolbox());return{width:e.width,height:e.height,position:this.workspace_.toolboxPosition}}getSvgMetrics(){return this.workspace_.getCachedParentSvgSize()}getAbsoluteMetrics(){let e=0;const t=this.getToolboxMetrics(),r=this.getFlyoutMetrics(true),a=!!this.workspace_.getToolbox(),d=!!this.workspace_.getFlyout(true);var C=a?t.position:r.position,D=C===it.LEFT;return C=C===it.TOP,a&&D?e=t.width:d&&D&&(e=r.width),D=0,a&&C?D=t.height:d&&C&&(D=r.height),{top:D,left:e}}getViewMetrics(e){e=e?this.workspace_.scale:1;const t=this.getSvgMetrics(),r=this.getToolboxMetrics(),a=this.getFlyoutMetrics(true),d=this.workspace_.getToolbox()?r.position:a.position;return this.workspace_.getToolbox()?d===it.TOP||d===it.BOTTOM?t.height-=r.height:(d===it.LEFT||d===it.RIGHT)&&(t.width-=r.width):this.workspace_.getFlyout(true)&&(d===it.TOP||d===it.BOTTOM?t.height-=a.height:(d===it.LEFT||d===it.RIGHT)&&(t.width-=a.width)),{height:t.height/e,width:t.width/e,top:-this.workspace_.scrollY/e,left:-this.workspace_.scrollX/e}}getContentMetrics(e){e=e?1:this.workspace_.scale;const t=this.workspace_.getBlocksBoundingBox();return{height:(t.bottom-t.top)*e,width:(t.right-t.left)*e,top:t.top*e,left:t.left*e}}hasFixedEdges(){return!this.workspace_.isMovableHorizontally()||!this.workspace_.isMovableVertically()}getComputedFixedEdges_(e){if(!this.hasFixedEdges())return{};const t=this.workspace_.isMovableHorizontally(),r=this.workspace_.isMovableVertically();e=e||this.getViewMetrics(false);const a={};return r||(a.top=e.top,a.bottom=e.top+e.height),t||(a.left=e.left,a.right=e.left+e.width),a}getPaddedContent_(e,t){const r=t.top+t.height,a=t.left+t.width,d=e.width;e=e.height;const C=d/2,D=e/2;return{top:Math.min(t.top-D,r-e),bottom:Math.max(r+D,t.top+e),left:Math.min(t.left-C,a-d),right:Math.max(a+C,t.left+d)}}getScrollMetrics(e,t,r){e=e?this.workspace_.scale:1,t=t||this.getViewMetrics(false);var a=r||this.getContentMetrics();r=this.getComputedFixedEdges_(t),t=this.getPaddedContent_(t,a),a=r.top!==void 0?r.top:t.top;const d=r.left!==void 0?r.left:t.left;return{top:a/e,left:d/e,width:((r.right!==void 0?r.right:t.right)-d)/e,height:((r.bottom!==void 0?r.bottom:t.bottom)-a)/e}}getUiMetrics(){return{viewMetrics:this.getViewMetrics(),absoluteMetrics:this.getAbsoluteMetrics(),toolboxMetrics:this.getToolboxMetrics()}}getMetrics(){const e=this.getToolboxMetrics(),t=this.getFlyoutMetrics(true),r=this.getSvgMetrics(),a=this.getAbsoluteMetrics(),d=this.getViewMetrics(),C=this.getContentMetrics(),D=this.getScrollMetrics(false,d,C);return{contentHeight:C.height,contentWidth:C.width,contentTop:C.top,contentLeft:C.left,scrollHeight:D.height,scrollWidth:D.width,scrollTop:D.top,scrollLeft:D.left,viewHeight:d.height,viewWidth:d.width,viewTop:d.top,viewLeft:d.left,absoluteTop:a.top,absoluteLeft:a.left,svgHeight:r.height,svgWidth:r.width,toolboxWidth:e.width,toolboxHeight:e.height,toolboxPosition:e.position,flyoutWidth:t.width,flyoutHeight:t.height}}};$e(Te.METRICS_MANAGER,Un,k_);var Yb=class extends k_{constructor(e,t){super(e),this.flyout_=t}getBoundingBox_(){let e;try{e=this.workspace_.getCanvas().getBBox()}catch{e={height:0,y:0,width:0,x:0}}return e}getContentMetrics(e){const t=this.getBoundingBox_();return e=e?1:this.workspace_.scale,{height:t.height*e,width:t.width*e,top:t.y*e,left:t.x*e}}getScrollMetrics(e,t,r){return t=r||this.getContentMetrics(),r=this.flyout_.MARGIN*this.workspace_.scale,e=e?this.workspace_.scale:1,{height:(t.height+2*r)/e,width:(t.width+t.left+r)/e,top:0,left:0}}},ra;(function(e){e.BLOCK="block",e.BUTTON="button"})(ra||(ra={}));var Tu=class extends pu{constructor(e){super(),this.horizontalLayout=false,this.eventWrappers_=[],this.filterWrapper_=this.reflowWrapper_=null,this.mats_=[],this.buttons_=[],this.listeners_=[],this.permanentlyDisabled_=[],this.recycledBlocks_=[],this.autoClose=true,this.isVisible_=false,this.containerVisible_=true,this.CORNER_RADIUS=8,this.SCROLLBAR_MARGIN=2.5,this.height_=this.width_=0,this.dragAngleRange_=70,this.svgGroup_=this.svgBackground_=null,e.setMetrics=this.setMetrics_.bind(this),this.workspace_=new ln(e),this.workspace_.setMetricsManager(new Yb(this.workspace_,this)),this.workspace_.internalIsFlyout=true,this.workspace_.setVisible(this.isVisible_),this.id=mi(),this.RTL=!!e.RTL,this.toolboxPosition_=e.toolboxPosition,this.tabWidth_=this.workspace_.getRenderer().getConstants().TAB_WIDTH,this.rectMap_=new WeakMap,this.MARGIN=this.CORNER_RADIUS,this.GAP_X=3*this.MARGIN,this.GAP_Y=3*this.MARGIN}createDom(e){return this.svgGroup_=H(e,{class:"blocklyFlyout",style:"display: none"}),this.svgBackground_=H(ee.PATH,{class:"blocklyFlyoutBackground"},this.svgGroup_),this.svgGroup_.appendChild(this.workspace_.createDom()),this.workspace_.getThemeManager().subscribe(this.svgBackground_,"flyoutBackgroundColour","fill"),this.workspace_.getThemeManager().subscribe(this.svgBackground_,"flyoutOpacity","fill-opacity"),this.svgGroup_}init(e){this.targetWorkspace=e,this.workspace_.targetWorkspace=e,this.workspace_.scrollbar=new w_(this.workspace_,this.horizontalLayout,!this.horizontalLayout,"blocklyFlyoutScrollbar",this.SCROLLBAR_MARGIN),this.hide(),Array.prototype.push.apply(this.eventWrappers_,S(this.svgGroup_,"wheel",this,this.wheel_)),this.autoClose||(this.filterWrapper_=this.filterForCapacity_.bind(this),this.targetWorkspace.addChangeListener(this.filterWrapper_)),Array.prototype.push.apply(this.eventWrappers_,S(this.svgBackground_,"pointerdown",this,this.onMouseDown_)),this.workspace_.getGesture=this.targetWorkspace.getGesture.bind(this.targetWorkspace),this.workspace_.setVariableMap(this.targetWorkspace.getVariableMap()),this.workspace_.createPotentialVariableMap(),e.getComponentManager().addComponent({component:this,weight:1,capabilities:[$s.Capability.DELETE_AREA,$s.Capability.DRAG_TARGET]})}dispose(){this.hide(),this.workspace_.getComponentManager().removeComponent(this.id),g(this.eventWrappers_),this.filterWrapper_&&(this.targetWorkspace.removeChangeListener(this.filterWrapper_),this.filterWrapper_=null),this.workspace_&&(this.workspace_.getThemeManager().unsubscribe(this.svgBackground_),this.workspace_.dispose()),this.svgGroup_&&(B(this.svgGroup_),this.svgGroup_=null),this.svgBackground_=null}getWidth(){return this.width_}getHeight(){return this.height_}getFlyoutScale(){return this.targetWorkspace.scale}getWorkspace(){return this.workspace_}isVisible(){return this.isVisible_}setVisible(e){const t=e!==this.isVisible();this.isVisible_=e,t&&(this.autoClose||this.workspace_.recordDragTargets(),this.updateDisplay_())}setContainerVisible(e){const t=e!==this.containerVisible_;this.containerVisible_=e,t&&this.updateDisplay_()}updateDisplay_(){let e;e=this.containerVisible_?this.isVisible():false,this.svgGroup_&&(this.svgGroup_.style.display=e?"block":"none");let t;(t=this.workspace_.scrollbar)==null||t.setContainerVisible(e)}positionAt_(e,t,r,a){let d;(d=this.svgGroup_)==null||d.setAttribute("width",e.toString());let C;(C=this.svgGroup_)==null||C.setAttribute("height",t.toString()),this.workspace_.setCachedParentSvgSize(e,t);let D;if(((D=this.svgGroup_)==null?void 0:D.tagName)==="svg")ae(this.svgGroup_,"translate("+r+"px,"+a+"px)");else{let Y;(Y=this.svgGroup_)==null||Y.setAttribute("transform","translate("+r+","+a+")")}(e=this.workspace_.scrollbar)&&(e.setOrigin(r,a),e.resize(),e.hScroll&&e.hScroll.setPosition(e.hScroll.position.x,e.hScroll.position.y),e.vScroll&&e.vScroll.setPosition(e.vScroll.position.x,e.vScroll.position.y))}hide(){if(this.isVisible()){this.setVisible(false);for(let e=0,t;t=this.listeners_[e];e++)g(t);this.listeners_.length=0,this.reflowWrapper_&&(this.workspace_.removeChangeListener(this.reflowWrapper_),this.reflowWrapper_=null)}}show(e){this.workspace_.setResizesEnabled(false),this.hide(),this.clearOldBlocks_(),typeof e=="string"&&(e=this.getDynamicCategoryContents_(e)),this.setVisible(true),e=Cc(e),e=this.createFlyoutInfo_(e),this.layout_(e.contents,e.gaps),this.listeners_.push(S(this.svgBackground_,"pointerover",this,function(){const t=this.workspace_.getTopBlocks(false);for(let r=0,a;a=t[r];r++)a.removeSelect()})),this.horizontalLayout?this.height_=0:this.width_=0,this.workspace_.setResizesEnabled(true),this.reflow(),this.filterForCapacity_(),this.position(),this.reflowWrapper_=this.reflow.bind(this),this.workspace_.addChangeListener(this.reflowWrapper_),this.emptyRecycledBlocks_()}createFlyoutInfo_(e){const t=[],r=[];this.permanentlyDisabled_.length=0;const a=this.horizontalLayout?this.GAP_X:this.GAP_Y;for(let C=0,D;D=e[C];C++){if("custom"in D){var d=this.getDynamicCategoryContents_(D.custom);d=Cc(d),e.splice.apply(e,[C,1,...d]),D=e[C]}switch(D.kind.toUpperCase()){case"BLOCK":d=D;const Y=this.createFlyoutBlock_(d);t.push({type:ra.BLOCK,block:Y}),this.addBlockGap_(d,r,a);break;case"SEP":this.addSeparatorGap_(D,r,a);break;case"LABEL":d=this.createButton_(D,true),t.push({type:ra.BUTTON,button:d}),r.push(a);break;case"BUTTON":d=this.createButton_(D,false),t.push({type:ra.BUTTON,button:d}),r.push(a)}}return{contents:t,gaps:r}}getDynamicCategoryContents_(e){if(e=this.workspace_.targetWorkspace.getToolboxCategoryCallback(e),typeof e!="function")throw TypeError("Couldn't find a callback function when opening a toolbox category.");return e(this.workspace_.targetWorkspace)}createButton_(e,t){return new na(this.workspace_,this.targetWorkspace,e,t)}createFlyoutBlock_(e){let t;return e.blockxml?(e=typeof e.blockxml=="string"?zs(e.blockxml):e.blockxml,(t=this.getRecycledBlock_(e.getAttribute("type")))||(t=Co(e,this.workspace_))):(t=this.getRecycledBlock_(e.type),t||(e.enabled===void 0&&(e.enabled=e.disabled!=="true"&&e.disabled!==true),t=Hr(e,this.workspace_))),t.isEnabled()||this.permanentlyDisabled_.push(t),t}getRecycledBlock_(e){let t=-1;for(let r=0;r<this.recycledBlocks_.length;r++)if(this.recycledBlocks_[r].type===e){t=r;break}return t===-1?void 0:this.recycledBlocks_.splice(t,1)[0]}addBlockGap_(e,t,r){let a;e.gap?a=parseInt(e.gap.toString()):e.blockxml&&(e=typeof e.blockxml=="string"?zs(e.blockxml):e.blockxml,a=parseInt(e.getAttribute("gap"))),t.push(!a||isNaN(a)?r:a)}addSeparatorGap_(e,t,r){e=parseInt(e.gap.toString()),!isNaN(e)&&0<t.length?t[t.length-1]=e:t.push(r)}clearOldBlocks_(){var e=this.workspace_.getTopBlocks(false);for(let r=0,a;a=e[r];r++)this.blockIsRecyclable_(a)?this.recycleBlock_(a):a.dispose(false,false);for(e=0;e<this.mats_.length;e++){const r=this.mats_[e];r&&($c(r),B(r))}this.mats_.length=0;for(let r=0,a;a=this.buttons_[r];r++)a.dispose();this.buttons_.length=0;let t;(t=this.workspace_.getPotentialVariableMap())==null||t.clear()}emptyRecycledBlocks_(){for(let e=0;e<this.recycledBlocks_.length;e++)this.recycledBlocks_[e].dispose();this.recycledBlocks_=[]}blockIsRecyclable_(e){return false}recycleBlock_(e){const t=e.getRelativeToSurfaceXY();e.moveBy(-t.x,-t.y),this.recycledBlocks_.push(e)}addBlockListeners_(e,t,r){this.listeners_.push(S(e,"pointerdown",null,this.blockMouseDown_(t))),this.listeners_.push(S(r,"pointerdown",null,this.blockMouseDown_(t))),this.listeners_.push(y(e,"pointerenter",t,t.addSelect)),this.listeners_.push(y(e,"pointerleave",t,t.removeSelect)),this.listeners_.push(y(r,"pointerenter",t,t.addSelect)),this.listeners_.push(y(r,"pointerleave",t,t.removeSelect))}blockMouseDown_(e){return t=>{const r=this.targetWorkspace.getGesture(t);r&&(r.setStartBlock(e),r.handleFlyoutStart(t,this))}}onMouseDown_(e){const t=this.targetWorkspace.getGesture(e);t&&t.handleFlyoutStart(e,this)}isBlockCreatable(e){return e.isEnabled()}createBlock(e){let t=null;Zt();var r=this.targetWorkspace.getAllVariables();this.targetWorkspace.setResizesEnabled(false);try{t=this.placeNewBlock_(e)}finally{ss()}if(this.targetWorkspace.hideChaff(),e=bi(this.targetWorkspace,r),ls()){for(He(true),r=0;r<e.length;r++){const a=e[r];Pe(new(Re(Xr))(a))}Pe(new(Re(ks))(t))}return this.autoClose?this.hide():this.filterForCapacity_(),t}initFlyoutButton_(e,t,r){const a=e.createDom();e.moveTo(t,r),e.show(),this.listeners_.push(S(a,"pointerdown",this,this.onMouseDown_)),this.buttons_.push(e)}createRect_(e,t,r,a,d){return t=H(ee.RECT,{"fill-opacity":0,x:t,y:r,height:a.height,width:a.width}),t.tooltip=e,Sc(t),this.workspace_.getCanvas().insertBefore(t,e.getSvgRoot()),this.rectMap_.set(e,t),this.mats_[d]=t}moveRectToBlock_(e,t){const r=t.getHeightWidth();e.setAttribute("width",r.width.toString()),e.setAttribute("height",r.height.toString()),t=t.getRelativeToSurfaceXY(),e.setAttribute("y",t.y.toString()),e.setAttribute("x",(this.RTL?t.x-r.width:t.x).toString())}filterForCapacity_(){const e=this.workspace_.getTopBlocks(false);for(let t=0,r;r=e[t];t++)if(this.permanentlyDisabled_.indexOf(r)===-1){const a=this.targetWorkspace.isCapacityAvailable(j(r));for(;r;)r.setEnabled(a),r=r.getNextBlock()}}reflow(){this.reflowWrapper_&&this.workspace_.removeChangeListener(this.reflowWrapper_),this.reflowInternal_(),this.reflowWrapper_&&this.workspace_.addChangeListener(this.reflowWrapper_)}isScrollable(){return this.workspace_.scrollbar?this.workspace_.scrollbar.isVisible():false}placeNewBlock_(e){var t=this.targetWorkspace;if(!e.getSvgRoot())throw Error("oldBlock is not rendered.");const r=xn(e);return t.setResizesEnabled(false),t=Hr(r,t),this.positionNewBlock_(e,t),t}positionNewBlock_(e,t){const r=this.targetWorkspace;var a=r.getOriginOffsetInPixels(),d=this.workspace_.getOriginOffsetInPixels();e=e.getRelativeToSurfaceXY(),e.scale(this.workspace_.scale),d=Oe.sum(d,e),a=Oe.difference(d,a),a.scale(1/r.scale),t.moveTo(new Oe(a.x,a.y))}};Tu.FlyoutItemType=ra;var A_=class extends Tu{constructor(e){super(e)}setMetrics_(e){if(this.isVisible()){var t=this.workspace_.getMetricsManager(),r=t.getScrollMetrics(),a=t.getViewMetrics();t=t.getAbsoluteMetrics(),typeof e.y=="number"&&(this.workspace_.scrollY=-(r.top+(r.height-a.height)*e.y)),this.workspace_.translate(this.workspace_.scrollX+t.left,this.workspace_.scrollY+t.top)}}getX(){if(!this.isVisible())return 0;var e=this.targetWorkspace.getMetricsManager();const t=e.getAbsoluteMetrics(),r=e.getViewMetrics();return e=e.getToolboxMetrics(),this.targetWorkspace.toolboxPosition===this.toolboxPosition_?this.targetWorkspace.getToolbox()?this.toolboxPosition_===it.LEFT?e.width:r.width-this.width_:this.toolboxPosition_===it.LEFT?0:r.width:this.toolboxPosition_===it.LEFT?0:r.width+t.left-this.width_}getY(){return 0}position(){if(this.isVisible()&&this.targetWorkspace.isVisible()){var e=this.targetWorkspace.getMetricsManager().getViewMetrics();this.height_=e.height,this.setBackgroundPath_(this.width_-this.CORNER_RADIUS,e.height-2*this.CORNER_RADIUS),e=this.getX();var t=this.getY();this.positionAt_(this.width_,this.height_,e,t)}}setBackgroundPath_(e,t){const r=this.toolboxPosition_===it.RIGHT;var a=e+this.CORNER_RADIUS;a=["M "+(r?a:0)+",0"],a.push("h",r?-e:e),a.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,r?0:1,r?-this.CORNER_RADIUS:this.CORNER_RADIUS,this.CORNER_RADIUS),a.push("v",Math.max(0,t)),a.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,r?0:1,r?this.CORNER_RADIUS:-this.CORNER_RADIUS,this.CORNER_RADIUS),a.push("h",r?e:-e),a.push("z"),this.svgBackground_.setAttribute("d",a.join(" "))}scrollToStart(){let e;(e=this.workspace_.scrollbar)==null||e.setY(0)}wheel_(e){var t=R(e);if(t.y){const r=this.workspace_.getMetricsManager(),a=r.getScrollMetrics();t=r.getViewMetrics().top-a.top+t.y;let d;(d=this.workspace_.scrollbar)==null||d.setY(t),En(),Lt()}e.preventDefault(),e.stopPropagation()}layout_(e,t){this.workspace_.scale=this.targetWorkspace.scale;var r=this.MARGIN;const a=this.RTL?r:r+this.tabWidth_;for(let Y=0,pe;pe=e[Y];Y++)if(pe.type==="block"){var d=pe.block,C=d.getDescendants(false);for(let Et=0,zt;zt=C[Et];Et++)zt.isInFlyout=true;d.render(),C=d.getSvgRoot();const we=d.getHeightWidth();var D=d.outputConnection?a-this.tabWidth_:a;d.moveBy(D,r),D=this.createRect_(d,this.RTL?D-we.width:D,r,we,Y),this.addBlockListeners_(C,d,D),r+=we.height+t[Y]}else pe.type==="button"&&(d=pe.button,this.initFlyoutButton_(d,a,r),r+=d.height+t[Y])}isDragTowardWorkspace(e){e=Math.atan2(e.y,e.x)/Math.PI*180;const t=this.dragAngleRange_;return e<t&&e>-t||e<-180+t||e>180-t}getClientRect(){if(!this.svgGroup_||this.autoClose||!this.isVisible())return null;const e=this.svgGroup_.getBoundingClientRect(),t=e.left;return this.toolboxPosition_===it.LEFT?new ts(-1e9,1e9,-1e9,t+e.width):new ts(-1e9,1e9,t,1e9)}reflowInternal_(){this.workspace_.scale=this.getFlyoutScale();let e=0;var t=this.workspace_.getTopBlocks(false);for(let a=0,d;d=t[a];a++){var r=d.getHeightWidth().width;d.outputConnection&&(r-=this.tabWidth_),e=Math.max(e,r)}for(let a=0,d;d=this.buttons_[a];a++)e=Math.max(e,d.width);if(e+=1.5*this.MARGIN+this.tabWidth_,e*=this.workspace_.scale,e+=Kt.scrollbarThickness,this.width_!==e){for(let a=0,d;d=t[a];a++){if(this.RTL){r=d.getRelativeToSurfaceXY().x;let C=e/this.workspace_.scale-this.MARGIN;d.outputConnection||(C-=this.tabWidth_),d.moveBy(C-r,0)}this.rectMap_.has(d)&&this.moveRectToBlock_(this.rectMap_.get(d),d)}if(this.RTL)for(let a=0,d;d=this.buttons_[a];a++)t=d.getPosition().y,d.moveTo(e/this.workspace_.scale-d.width-this.MARGIN-this.tabWidth_,t);this.targetWorkspace.toolboxPosition!==this.toolboxPosition_||this.toolboxPosition_!==it.LEFT||this.targetWorkspace.getToolbox()||this.targetWorkspace.translate(this.targetWorkspace.scrollX+e,this.targetWorkspace.scrollY),this.width_=e,this.position(),this.targetWorkspace.recordDragTargets()}}};A_.registryName="verticalFlyout",$e(Te.FLYOUTS_VERTICAL_TOOLBOX,Un,A_);var qb=class extends Tu{constructor(e){super(e),this.horizontalLayout=true}setMetrics_(e){if(this.isVisible()){var t=this.workspace_.getMetricsManager(),r=t.getScrollMetrics(),a=t.getViewMetrics();t=t.getAbsoluteMetrics(),typeof e.x=="number"&&(this.workspace_.scrollX=-(r.left+(r.width-a.width)*e.x)),this.workspace_.translate(this.workspace_.scrollX+t.left,this.workspace_.scrollY+t.top)}}getX(){return 0}getY(){if(!this.isVisible())return 0;var e=this.targetWorkspace.getMetricsManager();const t=e.getAbsoluteMetrics(),r=e.getViewMetrics();e=e.getToolboxMetrics();const a=this.toolboxPosition_===it.TOP;return this.targetWorkspace.toolboxPosition===this.toolboxPosition_?this.targetWorkspace.getToolbox()?a?e.height:r.height-this.height_:a?0:r.height:a?0:r.height+t.top-this.height_}position(){if(this.isVisible()&&this.targetWorkspace.isVisible()){var e=this.targetWorkspace.getMetricsManager().getViewMetrics();this.width_=e.width,this.setBackgroundPath_(e.width-2*this.CORNER_RADIUS,this.height_-this.CORNER_RADIUS),e=this.getX();var t=this.getY();this.positionAt_(this.width_,this.height_,e,t)}}setBackgroundPath_(e,t){const r=this.toolboxPosition_===it.TOP,a=["M 0,"+(r?0:this.CORNER_RADIUS)];r?(a.push("h",e+2*this.CORNER_RADIUS),a.push("v",t),a.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,-this.CORNER_RADIUS,this.CORNER_RADIUS),a.push("h",-e),a.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,-this.CORNER_RADIUS,-this.CORNER_RADIUS)):(a.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,this.CORNER_RADIUS,-this.CORNER_RADIUS),a.push("h",e),a.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,this.CORNER_RADIUS,this.CORNER_RADIUS),a.push("v",t),a.push("h",-e-2*this.CORNER_RADIUS)),a.push("z"),this.svgBackground_.setAttribute("d",a.join(" "))}scrollToStart(){let e;(e=this.workspace_.scrollbar)==null||e.setX(this.RTL?1/0:0)}wheel_(e){var t=R(e);if(t=t.x||t.y){const r=this.workspace_.getMetricsManager(),a=r.getScrollMetrics();t=r.getViewMetrics().left-a.left+t;let d;(d=this.workspace_.scrollbar)==null||d.setX(t),En(),Lt()}e.preventDefault(),e.stopPropagation()}layout_(e,t){this.workspace_.scale=this.targetWorkspace.scale;const r=this.MARGIN;let a=r+this.tabWidth_;this.RTL&&(e=e.reverse());for(let Y=0,pe;pe=e[Y];Y++)if(pe.type==="block"){var d=pe.block,C=d.getDescendants(false);for(let Et=0,zt;zt=C[Et];Et++)zt.isInFlyout=true;d.render(),C=d.getSvgRoot();const we=d.getHeightWidth();var D=d.outputConnection?this.tabWidth_:0;D=this.RTL?a+we.width:a-D,d.moveBy(D,r),D=this.createRect_(d,D,r,we,Y),a+=we.width+t[Y],this.addBlockListeners_(C,d,D)}else pe.type==="button"&&(d=pe.button,this.initFlyoutButton_(d,a,r),a+=d.width+t[Y])}isDragTowardWorkspace(e){e=Math.atan2(e.y,e.x)/Math.PI*180;const t=this.dragAngleRange_;return e<90+t&&e>90-t||e>-90-t&&e<-90+t}getClientRect(){if(!this.svgGroup_||this.autoClose||!this.isVisible())return null;const e=this.svgGroup_.getBoundingClientRect(),t=e.top;return this.toolboxPosition_===it.TOP?new ts(-1e9,t+e.height,-1e9,1e9):new ts(t,1e9,-1e9,1e9)}reflowInternal_(){this.workspace_.scale=this.getFlyoutScale();let e=0;const t=this.workspace_.getTopBlocks(false);for(let a=0,d;d=t[a];a++)e=Math.max(e,d.getHeightWidth().height);const r=this.buttons_;for(let a=0,d;d=r[a];a++)e=Math.max(e,d.height);if(e+=1.5*this.MARGIN,e*=this.workspace_.scale,e+=Kt.scrollbarThickness,this.height_!==e){for(let a=0,d;d=t[a];a++)this.rectMap_.has(d)&&this.moveRectToBlock_(this.rectMap_.get(d),d);this.targetWorkspace.toolboxPosition!==this.toolboxPosition_||this.toolboxPosition_!==it.TOP||this.targetWorkspace.getToolbox()||this.targetWorkspace.translate(this.targetWorkspace.scrollX,this.targetWorkspace.scrollY+e),this.height_=e,this.position(),this.targetWorkspace.recordDragTargets()}}};$e(Te.FLYOUTS_HORIZONTAL_TOOLBOX,Un,qb);var Ol=class extends rn{constructor(e,t,r,a,d){super(pt.SKIP_SETUP),this.defaultType_="",this.variableTypes=[],this.variable_=null,this.SERIALIZABLE=true,this.menuGenerator_=Ol.dropdownCreate,this.defaultVariableName=typeof e=="string"?e:"",this.size_=new Ss(0,0),e!==pt.SKIP_SETUP&&(d?this.configure_(d):this.setTypes_(r,a),t&&this.setValidator(t))}configure_(e){super.configure_(e),this.setTypes_(e.variableTypes,e.defaultType)}initModel(){var e=this.getSourceBlock();if(!e)throw new hs;this.variable_||(e=ht(e.workspace,null,this.defaultVariableName,this.defaultType_),this.doValueUpdate_(e.getId()))}shouldAddBorderRect_(){const e=this.getSourceBlock();if(!e)throw new hs;return super.shouldAddBorderRect_()&&(!this.getConstants().FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW||e.type!=="variables_get")}fromXml(e){var t=this.getSourceBlock();if(!t)throw new hs;const r=e.getAttribute("id"),a=e.textContent,d=e.getAttribute("variabletype")||e.getAttribute("variableType")||"";if(t=ht(t.workspace,r,a,d),d!==null&&d!==t.type)throw Error("Serialized variable type with id '"+t.getId()+"' had type "+t.type+", and does not match variable field that references it: "+Bi(e)+".");this.setValue(t.getId())}toXml(e){return this.initModel(),e.id=this.variable_.getId(),e.textContent=this.variable_.name,this.variable_.type&&e.setAttribute("variabletype",this.variable_.type),e}saveState(e){var t=this.saveLegacyState(Ol);return t!==null||(this.initModel(),t={id:this.variable_.getId()},e&&(t.name=this.variable_.name,t.type=this.variable_.type)),t}loadState(e){const t=this.getSourceBlock();if(!t)throw new hs;this.loadLegacyState(Ol,e)||(e=ht(t.workspace,e.id||null,e.name,e.type||""),this.setValue(e.getId()))}setSourceBlock(e){if(e.isShadow())throw Error("Variable fields are not allowed to exist on shadow blocks.");super.setSourceBlock(e)}getValue(){return this.variable_?this.variable_.getId():null}getText(){return this.variable_?this.variable_.name:""}getVariable(){return this.variable_}getValidator(){return this.variable_?this.validator_:null}doClassValidation_(e){if(e===null)return null;var t=this.getSourceBlock();if(!t)throw new hs;return t=$t(t.workspace,e),t?(t=t.type,this.typeIsAllowed_(t)?e:(console.warn("Variable type doesn't match this field!  Type was "+t),null)):(console.warn("Variable id doesn't point to a real variable! ID was "+e),null)}doValueUpdate_(e){const t=this.getSourceBlock();if(!t)throw new hs;this.variable_=$t(t.workspace,e),super.doValueUpdate_(e)}typeIsAllowed_(e){const t=this.getVariableTypes_();if(!t)return true;for(let r=0;r<t.length;r++)if(e===t[r])return true;return false}getVariableTypes_(){var e=this.variableTypes;if(e===null&&this.sourceBlock_&&!this.sourceBlock_.isDeadOrDying())return this.sourceBlock_.workspace.getVariableTypes();if(e=e||[""],e.length===0)throw e=this.getText(),Error("'variableTypes' of field variable "+e+" was an empty list");return e}setTypes_(e,t){if(t=t||"",e==null)e=null;else if(Array.isArray(e)){let r=false;for(let a=0;a<e.length;a++)e[a]===t&&(r=true);if(!r)throw Error("Invalid default type '"+t+"' in the definition of a FieldVariable")}else throw Error("'variableTypes' was not an array in the definition of a FieldVariable");this.defaultType_=t,this.variableTypes=e}refreshVariableName(){this.forceRerender()}onItemSelected_(e,t){if(e=t.getValue(),this.sourceBlock_&&!this.sourceBlock_.isDeadOrDying()){if(e===e_){mn(this.sourceBlock_.workspace,this.variable_);return}if(e===t_){this.sourceBlock_.workspace.deleteVariableById(this.variable_.getId());return}}this.setValue(e)}referencesVariables(){return true}static fromJson(e){return new this(es(e.variable),void 0,void 0,void 0,e)}static dropdownCreate(){if(!this.variable_)throw Error("Tried to call dropdownCreate on a variable field with no variable selected.");const e=this.getText();let t=[];if(this.sourceBlock_&&!this.sourceBlock_.isDeadOrDying())for(var r=this.getVariableTypes_(),a=0;a<r.length;a++){const d=this.sourceBlock_.workspace.getVariablesOfType(r[a]);t=t.concat(d)}for(t.sort(Ja.compareByName),r=[],a=0;a<t.length;a++)r[a]=[t[a].name,t[a].getId()];return r.push([Je.RENAME_VARIABLE,e_]),Je.DELETE_VARIABLE&&r.push([Je.DELETE_VARIABLE.replace("%1",e),t_]),r}};Pi("field_variable",Ol);var L_=class extends Il{constructor(e,t,r,a,d,C){super(pt.SKIP_SETUP),this.min_=-1/0,this.max_=1/0,this.precision_=0,this.decimalPlaces_=null,this.SERIALIZABLE=true,this.spellcheck_=false,e!==pt.SKIP_SETUP&&(C?this.configure_(C):this.setConstraints(t,r,a),this.setValue(e),d&&this.setValidator(d))}configure_(e){super.configure_(e),this.setMinInternal_(e.min),this.setMaxInternal_(e.max),this.setPrecisionInternal_(e.precision)}setConstraints(e,t,r){this.setMinInternal_(e),this.setMaxInternal_(t),this.setPrecisionInternal_(r),this.setValue(this.getValue())}setMin(e){this.setMinInternal_(e),this.setValue(this.getValue())}setMinInternal_(e){e==null?this.min_=-1/0:(e=Number(e),isNaN(e)||(this.min_=e))}getMin(){return this.min_}setMax(e){this.setMaxInternal_(e),this.setValue(this.getValue())}setMaxInternal_(e){e==null?this.max_=1/0:(e=Number(e),isNaN(e)||(this.max_=e))}getMax(){return this.max_}setPrecision(e){this.setPrecisionInternal_(e),this.setValue(this.getValue())}setPrecisionInternal_(e){this.precision_=Number(e)||0;let t=String(this.precision_);t.indexOf("e")!==-1&&(t=this.precision_.toLocaleString("en-US",{maximumFractionDigits:20}));const r=t.indexOf(".");this.decimalPlaces_=r===-1?e?0:null:t.length-r-1}getPrecision(){return this.precision_}doClassValidation_(e){return e===null||(e=String(e),e=e.replace(/O/ig,"0"),e=e.replace(/,/g,""),e=e.replace(/infinity/i,"Infinity"),e=Number(e||0),isNaN(e))?null:(e=Math.min(Math.max(e,this.min_),this.max_),this.precision_&&isFinite(e)&&(e=Math.round(e/this.precision_)*this.precision_),this.decimalPlaces_!==null&&(e=Number(e.toFixed(this.decimalPlaces_))),e)}widgetCreate_(){const e=super.widgetCreate_();return-1/0<this.min_&&Xt(e,Gt.VALUEMIN,this.min_),1/0>this.max_&&Xt(e,Gt.VALUEMAX,this.max_),e}static fromJson(e){return new this(e.value,void 0,void 0,void 0,void 0,e)}};Pi("field_number",L_),L_.prototype.DEFAULT_VALUE=0;var N_=class extends i.FieldTextInput$$module$build$src$core$field_textinput{constructor(e,t,r){super(pt.SKIP_SETUP),this.textGroup_=null,this.maxLines_=1/0,this.isOverflowedY_=false,e!==pt.SKIP_SETUP&&(r&&this.configure_(r),this.setValue(e),t&&this.setValidator(t))}configure_(e){super.configure_(e),e.maxLines&&this.setMaxLines(e.maxLines)}toXml(e){return e.textContent=this.getValue().replace(/\n/g,"&#10;"),e}fromXml(e){this.setValue(e.textContent.replace(/&#10;/g,`
`))}saveState(){const e=this.saveLegacyState(N_);return e!==null?e:this.getValue()}loadState(e){this.loadLegacyState(pt,e)||this.setValue(e)}initView(){this.createBorderRect_(),this.textGroup_=H(ee.G,{class:"blocklyEditableText"},this.fieldGroup_)}getDisplayText_(){const e=this.getSourceBlock();if(!e)throw new hs;let t=this.getText();if(!t)return pt.NBSP;const r=t.split(`
`);t="";const a=this.isOverflowedY_?this.maxLines_:r.length;for(let d=0;d<a;d++){let C=r[d];C.length>this.maxDisplayLength?C=C.substring(0,this.maxDisplayLength-4)+"...":this.isOverflowedY_&&d===a-1&&(C=C.substring(0,C.length-3)+"..."),C=C.replace(/\s/g,pt.NBSP),t+=C,d!==a-1&&(t+=`
`)}return e.RTL&&(t+="‏"),t}doValueUpdate_(e){super.doValueUpdate_(e),this.isOverflowedY_=this.value_.split(`
`).length>this.maxLines_}render_(){var e=this.getSourceBlock();if(!e)throw new hs;for(var t;t=this.textGroup_.firstChild;)this.textGroup_.removeChild(t);t=this.getDisplayText_().split(`
`);let r=0;for(let a=0;a<t.length;a++){const d=this.getConstants().FIELD_TEXT_HEIGHT+this.getConstants().FIELD_BORDER_RECT_Y_PADDING;H(ee.TEXT,{class:"blocklyText blocklyMultilineText",x:this.getConstants().FIELD_BORDER_RECT_X_PADDING,y:r+this.getConstants().FIELD_BORDER_RECT_Y_PADDING,dy:this.getConstants().FIELD_TEXT_BASELINE},this.textGroup_).appendChild(document.createTextNode(t[a])),r+=d}this.isBeingEdited_&&(t=this.htmlInput_,this.isOverflowedY_?ie(t,"blocklyHtmlTextAreaInputOverflowedY"):he(t,"blocklyHtmlTextAreaInputOverflowedY")),this.updateSize_(),this.isBeingEdited_&&(e.RTL?setTimeout(this.resizeEditor_.bind(this),0):this.resizeEditor_(),e=this.htmlInput_,this.isTextValid_?(he(e,"blocklyInvalidInput"),Xt(e,Gt.INVALID,false)):(ie(e,"blocklyInvalidInput"),Xt(e,Gt.INVALID,true)))}updateSize_(){var e=this.textGroup_.childNodes;const t=this.getConstants().FIELD_TEXT_FONTSIZE,r=this.getConstants().FIELD_TEXT_FONTWEIGHT,a=this.getConstants().FIELD_TEXT_FONTFAMILY;let d=0,C=0;for(var D=0;D<e.length;D++){var Y=St(e[D],t,r,a);Y>d&&(d=Y),C+=this.getConstants().FIELD_TEXT_HEIGHT+(0<D?this.getConstants().FIELD_BORDER_RECT_Y_PADDING:0)}if(this.isBeingEdited_){for(e=this.value_.split(`
`),D=H(ee.TEXT,{class:"blocklyText blocklyMultilineText"}),Y=0;Y<e.length;Y++){e[Y].length>this.maxDisplayLength&&(e[Y]=e[Y].substring(0,this.maxDisplayLength)),D.textContent=e[Y];const pe=St(D,t,r,a);pe>d&&(d=pe)}d+=this.htmlInput_.offsetWidth-this.htmlInput_.clientWidth}this.borderRect_&&(C+=2*this.getConstants().FIELD_BORDER_RECT_Y_PADDING,d+=2*this.getConstants().FIELD_BORDER_RECT_X_PADDING,this.borderRect_.setAttribute("width",d),this.borderRect_.setAttribute("height",C)),this.size_.width=d,this.size_.height=C,this.positionBorderRect_()}showEditor_(e,t){super.showEditor_(e,t),this.forceRerender()}widgetCreate_(){const e=ko(),t=this.workspace_.getScale(),r=document.createElement("textarea");r.className="blocklyHtmlInput blocklyHtmlTextAreaInput",r.setAttribute("spellcheck",this.spellcheck_);var a=this.getConstants().FIELD_TEXT_FONTSIZE*t+"pt";e.style.fontSize=a,r.style.fontSize=a,r.style.borderRadius=i.FieldTextInput$$module$build$src$core$field_textinput.BORDERRADIUS*t+"px",a=this.getConstants().FIELD_BORDER_RECT_X_PADDING*t;const d=this.getConstants().FIELD_BORDER_RECT_Y_PADDING*t/2;return r.style.padding=d+"px "+a+"px "+d+"px "+a+"px",a=this.getConstants().FIELD_TEXT_HEIGHT+this.getConstants().FIELD_BORDER_RECT_Y_PADDING,r.style.lineHeight=a*t+"px",e.appendChild(r),r.value=r.defaultValue=this.getEditorText_(this.value_),r.setAttribute("data-untyped-default-value",this.value_),r.setAttribute("data-old-value",""),_d?setTimeout(this.resizeEditor_.bind(this),0):this.resizeEditor_(),this.bindInputEvents_(r),r}setMaxLines(e){typeof e=="number"&&0<e&&e!==this.maxLines_&&(this.maxLines_=e,this.forceRerender())}getMaxLines(){return this.maxLines_}onHtmlInputKeyDown_(e){e.keyCode!==xe.ENTER&&super.onHtmlInputKeyDown_(e)}static fromJson(e){return new this(es(e.text),void 0,e)}};Ti(`
.blocklyHtmlTextAreaInput {
  font-family: monospace;
  resize: none;
  overflow: hidden;
  height: 100%;
  text-align: left;
}

.blocklyHtmlTextAreaInputOverflowedY {
  overflow-y: scroll;
}
`),Pi("field_multilinetext",N_);var Jb=class extends i.FieldLabel$$module$build$src$core$field_label{constructor(e,t,r){super(String(e??""),t,r),this.EDITABLE=false,this.SERIALIZABLE=true}static fromJson(e){return new this(es(e.text),void 0,e)}};Pi("field_label_serializable",Jb);var Ci=class extends pt{constructor(e,t,r){super(pt.SKIP_SETUP),this.onKeyDownWrapper_=this.onMouseLeaveWrapper_=this.onMouseEnterWrapper_=this.onMouseMoveWrapper_=this.onClickWrapper_=this.highlightedIndex_=this.picker_=null,this.SERIALIZABLE=true,this.CURSOR="default",this.isDirty_=false,this.titles_=this.colours_=null,this.columns_=0,e!==pt.SKIP_SETUP&&(r&&this.configure_(r),this.setValue(e),t&&this.setValidator(t))}configure_(e){super.configure_(e),e.colourOptions&&(this.colours_=e.colourOptions),e.colourTitles&&(this.titles_=e.colourTitles),e.columns&&(this.columns_=e.columns)}initView(){this.size_=new Ss(this.getConstants().FIELD_COLOUR_DEFAULT_WIDTH,this.getConstants().FIELD_COLOUR_DEFAULT_HEIGHT),this.getConstants().FIELD_COLOUR_FULL_BLOCK?this.sourceBlock_ instanceof Fi&&(this.clickTarget_=this.sourceBlock_.getSvgRoot()):(this.createBorderRect_(),this.getBorderRect().style.fillOpacity="1")}applyColour(){this.getConstants().FIELD_COLOUR_FULL_BLOCK?this.sourceBlock_ instanceof Fi&&(this.sourceBlock_.pathObject.svgPath.setAttribute("fill",this.getValue()),this.sourceBlock_.pathObject.svgPath.setAttribute("stroke","#fff")):this.borderRect_&&(this.borderRect_.style.fill=this.getValue())}doClassValidation_(e){return typeof e!="string"?null:Gr(e)}doValueUpdate_(e){this.value_=e,this.borderRect_?this.borderRect_.style.fill=e:this.sourceBlock_&&this.sourceBlock_.rendered&&this.sourceBlock_ instanceof Fi&&(this.sourceBlock_.pathObject.svgPath.setAttribute("fill",e),this.sourceBlock_.pathObject.svgPath.setAttribute("stroke","#fff"))}getText(){let e=this.value_;return/^#(.)\1(.)\2(.)\3$/.test(e)&&(e="#"+e[1]+e[3]+e[5]),e}setColours(e,t){return this.colours_=e,t&&(this.titles_=t),this}setColumns(e){return this.columns_=e,this}showEditor_(){this.dropdownCreate_(),xi().appendChild(this.picker_),Z(this,this.dropdownDispose_.bind(this)),this.picker_.focus({preventScroll:true})}onClick_(e){e=(e=e.target)&&e.getAttribute("data-colour"),e!==null&&(this.setValue(e),et(this))}onKeyDown_(e){var t=false;e.keyCode===xe.UP?(this.moveHighlightBy_(0,-1),t=true):e.keyCode===xe.DOWN?(this.moveHighlightBy_(0,1),t=true):e.keyCode===xe.LEFT?(this.moveHighlightBy_(-1,0),t=true):e.keyCode===xe.RIGHT?(this.moveHighlightBy_(1,0),t=true):e.keyCode===xe.ENTER&&((t=this.getHighlighted_())&&(t=t&&t.getAttribute("data-colour"),t!==null&&this.setValue(t)),Lt(),t=true),t&&e.stopPropagation()}moveHighlightBy_(e,t){if(this.highlightedIndex_){var r=this.colours_||Ci.COLOURS,a=this.columns_||Ci.COLUMNS,d=this.highlightedIndex_%a,C=Math.floor(this.highlightedIndex_/a);d+=e,C+=t,0>e?0>d&&0<C?(d=a-1,C--):0>d&&(d=0):0<e?d>a-1&&C<Math.floor(r.length/a)-1?(d=0,C++):d>a-1&&d--:0>t?0>C&&(C=0):0<t&&C>Math.floor(r.length/a)-1&&(C=Math.floor(r.length/a)-1),this.setHighlightedCell_(this.picker_.childNodes[C].childNodes[d],C*a+d)}}onMouseMove_(e){const t=(e=e.target)&&Number(e.getAttribute("data-index"));t!==null&&t!==this.highlightedIndex_&&this.setHighlightedCell_(e,t)}onMouseEnter_(){this.picker_.focus({preventScroll:true})}onMouseLeave_(){this.picker_.blur();const e=this.getHighlighted_();e&&he(e,"blocklyColourHighlighted")}getHighlighted_(){if(!this.highlightedIndex_)return null;const e=this.columns_||Ci.COLUMNS,t=this.picker_.childNodes[Math.floor(this.highlightedIndex_/e)];return t?t.childNodes[this.highlightedIndex_%e]:null}setHighlightedCell_(e,t){const r=this.getHighlighted_();r&&he(r,"blocklyColourHighlighted"),ie(e,"blocklyColourHighlighted"),this.highlightedIndex_=t,Xt(this.picker_,Gt.ACTIVEDESCENDANT,e.getAttribute("id"))}dropdownCreate_(){const e=this.columns_||Ci.COLUMNS,t=this.colours_||Ci.COLOURS,r=this.titles_||Ci.TITLES,a=this.getValue(),d=document.createElement("table");d.className="blocklyColourTable",d.tabIndex=0,d.dir="ltr",vn(d,ci.GRID),Xt(d,Gt.EXPANDED,true),Xt(d,Gt.ROWCOUNT,Math.floor(t.length/e)),Xt(d,Gt.COLCOUNT,e);let C;for(let D=0;D<t.length;D++){D%e===0&&(C=document.createElement("tr"),vn(C,ci.ROW),d.appendChild(C));const Y=document.createElement("td");C.appendChild(Y),Y.setAttribute("data-colour",t[D]),Y.title=r[D]||t[D],Y.id=Dr(),Y.setAttribute("data-index",D),vn(Y,ci.GRIDCELL),Xt(Y,Gt.LABEL,t[D]),Xt(Y,Gt.SELECTED,t[D]===a),Y.style.backgroundColor=t[D],t[D]===a&&(Y.className="blocklyColourSelected",this.highlightedIndex_=D)}this.onClickWrapper_=S(d,"pointerdown",this,this.onClick_,true),this.onMouseMoveWrapper_=S(d,"pointermove",this,this.onMouseMove_,true),this.onMouseEnterWrapper_=S(d,"pointerenter",this,this.onMouseEnter_,true),this.onMouseLeaveWrapper_=S(d,"pointerleave",this,this.onMouseLeave_,true),this.onKeyDownWrapper_=S(d,"keydown",this,this.onKeyDown_),this.picker_=d}dropdownDispose_(){this.onClickWrapper_&&(g(this.onClickWrapper_),this.onClickWrapper_=null),this.onMouseMoveWrapper_&&(g(this.onMouseMoveWrapper_),this.onMouseMoveWrapper_=null),this.onMouseEnterWrapper_&&(g(this.onMouseEnterWrapper_),this.onMouseEnterWrapper_=null),this.onMouseLeaveWrapper_&&(g(this.onMouseLeaveWrapper_),this.onMouseLeaveWrapper_=null),this.onKeyDownWrapper_&&(g(this.onKeyDownWrapper_),this.onKeyDownWrapper_=null),this.highlightedIndex_=this.picker_=null}static fromJson(e){return new this(e.colour,void 0,e)}};Ci.COLOURS="#ffffff #cccccc #c0c0c0 #999999 #666666 #333333 #000000 #ffcccc #ff6666 #ff0000 #cc0000 #990000 #660000 #330000 #ffcc99 #ff9966 #ff9900 #ff6600 #cc6600 #993300 #663300 #ffff99 #ffff66 #ffcc66 #ffcc33 #cc9933 #996633 #663333 #ffffcc #ffff33 #ffff00 #ffcc00 #999900 #666600 #333300 #99ff99 #66ff99 #33ff33 #33cc00 #009900 #006600 #003300 #99ffff #33ffff #66cccc #00cccc #339999 #336666 #003333 #ccffff #66ffff #33ccff #3366ff #3333ff #000099 #000066 #ccccff #9999ff #6666cc #6633ff #6600cc #333399 #330099 #ffccff #ff99ff #cc66cc #cc33cc #993399 #663366 #330033".split(" "),Ci.TITLES=[],Ci.COLUMNS=7,Ci.prototype.DEFAULT_VALUE=Ci.COLOURS[0],Ti(`
.blocklyColourTable {
  border-collapse: collapse;
  display: block;
  outline: none;
  padding: 1px;
}

.blocklyColourTable>tr>td {
  border: .5px solid #888;
  box-sizing: border-box;
  cursor: pointer;
  display: inline-block;
  height: 20px;
  padding: 0;
  width: 20px;
}

.blocklyColourTable>tr>td.blocklyColourHighlighted {
  border-color: #eee;
  box-shadow: 2px 2px 7px 2px rgba(0,0,0,.3);
  position: relative;
}

.blocklyColourSelected, .blocklyColourSelected:hover {
  border-color: #eee !important;
  outline: 1px solid #333;
  position: relative;
}
`),Pi("field_colour",Ci),i.FieldCheckbox$$module$build$src$core$field_checkbox=class extends pt{constructor(e,t,r){super(pt.SKIP_SETUP),this.SERIALIZABLE=true,this.CURSOR="default",this.checkChar_=i.FieldCheckbox$$module$build$src$core$field_checkbox.CHECK_CHAR,e!==pt.SKIP_SETUP&&(r&&this.configure_(r),this.setValue(e),t&&this.setValidator(t))}configure_(e){super.configure_(e),e.checkCharacter&&(this.checkChar_=e.checkCharacter)}saveState(){const e=this.saveLegacyState(i.FieldCheckbox$$module$build$src$core$field_checkbox);return e!==null?e:this.getValueBoolean()}initView(){super.initView();const e=this.getTextElement();ie(e,"blocklyCheckbox"),e.style.display=this.value_?"block":"none"}render_(){this.textContent_&&(this.textContent_.nodeValue=this.getDisplayText_()),this.updateSize_(this.getConstants().FIELD_CHECKBOX_X_OFFSET)}getDisplayText_(){return this.checkChar_}setCheckCharacter(e){this.checkChar_=e||i.FieldCheckbox$$module$build$src$core$field_checkbox.CHECK_CHAR,this.forceRerender()}showEditor_(){this.setValue(!this.value_)}doClassValidation_(e){return e===true||e==="TRUE"?"TRUE":e===false||e==="FALSE"?"FALSE":null}doValueUpdate_(e){this.value_=this.convertValueToBool_(e),this.textElement_&&(this.textElement_.style.display=this.value_?"block":"none")}getValue(){return this.value_?"TRUE":"FALSE"}getValueBoolean(){return this.value_}getText(){return String(this.convertValueToBool_(this.value_))}convertValueToBool_(e){return typeof e=="string"?e==="TRUE":!!e}static fromJson(e){return new this(e.checked,void 0,e)}},i.FieldCheckbox$$module$build$src$core$field_checkbox.CHECK_CHAR="✓",Pi("field_checkbox",i.FieldCheckbox$$module$build$src$core$field_checkbox),i.FieldCheckbox$$module$build$src$core$field_checkbox.prototype.DEFAULT_VALUE=false,i.FieldCheckbox$$module$build$src$core$field_checkbox;var dt=class extends Il{constructor(e,t,r){super(pt.SKIP_SETUP),this.clockwise_=dt.CLOCKWISE,this.offset_=dt.OFFSET,this.wrap_=dt.WRAP,this.round_=dt.ROUND,this.moveSurfaceWrapper_=this.clickSurfaceWrapper_=this.clickWrapper_=this.symbol_=this.line_=this.gauge_=this.editor_=null,this.SERIALIZABLE=true,e!==pt.SKIP_SETUP&&(r&&this.configure_(r),this.setValue(e),t&&this.setValidator(t))}configure_(e){switch(super.configure_(e),e.mode){case Su.COMPASS:this.clockwise_=true,this.offset_=90;break;case Su.PROTRACTOR:this.clockwise_=false,this.offset_=0}e.clockwise&&(this.clockwise_=e.clockwise),e.offset&&(this.offset_=e.offset),e.wrap&&(this.wrap_=e.wrap),e.round&&(this.round_=e.round)}initView(){super.initView(),this.symbol_=H(ee.TSPAN,{}),this.symbol_.appendChild(document.createTextNode("°")),this.getTextElement().appendChild(this.symbol_)}render_(){super.render_(),this.updateGraph_()}showEditor_(e){super.showEditor_(e,gd||Gc||Lo),this.dropdownCreate_(),xi().appendChild(this.editor_),this.sourceBlock_ instanceof Fi&&N(this.sourceBlock_.style.colourPrimary,this.sourceBlock_.style.colourTertiary),Z(this,this.dropdownDispose_.bind(this)),this.updateGraph_()}dropdownCreate_(){const e=H(ee.SVG,{xmlns:Mo,"xmlns:html":Zi,"xmlns:xlink":ai,version:"1.1",height:2*dt.HALF+"px",width:2*dt.HALF+"px",style:"touch-action: none"}),t=H(ee.CIRCLE,{cx:dt.HALF,cy:dt.HALF,r:dt.RADIUS,class:"blocklyAngleCircle"},e);this.gauge_=H(ee.PATH,{class:"blocklyAngleGauge"},e),this.line_=H(ee.LINE,{x1:dt.HALF,y1:dt.HALF,class:"blocklyAngleLine"},e);for(let r=0;360>r;r+=15)H(ee.LINE,{x1:dt.HALF+dt.RADIUS,y1:dt.HALF,x2:dt.HALF+dt.RADIUS-(r%45===0?10:5),y2:dt.HALF,class:"blocklyAngleMarks",transform:"rotate("+r+","+dt.HALF+","+dt.HALF+")"},e);this.clickWrapper_=S(e,"click",this,this.hide_),this.clickSurfaceWrapper_=S(t,"pointerdown",this,this.onMouseMove_,true),this.moveSurfaceWrapper_=S(t,"pointermove",this,this.onMouseMove_,true),this.editor_=e}dropdownDispose_(){this.clickWrapper_&&(g(this.clickWrapper_),this.clickWrapper_=null),this.clickSurfaceWrapper_&&(g(this.clickSurfaceWrapper_),this.clickSurfaceWrapper_=null),this.moveSurfaceWrapper_&&(g(this.moveSurfaceWrapper_),this.moveSurfaceWrapper_=null),this.line_=this.gauge_=null}hide_(){et(this),En()}onMouseMove_(e){var t=this.gauge_.ownerSVGElement.getBoundingClientRect();const r=e.clientX-t.left-dt.HALF;e=e.clientY-t.top-dt.HALF,t=Math.atan(-e/r),isNaN(t)||(t=Is(t),0>r?t+=180:0<e&&(t+=360),t=this.clockwise_?this.offset_+360-t:360-(this.offset_-t),this.displayMouseOrKeyboardValue_(t))}displayMouseOrKeyboardValue_(e){this.round_&&(e=Math.round(e/this.round_)*this.round_),e=this.wrapValue_(e),e!==this.value_&&this.setEditorValue_(e)}updateGraph_(){if(this.gauge_){var e=Number(this.getText())+this.offset_,t=We(e%360);e=["M ",dt.HALF,",",dt.HALF];var r=dt.HALF,a=dt.HALF;if(!isNaN(t)){const d=Number(this.clockwise_),C=We(this.offset_),D=Math.cos(C)*dt.RADIUS,Y=Math.sin(C)*-dt.RADIUS;d&&(t=2*C-t),r+=Math.cos(t)*dt.RADIUS,a-=Math.sin(t)*dt.RADIUS,t=Math.abs(Math.floor((t-C)/Math.PI)%2),d&&(t=1-t),e.push(" l ",D,",",Y," A ",dt.RADIUS,",",dt.RADIUS," 0 ",t," ",d," ",r,",",a," z")}this.gauge_.setAttribute("d",e.join("")),this.line_.setAttribute("x2",r),this.line_.setAttribute("y2",a)}}onHtmlInputKeyDown_(e){super.onHtmlInputKeyDown_(e);var t=this.getSourceBlock();if(!t)throw new hs;let r;e.keyCode===xe.LEFT?r=t.RTL?1:-1:e.keyCode===xe.RIGHT?r=t.RTL?-1:1:e.keyCode===xe.DOWN?r=-1:e.keyCode===xe.UP&&(r=1),r&&(t=this.getValue(),this.displayMouseOrKeyboardValue_(t+r*this.round_),e.preventDefault(),e.stopPropagation())}doClassValidation_(e){return e=Number(e),isNaN(e)||!isFinite(e)?null:this.wrapValue_(e)}wrapValue_(e){return e%=360,0>e&&(e+=360),e>this.wrap_&&(e-=360),e}static fromJson(e){return new this(e.angle,void 0,e)}};dt.ROUND=15,dt.HALF=50,dt.CLOCKWISE=false,dt.OFFSET=0,dt.WRAP=360,dt.RADIUS=dt.HALF-1,Ti(`
.blocklyAngleCircle {
  stroke: #444;
  stroke-width: 1;
  fill: #ddd;
  fill-opacity: .8;
}

.blocklyAngleMarks {
  stroke: #444;
  stroke-width: 1;
}

.blocklyAngleGauge {
  fill: #f88;
  fill-opacity: .8;
  pointer-events: none;
}

.blocklyAngleLine {
  stroke: #f00;
  stroke-width: 2;
  stroke-linecap: round;
  pointer-events: none;
}
`),Pi("field_angle",dt),dt.prototype.DEFAULT_VALUE=0;var Su;(function(e){e.COMPASS="compass",e.PROTRACTOR="protractor"})(Su||(Su={}));var M_=class extends Vo{constructor(e){super(e),this.type=js,e&&(e.isShadow()&&(this.recordUndo=false),e=this.currentLocation_(),this.oldParentId=e.parentId,this.oldInputName=e.inputName,this.oldCoordinate=e.coordinate)}toJson(){const e=super.toJson();return e.oldParentId=this.oldParentId,e.oldInputName=this.oldInputName,this.oldCoordinate&&(e.oldCoordinate=`${Math.round(this.oldCoordinate.x)}, ${Math.round(this.oldCoordinate.y)}`),e.newParentId=this.newParentId,e.newInputName=this.newInputName,this.newCoordinate&&(e.newCoordinate=`${Math.round(this.newCoordinate.x)}, ${Math.round(this.newCoordinate.y)}`),this.recordUndo||(e.recordUndo=this.recordUndo),e}fromJson(e){if(o("Blockly.Events.BlockMove.prototype.fromJson","version 9","version 10","Blockly.Events.fromJson"),super.fromJson(e),this.oldParentId=e.oldParentId,this.oldInputName=e.oldInputName,e.oldCoordinate){var t=e.oldCoordinate.split(",");this.oldCoordinate=new Oe(Number(t[0]),Number(t[1]))}this.newParentId=e.newParentId,this.newInputName=e.newInputName,e.newCoordinate&&(t=e.newCoordinate.split(","),this.newCoordinate=new Oe(Number(t[0]),Number(t[1]))),e.recordUndo!==void 0&&(this.recordUndo=e.recordUndo)}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new M_),t.oldParentId=e.oldParentId,t.oldInputName=e.oldInputName,e.oldCoordinate&&(r=e.oldCoordinate.split(","),t.oldCoordinate=new Oe(Number(r[0]),Number(r[1]))),t.newParentId=e.newParentId,t.newInputName=e.newInputName,e.newCoordinate&&(r=e.newCoordinate.split(","),t.newCoordinate=new Oe(Number(r[0]),Number(r[1]))),e.recordUndo!==void 0&&(t.recordUndo=e.recordUndo),t}recordNew(){const e=this.currentLocation_();this.newParentId=e.parentId,this.newInputName=e.inputName,this.newCoordinate=e.coordinate}currentLocation_(){var e=this.getEventWorkspace_();if(!this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");var t=e.getBlockById(this.blockId);if(!t)throw Error("The block associated with the block move event could not be found");e={};const r=t.getParent();return r?(e.parentId=r.id,(t=r.getInputWithBlock(t))&&(e.inputName=t.name)):e.coordinate=t.getRelativeToSurfaceXY(),e}isNull(){return this.oldParentId===this.newParentId&&this.oldInputName===this.newInputName&&Oe.equals(this.oldCoordinate,this.newCoordinate)}run(e){var t=this.getEventWorkspace_();if(!this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");var r=t.getBlockById(this.blockId);if(r){var a=e?this.newParentId:this.oldParentId,d=e?this.newInputName:this.oldInputName;if(e=e?this.newCoordinate:this.oldCoordinate,a){var C=t.getBlockById(a);if(!C){console.warn("Can't connect to non-existent block: "+a);return}}if(r.getParent()&&r.unplug(),e)d=r.getRelativeToSurfaceXY(),r.moveBy(e.x-d.x,e.y-d.y);else{t=r.outputConnection,(!t||r.previousConnection&&r.previousConnection.isConnected())&&(t=r.previousConnection);let D;r=t.type,d?(r=C.getInput(d))&&(D=r.connection):r===Le.PREVIOUS_STATEMENT&&(D=C.nextConnection),D?t.connect(D):console.warn("Can't connect to non-existent input: "+d)}}else console.warn("Can't move non-existent block: "+this.blockId)}};$e(Te.EVENT,js,M_);var Er=class extends Jr{constructor(e){super(),this.isBlank=!e,e&&(this.commentId=e.id,this.workspaceId=e.workspace.id,this.group=Ft(),this.recordUndo=Ps())}toJson(){const e=super.toJson();if(!this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");return e.commentId=this.commentId,e}fromJson(e){o("Blockly.Events.CommentBase.prototype.fromJson","version 9","version 10","Blockly.Events.fromJson"),super.fromJson(e),this.commentId=e.commentId}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new Er),t.commentId=e.commentId,t}static CommentCreateDeleteHelper(e,t){var r=e.getEventWorkspace_();if(t){if(t=ot("xml"),!e.xml)throw Error("Ecountered a comment event without proper xml");t.appendChild(e.xml),Da(t,r)}else{if(!e.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");(r=r.getCommentById(e.commentId))?r.dispose():console.warn("Can't uncreate non-existent comment: "+e.commentId)}}},D_=class extends Er{constructor(e,t,r){super(e),this.type=Ka,e&&(this.oldContents_=typeof t>"u"?"":t,this.newContents_=typeof r>"u"?"":r)}toJson(){const e=super.toJson();if(!this.oldContents_)throw Error("The old contents is undefined. Either pass a value to the constructor, or call fromJson");if(!this.newContents_)throw Error("The new contents is undefined. Either pass a value to the constructor, or call fromJson");return e.oldContents=this.oldContents_,e.newContents=this.newContents_,e}fromJson(e){o("Blockly.Events.CommentChange.prototype.fromJson","version 9","version 10","Blockly.Events.fromJson"),super.fromJson(e),this.oldContents_=e.oldContents,this.newContents_=e.newContents}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new D_),t.oldContents_=e.oldContents,t.newContents_=e.newContents,t}isNull(){return this.oldContents_===this.newContents_}run(e){var t=this.getEventWorkspace_();if(!this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");if(t=t.getCommentById(this.commentId)){var r=e?this.newContents_:this.oldContents_;if(!r)throw Error(e?"The new contents is undefined. Either pass a value to the constructor, or call fromJson":"The old contents is undefined. Either pass a value to the constructor, or call fromJson");t.setContent(r)}else console.warn("Can't change non-existent comment: "+this.commentId)}};$e(Te.EVENT,Ka,D_);var x_=class extends Er{constructor(e){super(e),this.type=Yr,e&&(this.xml=e.toXmlWithXY())}toJson(){const e=super.toJson();if(!this.xml)throw Error("The comment XML is undefined. Either pass a comment to the constructor, or call fromJson");return e.xml=Bi(this.xml),e}fromJson(e){o("Blockly.Events.CommentCreate.prototype.fromJson","version 9","version 10","Blockly.Events.fromJson"),super.fromJson(e),this.xml=zs(e.xml)}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new x_),t.xml=zs(e.xml),t}run(e){Er.CommentCreateDeleteHelper(this,e)}};$e(Te.EVENT,Yr,x_);var B_=class extends Er{constructor(e){super(e),this.type=Fo,e&&(this.xml=e.toXmlWithXY())}run(e){Er.CommentCreateDeleteHelper(this,!e)}toJson(){const e=super.toJson();if(!this.xml)throw Error("The comment XML is undefined. Either pass a comment to the constructor, or call fromJson");return e.xml=Bi(this.xml),e}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new B_),t.xml=zs(e.xml),t}};$e(Te.EVENT,Fo,B_);var P_=class extends Er{constructor(e){super(e),this.type=Gn,e&&(this.comment_=e,this.oldCoordinate_=e.getXY())}recordNew(){if(this.newCoordinate_)throw Error("Tried to record the new position of a comment on the same event twice.");if(!this.comment_)throw Error("The comment is undefined. Pass a comment to the constructor if you want to use the record functionality");this.newCoordinate_=this.comment_.getXY()}setOldCoordinate(e){this.oldCoordinate_=e}toJson(){const e=super.toJson();if(!this.oldCoordinate_)throw Error("The old comment position is undefined. Either pass a comment to the constructor, or call fromJson");if(!this.newCoordinate_)throw Error("The new comment position is undefined. Either call recordNew, or call fromJson");return e.oldCoordinate=`${Math.round(this.oldCoordinate_.x)}, ${Math.round(this.oldCoordinate_.y)}`,e.newCoordinate=Math.round(this.newCoordinate_.x)+","+Math.round(this.newCoordinate_.y),e}fromJson(e){o("Blockly.Events.CommentMove.prototype.fromJson","version 9","version 10","Blockly.Events.fromJson"),super.fromJson(e);let t=e.oldCoordinate.split(",");this.oldCoordinate_=new Oe(Number(t[0]),Number(t[1])),t=e.newCoordinate.split(","),this.newCoordinate_=new Oe(Number(t[0]),Number(t[1]))}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new P_),r=e.oldCoordinate.split(","),t.oldCoordinate_=new Oe(Number(r[0]),Number(r[1])),r=e.newCoordinate.split(","),t.newCoordinate_=new Oe(Number(r[0]),Number(r[1])),t}isNull(){return Oe.equals(this.oldCoordinate_,this.newCoordinate_)}run(e){var t=this.getEventWorkspace_();if(!this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");if(t=t.getCommentById(this.commentId)){if(e=e?this.newCoordinate_:this.oldCoordinate_,!e)throw Error("Either oldCoordinate_ or newCoordinate_ is undefined. Either pass a comment to the constructor and call recordNew, or call fromJson");var r=t.getXY();t.moveBy(e.x-r.x,e.y-r.y)}else console.warn("Can't move non-existent comment: "+this.commentId)}};$e(Te.EVENT,Gn,P_);var ro=class extends Jr{constructor(e,t){super(),this.model=t,this.isBlank=false,this.workspaceId=e.id}toJson(){const e=super.toJson();return e.procedureId=this.model.getId(),e}},U_=class extends ro{constructor(e,t,r){super(e,t),this.oldTypes=r,this.type=Jc,this.newTypes=t.getReturnTypes()}run(e){const t=this.getEventWorkspace_().getProcedureMap().get(this.model.getId());if(!t)throw Error("Cannot change the type of a procedure that does not exist in the procedure map");e?t.setReturnTypes(this.newTypes):t.setReturnTypes(this.oldTypes)}toJson(){const e=super.toJson();return e.oldTypes=this.oldTypes,e}static fromJson(e,t){const r=t.getProcedureMap().get(e.procedureId);if(!r)throw Error("Cannot deserialize procedure change return event because the target procedure does not exist");return new U_(t,r,e.oldTypes)}};$e(Te.EVENT,Jc,U_);var F_=class extends ro{constructor(e,t){super(e,t),this.type=Kc}run(e){const t=this.getEventWorkspace_(),r=t.getProcedureMap(),a=r.get(this.model.getId());e?a||r.add(new El(t,this.model.getName(),this.model.getId())):a&&r.delete(this.model.getId())}toJson(){const e=super.toJson();return e.model=rd(this.model),e}static fromJson(e,t){return new F_(t,ad(El,sa,e.model,t))}};$e(Te.EVENT,Kc,F_);var G_=class extends ro{constructor(e,t){super(e,t),this.type=Ya}run(e){const t=this.getEventWorkspace_(),r=t.getProcedureMap(),a=r.get(this.model.getId());e?a&&r.delete(this.model.getId()):a||r.add(new El(t,this.model.getName(),this.model.getId()))}toJson(){return super.toJson()}static fromJson(e,t){if(e=t.getProcedureMap().get(e.procedureId),!e)throw Error("Cannot deserialize procedure delete event because the target procedure does not exist");return new G_(t,e)}};$e(Te.EVENT,Ya,G_);var H_=class extends ro{constructor(e,t){super(e,t),this.type=qc,this.oldState=!t.getEnabled(),this.newState=t.getEnabled()}run(e){const t=this.getEventWorkspace_().getProcedureMap().get(this.model.getId());if(!t)throw Error("Cannot change the enabled state of a procedure that does not exist in the procedure map");e?t.setEnabled(this.newState):t.setEnabled(this.oldState)}toJson(){return super.toJson()}static fromJson(e,t){if(e=t.getProcedureMap().get(e.procedureId),!e)throw Error("Cannot deserialize procedure enable event because the target procedure does not exist");return new H_(t,e)}};$e(Te.EVENT,qc,H_);var V_=class extends ro{constructor(e,t,r){super(e,t),this.oldName=r,this.type=Yc,this.newName=t.getName()}run(e){const t=this.getEventWorkspace_().getProcedureMap().get(this.model.getId());if(!t)throw Error("Cannot change the type of a procedure that does not exist in the procedure map");e?t.setName(this.newName):t.setName(this.oldName)}toJson(){const e=super.toJson();return e.oldName=this.oldName,e}static fromJson(e,t){const r=t.getProcedureMap().get(e.procedureId);if(!r)throw Error("Cannot deserialize procedure rename event because the target procedure does not exist");return new V_(t,r,e.oldName)}};$e(Te.EVENT,Yc,V_);var $u=class extends ro{constructor(e,t,r){super(e,t),this.parameter=r}toJson(){const e=super.toJson();return e.parameterId=this.model.getId(),e}},W_=class extends $u{constructor(e,t,r,a){super(e,t,r),this.index=a,this.type=Zc}run(e){const t=this.getEventWorkspace_(),r=t.getProcedureMap().get(this.model.getId());if(!r)throw Error("Cannot add a parameter to a procedure that does not exist in the procedure map");const a=r.getParameter(this.index);e?this.parameterMatches(a)||r.insertParameter(new sa(t,this.parameter.getName(),this.parameter.getId()),this.index):this.parameterMatches(a)&&r.deleteParameter(this.index)}parameterMatches(e){return e&&e.getId()===this.parameter.getId()}toJson(){const e=super.toJson();return e.parameter=od(this.parameter),e.index=this.index,e}static fromJson(e,t){const r=t.getProcedureMap().get(e.procedureId);if(!r)throw Error("Cannot deserialize parameter create event because the target procedure does not exist");return new W_(t,r,ld(sa,e.parameter,t),e.index)}};$e(Te.EVENT,Zc,W_);var z_=class extends $u{constructor(e,t,r,a){super(e,t,r),this.index=a,this.type=Qc}run(e){const t=this.getEventWorkspace_(),r=t.getProcedureMap().get(this.model.getId());if(!r)throw Error("Cannot add a parameter to a procedure that does not exist in the procedure map");const a=r.getParameter(this.index);e?this.parameterMatches(a)&&r.deleteParameter(this.index):this.parameterMatches(a)||r.insertParameter(new sa(t,this.parameter.getName(),this.parameter.getId()),this.index)}parameterMatches(e){return e&&e.getId()===this.parameter.getId()}toJson(){const e=super.toJson();return e.index=this.index,e}static fromJson(e,t){const r=t.getProcedureMap().get(e.procedureId);if(!r)throw Error("Cannot deserialize procedure delete event because the target procedure does not exist");const a=r.getParameter(e.index);return new z_(t,r,a,e.index)}};$e(Te.EVENT,Qc,z_);var j_=class extends $u{constructor(e,t,r,a){super(e,t,r),this.oldName=a,this.type=eu,this.newName=r.getName()}run(e){const t=UE(this.getEventWorkspace_(),this.model.getId(),this.parameter.getId());if(!t)throw Error("Cannot rename a parameter that does not exist in the procedure map");e?t.setName(this.newName):t.setName(this.oldName)}toJson(){const e=super.toJson();return e.oldName=this.oldName,e}static fromJson(e,t){const r=t.getProcedureMap().get(e.procedureId);if(!r)throw Error("Cannot deserialize procedure delete event because the target procedure does not exist");const a=UE(t,e.procedureId,e.parameterId);if(!a)throw Error("Cannot deserialize parameter rename event because the target parameter does not exist");return new j_(t,r,a,e.oldName)}};$e(Te.EVENT,eu,j_);var X_=class extends tn{constructor(e,t,r){super(e?e.workspace.id:void 0),this.type=Uo,e&&(this.blockId=e.id,this.isStart=t,this.blocks=r)}toJson(){const e=super.toJson();if(this.isStart===void 0)throw Error("Whether this event is the start of a drag is undefined. Either pass the value to the constructor, or call fromJson");if(this.blockId===void 0)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");return e.isStart=this.isStart,e.blockId=this.blockId,e.blocks=this.blocks,e}fromJson(e){o("Blockly.Events.BlockDrag.prototype.fromJson","version 9","version 10","Blockly.Events.fromJson"),super.fromJson(e),this.isStart=e.isStart,this.blockId=e.blockId,this.blocks=e.blocks}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new X_),t.isStart=e.isStart,t.blockId=e.blockId,t.blocks=e.blocks,t}};$e(Te.EVENT,Uo,X_);var Zb=class extends tn{constructor(e,t,r,a){super(e?e.workspace.id:void 0),this.type=Va,this.blockId=e?e.id:null,this.element=typeof t>"u"?"":t,this.oldValue=typeof r>"u"?"":r,this.newValue=typeof a>"u"?"":a}toJson(){const e=super.toJson();return e.element=this.element,this.newValue!==void 0&&(e.newValue=this.newValue),this.blockId&&(e.blockId=this.blockId),e}fromJson(e){super.fromJson(e),this.element=e.element,this.newValue=e.newValue,this.blockId=e.blockId}};$e(Te.EVENT,Va,Zb);var Qb=class extends Jr{constructor(e){super(),this.isBlank=true,this.recordUndo=false,this.type=Go,this.isBlank=!!e,e&&(this.workspaceId=e.id)}toJson(){const e=super.toJson();if(!this.workspaceId)throw Error("The workspace ID is undefined. Either pass a workspace to the constructor, or call fromJson");return e.workspaceId=this.workspaceId,e}fromJson(e){super.fromJson(e),this.workspaceId=e.workspaceId}};$e(Te.EVENT,Go,Qb),i.module$build$src$core$events$events={},i.module$build$src$core$events$events.Abstract=Jr,i.module$build$src$core$events$events.BLOCK_CHANGE=bs,i.module$build$src$core$events$events.BLOCK_CREATE=ks,i.module$build$src$core$events$events.BLOCK_DELETE=Sn,i.module$build$src$core$events$events.BLOCK_DRAG=Uo,i.module$build$src$core$events$events.BLOCK_MOVE=js,i.module$build$src$core$events$events.BUBBLE_OPEN=Fn,i.module$build$src$core$events$events.BUMP_EVENTS=yd,i.module$build$src$core$events$events.BlockBase=Vo,i.module$build$src$core$events$events.BlockChange=Zr,i.module$build$src$core$events$events.BlockCreate=Kd,i.module$build$src$core$events$events.BlockDelete=Yd,i.module$build$src$core$events$events.BlockDrag=X_,i.module$build$src$core$events$events.BlockMove=M_,i.module$build$src$core$events$events.BubbleOpen=Hd,i.module$build$src$core$events$events.BubbleType=Vd,i.module$build$src$core$events$events.CHANGE=bs,i.module$build$src$core$events$events.CLICK=_r,i.module$build$src$core$events$events.COMMENT_CHANGE=Ka,i.module$build$src$core$events$events.COMMENT_CREATE=Yr,i.module$build$src$core$events$events.COMMENT_DELETE=Fo,i.module$build$src$core$events$events.COMMENT_MOVE=Gn,i.module$build$src$core$events$events.CREATE=ks,i.module$build$src$core$events$events.Click=c_,i.module$build$src$core$events$events.ClickTarget=u_,i.module$build$src$core$events$events.CommentBase=Er,i.module$build$src$core$events$events.CommentChange=D_,i.module$build$src$core$events$events.CommentCreate=x_,i.module$build$src$core$events$events.CommentDelete=B_,i.module$build$src$core$events$events.CommentMove=P_,i.module$build$src$core$events$events.DELETE=Sn,i.module$build$src$core$events$events.FINISHED_LOADING=Go,i.module$build$src$core$events$events.FinishedLoading=Qb,i.module$build$src$core$events$events.MARKER_MOVE=Wa,i.module$build$src$core$events$events.MOVE=js,i.module$build$src$core$events$events.MarkerMove=T_,i.module$build$src$core$events$events.ProcedureBase=ro,i.module$build$src$core$events$events.ProcedureChangeReturn=U_,i.module$build$src$core$events$events.ProcedureCreate=F_,i.module$build$src$core$events$events.ProcedureDelete=G_,i.module$build$src$core$events$events.ProcedureEnable=H_,i.module$build$src$core$events$events.ProcedureParameterBase=$u,i.module$build$src$core$events$events.ProcedureParameterCreate=W_,i.module$build$src$core$events$events.ProcedureParameterDelete=z_,i.module$build$src$core$events$events.ProcedureParameterRename=j_,i.module$build$src$core$events$events.ProcedureRename=V_,i.module$build$src$core$events$events.SELECTED=dr,i.module$build$src$core$events$events.Selected=kd,i.module$build$src$core$events$events.THEME_CHANGE=Xa,i.module$build$src$core$events$events.TOOLBOX_ITEM_SELECT=ja,i.module$build$src$core$events$events.TRASHCAN_OPEN=za,i.module$build$src$core$events$events.ThemeChange=h_,i.module$build$src$core$events$events.ToolboxItemSelect=o_,i.module$build$src$core$events$events.TrashcanOpen=jd,i.module$build$src$core$events$events.UI=Va,i.module$build$src$core$events$events.Ui=Zb,i.module$build$src$core$events$events.UiBase=tn,i.module$build$src$core$events$events.VAR_CREATE=Xr,i.module$build$src$core$events$events.VAR_DELETE=Po,i.module$build$src$core$events$events.VAR_RENAME=Ha,i.module$build$src$core$events$events.VIEWPORT_CHANGE=Kr,i.module$build$src$core$events$events.VarBase=qa,i.module$build$src$core$events$events.VarCreate=Od,i.module$build$src$core$events$events.VarDelete=y_,i.module$build$src$core$events$events.VarRename=R_,i.module$build$src$core$events$events.ViewportChange=d_,i.module$build$src$core$events$events.clearPendingUndo=Ro,i.module$build$src$core$events$events.disable=Zt,i.module$build$src$core$events$events.disableOrphans=Qt,i.module$build$src$core$events$events.enable=ss,i.module$build$src$core$events$events.filter=Ei,i.module$build$src$core$events$events.fire=Pe,i.module$build$src$core$events$events.fromJson=Xe,i.module$build$src$core$events$events.get=Re,i.module$build$src$core$events$events.getDescendantIds=ye,i.module$build$src$core$events$events.getGroup=Ft,i.module$build$src$core$events$events.getRecordUndo=Ps,i.module$build$src$core$events$events.isEnabled=ls,i.module$build$src$core$events$events.setGroup=He,i.module$build$src$core$events$events.setRecordUndo=Bs,tv();var Ys={};Ys.registerCleanup=HE,Ys.registerCollapse=WE,Ys.registerCollapseExpandBlock=JE,Ys.registerComment=YE,Ys.registerDefaultOptions=tv,Ys.registerDelete=QE,Ys.registerDeleteAll=XE,Ys.registerDisable=ZE,Ys.registerDuplicate=KE,Ys.registerExpand=zE,Ys.registerHelp=ev,Ys.registerInline=qE,Ys.registerRedo=GE,Ys.registerUndo=FE;var eT=class{constructor(e,t){this.dragTarget_=null,this.wouldDeleteBlock_=false,this.draggingBlock_=e,this.draggedConnectionManager_=new Ii(this.draggingBlock_),this.workspace_=t,this.startXY_=this.draggingBlock_.getRelativeToSurfaceXY(),this.dragIconData_=e0(e)}dispose(){this.dragIconData_.length=0,this.draggedConnectionManager_&&this.draggedConnectionManager_.dispose()}startDrag(e,t){Ft()||He(true),this.fireDragStartEvent_(),this.workspace_.isMutator&&this.draggingBlock_.bringToFront(),Me(),this.workspace_.setResizesEnabled(false),Pa(),this.shouldDisconnect_(t)&&this.disconnectBlock_(t,e),this.draggingBlock_.setDragging(true),this.draggingBlock_.moveToDragSurface()}shouldDisconnect_(e){return!!(this.draggingBlock_.getParent()||e&&this.draggingBlock_.nextConnection&&this.draggingBlock_.nextConnection.targetBlock())}disconnectBlock_(e,t){this.draggingBlock_.unplug(e),e=this.pixelsToWorkspaceUnits_(t),e=Oe.sum(this.startXY_,e),this.draggingBlock_.translate(e.x,e.y),hE(this.draggingBlock_),this.draggedConnectionManager_.updateAvailableConnections()}fireDragStartEvent_(){const e=new(Re(Uo))(this.draggingBlock_,true,this.draggingBlock_.getDescendants(false));Pe(e)}drag(e,t){t=this.pixelsToWorkspaceUnits_(t);var r=Oe.sum(this.startXY_,t);this.draggingBlock_.moveDuringDrag(r),this.dragIcons_(t),r=this.dragTarget_,this.dragTarget_=this.workspace_.getDragTarget(e),this.draggedConnectionManager_.update(t,this.dragTarget_),e=this.wouldDeleteBlock_,this.wouldDeleteBlock_=this.draggedConnectionManager_.wouldDeleteBlock,e!==this.wouldDeleteBlock_&&this.updateCursorDuringBlockDrag_(),this.dragTarget_!==r&&(r&&r.onDragExit(this.draggingBlock_),this.dragTarget_&&this.dragTarget_.onDragEnter(this.draggingBlock_)),this.dragTarget_&&this.dragTarget_.onDragOver(this.draggingBlock_)}endDrag(e,t){this.drag(e,t),this.dragIconData_=[],this.fireDragEndEvent_(),Se(),Pa(),e=null,this.dragTarget_&&this.dragTarget_.shouldPreventMove(this.draggingBlock_)?t=this.startXY_:(t=this.getNewLocationAfterDrag_(t),e=t.delta,t=t.newLocation),this.draggingBlock_.moveOffDragSurface(t),this.dragTarget_&&this.dragTarget_.onDrop(this.draggingBlock_),this.maybeDeleteBlock_()||(this.draggingBlock_.setDragging(false),e?this.updateBlockAfterMove_(e):Dc(this.draggingBlock_.workspace,this.workspace_.getMetricsManager().getScrollMetrics(true),this.draggingBlock_)),this.workspace_.setResizesEnabled(true),He(false)}getNewLocationAfterDrag_(e){e=this.pixelsToWorkspaceUnits_(e);const t=Oe.sum(this.startXY_,e);return{delta:e,newLocation:t}}maybeDeleteBlock_(){return this.wouldDeleteBlock_?(this.fireMoveEvent_(),this.draggingBlock_.dispose(false,true),Wr.length=0,true):false}updateBlockAfterMove_(e){this.draggingBlock_.moveConnections(e.x,e.y),this.fireMoveEvent_(),this.draggedConnectionManager_.wouldConnectBlock()?this.draggedConnectionManager_.applyConnections():this.draggingBlock_.render(),this.draggingBlock_.scheduleSnapAndBump()}fireDragEndEvent_(){const e=new(Re(Uo))(this.draggingBlock_,false,this.draggingBlock_.getDescendants(false));Pe(e)}updateToolboxStyle_(e){const t=this.workspace_.getToolbox();if(t){const r=this.draggingBlock_.isDeletable()?"blocklyToolboxDelete":"blocklyToolboxGrab";e&&typeof t.removeStyle=="function"?t.removeStyle(r):e||typeof t.addStyle!="function"||t.addStyle(r)}}fireMoveEvent_(){const e=new(Re(js))(this.draggingBlock_);e.oldCoordinate=this.startXY_,e.recordNew(),Pe(e)}updateCursorDuringBlockDrag_(){this.draggingBlock_.setDeleteStyle(this.wouldDeleteBlock_)}pixelsToWorkspaceUnits_(e){return e=new Oe(e.x/this.workspace_.scale,e.y/this.workspace_.scale),this.workspace_.isMutator&&e.scale(1/this.workspace_.options.parentWorkspace.scale),e}dragIcons_(e){for(let t=0;t<this.dragIconData_.length;t++){const r=this.dragIconData_[t];r.icon.setIconLocation(Oe.sum(r.location,e))}}getInsertionMarkers(){return this.draggedConnectionManager_&&this.draggedConnectionManager_.getInsertionMarkers?this.draggedConnectionManager_.getInsertionMarkers():[]}};$e(Te.BLOCK_DRAGGER,Un,eT);var V0="9.2.1",W0=i.Align$$module$build$src$core$input.LEFT,z0=i.Align$$module$build$src$core$input.CENTRE,j0=i.Align$$module$build$src$core$input.RIGHT,X0=Le.INPUT_VALUE,K0=Le.OUTPUT_VALUE,Y0=Le.NEXT_STATEMENT,q0=Le.PREVIOUS_STATEMENT,J0=lt.DUMMY,Z0=it.TOP,Q0=it.BOTTOM,ew=it.LEFT,tw=it.RIGHT;Xn.prototype.newBlock=function(e,t){return new qo(this,e,t)},ln.prototype.newBlock=function(e,t){return new Fi(this,e,t)},ln.newTrashcan=function(e){return new Qv(e)},Fs.prototype.showContextMenu=function(e){if(!this.workspace.options.readOnly){var t=[];this.isDeletable()&&this.isMovable()&&(t.push(mE(this)),t.push(fE(this))),Lc(e,t,this.RTL)}},i.Mutator$$module$build$src$core$mutator.prototype.newWorkspaceSvg=function(e){return new ln(e)},Gi.prototype.populateProcedures=function(e){e=sd(e),e=e[0].concat(e[1]);for(let t=0;t<e.length;t++)this.getName(e[t][0],Gi.NameType.PROCEDURE)};var sw=Le,re={};return re.ALIGN_CENTRE=z0,re.ALIGN_LEFT=W0,re.ALIGN_RIGHT=j0,re.ASTNode=ge,re.BasicCursor=fl,re.Block=qo,re.BlockDragSurfaceSvg=Xb,re.BlockDragger=eT,re.BlockSvg=Fi,re.Blocks=oi,re.Bubble=rt,re.BubbleDragger=nb,re.COLLAPSED_FIELD_NAME=ul,re.COLLAPSED_INPUT_NAME=cl,re.COLLAPSE_CHARS=Xv,re.CodeGenerator=i.CodeGenerator$$module$build$src$core$generator,re.CollapsibleToolboxCategory=ea,re.Comment=jv,re.ComponentManager=$s,re.Connection=Rt,re.ConnectionChecker=gb,re.ConnectionDB=ta,re.ConnectionType=Le,re.ContextMenu=i.module$build$src$core$contextmenu,re.ContextMenuItems=Ys,re.ContextMenuRegistry=It,re.Css=Nd,re.Cursor=s_,re.DELETE_VARIABLE_ID=t_,re.DRAG_STACK=Kv,re.DUMMY_INPUT=J0,re.DeleteArea=pu,re.DragTarget=Zv,re.DropDownDiv=is,re.Events=i.module$build$src$core$events$events,re.Extensions=i.module$build$src$core$extensions,re.Field=pt,re.FieldAngle=dt,re.FieldCheckbox=i.FieldCheckbox$$module$build$src$core$field_checkbox,re.FieldColour=Ci,re.FieldDropdown=rn,re.FieldImage=i.FieldImage$$module$build$src$core$field_image,re.FieldLabel=i.FieldLabel$$module$build$src$core$field_label,re.FieldLabelSerializable=Jb,re.FieldMultilineInput=N_,re.FieldNumber=L_,re.FieldTextInput=i.FieldTextInput$$module$build$src$core$field_textinput,re.FieldVariable=Ol,re.Flyout=Tu,re.FlyoutButton=na,re.FlyoutMetricsManager=Yb,re.Generator=i.CodeGenerator$$module$build$src$core$generator,re.Gesture=yn,re.Grid=__,re.HorizontalFlyout=qb,re.INPUT_VALUE=X0,re.Icon=uu,re.Input=Yo,re.InsertionMarkerManager=Ii,re.Marker=Yv,re.MarkerManager=Za,re.Menu=Fd,re.MenuItem=Gd,re.MetricsManager=k_,re.Msg=Je,re.Mutator=i.Mutator$$module$build$src$core$mutator,re.NEXT_STATEMENT=Y0,re.Names=Gi,re.OPPOSITE_TYPE=eo,re.OUTPUT_VALUE=K0,re.Options=on,re.PREVIOUS_STATEMENT=q0,re.PROCEDURE_CATEGORY_NAME=mu,re.Procedures=i.module$build$src$core$procedures,re.RENAME_VARIABLE_ID=e_,re.RenderedConnection=Xs,re.Scrollbar=Kt,re.ScrollbarPair=w_,re.ShortcutItems=In,re.ShortcutRegistry=wt,re.TOOLBOX_AT_BOTTOM=Q0,re.TOOLBOX_AT_LEFT=ew,re.TOOLBOX_AT_RIGHT=tw,re.TOOLBOX_AT_TOP=Z0,re.TabNavigateCursor=qv,re.Theme=Qr,re.ThemeManager=pb,re.Themes=l_,re.Toolbox=ib,re.ToolboxCategory=an,re.ToolboxItem=a_,re.ToolboxSeparator=ml,re.Tooltip=ns,re.Touch=$i,re.TouchGesture=yn,re.Trashcan=Qv,re.VARIABLE_CATEGORY_NAME=iu,re.VARIABLE_DYNAMIC_CATEGORY_NAME=$_,re.VERSION=V0,re.VariableMap=I_,re.VariableModel=Ja,re.Variables=i.module$build$src$core$variables,re.VariablesDynamic=mr,re.VerticalFlyout=A_,re.Warning=Jv,re.WidgetDiv=nn,re.Workspace=Xn,re.WorkspaceAudio=fb,re.WorkspaceComment=$n,re.WorkspaceCommentSvg=Fs,re.WorkspaceDragSurfaceSvg=jb,re.WorkspaceDragger=rb,re.WorkspaceSvg=ln,re.Xml=i.module$build$src$core$xml,re.ZoomControls=mb,re.bindEventWithChecks_=u0,re.bindEvent_=l0,re.blockAnimations=dl,re.blockRendering=Ct,re.browserEvents=Pn,re.bumpObjects=bu,re.clipboard=_l,re.common=i.module$build$src$core$common,re.config=i.config$$module$build$src$core$config,re.connectionTypes=sw,re.constants=qd,re.copy=i0,re.defineBlocksWithJsonArray=M,re.dialog=li,re.duplicate=r0,re.fieldRegistry=il,re.geras=On,re.getMainWorkspace=k,re.getSelected=P,re.hideChaff=t0,re.hueToHex=a0,re.inject=zO,re.inputTypes=lt,re.isNumber=o0,re.minimalist=Cl,re.paste=n0,re.procedures=i.module$build$src$core$procedures,re.registry=en,re.resizeSvgContents=s0,re.serialization=H0,re.setLocale=Cd,re.setParentContainer=W,re.svgResize=z,re.thrasos=O_,re.uiPosition=to,re.unbindEvent_=c0,re.utils=mt,re.zelos=cn,i.module$build$src$core$contextmenu,i.module$build$src$core$events$events,i.module$build$src$core$msg,i.module$build$src$core$common,Object.defineProperties(re,{alert:{set:function(e){vs.warn("Blockly.alert","December 2021","December 2022"),li.setAlert(e)},get:function(){return vs.warn("Blockly.alert","December 2021","December 2022","Blockly.dialog.alert()"),li.alert}},confirm:{set:function(e){vs.warn("Blockly.confirm","December 2021","December 2022"),li.setConfirm(e)},get:function(){return vs.warn("Blockly.confirm","December 2021","December 2022","Blockly.dialog.confirm()"),li.confirm}},mainWorkspace:{set:function(e){vs.warn("Blockly.mainWorkspace","version 9","version 10","Blockly.getMainWorkspace"),i.module$build$src$core$common.setMainWorkspace(e)},get:function(){return vs.warn("Blockly.mainWorkspace","version 9","version 10","Blockly.getMainWorkspace"),i.module$build$src$core$common.getMainWorkspace()}},prompt:{set:function(e){vs.warn("Blockly.prompt","December 2021","December 2022"),li.setPrompt(e)},get:function(){return vs.warn("Blockly.prompt","December 2021","December 2022","Blockly.dialog.prompt()"),li.prompt}},selected:{get:function(){return vs.warn("Blockly.selected","version 9","version 10","Blockly.getSelected"),i.module$build$src$core$common.getSelected()},set:function(e){vs.warn("Blockly.selected","version 9","version 10","Blockly.getSelected"),i.module$build$src$core$common.setSelected(e)}},HSV_SATURATION:{get:function(){return Gs.getHsvSaturation()},set:function(e){Gs.setHsvSaturation(e)}},HSV_VALUE:{get:function(){return Gs.getHsvValue()},set:function(e){Gs.setHsvValue(e)}}}),Object.defineProperties(i.module$build$src$core$contextmenu,{currentBlock:{get:function(){return vs.warn("Blockly.ContextMenu.currentBlock","September 2021","September 2022","Blockly.Tooltip.getCurrentBlock()"),i.module$build$src$core$contextmenu.getCurrentBlock()},set:function(e){vs.warn("Blockly.ContextMenu.currentBlock","September 2021","September 2022","Blockly.Tooltip.setCurrentBlock(block)"),i.module$build$src$core$contextmenu.setCurrentBlock(e)}}}),Object.defineProperties(i.module$build$src$core$events$events,{recordUndo:{get:function(){return vs.warn("Blockly.Events.recordUndo","September 2021","September 2022","Blockly.Events.getRecordUndo()"),Qe.getRecordUndo()},set:function(e){vs.warn("Blockly.Events.recordUndo","September 2021","September 2022","Blockly.Events.setRecordUndo()"),Qe.setRecordUndo(e)}}}),Object.defineProperties(ns,{visible:{get:function(){return vs.warn("Blockly.Tooltip.visible","September 2021","September 2022","Blockly.Tooltip.isVisible()"),ns.isVisible()}},DIV:{get:function(){return vs.warn("Blockly.Tooltip.DIV","September 2021","September 2022","Blockly.Tooltip.getDiv()"),ns.getDiv()}}}),Object.defineProperties(nn,{DIV:{get:function(){return vs.warn("Blockly.WidgetDiv.DIV","September 2021","September 2022","Blockly.WidgetDiv.getDiv()"),nn.getDiv()}}}),"Blockly"in globalThis||(globalThis.Blockly={Msg:i.module$build$src$core$msg}),re.__namespace__=i,re})}(Tp)),Tp.exports}var $S;function k1(){return $S||($S=1,function(s,n){(function(i,o){s.exports=o(hm())})(Ni,function(i){/**
 * @license
 * Copyright 2020 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */return i})}(bp)),bp.exports}var yS;function ZR(){return yS||(yS=1,function(s,n){(function(i,o){s.exports=o(k1())})(Ni,function(i){return i})}(vp)),vp.exports}var Sp={exports:{}},RS;function A1(){return RS||(RS=1,function(s,n){(function(i,o){s.exports=o(hm())})(Ni,function(i){var o=i.__namespace__,l={};o.module$build$src$core$variables,o.module$build$src$core$utils$string,o.CodeGenerator$$module$build$src$core$generator,o.module$build$src$core$input_types.inputTypes,o.module$build$src$core$names.Names,o.NameType$$module$build$src$core$names,l.javascriptGenerator=new o.CodeGenerator$$module$build$src$core$generator("JavaScript"),l.javascriptGenerator.addReservedWords("break,case,catch,class,const,continue,debugger,default,delete,do,else,export,extends,finally,for,function,if,import,in,instanceof,new,return,super,switch,this,throw,try,typeof,var,void,while,with,yield,enum,implements,interface,let,package,private,protected,public,static,await,null,true,false,arguments,"+Object.getOwnPropertyNames(globalThis).join(",")),l.javascriptGenerator.ORDER_ATOMIC=0,l.javascriptGenerator.ORDER_NEW=1.1,l.javascriptGenerator.ORDER_MEMBER=1.2,l.javascriptGenerator.ORDER_FUNCTION_CALL=2,l.javascriptGenerator.ORDER_INCREMENT=3,l.javascriptGenerator.ORDER_DECREMENT=3,l.javascriptGenerator.ORDER_BITWISE_NOT=4.1,l.javascriptGenerator.ORDER_UNARY_PLUS=4.2,l.javascriptGenerator.ORDER_UNARY_NEGATION=4.3,l.javascriptGenerator.ORDER_LOGICAL_NOT=4.4,l.javascriptGenerator.ORDER_TYPEOF=4.5,l.javascriptGenerator.ORDER_VOID=4.6,l.javascriptGenerator.ORDER_DELETE=4.7,l.javascriptGenerator.ORDER_AWAIT=4.8,l.javascriptGenerator.ORDER_EXPONENTIATION=5,l.javascriptGenerator.ORDER_MULTIPLICATION=5.1,l.javascriptGenerator.ORDER_DIVISION=5.2,l.javascriptGenerator.ORDER_MODULUS=5.3,l.javascriptGenerator.ORDER_SUBTRACTION=6.1,l.javascriptGenerator.ORDER_ADDITION=6.2,l.javascriptGenerator.ORDER_BITWISE_SHIFT=7,l.javascriptGenerator.ORDER_RELATIONAL=8,l.javascriptGenerator.ORDER_IN=8,l.javascriptGenerator.ORDER_INSTANCEOF=8,l.javascriptGenerator.ORDER_EQUALITY=9,l.javascriptGenerator.ORDER_BITWISE_AND=10,l.javascriptGenerator.ORDER_BITWISE_XOR=11,l.javascriptGenerator.ORDER_BITWISE_OR=12,l.javascriptGenerator.ORDER_LOGICAL_AND=13,l.javascriptGenerator.ORDER_LOGICAL_OR=14,l.javascriptGenerator.ORDER_CONDITIONAL=15,l.javascriptGenerator.ORDER_ASSIGNMENT=16,l.javascriptGenerator.ORDER_YIELD=17,l.javascriptGenerator.ORDER_COMMA=18,l.javascriptGenerator.ORDER_NONE=99,l.javascriptGenerator.ORDER_OVERRIDES=[[l.javascriptGenerator.ORDER_FUNCTION_CALL,l.javascriptGenerator.ORDER_MEMBER],[l.javascriptGenerator.ORDER_FUNCTION_CALL,l.javascriptGenerator.ORDER_FUNCTION_CALL],[l.javascriptGenerator.ORDER_MEMBER,l.javascriptGenerator.ORDER_MEMBER],[l.javascriptGenerator.ORDER_MEMBER,l.javascriptGenerator.ORDER_FUNCTION_CALL],[l.javascriptGenerator.ORDER_LOGICAL_NOT,l.javascriptGenerator.ORDER_LOGICAL_NOT],[l.javascriptGenerator.ORDER_MULTIPLICATION,l.javascriptGenerator.ORDER_MULTIPLICATION],[l.javascriptGenerator.ORDER_ADDITION,l.javascriptGenerator.ORDER_ADDITION],[l.javascriptGenerator.ORDER_LOGICAL_AND,l.javascriptGenerator.ORDER_LOGICAL_AND],[l.javascriptGenerator.ORDER_LOGICAL_OR,l.javascriptGenerator.ORDER_LOGICAL_OR]],l.javascriptGenerator.isInitialized=false,l.javascriptGenerator.init=function(c){Object.getPrototypeOf(this).init.call(this),this.nameDB_?this.nameDB_.reset():this.nameDB_=new o.module$build$src$core$names.Names(this.RESERVED_WORDS_),this.nameDB_.setVariableMap(c.getVariableMap()),this.nameDB_.populateVariables(c),this.nameDB_.populateProcedures(c);const h=[];var p=o.module$build$src$core$variables.allDeveloperVariables(c);for(let T=0;T<p.length;T++)h.push(this.nameDB_.getName(p[T],o.NameType$$module$build$src$core$names.DEVELOPER_VARIABLE));for(c=o.module$build$src$core$variables.allUsedVarModels(c),p=0;p<c.length;p++)h.push(this.nameDB_.getName(c[p].getId(),o.NameType$$module$build$src$core$names.VARIABLE));h.length&&(this.definitions_.variables="var "+h.join(", ")+";"),this.isInitialized=true},l.javascriptGenerator.finish=function(c){const h=Object.values(this.definitions_);return c=Object.getPrototypeOf(this).finish.call(this,c),this.isInitialized=false,this.nameDB_.reset(),h.join(`

`)+`


`+c},l.javascriptGenerator.scrubNakedValue=function(c){return c+`;
`},l.javascriptGenerator.quote_=function(c){return c=c.replace(/\\/g,"\\\\").replace(/\n/g,`\\
`).replace(/'/g,"\\'"),"'"+c+"'"},l.javascriptGenerator.multiline_quote_=function(c){return c.split(/\n/g).map(this.quote_).join(` + '\\n' +
`)},l.javascriptGenerator.scrub_=function(c,h,p){let T="";if(!c.outputConnection||!c.outputConnection.targetConnection){var $=c.getCommentText();$&&($=o.module$build$src$core$utils$string.wrap($,this.COMMENT_WRAP-3),T+=this.prefixLines($+`
`,"// "));for(let S=0;S<c.inputList.length;S++)c.inputList[S].type===o.module$build$src$core$input_types.inputTypes.VALUE&&($=c.inputList[S].connection.targetBlock())&&($=this.allNestedComments($))&&(T+=this.prefixLines($,"// "))}return c=c.nextConnection&&c.nextConnection.targetBlock(),p=p?"":this.blockToCode(c),T+h+p},l.javascriptGenerator.getAdjusted=function(c,h,p,T,$){p=p||0,$=$||this.ORDER_NONE,c.workspace.options.oneBasedIndex&&p--;const S=c.workspace.options.oneBasedIndex?"1":"0";let y,g=$;return 0<p?y=g=this.ORDER_ADDITION:0>p?y=g=this.ORDER_SUBTRACTION:T&&(y=g=this.ORDER_UNARY_NEGATION),c=this.valueToCode(c,h,g)||S,o.module$build$src$core$utils$string.isNumber(c)?(c=Number(c)+p,T&&(c=-c)):(0<p?c=c+" + "+p:0>p&&(c=c+" - "+-p),T&&(c=p?"-("+c+")":"-"+c),y=Math.floor(y),$=Math.floor($),y&&$>=y&&(c="("+c+")")),c},o.NameType$$module$build$src$core$names,l.javascriptGenerator.variables_get=function(c){return[l.javascriptGenerator.nameDB_.getName(c.getFieldValue("VAR"),o.NameType$$module$build$src$core$names.VARIABLE),l.javascriptGenerator.ORDER_ATOMIC]},l.javascriptGenerator.variables_set=function(c){const h=l.javascriptGenerator.valueToCode(c,"VALUE",l.javascriptGenerator.ORDER_ASSIGNMENT)||"0";return l.javascriptGenerator.nameDB_.getName(c.getFieldValue("VAR"),o.NameType$$module$build$src$core$names.VARIABLE)+" = "+h+`;
`},l.javascriptGenerator.variables_get_dynamic=l.javascriptGenerator.variables_get,l.javascriptGenerator.variables_set_dynamic=l.javascriptGenerator.variables_set,o.NameType$$module$build$src$core$names;var f=/^\s*'([^']|\\')*'\s*$/,m=function(c){return f.test(c)?[c,l.javascriptGenerator.ORDER_ATOMIC]:["String("+c+")",l.javascriptGenerator.ORDER_FUNCTION_CALL]},u=function(c,h,p){return h==="FIRST"?"0":h==="FROM_END"?c+".length - 1 - "+p:h==="LAST"?c+".length - 1":p};l.javascriptGenerator.text=function(c){return[l.javascriptGenerator.quote_(c.getFieldValue("TEXT")),l.javascriptGenerator.ORDER_ATOMIC]},l.javascriptGenerator.text_multiline=function(c){c=l.javascriptGenerator.multiline_quote_(c.getFieldValue("TEXT"));const h=c.indexOf("+")!==-1?l.javascriptGenerator.ORDER_ADDITION:l.javascriptGenerator.ORDER_ATOMIC;return[c,h]},l.javascriptGenerator.text_join=function(c){switch(c.itemCount_){case 0:return["''",l.javascriptGenerator.ORDER_ATOMIC];case 1:return c=l.javascriptGenerator.valueToCode(c,"ADD0",l.javascriptGenerator.ORDER_NONE)||"''",m(c);case 2:var h=l.javascriptGenerator.valueToCode(c,"ADD0",l.javascriptGenerator.ORDER_NONE)||"''";return c=l.javascriptGenerator.valueToCode(c,"ADD1",l.javascriptGenerator.ORDER_NONE)||"''",[m(h)[0]+" + "+m(c)[0],l.javascriptGenerator.ORDER_ADDITION];default:h=Array(c.itemCount_);for(let p=0;p<c.itemCount_;p++)h[p]=l.javascriptGenerator.valueToCode(c,"ADD"+p,l.javascriptGenerator.ORDER_NONE)||"''";return["["+h.join(",")+"].join('')",l.javascriptGenerator.ORDER_FUNCTION_CALL]}},l.javascriptGenerator.text_append=function(c){const h=l.javascriptGenerator.nameDB_.getName(c.getFieldValue("VAR"),o.NameType$$module$build$src$core$names.VARIABLE);return c=l.javascriptGenerator.valueToCode(c,"TEXT",l.javascriptGenerator.ORDER_NONE)||"''",h+" += "+m(c)[0]+`;
`},l.javascriptGenerator.text_length=function(c){return[(l.javascriptGenerator.valueToCode(c,"VALUE",l.javascriptGenerator.ORDER_MEMBER)||"''")+".length",l.javascriptGenerator.ORDER_MEMBER]},l.javascriptGenerator.text_isEmpty=function(c){return["!"+(l.javascriptGenerator.valueToCode(c,"VALUE",l.javascriptGenerator.ORDER_MEMBER)||"''")+".length",l.javascriptGenerator.ORDER_LOGICAL_NOT]},l.javascriptGenerator.text_indexOf=function(c){var h=c.getFieldValue("END")==="FIRST"?"indexOf":"lastIndexOf";const p=l.javascriptGenerator.valueToCode(c,"FIND",l.javascriptGenerator.ORDER_NONE)||"''";return h=(l.javascriptGenerator.valueToCode(c,"VALUE",l.javascriptGenerator.ORDER_MEMBER)||"''")+"."+h+"("+p+")",c.workspace.options.oneBasedIndex?[h+" + 1",l.javascriptGenerator.ORDER_ADDITION]:[h,l.javascriptGenerator.ORDER_FUNCTION_CALL]},l.javascriptGenerator.text_charAt=function(c){const h=c.getFieldValue("WHERE")||"FROM_START",p=l.javascriptGenerator.valueToCode(c,"VALUE",h==="RANDOM"?l.javascriptGenerator.ORDER_NONE:l.javascriptGenerator.ORDER_MEMBER)||"''";switch(h){case"FIRST":return[p+".charAt(0)",l.javascriptGenerator.ORDER_FUNCTION_CALL];case"LAST":return[p+".slice(-1)",l.javascriptGenerator.ORDER_FUNCTION_CALL];case"FROM_START":return c=l.javascriptGenerator.getAdjusted(c,"AT"),[p+".charAt("+c+")",l.javascriptGenerator.ORDER_FUNCTION_CALL];case"FROM_END":return c=l.javascriptGenerator.getAdjusted(c,"AT",1,true),[p+".slice("+c+").charAt(0)",l.javascriptGenerator.ORDER_FUNCTION_CALL];case"RANDOM":return[l.javascriptGenerator.provideFunction_("textRandomLetter",`
function ${l.javascriptGenerator.FUNCTION_NAME_PLACEHOLDER_}(text) {
  var x = Math.floor(Math.random() * text.length);
  return text[x];
}
`)+"("+p+")",l.javascriptGenerator.ORDER_FUNCTION_CALL]}throw Error("Unhandled option (text_charAt).")},l.javascriptGenerator.text_getSubstring=function(c){var h=c.getFieldValue("WHERE1"),p=c.getFieldValue("WHERE2"),T=h!=="FROM_END"&&h!=="LAST"&&p!=="FROM_END"&&p!=="LAST",$=l.javascriptGenerator.valueToCode(c,"STRING",T?l.javascriptGenerator.ORDER_MEMBER:l.javascriptGenerator.ORDER_NONE)||"''";if(h==="FIRST"&&p==="LAST")return[$,l.javascriptGenerator.ORDER_NONE];if($.match(/^'?\w+'?$/)||T){switch(h){case"FROM_START":h=l.javascriptGenerator.getAdjusted(c,"AT1");break;case"FROM_END":h=l.javascriptGenerator.getAdjusted(c,"AT1",1,false,l.javascriptGenerator.ORDER_SUBTRACTION),h=$+".length - "+h;break;case"FIRST":h="0";break;default:throw Error("Unhandled option (text_getSubstring).")}switch(p){case"FROM_START":p=l.javascriptGenerator.getAdjusted(c,"AT2",1);break;case"FROM_END":p=l.javascriptGenerator.getAdjusted(c,"AT2",0,false,l.javascriptGenerator.ORDER_SUBTRACTION),p=$+".length - "+p;break;case"LAST":p=$+".length";break;default:throw Error("Unhandled option (text_getSubstring).")}$=$+".slice("+h+", "+p+")"}else{T=l.javascriptGenerator.getAdjusted(c,"AT1"),c=l.javascriptGenerator.getAdjusted(c,"AT2");const S={FIRST:"First",LAST:"Last",FROM_START:"FromStart",FROM_END:"FromEnd"};$=l.javascriptGenerator.provideFunction_("subsequence"+S[h]+S[p],`
function ${l.javascriptGenerator.FUNCTION_NAME_PLACEHOLDER_}(sequence${h==="FROM_END"||h==="FROM_START"?", at1":""}${p==="FROM_END"||p==="FROM_START"?", at2":""}) {
  var start = ${u("sequence",h,"at1")};
  var end = ${u("sequence",p,"at2")} + 1;
  return sequence.slice(start, end);
}
`)+"("+$+(h==="FROM_END"||h==="FROM_START"?", "+T:"")+(p==="FROM_END"||p==="FROM_START"?", "+c:"")+")"}return[$,l.javascriptGenerator.ORDER_FUNCTION_CALL]},l.javascriptGenerator.text_changeCase=function(c){const h={UPPERCASE:".toUpperCase()",LOWERCASE:".toLowerCase()",TITLECASE:null}[c.getFieldValue("CASE")];return c=l.javascriptGenerator.valueToCode(c,"TEXT",h?l.javascriptGenerator.ORDER_MEMBER:l.javascriptGenerator.ORDER_NONE)||"''",[h?c+h:l.javascriptGenerator.provideFunction_("textToTitleCase",`
function ${l.javascriptGenerator.FUNCTION_NAME_PLACEHOLDER_}(str) {
  return str.replace(/\\S+/g,
      function(txt) {return txt[0].toUpperCase() + txt.substring(1).toLowerCase();});
}
`)+"("+c+")",l.javascriptGenerator.ORDER_FUNCTION_CALL]},l.javascriptGenerator.text_trim=function(c){const h={LEFT:".replace(/^[\\s\\xa0]+/, '')",RIGHT:".replace(/[\\s\\xa0]+$/, '')",BOTH:".trim()"}[c.getFieldValue("MODE")];return[(l.javascriptGenerator.valueToCode(c,"TEXT",l.javascriptGenerator.ORDER_MEMBER)||"''")+h,l.javascriptGenerator.ORDER_FUNCTION_CALL]},l.javascriptGenerator.text_print=function(c){return"window.alert("+(l.javascriptGenerator.valueToCode(c,"TEXT",l.javascriptGenerator.ORDER_NONE)||"''")+`);
`},l.javascriptGenerator.text_prompt_ext=function(c){let h="window.prompt("+(c.getField("TEXT")?l.javascriptGenerator.quote_(c.getFieldValue("TEXT")):l.javascriptGenerator.valueToCode(c,"TEXT",l.javascriptGenerator.ORDER_NONE)||"''")+")";return c.getFieldValue("TYPE")==="NUMBER"&&(h="Number("+h+")"),[h,l.javascriptGenerator.ORDER_FUNCTION_CALL]},l.javascriptGenerator.text_prompt=l.javascriptGenerator.text_prompt_ext,l.javascriptGenerator.text_count=function(c){const h=l.javascriptGenerator.valueToCode(c,"TEXT",l.javascriptGenerator.ORDER_NONE)||"''";return c=l.javascriptGenerator.valueToCode(c,"SUB",l.javascriptGenerator.ORDER_NONE)||"''",[l.javascriptGenerator.provideFunction_("textCount",`
function ${l.javascriptGenerator.FUNCTION_NAME_PLACEHOLDER_}(haystack, needle) {
  if (needle.length === 0) {
    return haystack.length + 1;
  } else {
    return haystack.split(needle).length - 1;
  }
}
`)+"("+h+", "+c+")",l.javascriptGenerator.ORDER_FUNCTION_CALL]},l.javascriptGenerator.text_replace=function(c){const h=l.javascriptGenerator.valueToCode(c,"TEXT",l.javascriptGenerator.ORDER_NONE)||"''",p=l.javascriptGenerator.valueToCode(c,"FROM",l.javascriptGenerator.ORDER_NONE)||"''";return c=l.javascriptGenerator.valueToCode(c,"TO",l.javascriptGenerator.ORDER_NONE)||"''",[l.javascriptGenerator.provideFunction_("textReplace",`
function ${l.javascriptGenerator.FUNCTION_NAME_PLACEHOLDER_}(haystack, needle, replacement) {
  needle = needle.replace(/([-()\\[\\]{}+?*.$\\^|,:#<!\\\\])/g, '\\\\$1')
                 .replace(/\\x08/g, '\\\\x08');
  return haystack.replace(new RegExp(needle, 'g'), replacement);
}
`)+"("+h+", "+p+", "+c+")",l.javascriptGenerator.ORDER_FUNCTION_CALL]},l.javascriptGenerator.text_reverse=function(c){return[(l.javascriptGenerator.valueToCode(c,"TEXT",l.javascriptGenerator.ORDER_MEMBER)||"''")+".split('').reverse().join('')",l.javascriptGenerator.ORDER_FUNCTION_CALL]},o.NameType$$module$build$src$core$names,l.javascriptGenerator.procedures_defreturn=function(c){const h=l.javascriptGenerator.nameDB_.getName(c.getFieldValue("NAME"),o.NameType$$module$build$src$core$names.PROCEDURE);var p="";l.javascriptGenerator.STATEMENT_PREFIX&&(p+=l.javascriptGenerator.injectId(l.javascriptGenerator.STATEMENT_PREFIX,c)),l.javascriptGenerator.STATEMENT_SUFFIX&&(p+=l.javascriptGenerator.injectId(l.javascriptGenerator.STATEMENT_SUFFIX,c)),p&&(p=l.javascriptGenerator.prefixLines(p,l.javascriptGenerator.INDENT));let T="";l.javascriptGenerator.INFINITE_LOOP_TRAP&&(T=l.javascriptGenerator.prefixLines(l.javascriptGenerator.injectId(l.javascriptGenerator.INFINITE_LOOP_TRAP,c),l.javascriptGenerator.INDENT));const $=l.javascriptGenerator.statementToCode(c,"STACK");let S=l.javascriptGenerator.valueToCode(c,"RETURN",l.javascriptGenerator.ORDER_NONE)||"",y="";$&&S&&(y=p),S&&(S=l.javascriptGenerator.INDENT+"return "+S+`;
`);const g=[],E=c.getVars();for(let v=0;v<E.length;v++)g[v]=l.javascriptGenerator.nameDB_.getName(E[v],o.NameType$$module$build$src$core$names.VARIABLE);return p="function "+h+"("+g.join(", ")+`) {
`+p+T+$+y+S+"}",p=l.javascriptGenerator.scrub_(c,p),l.javascriptGenerator.definitions_["%"+h]=p,null},l.javascriptGenerator.procedures_defnoreturn=l.javascriptGenerator.procedures_defreturn,l.javascriptGenerator.procedures_callreturn=function(c){const h=l.javascriptGenerator.nameDB_.getName(c.getFieldValue("NAME"),o.NameType$$module$build$src$core$names.PROCEDURE),p=[],T=c.getVars();for(let $=0;$<T.length;$++)p[$]=l.javascriptGenerator.valueToCode(c,"ARG"+$,l.javascriptGenerator.ORDER_NONE)||"null";return[h+"("+p.join(", ")+")",l.javascriptGenerator.ORDER_FUNCTION_CALL]},l.javascriptGenerator.procedures_callnoreturn=function(c){return l.javascriptGenerator.procedures_callreturn(c)[0]+`;
`},l.javascriptGenerator.procedures_ifreturn=function(c){let h="if ("+(l.javascriptGenerator.valueToCode(c,"CONDITION",l.javascriptGenerator.ORDER_NONE)||"false")+`) {
`;return l.javascriptGenerator.STATEMENT_SUFFIX&&(h+=l.javascriptGenerator.prefixLines(l.javascriptGenerator.injectId(l.javascriptGenerator.STATEMENT_SUFFIX,c),l.javascriptGenerator.INDENT)),c.hasReturnValue_?(c=l.javascriptGenerator.valueToCode(c,"VALUE",l.javascriptGenerator.ORDER_NONE)||"null",h+=l.javascriptGenerator.INDENT+"return "+c+`;
`):h+=l.javascriptGenerator.INDENT+`return;
`,h+`}
`},o.NameType$$module$build$src$core$names,l.javascriptGenerator.math_number=function(c){return c=Number(c.getFieldValue("NUM")),[c,0<=c?l.javascriptGenerator.ORDER_ATOMIC:l.javascriptGenerator.ORDER_UNARY_NEGATION]},l.javascriptGenerator.math_arithmetic=function(c){var h={ADD:[" + ",l.javascriptGenerator.ORDER_ADDITION],MINUS:[" - ",l.javascriptGenerator.ORDER_SUBTRACTION],MULTIPLY:[" * ",l.javascriptGenerator.ORDER_MULTIPLICATION],DIVIDE:[" / ",l.javascriptGenerator.ORDER_DIVISION],POWER:[null,l.javascriptGenerator.ORDER_NONE]}[c.getFieldValue("OP")];const p=h[0];h=h[1];const T=l.javascriptGenerator.valueToCode(c,"A",h)||"0";return c=l.javascriptGenerator.valueToCode(c,"B",h)||"0",p?[T+p+c,h]:["Math.pow("+T+", "+c+")",l.javascriptGenerator.ORDER_FUNCTION_CALL]},l.javascriptGenerator.math_single=function(c){const h=c.getFieldValue("OP");let p;if(h==="NEG")return c=l.javascriptGenerator.valueToCode(c,"NUM",l.javascriptGenerator.ORDER_UNARY_NEGATION)||"0",c[0]==="-"&&(c=" "+c),["-"+c,l.javascriptGenerator.ORDER_UNARY_NEGATION];switch(c=h==="SIN"||h==="COS"||h==="TAN"?l.javascriptGenerator.valueToCode(c,"NUM",l.javascriptGenerator.ORDER_DIVISION)||"0":l.javascriptGenerator.valueToCode(c,"NUM",l.javascriptGenerator.ORDER_NONE)||"0",h){case"ABS":p="Math.abs("+c+")";break;case"ROOT":p="Math.sqrt("+c+")";break;case"LN":p="Math.log("+c+")";break;case"EXP":p="Math.exp("+c+")";break;case"POW10":p="Math.pow(10,"+c+")";break;case"ROUND":p="Math.round("+c+")";break;case"ROUNDUP":p="Math.ceil("+c+")";break;case"ROUNDDOWN":p="Math.floor("+c+")";break;case"SIN":p="Math.sin("+c+" / 180 * Math.PI)";break;case"COS":p="Math.cos("+c+" / 180 * Math.PI)";break;case"TAN":p="Math.tan("+c+" / 180 * Math.PI)"}if(p)return[p,l.javascriptGenerator.ORDER_FUNCTION_CALL];switch(h){case"LOG10":p="Math.log("+c+") / Math.log(10)";break;case"ASIN":p="Math.asin("+c+") / Math.PI * 180";break;case"ACOS":p="Math.acos("+c+") / Math.PI * 180";break;case"ATAN":p="Math.atan("+c+") / Math.PI * 180";break;default:throw Error("Unknown math operator: "+h)}return[p,l.javascriptGenerator.ORDER_DIVISION]},l.javascriptGenerator.math_constant=function(c){return{PI:["Math.PI",l.javascriptGenerator.ORDER_MEMBER],E:["Math.E",l.javascriptGenerator.ORDER_MEMBER],GOLDEN_RATIO:["(1 + Math.sqrt(5)) / 2",l.javascriptGenerator.ORDER_DIVISION],SQRT2:["Math.SQRT2",l.javascriptGenerator.ORDER_MEMBER],SQRT1_2:["Math.SQRT1_2",l.javascriptGenerator.ORDER_MEMBER],INFINITY:["Infinity",l.javascriptGenerator.ORDER_ATOMIC]}[c.getFieldValue("CONSTANT")]},l.javascriptGenerator.math_number_property=function(c){var h={EVEN:[" % 2 === 0",l.javascriptGenerator.ORDER_MODULUS,l.javascriptGenerator.ORDER_EQUALITY],ODD:[" % 2 === 1",l.javascriptGenerator.ORDER_MODULUS,l.javascriptGenerator.ORDER_EQUALITY],WHOLE:[" % 1 === 0",l.javascriptGenerator.ORDER_MODULUS,l.javascriptGenerator.ORDER_EQUALITY],POSITIVE:[" > 0",l.javascriptGenerator.ORDER_RELATIONAL,l.javascriptGenerator.ORDER_RELATIONAL],NEGATIVE:[" < 0",l.javascriptGenerator.ORDER_RELATIONAL,l.javascriptGenerator.ORDER_RELATIONAL],DIVISIBLE_BY:[null,l.javascriptGenerator.ORDER_MODULUS,l.javascriptGenerator.ORDER_EQUALITY],PRIME:[null,l.javascriptGenerator.ORDER_NONE,l.javascriptGenerator.ORDER_FUNCTION_CALL]};const p=c.getFieldValue("PROPERTY"),[T,$,S]=h[p];return h=l.javascriptGenerator.valueToCode(c,"NUMBER_TO_CHECK",$)||"0",p==="PRIME"?c=l.javascriptGenerator.provideFunction_("mathIsPrime",`
function ${l.javascriptGenerator.FUNCTION_NAME_PLACEHOLDER_}(n) {
  // https://en.wikipedia.org/wiki/Primality_test#Naive_methods
  if (n == 2 || n == 3) {
    return true;
  }
  // False if n is NaN, negative, is 1, or not whole.
  // And false if n is divisible by 2 or 3.
  if (isNaN(n) || n <= 1 || n % 1 !== 0 || n % 2 === 0 || n % 3 === 0) {
    return false;
  }
  // Check all the numbers of form 6k +/- 1, up to sqrt(n).
  for (var x = 6; x <= Math.sqrt(n) + 1; x += 6) {
    if (n % (x - 1) === 0 || n % (x + 1) === 0) {
      return false;
    }
  }
  return true;
}
`)+"("+h+")":p==="DIVISIBLE_BY"?(c=l.javascriptGenerator.valueToCode(c,"DIVISOR",l.javascriptGenerator.ORDER_MODULUS)||"0",c=h+" % "+c+" === 0"):c=h+T,[c,S]},l.javascriptGenerator.math_change=function(c){const h=l.javascriptGenerator.valueToCode(c,"DELTA",l.javascriptGenerator.ORDER_ADDITION)||"0";return c=l.javascriptGenerator.nameDB_.getName(c.getFieldValue("VAR"),o.NameType$$module$build$src$core$names.VARIABLE),c+" = (typeof "+c+" === 'number' ? "+c+" : 0) + "+h+`;
`},l.javascriptGenerator.math_round=l.javascriptGenerator.math_single,l.javascriptGenerator.math_trig=l.javascriptGenerator.math_single,l.javascriptGenerator.math_on_list=function(c){var h=c.getFieldValue("OP");switch(h){case"SUM":c=l.javascriptGenerator.valueToCode(c,"LIST",l.javascriptGenerator.ORDER_MEMBER)||"[]",c+=".reduce(function(x, y) {return x + y;}, 0)";break;case"MIN":c=l.javascriptGenerator.valueToCode(c,"LIST",l.javascriptGenerator.ORDER_NONE)||"[]",c="Math.min.apply(null, "+c+")";break;case"MAX":c=l.javascriptGenerator.valueToCode(c,"LIST",l.javascriptGenerator.ORDER_NONE)||"[]",c="Math.max.apply(null, "+c+")";break;case"AVERAGE":h=l.javascriptGenerator.provideFunction_("mathMean",`
function ${l.javascriptGenerator.FUNCTION_NAME_PLACEHOLDER_}(myList) {
  return myList.reduce(function(x, y) {return x + y;}, 0) / myList.length;
}
`),c=l.javascriptGenerator.valueToCode(c,"LIST",l.javascriptGenerator.ORDER_NONE)||"[]",c=h+"("+c+")";break;case"MEDIAN":h=l.javascriptGenerator.provideFunction_("mathMedian",`
function ${l.javascriptGenerator.FUNCTION_NAME_PLACEHOLDER_}(myList) {
  var localList = myList.filter(function (x) {return typeof x === 'number';});
  if (!localList.length) return null;
  localList.sort(function(a, b) {return b - a;});
  if (localList.length % 2 === 0) {
    return (localList[localList.length / 2 - 1] + localList[localList.length / 2]) / 2;
  } else {
    return localList[(localList.length - 1) / 2];
  }
}
`),c=l.javascriptGenerator.valueToCode(c,"LIST",l.javascriptGenerator.ORDER_NONE)||"[]",c=h+"("+c+")";break;case"MODE":h=l.javascriptGenerator.provideFunction_("mathModes",`
function ${l.javascriptGenerator.FUNCTION_NAME_PLACEHOLDER_}(values) {
  var modes = [];
  var counts = [];
  var maxCount = 0;
  for (var i = 0; i < values.length; i++) {
    var value = values[i];
    var found = false;
    var thisCount;
    for (var j = 0; j < counts.length; j++) {
      if (counts[j][0] === value) {
        thisCount = ++counts[j][1];
        found = true;
        break;
      }
    }
    if (!found) {
      counts.push([value, 1]);
      thisCount = 1;
    }
    maxCount = Math.max(thisCount, maxCount);
  }
  for (var j = 0; j < counts.length; j++) {
    if (counts[j][1] === maxCount) {
        modes.push(counts[j][0]);
    }
  }
  return modes;
}
`),c=l.javascriptGenerator.valueToCode(c,"LIST",l.javascriptGenerator.ORDER_NONE)||"[]",c=h+"("+c+")";break;case"STD_DEV":h=l.javascriptGenerator.provideFunction_("mathStandardDeviation",`
function ${l.javascriptGenerator.FUNCTION_NAME_PLACEHOLDER_}(numbers) {
  var n = numbers.length;
  if (!n) return null;
  var mean = numbers.reduce(function(x, y) {return x + y;}) / n;
  var variance = 0;
  for (var j = 0; j < n; j++) {
    variance += Math.pow(numbers[j] - mean, 2);
  }
  variance = variance / n;
  return Math.sqrt(variance);
}
`),c=l.javascriptGenerator.valueToCode(c,"LIST",l.javascriptGenerator.ORDER_NONE)||"[]",c=h+"("+c+")";break;case"RANDOM":h=l.javascriptGenerator.provideFunction_("mathRandomList",`
function ${l.javascriptGenerator.FUNCTION_NAME_PLACEHOLDER_}(list) {
  var x = Math.floor(Math.random() * list.length);
  return list[x];
}
`),c=l.javascriptGenerator.valueToCode(c,"LIST",l.javascriptGenerator.ORDER_NONE)||"[]",c=h+"("+c+")";break;default:throw Error("Unknown operator: "+h)}return[c,l.javascriptGenerator.ORDER_FUNCTION_CALL]},l.javascriptGenerator.math_modulo=function(c){const h=l.javascriptGenerator.valueToCode(c,"DIVIDEND",l.javascriptGenerator.ORDER_MODULUS)||"0";return c=l.javascriptGenerator.valueToCode(c,"DIVISOR",l.javascriptGenerator.ORDER_MODULUS)||"0",[h+" % "+c,l.javascriptGenerator.ORDER_MODULUS]},l.javascriptGenerator.math_constrain=function(c){const h=l.javascriptGenerator.valueToCode(c,"VALUE",l.javascriptGenerator.ORDER_NONE)||"0",p=l.javascriptGenerator.valueToCode(c,"LOW",l.javascriptGenerator.ORDER_NONE)||"0";return c=l.javascriptGenerator.valueToCode(c,"HIGH",l.javascriptGenerator.ORDER_NONE)||"Infinity",["Math.min(Math.max("+h+", "+p+"), "+c+")",l.javascriptGenerator.ORDER_FUNCTION_CALL]},l.javascriptGenerator.math_random_int=function(c){const h=l.javascriptGenerator.valueToCode(c,"FROM",l.javascriptGenerator.ORDER_NONE)||"0";return c=l.javascriptGenerator.valueToCode(c,"TO",l.javascriptGenerator.ORDER_NONE)||"0",[l.javascriptGenerator.provideFunction_("mathRandomInt",`
function ${l.javascriptGenerator.FUNCTION_NAME_PLACEHOLDER_}(a, b) {
  if (a > b) {
    // Swap a and b to ensure a is smaller.
    var c = a;
    a = b;
    b = c;
  }
  return Math.floor(Math.random() * (b - a + 1) + a);
}
`)+"("+h+", "+c+")",l.javascriptGenerator.ORDER_FUNCTION_CALL]},l.javascriptGenerator.math_random_float=function(c){return["Math.random()",l.javascriptGenerator.ORDER_FUNCTION_CALL]},l.javascriptGenerator.math_atan2=function(c){const h=l.javascriptGenerator.valueToCode(c,"X",l.javascriptGenerator.ORDER_NONE)||"0";return["Math.atan2("+(l.javascriptGenerator.valueToCode(c,"Y",l.javascriptGenerator.ORDER_NONE)||"0")+", "+h+") / Math.PI * 180",l.javascriptGenerator.ORDER_DIVISION]},o.module$build$src$core$utils$string,o.NameType$$module$build$src$core$names,l.javascriptGenerator.controls_repeat_ext=function(c){let h;h=c.getField("TIMES")?String(Number(c.getFieldValue("TIMES"))):l.javascriptGenerator.valueToCode(c,"TIMES",l.javascriptGenerator.ORDER_ASSIGNMENT)||"0";let p=l.javascriptGenerator.statementToCode(c,"DO");p=l.javascriptGenerator.addLoopTrap(p,c),c="";const T=l.javascriptGenerator.nameDB_.getDistinctName("count",o.NameType$$module$build$src$core$names.VARIABLE);let $=h;return h.match(/^\w+$/)||o.module$build$src$core$utils$string.isNumber(h)||($=l.javascriptGenerator.nameDB_.getDistinctName("repeat_end",o.NameType$$module$build$src$core$names.VARIABLE),c+="var "+$+" = "+h+`;
`),c+("for (var "+T+" = 0; "+T+" < "+$+"; "+T+`++) {
`+p+`}
`)},l.javascriptGenerator.controls_repeat=l.javascriptGenerator.controls_repeat_ext,l.javascriptGenerator.controls_whileUntil=function(c){const h=c.getFieldValue("MODE")==="UNTIL";let p=l.javascriptGenerator.valueToCode(c,"BOOL",h?l.javascriptGenerator.ORDER_LOGICAL_NOT:l.javascriptGenerator.ORDER_NONE)||"false",T=l.javascriptGenerator.statementToCode(c,"DO");return T=l.javascriptGenerator.addLoopTrap(T,c),h&&(p="!"+p),"while ("+p+`) {
`+T+`}
`},l.javascriptGenerator.controls_for=function(c){var h=l.javascriptGenerator.nameDB_.getName(c.getFieldValue("VAR"),o.NameType$$module$build$src$core$names.VARIABLE),p=l.javascriptGenerator.valueToCode(c,"FROM",l.javascriptGenerator.ORDER_ASSIGNMENT)||"0",T=l.javascriptGenerator.valueToCode(c,"TO",l.javascriptGenerator.ORDER_ASSIGNMENT)||"0";const $=l.javascriptGenerator.valueToCode(c,"BY",l.javascriptGenerator.ORDER_ASSIGNMENT)||"1";let S=l.javascriptGenerator.statementToCode(c,"DO");if(S=l.javascriptGenerator.addLoopTrap(S,c),o.module$build$src$core$utils$string.isNumber(p)&&o.module$build$src$core$utils$string.isNumber(T)&&o.module$build$src$core$utils$string.isNumber($)){var y=Number(p)<=Number(T);c="for ("+h+" = "+p+"; "+h+(y?" <= ":" >= ")+T+"; "+h,h=Math.abs(Number($)),c=h===1?c+(y?"++":"--"):c+((y?" += ":" -= ")+h),c+=`) {
`+S+`}
`}else c="",y=p,p.match(/^\w+$/)||o.module$build$src$core$utils$string.isNumber(p)||(y=l.javascriptGenerator.nameDB_.getDistinctName(h+"_start",o.NameType$$module$build$src$core$names.VARIABLE),c+="var "+y+" = "+p+`;
`),p=T,T.match(/^\w+$/)||o.module$build$src$core$utils$string.isNumber(T)||(p=l.javascriptGenerator.nameDB_.getDistinctName(h+"_end",o.NameType$$module$build$src$core$names.VARIABLE),c+="var "+p+" = "+T+`;
`),T=l.javascriptGenerator.nameDB_.getDistinctName(h+"_inc",o.NameType$$module$build$src$core$names.VARIABLE),c+="var "+T+" = ",c=o.module$build$src$core$utils$string.isNumber($)?c+(Math.abs($)+`;
`):c+("Math.abs("+$+`);
`),c+="if ("+y+" > "+p+`) {
`,c+=l.javascriptGenerator.INDENT+T+" = -"+T+`;
`,c=c+`}
for (`+(h+" = "+y+"; "+T+" >= 0 ? "+h+" <= "+p+" : "+h+" >= "+p+"; "+h+" += "+T+`) {
`+S+`}
`);return c},l.javascriptGenerator.controls_forEach=function(c){const h=l.javascriptGenerator.nameDB_.getName(c.getFieldValue("VAR"),o.NameType$$module$build$src$core$names.VARIABLE);var p=l.javascriptGenerator.valueToCode(c,"LIST",l.javascriptGenerator.ORDER_ASSIGNMENT)||"[]";let T=l.javascriptGenerator.statementToCode(c,"DO");T=l.javascriptGenerator.addLoopTrap(T,c),c="";let $=p;return p.match(/^\w+$/)||($=l.javascriptGenerator.nameDB_.getDistinctName(h+"_list",o.NameType$$module$build$src$core$names.VARIABLE),c+="var "+$+" = "+p+`;
`),p=l.javascriptGenerator.nameDB_.getDistinctName(h+"_index",o.NameType$$module$build$src$core$names.VARIABLE),T=l.javascriptGenerator.INDENT+h+" = "+$+"["+p+`];
`+T,c+("for (var "+p+" in "+$+`) {
`+T+`}
`)},l.javascriptGenerator.controls_flow_statements=function(c){let h="";if(l.javascriptGenerator.STATEMENT_PREFIX&&(h+=l.javascriptGenerator.injectId(l.javascriptGenerator.STATEMENT_PREFIX,c)),l.javascriptGenerator.STATEMENT_SUFFIX&&(h+=l.javascriptGenerator.injectId(l.javascriptGenerator.STATEMENT_SUFFIX,c)),l.javascriptGenerator.STATEMENT_PREFIX){const p=c.getSurroundLoop();p&&!p.suppressPrefixSuffix&&(h+=l.javascriptGenerator.injectId(l.javascriptGenerator.STATEMENT_PREFIX,p))}switch(c.getFieldValue("FLOW")){case"BREAK":return h+`break;
`;case"CONTINUE":return h+`continue;
`}throw Error("Unknown flow statement.")},l.javascriptGenerator.controls_if=function(c){var h=0;let p="";l.javascriptGenerator.STATEMENT_PREFIX&&(p+=l.javascriptGenerator.injectId(l.javascriptGenerator.STATEMENT_PREFIX,c));do{const T=l.javascriptGenerator.valueToCode(c,"IF"+h,l.javascriptGenerator.ORDER_NONE)||"false";let $=l.javascriptGenerator.statementToCode(c,"DO"+h);l.javascriptGenerator.STATEMENT_SUFFIX&&($=l.javascriptGenerator.prefixLines(l.javascriptGenerator.injectId(l.javascriptGenerator.STATEMENT_SUFFIX,c),l.javascriptGenerator.INDENT)+$),p+=(0<h?" else ":"")+"if ("+T+`) {
`+$+"}",h++}while(c.getInput("IF"+h));return(c.getInput("ELSE")||l.javascriptGenerator.STATEMENT_SUFFIX)&&(h=l.javascriptGenerator.statementToCode(c,"ELSE"),l.javascriptGenerator.STATEMENT_SUFFIX&&(h=l.javascriptGenerator.prefixLines(l.javascriptGenerator.injectId(l.javascriptGenerator.STATEMENT_SUFFIX,c),l.javascriptGenerator.INDENT)+h),p+=` else {
`+h+"}"),p+`
`},l.javascriptGenerator.controls_ifelse=l.javascriptGenerator.controls_if,l.javascriptGenerator.logic_compare=function(c){const h={EQ:"==",NEQ:"!=",LT:"<",LTE:"<=",GT:">",GTE:">="}[c.getFieldValue("OP")],p=h==="=="||h==="!="?l.javascriptGenerator.ORDER_EQUALITY:l.javascriptGenerator.ORDER_RELATIONAL,T=l.javascriptGenerator.valueToCode(c,"A",p)||"0";return c=l.javascriptGenerator.valueToCode(c,"B",p)||"0",[T+" "+h+" "+c,p]},l.javascriptGenerator.logic_operation=function(c){const h=c.getFieldValue("OP")==="AND"?"&&":"||",p=h==="&&"?l.javascriptGenerator.ORDER_LOGICAL_AND:l.javascriptGenerator.ORDER_LOGICAL_OR;let T=l.javascriptGenerator.valueToCode(c,"A",p);if(c=l.javascriptGenerator.valueToCode(c,"B",p),T||c){const $=h==="&&"?"true":"false";T||(T=$),c||(c=$)}else c=T="false";return[T+" "+h+" "+c,p]},l.javascriptGenerator.logic_negate=function(c){const h=l.javascriptGenerator.ORDER_LOGICAL_NOT;return["!"+(l.javascriptGenerator.valueToCode(c,"BOOL",h)||"true"),h]},l.javascriptGenerator.logic_boolean=function(c){return[c.getFieldValue("BOOL")==="TRUE"?"true":"false",l.javascriptGenerator.ORDER_ATOMIC]},l.javascriptGenerator.logic_null=function(c){return["null",l.javascriptGenerator.ORDER_ATOMIC]},l.javascriptGenerator.logic_ternary=function(c){const h=l.javascriptGenerator.valueToCode(c,"IF",l.javascriptGenerator.ORDER_CONDITIONAL)||"false",p=l.javascriptGenerator.valueToCode(c,"THEN",l.javascriptGenerator.ORDER_CONDITIONAL)||"null";return c=l.javascriptGenerator.valueToCode(c,"ELSE",l.javascriptGenerator.ORDER_CONDITIONAL)||"null",[h+" ? "+p+" : "+c,l.javascriptGenerator.ORDER_CONDITIONAL]},o.NameType$$module$build$src$core$names,l.javascriptGenerator.lists_create_empty=function(c){return["[]",l.javascriptGenerator.ORDER_ATOMIC]},l.javascriptGenerator.lists_create_with=function(c){const h=Array(c.itemCount_);for(let p=0;p<c.itemCount_;p++)h[p]=l.javascriptGenerator.valueToCode(c,"ADD"+p,l.javascriptGenerator.ORDER_NONE)||"null";return["["+h.join(", ")+"]",l.javascriptGenerator.ORDER_ATOMIC]},l.javascriptGenerator.lists_repeat=function(c){const h=l.javascriptGenerator.provideFunction_("listsRepeat",`
function ${l.javascriptGenerator.FUNCTION_NAME_PLACEHOLDER_}(value, n) {
  var array = [];
  for (var i = 0; i < n; i++) {
    array[i] = value;
  }
  return array;
}
`),p=l.javascriptGenerator.valueToCode(c,"ITEM",l.javascriptGenerator.ORDER_NONE)||"null";return c=l.javascriptGenerator.valueToCode(c,"NUM",l.javascriptGenerator.ORDER_NONE)||"0",[h+"("+p+", "+c+")",l.javascriptGenerator.ORDER_FUNCTION_CALL]},l.javascriptGenerator.lists_length=function(c){return[(l.javascriptGenerator.valueToCode(c,"VALUE",l.javascriptGenerator.ORDER_MEMBER)||"[]")+".length",l.javascriptGenerator.ORDER_MEMBER]},l.javascriptGenerator.lists_isEmpty=function(c){return["!"+(l.javascriptGenerator.valueToCode(c,"VALUE",l.javascriptGenerator.ORDER_MEMBER)||"[]")+".length",l.javascriptGenerator.ORDER_LOGICAL_NOT]},l.javascriptGenerator.lists_indexOf=function(c){var h=c.getFieldValue("END")==="FIRST"?"indexOf":"lastIndexOf";const p=l.javascriptGenerator.valueToCode(c,"FIND",l.javascriptGenerator.ORDER_NONE)||"''";return h=(l.javascriptGenerator.valueToCode(c,"VALUE",l.javascriptGenerator.ORDER_MEMBER)||"[]")+"."+h+"("+p+")",c.workspace.options.oneBasedIndex?[h+" + 1",l.javascriptGenerator.ORDER_ADDITION]:[h,l.javascriptGenerator.ORDER_FUNCTION_CALL]},l.javascriptGenerator.lists_getIndex=function(c){const h=c.getFieldValue("MODE")||"GET",p=c.getFieldValue("WHERE")||"FROM_START";var T=l.javascriptGenerator.valueToCode(c,"VALUE",p==="RANDOM"?l.javascriptGenerator.ORDER_NONE:l.javascriptGenerator.ORDER_MEMBER)||"[]";switch(p){case"FIRST":if(h==="GET")return[T+"[0]",l.javascriptGenerator.ORDER_MEMBER];if(h==="GET_REMOVE")return[T+".shift()",l.javascriptGenerator.ORDER_MEMBER];if(h==="REMOVE")return T+`.shift();
`;break;case"LAST":if(h==="GET")return[T+".slice(-1)[0]",l.javascriptGenerator.ORDER_MEMBER];if(h==="GET_REMOVE")return[T+".pop()",l.javascriptGenerator.ORDER_MEMBER];if(h==="REMOVE")return T+`.pop();
`;break;case"FROM_START":if(c=l.javascriptGenerator.getAdjusted(c,"AT"),h==="GET")return[T+"["+c+"]",l.javascriptGenerator.ORDER_MEMBER];if(h==="GET_REMOVE")return[T+".splice("+c+", 1)[0]",l.javascriptGenerator.ORDER_FUNCTION_CALL];if(h==="REMOVE")return T+".splice("+c+`, 1);
`;break;case"FROM_END":if(c=l.javascriptGenerator.getAdjusted(c,"AT",1,true),h==="GET")return[T+".slice("+c+")[0]",l.javascriptGenerator.ORDER_FUNCTION_CALL];if(h==="GET_REMOVE")return[T+".splice("+c+", 1)[0]",l.javascriptGenerator.ORDER_FUNCTION_CALL];if(h==="REMOVE")return T+".splice("+c+", 1);";break;case"RANDOM":if(T=l.javascriptGenerator.provideFunction_("listsGetRandomItem",`
function ${l.javascriptGenerator.FUNCTION_NAME_PLACEHOLDER_}(list, remove) {
  var x = Math.floor(Math.random() * list.length);
  if (remove) {
    return list.splice(x, 1)[0];
  } else {
    return list[x];
  }
}
`)+"("+T+", "+(h!=="GET")+")",h==="GET"||h==="GET_REMOVE")return[T,l.javascriptGenerator.ORDER_FUNCTION_CALL];if(h==="REMOVE")return T+`;
`}throw Error("Unhandled combination (lists_getIndex).")},l.javascriptGenerator.lists_setIndex=function(c){function h(){if(p.match(/^\w+$/))return"";const y=l.javascriptGenerator.nameDB_.getDistinctName("tmpList",o.NameType$$module$build$src$core$names.VARIABLE),g="var "+y+" = "+p+`;
`;return p=y,g}let p=l.javascriptGenerator.valueToCode(c,"LIST",l.javascriptGenerator.ORDER_MEMBER)||"[]";const T=c.getFieldValue("MODE")||"GET";var $=c.getFieldValue("WHERE")||"FROM_START";const S=l.javascriptGenerator.valueToCode(c,"TO",l.javascriptGenerator.ORDER_ASSIGNMENT)||"null";switch($){case"FIRST":if(T==="SET")return p+"[0] = "+S+`;
`;if(T==="INSERT")return p+".unshift("+S+`);
`;break;case"LAST":if(T==="SET")return h()+(p+"["+p+".length - 1] = "+S+`;
`);if(T==="INSERT")return p+".push("+S+`);
`;break;case"FROM_START":if(c=l.javascriptGenerator.getAdjusted(c,"AT"),T==="SET")return p+"["+c+"] = "+S+`;
`;if(T==="INSERT")return p+".splice("+c+", 0, "+S+`);
`;break;case"FROM_END":if(c=l.javascriptGenerator.getAdjusted(c,"AT",1,false,l.javascriptGenerator.ORDER_SUBTRACTION),$=h(),T==="SET")return $+(p+"["+p+".length - "+c+"] = "+S+`;
`);if(T==="INSERT")return $+(p+".splice("+p+".length - "+c+", 0, "+S+`);
`);break;case"RANDOM":if(c=h(),$=l.javascriptGenerator.nameDB_.getDistinctName("tmpX",o.NameType$$module$build$src$core$names.VARIABLE),c+="var "+$+" = Math.floor(Math.random() * "+p+`.length);
`,T==="SET")return c+(p+"["+$+"] = "+S+`;
`);if(T==="INSERT")return c+(p+".splice("+$+", 0, "+S+`);
`)}throw Error("Unhandled combination (lists_setIndex).")};var _=function(c,h,p){return h==="FIRST"?"0":h==="FROM_END"?c+".length - 1 - "+p:h==="LAST"?c+".length - 1":p};return l.javascriptGenerator.lists_getSublist=function(c){var h=l.javascriptGenerator.valueToCode(c,"LIST",l.javascriptGenerator.ORDER_MEMBER)||"[]",p=c.getFieldValue("WHERE1"),T=c.getFieldValue("WHERE2");if(p==="FIRST"&&T==="LAST")h+=".slice(0)";else if(h.match(/^\w+$/)||p!=="FROM_END"&&T==="FROM_START"){switch(p){case"FROM_START":p=l.javascriptGenerator.getAdjusted(c,"AT1");break;case"FROM_END":p=l.javascriptGenerator.getAdjusted(c,"AT1",1,false,l.javascriptGenerator.ORDER_SUBTRACTION),p=h+".length - "+p;break;case"FIRST":p="0";break;default:throw Error("Unhandled option (lists_getSublist).")}switch(T){case"FROM_START":T=l.javascriptGenerator.getAdjusted(c,"AT2",1);break;case"FROM_END":T=l.javascriptGenerator.getAdjusted(c,"AT2",0,false,l.javascriptGenerator.ORDER_SUBTRACTION),T=h+".length - "+T;break;case"LAST":T=h+".length";break;default:throw Error("Unhandled option (lists_getSublist).")}h=h+".slice("+p+", "+T+")"}else{const $=l.javascriptGenerator.getAdjusted(c,"AT1");c=l.javascriptGenerator.getAdjusted(c,"AT2");const S={FIRST:"First",LAST:"Last",FROM_START:"FromStart",FROM_END:"FromEnd"};h=l.javascriptGenerator.provideFunction_("subsequence"+S[p]+S[T],`
function ${l.javascriptGenerator.FUNCTION_NAME_PLACEHOLDER_}(sequence${p==="FROM_END"||p==="FROM_START"?", at1":""}${T==="FROM_END"||T==="FROM_START"?", at2":""}) {
  var start = ${_("sequence",p,"at1")};
  var end = ${_("sequence",T,"at2")} + 1;
  return sequence.slice(start, end);
}
`)+"("+h+(p==="FROM_END"||p==="FROM_START"?", "+$:"")+(T==="FROM_END"||T==="FROM_START"?", "+c:"")+")"}return[h,l.javascriptGenerator.ORDER_FUNCTION_CALL]},l.javascriptGenerator.lists_sort=function(c){const h=l.javascriptGenerator.valueToCode(c,"LIST",l.javascriptGenerator.ORDER_FUNCTION_CALL)||"[]",p=c.getFieldValue("DIRECTION")==="1"?1:-1;c=c.getFieldValue("TYPE");const T=l.javascriptGenerator.provideFunction_("listsGetSortCompare",`
function ${l.javascriptGenerator.FUNCTION_NAME_PLACEHOLDER_}(type, direction) {
  var compareFuncs = {
    'NUMERIC': function(a, b) {
        return Number(a) - Number(b); },
    'TEXT': function(a, b) {
        return a.toString() > b.toString() ? 1 : -1; },
    'IGNORE_CASE': function(a, b) {
        return a.toString().toLowerCase() > b.toString().toLowerCase() ? 1 : -1; },
  };
  var compare = compareFuncs[type];
  return function(a, b) { return compare(a, b) * direction; };
}
      `);return[h+".slice().sort("+T+'("'+c+'", '+p+"))",l.javascriptGenerator.ORDER_FUNCTION_CALL]},l.javascriptGenerator.lists_split=function(c){let h=l.javascriptGenerator.valueToCode(c,"INPUT",l.javascriptGenerator.ORDER_MEMBER);const p=l.javascriptGenerator.valueToCode(c,"DELIM",l.javascriptGenerator.ORDER_NONE)||"''";if(c=c.getFieldValue("MODE"),c==="SPLIT")h||(h="''"),c="split";else if(c==="JOIN")h||(h="[]"),c="join";else throw Error("Unknown mode: "+c);return[h+"."+c+"("+p+")",l.javascriptGenerator.ORDER_FUNCTION_CALL]},l.javascriptGenerator.lists_reverse=function(c){return[(l.javascriptGenerator.valueToCode(c,"LIST",l.javascriptGenerator.ORDER_FUNCTION_CALL)||"[]")+".slice().reverse()",l.javascriptGenerator.ORDER_FUNCTION_CALL]},l.javascriptGenerator.colour_picker=function(c){return[l.javascriptGenerator.quote_(c.getFieldValue("COLOUR")),l.javascriptGenerator.ORDER_ATOMIC]},l.javascriptGenerator.colour_random=function(c){return[l.javascriptGenerator.provideFunction_("colourRandom",`
function ${l.javascriptGenerator.FUNCTION_NAME_PLACEHOLDER_}() {
  var num = Math.floor(Math.random() * Math.pow(2, 24));
  return '#' + ('00000' + num.toString(16)).substr(-6);
}
`)+"()",l.javascriptGenerator.ORDER_FUNCTION_CALL]},l.javascriptGenerator.colour_rgb=function(c){const h=l.javascriptGenerator.valueToCode(c,"RED",l.javascriptGenerator.ORDER_NONE)||0,p=l.javascriptGenerator.valueToCode(c,"GREEN",l.javascriptGenerator.ORDER_NONE)||0;return c=l.javascriptGenerator.valueToCode(c,"BLUE",l.javascriptGenerator.ORDER_NONE)||0,[l.javascriptGenerator.provideFunction_("colourRgb",`
function ${l.javascriptGenerator.FUNCTION_NAME_PLACEHOLDER_}(r, g, b) {
  r = Math.max(Math.min(Number(r), 100), 0) * 2.55;
  g = Math.max(Math.min(Number(g), 100), 0) * 2.55;
  b = Math.max(Math.min(Number(b), 100), 0) * 2.55;
  r = ('0' + (Math.round(r) || 0).toString(16)).slice(-2);
  g = ('0' + (Math.round(g) || 0).toString(16)).slice(-2);
  b = ('0' + (Math.round(b) || 0).toString(16)).slice(-2);
  return '#' + r + g + b;
}
`)+"("+h+", "+p+", "+c+")",l.javascriptGenerator.ORDER_FUNCTION_CALL]},l.javascriptGenerator.colour_blend=function(c){const h=l.javascriptGenerator.valueToCode(c,"COLOUR1",l.javascriptGenerator.ORDER_NONE)||"'#000000'",p=l.javascriptGenerator.valueToCode(c,"COLOUR2",l.javascriptGenerator.ORDER_NONE)||"'#000000'";return c=l.javascriptGenerator.valueToCode(c,"RATIO",l.javascriptGenerator.ORDER_NONE)||.5,[l.javascriptGenerator.provideFunction_("colourBlend",`
function ${l.javascriptGenerator.FUNCTION_NAME_PLACEHOLDER_}(c1, c2, ratio) {
  ratio = Math.max(Math.min(Number(ratio), 1), 0);
  var r1 = parseInt(c1.substring(1, 3), 16);
  var g1 = parseInt(c1.substring(3, 5), 16);
  var b1 = parseInt(c1.substring(5, 7), 16);
  var r2 = parseInt(c2.substring(1, 3), 16);
  var g2 = parseInt(c2.substring(3, 5), 16);
  var b2 = parseInt(c2.substring(5, 7), 16);
  var r = Math.round(r1 * (1 - ratio) + r2 * ratio);
  var g = Math.round(g1 * (1 - ratio) + g2 * ratio);
  var b = Math.round(b1 * (1 - ratio) + b2 * ratio);
  r = ('0' + (r || 0).toString(16)).slice(-2);
  g = ('0' + (g || 0).toString(16)).slice(-2);
  b = ('0' + (b || 0).toString(16)).slice(-2);
  return '#' + r + g + b;
}
`)+"("+h+", "+p+", "+c+")",l.javascriptGenerator.ORDER_FUNCTION_CALL]},l.__namespace__=o,l})}(Sp)),Sp.exports}var IS;function QR(){return IS||(IS=1,function(s,n){(function(i,o){s.exports=o(ZR(),A1())})(Ni,function(i,o){/**
 * @license
 * Copyright 2020 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */return o})}(Ep)),Ep.exports}var se=QR(),L1=Object.defineProperty,ct=(s,n)=>L1(s,"name",{value:n,configurable:true});function N1(){}ct(N1,"noop");function tc(s){return s==null}ct(tc,"isNullable");function M1(s){return!tc(s)}ct(M1,"isNonNullable");function D1(s){return s&&typeof s=="object"&&!Array.isArray(s)}ct(D1,"isPlainObject");function x1(s,n){return Object.fromEntries(Object.entries(s).filter(([i,o])=>n(i,o)))}ct(x1,"filterKeys");function B1(s,n){return Object.fromEntries(Object.entries(s).map(([i,o])=>[i,n(o,i)]))}ct(B1,"mapValues");function P1(s,n,i){if(!n)return{...s};const o={};for(const l of n)(i||s[l]!==void 0)&&(o[l]=s[l]);return o}ct(P1,"pick");function U1(s,n){if(!n)return{...s};const i={...s};for(const o of n)Reflect.deleteProperty(i,o);return i}ct(U1,"omit");function F1(s,n,i){return Object.defineProperty(s,n,{writable:true,value:i,enumerable:false})}ct(F1,"defineProperty");function G1(s,n){return n.every(i=>s.includes(i))}ct(G1,"contain");function H1(s,n){return s.filter(i=>n.includes(i))}ct(H1,"intersection");function V1(s,n){return s.filter(i=>!n.includes(i))}ct(V1,"difference");function W1(s,n){return Array.from(new Set([...s,...n]))}ct(W1,"union");function dm(s){return[...new Set(s)]}ct(dm,"deduplicate");function z1(s,n){const i=s==null?void 0:s.indexOf(n);return i>=0?(s.splice(i,1),true):false}ct(z1,"remove");function j1(s){return Array.isArray(s)?s:tc(s)?[]:[s]}ct(j1,"makeArray");function Lr(s,n){return arguments.length===1?i=>Lr(s,i):s in globalThis&&n instanceof globalThis[s]||Object.prototype.toString.call(n).slice(8,-1)===s}ct(Lr,"is");function hc(s){return Lr("ArrayBuffer",s)||Lr("SharedArrayBuffer",s)}ct(hc,"isArrayBufferLike");function eI(s){return hc(s)||ArrayBuffer.isView(s)}ct(eI,"isArrayBufferSource");var ga;(s=>{s.is=hc,s.isSource=eI;function n(m){return ArrayBuffer.isView(m)?m.buffer.slice(m.byteOffset,m.byteOffset+m.byteLength):m}s.fromSource=n,ct(n,"fromSource");function i(m){if(typeof Buffer<"u")return Buffer.from(m).toString("base64");let u="";const _=new Uint8Array(m);for(let c=0;c<_.byteLength;c++)u+=String.fromCharCode(_[c]);return btoa(u)}s.toBase64=i,ct(i,"toBase64");function o(m){return typeof Buffer<"u"?n(Buffer.from(m,"base64")):Uint8Array.from(atob(m),u=>u.charCodeAt(0))}s.fromBase64=o,ct(o,"fromBase64");function l(m){return typeof Buffer<"u"?Buffer.from(m).toString("hex"):Array.from(new Uint8Array(m),u=>u.toString(16).padStart(2,"0")).join("")}s.toHex=l,ct(l,"toHex");function f(m){if(typeof Buffer<"u")return n(Buffer.from(m,"hex"));const u=m.length%2===0?m:m.slice(0,m.length-1),_=[];for(let c=0;c<u.length;c+=2)_.push(parseInt(`${u[c]}${u[c+1]}`,16));return Uint8Array.from(_).buffer}s.fromHex=f,ct(f,"fromHex")})(ga||(ga={}));ga.fromBase64;ga.toBase64;ga.fromHex;ga.toHex;function kf(s,n=new Map){if(!s||typeof s!="object")return s;if(Lr("Date",s))return new Date(s.valueOf());if(Lr("RegExp",s))return new RegExp(s.source,s.flags);if(hc(s))return s.slice(0);if(ArrayBuffer.isView(s))return s.buffer.slice(s.byteOffset,s.byteOffset+s.byteLength);const i=n.get(s);if(i)return i;if(Array.isArray(s)){const l=[];return n.set(s,l),s.forEach((f,m)=>{l[m]=Reflect.apply(kf,null,[f,n])}),l}const o=Object.create(Object.getPrototypeOf(s));n.set(s,o);for(const l of Reflect.ownKeys(s)){const f={...Reflect.getOwnPropertyDescriptor(s,l)};"value"in f&&(f.value=Reflect.apply(kf,null,[f.value,n])),Reflect.defineProperty(o,l,f)}return o}ct(kf,"clone");function Af(s,n,i){if(s===n||!i&&tc(s)&&tc(n))return true;if(typeof s!=typeof n||typeof s!="object"||!s||!n)return false;function o(l,f){return l(s)?l(n)?f(s,n):false:l(n)?false:void 0}return ct(o,"check"),o(Array.isArray,(l,f)=>l.length===f.length&&l.every((m,u)=>Af(m,f[u])))??o(Lr("Date"),(l,f)=>l.valueOf()===f.valueOf())??o(Lr("RegExp"),(l,f)=>l.source===f.source&&l.flags===f.flags)??o(hc,(l,f)=>{if(l.byteLength!==f.byteLength)return false;const m=new Uint8Array(l),u=new Uint8Array(f);for(let _=0;_<m.length;_++)if(m[_]!==u[_])return false;return true})??Object.keys({...s,...n}).every(l=>Af(s[l],n[l],i))}ct(Af,"deepEqual");function X1(s){return s.charAt(0).toUpperCase()+s.slice(1)}ct(X1,"capitalize");function K1(s){return s.charAt(0).toLowerCase()+s.slice(1)}ct(K1,"uncapitalize");function Y1(s){return s.replace(/[_-][a-z]/g,n=>n.slice(1).toUpperCase())}ct(Y1,"camelCase");function _m(s,n,i){const o=[];let l=0;for(let f=0;f<s.length;f++){const m=s.charCodeAt(f);if(m>=65&&m<=90){if(l===1){const u=s.charCodeAt(f+1);u>=97&&u<=122&&o.push(i),o.push(m+32)}else l!==0&&o.push(i),o.push(m+32);l=1}else m>=97&&m<=122?(o.push(m),l=2):n.includes(m)?(l!==0&&o.push(i),l=0):o.push(m)}return String.fromCharCode(...o)}ct(_m,"tokenize");function q1(s){return _m(s,[45,95],45)}ct(q1,"paramCase");function J1(s){return _m(s,[45,95],95)}ct(J1,"snakeCase");function Z1(s){return typeof s!="string"?`[${s.toString()}]`:/^[a-z_$][\w$]*$/i.test(s)?`.${s}`:`[${JSON.stringify(s)}]`}ct(Z1,"formatProperty");function tI(s){return s.replace(/\/$/,"")}ct(tI,"trimSlash");function Q1(s){return s.startsWith("/")||(s="/"+s),tI(s)}ct(Q1,"sanitize");var CS;(s=>{s.millisecond=1,s.second=1e3,s.minute=s.second*60,s.hour=s.minute*60,s.day=s.hour*24,s.week=s.day*7;let n=new Date().getTimezoneOffset();function i($){n=$}s.setTimezoneOffset=i,ct(i,"setTimezoneOffset");function o(){return n}s.getTimezoneOffset=o,ct(o,"getTimezoneOffset");function l($=new Date,S){return typeof $=="number"&&($=new Date($)),S===void 0&&(S=n),Math.floor(($.valueOf()/s.minute-S)/1440)}s.getDateNumber=l,ct(l,"getDateNumber");function f($,S){const y=new Date($*s.day);return S===void 0&&(S=n),new Date(+y+S*s.minute)}s.fromDateNumber=f,ct(f,"fromDateNumber");const m=/\d+(?:\.\d+)?/.source,u=new RegExp(`^${["w(?:eek(?:s)?)?","d(?:ay(?:s)?)?","h(?:our(?:s)?)?","m(?:in(?:ute)?(?:s)?)?","s(?:ec(?:ond)?(?:s)?)?"].map($=>`(${m}${$})?`).join("")}$`);function _($){const S=u.exec($);return S?(parseFloat(S[1])*s.week||0)+(parseFloat(S[2])*s.day||0)+(parseFloat(S[3])*s.hour||0)+(parseFloat(S[4])*s.minute||0)+(parseFloat(S[5])*s.second||0):0}s.parseTime=_,ct(_,"parseTime");function c($){const S=_($);return S?$=Date.now()+S:/^\d{1,2}(:\d{1,2}){1,2}$/.test($)?$=`${new Date().toLocaleDateString()}-${$}`:/^\d{1,2}-\d{1,2}-\d{1,2}(:\d{1,2}){1,2}$/.test($)&&($=`${new Date().getFullYear()}-${$}`),$?new Date($):new Date}s.parseDate=c,ct(c,"parseDate");function h($){const S=Math.abs($);return S>=s.day-s.hour/2?Math.round($/s.day)+"d":S>=s.hour-s.minute/2?Math.round($/s.hour)+"h":S>=s.minute-s.second/2?Math.round($/s.minute)+"m":S>=s.second?Math.round($/s.second)+"s":$+"ms"}s.format=h,ct(h,"format");function p($,S=2){return $.toString().padStart(S,"0")}s.toDigits=p,ct(p,"toDigits");function T($,S=new Date){return $.replace("yyyy",S.getFullYear().toString()).replace("yy",S.getFullYear().toString().slice(2)).replace("MM",p(S.getMonth()+1)).replace("dd",p(S.getDate())).replace("hh",p(S.getHours())).replace("mm",p(S.getMinutes())).replace("ss",p(S.getSeconds())).replace("SSS",p(S.getMilliseconds(),3))}s.template=T,ct(T,"template")})(CS||(CS={}));const ex='export const inject = {required: ["puppeteer"]}',tx=`ctx.database.extend("blockly_key_value",{
    key: "string",
    value: "string",
},{
  primary: "key"
})
`,sx=`const logger = ctx.logger("{{name}}")
`,ix=`const plugin_id = "{{plugin_id}}"
`,nx=`function getFiles(dir, extensions, files_){
    const fs = require('fs');
    const path = require('path');
    files_ = files_ || [];
    let files = fs.readdirSync(dir);
    for (let i in files){
        let name = dir + '/' + files[i];
        if (fs.statSync(name).isDirectory()){
            getFiles(name, extensions, files_);
        } else {
            let ext = path.extname(name);
            if(extensions.includes(ext)) {
                files_.push(name);
            }
        }
    }
    return files_;
}
`,rx=`function fetchDataFromUrl(url) {
    const http = require('http');
    const fs = require('fs');
    const urlModule = require('url');
    return new Promise((resolve, reject) => {
        const parsedUrl = urlModule.parse(url);
        if (parsedUrl.protocol.startsWith('http')) {
            const protocol = parsedUrl.protocol === 'https:' ? require('https') : require('http');
            protocol.get(url, (res) => {
                const data = [];
                res.on('data', (chunk) => {
                    data.push(chunk);
                });
                res.on('end', () => {
                    resolve(Buffer.concat(data));
                }).on('error', (err) => {
                    console.error(err.message);
                    reject(err);
                });
            });
        } else if (parsedUrl.protocol === 'file:') {
            fs.readFile(parsedUrl.path, (err, data) => {
                if (err) {
                    console.error(err.message);
                    reject(err);
                } else {
                    resolve(data);
                }
            });
        } else {
            reject(new Error(\`Unsupported protocol: \${parsedUrl.protocol}\`));
        }
    });
}
`,ox=`function x_MD5(x_MD5) { 
    const crypto = require('crypto');   
    const hash = crypto.createHash('md5');     
    hash.update(x_MD5);     
    return hash.digest('hex'); 
}`,ax={key_value_initialize:tx,logger_initialize:sx,plugin_id:ix,test:nx,pptr:ex,fetchDataFromUrl:rx,MD5:ox};function lx(s,n="",i=[],o=""){return[...Object.entries(s)].map(([f,m])=>`import { ${m.join(", ")} } from "${f}"
`).join("")+w1.replace(/\{\{name}}/g,n.replace(/"/g,'\\"').replace(/\\/g,"\\\\")).replace(/\{\{apply}}/g,o.split(`
`).map(f=>"  "+f).join(`
`))}function cx(s){const n=s.split(`
`),i=[],o=[];let l;(m=>{m[m.Import=0]="Import",m[m.Export=1]="Export",m[m.Other=2]="Other"})(l||(l={}));for(const m of n){const u=m.trimLeft(),_=u.startsWith("import")?0:u.startsWith("export const")?1:2;_===0||_===1?i.push(u):o.push(m)}return i.sort((m,u)=>m.startsWith("import")&&u.startsWith("export const")?0:m.startsWith("import")?-1:u.startsWith("import")?1:0),i.concat(o).join(`
`)}function ux(s,n,i){let o={};const l=i.getAllBlocks(false);l.filter(_=>_.imports).forEach(_=>{Object.entries(_.imports).forEach(([c,h])=>{o[c]||(o[c]=[]),o[c]=dm([...o[c],...h])})});const f=l.filter(_=>_.template).map(_=>_.template).reduce((_,c)=>_.concat(c),[]).filter((_,c,h)=>h.indexOf(_)===c),m=l.filter(_=>_.injects).map(_=>_.injects).reduce((_,c)=>_.concat(c),[]).filter((_,c,h)=>h.indexOf(_)===c);console.log(m),console.log(l);let u=lx(o,s,m,f.map(_=>ax[_]+`
`).map(_=>_.replace("{{name}}",s).replace("{{plugin_id}}",n)).join("")+se.javascriptGenerator.workspaceToCode(i));return cx(u)}var Du={exports:{}},$p,OS;function fh(){if(OS)return $p;OS=1;const s="2.0.0",n=256,i=Number.MAX_SAFE_INTEGER||9007199254740991,o=16,l=n-6;return $p={MAX_LENGTH:n,MAX_SAFE_COMPONENT_LENGTH:o,MAX_SAFE_BUILD_LENGTH:l,MAX_SAFE_INTEGER:i,RELEASE_TYPES:["major","premajor","minor","preminor","patch","prepatch","prerelease"],SEMVER_SPEC_VERSION:s,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2},$p}var yp,wS;function mh(){return wS||(wS=1,yp=typeof process=="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...n)=>console.error("SEMVER",...n):()=>{}),yp}var kS;function dc(){return kS||(kS=1,function(s,n){const{MAX_SAFE_COMPONENT_LENGTH:i,MAX_SAFE_BUILD_LENGTH:o,MAX_LENGTH:l}=fh(),f=mh();n=s.exports={};const m=n.re=[],u=n.safeRe=[],_=n.src=[],c=n.safeSrc=[],h=n.t={};let p=0;const T="[a-zA-Z0-9-]",$=[["\\s",1],["\\d",l],[T,o]],S=g=>{for(const[E,v]of $)g=g.split(`${E}*`).join(`${E}{0,${v}}`).split(`${E}+`).join(`${E}{1,${v}}`);return g},y=(g,E,v)=>{const b=S(E),R=p++;f(g,R,E),h[g]=R,_[R]=E,c[R]=b,m[R]=new RegExp(E,v?"g":void 0),u[R]=new RegExp(b,v?"g":void 0)};y("NUMERICIDENTIFIER","0|[1-9]\\d*"),y("NUMERICIDENTIFIERLOOSE","\\d+"),y("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${T}*`),y("MAINVERSION",`(${_[h.NUMERICIDENTIFIER]})\\.(${_[h.NUMERICIDENTIFIER]})\\.(${_[h.NUMERICIDENTIFIER]})`),y("MAINVERSIONLOOSE",`(${_[h.NUMERICIDENTIFIERLOOSE]})\\.(${_[h.NUMERICIDENTIFIERLOOSE]})\\.(${_[h.NUMERICIDENTIFIERLOOSE]})`),y("PRERELEASEIDENTIFIER",`(?:${_[h.NONNUMERICIDENTIFIER]}|${_[h.NUMERICIDENTIFIER]})`),y("PRERELEASEIDENTIFIERLOOSE",`(?:${_[h.NONNUMERICIDENTIFIER]}|${_[h.NUMERICIDENTIFIERLOOSE]})`),y("PRERELEASE",`(?:-(${_[h.PRERELEASEIDENTIFIER]}(?:\\.${_[h.PRERELEASEIDENTIFIER]})*))`),y("PRERELEASELOOSE",`(?:-?(${_[h.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${_[h.PRERELEASEIDENTIFIERLOOSE]})*))`),y("BUILDIDENTIFIER",`${T}+`),y("BUILD",`(?:\\+(${_[h.BUILDIDENTIFIER]}(?:\\.${_[h.BUILDIDENTIFIER]})*))`),y("FULLPLAIN",`v?${_[h.MAINVERSION]}${_[h.PRERELEASE]}?${_[h.BUILD]}?`),y("FULL",`^${_[h.FULLPLAIN]}$`),y("LOOSEPLAIN",`[v=\\s]*${_[h.MAINVERSIONLOOSE]}${_[h.PRERELEASELOOSE]}?${_[h.BUILD]}?`),y("LOOSE",`^${_[h.LOOSEPLAIN]}$`),y("GTLT","((?:<|>)?=?)"),y("XRANGEIDENTIFIERLOOSE",`${_[h.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),y("XRANGEIDENTIFIER",`${_[h.NUMERICIDENTIFIER]}|x|X|\\*`),y("XRANGEPLAIN",`[v=\\s]*(${_[h.XRANGEIDENTIFIER]})(?:\\.(${_[h.XRANGEIDENTIFIER]})(?:\\.(${_[h.XRANGEIDENTIFIER]})(?:${_[h.PRERELEASE]})?${_[h.BUILD]}?)?)?`),y("XRANGEPLAINLOOSE",`[v=\\s]*(${_[h.XRANGEIDENTIFIERLOOSE]})(?:\\.(${_[h.XRANGEIDENTIFIERLOOSE]})(?:\\.(${_[h.XRANGEIDENTIFIERLOOSE]})(?:${_[h.PRERELEASELOOSE]})?${_[h.BUILD]}?)?)?`),y("XRANGE",`^${_[h.GTLT]}\\s*${_[h.XRANGEPLAIN]}$`),y("XRANGELOOSE",`^${_[h.GTLT]}\\s*${_[h.XRANGEPLAINLOOSE]}$`),y("COERCEPLAIN",`(^|[^\\d])(\\d{1,${i}})(?:\\.(\\d{1,${i}}))?(?:\\.(\\d{1,${i}}))?`),y("COERCE",`${_[h.COERCEPLAIN]}(?:$|[^\\d])`),y("COERCEFULL",_[h.COERCEPLAIN]+`(?:${_[h.PRERELEASE]})?(?:${_[h.BUILD]})?(?:$|[^\\d])`),y("COERCERTL",_[h.COERCE],true),y("COERCERTLFULL",_[h.COERCEFULL],true),y("LONETILDE","(?:~>?)"),y("TILDETRIM",`(\\s*)${_[h.LONETILDE]}\\s+`,true),n.tildeTrimReplace="$1~",y("TILDE",`^${_[h.LONETILDE]}${_[h.XRANGEPLAIN]}$`),y("TILDELOOSE",`^${_[h.LONETILDE]}${_[h.XRANGEPLAINLOOSE]}$`),y("LONECARET","(?:\\^)"),y("CARETTRIM",`(\\s*)${_[h.LONECARET]}\\s+`,true),n.caretTrimReplace="$1^",y("CARET",`^${_[h.LONECARET]}${_[h.XRANGEPLAIN]}$`),y("CARETLOOSE",`^${_[h.LONECARET]}${_[h.XRANGEPLAINLOOSE]}$`),y("COMPARATORLOOSE",`^${_[h.GTLT]}\\s*(${_[h.LOOSEPLAIN]})$|^$`),y("COMPARATOR",`^${_[h.GTLT]}\\s*(${_[h.FULLPLAIN]})$|^$`),y("COMPARATORTRIM",`(\\s*)${_[h.GTLT]}\\s*(${_[h.LOOSEPLAIN]}|${_[h.XRANGEPLAIN]})`,true),n.comparatorTrimReplace="$1$2$3",y("HYPHENRANGE",`^\\s*(${_[h.XRANGEPLAIN]})\\s+-\\s+(${_[h.XRANGEPLAIN]})\\s*$`),y("HYPHENRANGELOOSE",`^\\s*(${_[h.XRANGEPLAINLOOSE]})\\s+-\\s+(${_[h.XRANGEPLAINLOOSE]})\\s*$`),y("STAR","(<|>)?=?\\s*\\*"),y("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),y("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")}(Du,Du.exports)),Du.exports}var Rp,AS;function pm(){if(AS)return Rp;AS=1;const s=Object.freeze({loose:true}),n=Object.freeze({});return Rp=o=>o?typeof o!="object"?s:o:n,Rp}var Ip,LS;function sI(){if(LS)return Ip;LS=1;const s=/^[0-9]+$/,n=(o,l)=>{const f=s.test(o),m=s.test(l);return f&&m&&(o=+o,l=+l),o===l?0:f&&!m?-1:m&&!f?1:o<l?-1:1};return Ip={compareIdentifiers:n,rcompareIdentifiers:(o,l)=>n(l,o)},Ip}var Cp,NS;function ei(){if(NS)return Cp;NS=1;const s=mh(),{MAX_LENGTH:n,MAX_SAFE_INTEGER:i}=fh(),{safeRe:o,t:l}=dc(),f=pm(),{compareIdentifiers:m}=sI();class u{constructor(c,h){if(h=f(h),c instanceof u){if(c.loose===!!h.loose&&c.includePrerelease===!!h.includePrerelease)return c;c=c.version}else if(typeof c!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof c}".`);if(c.length>n)throw new TypeError(`version is longer than ${n} characters`);s("SemVer",c,h),this.options=h,this.loose=!!h.loose,this.includePrerelease=!!h.includePrerelease;const p=c.trim().match(h.loose?o[l.LOOSE]:o[l.FULL]);if(!p)throw new TypeError(`Invalid Version: ${c}`);if(this.raw=c,this.major=+p[1],this.minor=+p[2],this.patch=+p[3],this.major>i||this.major<0)throw new TypeError("Invalid major version");if(this.minor>i||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>i||this.patch<0)throw new TypeError("Invalid patch version");p[4]?this.prerelease=p[4].split(".").map(T=>{if(/^[0-9]+$/.test(T)){const $=+T;if($>=0&&$<i)return $}return T}):this.prerelease=[],this.build=p[5]?p[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(c){if(s("SemVer.compare",this.version,this.options,c),!(c instanceof u)){if(typeof c=="string"&&c===this.version)return 0;c=new u(c,this.options)}return c.version===this.version?0:this.compareMain(c)||this.comparePre(c)}compareMain(c){return c instanceof u||(c=new u(c,this.options)),m(this.major,c.major)||m(this.minor,c.minor)||m(this.patch,c.patch)}comparePre(c){if(c instanceof u||(c=new u(c,this.options)),this.prerelease.length&&!c.prerelease.length)return-1;if(!this.prerelease.length&&c.prerelease.length)return 1;if(!this.prerelease.length&&!c.prerelease.length)return 0;let h=0;do{const p=this.prerelease[h],T=c.prerelease[h];if(s("prerelease compare",h,p,T),p===void 0&&T===void 0)return 0;if(T===void 0)return 1;if(p===void 0)return-1;if(p===T)continue;return m(p,T)}while(++h)}compareBuild(c){c instanceof u||(c=new u(c,this.options));let h=0;do{const p=this.build[h],T=c.build[h];if(s("build compare",h,p,T),p===void 0&&T===void 0)return 0;if(T===void 0)return 1;if(p===void 0)return-1;if(p===T)continue;return m(p,T)}while(++h)}inc(c,h,p){if(c.startsWith("pre")){if(!h&&p===false)throw new Error("invalid increment argument: identifier is empty");if(h){const T=`-${h}`.match(this.options.loose?o[l.PRERELEASELOOSE]:o[l.PRERELEASE]);if(!T||T[1]!==h)throw new Error(`invalid identifier: ${h}`)}}switch(c){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",h,p);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",h,p);break;case"prepatch":this.prerelease.length=0,this.inc("patch",h,p),this.inc("pre",h,p);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",h,p),this.inc("pre",h,p);break;case"release":if(this.prerelease.length===0)throw new Error(`version ${this.raw} is not a prerelease`);this.prerelease.length=0;break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{const T=Number(p)?1:0;if(this.prerelease.length===0)this.prerelease=[T];else{let $=this.prerelease.length;for(;--$>=0;)typeof this.prerelease[$]=="number"&&(this.prerelease[$]++,$=-2);if($===-1){if(h===this.prerelease.join(".")&&p===false)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(T)}}if(h){let $=[h,T];p===false&&($=[h]),m(this.prerelease[0],h)===0?isNaN(this.prerelease[1])&&(this.prerelease=$):this.prerelease=$}break}default:throw new Error(`invalid increment argument: ${c}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}}return Cp=u,Cp}var Op,MS;function wa(){if(MS)return Op;MS=1;const s=ei();return Op=(i,o,l=false)=>{if(i instanceof s)return i;try{return new s(i,o)}catch(f){if(!l)return null;throw f}},Op}var wp,DS;function hx(){if(DS)return wp;DS=1;const s=wa();return wp=(i,o)=>{const l=s(i,o);return l?l.version:null},wp}var kp,xS;function dx(){if(xS)return kp;xS=1;const s=wa();return kp=(i,o)=>{const l=s(i.trim().replace(/^[=v]+/,""),o);return l?l.version:null},kp}var Ap,BS;function _x(){if(BS)return Ap;BS=1;const s=ei();return Ap=(i,o,l,f,m)=>{typeof l=="string"&&(m=f,f=l,l=void 0);try{return new s(i instanceof s?i.version:i,l).inc(o,f,m).version}catch{return null}},Ap}var Lp,PS;function px(){if(PS)return Lp;PS=1;const s=wa();return Lp=(i,o)=>{const l=s(i,null,true),f=s(o,null,true),m=l.compare(f);if(m===0)return null;const u=m>0,_=u?l:f,c=u?f:l,h=!!_.prerelease.length;if(!!c.prerelease.length&&!h){if(!c.patch&&!c.minor)return"major";if(c.compareMain(_)===0)return c.minor&&!c.patch?"minor":"patch"}const T=h?"pre":"";return l.major!==f.major?T+"major":l.minor!==f.minor?T+"minor":l.patch!==f.patch?T+"patch":"prerelease"},Lp}var Np,US;function gx(){if(US)return Np;US=1;const s=ei();return Np=(i,o)=>new s(i,o).major,Np}var Mp,FS;function fx(){if(FS)return Mp;FS=1;const s=ei();return Mp=(i,o)=>new s(i,o).minor,Mp}var Dp,GS;function mx(){if(GS)return Dp;GS=1;const s=ei();return Dp=(i,o)=>new s(i,o).patch,Dp}var xp,HS;function Ex(){if(HS)return xp;HS=1;const s=wa();return xp=(i,o)=>{const l=s(i,o);return l&&l.prerelease.length?l.prerelease:null},xp}var Bp,VS;function dn(){if(VS)return Bp;VS=1;const s=ei();return Bp=(i,o,l)=>new s(i,l).compare(new s(o,l)),Bp}var Pp,WS;function vx(){if(WS)return Pp;WS=1;const s=dn();return Pp=(i,o,l)=>s(o,i,l),Pp}var Up,zS;function bx(){if(zS)return Up;zS=1;const s=dn();return Up=(i,o)=>s(i,o,true),Up}var Fp,jS;function gm(){if(jS)return Fp;jS=1;const s=ei();return Fp=(i,o,l)=>{const f=new s(i,l),m=new s(o,l);return f.compare(m)||f.compareBuild(m)},Fp}var Gp,XS;function Tx(){if(XS)return Gp;XS=1;const s=gm();return Gp=(i,o)=>i.sort((l,f)=>s(l,f,o)),Gp}var Hp,KS;function Sx(){if(KS)return Hp;KS=1;const s=gm();return Hp=(i,o)=>i.sort((l,f)=>s(f,l,o)),Hp}var Vp,YS;function Eh(){if(YS)return Vp;YS=1;const s=dn();return Vp=(i,o,l)=>s(i,o,l)>0,Vp}var Wp,qS;function fm(){if(qS)return Wp;qS=1;const s=dn();return Wp=(i,o,l)=>s(i,o,l)<0,Wp}var zp,JS;function iI(){if(JS)return zp;JS=1;const s=dn();return zp=(i,o,l)=>s(i,o,l)===0,zp}var jp,ZS;function nI(){if(ZS)return jp;ZS=1;const s=dn();return jp=(i,o,l)=>s(i,o,l)!==0,jp}var Xp,QS;function mm(){if(QS)return Xp;QS=1;const s=dn();return Xp=(i,o,l)=>s(i,o,l)>=0,Xp}var Kp,e$;function Em(){if(e$)return Kp;e$=1;const s=dn();return Kp=(i,o,l)=>s(i,o,l)<=0,Kp}var Yp,t$;function rI(){if(t$)return Yp;t$=1;const s=iI(),n=nI(),i=Eh(),o=mm(),l=fm(),f=Em();return Yp=(u,_,c,h)=>{switch(_){case"===":return typeof u=="object"&&(u=u.version),typeof c=="object"&&(c=c.version),u===c;case"!==":return typeof u=="object"&&(u=u.version),typeof c=="object"&&(c=c.version),u!==c;case"":case"=":case"==":return s(u,c,h);case"!=":return n(u,c,h);case">":return i(u,c,h);case">=":return o(u,c,h);case"<":return l(u,c,h);case"<=":return f(u,c,h);default:throw new TypeError(`Invalid operator: ${_}`)}},Yp}var qp,s$;function $x(){if(s$)return qp;s$=1;const s=ei(),n=wa(),{safeRe:i,t:o}=dc();return qp=(f,m)=>{if(f instanceof s)return f;if(typeof f=="number"&&(f=String(f)),typeof f!="string")return null;m=m||{};let u=null;if(!m.rtl)u=f.match(m.includePrerelease?i[o.COERCEFULL]:i[o.COERCE]);else{const $=m.includePrerelease?i[o.COERCERTLFULL]:i[o.COERCERTL];let S;for(;(S=$.exec(f))&&(!u||u.index+u[0].length!==f.length);)(!u||S.index+S[0].length!==u.index+u[0].length)&&(u=S),$.lastIndex=S.index+S[1].length+S[2].length;$.lastIndex=-1}if(u===null)return null;const _=u[2],c=u[3]||"0",h=u[4]||"0",p=m.includePrerelease&&u[5]?`-${u[5]}`:"",T=m.includePrerelease&&u[6]?`+${u[6]}`:"";return n(`${_}.${c}.${h}${p}${T}`,m)},qp}var Jp,i$;function yx(){if(i$)return Jp;i$=1;class s{constructor(){this.max=1e3,this.map=new Map}get(i){const o=this.map.get(i);if(o!==void 0)return this.map.delete(i),this.map.set(i,o),o}delete(i){return this.map.delete(i)}set(i,o){if(!this.delete(i)&&o!==void 0){if(this.map.size>=this.max){const f=this.map.keys().next().value;this.delete(f)}this.map.set(i,o)}return this}}return Jp=s,Jp}var Zp,n$;function _n(){if(n$)return Zp;n$=1;const s=/\s+/g;class n{constructor(z,j){if(j=l(j),z instanceof n)return z.loose===!!j.loose&&z.includePrerelease===!!j.includePrerelease?z:new n(z.raw,j);if(z instanceof f)return this.raw=z.value,this.set=[[z]],this.formatted=void 0,this;if(this.options=j,this.loose=!!j.loose,this.includePrerelease=!!j.includePrerelease,this.raw=z.trim().replace(s," "),this.set=this.raw.split("||").map(J=>this.parseRange(J.trim())).filter(J=>J.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){const J=this.set[0];if(this.set=this.set.filter(M=>!y(M[0])),this.set.length===0)this.set=[J];else if(this.set.length>1){for(const M of this.set)if(M.length===1&&g(M[0])){this.set=[M];break}}}this.formatted=void 0}get range(){if(this.formatted===void 0){this.formatted="";for(let z=0;z<this.set.length;z++){z>0&&(this.formatted+="||");const j=this.set[z];for(let J=0;J<j.length;J++)J>0&&(this.formatted+=" "),this.formatted+=j[J].toString().trim()}}return this.formatted}format(){return this.range}toString(){return this.range}parseRange(z){const J=((this.options.includePrerelease&&$)|(this.options.loose&&S))+":"+z,M=o.get(J);if(M)return M;const U=this.options.loose,V=U?_[c.HYPHENRANGELOOSE]:_[c.HYPHENRANGE];z=z.replace(V,F(this.options.includePrerelease)),m("hyphen replace",z),z=z.replace(_[c.COMPARATORTRIM],h),m("comparator trim",z),z=z.replace(_[c.TILDETRIM],p),m("tilde trim",z),z=z.replace(_[c.CARETTRIM],T),m("caret trim",z);let K=z.split(" ").map(he=>v(he,this.options)).join(" ").split(/\s+/).map(he=>P(he,this.options));U&&(K=K.filter(he=>(m("loose invalid filter",he,this.options),!!he.match(_[c.COMPARATORLOOSE])))),m("range list",K);const H=new Map,ie=K.map(he=>new f(he,this.options));for(const he of ie){if(y(he))return[he];H.set(he.value,he)}H.size>1&&H.has("")&&H.delete("");const Ie=[...H.values()];return o.set(J,Ie),Ie}intersects(z,j){if(!(z instanceof n))throw new TypeError("a Range is required");return this.set.some(J=>E(J,j)&&z.set.some(M=>E(M,j)&&J.every(U=>M.every(V=>U.intersects(V,j)))))}test(z){if(!z)return false;if(typeof z=="string")try{z=new u(z,this.options)}catch{return false}for(let j=0;j<this.set.length;j++)if(X(this.set[j],z,this.options))return true;return false}}Zp=n;const i=yx(),o=new i,l=pm(),f=vh(),m=mh(),u=ei(),{safeRe:_,t:c,comparatorTrimReplace:h,tildeTrimReplace:p,caretTrimReplace:T}=dc(),{FLAG_INCLUDE_PRERELEASE:$,FLAG_LOOSE:S}=fh(),y=W=>W.value==="<0.0.0-0",g=W=>W.value==="",E=(W,z)=>{let j=true;const J=W.slice();let M=J.pop();for(;j&&J.length;)j=J.every(U=>M.intersects(U,z)),M=J.pop();return j},v=(W,z)=>(m("comp",W,z),W=w(W,z),m("caret",W),W=R(W,z),m("tildes",W),W=I(W,z),m("xrange",W),W=x(W,z),m("stars",W),W),b=W=>!W||W.toLowerCase()==="x"||W==="*",R=(W,z)=>W.trim().split(/\s+/).map(j=>O(j,z)).join(" "),O=(W,z)=>{const j=z.loose?_[c.TILDELOOSE]:_[c.TILDE];return W.replace(j,(J,M,U,V,K)=>{m("tilde",W,J,M,U,V,K);let H;return b(M)?H="":b(U)?H=`>=${M}.0.0 <${+M+1}.0.0-0`:b(V)?H=`>=${M}.${U}.0 <${M}.${+U+1}.0-0`:K?(m("replaceTilde pr",K),H=`>=${M}.${U}.${V}-${K} <${M}.${+U+1}.0-0`):H=`>=${M}.${U}.${V} <${M}.${+U+1}.0-0`,m("tilde return",H),H})},w=(W,z)=>W.trim().split(/\s+/).map(j=>L(j,z)).join(" "),L=(W,z)=>{m("caret",W,z);const j=z.loose?_[c.CARETLOOSE]:_[c.CARET],J=z.includePrerelease?"-0":"";return W.replace(j,(M,U,V,K,H)=>{m("caret",W,M,U,V,K,H);let ie;return b(U)?ie="":b(V)?ie=`>=${U}.0.0${J} <${+U+1}.0.0-0`:b(K)?U==="0"?ie=`>=${U}.${V}.0${J} <${U}.${+V+1}.0-0`:ie=`>=${U}.${V}.0${J} <${+U+1}.0.0-0`:H?(m("replaceCaret pr",H),U==="0"?V==="0"?ie=`>=${U}.${V}.${K}-${H} <${U}.${V}.${+K+1}-0`:ie=`>=${U}.${V}.${K}-${H} <${U}.${+V+1}.0-0`:ie=`>=${U}.${V}.${K}-${H} <${+U+1}.0.0-0`):(m("no pr"),U==="0"?V==="0"?ie=`>=${U}.${V}.${K}${J} <${U}.${V}.${+K+1}-0`:ie=`>=${U}.${V}.${K}${J} <${U}.${+V+1}.0-0`:ie=`>=${U}.${V}.${K} <${+U+1}.0.0-0`),m("caret return",ie),ie})},I=(W,z)=>(m("replaceXRanges",W,z),W.split(/\s+/).map(j=>k(j,z)).join(" ")),k=(W,z)=>{W=W.trim();const j=z.loose?_[c.XRANGELOOSE]:_[c.XRANGE];return W.replace(j,(J,M,U,V,K,H)=>{m("xRange",W,J,M,U,V,K,H);const ie=b(U),Ie=ie||b(V),he=Ie||b(K),st=he;return M==="="&&st&&(M=""),H=z.includePrerelease?"-0":"",ie?M===">"||M==="<"?J="<0.0.0-0":J="*":M&&st?(Ie&&(V=0),K=0,M===">"?(M=">=",Ie?(U=+U+1,V=0,K=0):(V=+V+1,K=0)):M==="<="&&(M="<",Ie?U=+U+1:V=+V+1),M==="<"&&(H="-0"),J=`${M+U}.${V}.${K}${H}`):Ie?J=`>=${U}.0.0${H} <${+U+1}.0.0-0`:he&&(J=`>=${U}.${V}.0${H} <${U}.${+V+1}.0-0`),m("xRange return",J),J})},x=(W,z)=>(m("replaceStars",W,z),W.trim().replace(_[c.STAR],"")),P=(W,z)=>(m("replaceGTE0",W,z),W.trim().replace(_[z.includePrerelease?c.GTE0PRE:c.GTE0],"")),F=W=>(z,j,J,M,U,V,K,H,ie,Ie,he,st)=>(b(J)?j="":b(M)?j=`>=${J}.0.0${W?"-0":""}`:b(U)?j=`>=${J}.${M}.0${W?"-0":""}`:V?j=`>=${j}`:j=`>=${j}${W?"-0":""}`,b(ie)?H="":b(Ie)?H=`<${+ie+1}.0.0-0`:b(he)?H=`<${ie}.${+Ie+1}.0-0`:st?H=`<=${ie}.${Ie}.${he}-${st}`:W?H=`<${ie}.${Ie}.${+he+1}-0`:H=`<=${H}`,`${j} ${H}`.trim()),X=(W,z,j)=>{for(let J=0;J<W.length;J++)if(!W[J].test(z))return false;if(z.prerelease.length&&!j.includePrerelease){for(let J=0;J<W.length;J++)if(m(W[J].semver),W[J].semver!==f.ANY&&W[J].semver.prerelease.length>0){const M=W[J].semver;if(M.major===z.major&&M.minor===z.minor&&M.patch===z.patch)return true}return false}return true};return Zp}var Qp,r$;function vh(){if(r$)return Qp;r$=1;const s=Symbol("SemVer ANY");class n{static get ANY(){return s}constructor(h,p){if(p=i(p),h instanceof n){if(h.loose===!!p.loose)return h;h=h.value}h=h.trim().split(/\s+/).join(" "),m("comparator",h,p),this.options=p,this.loose=!!p.loose,this.parse(h),this.semver===s?this.value="":this.value=this.operator+this.semver.version,m("comp",this)}parse(h){const p=this.options.loose?o[l.COMPARATORLOOSE]:o[l.COMPARATOR],T=h.match(p);if(!T)throw new TypeError(`Invalid comparator: ${h}`);this.operator=T[1]!==void 0?T[1]:"",this.operator==="="&&(this.operator=""),T[2]?this.semver=new u(T[2],this.options.loose):this.semver=s}toString(){return this.value}test(h){if(m("Comparator.test",h,this.options.loose),this.semver===s||h===s)return true;if(typeof h=="string")try{h=new u(h,this.options)}catch{return false}return f(h,this.operator,this.semver,this.options)}intersects(h,p){if(!(h instanceof n))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""?true:new _(h.value,p).test(this.value):h.operator===""?h.value===""?true:new _(this.value,p).test(h.semver):(p=i(p),p.includePrerelease&&(this.value==="<0.0.0-0"||h.value==="<0.0.0-0")||!p.includePrerelease&&(this.value.startsWith("<0.0.0")||h.value.startsWith("<0.0.0"))?false:!!(this.operator.startsWith(">")&&h.operator.startsWith(">")||this.operator.startsWith("<")&&h.operator.startsWith("<")||this.semver.version===h.semver.version&&this.operator.includes("=")&&h.operator.includes("=")||f(this.semver,"<",h.semver,p)&&this.operator.startsWith(">")&&h.operator.startsWith("<")||f(this.semver,">",h.semver,p)&&this.operator.startsWith("<")&&h.operator.startsWith(">")))}}Qp=n;const i=pm(),{safeRe:o,t:l}=dc(),f=rI(),m=mh(),u=ei(),_=_n();return Qp}var eg,o$;function bh(){if(o$)return eg;o$=1;const s=_n();return eg=(i,o,l)=>{try{o=new s(o,l)}catch{return false}return o.test(i)},eg}var tg,a$;function Rx(){if(a$)return tg;a$=1;const s=_n();return tg=(i,o)=>new s(i,o).set.map(l=>l.map(f=>f.value).join(" ").trim().split(" ")),tg}var sg,l$;function Ix(){if(l$)return sg;l$=1;const s=ei(),n=_n();return sg=(o,l,f)=>{let m=null,u=null,_=null;try{_=new n(l,f)}catch{return null}return o.forEach(c=>{_.test(c)&&(!m||u.compare(c)===-1)&&(m=c,u=new s(m,f))}),m},sg}var ig,c$;function Cx(){if(c$)return ig;c$=1;const s=ei(),n=_n();return ig=(o,l,f)=>{let m=null,u=null,_=null;try{_=new n(l,f)}catch{return null}return o.forEach(c=>{_.test(c)&&(!m||u.compare(c)===1)&&(m=c,u=new s(m,f))}),m},ig}var ng,u$;function Ox(){if(u$)return ng;u$=1;const s=ei(),n=_n(),i=Eh();return ng=(l,f)=>{l=new n(l,f);let m=new s("0.0.0");if(l.test(m)||(m=new s("0.0.0-0"),l.test(m)))return m;m=null;for(let u=0;u<l.set.length;++u){const _=l.set[u];let c=null;_.forEach(h=>{const p=new s(h.semver.version);switch(h.operator){case">":p.prerelease.length===0?p.patch++:p.prerelease.push(0),p.raw=p.format();case"":case">=":(!c||i(p,c))&&(c=p);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${h.operator}`)}}),c&&(!m||i(m,c))&&(m=c)}return m&&l.test(m)?m:null},ng}var rg,h$;function wx(){if(h$)return rg;h$=1;const s=_n();return rg=(i,o)=>{try{return new s(i,o).range||"*"}catch{return null}},rg}var og,d$;function vm(){if(d$)return og;d$=1;const s=ei(),n=vh(),{ANY:i}=n,o=_n(),l=bh(),f=Eh(),m=fm(),u=Em(),_=mm();return og=(h,p,T,$)=>{h=new s(h,$),p=new o(p,$);let S,y,g,E,v;switch(T){case">":S=f,y=u,g=m,E=">",v=">=";break;case"<":S=m,y=_,g=f,E="<",v="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(l(h,p,$))return false;for(let b=0;b<p.set.length;++b){const R=p.set[b];let O=null,w=null;if(R.forEach(L=>{L.semver===i&&(L=new n(">=0.0.0")),O=O||L,w=w||L,S(L.semver,O.semver,$)?O=L:g(L.semver,w.semver,$)&&(w=L)}),O.operator===E||O.operator===v||(!w.operator||w.operator===E)&&y(h,w.semver))return false;if(w.operator===v&&g(h,w.semver))return false}return true},og}var ag,_$;function kx(){if(_$)return ag;_$=1;const s=vm();return ag=(i,o,l)=>s(i,o,">",l),ag}var lg,p$;function Ax(){if(p$)return lg;p$=1;const s=vm();return lg=(i,o,l)=>s(i,o,"<",l),lg}var cg,g$;function Lx(){if(g$)return cg;g$=1;const s=_n();return cg=(i,o,l)=>(i=new s(i,l),o=new s(o,l),i.intersects(o,l)),cg}var ug,f$;function Nx(){if(f$)return ug;f$=1;const s=bh(),n=dn();return ug=(i,o,l)=>{const f=[];let m=null,u=null;const _=i.sort((T,$)=>n(T,$,l));for(const T of _)s(T,o,l)?(u=T,m||(m=T)):(u&&f.push([m,u]),u=null,m=null);m&&f.push([m,null]);const c=[];for(const[T,$]of f)T===$?c.push(T):!$&&T===_[0]?c.push("*"):$?T===_[0]?c.push(`<=${$}`):c.push(`${T} - ${$}`):c.push(`>=${T}`);const h=c.join(" || "),p=typeof o.raw=="string"?o.raw:String(o);return h.length<p.length?h:o},ug}var hg,m$;function Mx(){if(m$)return hg;m$=1;const s=_n(),n=vh(),{ANY:i}=n,o=bh(),l=dn(),f=(p,T,$={})=>{if(p===T)return true;p=new s(p,$),T=new s(T,$);let S=false;e:for(const y of p.set){for(const g of T.set){const E=_(y,g,$);if(S=S||E!==null,E)continue e}if(S)return false}return true},m=[new n(">=0.0.0-0")],u=[new n(">=0.0.0")],_=(p,T,$)=>{if(p===T)return true;if(p.length===1&&p[0].semver===i){if(T.length===1&&T[0].semver===i)return true;$.includePrerelease?p=m:p=u}if(T.length===1&&T[0].semver===i){if($.includePrerelease)return true;T=u}const S=new Set;let y,g;for(const I of p)I.operator===">"||I.operator===">="?y=c(y,I,$):I.operator==="<"||I.operator==="<="?g=h(g,I,$):S.add(I.semver);if(S.size>1)return null;let E;if(y&&g){if(E=l(y.semver,g.semver,$),E>0)return null;if(E===0&&(y.operator!==">="||g.operator!=="<="))return null}for(const I of S){if(y&&!o(I,String(y),$)||g&&!o(I,String(g),$))return null;for(const k of T)if(!o(I,String(k),$))return false;return true}let v,b,R,O,w=g&&!$.includePrerelease&&g.semver.prerelease.length?g.semver:false,L=y&&!$.includePrerelease&&y.semver.prerelease.length?y.semver:false;w&&w.prerelease.length===1&&g.operator==="<"&&w.prerelease[0]===0&&(w=false);for(const I of T){if(O=O||I.operator===">"||I.operator===">=",R=R||I.operator==="<"||I.operator==="<=",y){if(L&&I.semver.prerelease&&I.semver.prerelease.length&&I.semver.major===L.major&&I.semver.minor===L.minor&&I.semver.patch===L.patch&&(L=false),I.operator===">"||I.operator===">="){if(v=c(y,I,$),v===I&&v!==y)return false}else if(y.operator===">="&&!o(y.semver,String(I),$))return false}if(g){if(w&&I.semver.prerelease&&I.semver.prerelease.length&&I.semver.major===w.major&&I.semver.minor===w.minor&&I.semver.patch===w.patch&&(w=false),I.operator==="<"||I.operator==="<="){if(b=h(g,I,$),b===I&&b!==g)return false}else if(g.operator==="<="&&!o(g.semver,String(I),$))return false}if(!I.operator&&(g||y)&&E!==0)return false}return!(y&&R&&!g&&E!==0||g&&O&&!y&&E!==0||L||w)},c=(p,T,$)=>{if(!p)return T;const S=l(p.semver,T.semver,$);return S>0?p:S<0||T.operator===">"&&p.operator===">="?T:p},h=(p,T,$)=>{if(!p)return T;const S=l(p.semver,T.semver,$);return S<0?p:S>0||T.operator==="<"&&p.operator==="<="?T:p};return hg=f,hg}var dg,E$;function Dx(){if(E$)return dg;E$=1;const s=dc(),n=fh(),i=ei(),o=sI(),l=wa(),f=hx(),m=dx(),u=_x(),_=px(),c=gx(),h=fx(),p=mx(),T=Ex(),$=dn(),S=vx(),y=bx(),g=gm(),E=Tx(),v=Sx(),b=Eh(),R=fm(),O=iI(),w=nI(),L=mm(),I=Em(),k=rI(),x=$x(),P=vh(),F=_n(),X=bh(),W=Rx(),z=Ix(),j=Cx(),J=Ox(),M=wx(),U=vm(),V=kx(),K=Ax(),H=Lx(),ie=Nx(),Ie=Mx();return dg={parse:l,valid:f,clean:m,inc:u,diff:_,major:c,minor:h,patch:p,prerelease:T,compare:$,rcompare:S,compareLoose:y,compareBuild:g,sort:E,rsort:v,gt:b,lt:R,eq:O,neq:w,gte:L,lte:I,cmp:k,coerce:x,Comparator:P,Range:F,satisfies:X,toComparators:W,maxSatisfying:z,minSatisfying:j,minVersion:J,validRange:M,outside:U,gtr:V,ltr:K,intersects:H,simplifyRange:ie,subset:Ie,SemVer:i,re:s.re,src:s.src,tokens:s.t,SEMVER_SPEC_VERSION:n.SEMVER_SPEC_VERSION,RELEASE_TYPES:n.RELEASE_TYPES,compareIdentifiers:o.compareIdentifiers,rcompareIdentifiers:o.rcompareIdentifiers},dg}var _g=Dx();const xx=async()=>(await _i("create-blockly-block")).toString(),oI=async(s,n)=>{s!=null&&await _i("save-blockly-block",s,{body:n.save()})};async function Bx(s,n,i,o,l){if(s==null)return;l.info("正在开始编译.......");let f;try{f=ux(n,i,o.getWorkspaceSvg())}catch(m){l.error("编译时发生错误: "+m.toString()),console.error(m);return}return l.info("正在上传......"),await _i("save-blockly-block",s,{code:f}),l.success("上传成功"),f}async function Px(s){s!=null&&await _i("set-blockly-block-state",s,true)}async function Ux(s){s!=null&&await _i("set-blockly-block-state",s,false)}async function Fx(s,n){s!=null&&await _i("rename-blockly-block",s,n)}async function Gx(s){s!=null&&await _i("delete-blockly-block",s)}async function Hx(s,n,i,o){if(s!=null)return C1(n,i,o.save())}async function Vx(s,n){if(s.length==0)return;const i=O1(s);if(console.info(i),!i)return;if(i.version!=JR){Ll.alert(`无法读取该插件: 该插件的API Major版本(${i.version})不兼容当前版本`);return}if(i.plugin_version&&_g.cmp(i.plugin_version,">",wf)&&await Ll.confirm(`该插件是由更高版本(${i.plugin_version})的Blockly插件导出的，可能无法正常导入或执行异常。建议升级您的Blockly版本到最新版本`,"提示",{confirmButtonText:"继续",cancelButtonText:"取消",type:"warning"})=="cancel"||i.plugin_version&&_g.major(i.plugin_version)!=_g.major(wf)&&await Ll.confirm(`该插件是由不同主版本(${i.plugin_version})的Blockly插件导出的，可能无法正常导入或执行异常。`,"提示",{confirmButtonText:"继续",cancelButtonText:"取消",type:"warning"})=="cancel")return;if(!n&&(i!=null&&i.uuid)){const l=await _i("get-all-blockly-blocks");if(l&&l.filter(f=>f.uuid==i.uuid).length>0&&await Ll.confirm("检测到该插件已存在，是否覆盖？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"})=="cancel")return}const o=await _i("create-blockly-block",n?void 0:i.uuid);return await _i("save-blockly-block",o,{body:i.body,name:i.name}),o.toString()}const Wx={class:"create",style:{display:"flex","flex-direction":"row-reverse","padding-right":"10px","padding-top":"10px",height:"48px"}},zx={class:"list",style:{height:"60%"}},jx={style:{height:"40%",padding:"10px"}},Xx={key:0},Kx=Ke({__name:"index",props:["blocks","workspace","dialog","current","panel","logger"],emits:["update:dialog","update:current"],setup(s,{emit:n}){const i=s,o=n,{panel:l,blocks:f}=i,m=me([]),u=me(0),_=_e({get:()=>i.current,set:E=>o("update:current",E)}),c=_e({get:()=>i.dialog,set:E=>o("update:dialog",E)}),h=async()=>{try{return await _i("get-all-blockly-blocks")}catch(E){return console.error("获取插件数据失败:",E),null}},p=async()=>{const E=await h();E&&Array.isArray(E)&&(m.value=E,u.value++,await rs())},T=async()=>{if(await oI(_.value,i.workspace),_.value==null)return;const v=(m.value.length>0?m.value:Ir.blockly).find(R=>R.id==_.value);if(!v){console.error("找不到插件数据，ID:",_.value);return}const b=await Bx(_.value,v.name,v.uuid,i.workspace,i.logger.logger);b&&(l.code=b)};async function $(){const E=prompt("输入重命名的插件名词","未命名Koishi插件");E!=null&&(await Fx(_.value,E),await p())}async function S(){_.value!=null&&await Ll.confirm("确定删除当前插件?")==="confirm"&&(await Gx(_.value),_.value=void 0,await p())}async function y(){if(_.value==null)return;const v=(m.value.length>0?m.value:Ir.blockly).find(R=>R.id==_.value);if(!v){console.error("找不到插件数据，ID:",_.value);return}const b=await Hx(_.value,v.name,v.uuid,i.workspace);b&&(c.value.export=b)}async function g(){const E=await xx();await p(),setTimeout(()=>{o("update:current",E)},100)}return Rs(async()=>{await p()}),(E,v)=>{const b=gt("el-popover"),R=gt("el-scrollbar"),O=gt("k-button");return ne(),ve(Pt,null,[de("div",Wx,[De(b,{placement:"bottom",trigger:"hover",content:"新建插件"},{reference:je(()=>[de("i",{onClick:g,style:{cursor:"pointer","padding-right":"20px"}},[De(XN)])]),_:1}),De(b,{placement:"bottom",trigger:"hover",content:"导入代码"},{reference:je(()=>[de("i",{onClick:v[0]||(v[0]=w=>c.value.import=true),style:{cursor:"pointer","padding-right":"20px"}},[De(VN)])]),_:1}),v[8]||(v[8]=de("div",{style:{"flex-grow":"1"}},null,-1)),v[9]||(v[9]=de("div",{style:{"font-size":"18px","font-weight":"bold","margin-left":"19px"}}," 插件列表 ",-1))]),de("div",zx,[De(R,null,{default:je(()=>[(ne(),Ye(Cw,{key:u.value,data:Object.fromEntries((m.value.length>0?m.value:ue(Ir).blockly).map(w=>[w.id,w])),modelValue:_.value,"onUpdate:modelValue":v[1]||(v[1]=w=>_.value=w)},null,8,["data","modelValue"]))]),_:1})]),de("div",jx,[_.value?(ne(),ve("div",Xx,[v[16]||(v[16]=de("h3",null,"操作",-1)),De(O,{onClick:v[2]||(v[2]=w=>T())},{default:je(()=>v[10]||(v[10]=[xt("编译插件")])),_:1,__:[10]}),v[17]||(v[17]=de("br",null,null,-1)),De(O,{onClick:v[3]||(v[3]=async()=>{await ue(Px)(_.value),await p()})},{default:je(()=>v[11]||(v[11]=[xt("启用插件")])),_:1,__:[11]}),De(O,{onClick:v[4]||(v[4]=async()=>{await ue(Ux)(_.value),await p()})},{default:je(()=>v[12]||(v[12]=[xt("禁用插件")])),_:1,__:[12]}),v[18]||(v[18]=de("br",null,null,-1)),De(O,{onClick:v[5]||(v[5]=w=>$())},{default:je(()=>v[13]||(v[13]=[xt("重命名插件")])),_:1,__:[13]}),De(O,{onClick:v[6]||(v[6]=w=>S())},{default:je(()=>v[14]||(v[14]=[xt("删除插件")])),_:1,__:[14]}),v[19]||(v[19]=de("br",null,null,-1)),De(O,{onClick:v[7]||(v[7]=w=>y())},{default:je(()=>v[15]||(v[15]=[xt("导出插件")])),_:1,__:[15]})])):Ze("v-if",true)])],64)}}});var pg={exports:{}},gg={exports:{}},fg={exports:{}},v$;function Yx(){return v$||(v$=1,function(s,n){(function(i,o){s.exports=o()})(Ni,function(){var i=i||{Msg:Object.create(null)};return i.Msg.ADD_COMMENT="Add Comment",i.Msg.CANNOT_DELETE_VARIABLE_PROCEDURE="Can't delete the variable '%1' because it's part of the definition of the function '%2'",i.Msg.CHANGE_VALUE_TITLE="Change value:",i.Msg.CLEAN_UP="Clean up Blocks",i.Msg.COLLAPSED_WARNINGS_WARNING="Collapsed blocks contain warnings.",i.Msg.COLLAPSE_ALL="Collapse Blocks",i.Msg.COLLAPSE_BLOCK="Collapse Block",i.Msg.COLOUR_BLEND_COLOUR1="colour 1",i.Msg.COLOUR_BLEND_COLOUR2="colour 2",i.Msg.COLOUR_BLEND_HELPURL="https://meyerweb.com/eric/tools/color-blend/#:::rgbp",i.Msg.COLOUR_BLEND_RATIO="ratio",i.Msg.COLOUR_BLEND_TITLE="blend",i.Msg.COLOUR_BLEND_TOOLTIP="Blends two colours together with a given ratio (0.0 - 1.0).",i.Msg.COLOUR_PICKER_HELPURL="https://en.wikipedia.org/wiki/Color",i.Msg.COLOUR_PICKER_TOOLTIP="Choose a colour from the palette.",i.Msg.COLOUR_RANDOM_HELPURL="http://randomcolour.com",i.Msg.COLOUR_RANDOM_TITLE="random colour",i.Msg.COLOUR_RANDOM_TOOLTIP="Choose a colour at random.",i.Msg.COLOUR_RGB_BLUE="blue",i.Msg.COLOUR_RGB_GREEN="green",i.Msg.COLOUR_RGB_HELPURL="https://www.december.com/html/spec/colorpercompact.html",i.Msg.COLOUR_RGB_RED="red",i.Msg.COLOUR_RGB_TITLE="colour with",i.Msg.COLOUR_RGB_TOOLTIP="Create a colour with the specified amount of red, green, and blue. All values must be between 0 and 100.",i.Msg.CONTROLS_FLOW_STATEMENTS_HELPURL="https://github.com/google/blockly/wiki/Loops#loop-termination-blocks",i.Msg.CONTROLS_FLOW_STATEMENTS_OPERATOR_BREAK="break out of loop",i.Msg.CONTROLS_FLOW_STATEMENTS_OPERATOR_CONTINUE="continue with next iteration of loop",i.Msg.CONTROLS_FLOW_STATEMENTS_TOOLTIP_BREAK="Break out of the containing loop.",i.Msg.CONTROLS_FLOW_STATEMENTS_TOOLTIP_CONTINUE="Skip the rest of this loop, and continue with the next iteration.",i.Msg.CONTROLS_FLOW_STATEMENTS_WARNING="Warning: This block may only be used within a loop.",i.Msg.CONTROLS_FOREACH_HELPURL="https://github.com/google/blockly/wiki/Loops#for-each",i.Msg.CONTROLS_FOREACH_TITLE="for each item %1 in list %2",i.Msg.CONTROLS_FOREACH_TOOLTIP="For each item in a list, set the variable '%1' to the item, and then do some statements.",i.Msg.CONTROLS_FOR_HELPURL="https://github.com/google/blockly/wiki/Loops#count-with",i.Msg.CONTROLS_FOR_TITLE="count with %1 from %2 to %3 by %4",i.Msg.CONTROLS_FOR_TOOLTIP="Have the variable '%1' take on the values from the start number to the end number, counting by the specified interval, and do the specified blocks.",i.Msg.CONTROLS_IF_ELSEIF_TOOLTIP="Add a condition to the if block.",i.Msg.CONTROLS_IF_ELSE_TOOLTIP="Add a final, catch-all condition to the if block.",i.Msg.CONTROLS_IF_HELPURL="https://github.com/google/blockly/wiki/IfElse",i.Msg.CONTROLS_IF_IF_TOOLTIP="Add, remove, or reorder sections to reconfigure this if block.",i.Msg.CONTROLS_IF_MSG_ELSE="else",i.Msg.CONTROLS_IF_MSG_ELSEIF="else if",i.Msg.CONTROLS_IF_MSG_IF="if",i.Msg.CONTROLS_IF_TOOLTIP_1="If a value is true, then do some statements.",i.Msg.CONTROLS_IF_TOOLTIP_2="If a value is true, then do the first block of statements. Otherwise, do the second block of statements.",i.Msg.CONTROLS_IF_TOOLTIP_3="If the first value is true, then do the first block of statements. Otherwise, if the second value is true, do the second block of statements.",i.Msg.CONTROLS_IF_TOOLTIP_4="If the first value is true, then do the first block of statements. Otherwise, if the second value is true, do the second block of statements. If none of the values are true, do the last block of statements.",i.Msg.CONTROLS_REPEAT_HELPURL="https://en.wikipedia.org/wiki/For_loop",i.Msg.CONTROLS_REPEAT_INPUT_DO="do",i.Msg.CONTROLS_REPEAT_TITLE="repeat %1 times",i.Msg.CONTROLS_REPEAT_TOOLTIP="Do some statements several times.",i.Msg.CONTROLS_WHILEUNTIL_HELPURL="https://github.com/google/blockly/wiki/Loops#repeat",i.Msg.CONTROLS_WHILEUNTIL_OPERATOR_UNTIL="repeat until",i.Msg.CONTROLS_WHILEUNTIL_OPERATOR_WHILE="repeat while",i.Msg.CONTROLS_WHILEUNTIL_TOOLTIP_UNTIL="While a value is false, then do some statements.",i.Msg.CONTROLS_WHILEUNTIL_TOOLTIP_WHILE="While a value is true, then do some statements.",i.Msg.DELETE_ALL_BLOCKS="Delete all %1 blocks?",i.Msg.DELETE_BLOCK="Delete Block",i.Msg.DELETE_VARIABLE="Delete the '%1' variable",i.Msg.DELETE_VARIABLE_CONFIRMATION="Delete %1 uses of the '%2' variable?",i.Msg.DELETE_X_BLOCKS="Delete %1 Blocks",i.Msg.DIALOG_CANCEL="Cancel",i.Msg.DIALOG_OK="OK",i.Msg.DISABLE_BLOCK="Disable Block",i.Msg.DUPLICATE_BLOCK="Duplicate",i.Msg.DUPLICATE_COMMENT="Duplicate Comment",i.Msg.ENABLE_BLOCK="Enable Block",i.Msg.EXPAND_ALL="Expand Blocks",i.Msg.EXPAND_BLOCK="Expand Block",i.Msg.EXTERNAL_INPUTS="External Inputs",i.Msg.HELP="Help",i.Msg.INLINE_INPUTS="Inline Inputs",i.Msg.LISTS_CREATE_EMPTY_HELPURL="https://github.com/google/blockly/wiki/Lists#create-empty-list",i.Msg.LISTS_CREATE_EMPTY_TITLE="create empty list",i.Msg.LISTS_CREATE_EMPTY_TOOLTIP="Returns a list, of length 0, containing no data records",i.Msg.LISTS_CREATE_WITH_CONTAINER_TITLE_ADD="list",i.Msg.LISTS_CREATE_WITH_CONTAINER_TOOLTIP="Add, remove, or reorder sections to reconfigure this list block.",i.Msg.LISTS_CREATE_WITH_HELPURL="https://github.com/google/blockly/wiki/Lists#create-list-with",i.Msg.LISTS_CREATE_WITH_INPUT_WITH="create list with",i.Msg.LISTS_CREATE_WITH_ITEM_TOOLTIP="Add an item to the list.",i.Msg.LISTS_CREATE_WITH_TOOLTIP="Create a list with any number of items.",i.Msg.LISTS_GET_INDEX_FIRST="first",i.Msg.LISTS_GET_INDEX_FROM_END="# from end",i.Msg.LISTS_GET_INDEX_FROM_START="#",i.Msg.LISTS_GET_INDEX_GET="get",i.Msg.LISTS_GET_INDEX_GET_REMOVE="get and remove",i.Msg.LISTS_GET_INDEX_LAST="last",i.Msg.LISTS_GET_INDEX_RANDOM="random",i.Msg.LISTS_GET_INDEX_REMOVE="remove",i.Msg.LISTS_GET_INDEX_TAIL="",i.Msg.LISTS_GET_INDEX_TOOLTIP_GET_FIRST="Returns the first item in a list.",i.Msg.LISTS_GET_INDEX_TOOLTIP_GET_FROM="Returns the item at the specified position in a list.",i.Msg.LISTS_GET_INDEX_TOOLTIP_GET_LAST="Returns the last item in a list.",i.Msg.LISTS_GET_INDEX_TOOLTIP_GET_RANDOM="Returns a random item in a list.",i.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FIRST="Removes and returns the first item in a list.",i.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FROM="Removes and returns the item at the specified position in a list.",i.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_LAST="Removes and returns the last item in a list.",i.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_RANDOM="Removes and returns a random item in a list.",i.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FIRST="Removes the first item in a list.",i.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FROM="Removes the item at the specified position in a list.",i.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_LAST="Removes the last item in a list.",i.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_RANDOM="Removes a random item in a list.",i.Msg.LISTS_GET_SUBLIST_END_FROM_END="to # from end",i.Msg.LISTS_GET_SUBLIST_END_FROM_START="to #",i.Msg.LISTS_GET_SUBLIST_END_LAST="to last",i.Msg.LISTS_GET_SUBLIST_HELPURL="https://github.com/google/blockly/wiki/Lists#getting-a-sublist",i.Msg.LISTS_GET_SUBLIST_START_FIRST="get sub-list from first",i.Msg.LISTS_GET_SUBLIST_START_FROM_END="get sub-list from # from end",i.Msg.LISTS_GET_SUBLIST_START_FROM_START="get sub-list from #",i.Msg.LISTS_GET_SUBLIST_TAIL="",i.Msg.LISTS_GET_SUBLIST_TOOLTIP="Creates a copy of the specified portion of a list.",i.Msg.LISTS_INDEX_FROM_END_TOOLTIP="%1 is the last item.",i.Msg.LISTS_INDEX_FROM_START_TOOLTIP="%1 is the first item.",i.Msg.LISTS_INDEX_OF_FIRST="find first occurrence of item",i.Msg.LISTS_INDEX_OF_HELPURL="https://github.com/google/blockly/wiki/Lists#getting-items-from-a-list",i.Msg.LISTS_INDEX_OF_LAST="find last occurrence of item",i.Msg.LISTS_INDEX_OF_TOOLTIP="Returns the index of the first/last occurrence of the item in the list. Returns %1 if item is not found.",i.Msg.LISTS_INLIST="in list",i.Msg.LISTS_ISEMPTY_HELPURL="https://github.com/google/blockly/wiki/Lists#is-empty",i.Msg.LISTS_ISEMPTY_TITLE="%1 is empty",i.Msg.LISTS_ISEMPTY_TOOLTIP="Returns true if the list is empty.",i.Msg.LISTS_LENGTH_HELPURL="https://github.com/google/blockly/wiki/Lists#length-of",i.Msg.LISTS_LENGTH_TITLE="length of %1",i.Msg.LISTS_LENGTH_TOOLTIP="Returns the length of a list.",i.Msg.LISTS_REPEAT_HELPURL="https://github.com/google/blockly/wiki/Lists#create-list-with",i.Msg.LISTS_REPEAT_TITLE="create list with item %1 repeated %2 times",i.Msg.LISTS_REPEAT_TOOLTIP="Creates a list consisting of the given value repeated the specified number of times.",i.Msg.LISTS_REVERSE_HELPURL="https://github.com/google/blockly/wiki/Lists#reversing-a-list",i.Msg.LISTS_REVERSE_MESSAGE0="reverse %1",i.Msg.LISTS_REVERSE_TOOLTIP="Reverse a copy of a list.",i.Msg.LISTS_SET_INDEX_HELPURL="https://github.com/google/blockly/wiki/Lists#in-list--set",i.Msg.LISTS_SET_INDEX_INPUT_TO="as",i.Msg.LISTS_SET_INDEX_INSERT="insert at",i.Msg.LISTS_SET_INDEX_SET="set",i.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FIRST="Inserts the item at the start of a list.",i.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FROM="Inserts the item at the specified position in a list.",i.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_LAST="Append the item to the end of a list.",i.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_RANDOM="Inserts the item randomly in a list.",i.Msg.LISTS_SET_INDEX_TOOLTIP_SET_FIRST="Sets the first item in a list.",i.Msg.LISTS_SET_INDEX_TOOLTIP_SET_FROM="Sets the item at the specified position in a list.",i.Msg.LISTS_SET_INDEX_TOOLTIP_SET_LAST="Sets the last item in a list.",i.Msg.LISTS_SET_INDEX_TOOLTIP_SET_RANDOM="Sets a random item in a list.",i.Msg.LISTS_SORT_HELPURL="https://github.com/google/blockly/wiki/Lists#sorting-a-list",i.Msg.LISTS_SORT_ORDER_ASCENDING="ascending",i.Msg.LISTS_SORT_ORDER_DESCENDING="descending",i.Msg.LISTS_SORT_TITLE="sort %1 %2 %3",i.Msg.LISTS_SORT_TOOLTIP="Sort a copy of a list.",i.Msg.LISTS_SORT_TYPE_IGNORECASE="alphabetic, ignore case",i.Msg.LISTS_SORT_TYPE_NUMERIC="numeric",i.Msg.LISTS_SORT_TYPE_TEXT="alphabetic",i.Msg.LISTS_SPLIT_HELPURL="https://github.com/google/blockly/wiki/Lists#splitting-strings-and-joining-lists",i.Msg.LISTS_SPLIT_LIST_FROM_TEXT="make list from text",i.Msg.LISTS_SPLIT_TEXT_FROM_LIST="make text from list",i.Msg.LISTS_SPLIT_TOOLTIP_JOIN="Join a list of texts into one text, separated by a delimiter.",i.Msg.LISTS_SPLIT_TOOLTIP_SPLIT="Split text into a list of texts, breaking at each delimiter.",i.Msg.LISTS_SPLIT_WITH_DELIMITER="with delimiter",i.Msg.LOGIC_BOOLEAN_FALSE="false",i.Msg.LOGIC_BOOLEAN_HELPURL="https://github.com/google/blockly/wiki/Logic#values",i.Msg.LOGIC_BOOLEAN_TOOLTIP="Returns either true or false.",i.Msg.LOGIC_BOOLEAN_TRUE="true",i.Msg.LOGIC_COMPARE_HELPURL="https://en.wikipedia.org/wiki/Inequality_(mathematics)",i.Msg.LOGIC_COMPARE_TOOLTIP_EQ="Return true if both inputs equal each other.",i.Msg.LOGIC_COMPARE_TOOLTIP_GT="Return true if the first input is greater than the second input.",i.Msg.LOGIC_COMPARE_TOOLTIP_GTE="Return true if the first input is greater than or equal to the second input.",i.Msg.LOGIC_COMPARE_TOOLTIP_LT="Return true if the first input is smaller than the second input.",i.Msg.LOGIC_COMPARE_TOOLTIP_LTE="Return true if the first input is smaller than or equal to the second input.",i.Msg.LOGIC_COMPARE_TOOLTIP_NEQ="Return true if both inputs are not equal to each other.",i.Msg.LOGIC_NEGATE_HELPURL="https://github.com/google/blockly/wiki/Logic#not",i.Msg.LOGIC_NEGATE_TITLE="not %1",i.Msg.LOGIC_NEGATE_TOOLTIP="Returns true if the input is false. Returns false if the input is true.",i.Msg.LOGIC_NULL="null",i.Msg.LOGIC_NULL_HELPURL="https://en.wikipedia.org/wiki/Nullable_type",i.Msg.LOGIC_NULL_TOOLTIP="Returns null.",i.Msg.LOGIC_OPERATION_AND="and",i.Msg.LOGIC_OPERATION_HELPURL="https://github.com/google/blockly/wiki/Logic#logical-operations",i.Msg.LOGIC_OPERATION_OR="or",i.Msg.LOGIC_OPERATION_TOOLTIP_AND="Return true if both inputs are true.",i.Msg.LOGIC_OPERATION_TOOLTIP_OR="Return true if at least one of the inputs is true.",i.Msg.LOGIC_TERNARY_CONDITION="test",i.Msg.LOGIC_TERNARY_HELPURL="https://en.wikipedia.org/wiki/%3F:",i.Msg.LOGIC_TERNARY_IF_FALSE="if false",i.Msg.LOGIC_TERNARY_IF_TRUE="if true",i.Msg.LOGIC_TERNARY_TOOLTIP="Check the condition in 'test'. If the condition is true, returns the 'if true' value; otherwise returns the 'if false' value.",i.Msg.MATH_ADDITION_SYMBOL="+",i.Msg.MATH_ARITHMETIC_HELPURL="https://en.wikipedia.org/wiki/Arithmetic",i.Msg.MATH_ARITHMETIC_TOOLTIP_ADD="Return the sum of the two numbers.",i.Msg.MATH_ARITHMETIC_TOOLTIP_DIVIDE="Return the quotient of the two numbers.",i.Msg.MATH_ARITHMETIC_TOOLTIP_MINUS="Return the difference of the two numbers.",i.Msg.MATH_ARITHMETIC_TOOLTIP_MULTIPLY="Return the product of the two numbers.",i.Msg.MATH_ARITHMETIC_TOOLTIP_POWER="Return the first number raised to the power of the second number.",i.Msg.MATH_ATAN2_HELPURL="https://en.wikipedia.org/wiki/Atan2",i.Msg.MATH_ATAN2_TITLE="atan2 of X:%1 Y:%2",i.Msg.MATH_ATAN2_TOOLTIP="Return the arctangent of point (X, Y) in degrees from -180 to 180.",i.Msg.MATH_CHANGE_HELPURL="https://en.wikipedia.org/wiki/Programming_idiom#Incrementing_a_counter",i.Msg.MATH_CHANGE_TITLE="change %1 by %2",i.Msg.MATH_CHANGE_TOOLTIP="Add a number to variable '%1'.",i.Msg.MATH_CONSTANT_HELPURL="https://en.wikipedia.org/wiki/Mathematical_constant",i.Msg.MATH_CONSTANT_TOOLTIP="Return one of the common constants: π (3.141…), e (2.718…), φ (1.618…), sqrt(2) (1.414…), sqrt(½) (0.707…), or ∞ (infinity).",i.Msg.MATH_CONSTRAIN_HELPURL="https://en.wikipedia.org/wiki/Clamping_(graphics)",i.Msg.MATH_CONSTRAIN_TITLE="constrain %1 low %2 high %3",i.Msg.MATH_CONSTRAIN_TOOLTIP="Constrain a number to be between the specified limits (inclusive).",i.Msg.MATH_DIVISION_SYMBOL="÷",i.Msg.MATH_IS_DIVISIBLE_BY="is divisible by",i.Msg.MATH_IS_EVEN="is even",i.Msg.MATH_IS_NEGATIVE="is negative",i.Msg.MATH_IS_ODD="is odd",i.Msg.MATH_IS_POSITIVE="is positive",i.Msg.MATH_IS_PRIME="is prime",i.Msg.MATH_IS_TOOLTIP="Check if a number is an even, odd, prime, whole, positive, negative, or if it is divisible by certain number. Returns true or false.",i.Msg.MATH_IS_WHOLE="is whole",i.Msg.MATH_MODULO_HELPURL="https://en.wikipedia.org/wiki/Modulo_operation",i.Msg.MATH_MODULO_TITLE="remainder of %1 ÷ %2",i.Msg.MATH_MODULO_TOOLTIP="Return the remainder from dividing the two numbers.",i.Msg.MATH_MULTIPLICATION_SYMBOL="×",i.Msg.MATH_NUMBER_HELPURL="https://en.wikipedia.org/wiki/Number",i.Msg.MATH_NUMBER_TOOLTIP="A number.",i.Msg.MATH_ONLIST_HELPURL="",i.Msg.MATH_ONLIST_OPERATOR_AVERAGE="average of list",i.Msg.MATH_ONLIST_OPERATOR_MAX="max of list",i.Msg.MATH_ONLIST_OPERATOR_MEDIAN="median of list",i.Msg.MATH_ONLIST_OPERATOR_MIN="min of list",i.Msg.MATH_ONLIST_OPERATOR_MODE="modes of list",i.Msg.MATH_ONLIST_OPERATOR_RANDOM="random item of list",i.Msg.MATH_ONLIST_OPERATOR_STD_DEV="standard deviation of list",i.Msg.MATH_ONLIST_OPERATOR_SUM="sum of list",i.Msg.MATH_ONLIST_TOOLTIP_AVERAGE="Return the average (arithmetic mean) of the numeric values in the list.",i.Msg.MATH_ONLIST_TOOLTIP_MAX="Return the largest number in the list.",i.Msg.MATH_ONLIST_TOOLTIP_MEDIAN="Return the median number in the list.",i.Msg.MATH_ONLIST_TOOLTIP_MIN="Return the smallest number in the list.",i.Msg.MATH_ONLIST_TOOLTIP_MODE="Return a list of the most common item(s) in the list.",i.Msg.MATH_ONLIST_TOOLTIP_RANDOM="Return a random element from the list.",i.Msg.MATH_ONLIST_TOOLTIP_STD_DEV="Return the standard deviation of the list.",i.Msg.MATH_ONLIST_TOOLTIP_SUM="Return the sum of all the numbers in the list.",i.Msg.MATH_POWER_SYMBOL="^",i.Msg.MATH_RANDOM_FLOAT_HELPURL="https://en.wikipedia.org/wiki/Random_number_generation",i.Msg.MATH_RANDOM_FLOAT_TITLE_RANDOM="random fraction",i.Msg.MATH_RANDOM_FLOAT_TOOLTIP="Return a random fraction between 0.0 (inclusive) and 1.0 (exclusive).",i.Msg.MATH_RANDOM_INT_HELPURL="https://en.wikipedia.org/wiki/Random_number_generation",i.Msg.MATH_RANDOM_INT_TITLE="random integer from %1 to %2",i.Msg.MATH_RANDOM_INT_TOOLTIP="Return a random integer between the two specified limits, inclusive.",i.Msg.MATH_ROUND_HELPURL="https://en.wikipedia.org/wiki/Rounding",i.Msg.MATH_ROUND_OPERATOR_ROUND="round",i.Msg.MATH_ROUND_OPERATOR_ROUNDDOWN="round down",i.Msg.MATH_ROUND_OPERATOR_ROUNDUP="round up",i.Msg.MATH_ROUND_TOOLTIP="Round a number up or down.",i.Msg.MATH_SINGLE_HELPURL="https://en.wikipedia.org/wiki/Square_root",i.Msg.MATH_SINGLE_OP_ABSOLUTE="absolute",i.Msg.MATH_SINGLE_OP_ROOT="square root",i.Msg.MATH_SINGLE_TOOLTIP_ABS="Return the absolute value of a number.",i.Msg.MATH_SINGLE_TOOLTIP_EXP="Return e to the power of a number.",i.Msg.MATH_SINGLE_TOOLTIP_LN="Return the natural logarithm of a number.",i.Msg.MATH_SINGLE_TOOLTIP_LOG10="Return the base 10 logarithm of a number.",i.Msg.MATH_SINGLE_TOOLTIP_NEG="Return the negation of a number.",i.Msg.MATH_SINGLE_TOOLTIP_POW10="Return 10 to the power of a number.",i.Msg.MATH_SINGLE_TOOLTIP_ROOT="Return the square root of a number.",i.Msg.MATH_SUBTRACTION_SYMBOL="-",i.Msg.MATH_TRIG_ACOS="acos",i.Msg.MATH_TRIG_ASIN="asin",i.Msg.MATH_TRIG_ATAN="atan",i.Msg.MATH_TRIG_COS="cos",i.Msg.MATH_TRIG_HELPURL="https://en.wikipedia.org/wiki/Trigonometric_functions",i.Msg.MATH_TRIG_SIN="sin",i.Msg.MATH_TRIG_TAN="tan",i.Msg.MATH_TRIG_TOOLTIP_ACOS="Return the arccosine of a number.",i.Msg.MATH_TRIG_TOOLTIP_ASIN="Return the arcsine of a number.",i.Msg.MATH_TRIG_TOOLTIP_ATAN="Return the arctangent of a number.",i.Msg.MATH_TRIG_TOOLTIP_COS="Return the cosine of a degree (not radian).",i.Msg.MATH_TRIG_TOOLTIP_SIN="Return the sine of a degree (not radian).",i.Msg.MATH_TRIG_TOOLTIP_TAN="Return the tangent of a degree (not radian).",i.Msg.NEW_COLOUR_VARIABLE="Create colour variable...",i.Msg.NEW_NUMBER_VARIABLE="Create number variable...",i.Msg.NEW_STRING_VARIABLE="Create string variable...",i.Msg.NEW_VARIABLE="Create variable...",i.Msg.NEW_VARIABLE_TITLE="New variable name:",i.Msg.NEW_VARIABLE_TYPE_TITLE="New variable type:",i.Msg.ORDINAL_NUMBER_SUFFIX="",i.Msg.PROCEDURES_ALLOW_STATEMENTS="allow statements",i.Msg.PROCEDURES_BEFORE_PARAMS="with:",i.Msg.PROCEDURES_CALLNORETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",i.Msg.PROCEDURES_CALLNORETURN_TOOLTIP="Run the user-defined function '%1'.",i.Msg.PROCEDURES_CALLRETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",i.Msg.PROCEDURES_CALLRETURN_TOOLTIP="Run the user-defined function '%1' and use its output.",i.Msg.PROCEDURES_CALL_BEFORE_PARAMS="with:",i.Msg.PROCEDURES_CREATE_DO="Create '%1'",i.Msg.PROCEDURES_DEFNORETURN_COMMENT="Describe this function...",i.Msg.PROCEDURES_DEFNORETURN_DO="",i.Msg.PROCEDURES_DEFNORETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",i.Msg.PROCEDURES_DEFNORETURN_PROCEDURE="do something",i.Msg.PROCEDURES_DEFNORETURN_TITLE="to",i.Msg.PROCEDURES_DEFNORETURN_TOOLTIP="Creates a function with no output.",i.Msg.PROCEDURES_DEFRETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",i.Msg.PROCEDURES_DEFRETURN_RETURN="return",i.Msg.PROCEDURES_DEFRETURN_TOOLTIP="Creates a function with an output.",i.Msg.PROCEDURES_DEF_DUPLICATE_WARNING="Warning: This function has duplicate parameters.",i.Msg.PROCEDURES_HIGHLIGHT_DEF="Highlight function definition",i.Msg.PROCEDURES_IFRETURN_HELPURL="http://c2.com/cgi/wiki?GuardClause",i.Msg.PROCEDURES_IFRETURN_TOOLTIP="If a value is true, then return a second value.",i.Msg.PROCEDURES_IFRETURN_WARNING="Warning: This block may be used only within a function definition.",i.Msg.PROCEDURES_MUTATORARG_TITLE="input name:",i.Msg.PROCEDURES_MUTATORARG_TOOLTIP="Add an input to the function.",i.Msg.PROCEDURES_MUTATORCONTAINER_TITLE="inputs",i.Msg.PROCEDURES_MUTATORCONTAINER_TOOLTIP="Add, remove, or reorder inputs to this function.",i.Msg.REDO="Redo",i.Msg.REMOVE_COMMENT="Remove Comment",i.Msg.RENAME_VARIABLE="Rename variable...",i.Msg.RENAME_VARIABLE_TITLE="Rename all '%1' variables to:",i.Msg.TEXT_APPEND_HELPURL="https://github.com/google/blockly/wiki/Text#text-modification",i.Msg.TEXT_APPEND_TITLE="to %1 append text %2",i.Msg.TEXT_APPEND_TOOLTIP="Append some text to variable '%1'.",i.Msg.TEXT_CHANGECASE_HELPURL="https://github.com/google/blockly/wiki/Text#adjusting-text-case",i.Msg.TEXT_CHANGECASE_OPERATOR_LOWERCASE="to lower case",i.Msg.TEXT_CHANGECASE_OPERATOR_TITLECASE="to Title Case",i.Msg.TEXT_CHANGECASE_OPERATOR_UPPERCASE="to UPPER CASE",i.Msg.TEXT_CHANGECASE_TOOLTIP="Return a copy of the text in a different case.",i.Msg.TEXT_CHARAT_FIRST="get first letter",i.Msg.TEXT_CHARAT_FROM_END="get letter # from end",i.Msg.TEXT_CHARAT_FROM_START="get letter #",i.Msg.TEXT_CHARAT_HELPURL="https://github.com/google/blockly/wiki/Text#extracting-text",i.Msg.TEXT_CHARAT_LAST="get last letter",i.Msg.TEXT_CHARAT_RANDOM="get random letter",i.Msg.TEXT_CHARAT_TAIL="",i.Msg.TEXT_CHARAT_TITLE="in text %1 %2",i.Msg.TEXT_CHARAT_TOOLTIP="Returns the letter at the specified position.",i.Msg.TEXT_COUNT_HELPURL="https://github.com/google/blockly/wiki/Text#counting-substrings",i.Msg.TEXT_COUNT_MESSAGE0="count %1 in %2",i.Msg.TEXT_COUNT_TOOLTIP="Count how many times some text occurs within some other text.",i.Msg.TEXT_CREATE_JOIN_ITEM_TOOLTIP="Add an item to the text.",i.Msg.TEXT_CREATE_JOIN_TITLE_JOIN="join",i.Msg.TEXT_CREATE_JOIN_TOOLTIP="Add, remove, or reorder sections to reconfigure this text block.",i.Msg.TEXT_GET_SUBSTRING_END_FROM_END="to letter # from end",i.Msg.TEXT_GET_SUBSTRING_END_FROM_START="to letter #",i.Msg.TEXT_GET_SUBSTRING_END_LAST="to last letter",i.Msg.TEXT_GET_SUBSTRING_HELPURL="https://github.com/google/blockly/wiki/Text#extracting-a-region-of-text",i.Msg.TEXT_GET_SUBSTRING_INPUT_IN_TEXT="in text",i.Msg.TEXT_GET_SUBSTRING_START_FIRST="get substring from first letter",i.Msg.TEXT_GET_SUBSTRING_START_FROM_END="get substring from letter # from end",i.Msg.TEXT_GET_SUBSTRING_START_FROM_START="get substring from letter #",i.Msg.TEXT_GET_SUBSTRING_TAIL="",i.Msg.TEXT_GET_SUBSTRING_TOOLTIP="Returns a specified portion of the text.",i.Msg.TEXT_INDEXOF_HELPURL="https://github.com/google/blockly/wiki/Text#finding-text",i.Msg.TEXT_INDEXOF_OPERATOR_FIRST="find first occurrence of text",i.Msg.TEXT_INDEXOF_OPERATOR_LAST="find last occurrence of text",i.Msg.TEXT_INDEXOF_TITLE="in text %1 %2 %3",i.Msg.TEXT_INDEXOF_TOOLTIP="Returns the index of the first/last occurrence of the first text in the second text. Returns %1 if text is not found.",i.Msg.TEXT_ISEMPTY_HELPURL="https://github.com/google/blockly/wiki/Text#checking-for-empty-text",i.Msg.TEXT_ISEMPTY_TITLE="%1 is empty",i.Msg.TEXT_ISEMPTY_TOOLTIP="Returns true if the provided text is empty.",i.Msg.TEXT_JOIN_HELPURL="https://github.com/google/blockly/wiki/Text#text-creation",i.Msg.TEXT_JOIN_TITLE_CREATEWITH="create text with",i.Msg.TEXT_JOIN_TOOLTIP="Create a piece of text by joining together any number of items.",i.Msg.TEXT_LENGTH_HELPURL="https://github.com/google/blockly/wiki/Text#text-modification",i.Msg.TEXT_LENGTH_TITLE="length of %1",i.Msg.TEXT_LENGTH_TOOLTIP="Returns the number of letters (including spaces) in the provided text.",i.Msg.TEXT_PRINT_HELPURL="https://github.com/google/blockly/wiki/Text#printing-text",i.Msg.TEXT_PRINT_TITLE="print %1",i.Msg.TEXT_PRINT_TOOLTIP="Print the specified text, number or other value.",i.Msg.TEXT_PROMPT_HELPURL="https://github.com/google/blockly/wiki/Text#getting-input-from-the-user",i.Msg.TEXT_PROMPT_TOOLTIP_NUMBER="Prompt for user for a number.",i.Msg.TEXT_PROMPT_TOOLTIP_TEXT="Prompt for user for some text.",i.Msg.TEXT_PROMPT_TYPE_NUMBER="prompt for number with message",i.Msg.TEXT_PROMPT_TYPE_TEXT="prompt for text with message",i.Msg.TEXT_REPLACE_HELPURL="https://github.com/google/blockly/wiki/Text#replacing-substrings",i.Msg.TEXT_REPLACE_MESSAGE0="replace %1 with %2 in %3",i.Msg.TEXT_REPLACE_TOOLTIP="Replace all occurances of some text within some other text.",i.Msg.TEXT_REVERSE_HELPURL="https://github.com/google/blockly/wiki/Text#reversing-text",i.Msg.TEXT_REVERSE_MESSAGE0="reverse %1",i.Msg.TEXT_REVERSE_TOOLTIP="Reverses the order of the characters in the text.",i.Msg.TEXT_TEXT_HELPURL="https://en.wikipedia.org/wiki/String_(computer_science)",i.Msg.TEXT_TEXT_TOOLTIP="A letter, word, or line of text.",i.Msg.TEXT_TRIM_HELPURL="https://github.com/google/blockly/wiki/Text#trimming-removing-spaces",i.Msg.TEXT_TRIM_OPERATOR_BOTH="trim spaces from both sides of",i.Msg.TEXT_TRIM_OPERATOR_LEFT="trim spaces from left side of",i.Msg.TEXT_TRIM_OPERATOR_RIGHT="trim spaces from right side of",i.Msg.TEXT_TRIM_TOOLTIP="Return a copy of the text with spaces removed from one or both ends.",i.Msg.TODAY="Today",i.Msg.UNDO="Undo",i.Msg.UNNAMED_KEY="unnamed",i.Msg.VARIABLES_DEFAULT_NAME="item",i.Msg.VARIABLES_GET_CREATE_SET="Create 'set %1'",i.Msg.VARIABLES_GET_HELPURL="https://github.com/google/blockly/wiki/Variables#get",i.Msg.VARIABLES_GET_TOOLTIP="Returns the value of this variable.",i.Msg.VARIABLES_SET="set %1 to %2",i.Msg.VARIABLES_SET_CREATE_GET="Create 'get %1'",i.Msg.VARIABLES_SET_HELPURL="https://github.com/google/blockly/wiki/Variables#set",i.Msg.VARIABLES_SET_TOOLTIP="Sets this variable to be equal to the input.",i.Msg.VARIABLE_ALREADY_EXISTS="A variable named '%1' already exists.",i.Msg.VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE="A variable named '%1' already exists for another type: '%2'.",i.Msg.WORKSPACE_ARIA_LABEL="Blockly Workspace",i.Msg.WORKSPACE_COMMENT_DEFAULT_TEXT="Say something...",i.Msg.CONTROLS_FOREACH_INPUT_DO=i.Msg.CONTROLS_REPEAT_INPUT_DO,i.Msg.CONTROLS_FOR_INPUT_DO=i.Msg.CONTROLS_REPEAT_INPUT_DO,i.Msg.CONTROLS_IF_ELSEIF_TITLE_ELSEIF=i.Msg.CONTROLS_IF_MSG_ELSEIF,i.Msg.CONTROLS_IF_ELSE_TITLE_ELSE=i.Msg.CONTROLS_IF_MSG_ELSE,i.Msg.CONTROLS_IF_IF_TITLE_IF=i.Msg.CONTROLS_IF_MSG_IF,i.Msg.CONTROLS_IF_MSG_THEN=i.Msg.CONTROLS_REPEAT_INPUT_DO,i.Msg.CONTROLS_WHILEUNTIL_INPUT_DO=i.Msg.CONTROLS_REPEAT_INPUT_DO,i.Msg.LISTS_CREATE_WITH_ITEM_TITLE=i.Msg.VARIABLES_DEFAULT_NAME,i.Msg.LISTS_GET_INDEX_HELPURL=i.Msg.LISTS_INDEX_OF_HELPURL,i.Msg.LISTS_GET_INDEX_INPUT_IN_LIST=i.Msg.LISTS_INLIST,i.Msg.LISTS_GET_SUBLIST_INPUT_IN_LIST=i.Msg.LISTS_INLIST,i.Msg.LISTS_INDEX_OF_INPUT_IN_LIST=i.Msg.LISTS_INLIST,i.Msg.LISTS_SET_INDEX_INPUT_IN_LIST=i.Msg.LISTS_INLIST,i.Msg.MATH_CHANGE_TITLE_ITEM=i.Msg.VARIABLES_DEFAULT_NAME,i.Msg.PROCEDURES_DEFRETURN_COMMENT=i.Msg.PROCEDURES_DEFNORETURN_COMMENT,i.Msg.PROCEDURES_DEFRETURN_DO=i.Msg.PROCEDURES_DEFNORETURN_DO,i.Msg.PROCEDURES_DEFRETURN_PROCEDURE=i.Msg.PROCEDURES_DEFNORETURN_PROCEDURE,i.Msg.PROCEDURES_DEFRETURN_TITLE=i.Msg.PROCEDURES_DEFNORETURN_TITLE,i.Msg.TEXT_APPEND_VARIABLE=i.Msg.VARIABLES_DEFAULT_NAME,i.Msg.TEXT_CREATE_JOIN_ITEM_TITLE_ITEM=i.Msg.VARIABLES_DEFAULT_NAME,i.Msg.MATH_HUE="230",i.Msg.LOOPS_HUE="120",i.Msg.LISTS_HUE="260",i.Msg.LOGIC_HUE="210",i.Msg.VARIABLES_HUE="330",i.Msg.TEXTS_HUE="160",i.Msg.PROCEDURES_HUE="290",i.Msg.COLOUR_HUE="20",i.Msg.VARIABLES_DYNAMIC_HUE="310",i.Msg})}(fg)),fg.exports}var mg={exports:{}},Eg={exports:{}},b$;function qx(){return b$||(b$=1,function(s,n){(function(i,o){s.exports=o(hm())})(Ni,function(i){var o=i.__namespace__,l={};o.module$build$src$core$contextmenu,o.module$build$src$core$extensions,o.module$build$src$core$variables,o.module$build$src$core$utils$xml;var f=o.module$build$src$core$msg.Msg,m=o.module$build$src$core$common.createBlockDefinitionsFromJsonArray,u=o.module$build$src$core$common.defineBlocks;l.blocks=m([{type:"variables_get_dynamic",message0:"%1",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"}],output:null,style:"variable_dynamic_blocks",helpUrl:"%{BKY_VARIABLES_GET_HELPURL}",tooltip:"%{BKY_VARIABLES_GET_TOOLTIP}",extensions:["contextMenu_variableDynamicSetterGetter"]},{type:"variables_set_dynamic",message0:"%{BKY_VARIABLES_SET}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"},{type:"input_value",name:"VALUE"}],previousStatement:null,nextStatement:null,style:"variable_dynamic_blocks",tooltip:"%{BKY_VARIABLES_SET_TOOLTIP}",helpUrl:"%{BKY_VARIABLES_SET_HELPURL}",extensions:["contextMenu_variableDynamicSetterGetter"]}]);var _={customContextMenu:function(N){if(this.isInFlyout)(this.type==="variables_get_dynamic"||this.type==="variables_get_reporter_dynamic")&&(G={text:f.RENAME_VARIABLE,enabled:true,callback:c(this)},ce=this.getField("VAR").getText(),ce={text:f.DELETE_VARIABLE.replace("%1",ce),enabled:true,callback:h(this)},N.unshift(G),N.unshift(ce));else{var G=this.getFieldValue("VAR"),Z=this.workspace.getVariableById(G).type;if(this.type==="variables_get_dynamic"){G="variables_set_dynamic";var oe=f.VARIABLES_GET_CREATE_SET}else G="variables_get_dynamic",oe=f.VARIABLES_SET_CREATE_GET;var ce={enabled:0<this.workspace.remainingCapacity()};const Ue=this.getField("VAR").getText();ce.text=oe.replace("%1",Ue),oe=o.module$build$src$core$utils$xml.createElement("field"),oe.setAttribute("name","VAR"),oe.setAttribute("variabletype",Z),oe.appendChild(o.module$build$src$core$utils$xml.createTextNode(Ue)),Z=o.module$build$src$core$utils$xml.createElement("block"),Z.setAttribute("type",G),Z.appendChild(oe),ce.callback=o.module$build$src$core$contextmenu.callbackFactory(this,Z),N.push(ce)}},onchange:function(N){N=this.getFieldValue("VAR"),N=o.module$build$src$core$variables.getVariable(this.workspace,N),this.type==="variables_get_dynamic"?this.outputConnection.setCheck(N.type):this.getInput("VALUE").connection.setCheck(N.type)}},c=function(N){return function(){const G=N.workspace,Z=N.getField("VAR").getVariable();o.module$build$src$core$variables.renameVariable(G,Z)}},h=function(N){return function(){const G=N.workspace,Z=N.getField("VAR").getVariable();G.deleteVariableById(Z.getId()),G.refreshToolboxSelection()}};o.module$build$src$core$extensions.registerMixin("contextMenu_variableDynamicSetterGetter",_),u(l.blocks);var p={};o.module$build$src$core$contextmenu,o.module$build$src$core$extensions,o.module$build$src$core$variables,o.module$build$src$core$utils$xml;var T=o.module$build$src$core$msg.Msg,$=o.module$build$src$core$common.createBlockDefinitionsFromJsonArray,S=o.module$build$src$core$common.defineBlocks;p.blocks=$([{type:"variables_get",message0:"%1",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"}],output:null,style:"variable_blocks",helpUrl:"%{BKY_VARIABLES_GET_HELPURL}",tooltip:"%{BKY_VARIABLES_GET_TOOLTIP}",extensions:["contextMenu_variableSetterGetter"]},{type:"variables_set",message0:"%{BKY_VARIABLES_SET}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"},{type:"input_value",name:"VALUE"}],previousStatement:null,nextStatement:null,style:"variable_blocks",tooltip:"%{BKY_VARIABLES_SET_TOOLTIP}",helpUrl:"%{BKY_VARIABLES_SET_HELPURL}",extensions:["contextMenu_variableSetterGetter"]}]);var y={customContextMenu:function(N){if(this.isInFlyout)(this.type==="variables_get"||this.type==="variables_get_reporter")&&(G={text:T.RENAME_VARIABLE,enabled:true,callback:g(this)},oe=this.getField("VAR").getText(),oe={text:T.DELETE_VARIABLE.replace("%1",oe),enabled:true,callback:E(this)},N.unshift(G),N.unshift(oe));else{if(this.type==="variables_get")var G="variables_set",Z=T.VARIABLES_GET_CREATE_SET;else G="variables_get",Z=T.VARIABLES_SET_CREATE_GET;var oe={enabled:0<this.workspace.remainingCapacity()},ce=this.getField("VAR").getText();oe.text=Z.replace("%1",ce),Z=o.module$build$src$core$utils$xml.createElement("field"),Z.setAttribute("name","VAR"),Z.appendChild(o.module$build$src$core$utils$xml.createTextNode(ce)),ce=o.module$build$src$core$utils$xml.createElement("block"),ce.setAttribute("type",G),ce.appendChild(Z),oe.callback=o.module$build$src$core$contextmenu.callbackFactory(this,ce),N.push(oe)}}},g=function(N){return function(){const G=N.workspace,Z=N.getField("VAR").getVariable();o.module$build$src$core$variables.renameVariable(G,Z)}},E=function(N){return function(){const G=N.workspace,Z=N.getField("VAR").getVariable();G.deleteVariableById(Z.getId()),G.refreshToolboxSelection()}};o.module$build$src$core$extensions.registerMixin("contextMenu_variableSetterGetter",y),S(p.blocks);var v={};o.module$build$src$core$extensions;var b=o.module$build$src$core$msg.Msg;o.module$build$src$core$utils$xml,o.Align$$module$build$src$core$input,o.module$build$src$core$connection_type.ConnectionType;var R=o.module$build$src$core$field_dropdown.FieldDropdown;o.FieldImage$$module$build$src$core$field_image,o.FieldTextInput$$module$build$src$core$field_textinput,o.Mutator$$module$build$src$core$mutator;var O=o.module$build$src$core$common.createBlockDefinitionsFromJsonArray,w=o.module$build$src$core$common.defineBlocks;v.blocks=O([{type:"text",message0:"%1",args0:[{type:"field_input",name:"TEXT",text:""}],output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_TEXT_HELPURL}",tooltip:"%{BKY_TEXT_TEXT_TOOLTIP}",extensions:["text_quotes","parent_tooltip_when_inline"]},{type:"text_multiline",message0:"%1 %2",args0:[{type:"field_image",src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAARCAYAAADpPU2iAAAABGdBTUEAALGPC/xhBQAAAAlwSFlzAAAdhgAAHYYBXaITgQAAABh0RVh0U29mdHdhcmUAcGFpbnQubmV0IDQuMS42/U4J6AAAAP1JREFUOE+Vks0KQUEYhjmRIja4ABtZ2dm5A3t3Ia6AUm7CylYuQRaUhZSlLZJiQbFAyRnPN33y01HOW08z8873zpwzM4F3GWOCruvGIE4/rLaV+Nq1hVGMBqzhqlxgCys4wJA65xnogMHsQ5lujnYHTejBBCK2mE4abjCgMGhNxHgDFWjDSG07kdfVa2pZMf4ZyMAdWmpZMfYOsLiDMYMjlMB+K613QISRhTnITnsYg5yUd0DETmEoMlkFOeIT/A58iyK5E18BuTBfgYXfwNJv4P9/oEBerLylOnRhygmGdPpTTBZAPkde61lbQe4moWUvYUZYLfUNftIY4zwA5X2Z9AYnQrEAAAAASUVORK5CYII=",width:12,height:17,alt:"¶"},{type:"field_multilinetext",name:"TEXT",text:""}],output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_TEXT_HELPURL}",tooltip:"%{BKY_TEXT_TEXT_TOOLTIP}",extensions:["parent_tooltip_when_inline"]},{type:"text_join",message0:"",output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_JOIN_HELPURL}",tooltip:"%{BKY_TEXT_JOIN_TOOLTIP}",mutator:"text_join_mutator"},{type:"text_create_join_container",message0:"%{BKY_TEXT_CREATE_JOIN_TITLE_JOIN} %1 %2",args0:[{type:"input_dummy"},{type:"input_statement",name:"STACK"}],style:"text_blocks",tooltip:"%{BKY_TEXT_CREATE_JOIN_TOOLTIP}",enableContextMenu:false},{type:"text_create_join_item",message0:"%{BKY_TEXT_CREATE_JOIN_ITEM_TITLE_ITEM}",previousStatement:null,nextStatement:null,style:"text_blocks",tooltip:"%{BKY_TEXT_CREATE_JOIN_ITEM_TOOLTIP}",enableContextMenu:false},{type:"text_append",message0:"%{BKY_TEXT_APPEND_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_TEXT_APPEND_VARIABLE}"},{type:"input_value",name:"TEXT"}],previousStatement:null,nextStatement:null,style:"text_blocks",extensions:["text_append_tooltip"]},{type:"text_length",message0:"%{BKY_TEXT_LENGTH_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Number",style:"text_blocks",tooltip:"%{BKY_TEXT_LENGTH_TOOLTIP}",helpUrl:"%{BKY_TEXT_LENGTH_HELPURL}"},{type:"text_isEmpty",message0:"%{BKY_TEXT_ISEMPTY_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Boolean",style:"text_blocks",tooltip:"%{BKY_TEXT_ISEMPTY_TOOLTIP}",helpUrl:"%{BKY_TEXT_ISEMPTY_HELPURL}"},{type:"text_indexOf",message0:"%{BKY_TEXT_INDEXOF_TITLE}",args0:[{type:"input_value",name:"VALUE",check:"String"},{type:"field_dropdown",name:"END",options:[["%{BKY_TEXT_INDEXOF_OPERATOR_FIRST}","FIRST"],["%{BKY_TEXT_INDEXOF_OPERATOR_LAST}","LAST"]]},{type:"input_value",name:"FIND",check:"String"}],output:"Number",style:"text_blocks",helpUrl:"%{BKY_TEXT_INDEXOF_HELPURL}",inputsInline:true,extensions:["text_indexOf_tooltip"]},{type:"text_charAt",message0:"%{BKY_TEXT_CHARAT_TITLE}",args0:[{type:"input_value",name:"VALUE",check:"String"},{type:"field_dropdown",name:"WHERE",options:[["%{BKY_TEXT_CHARAT_FROM_START}","FROM_START"],["%{BKY_TEXT_CHARAT_FROM_END}","FROM_END"],["%{BKY_TEXT_CHARAT_FIRST}","FIRST"],["%{BKY_TEXT_CHARAT_LAST}","LAST"],["%{BKY_TEXT_CHARAT_RANDOM}","RANDOM"]]}],output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_CHARAT_HELPURL}",inputsInline:true,mutator:"text_charAt_mutator"}]),v.blocks.text_getSubstring={init:function(){this.WHERE_OPTIONS_1=[[b.TEXT_GET_SUBSTRING_START_FROM_START,"FROM_START"],[b.TEXT_GET_SUBSTRING_START_FROM_END,"FROM_END"],[b.TEXT_GET_SUBSTRING_START_FIRST,"FIRST"]],this.WHERE_OPTIONS_2=[[b.TEXT_GET_SUBSTRING_END_FROM_START,"FROM_START"],[b.TEXT_GET_SUBSTRING_END_FROM_END,"FROM_END"],[b.TEXT_GET_SUBSTRING_END_LAST,"LAST"]],this.setHelpUrl(b.TEXT_GET_SUBSTRING_HELPURL),this.setStyle("text_blocks"),this.appendValueInput("STRING").setCheck("String").appendField(b.TEXT_GET_SUBSTRING_INPUT_IN_TEXT),this.appendDummyInput("AT1"),this.appendDummyInput("AT2"),b.TEXT_GET_SUBSTRING_TAIL&&this.appendDummyInput("TAIL").appendField(b.TEXT_GET_SUBSTRING_TAIL),this.setInputsInline(true),this.setOutput(true,"String"),this.updateAt_(1,true),this.updateAt_(2,true),this.setTooltip(b.TEXT_GET_SUBSTRING_TOOLTIP)},mutationToDom:function(){const N=o.module$build$src$core$utils$xml.createElement("mutation");var G=this.getInput("AT1").type===o.module$build$src$core$connection_type.ConnectionType.INPUT_VALUE;return N.setAttribute("at1",G),G=this.getInput("AT2").type===o.module$build$src$core$connection_type.ConnectionType.INPUT_VALUE,N.setAttribute("at2",G),N},domToMutation:function(N){const G=N.getAttribute("at1")==="true";N=N.getAttribute("at2")==="true",this.updateAt_(1,G),this.updateAt_(2,N)},updateAt_:function(N,G){this.removeInput("AT"+N),this.removeInput("ORDINAL"+N,true),G?(this.appendValueInput("AT"+N).setCheck("Number"),b.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL"+N).appendField(b.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT"+N),N===2&&b.TEXT_GET_SUBSTRING_TAIL&&(this.removeInput("TAIL",true),this.appendDummyInput("TAIL").appendField(b.TEXT_GET_SUBSTRING_TAIL));const Z=new R(this["WHERE_OPTIONS_"+N],function(oe){const ce=oe==="FROM_START"||oe==="FROM_END";if(ce!==G){const Ue=this.getSourceBlock();return Ue.updateAt_(N,ce),Ue.setFieldValue(oe,"WHERE"+N),null}});this.getInput("AT"+N).appendField(Z,"WHERE"+N),N===1&&(this.moveInputBefore("AT1","AT2"),this.getInput("ORDINAL1")&&this.moveInputBefore("ORDINAL1","AT2"))}},v.blocks.text_changeCase={init:function(){const N=[[b.TEXT_CHANGECASE_OPERATOR_UPPERCASE,"UPPERCASE"],[b.TEXT_CHANGECASE_OPERATOR_LOWERCASE,"LOWERCASE"],[b.TEXT_CHANGECASE_OPERATOR_TITLECASE,"TITLECASE"]];this.setHelpUrl(b.TEXT_CHANGECASE_HELPURL),this.setStyle("text_blocks"),this.appendValueInput("TEXT").setCheck("String").appendField(new R(N),"CASE"),this.setOutput(true,"String"),this.setTooltip(b.TEXT_CHANGECASE_TOOLTIP)}},v.blocks.text_trim={init:function(){const N=[[b.TEXT_TRIM_OPERATOR_BOTH,"BOTH"],[b.TEXT_TRIM_OPERATOR_LEFT,"LEFT"],[b.TEXT_TRIM_OPERATOR_RIGHT,"RIGHT"]];this.setHelpUrl(b.TEXT_TRIM_HELPURL),this.setStyle("text_blocks"),this.appendValueInput("TEXT").setCheck("String").appendField(new R(N),"MODE"),this.setOutput(true,"String"),this.setTooltip(b.TEXT_TRIM_TOOLTIP)}},v.blocks.text_print={init:function(){this.jsonInit({message0:b.TEXT_PRINT_TITLE,args0:[{type:"input_value",name:"TEXT"}],previousStatement:null,nextStatement:null,style:"text_blocks",tooltip:b.TEXT_PRINT_TOOLTIP,helpUrl:b.TEXT_PRINT_HELPURL})}};var L={updateType_:function(N){this.outputConnection.setCheck(N==="NUMBER"?"Number":"String")},mutationToDom:function(){const N=o.module$build$src$core$utils$xml.createElement("mutation");return N.setAttribute("type",this.getFieldValue("TYPE")),N},domToMutation:function(N){this.updateType_(N.getAttribute("type"))}};v.blocks.text_prompt_ext=Object.assign({},L,{init:function(){var N=[[b.TEXT_PROMPT_TYPE_TEXT,"TEXT"],[b.TEXT_PROMPT_TYPE_NUMBER,"NUMBER"]];this.setHelpUrl(b.TEXT_PROMPT_HELPURL),this.setStyle("text_blocks");const G=this;N=new R(N,function(Z){G.updateType_(Z)}),this.appendValueInput("TEXT").appendField(N,"TYPE"),this.setOutput(true,"String"),this.setTooltip(function(){return G.getFieldValue("TYPE")==="TEXT"?b.TEXT_PROMPT_TOOLTIP_TEXT:b.TEXT_PROMPT_TOOLTIP_NUMBER})}}),v.blocks.text_prompt=Object.assign({},L,{init:function(){this.mixin(I);var N=[[b.TEXT_PROMPT_TYPE_TEXT,"TEXT"],[b.TEXT_PROMPT_TYPE_NUMBER,"NUMBER"]];const G=this;this.setHelpUrl(b.TEXT_PROMPT_HELPURL),this.setStyle("text_blocks"),N=new R(N,function(Z){G.updateType_(Z)}),this.appendDummyInput().appendField(N,"TYPE").appendField(this.newQuote_(true)).appendField(new o.FieldTextInput$$module$build$src$core$field_textinput(""),"TEXT").appendField(this.newQuote_(false)),this.setOutput(true,"String"),this.setTooltip(function(){return G.getFieldValue("TYPE")==="TEXT"?b.TEXT_PROMPT_TOOLTIP_TEXT:b.TEXT_PROMPT_TOOLTIP_NUMBER})}}),v.blocks.text_count={init:function(){this.jsonInit({message0:b.TEXT_COUNT_MESSAGE0,args0:[{type:"input_value",name:"SUB",check:"String"},{type:"input_value",name:"TEXT",check:"String"}],output:"Number",inputsInline:true,style:"text_blocks",tooltip:b.TEXT_COUNT_TOOLTIP,helpUrl:b.TEXT_COUNT_HELPURL})}},v.blocks.text_replace={init:function(){this.jsonInit({message0:b.TEXT_REPLACE_MESSAGE0,args0:[{type:"input_value",name:"FROM",check:"String"},{type:"input_value",name:"TO",check:"String"},{type:"input_value",name:"TEXT",check:"String"}],output:"String",inputsInline:true,style:"text_blocks",tooltip:b.TEXT_REPLACE_TOOLTIP,helpUrl:b.TEXT_REPLACE_HELPURL})}},v.blocks.text_reverse={init:function(){this.jsonInit({message0:b.TEXT_REVERSE_MESSAGE0,args0:[{type:"input_value",name:"TEXT",check:"String"}],output:"String",inputsInline:true,style:"text_blocks",tooltip:b.TEXT_REVERSE_TOOLTIP,helpUrl:b.TEXT_REVERSE_HELPURL})}};var I={QUOTE_IMAGE_LEFT_DATAURI:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAKCAQAAAAqJXdxAAAAn0lEQVQI1z3OMa5BURSF4f/cQhAKjUQhuQmFNwGJEUi0RKN5rU7FHKhpjEH3TEMtkdBSCY1EIv8r7nFX9e29V7EBAOvu7RPjwmWGH/VuF8CyN9/OAdvqIXYLvtRaNjx9mMTDyo+NjAN1HNcl9ZQ5oQMM3dgDUqDo1l8DzvwmtZN7mnD+PkmLa+4mhrxVA9fRowBWmVBhFy5gYEjKMfz9AylsaRRgGzvZAAAAAElFTkSuQmCC",QUOTE_IMAGE_RIGHT_DATAURI:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAKCAQAAAAqJXdxAAAAqUlEQVQI1z3KvUpCcRiA8ef9E4JNHhI0aFEacm1o0BsI0Slx8wa8gLauoDnoBhq7DcfWhggONDmJJgqCPA7neJ7p934EOOKOnM8Q7PDElo/4x4lFb2DmuUjcUzS3URnGib9qaPNbuXvBO3sGPHJDRG6fGVdMSeWDP2q99FQdFrz26Gu5Tq7dFMzUvbXy8KXeAj57cOklgA+u1B5AoslLtGIHQMaCVnwDnADZIFIrXsoXrgAAAABJRU5ErkJggg==",QUOTE_IMAGE_WIDTH:12,QUOTE_IMAGE_HEIGHT:12,quoteField_:function(N){for(let G=0,Z;Z=this.inputList[G];G++)for(let oe=0,ce;ce=Z.fieldRow[oe];oe++)if(N===ce.name){Z.insertFieldAt(oe,this.newQuote_(true)),Z.insertFieldAt(oe+2,this.newQuote_(false));return}console.warn('field named "'+N+'" not found in '+this.toDevString())},newQuote_:function(N){return N=this.RTL?!N:N,new o.FieldImage$$module$build$src$core$field_image(N?this.QUOTE_IMAGE_LEFT_DATAURI:this.QUOTE_IMAGE_RIGHT_DATAURI,this.QUOTE_IMAGE_WIDTH,this.QUOTE_IMAGE_HEIGHT,N?"“":"”")}},k=function(){this.mixin(I),this.quoteField_("TEXT")},x={mutationToDom:function(){const N=o.module$build$src$core$utils$xml.createElement("mutation");return N.setAttribute("items",this.itemCount_),N},domToMutation:function(N){this.itemCount_=parseInt(N.getAttribute("items"),10),this.updateShape_()},saveExtraState:function(){return{itemCount:this.itemCount_}},loadExtraState:function(N){this.itemCount_=N.itemCount,this.updateShape_()},decompose:function(N){const G=N.newBlock("text_create_join_container");G.initSvg();let Z=G.getInput("STACK").connection;for(let oe=0;oe<this.itemCount_;oe++){const ce=N.newBlock("text_create_join_item");ce.initSvg(),Z.connect(ce.previousConnection),Z=ce.nextConnection}return G},compose:function(N){var G=N.getInputTargetBlock("STACK");for(N=[];G;)G.isInsertionMarker()||N.push(G.valueConnection_),G=G.getNextBlock();for(G=0;G<this.itemCount_;G++){const Z=this.getInput("ADD"+G).connection.targetConnection;Z&&N.indexOf(Z)===-1&&Z.disconnect()}for(this.itemCount_=N.length,this.updateShape_(),G=0;G<this.itemCount_;G++)o.Mutator$$module$build$src$core$mutator.reconnect(N[G],this,"ADD"+G)},saveConnections:function(N){N=N.getInputTargetBlock("STACK");let G=0;for(;N;){if(N.isInsertionMarker()){N=N.getNextBlock();continue}const Z=this.getInput("ADD"+G);N.valueConnection_=Z&&Z.connection.targetConnection,N=N.getNextBlock(),G++}},updateShape_:function(){this.itemCount_&&this.getInput("EMPTY")?this.removeInput("EMPTY"):this.itemCount_||this.getInput("EMPTY")||this.appendDummyInput("EMPTY").appendField(this.newQuote_(true)).appendField(this.newQuote_(false));for(var N=0;N<this.itemCount_;N++)if(!this.getInput("ADD"+N)){const G=this.appendValueInput("ADD"+N).setAlign(o.Align$$module$build$src$core$input.RIGHT);N===0&&G.appendField(b.TEXT_JOIN_TITLE_CREATEWITH)}for(N=this.itemCount_;this.getInput("ADD"+N);N++)this.removeInput("ADD"+N)}},P=function(){this.mixin(I),this.itemCount_=2,this.updateShape_(),this.setMutator(new o.Mutator$$module$build$src$core$mutator(["text_create_join_item"],this))};o.module$build$src$core$extensions.register("text_append_tooltip",o.module$build$src$core$extensions.buildTooltipWithFieldText("%{BKY_TEXT_APPEND_TOOLTIP}","VAR"));var F=function(){const N=this;this.setTooltip(function(){return b.TEXT_INDEXOF_TOOLTIP.replace("%1",N.workspace.options.oneBasedIndex?"0":"-1")})},X={mutationToDom:function(){const N=o.module$build$src$core$utils$xml.createElement("mutation");return N.setAttribute("at",!!this.isAt_),N},domToMutation:function(N){N=N.getAttribute("at")!=="false",this.updateAt_(N)},updateAt_:function(N){this.removeInput("AT",true),this.removeInput("ORDINAL",true),N&&(this.appendValueInput("AT").setCheck("Number"),b.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL").appendField(b.ORDINAL_NUMBER_SUFFIX)),b.TEXT_CHARAT_TAIL&&(this.removeInput("TAIL",true),this.appendDummyInput("TAIL").appendField(b.TEXT_CHARAT_TAIL)),this.isAt_=N}},W=function(){this.getField("WHERE").setValidator(function(G){G=G==="FROM_START"||G==="FROM_END",G!==this.isAt_&&this.getSourceBlock().updateAt_(G)}),this.updateAt_(true);const N=this;this.setTooltip(function(){var G=N.getFieldValue("WHERE");let Z=b.TEXT_CHARAT_TOOLTIP;return(G==="FROM_START"||G==="FROM_END")&&(G=G==="FROM_START"?b.LISTS_INDEX_FROM_START_TOOLTIP:b.LISTS_INDEX_FROM_END_TOOLTIP)&&(Z+="  "+G.replace("%1",N.workspace.options.oneBasedIndex?"#1":"#0")),Z})};o.module$build$src$core$extensions.register("text_indexOf_tooltip",F),o.module$build$src$core$extensions.register("text_quotes",k),o.module$build$src$core$extensions.registerMutator("text_join_mutator",x,P),o.module$build$src$core$extensions.registerMutator("text_charAt_mutator",X,W),w(v.blocks);var z={};o.module$build$src$core$contextmenu,o.module$build$src$core$events$events,o.module$build$src$core$procedures,o.module$build$src$core$variables,o.module$build$src$core$xml,o.module$build$src$core$utils$xml,o.Align$$module$build$src$core$input,o.config$$module$build$src$core$config,o.FieldCheckbox$$module$build$src$core$field_checkbox,o.FieldLabel$$module$build$src$core$field_label,o.FieldTextInput$$module$build$src$core$field_textinput;var j=o.module$build$src$core$msg.Msg;o.Mutator$$module$build$src$core$mutator,o.module$build$src$core$names.Names;var J=o.module$build$src$core$common.defineBlocks;z.blocks={};var M={setStatements_:function(N){this.hasStatements_!==N&&(N?(this.appendStatementInput("STACK").appendField(j.PROCEDURES_DEFNORETURN_DO),this.getInput("RETURN")&&this.moveInputBefore("STACK","RETURN")):this.removeInput("STACK",true),this.hasStatements_=N)},updateParams_:function(){let N="";this.arguments_.length&&(N=j.PROCEDURES_BEFORE_PARAMS+" "+this.arguments_.join(", ")),o.module$build$src$core$events$events.disable();try{this.setFieldValue(N,"PARAMS")}finally{o.module$build$src$core$events$events.enable()}},mutationToDom:function(N){const G=o.module$build$src$core$utils$xml.createElement("mutation");N&&G.setAttribute("name",this.getFieldValue("NAME"));for(let Z=0;Z<this.argumentVarModels_.length;Z++){const oe=o.module$build$src$core$utils$xml.createElement("arg"),ce=this.argumentVarModels_[Z];oe.setAttribute("name",ce.name),oe.setAttribute("varid",ce.getId()),N&&this.paramIds_&&oe.setAttribute("paramId",this.paramIds_[Z]),G.appendChild(oe)}return this.hasStatements_||G.setAttribute("statements","false"),G},domToMutation:function(N){this.arguments_=[],this.argumentVarModels_=[];for(let Z=0,oe;oe=N.childNodes[Z];Z++)if(oe.nodeName.toLowerCase()==="arg"){const ce=oe.getAttribute("name");var G=oe.getAttribute("varid")||oe.getAttribute("varId");this.arguments_.push(ce),G=o.module$build$src$core$variables.getOrCreateVariablePackage(this.workspace,G,ce,""),G!==null?this.argumentVarModels_.push(G):console.log(`Failed to create a variable named "${ce}", ignoring.`)}this.updateParams_(),o.module$build$src$core$procedures.mutateCallers(this),this.setStatements_(N.getAttribute("statements")!=="false")},saveExtraState:function(){if(!this.argumentVarModels_.length&&this.hasStatements_)return null;const N=Object.create(null);if(this.argumentVarModels_.length){N.params=[];for(let G=0;G<this.argumentVarModels_.length;G++)N.params.push({name:this.argumentVarModels_[G].name,id:this.argumentVarModels_[G].getId()})}return this.hasStatements_||(N.hasStatements=false),N},loadExtraState:function(N){if(this.arguments_=[],this.argumentVarModels_=[],N.params)for(let Z=0;Z<N.params.length;Z++){var G=N.params[Z];G=o.module$build$src$core$variables.getOrCreateVariablePackage(this.workspace,G.id,G.name,""),this.arguments_.push(G.name),this.argumentVarModels_.push(G)}this.updateParams_(),o.module$build$src$core$procedures.mutateCallers(this),this.setStatements_(N.hasStatements!==false)},decompose:function(N){const G=o.module$build$src$core$utils$xml.createElement("block");G.setAttribute("type","procedures_mutatorcontainer");var Z=o.module$build$src$core$utils$xml.createElement("statement");Z.setAttribute("name","STACK"),G.appendChild(Z);for(let ce=0;ce<this.arguments_.length;ce++){const Ue=o.module$build$src$core$utils$xml.createElement("block");Ue.setAttribute("type","procedures_mutatorarg");var oe=o.module$build$src$core$utils$xml.createElement("field");oe.setAttribute("name","NAME");const ti=o.module$build$src$core$utils$xml.createTextNode(this.arguments_[ce]);oe.appendChild(ti),Ue.appendChild(oe),oe=o.module$build$src$core$utils$xml.createElement("next"),Ue.appendChild(oe),Z.appendChild(Ue),Z=oe}return N=o.module$build$src$core$xml.domToBlock(G,N),this.type==="procedures_defreturn"?N.setFieldValue(this.hasStatements_,"STATEMENTS"):N.removeInput("STATEMENT_INPUT"),o.module$build$src$core$procedures.mutateCallers(this),N},compose:function(N){this.arguments_=[],this.paramIds_=[],this.argumentVarModels_=[];let G=N.getInputTargetBlock("STACK");for(;G&&!G.isInsertionMarker();){var Z=G.getFieldValue("NAME");this.arguments_.push(Z),Z=this.workspace.getVariable(Z,""),this.argumentVarModels_.push(Z),this.paramIds_.push(G.id),G=G.nextConnection&&G.nextConnection.targetBlock()}this.updateParams_(),o.module$build$src$core$procedures.mutateCallers(this),N=N.getFieldValue("STATEMENTS"),N!==null&&(N=N==="TRUE",this.hasStatements_!==N)&&(N?(this.setStatements_(true),o.Mutator$$module$build$src$core$mutator.reconnect(this.statementConnection_,this,"STACK"),this.statementConnection_=null):(N=this.getInput("STACK").connection,(this.statementConnection_=N.targetConnection)&&(N=N.targetBlock(),N.unplug(),N.bumpNeighbours()),this.setStatements_(false)))},getVars:function(){return this.arguments_},getVarModels:function(){return this.argumentVarModels_},renameVarById:function(N,G){var Z=this.workspace.getVariableById(N);if(Z.type===""){Z=Z.name,G=this.workspace.getVariableById(G);var oe=false;for(let ce=0;ce<this.argumentVarModels_.length;ce++)this.argumentVarModels_[ce].getId()===N&&(this.arguments_[ce]=G.name,this.argumentVarModels_[ce]=G,oe=true);oe&&(this.displayRenamedVar_(Z,G.name),o.module$build$src$core$procedures.mutateCallers(this))}},updateVarName:function(N){const G=N.name;let Z=false,oe;for(let ce=0;ce<this.argumentVarModels_.length;ce++)this.argumentVarModels_[ce].getId()===N.getId()&&(oe=this.arguments_[ce],this.arguments_[ce]=G,Z=true);Z&&(this.displayRenamedVar_(oe,G),o.module$build$src$core$procedures.mutateCallers(this))},displayRenamedVar_:function(N,G){if(this.updateParams_(),this.mutator&&this.mutator.isVisible()){const Z=this.mutator.workspace_.getAllBlocks(false);for(let oe=0,ce;ce=Z[oe];oe++)ce.type==="procedures_mutatorarg"&&o.module$build$src$core$names.Names.equals(N,ce.getFieldValue("NAME"))&&ce.setFieldValue(G,"NAME")}},customContextMenu:function(N){if(!this.isInFlyout){var G={enabled:true},Z=this.getFieldValue("NAME");G.text=j.PROCEDURES_CREATE_DO.replace("%1",Z);var oe=o.module$build$src$core$utils$xml.createElement("mutation");for(oe.setAttribute("name",Z),Z=0;Z<this.arguments_.length;Z++){var ce=o.module$build$src$core$utils$xml.createElement("arg");ce.setAttribute("name",this.arguments_[Z]),oe.appendChild(ce)}if(Z=o.module$build$src$core$utils$xml.createElement("block"),Z.setAttribute("type",this.callType_),Z.appendChild(oe),G.callback=o.module$build$src$core$contextmenu.callbackFactory(this,Z),N.push(G),!this.isCollapsed())for(G=0;G<this.argumentVarModels_.length;G++)oe={enabled:true},Z=this.argumentVarModels_[G],oe.text=j.VARIABLES_SET_CREATE_GET.replace("%1",Z.name),Z=o.module$build$src$core$variables.generateVariableFieldDom(Z),ce=o.module$build$src$core$utils$xml.createElement("block"),ce.setAttribute("type","variables_get"),ce.appendChild(Z),oe.callback=o.module$build$src$core$contextmenu.callbackFactory(this,ce),N.push(oe)}}};z.blocks.procedures_defnoreturn=Object.assign({},M,{init:function(){var N=o.module$build$src$core$procedures.findLegalName("",this);N=new o.FieldTextInput$$module$build$src$core$field_textinput(N,o.module$build$src$core$procedures.rename),N.setSpellcheck(false),this.appendDummyInput().appendField(j.PROCEDURES_DEFNORETURN_TITLE).appendField(N,"NAME").appendField("","PARAMS"),this.setMutator(new o.Mutator$$module$build$src$core$mutator(["procedures_mutatorarg"],this)),(this.workspace.options.comments||this.workspace.options.parentWorkspace&&this.workspace.options.parentWorkspace.options.comments)&&j.PROCEDURES_DEFNORETURN_COMMENT&&this.setCommentText(j.PROCEDURES_DEFNORETURN_COMMENT),this.setStyle("procedure_blocks"),this.setTooltip(j.PROCEDURES_DEFNORETURN_TOOLTIP),this.setHelpUrl(j.PROCEDURES_DEFNORETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.setStatements_(true),this.statementConnection_=null},getProcedureDef:function(){return[this.getFieldValue("NAME"),this.arguments_,false]},callType_:"procedures_callnoreturn"}),z.blocks.procedures_defreturn=Object.assign({},M,{init:function(){var N=o.module$build$src$core$procedures.findLegalName("",this);N=new o.FieldTextInput$$module$build$src$core$field_textinput(N,o.module$build$src$core$procedures.rename),N.setSpellcheck(false),this.appendDummyInput().appendField(j.PROCEDURES_DEFRETURN_TITLE).appendField(N,"NAME").appendField("","PARAMS"),this.appendValueInput("RETURN").setAlign(o.Align$$module$build$src$core$input.RIGHT).appendField(j.PROCEDURES_DEFRETURN_RETURN),this.setMutator(new o.Mutator$$module$build$src$core$mutator(["procedures_mutatorarg"],this)),(this.workspace.options.comments||this.workspace.options.parentWorkspace&&this.workspace.options.parentWorkspace.options.comments)&&j.PROCEDURES_DEFRETURN_COMMENT&&this.setCommentText(j.PROCEDURES_DEFRETURN_COMMENT),this.setStyle("procedure_blocks"),this.setTooltip(j.PROCEDURES_DEFRETURN_TOOLTIP),this.setHelpUrl(j.PROCEDURES_DEFRETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.setStatements_(true),this.statementConnection_=null},getProcedureDef:function(){return[this.getFieldValue("NAME"),this.arguments_,true]},callType_:"procedures_callreturn"}),z.blocks.procedures_mutatorcontainer={init:function(){this.appendDummyInput().appendField(j.PROCEDURES_MUTATORCONTAINER_TITLE),this.appendStatementInput("STACK"),this.appendDummyInput("STATEMENT_INPUT").appendField(j.PROCEDURES_ALLOW_STATEMENTS).appendField(new o.FieldCheckbox$$module$build$src$core$field_checkbox("TRUE"),"STATEMENTS"),this.setStyle("procedure_blocks"),this.setTooltip(j.PROCEDURES_MUTATORCONTAINER_TOOLTIP),this.contextMenu=false}},z.blocks.procedures_mutatorarg={init:function(){const N=new o.FieldTextInput$$module$build$src$core$field_textinput(o.module$build$src$core$procedures.DEFAULT_ARG,this.validator_);N.oldShowEditorFn_=N.showEditor_,N.showEditor_=function(){this.createdVariables_=[],this.oldShowEditorFn_()},this.appendDummyInput().appendField(j.PROCEDURES_MUTATORARG_TITLE).appendField(N,"NAME"),this.setPreviousStatement(true),this.setNextStatement(true),this.setStyle("procedure_blocks"),this.setTooltip(j.PROCEDURES_MUTATORARG_TOOLTIP),this.contextMenu=false,N.onFinishEditing_=this.deleteIntermediateVars_,N.createdVariables_=[],N.onFinishEditing_("x")},validator_:function(N){var G=this.getSourceBlock();const Z=o.Mutator$$module$build$src$core$mutator.findParentWs(G.workspace);if(N=N.replace(/[\s\xa0]+/g," ").replace(/^ | $/g,""),!N)return null;const oe=(G.workspace.targetWorkspace||G.workspace).getAllBlocks(false),ce=N.toLowerCase();for(let Ue=0;Ue<oe.length;Ue++){if(oe[Ue].id===this.getSourceBlock().id)continue;const ti=oe[Ue].getFieldValue("NAME");if(ti&&ti.toLowerCase()===ce)return null}return G.isInFlyout||((G=Z.getVariable(N,""))&&G.name!==N&&Z.renameVariableById(G.getId(),N),G||(G=Z.createVariable(N,""))&&this.createdVariables_&&this.createdVariables_.push(G)),N},deleteIntermediateVars_:function(N){const G=o.Mutator$$module$build$src$core$mutator.findParentWs(this.getSourceBlock().workspace);if(G)for(let Z=0;Z<this.createdVariables_.length;Z++){const oe=this.createdVariables_[Z];oe.name!==N&&G.deleteVariableById(oe.getId())}}};var U={getProcedureCall:function(){return this.getFieldValue("NAME")},renameProcedure:function(N,G){o.module$build$src$core$names.Names.equals(N,this.getProcedureCall())&&(this.setFieldValue(G,"NAME"),this.setTooltip((this.outputConnection?j.PROCEDURES_CALLRETURN_TOOLTIP:j.PROCEDURES_CALLNORETURN_TOOLTIP).replace("%1",G)))},setProcedureParameters_:function(N,G){var Z=o.module$build$src$core$procedures.getDefinition(this.getProcedureCall(),this.workspace),oe=Z&&Z.mutator&&Z.mutator.isVisible();if(oe?this.setCollapsed(false):(this.quarkConnections_={},this.quarkIds_=null),N.join(`
`)===this.arguments_.join(`
`))this.quarkIds_=G;else{if(G.length!==N.length)throw RangeError("paramNames and paramIds must be the same length.");this.quarkIds_||(this.quarkConnections_={},this.quarkIds_=[]),Z=this.rendered,this.rendered=false;for(let Ue=0;Ue<this.arguments_.length;Ue++){var ce=this.getInput("ARG"+Ue);ce&&(ce=ce.connection.targetConnection,this.quarkConnections_[this.quarkIds_[Ue]]=ce,oe&&ce&&G.indexOf(this.quarkIds_[Ue])===-1&&(ce.disconnect(),ce.getSourceBlock().bumpNeighbours()))}for(this.arguments_=[].concat(N),this.argumentVarModels_=[],N=0;N<this.arguments_.length;N++)oe=o.module$build$src$core$variables.getOrCreateVariablePackage(this.workspace,null,this.arguments_[N],""),this.argumentVarModels_.push(oe);if(this.updateShape_(),this.quarkIds_=G)for(G=0;G<this.arguments_.length;G++)N=this.quarkIds_[G],N in this.quarkConnections_&&(o.Mutator$$module$build$src$core$mutator.reconnect(this.quarkConnections_[N],this,"ARG"+G)||delete this.quarkConnections_[N]);(this.rendered=Z)&&this.render()}},updateShape_:function(){for(var N=0;N<this.arguments_.length;N++){var G=this.getField("ARGNAME"+N);if(G){o.module$build$src$core$events$events.disable();try{G.setValue(this.arguments_[N])}finally{o.module$build$src$core$events$events.enable()}}else G=new o.FieldLabel$$module$build$src$core$field_label(this.arguments_[N]),this.appendValueInput("ARG"+N).setAlign(o.Align$$module$build$src$core$input.RIGHT).appendField(G,"ARGNAME"+N).init()}for(N=this.arguments_.length;this.getInput("ARG"+N);N++)this.removeInput("ARG"+N);(N=this.getInput("TOPROW"))&&(this.arguments_.length?this.getField("WITH")||(N.appendField(j.PROCEDURES_CALL_BEFORE_PARAMS,"WITH"),N.init()):this.getField("WITH")&&N.removeField("WITH"))},mutationToDom:function(){const N=o.module$build$src$core$utils$xml.createElement("mutation");N.setAttribute("name",this.getProcedureCall());for(let G=0;G<this.arguments_.length;G++){const Z=o.module$build$src$core$utils$xml.createElement("arg");Z.setAttribute("name",this.arguments_[G]),N.appendChild(Z)}return N},domToMutation:function(N){var G=N.getAttribute("name");this.renameProcedure(this.getProcedureCall(),G),G=[];const Z=[];for(let oe=0,ce;ce=N.childNodes[oe];oe++)ce.nodeName.toLowerCase()==="arg"&&(G.push(ce.getAttribute("name")),Z.push(ce.getAttribute("paramId")));this.setProcedureParameters_(G,Z)},saveExtraState:function(){const N=Object.create(null);return N.name=this.getProcedureCall(),this.arguments_.length&&(N.params=this.arguments_),N},loadExtraState:function(N){if(this.renameProcedure(this.getProcedureCall(),N.name),N=N.params){const G=[];G.length=N.length,G.fill(null),this.setProcedureParameters_(N,G)}},getVars:function(){return this.arguments_},getVarModels:function(){return this.argumentVarModels_},onchange:function(N){if(this.workspace&&!this.workspace.isFlyout&&N.recordUndo)if(N.type===o.module$build$src$core$events$events.BLOCK_CREATE&&N.ids.indexOf(this.id)!==-1){var G=this.getProcedureCall();if(G=o.module$build$src$core$procedures.getDefinition(G,this.workspace),!G||G.type===this.defType_&&JSON.stringify(G.getVars())===JSON.stringify(this.arguments_)||(G=null),!G){o.module$build$src$core$events$events.setGroup(N.group),N=o.module$build$src$core$utils$xml.createElement("xml"),G=o.module$build$src$core$utils$xml.createElement("block"),G.setAttribute("type",this.defType_);var Z=this.getRelativeToSurfaceXY(),oe=Z.y+2*o.config$$module$build$src$core$config.snapRadius;G.setAttribute("x",Z.x+o.config$$module$build$src$core$config.snapRadius*(this.RTL?-1:1)),G.setAttribute("y",oe),Z=this.mutationToDom(),G.appendChild(Z),Z=o.module$build$src$core$utils$xml.createElement("field"),Z.setAttribute("name","NAME"),oe=this.getProcedureCall();const ce=o.module$build$src$core$procedures.findLegalName(oe,this);oe!==ce&&this.renameProcedure(oe,ce),Z.appendChild(o.module$build$src$core$utils$xml.createTextNode(oe)),G.appendChild(Z),N.appendChild(G),o.module$build$src$core$xml.domToWorkspace(N,this.workspace),o.module$build$src$core$events$events.setGroup(false)}}else N.type===o.module$build$src$core$events$events.BLOCK_DELETE?(G=this.getProcedureCall(),o.module$build$src$core$procedures.getDefinition(G,this.workspace)||(o.module$build$src$core$events$events.setGroup(N.group),this.dispose(true),o.module$build$src$core$events$events.setGroup(false))):N.type===o.module$build$src$core$events$events.CHANGE&&N.element==="disabled"&&(G=this.getProcedureCall(),(G=o.module$build$src$core$procedures.getDefinition(G,this.workspace))&&G.id===N.blockId&&((G=o.module$build$src$core$events$events.getGroup())&&console.log("Saw an existing group while responding to a definition change"),o.module$build$src$core$events$events.setGroup(N.group),N.newValue?(this.previousEnabledState_=this.isEnabled(),this.setEnabled(false)):this.setEnabled(this.previousEnabledState_),o.module$build$src$core$events$events.setGroup(G)))},customContextMenu:function(N){if(this.workspace.isMovable()){var G={enabled:true};G.text=j.PROCEDURES_HIGHLIGHT_DEF;var Z=this.getProcedureCall(),oe=this.workspace;G.callback=function(){const ce=o.module$build$src$core$procedures.getDefinition(Z,oe);ce&&(oe.centerOnBlock(ce.id),ce.select())},N.push(G)}}};z.blocks.procedures_callnoreturn=Object.assign({},U,{init:function(){this.appendDummyInput("TOPROW").appendField("","NAME"),this.setPreviousStatement(true),this.setNextStatement(true),this.setStyle("procedure_blocks"),this.setHelpUrl(j.PROCEDURES_CALLNORETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.quarkConnections_={},this.quarkIds_=null,this.previousEnabledState_=true},defType_:"procedures_defnoreturn"}),z.blocks.procedures_callreturn=Object.assign({},U,{init:function(){this.appendDummyInput("TOPROW").appendField("","NAME"),this.setOutput(true),this.setStyle("procedure_blocks"),this.setHelpUrl(j.PROCEDURES_CALLRETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.quarkConnections_={},this.quarkIds_=null,this.previousEnabledState_=true},defType_:"procedures_defreturn"}),z.blocks.procedures_ifreturn={init:function(){this.appendValueInput("CONDITION").setCheck("Boolean").appendField(j.CONTROLS_IF_MSG_IF),this.appendValueInput("VALUE").appendField(j.PROCEDURES_DEFRETURN_RETURN),this.setInputsInline(true),this.setPreviousStatement(true),this.setNextStatement(true),this.setStyle("procedure_blocks"),this.setTooltip(j.PROCEDURES_IFRETURN_TOOLTIP),this.setHelpUrl(j.PROCEDURES_IFRETURN_HELPURL),this.hasReturnValue_=true},mutationToDom:function(){const N=o.module$build$src$core$utils$xml.createElement("mutation");return N.setAttribute("value",Number(this.hasReturnValue_)),N},domToMutation:function(N){this.hasReturnValue_=N.getAttribute("value")==="1",this.hasReturnValue_||(this.removeInput("VALUE"),this.appendDummyInput("VALUE").appendField(j.PROCEDURES_DEFRETURN_RETURN))},onchange:function(N){if(!(this.workspace.isDragging&&this.workspace.isDragging()||N.type!==o.module$build$src$core$events$events.BLOCK_MOVE)){var G=false,Z=this;do{if(this.FUNCTION_TYPES.indexOf(Z.type)!==-1){G=true;break}Z=Z.getSurroundParent()}while(Z);G?(Z.type==="procedures_defnoreturn"&&this.hasReturnValue_?(this.removeInput("VALUE"),this.appendDummyInput("VALUE").appendField(j.PROCEDURES_DEFRETURN_RETURN),this.hasReturnValue_=false):Z.type!=="procedures_defreturn"||this.hasReturnValue_||(this.removeInput("VALUE"),this.appendValueInput("VALUE").appendField(j.PROCEDURES_DEFRETURN_RETURN),this.hasReturnValue_=true),this.setWarningText(null)):this.setWarningText(j.PROCEDURES_IFRETURN_WARNING),this.isInFlyout||(Z=o.module$build$src$core$events$events.getGroup(),o.module$build$src$core$events$events.setGroup(N.group),this.setEnabled(G),o.module$build$src$core$events$events.setGroup(Z))}},FUNCTION_TYPES:["procedures_defnoreturn","procedures_defreturn"]},J(z.blocks);var V={};o.module$build$src$core$extensions,o.module$build$src$core$field_dropdown,o.module$build$src$core$utils$xml;var K=o.module$build$src$core$common.createBlockDefinitionsFromJsonArray,H=o.module$build$src$core$common.defineBlocks;V.blocks=K([{type:"math_number",message0:"%1",args0:[{type:"field_number",name:"NUM",value:0}],output:"Number",helpUrl:"%{BKY_MATH_NUMBER_HELPURL}",style:"math_blocks",tooltip:"%{BKY_MATH_NUMBER_TOOLTIP}",extensions:["parent_tooltip_when_inline"]},{type:"math_arithmetic",message0:"%1 %2 %3",args0:[{type:"input_value",name:"A",check:"Number"},{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_ADDITION_SYMBOL}","ADD"],["%{BKY_MATH_SUBTRACTION_SYMBOL}","MINUS"],["%{BKY_MATH_MULTIPLICATION_SYMBOL}","MULTIPLY"],["%{BKY_MATH_DIVISION_SYMBOL}","DIVIDE"],["%{BKY_MATH_POWER_SYMBOL}","POWER"]]},{type:"input_value",name:"B",check:"Number"}],inputsInline:true,output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_ARITHMETIC_HELPURL}",extensions:["math_op_tooltip"]},{type:"math_single",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_SINGLE_OP_ROOT}","ROOT"],["%{BKY_MATH_SINGLE_OP_ABSOLUTE}","ABS"],["-","NEG"],["ln","LN"],["log10","LOG10"],["e^","EXP"],["10^","POW10"]]},{type:"input_value",name:"NUM",check:"Number"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_SINGLE_HELPURL}",extensions:["math_op_tooltip"]},{type:"math_trig",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_TRIG_SIN}","SIN"],["%{BKY_MATH_TRIG_COS}","COS"],["%{BKY_MATH_TRIG_TAN}","TAN"],["%{BKY_MATH_TRIG_ASIN}","ASIN"],["%{BKY_MATH_TRIG_ACOS}","ACOS"],["%{BKY_MATH_TRIG_ATAN}","ATAN"]]},{type:"input_value",name:"NUM",check:"Number"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_TRIG_HELPURL}",extensions:["math_op_tooltip"]},{type:"math_constant",message0:"%1",args0:[{type:"field_dropdown",name:"CONSTANT",options:[["π","PI"],["e","E"],["φ","GOLDEN_RATIO"],["sqrt(2)","SQRT2"],["sqrt(½)","SQRT1_2"],["∞","INFINITY"]]}],output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_CONSTANT_TOOLTIP}",helpUrl:"%{BKY_MATH_CONSTANT_HELPURL}"},{type:"math_number_property",message0:"%1 %2",args0:[{type:"input_value",name:"NUMBER_TO_CHECK",check:"Number"},{type:"field_dropdown",name:"PROPERTY",options:[["%{BKY_MATH_IS_EVEN}","EVEN"],["%{BKY_MATH_IS_ODD}","ODD"],["%{BKY_MATH_IS_PRIME}","PRIME"],["%{BKY_MATH_IS_WHOLE}","WHOLE"],["%{BKY_MATH_IS_POSITIVE}","POSITIVE"],["%{BKY_MATH_IS_NEGATIVE}","NEGATIVE"],["%{BKY_MATH_IS_DIVISIBLE_BY}","DIVISIBLE_BY"]]}],inputsInline:true,output:"Boolean",style:"math_blocks",tooltip:"%{BKY_MATH_IS_TOOLTIP}",mutator:"math_is_divisibleby_mutator"},{type:"math_change",message0:"%{BKY_MATH_CHANGE_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_MATH_CHANGE_TITLE_ITEM}"},{type:"input_value",name:"DELTA",check:"Number"}],previousStatement:null,nextStatement:null,style:"variable_blocks",helpUrl:"%{BKY_MATH_CHANGE_HELPURL}",extensions:["math_change_tooltip"]},{type:"math_round",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_ROUND_OPERATOR_ROUND}","ROUND"],["%{BKY_MATH_ROUND_OPERATOR_ROUNDUP}","ROUNDUP"],["%{BKY_MATH_ROUND_OPERATOR_ROUNDDOWN}","ROUNDDOWN"]]},{type:"input_value",name:"NUM",check:"Number"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_ROUND_HELPURL}",tooltip:"%{BKY_MATH_ROUND_TOOLTIP}"},{type:"math_on_list",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_ONLIST_OPERATOR_SUM}","SUM"],["%{BKY_MATH_ONLIST_OPERATOR_MIN}","MIN"],["%{BKY_MATH_ONLIST_OPERATOR_MAX}","MAX"],["%{BKY_MATH_ONLIST_OPERATOR_AVERAGE}","AVERAGE"],["%{BKY_MATH_ONLIST_OPERATOR_MEDIAN}","MEDIAN"],["%{BKY_MATH_ONLIST_OPERATOR_MODE}","MODE"],["%{BKY_MATH_ONLIST_OPERATOR_STD_DEV}","STD_DEV"],["%{BKY_MATH_ONLIST_OPERATOR_RANDOM}","RANDOM"]]},{type:"input_value",name:"LIST",check:"Array"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_ONLIST_HELPURL}",mutator:"math_modes_of_list_mutator",extensions:["math_op_tooltip"]},{type:"math_modulo",message0:"%{BKY_MATH_MODULO_TITLE}",args0:[{type:"input_value",name:"DIVIDEND",check:"Number"},{type:"input_value",name:"DIVISOR",check:"Number"}],inputsInline:true,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_MODULO_TOOLTIP}",helpUrl:"%{BKY_MATH_MODULO_HELPURL}"},{type:"math_constrain",message0:"%{BKY_MATH_CONSTRAIN_TITLE}",args0:[{type:"input_value",name:"VALUE",check:"Number"},{type:"input_value",name:"LOW",check:"Number"},{type:"input_value",name:"HIGH",check:"Number"}],inputsInline:true,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_CONSTRAIN_TOOLTIP}",helpUrl:"%{BKY_MATH_CONSTRAIN_HELPURL}"},{type:"math_random_int",message0:"%{BKY_MATH_RANDOM_INT_TITLE}",args0:[{type:"input_value",name:"FROM",check:"Number"},{type:"input_value",name:"TO",check:"Number"}],inputsInline:true,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_RANDOM_INT_TOOLTIP}",helpUrl:"%{BKY_MATH_RANDOM_INT_HELPURL}"},{type:"math_random_float",message0:"%{BKY_MATH_RANDOM_FLOAT_TITLE_RANDOM}",output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_RANDOM_FLOAT_TOOLTIP}",helpUrl:"%{BKY_MATH_RANDOM_FLOAT_HELPURL}"},{type:"math_atan2",message0:"%{BKY_MATH_ATAN2_TITLE}",args0:[{type:"input_value",name:"X",check:"Number"},{type:"input_value",name:"Y",check:"Number"}],inputsInline:true,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_ATAN2_TOOLTIP}",helpUrl:"%{BKY_MATH_ATAN2_HELPURL}"}]);var ie={ADD:"%{BKY_MATH_ARITHMETIC_TOOLTIP_ADD}",MINUS:"%{BKY_MATH_ARITHMETIC_TOOLTIP_MINUS}",MULTIPLY:"%{BKY_MATH_ARITHMETIC_TOOLTIP_MULTIPLY}",DIVIDE:"%{BKY_MATH_ARITHMETIC_TOOLTIP_DIVIDE}",POWER:"%{BKY_MATH_ARITHMETIC_TOOLTIP_POWER}",ROOT:"%{BKY_MATH_SINGLE_TOOLTIP_ROOT}",ABS:"%{BKY_MATH_SINGLE_TOOLTIP_ABS}",NEG:"%{BKY_MATH_SINGLE_TOOLTIP_NEG}",LN:"%{BKY_MATH_SINGLE_TOOLTIP_LN}",LOG10:"%{BKY_MATH_SINGLE_TOOLTIP_LOG10}",EXP:"%{BKY_MATH_SINGLE_TOOLTIP_EXP}",POW10:"%{BKY_MATH_SINGLE_TOOLTIP_POW10}",SIN:"%{BKY_MATH_TRIG_TOOLTIP_SIN}",COS:"%{BKY_MATH_TRIG_TOOLTIP_COS}",TAN:"%{BKY_MATH_TRIG_TOOLTIP_TAN}",ASIN:"%{BKY_MATH_TRIG_TOOLTIP_ASIN}",ACOS:"%{BKY_MATH_TRIG_TOOLTIP_ACOS}",ATAN:"%{BKY_MATH_TRIG_TOOLTIP_ATAN}",SUM:"%{BKY_MATH_ONLIST_TOOLTIP_SUM}",MIN:"%{BKY_MATH_ONLIST_TOOLTIP_MIN}",MAX:"%{BKY_MATH_ONLIST_TOOLTIP_MAX}",AVERAGE:"%{BKY_MATH_ONLIST_TOOLTIP_AVERAGE}",MEDIAN:"%{BKY_MATH_ONLIST_TOOLTIP_MEDIAN}",MODE:"%{BKY_MATH_ONLIST_TOOLTIP_MODE}",STD_DEV:"%{BKY_MATH_ONLIST_TOOLTIP_STD_DEV}",RANDOM:"%{BKY_MATH_ONLIST_TOOLTIP_RANDOM}"};o.module$build$src$core$extensions.register("math_op_tooltip",o.module$build$src$core$extensions.buildTooltipForDropdown("OP",ie));var Ie={mutationToDom:function(){const N=o.module$build$src$core$utils$xml.createElement("mutation"),G=this.getFieldValue("PROPERTY")==="DIVISIBLE_BY";return N.setAttribute("divisor_input",G),N},domToMutation:function(N){N=N.getAttribute("divisor_input")==="true",this.updateShape_(N)},updateShape_:function(N){const G=this.getInput("DIVISOR");N?G||this.appendValueInput("DIVISOR").setCheck("Number"):G&&this.removeInput("DIVISOR")}},he=function(){this.getField("PROPERTY").setValidator(function(N){N=N==="DIVISIBLE_BY",this.getSourceBlock().updateShape_(N)})};o.module$build$src$core$extensions.registerMutator("math_is_divisibleby_mutator",Ie,he),o.module$build$src$core$extensions.register("math_change_tooltip",o.module$build$src$core$extensions.buildTooltipWithFieldText("%{BKY_MATH_CHANGE_TOOLTIP}","VAR"));var st={updateType_:function(N){N==="MODE"?this.outputConnection.setCheck("Array"):this.outputConnection.setCheck("Number")},mutationToDom:function(){const N=o.module$build$src$core$utils$xml.createElement("mutation");return N.setAttribute("op",this.getFieldValue("OP")),N},domToMutation:function(N){this.updateType_(N.getAttribute("op"))}},B=function(){this.getField("OP").setValidator(function(N){this.updateType_(N)}.bind(this))};o.module$build$src$core$extensions.registerMutator("math_modes_of_list_mutator",st,B),H(V.blocks);var te={};o.module$build$src$core$contextmenu,o.module$build$src$core$events$events,o.module$build$src$core$extensions,o.module$build$src$core$variables,o.module$build$src$core$utils$xml;var le=o.module$build$src$core$msg.Msg,ae=o.module$build$src$core$common.createBlockDefinitionsFromJsonArray,Me=o.module$build$src$core$common.defineBlocks;te.blocks=ae([{type:"controls_repeat_ext",message0:"%{BKY_CONTROLS_REPEAT_TITLE}",args0:[{type:"input_value",name:"TIMES",check:"Number"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",tooltip:"%{BKY_CONTROLS_REPEAT_TOOLTIP}",helpUrl:"%{BKY_CONTROLS_REPEAT_HELPURL}"},{type:"controls_repeat",message0:"%{BKY_CONTROLS_REPEAT_TITLE}",args0:[{type:"field_number",name:"TIMES",value:10,min:0,precision:1}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",tooltip:"%{BKY_CONTROLS_REPEAT_TOOLTIP}",helpUrl:"%{BKY_CONTROLS_REPEAT_HELPURL}"},{type:"controls_whileUntil",message0:"%1 %2",args0:[{type:"field_dropdown",name:"MODE",options:[["%{BKY_CONTROLS_WHILEUNTIL_OPERATOR_WHILE}","WHILE"],["%{BKY_CONTROLS_WHILEUNTIL_OPERATOR_UNTIL}","UNTIL"]]},{type:"input_value",name:"BOOL",check:"Boolean"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_WHILEUNTIL_HELPURL}",extensions:["controls_whileUntil_tooltip"]},{type:"controls_for",message0:"%{BKY_CONTROLS_FOR_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:null},{type:"input_value",name:"FROM",check:"Number",align:"RIGHT"},{type:"input_value",name:"TO",check:"Number",align:"RIGHT"},{type:"input_value",name:"BY",check:"Number",align:"RIGHT"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],inputsInline:true,previousStatement:null,nextStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_FOR_HELPURL}",extensions:["contextMenu_newGetVariableBlock","controls_for_tooltip"]},{type:"controls_forEach",message0:"%{BKY_CONTROLS_FOREACH_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:null},{type:"input_value",name:"LIST",check:"Array"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_FOREACH_HELPURL}",extensions:["contextMenu_newGetVariableBlock","controls_forEach_tooltip"]},{type:"controls_flow_statements",message0:"%1",args0:[{type:"field_dropdown",name:"FLOW",options:[["%{BKY_CONTROLS_FLOW_STATEMENTS_OPERATOR_BREAK}","BREAK"],["%{BKY_CONTROLS_FLOW_STATEMENTS_OPERATOR_CONTINUE}","CONTINUE"]]}],previousStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_FLOW_STATEMENTS_HELPURL}",suppressPrefixSuffix:true,extensions:["controls_flow_tooltip","controls_flow_in_loop_check"]}]);var Se={WHILE:"%{BKY_CONTROLS_WHILEUNTIL_TOOLTIP_WHILE}",UNTIL:"%{BKY_CONTROLS_WHILEUNTIL_TOOLTIP_UNTIL}"};o.module$build$src$core$extensions.register("controls_whileUntil_tooltip",o.module$build$src$core$extensions.buildTooltipForDropdown("MODE",Se));var nt={BREAK:"%{BKY_CONTROLS_FLOW_STATEMENTS_TOOLTIP_BREAK}",CONTINUE:"%{BKY_CONTROLS_FLOW_STATEMENTS_TOOLTIP_CONTINUE}"};o.module$build$src$core$extensions.register("controls_flow_tooltip",o.module$build$src$core$extensions.buildTooltipForDropdown("FLOW",nt));var St={customContextMenu:function(N){if(!this.isInFlyout){var G=this.getField("VAR").getVariable(),Z=G.name;if(!this.isCollapsed()&&Z!==null){const oe={enabled:true};oe.text=le.VARIABLES_SET_CREATE_GET.replace("%1",Z),G=o.module$build$src$core$variables.generateVariableFieldDom(G),Z=o.module$build$src$core$utils$xml.createElement("block"),Z.setAttribute("type","variables_get"),Z.appendChild(G),oe.callback=o.module$build$src$core$contextmenu.callbackFactory(this,Z),N.push(oe)}}}};o.module$build$src$core$extensions.registerMixin("contextMenu_newGetVariableBlock",St),o.module$build$src$core$extensions.register("controls_for_tooltip",o.module$build$src$core$extensions.buildTooltipWithFieldText("%{BKY_CONTROLS_FOR_TOOLTIP}","VAR")),o.module$build$src$core$extensions.register("controls_forEach_tooltip",o.module$build$src$core$extensions.buildTooltipWithFieldText("%{BKY_CONTROLS_FOREACH_TOOLTIP}","VAR")),te.loopTypes=new Set(["controls_repeat","controls_repeat_ext","controls_forEach","controls_for","controls_whileUntil"]);var Ut={getSurroundLoop:function(){let N=this;do{if(te.loopTypes.has(N.type))return N;N=N.getSurroundParent()}while(N);return null},onchange:function(N){if(this.workspace.isDragging&&!this.workspace.isDragging()&&N.type===o.module$build$src$core$events$events.BLOCK_MOVE){var G=this.getSurroundLoop(this);if(this.setWarningText(G?null:le.CONTROLS_FLOW_STATEMENTS_WARNING),!this.isInFlyout){const Z=o.module$build$src$core$events$events.getGroup();o.module$build$src$core$events$events.setGroup(N.group),this.setEnabled(G),o.module$build$src$core$events$events.setGroup(Z)}}}};o.module$build$src$core$extensions.registerMixin("controls_flow_in_loop_check",Ut),Me(te.blocks);var Jt={};o.module$build$src$core$events$events,o.module$build$src$core$extensions,o.module$build$src$core$utils$xml;var We=o.module$build$src$core$msg.Msg;o.Mutator$$module$build$src$core$mutator;var Is=o.module$build$src$core$common.createBlockDefinitionsFromJsonArray,Cs=o.module$build$src$core$common.defineBlocks;Jt.blocks=Is([{type:"logic_boolean",message0:"%1",args0:[{type:"field_dropdown",name:"BOOL",options:[["%{BKY_LOGIC_BOOLEAN_TRUE}","TRUE"],["%{BKY_LOGIC_BOOLEAN_FALSE}","FALSE"]]}],output:"Boolean",style:"logic_blocks",tooltip:"%{BKY_LOGIC_BOOLEAN_TOOLTIP}",helpUrl:"%{BKY_LOGIC_BOOLEAN_HELPURL}"},{type:"controls_if",message0:"%{BKY_CONTROLS_IF_MSG_IF} %1",args0:[{type:"input_value",name:"IF0",check:"Boolean"}],message1:"%{BKY_CONTROLS_IF_MSG_THEN} %1",args1:[{type:"input_statement",name:"DO0"}],previousStatement:null,nextStatement:null,style:"logic_blocks",helpUrl:"%{BKY_CONTROLS_IF_HELPURL}",suppressPrefixSuffix:true,mutator:"controls_if_mutator",extensions:["controls_if_tooltip"]},{type:"controls_ifelse",message0:"%{BKY_CONTROLS_IF_MSG_IF} %1",args0:[{type:"input_value",name:"IF0",check:"Boolean"}],message1:"%{BKY_CONTROLS_IF_MSG_THEN} %1",args1:[{type:"input_statement",name:"DO0"}],message2:"%{BKY_CONTROLS_IF_MSG_ELSE} %1",args2:[{type:"input_statement",name:"ELSE"}],previousStatement:null,nextStatement:null,style:"logic_blocks",tooltip:"%{BKYCONTROLS_IF_TOOLTIP_2}",helpUrl:"%{BKY_CONTROLS_IF_HELPURL}",suppressPrefixSuffix:true,extensions:["controls_if_tooltip"]},{type:"logic_compare",message0:"%1 %2 %3",args0:[{type:"input_value",name:"A"},{type:"field_dropdown",name:"OP",options:[["=","EQ"],["≠","NEQ"],["‏<","LT"],["‏≤","LTE"],["‏>","GT"],["‏≥","GTE"]]},{type:"input_value",name:"B"}],inputsInline:true,output:"Boolean",style:"logic_blocks",helpUrl:"%{BKY_LOGIC_COMPARE_HELPURL}",extensions:["logic_compare","logic_op_tooltip"]},{type:"logic_operation",message0:"%1 %2 %3",args0:[{type:"input_value",name:"A",check:"Boolean"},{type:"field_dropdown",name:"OP",options:[["%{BKY_LOGIC_OPERATION_AND}","AND"],["%{BKY_LOGIC_OPERATION_OR}","OR"]]},{type:"input_value",name:"B",check:"Boolean"}],inputsInline:true,output:"Boolean",style:"logic_blocks",helpUrl:"%{BKY_LOGIC_OPERATION_HELPURL}",extensions:["logic_op_tooltip"]},{type:"logic_negate",message0:"%{BKY_LOGIC_NEGATE_TITLE}",args0:[{type:"input_value",name:"BOOL",check:"Boolean"}],output:"Boolean",style:"logic_blocks",tooltip:"%{BKY_LOGIC_NEGATE_TOOLTIP}",helpUrl:"%{BKY_LOGIC_NEGATE_HELPURL}"},{type:"logic_null",message0:"%{BKY_LOGIC_NULL}",output:null,style:"logic_blocks",tooltip:"%{BKY_LOGIC_NULL_TOOLTIP}",helpUrl:"%{BKY_LOGIC_NULL_HELPURL}"},{type:"logic_ternary",message0:"%{BKY_LOGIC_TERNARY_CONDITION} %1",args0:[{type:"input_value",name:"IF",check:"Boolean"}],message1:"%{BKY_LOGIC_TERNARY_IF_TRUE} %1",args1:[{type:"input_value",name:"THEN"}],message2:"%{BKY_LOGIC_TERNARY_IF_FALSE} %1",args2:[{type:"input_value",name:"ELSE"}],output:null,style:"logic_blocks",tooltip:"%{BKY_LOGIC_TERNARY_TOOLTIP}",helpUrl:"%{BKY_LOGIC_TERNARY_HELPURL}",extensions:["logic_ternary"]},{type:"controls_if_if",message0:"%{BKY_CONTROLS_IF_IF_TITLE_IF}",nextStatement:null,enableContextMenu:false,style:"logic_blocks",tooltip:"%{BKY_CONTROLS_IF_IF_TOOLTIP}"},{type:"controls_if_elseif",message0:"%{BKY_CONTROLS_IF_ELSEIF_TITLE_ELSEIF}",previousStatement:null,nextStatement:null,enableContextMenu:false,style:"logic_blocks",tooltip:"%{BKY_CONTROLS_IF_ELSEIF_TOOLTIP}"},{type:"controls_if_else",message0:"%{BKY_CONTROLS_IF_ELSE_TITLE_ELSE}",previousStatement:null,enableContextMenu:false,style:"logic_blocks",tooltip:"%{BKY_CONTROLS_IF_ELSE_TOOLTIP}"}]);var Os={EQ:"%{BKY_LOGIC_COMPARE_TOOLTIP_EQ}",NEQ:"%{BKY_LOGIC_COMPARE_TOOLTIP_NEQ}",LT:"%{BKY_LOGIC_COMPARE_TOOLTIP_LT}",LTE:"%{BKY_LOGIC_COMPARE_TOOLTIP_LTE}",GT:"%{BKY_LOGIC_COMPARE_TOOLTIP_GT}",GTE:"%{BKY_LOGIC_COMPARE_TOOLTIP_GTE}",AND:"%{BKY_LOGIC_OPERATION_TOOLTIP_AND}",OR:"%{BKY_LOGIC_OPERATION_TOOLTIP_OR}"};o.module$build$src$core$extensions.register("logic_op_tooltip",o.module$build$src$core$extensions.buildTooltipForDropdown("OP",Os));var xs={elseifCount_:0,elseCount_:0,mutationToDom:function(){if(!this.elseifCount_&&!this.elseCount_)return null;const N=o.module$build$src$core$utils$xml.createElement("mutation");return this.elseifCount_&&N.setAttribute("elseif",this.elseifCount_),this.elseCount_&&N.setAttribute("else",1),N},domToMutation:function(N){this.elseifCount_=parseInt(N.getAttribute("elseif"),10)||0,this.elseCount_=parseInt(N.getAttribute("else"),10)||0,this.rebuildShape_()},saveExtraState:function(){if(!this.elseifCount_&&!this.elseCount_)return null;const N=Object.create(null);return this.elseifCount_&&(N.elseIfCount=this.elseifCount_),this.elseCount_&&(N.hasElse=true),N},loadExtraState:function(N){this.elseifCount_=N.elseIfCount||0,this.elseCount_=N.hasElse?1:0,this.updateShape_()},decompose:function(N){const G=N.newBlock("controls_if_if");G.initSvg();let Z=G.nextConnection;for(let oe=1;oe<=this.elseifCount_;oe++){const ce=N.newBlock("controls_if_elseif");ce.initSvg(),Z.connect(ce.previousConnection),Z=ce.nextConnection}return this.elseCount_&&(N=N.newBlock("controls_if_else"),N.initSvg(),Z.connect(N.previousConnection)),G},compose:function(N){N=N.nextConnection.targetBlock(),this.elseCount_=this.elseifCount_=0;const G=[null],Z=[null];let oe=null;for(;N;){if(!N.isInsertionMarker())switch(N.type){case"controls_if_elseif":this.elseifCount_++,G.push(N.valueConnection_),Z.push(N.statementConnection_);break;case"controls_if_else":this.elseCount_++,oe=N.statementConnection_;break;default:throw TypeError("Unknown block type: "+N.type)}N=N.getNextBlock()}this.updateShape_(),this.reconnectChildBlocks_(G,Z,oe)},saveConnections:function(N){N=N.nextConnection.targetBlock();let G=1;for(;N;){if(!N.isInsertionMarker())switch(N.type){case"controls_if_elseif":var Z=this.getInput("IF"+G);const oe=this.getInput("DO"+G);N.valueConnection_=Z&&Z.connection.targetConnection,N.statementConnection_=oe&&oe.connection.targetConnection,G++;break;case"controls_if_else":Z=this.getInput("ELSE"),N.statementConnection_=Z&&Z.connection.targetConnection;break;default:throw TypeError("Unknown block type: "+N.type)}N=N.getNextBlock()}},rebuildShape_:function(){const N=[null],G=[null];let Z=null;this.getInput("ELSE")&&(Z=this.getInput("ELSE").connection.targetConnection);for(let oe=1;this.getInput("IF"+oe);oe++){const ce=this.getInput("IF"+oe),Ue=this.getInput("DO"+oe);N.push(ce.connection.targetConnection),G.push(Ue.connection.targetConnection)}this.updateShape_(),this.reconnectChildBlocks_(N,G,Z)},updateShape_:function(){this.getInput("ELSE")&&this.removeInput("ELSE");for(var N=1;this.getInput("IF"+N);N++)this.removeInput("IF"+N),this.removeInput("DO"+N);for(N=1;N<=this.elseifCount_;N++)this.appendValueInput("IF"+N).setCheck("Boolean").appendField(We.CONTROLS_IF_MSG_ELSEIF),this.appendStatementInput("DO"+N).appendField(We.CONTROLS_IF_MSG_THEN);this.elseCount_&&this.appendStatementInput("ELSE").appendField(We.CONTROLS_IF_MSG_ELSE)},reconnectChildBlocks_:function(N,G,Z){for(let oe=1;oe<=this.elseifCount_;oe++)o.Mutator$$module$build$src$core$mutator.reconnect(N[oe],this,"IF"+oe),o.Mutator$$module$build$src$core$mutator.reconnect(G[oe],this,"DO"+oe);o.Mutator$$module$build$src$core$mutator.reconnect(Z,this,"ELSE")}};o.module$build$src$core$extensions.registerMutator("controls_if_mutator",xs,null,["controls_if_elseif","controls_if_else"]);var Ws=function(){this.setTooltip(function(){if(this.elseifCount_||this.elseCount_){if(!this.elseifCount_&&this.elseCount_)return We.CONTROLS_IF_TOOLTIP_2;if(this.elseifCount_&&!this.elseCount_)return We.CONTROLS_IF_TOOLTIP_3;if(this.elseifCount_&&this.elseCount_)return We.CONTROLS_IF_TOOLTIP_4}else return We.CONTROLS_IF_TOOLTIP_1;return""}.bind(this))};o.module$build$src$core$extensions.register("controls_if_tooltip",Ws);var At={onchange:function(N){this.prevBlocks_||(this.prevBlocks_=[null,null]);var G=this.getInputTargetBlock("A");const Z=this.getInputTargetBlock("B");G&&Z&&!this.workspace.connectionChecker.doTypeChecks(G.outputConnection,Z.outputConnection)&&(o.module$build$src$core$events$events.setGroup(N.group),N=this.prevBlocks_[0],N!==G&&(G.unplug(),!N||N.isDisposed()||N.isShadow()||this.getInput("A").connection.connect(N.outputConnection)),G=this.prevBlocks_[1],G!==Z&&(Z.unplug(),!G||G.isDisposed()||G.isShadow()||this.getInput("B").connection.connect(G.outputConnection)),this.bumpNeighbours(),o.module$build$src$core$events$events.setGroup(false)),this.prevBlocks_[0]=this.getInputTargetBlock("A"),this.prevBlocks_[1]=this.getInputTargetBlock("B")}},be=function(){this.mixin(At)};o.module$build$src$core$extensions.register("logic_compare",be);var qe={prevParentConnection_:null,onchange:function(N){const G=this.getInputTargetBlock("THEN"),Z=this.getInputTargetBlock("ELSE"),oe=this.outputConnection.targetConnection;if((G||Z)&&oe)for(let ce=0;2>ce;ce++){const Ue=ce===1?G:Z;Ue&&!Ue.workspace.connectionChecker.doTypeChecks(Ue.outputConnection,oe)&&(o.module$build$src$core$events$events.setGroup(N.group),oe===this.prevParentConnection_?(this.unplug(),oe.getSourceBlock().bumpNeighbours()):(Ue.unplug(),Ue.bumpNeighbours()),o.module$build$src$core$events$events.setGroup(false))}this.prevParentConnection_=oe}};o.module$build$src$core$extensions.registerMixin("logic_ternary",qe),Cs(Jt.blocks);var ut={};o.module$build$src$core$utils$xml,o.module$build$src$core$xml,o.Align$$module$build$src$core$input,o.module$build$src$core$connection_type.ConnectionType;var jt=o.module$build$src$core$field_dropdown.FieldDropdown,Ee=o.module$build$src$core$msg.Msg;o.Mutator$$module$build$src$core$mutator;var fi=o.module$build$src$core$common.createBlockDefinitionsFromJsonArray,fs=o.module$build$src$core$common.defineBlocks;ut.blocks=fi([{type:"lists_create_empty",message0:"%{BKY_LISTS_CREATE_EMPTY_TITLE}",output:"Array",style:"list_blocks",tooltip:"%{BKY_LISTS_CREATE_EMPTY_TOOLTIP}",helpUrl:"%{BKY_LISTS_CREATE_EMPTY_HELPURL}"},{type:"lists_repeat",message0:"%{BKY_LISTS_REPEAT_TITLE}",args0:[{type:"input_value",name:"ITEM"},{type:"input_value",name:"NUM",check:"Number"}],output:"Array",style:"list_blocks",tooltip:"%{BKY_LISTS_REPEAT_TOOLTIP}",helpUrl:"%{BKY_LISTS_REPEAT_HELPURL}"},{type:"lists_reverse",message0:"%{BKY_LISTS_REVERSE_MESSAGE0}",args0:[{type:"input_value",name:"LIST",check:"Array"}],output:"Array",inputsInline:true,style:"list_blocks",tooltip:"%{BKY_LISTS_REVERSE_TOOLTIP}",helpUrl:"%{BKY_LISTS_REVERSE_HELPURL}"},{type:"lists_isEmpty",message0:"%{BKY_LISTS_ISEMPTY_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Boolean",style:"list_blocks",tooltip:"%{BKY_LISTS_ISEMPTY_TOOLTIP}",helpUrl:"%{BKY_LISTS_ISEMPTY_HELPURL}"},{type:"lists_length",message0:"%{BKY_LISTS_LENGTH_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Number",style:"list_blocks",tooltip:"%{BKY_LISTS_LENGTH_TOOLTIP}",helpUrl:"%{BKY_LISTS_LENGTH_HELPURL}"}]),ut.blocks.lists_create_with={init:function(){this.setHelpUrl(Ee.LISTS_CREATE_WITH_HELPURL),this.setStyle("list_blocks"),this.itemCount_=3,this.updateShape_(),this.setOutput(true,"Array"),this.setMutator(new o.Mutator$$module$build$src$core$mutator(["lists_create_with_item"],this)),this.setTooltip(Ee.LISTS_CREATE_WITH_TOOLTIP)},mutationToDom:function(){const N=o.module$build$src$core$utils$xml.createElement("mutation");return N.setAttribute("items",this.itemCount_),N},domToMutation:function(N){this.itemCount_=parseInt(N.getAttribute("items"),10),this.updateShape_()},saveExtraState:function(){return{itemCount:this.itemCount_}},loadExtraState:function(N){this.itemCount_=N.itemCount,this.updateShape_()},decompose:function(N){const G=N.newBlock("lists_create_with_container");G.initSvg();let Z=G.getInput("STACK").connection;for(let oe=0;oe<this.itemCount_;oe++){const ce=N.newBlock("lists_create_with_item");ce.initSvg(),Z.connect(ce.previousConnection),Z=ce.nextConnection}return G},compose:function(N){var G=N.getInputTargetBlock("STACK");for(N=[];G;)G.isInsertionMarker()||N.push(G.valueConnection_),G=G.getNextBlock();for(G=0;G<this.itemCount_;G++){const Z=this.getInput("ADD"+G).connection.targetConnection;Z&&N.indexOf(Z)===-1&&Z.disconnect()}for(this.itemCount_=N.length,this.updateShape_(),G=0;G<this.itemCount_;G++)o.Mutator$$module$build$src$core$mutator.reconnect(N[G],this,"ADD"+G)},saveConnections:function(N){N=N.getInputTargetBlock("STACK");let G=0;for(;N;){if(N.isInsertionMarker()){N=N.getNextBlock();continue}const Z=this.getInput("ADD"+G);N.valueConnection_=Z&&Z.connection.targetConnection,N=N.getNextBlock(),G++}},updateShape_:function(){this.itemCount_&&this.getInput("EMPTY")?this.removeInput("EMPTY"):this.itemCount_||this.getInput("EMPTY")||this.appendDummyInput("EMPTY").appendField(Ee.LISTS_CREATE_EMPTY_TITLE);for(var N=0;N<this.itemCount_;N++)if(!this.getInput("ADD"+N)){const G=this.appendValueInput("ADD"+N).setAlign(o.Align$$module$build$src$core$input.RIGHT);N===0&&G.appendField(Ee.LISTS_CREATE_WITH_INPUT_WITH)}for(N=this.itemCount_;this.getInput("ADD"+N);N++)this.removeInput("ADD"+N)}},ut.blocks.lists_create_with_container={init:function(){this.setStyle("list_blocks"),this.appendDummyInput().appendField(Ee.LISTS_CREATE_WITH_CONTAINER_TITLE_ADD),this.appendStatementInput("STACK"),this.setTooltip(Ee.LISTS_CREATE_WITH_CONTAINER_TOOLTIP),this.contextMenu=false}},ut.blocks.lists_create_with_item={init:function(){this.setStyle("list_blocks"),this.appendDummyInput().appendField(Ee.LISTS_CREATE_WITH_ITEM_TITLE),this.setPreviousStatement(true),this.setNextStatement(true),this.setTooltip(Ee.LISTS_CREATE_WITH_ITEM_TOOLTIP),this.contextMenu=false}},ut.blocks.lists_indexOf={init:function(){const N=[[Ee.LISTS_INDEX_OF_FIRST,"FIRST"],[Ee.LISTS_INDEX_OF_LAST,"LAST"]];this.setHelpUrl(Ee.LISTS_INDEX_OF_HELPURL),this.setStyle("list_blocks"),this.setOutput(true,"Number"),this.appendValueInput("VALUE").setCheck("Array").appendField(Ee.LISTS_INDEX_OF_INPUT_IN_LIST),this.appendValueInput("FIND").appendField(new jt(N),"END"),this.setInputsInline(true);const G=this;this.setTooltip(function(){return Ee.LISTS_INDEX_OF_TOOLTIP.replace("%1",G.workspace.options.oneBasedIndex?"0":"-1")})}},ut.blocks.lists_getIndex={init:function(){var N=[[Ee.LISTS_GET_INDEX_GET,"GET"],[Ee.LISTS_GET_INDEX_GET_REMOVE,"GET_REMOVE"],[Ee.LISTS_GET_INDEX_REMOVE,"REMOVE"]];this.WHERE_OPTIONS=[[Ee.LISTS_GET_INDEX_FROM_START,"FROM_START"],[Ee.LISTS_GET_INDEX_FROM_END,"FROM_END"],[Ee.LISTS_GET_INDEX_FIRST,"FIRST"],[Ee.LISTS_GET_INDEX_LAST,"LAST"],[Ee.LISTS_GET_INDEX_RANDOM,"RANDOM"]],this.setHelpUrl(Ee.LISTS_GET_INDEX_HELPURL),this.setStyle("list_blocks"),N=new jt(N,function(Z){Z=Z==="REMOVE",this.getSourceBlock().updateStatement_(Z)}),this.appendValueInput("VALUE").setCheck("Array").appendField(Ee.LISTS_GET_INDEX_INPUT_IN_LIST),this.appendDummyInput().appendField(N,"MODE").appendField("","SPACE"),this.appendDummyInput("AT"),Ee.LISTS_GET_INDEX_TAIL&&this.appendDummyInput("TAIL").appendField(Ee.LISTS_GET_INDEX_TAIL),this.setInputsInline(true),this.setOutput(true),this.updateAt_(true);const G=this;this.setTooltip(function(){const Z=G.getFieldValue("MODE"),oe=G.getFieldValue("WHERE");let ce="";switch(Z+" "+oe){case"GET FROM_START":case"GET FROM_END":ce=Ee.LISTS_GET_INDEX_TOOLTIP_GET_FROM;break;case"GET FIRST":ce=Ee.LISTS_GET_INDEX_TOOLTIP_GET_FIRST;break;case"GET LAST":ce=Ee.LISTS_GET_INDEX_TOOLTIP_GET_LAST;break;case"GET RANDOM":ce=Ee.LISTS_GET_INDEX_TOOLTIP_GET_RANDOM;break;case"GET_REMOVE FROM_START":case"GET_REMOVE FROM_END":ce=Ee.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FROM;break;case"GET_REMOVE FIRST":ce=Ee.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FIRST;break;case"GET_REMOVE LAST":ce=Ee.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_LAST;break;case"GET_REMOVE RANDOM":ce=Ee.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_RANDOM;break;case"REMOVE FROM_START":case"REMOVE FROM_END":ce=Ee.LISTS_GET_INDEX_TOOLTIP_REMOVE_FROM;break;case"REMOVE FIRST":ce=Ee.LISTS_GET_INDEX_TOOLTIP_REMOVE_FIRST;break;case"REMOVE LAST":ce=Ee.LISTS_GET_INDEX_TOOLTIP_REMOVE_LAST;break;case"REMOVE RANDOM":ce=Ee.LISTS_GET_INDEX_TOOLTIP_REMOVE_RANDOM}return(oe==="FROM_START"||oe==="FROM_END")&&(ce+="  "+(oe==="FROM_START"?Ee.LISTS_INDEX_FROM_START_TOOLTIP:Ee.LISTS_INDEX_FROM_END_TOOLTIP).replace("%1",G.workspace.options.oneBasedIndex?"#1":"#0")),ce})},mutationToDom:function(){const N=o.module$build$src$core$utils$xml.createElement("mutation");N.setAttribute("statement",!this.outputConnection);const G=this.getInput("AT").type===o.module$build$src$core$connection_type.ConnectionType.INPUT_VALUE;return N.setAttribute("at",G),N},domToMutation:function(N){const G=N.getAttribute("statement")==="true";this.updateStatement_(G),N=N.getAttribute("at")!=="false",this.updateAt_(N)},saveExtraState:function(){return this.outputConnection?null:{isStatement:true}},loadExtraState:function(N){N.isStatement?this.updateStatement_(true):typeof N=="string"&&this.domToMutation(o.module$build$src$core$xml.textToDom(N))},updateStatement_:function(N){N!==!this.outputConnection&&(this.unplug(true,true),N?(this.setOutput(false),this.setPreviousStatement(true),this.setNextStatement(true)):(this.setPreviousStatement(false),this.setNextStatement(false),this.setOutput(true)))},updateAt_:function(N){this.removeInput("AT"),this.removeInput("ORDINAL",true),N?(this.appendValueInput("AT").setCheck("Number"),Ee.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL").appendField(Ee.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT");const G=new jt(this.WHERE_OPTIONS,function(Z){const oe=Z==="FROM_START"||Z==="FROM_END";if(oe!==N){const ce=this.getSourceBlock();return ce.updateAt_(oe),ce.setFieldValue(Z,"WHERE"),null}});this.getInput("AT").appendField(G,"WHERE"),Ee.LISTS_GET_INDEX_TAIL&&this.moveInputBefore("TAIL",null)}},ut.blocks.lists_setIndex={init:function(){const N=[[Ee.LISTS_SET_INDEX_SET,"SET"],[Ee.LISTS_SET_INDEX_INSERT,"INSERT"]];this.WHERE_OPTIONS=[[Ee.LISTS_GET_INDEX_FROM_START,"FROM_START"],[Ee.LISTS_GET_INDEX_FROM_END,"FROM_END"],[Ee.LISTS_GET_INDEX_FIRST,"FIRST"],[Ee.LISTS_GET_INDEX_LAST,"LAST"],[Ee.LISTS_GET_INDEX_RANDOM,"RANDOM"]],this.setHelpUrl(Ee.LISTS_SET_INDEX_HELPURL),this.setStyle("list_blocks"),this.appendValueInput("LIST").setCheck("Array").appendField(Ee.LISTS_SET_INDEX_INPUT_IN_LIST),this.appendDummyInput().appendField(new jt(N),"MODE").appendField("","SPACE"),this.appendDummyInput("AT"),this.appendValueInput("TO").appendField(Ee.LISTS_SET_INDEX_INPUT_TO),this.setInputsInline(true),this.setPreviousStatement(true),this.setNextStatement(true),this.setTooltip(Ee.LISTS_SET_INDEX_TOOLTIP),this.updateAt_(true);const G=this;this.setTooltip(function(){const Z=G.getFieldValue("MODE"),oe=G.getFieldValue("WHERE");let ce="";switch(Z+" "+oe){case"SET FROM_START":case"SET FROM_END":ce=Ee.LISTS_SET_INDEX_TOOLTIP_SET_FROM;break;case"SET FIRST":ce=Ee.LISTS_SET_INDEX_TOOLTIP_SET_FIRST;break;case"SET LAST":ce=Ee.LISTS_SET_INDEX_TOOLTIP_SET_LAST;break;case"SET RANDOM":ce=Ee.LISTS_SET_INDEX_TOOLTIP_SET_RANDOM;break;case"INSERT FROM_START":case"INSERT FROM_END":ce=Ee.LISTS_SET_INDEX_TOOLTIP_INSERT_FROM;break;case"INSERT FIRST":ce=Ee.LISTS_SET_INDEX_TOOLTIP_INSERT_FIRST;break;case"INSERT LAST":ce=Ee.LISTS_SET_INDEX_TOOLTIP_INSERT_LAST;break;case"INSERT RANDOM":ce=Ee.LISTS_SET_INDEX_TOOLTIP_INSERT_RANDOM}return(oe==="FROM_START"||oe==="FROM_END")&&(ce+="  "+Ee.LISTS_INDEX_FROM_START_TOOLTIP.replace("%1",G.workspace.options.oneBasedIndex?"#1":"#0")),ce})},mutationToDom:function(){const N=o.module$build$src$core$utils$xml.createElement("mutation"),G=this.getInput("AT").type===o.module$build$src$core$connection_type.ConnectionType.INPUT_VALUE;return N.setAttribute("at",G),N},domToMutation:function(N){N=N.getAttribute("at")!=="false",this.updateAt_(N)},saveExtraState:function(){return null},loadExtraState:function(){},updateAt_:function(N){this.removeInput("AT"),this.removeInput("ORDINAL",true),N?(this.appendValueInput("AT").setCheck("Number"),Ee.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL").appendField(Ee.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT");const G=new jt(this.WHERE_OPTIONS,function(Z){const oe=Z==="FROM_START"||Z==="FROM_END";if(oe!==N){const ce=this.getSourceBlock();return ce.updateAt_(oe),ce.setFieldValue(Z,"WHERE"),null}});this.moveInputBefore("AT","TO"),this.getInput("ORDINAL")&&this.moveInputBefore("ORDINAL","TO"),this.getInput("AT").appendField(G,"WHERE")}},ut.blocks.lists_getSublist={init:function(){this.WHERE_OPTIONS_1=[[Ee.LISTS_GET_SUBLIST_START_FROM_START,"FROM_START"],[Ee.LISTS_GET_SUBLIST_START_FROM_END,"FROM_END"],[Ee.LISTS_GET_SUBLIST_START_FIRST,"FIRST"]],this.WHERE_OPTIONS_2=[[Ee.LISTS_GET_SUBLIST_END_FROM_START,"FROM_START"],[Ee.LISTS_GET_SUBLIST_END_FROM_END,"FROM_END"],[Ee.LISTS_GET_SUBLIST_END_LAST,"LAST"]],this.setHelpUrl(Ee.LISTS_GET_SUBLIST_HELPURL),this.setStyle("list_blocks"),this.appendValueInput("LIST").setCheck("Array").appendField(Ee.LISTS_GET_SUBLIST_INPUT_IN_LIST),this.appendDummyInput("AT1"),this.appendDummyInput("AT2"),Ee.LISTS_GET_SUBLIST_TAIL&&this.appendDummyInput("TAIL").appendField(Ee.LISTS_GET_SUBLIST_TAIL),this.setInputsInline(true),this.setOutput(true,"Array"),this.updateAt_(1,true),this.updateAt_(2,true),this.setTooltip(Ee.LISTS_GET_SUBLIST_TOOLTIP)},mutationToDom:function(){const N=o.module$build$src$core$utils$xml.createElement("mutation");var G=this.getInput("AT1").type===o.module$build$src$core$connection_type.ConnectionType.INPUT_VALUE;return N.setAttribute("at1",G),G=this.getInput("AT2").type===o.module$build$src$core$connection_type.ConnectionType.INPUT_VALUE,N.setAttribute("at2",G),N},domToMutation:function(N){const G=N.getAttribute("at1")==="true";N=N.getAttribute("at2")==="true",this.updateAt_(1,G),this.updateAt_(2,N)},saveExtraState:function(){return null},loadExtraState:function(){},updateAt_:function(N,G){this.removeInput("AT"+N),this.removeInput("ORDINAL"+N,true),G?(this.appendValueInput("AT"+N).setCheck("Number"),Ee.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL"+N).appendField(Ee.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT"+N);const Z=new jt(this["WHERE_OPTIONS_"+N],function(oe){const ce=oe==="FROM_START"||oe==="FROM_END";if(ce!==G){const Ue=this.getSourceBlock();return Ue.updateAt_(N,ce),Ue.setFieldValue(oe,"WHERE"+N),null}});this.getInput("AT"+N).appendField(Z,"WHERE"+N),N===1&&(this.moveInputBefore("AT1","AT2"),this.getInput("ORDINAL1")&&this.moveInputBefore("ORDINAL1","AT2")),Ee.LISTS_GET_SUBLIST_TAIL&&this.moveInputBefore("TAIL",null)}},ut.blocks.lists_sort={init:function(){this.jsonInit({message0:"%{BKY_LISTS_SORT_TITLE}",args0:[{type:"field_dropdown",name:"TYPE",options:[["%{BKY_LISTS_SORT_TYPE_NUMERIC}","NUMERIC"],["%{BKY_LISTS_SORT_TYPE_TEXT}","TEXT"],["%{BKY_LISTS_SORT_TYPE_IGNORECASE}","IGNORE_CASE"]]},{type:"field_dropdown",name:"DIRECTION",options:[["%{BKY_LISTS_SORT_ORDER_ASCENDING}","1"],["%{BKY_LISTS_SORT_ORDER_DESCENDING}","-1"]]},{type:"input_value",name:"LIST",check:"Array"}],output:"Array",style:"list_blocks",tooltip:"%{BKY_LISTS_SORT_TOOLTIP}",helpUrl:"%{BKY_LISTS_SORT_HELPURL}"})}},ut.blocks.lists_split={init:function(){const N=this,G=new jt([[Ee.LISTS_SPLIT_LIST_FROM_TEXT,"SPLIT"],[Ee.LISTS_SPLIT_TEXT_FROM_LIST,"JOIN"]],function(Z){N.updateType_(Z)});this.setHelpUrl(Ee.LISTS_SPLIT_HELPURL),this.setStyle("list_blocks"),this.appendValueInput("INPUT").setCheck("String").appendField(G,"MODE"),this.appendValueInput("DELIM").setCheck("String").appendField(Ee.LISTS_SPLIT_WITH_DELIMITER),this.setInputsInline(true),this.setOutput(true,"Array"),this.setTooltip(function(){const Z=N.getFieldValue("MODE");if(Z==="SPLIT")return Ee.LISTS_SPLIT_TOOLTIP_SPLIT;if(Z==="JOIN")return Ee.LISTS_SPLIT_TOOLTIP_JOIN;throw Error("Unknown mode: "+Z)})},updateType_:function(N){if(this.getFieldValue("MODE")!==N){const G=this.getInput("INPUT").connection;G.setShadowDom(null);const Z=G.targetBlock();Z&&(G.disconnect(),Z.isShadow()?Z.dispose():this.bumpNeighbours())}N==="SPLIT"?(this.outputConnection.setCheck("Array"),this.getInput("INPUT").setCheck("String")):(this.outputConnection.setCheck("String"),this.getInput("INPUT").setCheck("Array"))},mutationToDom:function(){const N=o.module$build$src$core$utils$xml.createElement("mutation");return N.setAttribute("mode",this.getFieldValue("MODE")),N},domToMutation:function(N){this.updateType_(N.getAttribute("mode"))},saveExtraState:function(){return null},loadExtraState:function(){}},fs(ut.blocks);var ws={},Ot=o.module$build$src$core$common.createBlockDefinitionsFromJsonArray,xi=o.module$build$src$core$common.defineBlocks;ws.blocks=Ot([{type:"colour_picker",message0:"%1",args0:[{type:"field_colour",name:"COLOUR",colour:"#ff0000"}],output:"Colour",helpUrl:"%{BKY_COLOUR_PICKER_HELPURL}",style:"colour_blocks",tooltip:"%{BKY_COLOUR_PICKER_TOOLTIP}",extensions:["parent_tooltip_when_inline"]},{type:"colour_random",message0:"%{BKY_COLOUR_RANDOM_TITLE}",output:"Colour",helpUrl:"%{BKY_COLOUR_RANDOM_HELPURL}",style:"colour_blocks",tooltip:"%{BKY_COLOUR_RANDOM_TOOLTIP}"},{type:"colour_rgb",message0:"%{BKY_COLOUR_RGB_TITLE} %{BKY_COLOUR_RGB_RED} %1 %{BKY_COLOUR_RGB_GREEN} %2 %{BKY_COLOUR_RGB_BLUE} %3",args0:[{type:"input_value",name:"RED",check:"Number",align:"RIGHT"},{type:"input_value",name:"GREEN",check:"Number",align:"RIGHT"},{type:"input_value",name:"BLUE",check:"Number",align:"RIGHT"}],output:"Colour",helpUrl:"%{BKY_COLOUR_RGB_HELPURL}",style:"colour_blocks",tooltip:"%{BKY_COLOUR_RGB_TOOLTIP}"},{type:"colour_blend",message0:"%{BKY_COLOUR_BLEND_TITLE} %{BKY_COLOUR_BLEND_COLOUR1} %1 %{BKY_COLOUR_BLEND_COLOUR2} %2 %{BKY_COLOUR_BLEND_RATIO} %3",args0:[{type:"input_value",name:"COLOUR1",check:"Colour",align:"RIGHT"},{type:"input_value",name:"COLOUR2",check:"Colour",align:"RIGHT"},{type:"input_value",name:"RATIO",check:"Number",align:"RIGHT"}],output:"Colour",helpUrl:"%{BKY_COLOUR_BLEND_HELPURL}",style:"colour_blocks",tooltip:"%{BKY_COLOUR_BLEND_TOOLTIP}"}]),xi(ws.blocks);var as={};return as.colour=ws,as.lists=ut,as.logic=Jt,as.loops=te,as.math=V,as.procedures=z,as.texts=v,as.variables=p,as.variablesDynamic=l,as.blocks=Object.assign({},ws.blocks,ut.blocks,Jt.blocks,te.blocks,V.blocks,z.blocks,p.blocks,l.blocks),as.__namespace__=o,as})}(Eg)),Eg.exports}var T$;function Jx(){return T$||(T$=1,function(s,n){(function(i,o){s.exports=o(qx())})(Ni,function(i){/**
 * @license
 * Copyright 2020 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */return i})}(mg)),mg.exports}var S$;function Zx(){return S$||(S$=1,function(s,n){(function(i,o){s.exports=o(ZR(),Yx(),Jx(),QR())})(Ni,function(i,o,l,f){return i.setLocale(o),i})}(gg)),gg.exports}var $$;function Qx(){return $$||($$=1,function(s,n){(function(i,o){s.exports=o(Zx())})(Ni,function(i){/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */return i})}(pg)),pg.exports}var A=Qx();const eB={class:"dialog-footer"},tB=Ke({__name:"author",props:["modelValue"],emits:["update:modelValue","callback"],setup(s,{emit:n}){const i=me({name:"",email:""}),o=s,l=n,f=me(false);function m(){if(!(!i.value.name||!i.value.email)){if(!i.value.name.match(/^[A-Za-z0-9_-]+$/)){alert("作者名称只能包含英文、数字、下划线和中划线");return}if(!i.value.email.match(/^[A-Za-z0-9_-]+@[A-Za-z0-9_\-.]+$/)){alert("作者邮箱格式不正确");return}l("update:modelValue",false),l("callback",i.value.name+"<"+i.value.email+">"),i.value.name=void 0,i.value.email=void 0}}return kt(o,u=>{f.value=!!o.modelValue;const c=/^([A-Za-z0-9_-]+)<([A-Za-z0-9_-]+@[A-Za-z0-9_\-.]+)>$/.exec(o.modelValue);c&&(i.value.name=c[1],i.value.email=c[2])}),kt(f,u=>{l("update:modelValue",u||void 0)}),(u,_)=>{const c=gt("el-input"),h=gt("el-button"),p=gt("el-dialog");return ne(),Ye(p,{modelValue:f.value,"onUpdate:modelValue":_[4]||(_[4]=T=>f.value=T),title:"设置作者"},{footer:je(()=>[de("span",eB,[De(h,{onClick:_[2]||(_[2]=T=>l("update:modelValue"))},{default:je(()=>_[5]||(_[5]=[xt("关闭")])),_:1,__:[5]}),De(h,{type:"primary",onClick:_[3]||(_[3]=T=>m())},{default:je(()=>_[6]||(_[6]=[xt(" 确定 ")])),_:1,__:[6]})])]),default:je(()=>[De(c,{modelValue:i.value.name,"onUpdate:modelValue":_[0]||(_[0]=T=>i.value.name=T),placeholder:"作者名称(请使用英文名称)"},null,8,["modelValue"]),De(c,{modelValue:i.value.email,"onUpdate:modelValue":_[1]||(_[1]=T=>i.value.email=T),placeholder:"作者邮箱"},null,8,["modelValue"])]),_:1},8,["modelValue"])}}}),sB={style:{display:"flex","flex-flow":"column",contain:"size",overflow:"hidden",height:"100%"}},iB={style:{width:"100%",padding:"5px","padding-left":"20px",height:"25px","border-bottom":"1px solid var(--bg1)"}},nB={style:{padding:"20px"}},rB=Ke({__name:"meta",props:["current","workspace"],emits:["update:workspace","metaChange"],setup(s,{emit:n}){const i=n,o=s,l=me([]),f=me([]),m=async()=>{try{return await _i("get-all-blockly-blocks")}catch(g){return console.error("获取meta页面插件数据失败:",g),null}},u=async()=>{const g=await m();g&&Array.isArray(g)&&(f.value=g)},_=_e(()=>(f.value.length>0?f.value:Ir.blockly).find(E=>{var v;return E.id.toString()===((v=o.current)==null?void 0:v.toString())})),c=me({author:void 0,description:"",commands:{},tables:{}});function h(){l.value=[],this.getAllBlocks(false).forEach(g=>{g.type==="command"&&l.value.push(g)})}try{A.serialization.registry.unregister("plugin-meta"),A.serialization.registry.register("plugin-meta",{save(g){return g.meta=df(c.value),c.value},load(g,E){g&&(c.value.author=g.author,c.value.description=g.description??void 0,E.metaListener=h.bind(E),E.addChangeListener(E.metaListener),E.metaListener(),c.value.commands=g.commands??{},c.value.tables=g.tables??{},E.meta=df(c.value))},clear(g){c.value.description="",c.value.author=void 0,g.removeChangeListener(g.metaListener),g.meta={}},priority:10})}catch(g){console.error(g)}function p(g){c.value.author=g,i("metaChange")}kt(c.value,()=>{i("metaChange")});const T=me(void 0);function $(){const g=prompt("请输入数据表名");g&&(c.value.tables[g]={columns:{}})}const S=_e(()=>l.value.map(g=>g.getFieldValue("name"))),y=_e(()=>dm([...S.value,...Object.keys(c.value.commands)]));return Rs(async()=>{await u()}),(g,E)=>{const v=gt("k-button"),b=gt("el-input"),R=gt("el-button"),O=gt("el-table-column"),w=gt("el-table"),L=gt("el-input-number"),I=gt("el-scrollbar");return ne(),ve(Pt,null,[De(tB,{modelValue:T.value,"onUpdate:modelValue":E[0]||(E[0]=k=>T.value=k),onCallback:p},null,8,["modelValue"]),de("div",sB,[de("div",iB,[de("button",{class:"menu-button",onClick:E[1]||(E[1]=k=>i("update:workspace","blockly"))},"退出元数据编辑")]),De(I,{style:{flex:"auto"}},{default:je(()=>{var k;return[de("div",nB,[E[10]||(E[10]=de("h2",null,"插件基本信息",-1)),de("p",null,"插件ID:"+Bt(o.current),1),de("p",null,"插件UUID: "+Bt((k=_.value)==null?void 0:k.uuid),1),de("p",null,[xt("插件作者: "+Bt(c.value.author??"未署名"),1),De(v,{onClick:E[2]||(E[2]=x=>T.value=c.value.author??true)},{default:je(()=>E[5]||(E[5]=[xt("修改")])),_:1,__:[5]})]),E[11]||(E[11]=xt(" 插件描述: ")),E[12]||(E[12]=de("br",null,null,-1)),De(b,{type:"textarea",modelValue:c.value.description,"onUpdate:modelValue":E[3]||(E[3]=x=>c.value.description=x)},null,8,["modelValue"]),E[13]||(E[13]=de("h2",null,"数据库",-1)),De(R,{onClick:$},{default:je(()=>E[6]||(E[6]=[xt("新建数据表")])),_:1,__:[6]}),De(w,{modelValue:c.value.tables,"onUpdate:modelValue":E[4]||(E[4]=x=>c.value.tables=x)},{default:je(()=>[De(O,{prop:"table",label:"数据表名",width:"180"}),De(O,{prop:"columns",label:"字段",width:"180"}),De(O,{prop:"operation",label:"操作"})]),_:1},8,["modelValue"]),E[14]||(E[14]=de("h2",null,"指令",-1)),de("div",null,[(ne(true),ve(Pt,null,pi(y.value,(x,P)=>(ne(),ve("div",null,[de("h3",{class:tt(S.value.includes(x)?"":"disabled-title")},[xt(Bt(x)+" ",1),c.value.commands[x]?(ne(),Ye(R,{key:0,onClick:F=>delete c.value.commands[x]},{default:je(()=>E[7]||(E[7]=[xt("删除")])),_:2,__:[7]},1032,["onClick"])):Ze("v-if",true)],2),c.value.commands[x]?(ne(),ve(Pt,{key:1},[De(b,{type:"textarea",modelValue:c.value.commands[x].description,"onUpdate:modelValue":F=>c.value.commands[x].description=F},null,8,["modelValue","onUpdate:modelValue"]),E[9]||(E[9]=xt(" 最低权限等级")),De(L,{modelValue:c.value.commands[x].authority,"onUpdate:modelValue":F=>c.value.commands[x].authority=F},null,8,["modelValue","onUpdate:modelValue"])],64)):(ne(),Ye(v,{key:0,onClick:F=>c.value.commands[x]={authority:0}},{default:je(()=>E[8]||(E[8]=[xt("设置指令信息")])),_:2,__:[8]},1032,["onClick"]))]))),256))]),E[15]||(E[15]=de("h2",null,"存储空间",-1)),E[16]||(E[16]=xt(" 暂未支持 ")),E[17]||(E[17]=de("h2",null,"其他信息",-1)),E[18]||(E[18]=xt(" SHA256校验值: ")),De(b,{"model-value":"96cae35ce8a9b0244178bf28e4966c2ce1b8385723a96a6b838858cdd6ca0a1e"})])]}),_:1})])],64)}}}),oB=rr(rB,[["__scopeId","data-v-89e21dec"]]);var vg={exports:{}},y$;function aB(){return y$||(y$=1,function(s,n){(function(i,o){s.exports=o()})(Ni,function(){var i=i||{Msg:Object.create(null)};return i.Msg.ADD_COMMENT="添加注释",i.Msg.CANNOT_DELETE_VARIABLE_PROCEDURE="不能删除变量“%1”，因为它是函数“%2”定义的一部分",i.Msg.CHANGE_VALUE_TITLE="更改值：",i.Msg.CLEAN_UP="整理块",i.Msg.COLLAPSED_WARNINGS_WARNING="已收起的信息块内包含警告。",i.Msg.COLLAPSE_ALL="折叠块",i.Msg.COLLAPSE_BLOCK="折叠块",i.Msg.COLOUR_BLEND_COLOUR1="颜色1",i.Msg.COLOUR_BLEND_COLOUR2="颜色2",i.Msg.COLOUR_BLEND_HELPURL="https://meyerweb.com/eric/tools/color-blend/#:::rgbp",i.Msg.COLOUR_BLEND_RATIO="比例",i.Msg.COLOUR_BLEND_TITLE="混合",i.Msg.COLOUR_BLEND_TOOLTIP="把两种颜色以一个给定的比例(0.0-1.0)进行混合。",i.Msg.COLOUR_PICKER_HELPURL="https://zh.wikipedia.org/wiki/颜色",i.Msg.COLOUR_PICKER_TOOLTIP="从调色板中选择一种颜色。",i.Msg.COLOUR_RANDOM_HELPURL="http://randomcolour.com",i.Msg.COLOUR_RANDOM_TITLE="随机颜色",i.Msg.COLOUR_RANDOM_TOOLTIP="随机选择一种颜色。",i.Msg.COLOUR_RGB_BLUE="蓝色",i.Msg.COLOUR_RGB_GREEN="绿色",i.Msg.COLOUR_RGB_HELPURL="https://www.december.com/html/spec/colorpercompact.html",i.Msg.COLOUR_RGB_RED="红色",i.Msg.COLOUR_RGB_TITLE="颜色",i.Msg.COLOUR_RGB_TOOLTIP="通过指定红色、绿色和蓝色的量创建一种颜色。所有的值必须在0和100之间。",i.Msg.CONTROLS_FLOW_STATEMENTS_HELPURL="https://github.com/google/blockly/wiki/Loops#loop-termination-blocks",i.Msg.CONTROLS_FLOW_STATEMENTS_OPERATOR_BREAK="跳出循环",i.Msg.CONTROLS_FLOW_STATEMENTS_OPERATOR_CONTINUE="继续下一轮循环",i.Msg.CONTROLS_FLOW_STATEMENTS_TOOLTIP_BREAK="跳出包含它的循环。",i.Msg.CONTROLS_FLOW_STATEMENTS_TOOLTIP_CONTINUE="跳过本轮循环的剩余部分，并继进行续下一轮循环。",i.Msg.CONTROLS_FLOW_STATEMENTS_WARNING="警告：这个块只能在循环内使用。",i.Msg.CONTROLS_FOREACH_HELPURL="https://github.com/google/blockly/wiki/Loops#for-each",i.Msg.CONTROLS_FOREACH_TITLE="遍历列表 %2 里的每一项 %1",i.Msg.CONTROLS_FOREACH_TOOLTIP="遍历列表中的每一项，将变量“%1”设为所选项，并执行一些语句。",i.Msg.CONTROLS_FOR_HELPURL="https://github.com/google/blockly/wiki/Loops#count-with",i.Msg.CONTROLS_FOR_TITLE="变量 %1 从 %2 数到 %3 每次增加 %4",i.Msg.CONTROLS_FOR_TOOLTIP="用变量%1记录从开始数值到终止数值之间的数值，数值按指定间隔增加，并执行指定的块。",i.Msg.CONTROLS_IF_ELSEIF_TOOLTIP="在这个if语句块中增加一个条件。",i.Msg.CONTROLS_IF_ELSE_TOOLTIP="在这个if语句块中添加一个最终的，包括所有其余情况的条件。",i.Msg.CONTROLS_IF_HELPURL="https://github.com/google/blockly/wiki/IfElse",i.Msg.CONTROLS_IF_IF_TOOLTIP="增加、删除或重新排列各节来重新配置这个if语句块。",i.Msg.CONTROLS_IF_MSG_ELSE="否则",i.Msg.CONTROLS_IF_MSG_ELSEIF="否则如果",i.Msg.CONTROLS_IF_MSG_IF="如果",i.Msg.CONTROLS_IF_TOOLTIP_1="如果值为真，执行一些语句。",i.Msg.CONTROLS_IF_TOOLTIP_2="如果值为真，则执行第一块语句。否则，则执行第二块语句。",i.Msg.CONTROLS_IF_TOOLTIP_3="如果第一个值为真，则执行第一块的语句。否则，如果第二个值为真，则执行第二块的语句。",i.Msg.CONTROLS_IF_TOOLTIP_4="如果第一个值为真，则执行第一块对语句。否则，如果第二个值为真，则执行语句的第二块。如果没有值为真，则执行最后一块的语句。",i.Msg.CONTROLS_REPEAT_HELPURL="https://zh.wikipedia.org/wiki/For循环",i.Msg.CONTROLS_REPEAT_INPUT_DO="执行",i.Msg.CONTROLS_REPEAT_TITLE="重复 %1 次",i.Msg.CONTROLS_REPEAT_TOOLTIP="多次执行一些语句。",i.Msg.CONTROLS_WHILEUNTIL_HELPURL="https://github.com/google/blockly/wiki/Loops#repeat",i.Msg.CONTROLS_WHILEUNTIL_OPERATOR_UNTIL="重复直到条件满足",i.Msg.CONTROLS_WHILEUNTIL_OPERATOR_WHILE="当条件满足时重复",i.Msg.CONTROLS_WHILEUNTIL_TOOLTIP_UNTIL="只要值为假，就一直循环执行一些语句。",i.Msg.CONTROLS_WHILEUNTIL_TOOLTIP_WHILE="只要值为真，就一直循环执行一些语句。",i.Msg.DELETE_ALL_BLOCKS="删除所有 %1 个块吗？",i.Msg.DELETE_BLOCK="删除块",i.Msg.DELETE_VARIABLE="删除变量“%1”",i.Msg.DELETE_VARIABLE_CONFIRMATION="要删除对变量“%2”的%1个引用吗？",i.Msg.DELETE_X_BLOCKS="删除 %1 个块",i.Msg.DIALOG_CANCEL="取消",i.Msg.DIALOG_OK="确认",i.Msg.DISABLE_BLOCK="禁用块",i.Msg.DUPLICATE_BLOCK="复制",i.Msg.DUPLICATE_COMMENT="复制注释",i.Msg.ENABLE_BLOCK="启用块",i.Msg.EXPAND_ALL="展开块",i.Msg.EXPAND_BLOCK="展开块",i.Msg.EXTERNAL_INPUTS="外部输入",i.Msg.HELP="帮助",i.Msg.INLINE_INPUTS="单行输入",i.Msg.LISTS_CREATE_EMPTY_HELPURL="https://github.com/google/blockly/wiki/Lists#create-empty-list",i.Msg.LISTS_CREATE_EMPTY_TITLE="创建空列表",i.Msg.LISTS_CREATE_EMPTY_TOOLTIP="返回一个列表，长度为 0，不包含任何数据记录",i.Msg.LISTS_CREATE_WITH_CONTAINER_TITLE_ADD="列表",i.Msg.LISTS_CREATE_WITH_CONTAINER_TOOLTIP="增加、删除或重新排列各部分以此重新配置这个列表块。",i.Msg.LISTS_CREATE_WITH_HELPURL="https://github.com/google/blockly/wiki/Lists#create-list-with",i.Msg.LISTS_CREATE_WITH_INPUT_WITH="创建列表，内容：",i.Msg.LISTS_CREATE_WITH_ITEM_TOOLTIP="将一个项添加到列表中。",i.Msg.LISTS_CREATE_WITH_TOOLTIP="建立一个具有任意数量项目的列表。",i.Msg.LISTS_GET_INDEX_FIRST="第一项",i.Msg.LISTS_GET_INDEX_FROM_END="倒数第#项",i.Msg.LISTS_GET_INDEX_FROM_START="#",i.Msg.LISTS_GET_INDEX_GET="取得",i.Msg.LISTS_GET_INDEX_GET_REMOVE="取得并移除",i.Msg.LISTS_GET_INDEX_LAST="最后一项",i.Msg.LISTS_GET_INDEX_RANDOM="随机的一项",i.Msg.LISTS_GET_INDEX_REMOVE="移除",i.Msg.LISTS_GET_INDEX_TAIL="",i.Msg.LISTS_GET_INDEX_TOOLTIP_GET_FIRST="返回列表中的第一项。",i.Msg.LISTS_GET_INDEX_TOOLTIP_GET_FROM="返回在列表中的指定位置的项。",i.Msg.LISTS_GET_INDEX_TOOLTIP_GET_LAST="返回列表中的最后一项。",i.Msg.LISTS_GET_INDEX_TOOLTIP_GET_RANDOM="返回列表中的随机一项。",i.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FIRST="移除并返回列表中的第一项。",i.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FROM="移除并返回列表中的指定位置的项。",i.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_LAST="移除并返回列表中的最后一项。",i.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_RANDOM="移除并返回列表中的随机一项。",i.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FIRST="移除列表中的第一项",i.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FROM="移除在列表中的指定位置的项。",i.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_LAST="移除列表中的最后一项",i.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_RANDOM="删除列表中的随机一项。",i.Msg.LISTS_GET_SUBLIST_END_FROM_END="到倒数第#项",i.Msg.LISTS_GET_SUBLIST_END_FROM_START="到第#项",i.Msg.LISTS_GET_SUBLIST_END_LAST="到最后一项",i.Msg.LISTS_GET_SUBLIST_HELPURL="https://github.com/google/blockly/wiki/Lists#getting-a-sublist",i.Msg.LISTS_GET_SUBLIST_START_FIRST="获取子列表，从第一项",i.Msg.LISTS_GET_SUBLIST_START_FROM_END="获取子列表，从倒数第#项",i.Msg.LISTS_GET_SUBLIST_START_FROM_START="获取子列表，从第#项",i.Msg.LISTS_GET_SUBLIST_TAIL="",i.Msg.LISTS_GET_SUBLIST_TOOLTIP="复制列表中指定的部分。",i.Msg.LISTS_INDEX_FROM_END_TOOLTIP="%1是最后一项。",i.Msg.LISTS_INDEX_FROM_START_TOOLTIP="%1是第一项。",i.Msg.LISTS_INDEX_OF_FIRST="寻找第一次出现的项",i.Msg.LISTS_INDEX_OF_HELPURL="https://github.com/google/blockly/wiki/Lists#getting-items-from-a-list",i.Msg.LISTS_INDEX_OF_LAST="寻找最后一次出现的项",i.Msg.LISTS_INDEX_OF_TOOLTIP="返回在列表中的第一/最后一个匹配项的索引值。如果找不到项目则返回%1。",i.Msg.LISTS_INLIST="在列表中",i.Msg.LISTS_ISEMPTY_HELPURL="https://github.com/google/blockly/wiki/Lists#is-empty",i.Msg.LISTS_ISEMPTY_TITLE="%1是空的",i.Msg.LISTS_ISEMPTY_TOOLTIP="如果改列表为空，则返回真。",i.Msg.LISTS_LENGTH_HELPURL="https://github.com/google/blockly/wiki/Lists#length-of",i.Msg.LISTS_LENGTH_TITLE="%1的长度",i.Msg.LISTS_LENGTH_TOOLTIP="返回列表的长度。",i.Msg.LISTS_REPEAT_HELPURL="https://github.com/google/blockly/wiki/Lists#create-list-with",i.Msg.LISTS_REPEAT_TITLE="建立列表使用项 %1 重复 %2 次",i.Msg.LISTS_REPEAT_TOOLTIP="建立包含指定重复次数的值的列表。",i.Msg.LISTS_REVERSE_HELPURL="https://github.com/google/blockly/wiki/Lists#reversing-a-list",i.Msg.LISTS_REVERSE_MESSAGE0="倒转%1",i.Msg.LISTS_REVERSE_TOOLTIP="倒转一个列表，返回副本。",i.Msg.LISTS_SET_INDEX_HELPURL="https://github.com/google/blockly/wiki/Lists#in-list--set",i.Msg.LISTS_SET_INDEX_INPUT_TO="值为",i.Msg.LISTS_SET_INDEX_INSERT="插入在",i.Msg.LISTS_SET_INDEX_SET="设置",i.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FIRST="在列表的起始处添加该项。",i.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FROM="在列表中指定位置插入项。",i.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_LAST="在列表的末尾处添加该项。",i.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_RANDOM="在列表的随机位置插入该项。",i.Msg.LISTS_SET_INDEX_TOOLTIP_SET_FIRST="设置列表中的第一项。",i.Msg.LISTS_SET_INDEX_TOOLTIP_SET_FROM="设置在列表中指定位置的项。",i.Msg.LISTS_SET_INDEX_TOOLTIP_SET_LAST="设置列表中的最后一项。",i.Msg.LISTS_SET_INDEX_TOOLTIP_SET_RANDOM="设置列表中的随机一项。",i.Msg.LISTS_SORT_HELPURL="https://github.com/google/blockly/wiki/Lists#sorting-a-list",i.Msg.LISTS_SORT_ORDER_ASCENDING="升序",i.Msg.LISTS_SORT_ORDER_DESCENDING="降序",i.Msg.LISTS_SORT_TITLE="排序%1 %2 %3",i.Msg.LISTS_SORT_TOOLTIP="排序一个列表，返回副本。",i.Msg.LISTS_SORT_TYPE_IGNORECASE="按字母（忽略大小写）",i.Msg.LISTS_SORT_TYPE_NUMERIC="按数字",i.Msg.LISTS_SORT_TYPE_TEXT="按字母",i.Msg.LISTS_SPLIT_HELPURL="https://github.com/google/blockly/wiki/Lists#splitting-strings-and-joining-lists",i.Msg.LISTS_SPLIT_LIST_FROM_TEXT="从文本制作列表",i.Msg.LISTS_SPLIT_TEXT_FROM_LIST="将列表合并为文本",i.Msg.LISTS_SPLIT_TOOLTIP_JOIN="加入文本列表至一个文本，由分隔符分隔。",i.Msg.LISTS_SPLIT_TOOLTIP_SPLIT="将文本按指定的分隔符拆分为文本组成的列表。",i.Msg.LISTS_SPLIT_WITH_DELIMITER="分隔符：",i.Msg.LOGIC_BOOLEAN_FALSE="假",i.Msg.LOGIC_BOOLEAN_HELPURL="https://github.com/google/blockly/wiki/Logic#values",i.Msg.LOGIC_BOOLEAN_TOOLTIP="返回真或假。",i.Msg.LOGIC_BOOLEAN_TRUE="真",i.Msg.LOGIC_COMPARE_HELPURL="https://zh.wikipedia.org/wiki/不等",i.Msg.LOGIC_COMPARE_TOOLTIP_EQ="如果两个输入结果相等，则返回真。",i.Msg.LOGIC_COMPARE_TOOLTIP_GT="如果第一个输入结果比第二个大，则返回真。",i.Msg.LOGIC_COMPARE_TOOLTIP_GTE="如果第一个输入结果大于或等于第二个输入结果，则返回真。",i.Msg.LOGIC_COMPARE_TOOLTIP_LT="如果第一个输入结果比第二个小，则返回真。",i.Msg.LOGIC_COMPARE_TOOLTIP_LTE="如果第一个输入结果小于或等于第二个输入结果，则返回真。",i.Msg.LOGIC_COMPARE_TOOLTIP_NEQ="如果两个输入结果不相等，则返回真。",i.Msg.LOGIC_NEGATE_HELPURL="https://github.com/google/blockly/wiki/Logic#not",i.Msg.LOGIC_NEGATE_TITLE="非%1",i.Msg.LOGIC_NEGATE_TOOLTIP="如果输入结果为假，则返回真；如果输入结果为真，则返回假。",i.Msg.LOGIC_NULL="空",i.Msg.LOGIC_NULL_HELPURL="https://en.wikipedia.org/wiki/Nullable_type",i.Msg.LOGIC_NULL_TOOLTIP="返回空值。",i.Msg.LOGIC_OPERATION_AND="并且",i.Msg.LOGIC_OPERATION_HELPURL="https://github.com/google/blockly/wiki/Logic#logical-operations",i.Msg.LOGIC_OPERATION_OR="或",i.Msg.LOGIC_OPERATION_TOOLTIP_AND="如果两个输入结果都为真，则返回真。",i.Msg.LOGIC_OPERATION_TOOLTIP_OR="如果至少有一个输入结果为真，则返回真。",i.Msg.LOGIC_TERNARY_CONDITION="断言",i.Msg.LOGIC_TERNARY_HELPURL="https://zh.wikipedia.org/wiki/条件运算符",i.Msg.LOGIC_TERNARY_IF_FALSE="如果为假",i.Msg.LOGIC_TERNARY_IF_TRUE="如果为真",i.Msg.LOGIC_TERNARY_TOOLTIP="检查“断言”里的条件语句。如果条件为真，则返回“如果为真”的值，否则，则返回“如果为假”的值。",i.Msg.MATH_ADDITION_SYMBOL="+",i.Msg.MATH_ARITHMETIC_HELPURL="https://zh.wikipedia.org/wiki/算术",i.Msg.MATH_ARITHMETIC_TOOLTIP_ADD="返回两个数值的和。",i.Msg.MATH_ARITHMETIC_TOOLTIP_DIVIDE="返回两个数值的商。",i.Msg.MATH_ARITHMETIC_TOOLTIP_MINUS="返回两个数值的差。",i.Msg.MATH_ARITHMETIC_TOOLTIP_MULTIPLY="返回两个数值的乘积。",i.Msg.MATH_ARITHMETIC_TOOLTIP_POWER="返回以第一个数值为底数，以第二个数值为幂的结果。",i.Msg.MATH_ATAN2_HELPURL="https://zh.wikipedia.org/wiki/反正切2",i.Msg.MATH_ATAN2_TITLE="点(x:%1,y:%2)的方位角",i.Msg.MATH_ATAN2_TOOLTIP="返回点（X，Y）的反正切值，范围为-180到180度。",i.Msg.MATH_CHANGE_HELPURL="https://zh.wikipedia.org/wiki/加法",i.Msg.MATH_CHANGE_TITLE="将 %1 增加 %2",i.Msg.MATH_CHANGE_TOOLTIP="为变量“%1”增加一个数值。",i.Msg.MATH_CONSTANT_HELPURL="https://zh.wikipedia.org/wiki/数学常数",i.Msg.MATH_CONSTANT_TOOLTIP="返回一个常见常量：π (3.141…)、e (2.718…)、φ (1.618…)、根号2 (1.414…)、根号二分之一 (0.707…)或∞ (无穷大)。",i.Msg.MATH_CONSTRAIN_HELPURL="https://en.wikipedia.org/wiki/Clamping_(graphics)",i.Msg.MATH_CONSTRAIN_TITLE="将 %1 限制在 最低 %2 到最高 %3 之间",i.Msg.MATH_CONSTRAIN_TOOLTIP="将一个数值限制在两个指定的数值范围（含边界）之间。",i.Msg.MATH_DIVISION_SYMBOL="÷",i.Msg.MATH_IS_DIVISIBLE_BY="可被整除",i.Msg.MATH_IS_EVEN="是偶数",i.Msg.MATH_IS_NEGATIVE="是负数",i.Msg.MATH_IS_ODD="是奇数",i.Msg.MATH_IS_POSITIVE="是正数",i.Msg.MATH_IS_PRIME="是质数",i.Msg.MATH_IS_TOOLTIP="检查一个数值是否是偶数、奇数、质数、自然数、正数、负数或者是否能被某数整除。返回真或假。",i.Msg.MATH_IS_WHOLE="是整数",i.Msg.MATH_MODULO_HELPURL="https://zh.wikipedia.org/wiki/模除",i.Msg.MATH_MODULO_TITLE="取 %1 ÷ %2 的余数",i.Msg.MATH_MODULO_TOOLTIP="返回这两个数字相除后的余数。",i.Msg.MATH_MULTIPLICATION_SYMBOL="×",i.Msg.MATH_NUMBER_HELPURL="https://zh.wikipedia.org/wiki/数",i.Msg.MATH_NUMBER_TOOLTIP="一个数值。",i.Msg.MATH_ONLIST_HELPURL="",i.Msg.MATH_ONLIST_OPERATOR_AVERAGE="列表平均值",i.Msg.MATH_ONLIST_OPERATOR_MAX="列表最大值",i.Msg.MATH_ONLIST_OPERATOR_MEDIAN="列表中位数",i.Msg.MATH_ONLIST_OPERATOR_MIN="列表最小值",i.Msg.MATH_ONLIST_OPERATOR_MODE="列表中的众数",i.Msg.MATH_ONLIST_OPERATOR_RANDOM="列表中的随机一项",i.Msg.MATH_ONLIST_OPERATOR_STD_DEV="列表的标准差",i.Msg.MATH_ONLIST_OPERATOR_SUM="列表中数值的和",i.Msg.MATH_ONLIST_TOOLTIP_AVERAGE="返回列表中的数值的平均值。",i.Msg.MATH_ONLIST_TOOLTIP_MAX="返回列表中最大值。",i.Msg.MATH_ONLIST_TOOLTIP_MEDIAN="返回列表中数值的中位数。",i.Msg.MATH_ONLIST_TOOLTIP_MIN="返回列表中最小值。",i.Msg.MATH_ONLIST_TOOLTIP_MODE="返回列表中的出现次数最多的项的列表。",i.Msg.MATH_ONLIST_TOOLTIP_RANDOM="从列表中返回一个随机的元素。",i.Msg.MATH_ONLIST_TOOLTIP_STD_DEV="返回列表的标准差。",i.Msg.MATH_ONLIST_TOOLTIP_SUM="返回列表中的所有数值的和。",i.Msg.MATH_POWER_SYMBOL="^",i.Msg.MATH_RANDOM_FLOAT_HELPURL="https://zh.wikipedia.org/wiki/随机数生成器",i.Msg.MATH_RANDOM_FLOAT_TITLE_RANDOM="随机小数",i.Msg.MATH_RANDOM_FLOAT_TOOLTIP="返回一个从0.0（含）到1.0（不含）之间的随机数。",i.Msg.MATH_RANDOM_INT_HELPURL="https://zh.wikipedia.org/wiki/随机数生成器",i.Msg.MATH_RANDOM_INT_TITLE="从 %1 到 %2 范围内的随机整数",i.Msg.MATH_RANDOM_INT_TOOLTIP="返回一个限制在两个指定数值的范围（含边界）之间的随机整数。",i.Msg.MATH_ROUND_HELPURL="https://zh.wikipedia.org/wiki/数值修约",i.Msg.MATH_ROUND_OPERATOR_ROUND="四舍五入",i.Msg.MATH_ROUND_OPERATOR_ROUNDDOWN="向下舍入",i.Msg.MATH_ROUND_OPERATOR_ROUNDUP="向上舍入",i.Msg.MATH_ROUND_TOOLTIP="数字向上或向下舍入。",i.Msg.MATH_SINGLE_HELPURL="https://zh.wikipedia.org/wiki/平方根",i.Msg.MATH_SINGLE_OP_ABSOLUTE="绝对值",i.Msg.MATH_SINGLE_OP_ROOT="平方根",i.Msg.MATH_SINGLE_TOOLTIP_ABS="返回一个数值的绝对值。",i.Msg.MATH_SINGLE_TOOLTIP_EXP="返回e的n次幂。",i.Msg.MATH_SINGLE_TOOLTIP_LN="返回一个数值的自然对数。",i.Msg.MATH_SINGLE_TOOLTIP_LOG10="返回一个数值的以10为底的对数。",i.Msg.MATH_SINGLE_TOOLTIP_NEG="返回一个数值的相反数。",i.Msg.MATH_SINGLE_TOOLTIP_POW10="返回10的n次幂。",i.Msg.MATH_SINGLE_TOOLTIP_ROOT="返回一个数的平方根。",i.Msg.MATH_SUBTRACTION_SYMBOL="-",i.Msg.MATH_TRIG_ACOS="acos",i.Msg.MATH_TRIG_ASIN="asin",i.Msg.MATH_TRIG_ATAN="atan",i.Msg.MATH_TRIG_COS="cos",i.Msg.MATH_TRIG_HELPURL="https://zh.wikipedia.org/wiki/三角函数",i.Msg.MATH_TRIG_SIN="sin",i.Msg.MATH_TRIG_TAN="tan",i.Msg.MATH_TRIG_TOOLTIP_ACOS="返回一个数值的反余弦值。",i.Msg.MATH_TRIG_TOOLTIP_ASIN="返回一个数值的反正弦值。",i.Msg.MATH_TRIG_TOOLTIP_ATAN="返回一个数值的反正切值。",i.Msg.MATH_TRIG_TOOLTIP_COS="返回指定角度的余弦值（非弧度）。",i.Msg.MATH_TRIG_TOOLTIP_SIN="返回指定角度的正弦值（非弧度）。",i.Msg.MATH_TRIG_TOOLTIP_TAN="返回指定角度的正切值（非弧度）。",i.Msg.NEW_COLOUR_VARIABLE="创建颜色变量...",i.Msg.NEW_NUMBER_VARIABLE="创建数字变量...",i.Msg.NEW_STRING_VARIABLE="创建字符串变量...",i.Msg.NEW_VARIABLE="创建变量...",i.Msg.NEW_VARIABLE_TITLE="新变量的名称：",i.Msg.NEW_VARIABLE_TYPE_TITLE="新变量的类型：",i.Msg.ORDINAL_NUMBER_SUFFIX="",i.Msg.PROCEDURES_ALLOW_STATEMENTS="允许声明",i.Msg.PROCEDURES_BEFORE_PARAMS="与：",i.Msg.PROCEDURES_CALLNORETURN_HELPURL="https://zh.wikipedia.org/wiki/子程序",i.Msg.PROCEDURES_CALLNORETURN_TOOLTIP="运行用户定义的函数“%1”。",i.Msg.PROCEDURES_CALLRETURN_HELPURL="https://zh.wikipedia.org/wiki/子程序",i.Msg.PROCEDURES_CALLRETURN_TOOLTIP="运行用户定义的函数“%1”，并使用它的输出值。",i.Msg.PROCEDURES_CALL_BEFORE_PARAMS="与：",i.Msg.PROCEDURES_CREATE_DO="创建“%1”",i.Msg.PROCEDURES_DEFNORETURN_COMMENT="描述该功能...",i.Msg.PROCEDURES_DEFNORETURN_DO="",i.Msg.PROCEDURES_DEFNORETURN_HELPURL="https://zh.wikipedia.org/wiki/子程序",i.Msg.PROCEDURES_DEFNORETURN_PROCEDURE="做点什么",i.Msg.PROCEDURES_DEFNORETURN_TITLE="至",i.Msg.PROCEDURES_DEFNORETURN_TOOLTIP="创建一个不带输出值的函数。",i.Msg.PROCEDURES_DEFRETURN_HELPURL="https://zh.wikipedia.org/wiki/子程序",i.Msg.PROCEDURES_DEFRETURN_RETURN="返回",i.Msg.PROCEDURES_DEFRETURN_TOOLTIP="创建一个有输出值的函数。",i.Msg.PROCEDURES_DEF_DUPLICATE_WARNING="警告：此函数具有重复参数。",i.Msg.PROCEDURES_HIGHLIGHT_DEF="突出显示函数定义",i.Msg.PROCEDURES_IFRETURN_HELPURL="http://c2.com/cgi/wiki?GuardClause",i.Msg.PROCEDURES_IFRETURN_TOOLTIP="如果值为真，则返回第二个值。",i.Msg.PROCEDURES_IFRETURN_WARNING="警告：这个块只能在函数内部使用。",i.Msg.PROCEDURES_MUTATORARG_TITLE="输入名称：",i.Msg.PROCEDURES_MUTATORARG_TOOLTIP="添加函数输入。",i.Msg.PROCEDURES_MUTATORCONTAINER_TITLE="输入",i.Msg.PROCEDURES_MUTATORCONTAINER_TOOLTIP="添加、移除或重新排此函数的输入。",i.Msg.REDO="重做",i.Msg.REMOVE_COMMENT="删除注释",i.Msg.RENAME_VARIABLE="重命名变量...",i.Msg.RENAME_VARIABLE_TITLE="将所有“%1”变量重命名为:",i.Msg.TEXT_APPEND_HELPURL="https://github.com/google/blockly/wiki/Text#text-modification",i.Msg.TEXT_APPEND_TITLE="在%1之后加上文本%2",i.Msg.TEXT_APPEND_TOOLTIP="将一些文本追加到变量“%1”里。",i.Msg.TEXT_CHANGECASE_HELPURL="https://github.com/google/blockly/wiki/Text#adjusting-text-case",i.Msg.TEXT_CHANGECASE_OPERATOR_LOWERCASE="转为小写",i.Msg.TEXT_CHANGECASE_OPERATOR_TITLECASE="转为首字母大写",i.Msg.TEXT_CHANGECASE_OPERATOR_UPPERCASE="转为大写",i.Msg.TEXT_CHANGECASE_TOOLTIP="用不同的大小写模式复制并返回这段文字。",i.Msg.TEXT_CHARAT_FIRST="获取第一个字符",i.Msg.TEXT_CHARAT_FROM_END="获取倒数第#个字符",i.Msg.TEXT_CHARAT_FROM_START="获取第#个字符",i.Msg.TEXT_CHARAT_HELPURL="https://github.com/google/blockly/wiki/Text#extracting-text",i.Msg.TEXT_CHARAT_LAST="获取最后一个字符",i.Msg.TEXT_CHARAT_RANDOM="获取随机一个字符",i.Msg.TEXT_CHARAT_TAIL="",i.Msg.TEXT_CHARAT_TITLE="在文本%1 里 %2",i.Msg.TEXT_CHARAT_TOOLTIP="返回位于指定位置的字符。",i.Msg.TEXT_COUNT_HELPURL="https://github.com/google/blockly/wiki/Text#counting-substrings",i.Msg.TEXT_COUNT_MESSAGE0="计算%1在%2里出现的次数",i.Msg.TEXT_COUNT_TOOLTIP="计算在一段文本中，某个部分文本重复出现了多少次。",i.Msg.TEXT_CREATE_JOIN_ITEM_TOOLTIP="将一个项添加到文本中。",i.Msg.TEXT_CREATE_JOIN_TITLE_JOIN="拼接",i.Msg.TEXT_CREATE_JOIN_TOOLTIP="添加、移除或重新排列各节来重新配置这个文本块。",i.Msg.TEXT_GET_SUBSTRING_END_FROM_END="到倒数第#个字符",i.Msg.TEXT_GET_SUBSTRING_END_FROM_START="到第#个字符",i.Msg.TEXT_GET_SUBSTRING_END_LAST="到最后一个字符",i.Msg.TEXT_GET_SUBSTRING_HELPURL="https://github.com/google/blockly/wiki/Text#extracting-a-region-of-text",i.Msg.TEXT_GET_SUBSTRING_INPUT_IN_TEXT="从文本",i.Msg.TEXT_GET_SUBSTRING_START_FIRST="获取子串，从第一个字符",i.Msg.TEXT_GET_SUBSTRING_START_FROM_END="获取子串，从倒数第#个字符",i.Msg.TEXT_GET_SUBSTRING_START_FROM_START="获取子串，从第#个字符",i.Msg.TEXT_GET_SUBSTRING_TAIL="",i.Msg.TEXT_GET_SUBSTRING_TOOLTIP="返回文本中指定的一部分。",i.Msg.TEXT_INDEXOF_HELPURL="https://github.com/google/blockly/wiki/Text#finding-text",i.Msg.TEXT_INDEXOF_OPERATOR_FIRST="寻找第一次出现的文本",i.Msg.TEXT_INDEXOF_OPERATOR_LAST="寻找最后一次出现的文本",i.Msg.TEXT_INDEXOF_TITLE="在文本 %1 里 %2  %3",i.Msg.TEXT_INDEXOF_TOOLTIP="返回第一个文本段在第二个文本段中的第一/最后一个匹配项的起始位置。如果未找到，则返回%1。",i.Msg.TEXT_ISEMPTY_HELPURL="https://github.com/google/blockly/wiki/Text#checking-for-empty-text",i.Msg.TEXT_ISEMPTY_TITLE="%1是空的",i.Msg.TEXT_ISEMPTY_TOOLTIP="如果给定的文本为空，则返回真。",i.Msg.TEXT_JOIN_HELPURL="https://github.com/google/blockly/wiki/Text#text-creation",i.Msg.TEXT_JOIN_TITLE_CREATEWITH="创建文本，内容：",i.Msg.TEXT_JOIN_TOOLTIP="通过串起任意数量的项以建立一段文本。",i.Msg.TEXT_LENGTH_HELPURL="https://github.com/google/blockly/wiki/Text#text-modification",i.Msg.TEXT_LENGTH_TITLE="%1的长度",i.Msg.TEXT_LENGTH_TOOLTIP="返回给定文本的字母数（包括空格）。",i.Msg.TEXT_PRINT_HELPURL="https://github.com/google/blockly/wiki/Text#printing-text",i.Msg.TEXT_PRINT_TITLE="输出%1",i.Msg.TEXT_PRINT_TOOLTIP="输出指定的文字、数字或其他值。",i.Msg.TEXT_PROMPT_HELPURL="https://github.com/google/blockly/wiki/Text#getting-input-from-the-user",i.Msg.TEXT_PROMPT_TOOLTIP_NUMBER="要求用户输入数字。",i.Msg.TEXT_PROMPT_TOOLTIP_TEXT="要求用户输入一些文本。",i.Msg.TEXT_PROMPT_TYPE_NUMBER="要求输入数字，并显示提示消息",i.Msg.TEXT_PROMPT_TYPE_TEXT="要求输入文本，并显示提示消息",i.Msg.TEXT_REPLACE_HELPURL="https://github.com/google/blockly/wiki/Text#replacing-substrings",i.Msg.TEXT_REPLACE_MESSAGE0="把%3中的%1替换为%2",i.Msg.TEXT_REPLACE_TOOLTIP="在一段文本中，将出现过的某部分文本都替换掉。",i.Msg.TEXT_REVERSE_HELPURL="https://github.com/google/blockly/wiki/Text#reversing-text",i.Msg.TEXT_REVERSE_MESSAGE0="倒转文本%1",i.Msg.TEXT_REVERSE_TOOLTIP="将文本中各个字符的顺序倒转。",i.Msg.TEXT_TEXT_HELPURL="https://zh.wikipedia.org/wiki/字符串",i.Msg.TEXT_TEXT_TOOLTIP="一个字、词语或一行文本。",i.Msg.TEXT_TRIM_HELPURL="https://github.com/google/blockly/wiki/Text#trimming-removing-spaces",i.Msg.TEXT_TRIM_OPERATOR_BOTH="消除其两侧的空白",i.Msg.TEXT_TRIM_OPERATOR_LEFT="消除其左侧的空白",i.Msg.TEXT_TRIM_OPERATOR_RIGHT="消除其右侧的空白",i.Msg.TEXT_TRIM_TOOLTIP="从某一端或同时从两端删除多余的空白，并返回这段文字的一个副本。",i.Msg.TODAY="今天",i.Msg.UNDO="撤销",i.Msg.UNNAMED_KEY="未命名",i.Msg.VARIABLES_DEFAULT_NAME="项目",i.Msg.VARIABLES_GET_CREATE_SET="创建“设定%1”",i.Msg.VARIABLES_GET_HELPURL="https://github.com/google/blockly/wiki/Variables#get",i.Msg.VARIABLES_GET_TOOLTIP="返回此变量的值。",i.Msg.VARIABLES_SET="赋值 %1 为 %2",i.Msg.VARIABLES_SET_CREATE_GET="创建“获得%1”",i.Msg.VARIABLES_SET_HELPURL="https://github.com/google/blockly/wiki/Variables#set",i.Msg.VARIABLES_SET_TOOLTIP="设置此变量，以使它和输入值相等。",i.Msg.VARIABLE_ALREADY_EXISTS="名字叫“%1”的变量已经存在了。",i.Msg.VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE="名字叫“%1”的变量已经有了另一个类型：“%2”。",i.Msg.WORKSPACE_ARIA_LABEL="Blockly工作区",i.Msg.WORKSPACE_COMMENT_DEFAULT_TEXT="说点什么...",i.Msg.CONTROLS_FOREACH_INPUT_DO=i.Msg.CONTROLS_REPEAT_INPUT_DO,i.Msg.CONTROLS_FOR_INPUT_DO=i.Msg.CONTROLS_REPEAT_INPUT_DO,i.Msg.CONTROLS_IF_ELSEIF_TITLE_ELSEIF=i.Msg.CONTROLS_IF_MSG_ELSEIF,i.Msg.CONTROLS_IF_ELSE_TITLE_ELSE=i.Msg.CONTROLS_IF_MSG_ELSE,i.Msg.CONTROLS_IF_IF_TITLE_IF=i.Msg.CONTROLS_IF_MSG_IF,i.Msg.CONTROLS_IF_MSG_THEN=i.Msg.CONTROLS_REPEAT_INPUT_DO,i.Msg.CONTROLS_WHILEUNTIL_INPUT_DO=i.Msg.CONTROLS_REPEAT_INPUT_DO,i.Msg.LISTS_CREATE_WITH_ITEM_TITLE=i.Msg.VARIABLES_DEFAULT_NAME,i.Msg.LISTS_GET_INDEX_HELPURL=i.Msg.LISTS_INDEX_OF_HELPURL,i.Msg.LISTS_GET_INDEX_INPUT_IN_LIST=i.Msg.LISTS_INLIST,i.Msg.LISTS_GET_SUBLIST_INPUT_IN_LIST=i.Msg.LISTS_INLIST,i.Msg.LISTS_INDEX_OF_INPUT_IN_LIST=i.Msg.LISTS_INLIST,i.Msg.LISTS_SET_INDEX_INPUT_IN_LIST=i.Msg.LISTS_INLIST,i.Msg.MATH_CHANGE_TITLE_ITEM=i.Msg.VARIABLES_DEFAULT_NAME,i.Msg.PROCEDURES_DEFRETURN_COMMENT=i.Msg.PROCEDURES_DEFNORETURN_COMMENT,i.Msg.PROCEDURES_DEFRETURN_DO=i.Msg.PROCEDURES_DEFNORETURN_DO,i.Msg.PROCEDURES_DEFRETURN_PROCEDURE=i.Msg.PROCEDURES_DEFNORETURN_PROCEDURE,i.Msg.PROCEDURES_DEFRETURN_TITLE=i.Msg.PROCEDURES_DEFNORETURN_TITLE,i.Msg.TEXT_APPEND_VARIABLE=i.Msg.VARIABLES_DEFAULT_NAME,i.Msg.TEXT_CREATE_JOIN_ITEM_TITLE_ITEM=i.Msg.VARIABLES_DEFAULT_NAME,i.Msg.MATH_HUE="230",i.Msg.LOOPS_HUE="120",i.Msg.LISTS_HUE="260",i.Msg.LOGIC_HUE="210",i.Msg.VARIABLES_HUE="330",i.Msg.TEXTS_HUE="160",i.Msg.PROCEDURES_HUE="290",i.Msg.COLOUR_HUE="20",i.Msg.VARIABLES_DYNAMIC_HUE="310",i.Msg})}(vg)),vg.exports}var aI=aB();const lB=rm(aI),cB=Tw({__proto__:null,default:lB},[aI]),uB=`
  .blocklyFieldParameter>rect {
    fill: rgb(222, 143, 108);
    fill-opacity: 1.0;
    stroke-width: 2;
    stroke: rgb(231, 175, 150);
  }
  .blocklyFieldParameter>text {
    stroke-width: 1;
    fill: #000;
  }
  .blocklyFieldParameter:hover>rect {
    stroke-width: 2;
    stroke: rgb(231,175,150);
    fill: rgb(231,175,150);
    fill-opacity: 1.0;
  }
  /*
   * [lyn, 10/08/13] Control flydown with the getter/setter blocks.
   */
  .blocklyFieldParameterFlydown {
    fill: rgb(231,175,150);
    fill-opacity: 0.8;
  }
  /*
   * [lyn, 10/08/13] Control parameter fields with flydown procedure
   * caller block.
   */
  .blocklyFieldProcedure>rect {
    fill: rgb(215,203,218);
    fill-opacity: 1.0;
    stroke-width: 0;
    stroke: #000;
  }
  .blocklyFieldProcedure>text {
    fill: #000;
  }
  .blocklyFieldProcedure:hover>rect {
    stroke-width: 2;
    stroke: #fff;
    fill: rgb(215,203,218);
    fill-opacity: 1.0;
  }
  /*
   * [lyn, 10/08/13] Control flydown with the procedure caller block.
   */
  .blocklyFieldProcedureFlydown {
    fill: rgb(215,203,218);
    fill-opacity: 0.8;
  }
`;function hB(){A.Css.register(uB)}/**
 * @license
 * Copyright 2021 Mark Friedman
 * SPDX-License-Identifier: Apache-2.0
 */A.Msg.LANG_VARIABLES_GLOBAL_DECLARATION_TITLE_INIT="initialize global";A.Msg.LANG_VARIABLES_GLOBAL_DECLARATION_NAME="name";A.Msg.LANG_VARIABLES_GLOBAL_DECLARATION_TO="to";A.Msg.LANG_VARIABLES_GLOBAL_DECLARATION_COLLAPSED_TEXT="global";A.Msg.LANG_VARIABLES_GLOBAL_DECLARATION_TOOLTIP="Creates a global variable and gives it the value of the attached blocks.";A.Msg.LANG_VARIABLES_GLOBAL_PREFIX="global";A.Msg.LANG_VARIABLES_GET_TITLE_GET="get";A.Msg.LANG_VARIABLES_GET_COLLAPSED_TEXT="get";A.Msg.LANG_VARIABLES_GET_TOOLTIP="Returns the value of this variable.";A.Msg.LANG_VARIABLES_SET_TITLE_SET="set";A.Msg.LANG_VARIABLES_SET_TITLE_TO="to";A.Msg.LANG_VARIABLES_SET_COLLAPSED_TEXT="set";A.Msg.LANG_VARIABLES_SET_TOOLTIP="Sets this variable to be equal to the input.";A.Msg.LANG_VARIABLES_VARIABLE=" variable";A.Msg.LANG_VARIABLES_LOCAL_DECLARATION_TITLE_INIT="initialize local";A.Msg.LANG_VARIABLES_LOCAL_DECLARATION_DEFAULT_NAME="name";A.Msg.LANG_VARIABLES_LOCAL_DECLARATION_INPUT_TO="to";A.Msg.LANG_VARIABLES_LOCAL_DECLARATION_IN_DO="in";A.Msg.LANG_VARIABLES_LOCAL_DECLARATION_COLLAPSED_TEXT="local";A.Msg.LANG_VARIABLES_LOCAL_DECLARATION_TOOLTIP="Allows you to create variables that are only accessible in the do part of this block.";A.Msg.LANG_VARIABLES_LOCAL_DECLARATION_TRANSLATED_NAME="initialize local in do";A.Msg.LANG_VARIABLES_LOCAL_DECLARATION_EXPRESSION_IN_RETURN="in";A.Msg.LANG_VARIABLES_LOCAL_DECLARATION_EXPRESSION_COLLAPSED_TEXT="local";A.Msg.LANG_VARIABLES_LOCAL_DECLARATION_EXPRESSION_TOOLTIP="Allows you to create variables that are only accessible in the return part of this block.";A.Msg.LANG_VARIABLES_LOCAL_DECLARATION_EXPRESSION_TRANSLATED_NAME="initialize local in return";A.Msg.LANG_VARIABLES_LOCAL_MUTATOR_CONTAINER_TITLE_LOCAL_NAMES="local names";A.Msg.LANG_VARIABLES_LOCAL_MUTATOR_CONTAINER_TOOLTIP="";A.Msg.LANG_VARIABLES_LOCAL_MUTATOR_ARG_TITLE_NAME="name";A.Msg.LANG_VARIABLES_LOCAL_MUTATOR_ARG_DEFAULT_VARIABLE="x";A.Msg.LANG_PROCEDURES_DEFNORETURN_DEFINE="to";A.Msg.LANG_PROCEDURES_DEFNORETURN_PROCEDURE="procedure";A.Msg.LANG_PROCEDURES_DEFNORETURN_DO="do";A.Msg.LANG_PROCEDURES_DEFNORETURN_COLLAPSED_PREFIX="to ";A.Msg.LANG_PROCEDURES_DEFNORETURN_TOOLTIP="A procedure that does not return a value.";A.Msg.LANG_PROCEDURES_DOTHENRETURN_THEN_RETURN="result";A.Msg.LANG_PROCEDURES_DOTHENRETURN_DO="do";A.Msg.LANG_PROCEDURES_DOTHENRETURN_RETURN="result";A.Msg.LANG_PROCEDURES_DOTHENRETURN_TOOLTIP="Runs the blocks in 'do' and returns a statement. Useful if you need to run a procedure before returning a value to a variable.";A.Msg.LANG_PROCEDURES_DOTHENRETURN_COLLAPSED_TEXT="do/result";A.Msg.LANG_PROCEDURES_DEFRETURN_DEFINE="to";A.Msg.LANG_PROCEDURES_DEFRETURN_PROCEDURE="procedure";A.Msg.LANG_PROCEDURES_DEFRETURN_RETURN="result";A.Msg.LANG_PROCEDURES_DEFRETURN_COLLAPSED_PREFIX="to ";A.Msg.LANG_PROCEDURES_DEFRETURN_TOOLTIP="A procedure returning a result value.";A.Msg.LANG_PROCEDURES_DEF_DUPLICATE_WARNING=`Warning:
This procedure has
duplicate inputs.`;A.Msg.LANG_PROCEDURES_CALLNORETURN_CALL="call ";A.Msg.LANG_PROCEDURES_CALLNORETURN_PROCEDURE="procedure";A.Msg.LANG_PROCEDURES_CALLNORETURN_COLLAPSED_PREFIX="call ";A.Msg.LANG_PROCEDURES_CALLNORETURN_TOOLTIP="Call a procedure with no return value.";A.Msg.LANG_PROCEDURES_CALLNORETURN_TRANSLATED_NAME="call no return";A.Msg.LANG_PROCEDURES_CALLRETURN_COLLAPSED_PREFIX="call ";A.Msg.LANG_PROCEDURES_CALLRETURN_TOOLTIP="Call a procedure with a return value.";A.Msg.LANG_PROCEDURES_CALLRETURN_TRANSLATED_NAME="call return";A.Msg.LANG_PROCEDURES_MUTATORCONTAINER_TITLE="inputs";A.Msg.LANG_PROCEDURES_MUTATORARG_TITLE="input:";A.Msg.LANG_PROCEDURES_HIGHLIGHT_DEF="Highlight Procedure";A.Msg.LANG_PROCEDURES_MUTATORCONTAINER_TOOLTIP="";A.Msg.LANG_PROCEDURES_MUTATORARG_TOOLTIP="";A.Msg.LANG_CONTROLS_FOR_INPUT_WITH="count with";A.Msg.LANG_CONTROLS_FOR_INPUT_VAR="x";A.Msg.LANG_CONTROLS_FOR_INPUT_FROM="from";A.Msg.LANG_CONTROLS_FOR_INPUT_TO="to";A.Msg.LANG_CONTROLS_FOR_INPUT_DO="do";A.Msg.LANG_CONTROLS_FOR_TOOLTIP=`Count from a start number to an end number.
For each count, set the current count number to
variable '%1', and then do some statements.`;A.Msg.LANG_CONTROLS_FORRANGE_INPUT_ITEM="for each";A.Msg.LANG_CONTROLS_FORRANGE_INPUT_VAR="number";A.Msg.LANG_CONTROLS_FORRANGE_INPUT_START="from";A.Msg.LANG_CONTROLS_FORRANGE_INPUT_END="to";A.Msg.LANG_CONTROLS_FORRANGE_INPUT_STEP="by";A.Msg.LANG_CONTROLS_FORRANGE_INPUT_DO="do";A.Msg.LANG_CONTROLS_FORRANGE_INPUT_COLLAPSED_TEXT="for number in range";A.Msg.LANG_CONTROLS_FORRANGE_INPUT_COLLAPSED_PREFIX="for";A.Msg.LANG_CONTROLS_FORRANGE_INPUT_COLLAPSED_SUFFIX=" in range";A.Msg.LANG_CONTROLS_FORRANGE_TOOLTIP="Runs the blocks in the 'do' section for each numeric value in the range from start to end, stepping the value each time.  Use the given variable name to refer to the current value.";A.Msg.LANG_CONTROLS_FOREACH_INPUT_ITEM="for each";A.Msg.LANG_CONTROLS_FOREACH_INPUT_VAR="item";A.Msg.LANG_CONTROLS_FOREACH_INPUT_INLIST="in list";A.Msg.LANG_CONTROLS_FOREACH_INPUT_DO="do";A.Msg.LANG_CONTROLS_FOREACH_INPUT_COLLAPSED_TEXT="for item in list";A.Msg.LANG_CONTROLS_FOREACH_INPUT_COLLAPSED_PREFIX="for ";A.Msg.LANG_CONTROLS_FOREACH_INPUT_COLLAPSED_SUFFIX=" in list";A.Msg.LANG_CONTROLS_FOREACH_TOOLTIP="Runs the blocks in the 'do'  section for each item in the list.  Use the given variable name to refer to the current list item.";A.Msg.LANG_CONTROLS_FOREACH_DICT_INPUT="for each %1 with %2 in dictionary %3";A.Msg.LANG_CONTROLS_FOREACH_DICT_INPUT_DO="do";A.Msg.LANG_CONTROLS_FOREACH_DICT_INPUT_KEY="key";A.Msg.LANG_CONTROLS_FOREACH_DICT_INPUT_VALUE="value";A.Msg.LANG_CONTROLS_FOREACH_DICT_TITLE="for each in dictionary";A.Msg.LANG_CONTROLS_FOREACH_DICT_TOOLTIP="Runs the blocks in the 'do' section for each key-value entry in the dictionary. Use the given variable names to refer to the key/value of the current dictionary item.";A.Msg.ERROR_SELECT_VALID_ITEM_FROM_DROPDOWN="Select a valid item in the drop down.";A.Msg.ERROR_BLOCK_CANNOT_BE_IN_DEFINITION="This block cannot be in a definition";A.Msg.HORIZONTAL_PARAMETERS="Arrange Parameters Horizontally";A.Msg.VERTICAL_PARAMETERS="Arrange Parameters Vertically";A.Msg.LANG_CONTROLS_DO_THEN_RETURN_INPUT_DO="do";A.Msg.LANG_CONTROLS_DO_THEN_RETURN_INPUT_RETURN="result";A.Msg.LANG_CONTROLS_DO_THEN_RETURN_TOOLTIP="Runs the blocks in 'do' and returns a statement. Useful if you need to run a procedure before returning a value to a variable.";A.Msg.LANG_CONTROLS_DO_THEN_RETURN_COLLAPSED_TEXT="do/result";A.Msg.LANG_CONTROLS_DO_THEN_RETURN_TITLE="do result";const R$=function(s,n){return!s.sourceBlock_.rendered||!n.sourceBlock_.rendered?(n.check_&&!n.check_.includes("InstantInTime")&&n.sourceBlock_.badBlock(),true):!n.check_||n.check_.includes("InstantInTime")},dB={number:{input:["Number"],output:["Number","String","Key"]},text:{input:["String"],output:["Number","String","Key"]},boolean:{input:["Boolean"],output:["Boolean","String"]},list:{input:["Array"],output:["Array","String"]},component:{input:["COMPONENT"],output:["COMPONENT","Key"]},InstantInTime:{input:["InstantInTime",R$],output:["InstantInTime",R$]},any:{input:null,output:null},dictionary:{input:["Dictionary"],output:["Dictionary","String","Array"]},pair:{input:["Pair"],output:["Pair","String","Array"]},key:{input:["Key"],output:["String","Key"]}},Gu="input",Hu=function(s,n){const i=dB[s][n];if(i===void 0)throw new Error("Unknown Yail type: "+s+" -- YailTypeToBlocklyType");return i},Th=function(s){return s.children!==void 0?s.children:Array.prototype.filter.call(s.childNodes,function(n){return n.nodeType==A.utils.dom.NodeType.ELEMENT_NODE})},_c=function(s){if(!s.getSvgRoot()||s.readOnly){s.hasWarning&&(s.hasWarning=false),s.hasError&&(s.hasError=false);return}s.errors||(s.errors=[]),s.warnings||(s.warnings=[]);const n=s.errors,i=s.warnings;for(let o=0;o<n.length;o++)if(n[o].func&&n[o].func.call(this,s,n[o])){s.hasError||(s.hasError=true),s.hasWarning&&(s.hasWarning=false);return}s.hasError&&(s.hasError=false);for(let o=0;o<i.length;o++)if(i[o].func&&i[o].func.call(this,s,i[o])){s.hasWarning||(s.hasWarning=true);return}s.warning&&s.setWarningText(null),s.hasWarning&&(s.hasWarning=false)},pc=function(s){if(s.getRootBlock().type==="global_declaration"){const i=A.Msg.ERROR_BLOCK_CANNOT_BE_IN_DEFINITION;return s.setWarningText(i),true}else return false},gc=function(s,n){if(s.workspace.isDragging())return false;for(let i=0;i<n.dropDowns.length;i++){const o=s.getField(n.dropDowns[i]),l=o.menuGenerator_(),f=o.getText(),m=o.getValue();let u=false;o.updateMutation&&o.updateMutation();for(let _=0;_<l.length;_++)if(l[_][1]===m&&m!==" "){u=true,l[_][0]!==f&&o.setValue(l[_][0]);break}if(!u){const _=A.Msg.ERROR_SELECT_VALID_ITEM_FROM_DROPDOWN;return s.setWarningText(_),true}}return false},_B=Object.freeze(Object.defineProperty({__proto__:null,checkDropDownContainsValidValue:gc,checkErrors:_c,checkIsInDefinition:pc},Symbol.toStringTag,{value:"Module"})),sc="global",lI="input",cI="local",pB="item",gB="counter",Qn=" ",Lf=function(s){return function(n){return""+n}},fB=function(s){return A.Msg.LANG_VARIABLES_GLOBAL_PREFIX+Qn+s},uI=function(s){return s.indexOf(A.Msg.LANG_VARIABLES_GLOBAL_PREFIX+Qn)===0?[A.Msg.LANG_VARIABLES_GLOBAL_PREFIX,s.substring(A.Msg.LANG_VARIABLES_GLOBAL_PREFIX.length+Qn.length)]:s.indexOf(sc+Qn)===0?[sc,s.substring(6+Qn.length)]:["",s]},mB=function(s){return function(n){return""+n}};/**
 * @license
 * @fileoverview Drop-down chooser of variables in the current lexical scope
 *     for App Inventor.
 * @author fturbak@wellesley.com (Lyn Turbak)
 */class bt extends A.FieldDropdown{constructor(n){super(bt.dropdownCreate,bt.dropdownChange),n?this.doValueUpdate_(n):this.doValueUpdate_(A.Variables.generateUniqueName())}setValue(n){if(n&&n!==" "){const i=n.split(" ");i.length==2&&i[0]!=="global"&&(n="global "+i[1])}super.setValue(n)}}bt.prototype.doClassValidation_=function(s){return s};bt.prototype.getBlock=function(){return this.block_};bt.prototype.setBlock=function(s){this.block_=s};bt.getGlobalNames=function(s){if(A.common.getMainWorkspace()&&A.common.getMainWorkspace().getWarningHandler&&A.common.getMainWorkspace().getWarningHandler().cacheGlobalNames)return A.common.getMainWorkspace().getWarningHandler().cachedGlobalNames;const n=[];if(A.common.getMainWorkspace()){let i=[];i=A.common.getMainWorkspace().getTopBlocks();for(let o=0;o<i.length;o++){const l=i[o];l.getGlobalNames&&l!=s&&n.push(...l.getGlobalNames())}}return n};bt.prototype.getNamesInScope=function(){return bt.getNamesInScope(this.block_)};bt.getNamesInScope=function(s){let n=bt.getGlobalNames();n=Ce.sortAndRemoveDuplicates(n),n=n.map(function(o){return[fB(o),"global "+o]});const i=bt.getLexicalNamesInScope(s);return n.concat(i)};bt.getLexicalNamesInScope=function(s){let n=[];const i={};let o,l;function f(m,u,_){let c;i[m]||(i[m]=_),c=Lf(i[m])(m),u.push(c)}if(l=s,l&&(o=l.getParent(),o))for(;o;)o.withLexicalVarsAndPrefix&&o.withLexicalVarsAndPrefix(l,(m,u)=>{f(m,n,u)}),l=o,o=o.getParent();return n=Ce.sortAndRemoveDuplicates(n),n.map(function(m){return[m,m]})};bt.dropdownCreate=function(){const s=this.getNamesInScope();return s.length==0?[[" "," "]]:s};bt.prototype.doValueUpdate_=function(s){Object.getPrototypeOf(A.FieldDropdown).prototype.doValueUpdate_.call(this,s);function n(o){return o.startsWith("global ")?o.replace("global ",A.Msg.LANG_VARIABLES_GLOBAL_PREFIX+" "):o}const i=this.getOptions(true,[[n(s),s]]);for(let o=0,l;l=i[o];o++)if(l[1]==this.value_){this.selectedOption_=l;break}this.forceRerender()};bt.prototype.getOptions=function(s,n){Array.isArray(s)&&(n=s);const i=n||[];return this.isOptionListDynamic()?((!this.generatedOptions_||!s)&&(this.generatedOptions_=this.menuGenerator_.call(this).concat(i),EB(this.generatedOptions_)),this.generatedOptions_.concat(i)):this.menuGenerator_};const EB=function(s){if(!Array.isArray(s))throw TypeError("FieldDropdown options must be an array.");if(!s.length)throw TypeError("FieldDropdown options must not be an empty array.");let n=false;for(let i=0;i<s.length;++i){const o=s[i];Array.isArray(o)?typeof o[1]!="string"?(n=true,console.error("Invalid option["+i+"]: Each FieldDropdown option id must be a string. Found "+o[1]+" in: ",o)):o[0]&&typeof o[0]!="string"&&typeof o[0].src!="string"&&(n=true,console.error("Invalid option["+i+"]: Each FieldDropdown option must have a string label or image description. Found"+o[0]+" in: ",o)):(n=true,console.error("Invalid option["+i+"]: Each FieldDropdown option must be an array. Found: ",o))}if(n)throw TypeError("Found invalid FieldDropdown options.")};bt.dropdownChange=function(s){if(s){this.doValueUpdate_(s);const n=this.sourceBlock_.workspace.getTopWorkspace();n.getWarningHandler&&n.getWarningHandler().checkErrors(this.sourceBlock_)}};bt.nameNotIn=function(s,n){const i=bt.prefixSuffix(s),o=i[0],l=i[1];let f=false,m=false;const u=[];for(let _=0;_<n.length;_++){const c=bt.prefixSuffix(n[_]),h=c[0],p=c[1];h===o&&(p===l&&(m=true),p===""?f=true:u.push(p))}if(m)if(f){const _=u.map(function(p,T,$){return parseInt(p,10)});_.sort(function(p,T){return p-T});let c=2,h=0;for(;h<_.length;){if(c<_[h])return o+c;c==_[h]&&c++,h++}return o+c}else return o;else return s};bt.prefixSuffix=function(s){const n=s.match(/^(.*?)(\d+)$/);return n?[n[1],n[2]]:[s,""]};bt.fromJson=function(s){const n=A.utils.replaceMessageReferences(s.name);return new bt(n)};A.fieldRegistry.register("field_lexical_variable",bt);const Ce={};Ce.renameGlobal=function(s){const n=this.value_;s=Ce.makeLegalIdentifier(s),this.sourceBlock_.getField("NAME").doValueUpdate_(s);const i=bt.getGlobalNames(this.sourceBlock_);if(s=bt.nameNotIn(s,i),this.sourceBlock_.rendered&&A.common.getMainWorkspace()){const o=A.common.getMainWorkspace().getAllBlocks();for(let l=0;l<o.length;l++){const f=o[l],m=f.renameLexicalVar;m&&m.call(f,sc+Qn+n,sc+Qn+s,A.Msg.LANG_VARIABLES_GLOBAL_PREFIX+Qn+n,A.Msg.LANG_VARIABLES_GLOBAL_PREFIX+Qn+s)}}return s};Ce.renameParam=function(s){const n=this.htmlInput_,i=this.getValue()||n&&n.defaultValue||this.getText();return s=Ce.makeLegalIdentifier(s),Ce.renameParamFromTo(this.sourceBlock_,i,s,false)};Ce.renameParamFromTo=function(s,n,i,o){return s.mustNotRenameCapturables?Ce.renameParamWithoutRenamingCapturables(s,n,i,[]):o?(Ce.renameParamRenamingCapturables(s,n,i),i):Ce.renameParamWithoutRenamingCapturables(s,n,i,[])};Ce.renameParamRenamingCapturables=function(s,n,i){if(i!==n){const o=s.declaredNames?s.declaredNames():[];if(o.indexOf(n)==-1)throw Error("LexicalVariable.renamingCapturables: oldName "+n+" is not in declarations {"+o.join(",")+"}");const l=[];bt.getNamesInScope(s).map(function(m){m[0]==m[1]?l.push(m[0]):l.push(m[0],m[1])});const f=o.concat(l);if(f.indexOf(i)!=-1)throw Error("LexicalVariable.renameParamRenamingCapturables: newName "+i+" is in existing declarations {"+f.join(",")+"}");if(s.renameBound){const m=A.Substitution.simpleSubstitution(n,i),u=new A.Substitution;s.renameBound(m,u)}else throw Error("LexicalVariable.renameParamRenamingCapturables: block "+s.type+" is not a declaration block.")}};Ce.renameFree=function(s,n){s&&(s.renameFree?s.renameFree(n):s.getChildren().map(function(i){Ce.renameFree(i,n)}))};Ce.freeVariables=function(s){let n=[];if(!s)n=new A.NameSet;else if(s.freeVariables)n=s.freeVariables();else{const i=s.getChildren().map(function(o){return Ce.freeVariables(o)});n=A.NameSet.unionAll(i)}return n};Ce.renameParamWithoutRenamingCapturables=function(s,n,i,o){if(n===i)return n;s.declaredNames&&s.declaredNames();const f=Ce.renameParamWithoutRenamingCapturablesInfo(s,n,""),m=f[0],u=f[1];let _=[];if(s.declaredNames){_=s.declaredNames();const h=_.indexOf(n);if(h!=-1&&_.splice(h,1),o.indexOf(i)!=-1){const p=_.indexOf(i);p!=-1&&_.splice(p,1)}}const c=Ce.sortAndRemoveDuplicates(u.concat(_));if(i=bt.nameNotIn(i,c),i!==n&&!(_.indexOf(n)!=-1))for(let p=0;p<m.length;p++){const T=m[p],$=T.renameLexicalVar;$&&$.call(T,Lf()(n),Lf()(i))}return i};Ce.renameParamWithoutRenamingCapturablesInfo=function(s,n,i){let o=[];s.blocksInScope&&(o=s.blocksInScope());const l=o.map(function(u){return Ce.referenceResult(u,n,i,[])});let f=[],m=[];for(let u=0;u<l.length;u++)f=f.concat(l[u][0]),m=m.concat(l[u][1]);return m=Ce.sortAndRemoveDuplicates(m),[f,m]};Ce.checkIdentifier=function(s){const n=s.trim().replace(/[\s\xa0]+/g,"_"),i="^[^-0-9!&%^/>=<`'\"#:;,\\\\*+.()|{}[\\] ]",o=`[^-!&%^/>=<'"#:;,\\\\*+.()|{}[\\] ]*$`,l=new RegExp(i+o);return{isLegal:n.search(l)==0,transformed:n}};Ce.makeLegalIdentifier=function(s){const n=Ce.checkIdentifier(s);return n.isLegal?n.transformed:n.transformed===""?"_":"name"};Ce.referenceResult=function(s,n,i,o){if(!s)return[[],[]];const l=s.referenceResults?s.referenceResults(n,i,o):s.getChildren().map(function(u){return Ce.referenceResult(u,n,i,o)});let f=[],m=[];for(let u=0;u<l.length;u++)f=f.concat(l[u][0]),m=m.concat(l[u][1]);return[f,m]};Ce.sortAndRemoveDuplicates=function(s){const n=s.sort(),i=[];if(s.length>=1){let o=n[0];i.push(o);for(let l=1;l<n.length;l++)n[l]!==o&&(o=n[l],i.push(o))}return i};Ce.getNextTargetBlock=function(s){return s&&s.nextConnection&&s.nextConnection.targetBlock()?s.nextConnection.targetBlock():null};Ce.stringListsEqual=function(s,n){const i=s.length,o=n.length;if(i!==o)return false;for(let l=0;l<i;l++)if(s[l]!==n[l])return false;return true};/**
 * @license
 * @fileoverview Visual blocks editor for App Inventor
 * Methods to handle serialization of the blocks workspace.
 *
 * @author sharon@google.com (Sharon Perl)
 */const vB=["",""],sh=function(s){let n=this.block.workspace.getTopWorkspace();if(!this.block.isEditable()){n=A.Drawer.flyout_.workspace_;return}const i=n.getProcedureDatabase().getProcedure(s);if(!i)return;const o=i.getFieldValue("NAME");if(o==""||o!=this.getValue())for(let l=0;this.block.getInput("ARG"+l)!=null;l++)this.block.removeInput("ARG"+l);this.doValueUpdate_(o),i&&this.block.setProcedureParameters(i.arguments_,i.paramIds_,true)},hI=function(s,n){const o=(n||A.common.getMainWorkspace()).getTopBlocks(),l=[vB];for(let f=0;f<o.length;f++){const m=o[f].getFieldValue("NAME");o[f].type=="procedures_defnoreturn"&&!s?l.push([m,m]):o[f].type=="procedures_defreturn"&&s&&l.push([m,m])}return l.length>1&&l.splice(0,1),l},bB=function(s){const n=s.workspace.getTopBlocks(false),i=[];for(let o=0;o<n.length;o++)(n[o].type==="procedures_defnoreturn"||n[o].type==="procedures_defreturn")&&n[o]!==s&&i.push(n[o]);return i},TB=function(s,n){if(n&&n===A.common.getMainWorkspace()){const i=n.getAllBlocks();for(let o=0;o<i.length;o++){const l=i[o];(l.type=="procedures_callreturn"||l.type=="procedures_callnoreturn")&&l.getFieldValue("PROCNAME")==s&&l.removeProcedureValue()}}},SB=function(s){const n=this.oldName_||this.getValue(),i=s;s=Ce.makeLegalIdentifier(s);const l=bB(this.sourceBlock_).map(function(m){return m.getFieldValue("NAME")});s=bt.nameNotIn(s,l),s!==i&&this.doValueUpdate_(s);const f=this.sourceBlock_.workspace.getAllBlocks();for(let m=0;m<f.length;m++){const u=f[m].renameProcedure;u&&u.call(f[m],n,s)}return this.oldName_=s,s};/**
 * @license
 * Copyright © 2016-2017 Massachusetts Institute of Technology. All rights
 *     reserved.
 */const Mi=function(s){this.workspace_=s,this.procedures_={},this.returnProcedures_={},this.voidProcedures_={},this.length=0,this.returnProcedures=0,this.voidProcedures=0};Mi.defaultValue=["","none"];Mi.prototype.getNames=function(s){return hI(s,this.workspace_).map(function(n){return n[0]})};Mi.prototype.getMenuItems=function(s){return hI(s,this.workspace_)};Mi.prototype.getDeclarationBlocks=function(s){return A.utils.object.values(s?this.returnProcedures_:this.voidProcedures_)};Mi.prototype.getDeclarationsBlocksExcept=function(s){const n=[];return A.utils.values(this.procedures_).forEach(function(i){i!==s&&n.push(i)}),n};Mi.prototype.getAllDeclarationNames=function(){return A.utils.values(this.procedures_).map(function(s){return s.getFieldValue("NAME")})};Mi.prototype.addProcedure=function(s,n){if(n.type!="procedures_defnoreturn"&&n.type!="procedures_defreturn")return console.warn("Attempt to addProcedure with block type "+n.type),false;const i=n.id;return i in this.procedures_?false:(this.procedures_[i]=n,this.length++,n.type=="procedures_defnoreturn"?(this.voidProcedures_[i]=n,this.voidProcedures++):(this.returnProcedures_[i]=n,this.returnProcedures++),true)};Mi.prototype.removeProcedure=function(s){return s in this.procedures_&&(this.procedures_[s].type=="procedures_defnoreturn"?(delete this.voidProcedures_[s],this.voidProcedures--):(delete this.returnProcedures_[s],this.returnProcedures--),delete this.procedures_[s],this.length--),true};Mi.prototype.renameProcedure=function(s,n,i){};Mi.prototype.getProcedure=function(s){const n=this.procedures_[s];return n||this.getProcedureByName(s)};Mi.prototype.getProcedureByName=function(s){for(const n in this.procedures_)if(this.procedures_[n].getFieldValue("NAME")===s)return this.procedures_[n]};Mi.prototype.clear=function(){this.procedures_={},this.returnProcedures_={},this.voidProcedures_={},this.length=0,this.returnProcedures=0,this.voidProcedures=0};A.WorkspaceSvg.prototype.flydown_=null;A.WorkspaceSvg.prototype.getFlydown=function(){return this.flydown_};A.WorkspaceSvg.prototype.getProcedureDatabase=function(){return this.procedureDb_||(this.procedureDb_=new Mi(this)),this.procedureDb_};A.WorkspaceSvg.prototype.getTopWorkspace=function(){let s=this;for(;s.targetWorkspace;)s=s.targetWorkspace;return s};A.WorkspaceSvg.prototype.getWarningHandler=function(){return _B};/**
 * @license
 * @fileoverview Field in which mouseover displays flyout-like menu of blocks
 * and mouse click edits the field name.
 * Flydowns are used in App Inventor for displaying get/set blocks for
 *     parameter names and callers for procedure declarations.
 * @author fturbak@wellesley.edu (Lyn Turbak)
 */const ki=class ki2 extends A.FieldTextInput{constructor(n,i,o,l){super(n,l),this.EDITABLE=i,this.displayLocation=o||ki2.DISPLAY_RIGHT}showEditor_(){this.EDITABLE&&(ki2.showPid_&&(clearTimeout(ki2.showPid_),ki2.showPid_=0,A.common.getMainWorkspace().hideChaff()),super.showEditor_())}init(n){super.init(n),A.utils.dom.removeClass(this.fieldGroup_,"blocklyEditableText"),A.utils.dom.removeClass(this.fieldGroup_,"blocklyNoNEditableText"),A.utils.dom.addClass(this.fieldGroup_,this.fieldCSSClassName),this.mouseOverWrapper_=A.browserEvents.bind(this.fieldGroup_,"mouseover",this,this.onMouseOver_),this.mouseOutWrapper_=A.browserEvents.bind(this.fieldGroup_,"mouseout",this,this.onMouseOut_)}};oo(ki,"timeout",500),oo(ki,"showPid_",0),oo(ki,"openFieldFlydown_",null),oo(ki,"DISPLAY_BELOW","BELOW"),oo(ki,"DISPLAY_RIGHT","RIGHT"),oo(ki,"DISPLAY_LOCATION",ki.DISPLAY_BELOW);let vt=ki;vt.prototype.fieldCSSClassName="blocklyFieldFlydownField";vt.prototype.flyoutCSSClassName="blocklyFieldFlydownFlydown";vt.prototype.onMouseOver_=function(s){!this.sourceBlock_.isInFlyout&&vt.showPid_==0&&(vt.showPid_=window.setTimeout(this.showFlydownMaker_(),vt.timeout)),s.stopPropagation()};vt.prototype.onMouseOut_=function(s){window.clearTimeout(vt.showPid_),vt.showPid_=0,s.stopPropagation()};vt.prototype.showFlydownMaker_=function(){const s=this;return function(){if(vt.showPid_!==0&&!s.getSourceBlock().workspace.isDragging()&&!this.htmlInput_)try{s.showFlydown_()}catch(n){console.error("Failed to show flydown",n)}vt.showPid_=0}};vt.prototype.showFlydown_=function(){A.common.getMainWorkspace().hideChaff();const s=A.common.getMainWorkspace().getFlydown();A.common.getMainWorkspace().getParentSvg().appendChild(s.svgGroup_);const n=s.targetWorkspace.scale;s.workspace_.setScale(n),s.setCSSClass(this.flyoutCSSClassName);const i=this.flydownBlocksXML_(),o=A.Xml.textToDom(i),l=Th(o),f=A.common.getMainWorkspace().getSvgXY(this.borderRect_),m=this.borderRect_.getBBox();this.displayLocation===vt.DISPLAY_BELOW?f.y+=m.height*n:f.x+=m.width*n,s.field_=this,s.showAt(l,f.x,f.y),vt.openFieldFlydown_=this};vt.hide=function(){window.clearTimeout(vt.showPid_);const s=A.common.getMainWorkspace().getFlydown();s&&s.hide()};function $B(s,n){const i=s.doClassValidation_(n);if(i===null)return null;i!==void 0&&(n=i);const o=s.getValidator();if(o){const l=o.call(s,n);if(l===null)return null;l!==void 0&&(n=l)}return n}vt.prototype.onHtmlInputChange_=function(s){const n=this.htmlInput_,i=n.value;if(i!==n.oldValue_){n.oldValue_=i;let o=true;this.sourceBlock_&&(o=$B(this,n.value)),o===null?A.utils.dom.addClass(n,"blocklyInvalidInput"):(A.utils.dom.removeClass(n,"blocklyInvalidInput"),this.doValueUpdate_(o))}else A.utils.userAgent.WEBKIT&&this.sourceBlock_.render();this.textContent_.nodeValue=i,this.forceRerender(),this.resizeEditor_(),A.svgResize(this.sourceBlock_.workspace)};vt.prototype.dispose=function(){vt.openFieldFlydown_==this&&vt.hide(),A.FieldTextInput.prototype.dispose.call(this)};vt.fromJson=function(s){const n=A.utils.replaceMessageReferences(s.name);return new vt(n,s.is_editable)};A.fieldRegistry.register("field_flydown",vt);/**
 * @license
 * @fileoverview Flydown is an abstract class for a flyout-like dropdown
 *     containing blocks. Unlike a regular flyout, for simplicity it does not
 *     support scrolling. Any non-abstract subclass must provide a
 *     flydownBlocksXML_ () method that returns an XML element whose children
 *     are blocks that should appear in the flyout.
 * @author fturbak@wellesley.edu (Lyn Turbak)
 */class gi extends A.VerticalFlyout{constructor(n){super(n),this.dragAngleRange_=360}}gi.prototype.previousCSSClassName_="";gi.prototype.VERTICAL_SEPARATION_FACTOR=1;gi.prototype.createDom=function(s){return this.previousCSSClassName_=s,this.svgGroup_=A.utils.dom.createSvgElement("g",{class:s},null),this.svgBackground_=A.utils.dom.createSvgElement("path",{},this.svgGroup_),this.svgGroup_.appendChild(this.workspace_.createDom()),this.svgGroup_};gi.prototype.setCSSClass=function(s){s!==this.previousCSSClassName_&&(A.utils.dom.removeClass(this.svgGroup_,this.previousCSSClassName_),A.utils.dom.addClass(this.svgGroup_,s),this.previousCSSClassName_=s)};gi.prototype.init=function(s){A.Flyout.prototype.init.call(this,s,false),this.workspace_.setTheme(s.getTheme()),s.getComponentManager().addCapability(this.id,A.ComponentManager.Capability.AUTOHIDEABLE)};gi.prototype.position=function(){};gi.prototype.showAt=function(s,n,i){A.Events.disable();try{this.show(s)}finally{A.Events.enable()}const o=this.CORNER_RADIUS*this.workspace_.scale,l=this.width_-2*o,f=this.height_-2*o,m=["M 0,"+o];m.push("a",o,o,0,0,1,o,-o),m.push("h",l),m.push("a",o,o,0,0,1,o,o),m.push("v",f),m.push("a",o,o,0,0,1,-o,o),m.push("h",-l),m.push("a",o,o,0,0,1,-o,-o),m.push("z"),this.svgBackground_.setAttribute("d",m.join(" ")),this.svgGroup_.setAttribute("transform","translate("+n+", "+i+")")};gi.prototype.reflow=function(){this.workspace_.scale=this.targetWorkspace.scale;const s=this.workspace_.scale;let n=0,i=0;const o=this.CORNER_RADIUS*s,l=this.workspace_.getTopBlocks(false);for(let u=0,_;_=l[u];u++){const c=_.getHeightWidth();n=Math.max(n,c.width*s),i+=c.height*s}n+=2*o+this.tabWidth_*s;const f=this.workspace_.getRenderer().getConstants(),m=f.ADD_START_HATS?f.START_HAT_HEIGHT:0;if(i+=3*o+o*this.VERTICAL_SEPARATION_FACTOR*l.length+m*s/2,this.width_!=n){for(let u=0,_;_=l[u];u++){const c=_.getHeightWidth(),h=_.getRelativeToSurfaceXY();if(this.RTL){const p=n-o-s*(this.tabWidth_-h.x);_.moveBy(p,0),h.x+=p}_.flyoutRect_&&(_.flyoutRect_.setAttribute("width",c.width),_.flyoutRect_.setAttribute("height",c.height),_.flyoutRect_.setAttribute("x",this.RTL?h.x-c.width:h.x),_.flyoutRect_.setAttribute("y",h.y))}this.width_=n,this.height_=i}};gi.prototype.onMouseMove_=function(s){};gi.prototype.placeNewBlock_=function(s){const n=this.targetWorkspace,i=s.getSvgRoot();if(!i)throw Error("originBlock is not rendered.");let o=this.workspace_.scale;const l=this.workspace_.getSvgXY(i),f=l.x;l.x+=f/n.scale-f;const m=l.y;o=n.scale,l.y+=m/o-m;const u=A.Xml.blockToDom(s),_=A.Xml.domToBlock(u,n),c=_.getSvgRoot();if(!c)throw Error("block is not rendered.");const h=n.getSvgXY(c);return h.x+=n.scrollX/n.scale-n.scrollX,h.y+=n.scrollY/n.scale-n.scrollY,n.toolbox_&&!n.scrollbar&&(h.x+=n.toolbox_.getWidth()/n.scale,h.y+=n.toolbox_.getHeight()/n.scale),_.moveBy(l.x-h.x,l.y-h.y),_};gi.prototype.shouldHide=true;gi.prototype.hide=function(){this.shouldHide&&(A.Flyout.prototype.hide.call(this),vt.openFieldFlydown_=null),this.shouldHide=true};gi.prototype.autoHide=function(){this.hide()};/**
 * @license
 * @fileoverview Clickable field with flydown menu of global getter and setter
 *     blocks.
 * @author fturbak@wellesley.edu (Lyn Turbak)
 */class bo extends vt{constructor(n,i){super(n,true,i,Ce.renameGlobal)}}bo.prototype.fieldCSSClassName="blocklyFieldParameter";bo.prototype.flyoutCSSClassName="blocklyFieldParameterFlydown";bo.prototype.flydownBlocksXML_=function(){const s=A.Msg.LANG_VARIABLES_GLOBAL_PREFIX+" "+this.getText();return'<xml><block type="lexical_variable_get"><title name="VAR">'+s+'</title></block><block type="lexical_variable_set"><title name="VAR">'+s+"</title></block></xml>"};bo.fromJson=function(s){const n=A.utils.replaceMessageReferences(s.name);return new bo(n)};A.fieldRegistry.register("field_global_flydown",bo);class fa extends A.FieldDropdown{constructor(...n){super(...n)}}fa.prototype.doClassValidation_=function(s){let n=false;const i=this.getOptions(true);for(let o=0,l;l=i[o];o++)if(l[1]===s){n=true;break}return n||this.generatedOptions_.push([s,s]),s};fa.fromJson=function(s){return new fa(s.options,void 0,s)};A.fieldRegistry.register("field_nocheck_dropdown",fa);class os extends vt{constructor(n,i,o,l){const f=function(m){if(!os.changeHandlerEnabled)return m;const u=Ce.renameParam.call(this,m);return l&&l.call(this,u),u};super(n,i,o,f)}}os.prototype.fieldCSSClassName="blocklyFieldParameter";os.prototype.flyoutCSSClassName="blocklyFieldParameterFlydown";os.changeHandlerEnabled=true;os.withChangeHanderDisabled=function(s){const n=os.changeHandlerEnabled;os.changeHandlerEnabled=false;try{s()}finally{os.changeHandlerEnabled=n}};os.prototype.flydownBlocksXML_=function(){const s=this.getText();return'<xml><block type="lexical_variable_get"><field name="VAR">'+s+'</field></block><block type="lexical_variable_set"><field name="VAR">'+s+"</field></block></xml>"};os.addHorizontalVerticalOption=function(s,n){let i=0;if(s.getParameters&&(i=s.getParameters().length),s.isCollapsed()||i<=0)return;const o={enabled:true,text:s.horizontalParameters?A.Msg.VERTICAL_PARAMETERS:A.Msg.HORIZONTAL_PARAMETERS,callback:function(){s.setParameterOrientation(!s.horizontalParameters)}};let l=0;for(let f;(f=n[l])&&f.text!=A.Msg.COLLAPSE_BLOCK;l++);n.splice(l,0,o);for(let f=0,m;m=n[f];f++)if(m.text==A.Msg.INLINE_INPUTS){n.splice(f,1);break}};os.fromJson=function(s){const n=A.utils.replaceMessageReferences(s.name);return new os(n,s.is_editable)};A.fieldRegistry.register("field_parameter_flydown",os);/**
 * @license
 * @fileoverview Specialization of Blockly's FieldTextInput to handle logic of
 *     procedure renaming.
 * @author ewpatton@mit.edu (Evan W. Patton)
 */class ic extends A.FieldTextInput{constructor(n){super(n,SB)}setValue(n){const i=this.getValue();if(this.oldName_=i,this.doValueUpdate_(n),super.setValue(n),n=this.getValue(),typeof n=="string"&&this.sourceBlock_){const o=this.sourceBlock_.workspace.getProcedureDatabase();o&&(o.getProcedure(this.sourceBlock_.id)?o.renameProcedure(this.sourceBlock_.id,i,n):o.addProcedure(n,this.sourceBlock_))}this.oldName_=void 0}}ic.fromJson=function(s){const n=A.utils.replaceMessageReferences(s.name);return new ic(n)};A.fieldRegistry.register("field_procedurename",ic);/**
 * @license
 * @fileoverview Variables blocks for Blockly, modified for MIT App Inventor.
 * @author fturbak@wellesley.edu (Lyn Turbak)
 */delete A.Blocks.global_declaration;A.Blocks.global_declaration={category:"Variables",helpUrl:A.Msg.LANG_VARIABLES_GLOBAL_DECLARATION_HELPURL,init:function(){this.setStyle("variable_blocks"),this.appendValueInput("VALUE").appendField(A.Msg.LANG_VARIABLES_GLOBAL_DECLARATION_TITLE_INIT).appendField(new bo(A.Msg.LANG_VARIABLES_GLOBAL_DECLARATION_NAME,vt.DISPLAY_BELOW),"NAME").appendField(A.Msg.LANG_VARIABLES_GLOBAL_DECLARATION_TO),this.setTooltip(A.Msg.LANG_VARIABLES_GLOBAL_DECLARATION_TOOLTIP)},getVars:function(){const s=this.getField("NAME");return s?[s.getText()]:[]},getGlobalNames:function(){return this.getVars()},renameVar:function(s,n){A.Names.equals(s,this.getFieldValue("NAME"))&&this.setFieldValue(n,"NAME")}};A.Blocks.lexical_variable_get={category:"Variables",helpUrl:A.Msg.LANG_VARIABLES_GET_HELPURL,init:function(){this.setStyle("variable_blocks"),this.fieldVar_=new bt(" "),this.fieldVar_.setBlock(this),this.appendDummyInput().appendField(A.Msg.LANG_VARIABLES_GET_TITLE_GET).appendField(this.fieldVar_,"VAR"),this.setOutput(true,null),this.setTooltip(A.Msg.LANG_VARIABLES_GET_TOOLTIP),this.errors=[{func:pc},{func:gc,dropDowns:["VAR"]}],this.setOnChange(function(s){_c(this)})},referenceResults:function(s,n,i){const o=this.getChildren().map(function(p){return Ce.referenceResult(p,s,n,i)});let l=[],f=[];for(let p=0;p<o.length;p++)l=l.concat(o[p][0]),f=f.concat(o[p][1]);const m=this.getField("VAR").getText(),u=uI(m),_=u[0],c=u[1],h=i.indexOf(c)==-1;return _!==A.Msg.LANG_VARIABLES_GLOBAL_PREFIX&&(c===s&&h?(l.push(this),f=f.concat(i)):h&&f.push(c)),[[l,f]]},getVars:function(){return[this.getFieldValue("VAR")]},renameLexicalVar:function(s,n,i,o){i===void 0?s===this.getFieldValue("VAR")&&this.setFieldValue(n,"VAR"):i&&i===this.fieldVar_.getText()&&(this.fieldVar_.getOptions(false),this.fieldVar_.setValue(n),s===n&&this.setFieldValue(n,"VAR"),this.fieldVar_.forceRerender())},renameFree:function(s){const n=A.unprefixName(this.getFieldValue("VAR"));if(n[0]!==A.Msg.LANG_VARIABLES_GLOBAL_PREFIX){const o=n[1],l=s.apply(o);l!==o&&this.renameLexicalVar(o,l)}},freeVariables:function(){const s=A.unprefixName(this.getFieldValue("VAR"));if(s[0]!==A.Msg.LANG_VARIABLES_GLOBAL_PREFIX){const i=s[1];return new A.NameSet([i])}else return new A.NameSet}};A.Blocks.lexical_variable_set={category:"Variables",helpUrl:A.Msg.LANG_VARIABLES_SET_HELPURL,init:function(){this.setStyle("variable_blocks"),this.fieldVar_=new bt(" "),this.fieldVar_.setBlock(this),this.appendValueInput("VALUE").appendField(A.Msg.LANG_VARIABLES_SET_TITLE_SET).appendField(this.fieldVar_,"VAR").appendField(A.Msg.LANG_VARIABLES_SET_TITLE_TO),this.setPreviousStatement(true),this.setNextStatement(true),this.setTooltip(A.Msg.LANG_VARIABLES_SET_TOOLTIP),this.errors=[{func:pc},{func:gc,dropDowns:["VAR"]}],this.setOnChange(function(s){_c(this)})},referenceResults:A.Blocks.lexical_variable_get.referenceResults,getVars:function(){return[this.getFieldValue("VAR")]},renameLexicalVar:A.Blocks.lexical_variable_get.renameLexicalVar,renameFree:function(s){const n=A.unprefixName(this.getFieldValue("VAR"));if(n[0]!==A.Msg.LANG_VARIABLES_GLOBAL_PREFIX){const o=n[1],l=s.apply(o);l!==o&&this.renameLexicalVar(o,l)}this.getChildren().map(function(o){Ce.renameFree(o,s)})},freeVariables:function(){const s=this.getChildren().map(function(l){return Ce.freeVariables(l)}),n=A.NameSet.unionAll(s),i=A.unprefixName(this.getFieldValue("VAR"));if(i[0]!==A.Msg.LANG_VARIABLES_GLOBAL_PREFIX){const l=i[1];n.insert(l)}return n}};A.Blocks.local_declaration_statement={category:"Variables",helpUrl:A.Msg.LANG_VARIABLES_LOCAL_DECLARATION_HELPURL,bodyInputName:"STACK",init:function(){this.setStyle("variable_blocks"),this.initLocals(),this.appendStatementInput("STACK").appendField(A.Msg.LANG_VARIABLES_LOCAL_DECLARATION_IN_DO),this.setPreviousStatement(true),this.setNextStatement(true),this.setTooltip(A.Msg.LANG_VARIABLES_LOCAL_DECLARATION_TOOLTIP),this.lexicalVarPrefix=cI},referenceResults:function(s,n,i){const o=[];for(let c=0;this.getInput("DECL"+c);c++){let h=this.getFieldValue("VAR"+c);o.push(h)}const l=i.concat(o),f=[];for(let c=0;this.getInput("DECL"+c);c++){const h=this.getInputTargetBlock("DECL"+c);h&&f.push(h)}const m=f.map(function(c){return Ce.referenceResult(c,s,n,i)}),u=Ce.referenceResult(this.getInputTargetBlock("STACK"),s,n,l),_=Ce.referenceResult(Ce.getNextTargetBlock(this),s,n,i);return m.concat([u,_])},withLexicalVarsAndPrefix:function(s,n){if(this.getInputTargetBlock(this.bodyInputName)==s){const i=this.declaredNames();for(let o=0;o<i.length;o++)n(i[o],this.lexicalVarPrefix)}},initLocals:function(){this.setStyle("variable_blocks"),this.localNames_=[A.Msg.LANG_VARIABLES_LOCAL_DECLARATION_DEFAULT_NAME],this.appendValueInput("DECL0").appendField(A.Msg.LANG_VARIABLES_LOCAL_DECLARATION_TITLE_INIT).appendField(this.parameterFlydown(0),"VAR0").appendField(A.Msg.LANG_VARIABLES_LOCAL_DECLARATION_INPUT_TO).setAlign(A.ALIGN_RIGHT),this.setMutator(new A.Mutator(["local_mutatorarg"]))},onchange:function(){this.localNames_=this.declaredNames()},mutationToDom:function(){const s=document.createElement("mutation");for(let n=0;n<this.localNames_.length;n++){const i=document.createElement("localname");i.setAttribute("name",this.localNames_[n]),s.appendChild(i)}return s},domToMutation:function(s){const n=Th(s);if(n.length>0){this.localNames_=[];for(let i=0,o;o=n[i];i++)o.nodeName.toLowerCase()=="localname"&&this.localNames_.push(o.getAttribute("name"))}this.updateDeclarationInputs_(this.localNames_)},updateDeclarationInputs_:function(s,n){const i=this.inputList[this.inputList.length-1],o=this.inputList.length-1,l=this.rendered;this.rendered=false;const f=this;os.withChangeHanderDisabled(function(){for(let m=0;m<o;m++)f.removeInput("DECL"+m)}),this.inputList=[],this.localNames_=s;for(let m=0;m<s.length;m++){const u=this.appendValueInput("DECL"+m);u.appendField(A.Msg.LANG_VARIABLES_LOCAL_DECLARATION_TITLE_INIT).appendField(this.parameterFlydown(m),"VAR"+m).appendField(A.Msg.LANG_VARIABLES_LOCAL_DECLARATION_INPUT_TO).setAlign(A.ALIGN_RIGHT),n&&n[m]&&u.connection.connect(n[m])}this.inputList=this.inputList.concat(i),this.rendered=l,this.rendered&&(this.initSvg(),this.render())},parameterFlydown:function(s){const n=this.localNames_[s],i=this,o=function(l){const f=i.localNames_;if(f[s]=l,i.mutator&&i.mutator.rootBlock_){const m=i.mutator.rootBlock_;let u=0,_=m.getInputTargetBlock("STACK");for(;_&&u<s;)_=_.nextConnection&&_.nextConnection.targetBlock(),u++;_&&u==s&&A.Field.prototype.setValue.call(_.getField("NAME"),l)}};return new os(n,true,vt.DISPLAY_RIGHT,o)},decompose:function(s){const n=s.newBlock("local_mutatorcontainer");n.initSvg(),n.setDefBlock(this);let i=n.getInput("STACK").connection;for(let o=0;o<this.localNames_.length;o++){const l=this.getFieldValue("VAR"+o),f=s.newBlock("local_mutatorarg");f.initSvg(),f.setFieldValue(l,"NAME"),f.oldLocation=o,i.connect(f.previousConnection),i=f.nextConnection}return n},compose:function(s){const n=[],i=[];let o=s.getInputTargetBlock("STACK");for(;o;)n.push(o.getFieldValue("NAME")),i.push(o.valueConnection_),o=o.nextConnection&&o.nextConnection.targetBlock();Ce.stringListsEqual(this.localNames_,n)||this.updateDeclarationInputs_(n,i)},dispose:function(...s){A.BlockSvg.prototype.dispose.apply(this,s)},saveConnections:function(s){let n=s.getInputTargetBlock("STACK"),i=0;for(;n;){const l=this.getInput("DECL"+i);n.valueConnection_=l&&l.connection.targetConnection,i++,n=n.nextConnection&&n.nextConnection.targetBlock()}const o=this.getInput(this.bodyInputName);o&&(s.bodyConnection_=o.connection.targetConnection)},getVars:function(){const s=[];for(let n=0,i;i=this.getField("VAR"+n);n++)s.push(i.getValue());return s},declaredNames:function(){return this.getVars()},declaredVariables:function(){return this.getVars()},initializerConnections:function(){const s=[];for(let n=0,i;i=this.getInput("DECL"+n);n++)s.push(i.connection&&i.connection.targetConnection);return s},blocksInScope:function(){const s=this.getInputTargetBlock(this.bodyInputName);return s&&[s]||[]},renameVar:function(s,n){this.renameVars(A.Substitution.simpleSubstitution(s,n))},renameVars:function(s){const n=this.declaredNames(),i=s.map(n);if(!Ce.stringListsEqual(i,n)){const o=this.initializerConnections();if(this.updateDeclarationInputs_(i,o),this.mutator.isVisible()){const l=this.mutator.workspace_.getAllBlocks();for(let f=0,m;m=l[f];f++)if(m.type=="procedures_mutatorarg"){const u=m.getFieldValue("NAME"),_=s.apply(u);_!==u&&m.setFieldValue(_,"NAME")}}}},renameBound:function(s,n){const i=A.Xml.domToText(this.mutationToDom()),o=this.declaredNames();for(let u=0;u<o.length;u++)Ce.renameFree(this.getInputTargetBlock("DECL"+u),n);const l=s.restrictDomain(o);this.renameVars(l);const f=n.remove(o).extend(l);Ce.renameFree(this.getInputTargetBlock(this.bodyInputName),f);const m=A.Xml.domToText(this.mutationToDom());if(A.Events.isEnabled()&&A.Events.fire(new A.Events.BlockChange(this,"mutation",null,i,m)),this.nextConnection){const u=this.nextConnection.targetBlock();Ce.renameFree(u,n)}},renameFree:function(s){const n=this.declaredNames(),i=new A.NameSet(n),o=Ce.freeVariables(this.getInputTargetBlock(this.bodyInputName));o.subtract(i);const l=o.renamed(s),f=l.intersection(i);if(f.isEmpty())this.renameBound(new A.Substitution,s);else{const m=i.union(l).toList(),u={},_=f.toList();for(let c=0,h;h=_[c];c++){const p=bt.nameNotIn(h,m);u[h]=p,m.push(p)}this.renameBound(new A.Substitution(u),s)}},freeVariables:function(){const s=Ce.freeVariables(this.getInputTargetBlock(this.bodyInputName)),n=this.declaredNames();s.subtract(new A.NameSet(n));const i=n.length;for(let o=0;o<i;o++)s.union(Ce.freeVariables(this.getInputTargetBlock("DECL"+o)));if(this.nextConnection){const o=this.nextConnection.targetBlock();s.unite(Ce.freeVariables(o))}return s}};A.Blocks.local_declaration_expression={category:"Variables",helpUrl:A.Msg.LANG_VARIABLES_LOCAL_DECLARATION_EXPRESSION_HELPURL,initLocals:A.Blocks.local_declaration_statement.initLocals,bodyInputName:"RETURN",init:function(){this.setStyle("variables_blocks"),this.initLocals(),this.appendValueInput("RETURN").appendField(A.Msg.LANG_VARIABLES_LOCAL_DECLARATION_EXPRESSION_IN_RETURN),this.setOutput(true,null),this.setTooltip(A.Msg.LANG_VARIABLES_LOCAL_DECLARATION_EXPRESSION_TOOLTIP)},referenceResults:function(s,n,i){const o=[];for(let _=0;this.getInput("DECL"+_);_++){let c=this.getFieldValue("VAR"+_);o.push(c)}const l=i.concat(o),f=[];for(let _=0;this.getInput("DECL"+_);_++){const c=this.getInputTargetBlock("DECL"+_);c&&f.push(c)}const m=f.map(function(_){return Ce.referenceResult(_,s,n,i)}),u=Ce.referenceResult(this.getInputTargetBlock("RETURN"),s,n,l);return m.concat([u])},withLexicalVarsAndPrefix:A.Blocks.local_declaration_statement.withLexicalVarsAndPrefix,onchange:A.Blocks.local_declaration_statement.onchange,mutationToDom:A.Blocks.local_declaration_statement.mutationToDom,domToMutation:A.Blocks.local_declaration_statement.domToMutation,updateDeclarationInputs_:A.Blocks.local_declaration_statement.updateDeclarationInputs_,parameterFlydown:A.Blocks.local_declaration_statement.parameterFlydown,blocksInScope:A.Blocks.local_declaration_statement.blocksInScope,decompose:A.Blocks.local_declaration_statement.decompose,compose:A.Blocks.local_declaration_statement.compose,dispose:A.Blocks.local_declaration_statement.dispose,saveConnections:A.Blocks.local_declaration_statement.saveConnections,getVars:A.Blocks.local_declaration_statement.getVars,declaredNames:A.Blocks.local_declaration_statement.declaredNames,declaredVariables:A.Blocks.local_declaration_statement.declaredVariables,renameVar:A.Blocks.local_declaration_statement.renameVar,renameVars:A.Blocks.local_declaration_statement.renameVars,renameBound:A.Blocks.local_declaration_statement.renameBound,renameFree:A.Blocks.local_declaration_statement.renameFree,freeVariables:A.Blocks.local_declaration_statement.freeVariables};A.Blocks.local_mutatorcontainer={init:function(){this.setStyle("variable_blocks"),this.appendDummyInput().appendField(A.Msg.LANG_VARIABLES_LOCAL_MUTATOR_CONTAINER_TITLE_LOCAL_NAMES),this.appendStatementInput("STACK"),this.setTooltip(A.Msg.LANG_VARIABLES_LOCAL_MUTATOR_CONTAINER_TOOLTIP),this.contextMenu=false,this.mustNotRenameCapturables=true},setDefBlock:function(s){this.defBlock_=s},getDefBlock:function(){return this.defBlock_},declaredNames:function(){const s=[];let n=this.getInputTargetBlock("STACK");for(;n;)s.push(n.getFieldValue("NAME")),n=n.nextConnection&&n.nextConnection.targetBlock();return s}};A.Blocks.local_mutatorarg={init:function(){this.setStyle("variable_blocks"),this.appendDummyInput().appendField(A.Msg.LANG_VARIABLES_LOCAL_MUTATOR_ARG_TITLE_NAME).appendField(new A.FieldTextInput(A.Msg.LANG_VARIABLES_LOCAL_MUTATOR_ARG_DEFAULT_VARIABLE,Ce.renameParam),"NAME"),this.setPreviousStatement(true),this.setNextStatement(true),this.setTooltip(""),this.contextMenu=false,this.lexicalVarPrefix=cI,this.mustNotRenameCapturables=true},getContainerBlock:function(){let s=this.getParent();for(;s&&s.type!=="local_mutatorcontainer";)s=s.getParent();return this.cachedContainerBlock_=s&&s.type==="local_mutatorcontainer"&&s||null,this.cachedContainerBlock_},getDefBlock:function(){const s=this.getContainerBlock();return s&&s.getDefBlock()||null},blocksInScope:function(){const s=this.getDefBlock();return s&&s.blocksInScope()||[]},declaredNames:function(){const s=this.getContainerBlock();return s&&s.declaredNames()||[]},onchange:function(){const s=this.getFieldValue("NAME");if(s){const n=this.cachedContainerBlock_,i=this.getContainerBlock();if(!n&&i){const o=this.declaredNames(),l=o.indexOf(s);if(l!=-1&&o.indexOf(s,l+1)!=-1){const m=bt.nameNotIn(s,o);this.setFieldValue(m,"NAME")}}}}};A.Blocks.controls_forRange={category:"Control",helpUrl:A.Msg.LANG_CONTROLS_FORRANGE_HELPURL,init:function(){this.setStyle("loop_blocks"),this.appendValueInput("START").setCheck(Hu("number",Gu)).appendField(A.Msg.LANG_CONTROLS_FORRANGE_INPUT_ITEM).appendField(new os(A.Msg.LANG_CONTROLS_FORRANGE_INPUT_VAR,true,vt.DISPLAY_BELOW),"VAR").appendField(A.Msg.LANG_CONTROLS_FORRANGE_INPUT_START).setAlign(A.ALIGN_RIGHT),this.appendValueInput("END").setCheck(Hu("number",Gu)).appendField(A.Msg.LANG_CONTROLS_FORRANGE_INPUT_END).setAlign(A.ALIGN_RIGHT),this.appendValueInput("STEP").setCheck(Hu("number",Gu)).appendField(A.Msg.LANG_CONTROLS_FORRANGE_INPUT_STEP).setAlign(A.ALIGN_RIGHT),this.appendStatementInput("DO").appendField(A.Msg.LANG_CONTROLS_FORRANGE_INPUT_DO).setAlign(A.ALIGN_RIGHT),this.setPreviousStatement(true),this.setNextStatement(true),this.setTooltip(A.Msg.LANG_CONTROLS_FORRANGE_TOOLTIP),this.lexicalVarPrefix=gB},referenceResults:function(s,n,i){let o=this.getFieldValue("VAR");const l=i.concat([o]),f=Ce.referenceResult(this.getInputTargetBlock("START"),s,n,i),m=Ce.referenceResult(this.getInputTargetBlock("END"),s,n,i),u=Ce.referenceResult(this.getInputTargetBlock("STEP"),s,n,i),_=Ce.referenceResult(this.getInputTargetBlock("DO"),s,n,l),c=Ce.referenceResult(Ce.getNextTargetBlock(this),s,n,i);return[f,m,u,_,c]},withLexicalVarsAndPrefix:function(s,n){if(this.getInputTargetBlock("DO")==s){const i=this.getFieldValue("VAR");n(i,this.lexicalVarPrefix)}},getVars:function(){return[this.getFieldValue("VAR")]},blocksInScope:function(){const s=this.getInputTargetBlock("DO");return s?[s]:[]},declaredNames:function(){return[this.getFieldValue("VAR")]},renameVar:function(s,n){A.Names.equals(s,this.getFieldValue("VAR"))&&this.setFieldValue(n,"VAR")},renameBound:function(s,n){Ce.renameFree(this.getInputTargetBlock("START"),n),Ce.renameFree(this.getInputTargetBlock("END"),n),Ce.renameFree(this.getInputTargetBlock("STEP"),n);const i=this.getFieldValue("VAR"),o=s.apply(i);if(o!==i){this.renameVar(i,o);const l=A.Substitution.simpleSubstitution(i,o),f=n.extend(l);Ce.renameFree(this.getInputTargetBlock("DO"),f)}else{const l=n.remove([i]);Ce.renameFree(this.getInputTargetBlock("DO"),l)}if(this.nextConnection){const l=this.nextConnection.targetBlock();Ce.renameFree(l,n)}},renameFree:function(s){const n=this.getFieldValue("VAR"),i=Ce.freeVariables(this.getInputTargetBlock("DO"));i.deleteName(n);const o=i.renamed(s);if(o.isMember(n)){const l=bt.nameNotIn(n,o.toList()),f=A.Substitution.simpleSubstitution(n,l);this.renameBound(f,s)}else this.renameBound(new A.Substitution,s)},freeVariables:function(){const s=Ce.freeVariables(this.getInputTargetBlock("DO"));if(s.deleteName(this.getFieldValue("VAR")),s.unite(Ce.freeVariables(this.getInputTargetBlock("START"))),s.unite(Ce.freeVariables(this.getInputTargetBlock("END"))),s.unite(Ce.freeVariables(this.getInputTargetBlock("STEP"))),this.nextConnection){const n=this.nextConnection.targetBlock();s.unite(Ce.freeVariables(n))}return s}};delete A.Blocks.controls_for;A.Blocks.controls_for=A.Blocks.controls_forRange;A.Blocks.controls_forEach={category:"Control",helpUrl:A.Msg.LANG_CONTROLS_FOREACH_HELPURL,init:function(){this.setStyle("loop_blocks"),this.appendValueInput("LIST").setCheck(Hu("list",Gu)).appendField(A.Msg.LANG_CONTROLS_FOREACH_INPUT_ITEM).appendField(new os(A.Msg.LANG_CONTROLS_FOREACH_INPUT_VAR,true,vt.DISPLAY_BELOW),"VAR").appendField(A.Msg.LANG_CONTROLS_FOREACH_INPUT_INLIST).setAlign(A.ALIGN_RIGHT),this.appendStatementInput("DO").appendField(A.Msg.LANG_CONTROLS_FOREACH_INPUT_DO),this.setPreviousStatement(true),this.setNextStatement(true),this.setTooltip(A.Msg.LANG_CONTROLS_FOREACH_TOOLTIP),this.lexicalVarPrefix=pB},referenceResults:function(s,n,i){let o=this.getFieldValue("VAR");const l=i.concat([o]),f=Ce.referenceResult(this.getInputTargetBlock("LIST"),s,n,i),m=Ce.referenceResult(this.getInputTargetBlock("DO"),s,n,l),u=Ce.referenceResult(Ce.getNextTargetBlock(this),s,n,i);return[f,m,u]},withLexicalVarsAndPrefix:A.Blocks.controls_forRange.withLexicalVarsAndPrefix,getVars:function(){return[this.getFieldValue("VAR")]},blocksInScope:function(){const s=this.getInputTargetBlock("DO");return s?[s]:[]},declaredNames:function(){return[this.getFieldValue("VAR")]},renameVar:function(s,n){A.Names.equals(s,this.getFieldValue("VAR"))&&this.setFieldValue(n,"VAR")},renameBound:function(s,n){Ce.renameFree(this.getInputTargetBlock("LIST"),n);const i=this.getFieldValue("VAR"),o=s.apply(i);if(o!==i){this.renameVar(i,o);const l=A.Substitution.simpleSubstitution(i,o),f=n.extend(l);Ce.renameFree(this.getInputTargetBlock("DO"),f)}else{const l=n.remove([i]);Ce.renameFree(this.getInputTargetBlock("DO"),l)}if(this.nextConnection){const l=this.nextConnection.targetBlock();Ce.renameFree(l,n)}},renameFree:function(s){const n=this.getFieldValue("VAR"),i=Ce.freeVariables(this.getInputTargetBlock("DO"));i.deleteName(n);const o=i.renamed(s);if(o.isMember(n)){const l=bt.nameNotIn(n,o.toList()),f=A.Substitution.simpleSubstitution(n,l);this.renameBound(f,s)}else this.renameBound(new A.Substitution,s)},freeVariables:function(){const s=Ce.freeVariables(this.getInputTargetBlock("DO"));if(s.deleteName(this.getFieldValue("VAR")),s.unite(Ce.freeVariables(this.getInputTargetBlock("LIST"))),this.nextConnection){const n=this.nextConnection.targetBlock();s.unite(Ce.freeVariables(n))}return s}};A.Blocks.controls_do_then_return={category:"Control",helpUrl:A.Msg.LANG_CONTROLS_DO_THEN_RETURN_HELPURL,init:function(){this.setStyle("loop_blocks"),this.appendStatementInput("STM").appendField(A.Msg.LANG_CONTROLS_DO_THEN_RETURN_INPUT_DO),this.appendValueInput("VALUE").appendField(A.Msg.LANG_CONTROLS_DO_THEN_RETURN_INPUT_RETURN).setAlign(A.ALIGN_RIGHT),this.setOutput(true,null),this.setTooltip(A.Msg.LANG_CONTROLS_DO_THEN_RETURN_TOOLTIP)}};/**
 * @license
 * @fileoverview Procedure blocks for Blockly, modified for MIT App Inventor.
 * @author mckinney@mit.edu (Andrew F. McKinney)
 */A.Blocks.procedures_defnoreturn={category:"Procedures",helpUrl:A.Msg.LANG_PROCEDURES_DEFNORETURN_HELPURL,bodyInputName:"STACK",init:function(){this.setStyle("procedure_blocks");const s=A.Procedures.findLegalName(A.Msg.LANG_PROCEDURES_DEFNORETURN_PROCEDURE,this);this.createHeader(s),this.horizontalParameters=true,this.appendStatementInput("STACK").appendField(A.Msg.LANG_PROCEDURES_DEFNORETURN_DO),this.setMutator(new A.Mutator(["procedures_mutatorarg"])),this.setTooltip(A.Msg.LANG_PROCEDURES_DEFNORETURN_TOOLTIP),this.arguments_=[],this.warnings=[{name:"checkEmptySockets",sockets:["STACK"]}],this.lexicalVarPrefix=lI},createHeader:function(s){return this.appendDummyInput("HEADER").appendField(A.Msg.LANG_PROCEDURES_DEFNORETURN_DEFINE).appendField(new ic(s),"NAME")},withLexicalVarsAndPrefix:function(s,n){const i=this.declaredNames();for(let o=0;o<i.length;o++)n(i[o],this.lexicalVarPrefix)},onchange:function(){this.arguments_=this.declaredNames()},updateParams_:function(s){s&&(this.arguments_=s);let n=false;const i={};for(let c=0;c<this.arguments_.length;c++){if(i["arg_"+this.arguments_[c].toLowerCase()]){n=true;break}i["arg_"+this.arguments_[c].toLowerCase()]=true}n?this.setWarningText(A.Msg.LANG_PROCEDURES_DEF_DUPLICATE_WARNING):this.setWarningText(null);const o=this.getFieldValue("NAME"),l=this.inputList[this.inputList.length-1],f=this.rendered;this.rendered=false;const m=this;os.withChangeHanderDisabled(function(){m.removeInput("HEADER")});const u=this.inputList.length-1;if(u>0&&this.getInput("VAR0"))for(let h=0;h<u;h++)try{os.withChangeHanderDisabled(function(){m.removeInput("VAR"+h)})}catch(p){console.log(p)}this.inputList=[];const _=this.createHeader(o);if(this.horizontalParameters)for(let c=0;c<this.arguments_.length;c++)_.appendField(" ").appendField(this.parameterFlydown(c),"VAR"+c);else for(let c=0;c<this.arguments_.length;c++)this.appendDummyInput("VAR"+c).appendField(this.parameterFlydown(c),"VAR"+c).setAlign(A.ALIGN_RIGHT);this.inputList=this.inputList.concat(l),this.rendered=f;for(let c=0;c<this.inputList.length;c++)this.inputList[c].init();this.rendered&&this.render(),this.workspace.loadCompleted&&A.Procedures.mutateCallers(this)},parameterFlydown:function(s){const n=this.arguments_[s],i=this,o=function(l){const f=i.arguments_;if(f[s]=l,A.Procedures.mutateCallers(i),i.mutator&&i.mutator.rootBlock_){const m=i.mutator.rootBlock_;let u=0,_=m.getInputTargetBlock("STACK");for(;_&&u<s;)_=_.nextConnection&&_.nextConnection.targetBlock(),u++;_&&u==s&&_.getField("NAME").setValue(l)}};return new os(n,true,this.horizontalParameters?vt.DISPLAY_BELOW:vt.DISPLAY_RIGHT,o)},setParameterOrientation:function(s){this.getParameters().length!=0&&s!==this.horizontalParameters&&(this.horizontalParameters=s,this.updateParams_(),A.Events.isEnabled()&&A.Events.fire(new A.Events.Ui(this,"parameter_orientation",(!this.horizontalParameters).toString(),this.horizontalParameters.toString())))},mutationToDom:function(){const s=document.createElement("mutation");this.horizontalParameters||s.setAttribute("vertical_parameters","true");for(let n=0;n<this.arguments_.length;n++){const i=document.createElement("arg");i.setAttribute("name",this.arguments_[n]),s.appendChild(i)}return s},domToMutation:function(s){const n=[],i=Th(s);for(let o=0,l;l=i[o];o++)l.nodeName.toLowerCase()=="arg"&&n.push(l.getAttribute("name"));this.horizontalParameters=s.getAttribute("vertical_parameters")!=="true",this.updateParams_(n)},decompose:function(s){const n=s.newBlock("procedures_mutatorcontainer");n.initSvg(),n.setProcBlock(this),this.paramIds_=[];let i=n.getInput("STACK").connection;for(let o=0;o<this.arguments_.length;o++){const l=s.newBlock("procedures_mutatorarg");this.paramIds_.push(l.id),l.initSvg(),l.setFieldValue(this.arguments_[o],"NAME"),l.oldLocation=o,i.connect(l.previousConnection),i=l.nextConnection}return A.Procedures.mutateCallers(this),n},compose:function(s){const n=[];this.paramIds_=[];let i=s.getInputTargetBlock("STACK");for(;i;)n.push(i.getFieldValue("NAME")),this.paramIds_.push(i.id),i=i.nextConnection&&i.nextConnection.targetBlock();Ce.stringListsEqual(n,this.arguments_)||(this.updateParams_(n),A.Procedures.mutateCallers(this))},dispose:function(...s){const n=this.getFieldValue("NAME"),i=this.editable_,o=this.workspace;i&&TB(n,o),A.BlockSvg.prototype.dispose.apply(this,s);const l=o.getProcedureDatabase();i&&l&&l.removeProcedure(this.id)},getProcedureDef:function(){return[this.getFieldValue("NAME"),this.arguments_,this.bodyInputName==="RETURN"]},getVars:function(){const s=[];for(let n=0,i;i=this.getFieldValue("VAR"+n);n++)s.push(i);return s},declaredNames:function(){return this.getVars()},declaredVariables:function(){return this.getVars()},renameVar:function(s,n){this.renameVars(A.Substitution.simpleSubstitution(s,n))},renameVars:function(s){const n=this.getParameters(),i=s.map(n);if(!Ce.stringListsEqual(n,i)&&(this.updateParams_(i),this.mutator.isVisible())){const o=this.mutator.workspace_.getAllBlocks();for(let l=0,f;f=o[l];l++)if(f.type=="procedures_mutatorarg"){const m=f.getFieldValue("NAME"),u=s.apply(m);u!==m&&f.setFieldValue(u,"NAME")}}},renameBound:function(s,n){const i=s.restrictDomain(this.declaredNames());this.renameVars(i);const o=n.extend(i);Ce.renameFree(this.getInputTargetBlock(this.bodyInputName),o)},renameFree:function(s){this.freeVariables()},freeVariables:function(){const s=Ce.freeVariables(this.getInputTargetBlock(this.bodyInputName));if(s.subtract(new A.NameSet(this.declaredNames())),s.isEmpty())return s;throw Error("Violation of invariant: procedure declaration has nonempty free variables: "+s.toString())},blocksInScope:function(){const s=this.getInputTargetBlock(this.bodyInputName);return s&&[s]||[]},customContextMenu:function(s){os.addHorizontalVerticalOption(this,s)},getParameters:function(){return this.arguments_}};A.Blocks.procedures_defreturn={category:"Procedures",helpUrl:A.Msg.PROCEDURES_DEFRETURN_HELPURL,bodyInputName:"RETURN",init:function(){this.setStyle("procedure_blocks");const s=A.Procedures.findLegalName(A.Msg.LANG_PROCEDURES_DEFRETURN_PROCEDURE,this);this.createHeader(s),this.horizontalParameters=true,this.appendValueInput("RETURN").setAlign(A.ALIGN_RIGHT).appendField(A.Msg.LANG_PROCEDURES_DEFRETURN_RETURN),this.setMutator(new A.Mutator(["procedures_mutatorarg"])),this.setTooltip(A.Msg.LANG_PROCEDURES_DEFRETURN_TOOLTIP),this.arguments_=[],this.warnings=[{name:"checkEmptySockets",sockets:["RETURN"]}]},createHeader:function(s){return this.appendDummyInput("HEADER").appendField(A.Msg.LANG_PROCEDURES_DEFRETURN_DEFINE).appendField(new ic(s),"NAME")},withLexicalVarsAndPrefix:A.Blocks.procedures_defnoreturn.withLexicalVarsAndPrefix,onchange:A.Blocks.procedures_defnoreturn.onchange,updateParams_:A.Blocks.procedures_defnoreturn.updateParams_,parameterFlydown:A.Blocks.procedures_defnoreturn.parameterFlydown,setParameterOrientation:A.Blocks.procedures_defnoreturn.setParameterOrientation,mutationToDom:A.Blocks.procedures_defnoreturn.mutationToDom,domToMutation:A.Blocks.procedures_defnoreturn.domToMutation,decompose:A.Blocks.procedures_defnoreturn.decompose,compose:A.Blocks.procedures_defnoreturn.compose,dispose:A.Blocks.procedures_defnoreturn.dispose,getProcedureDef:A.Blocks.procedures_defnoreturn.getProcedureDef,getVars:A.Blocks.procedures_defnoreturn.getVars,declaredNames:A.Blocks.procedures_defnoreturn.declaredNames,declaredVariables:A.Blocks.procedures_defnoreturn.declaredVariables,renameVar:A.Blocks.procedures_defnoreturn.renameVar,renameVars:A.Blocks.procedures_defnoreturn.renameVars,renameBound:A.Blocks.procedures_defnoreturn.renameBound,renameFree:A.Blocks.procedures_defnoreturn.renameFree,freeVariables:A.Blocks.procedures_defnoreturn.freeVariables,blocksInScope:A.Blocks.procedures_defnoreturn.blocksInScope,customContextMenu:A.Blocks.procedures_defnoreturn.customContextMenu,getParameters:A.Blocks.procedures_defnoreturn.getParameters};A.Blocks.procedures_mutatorcontainer={init:function(){this.setStyle("procedure_blocks"),this.appendDummyInput().appendField(A.Msg.LANG_PROCEDURES_MUTATORCONTAINER_TITLE),this.appendStatementInput("STACK"),this.setTooltip(A.Msg.LANG_PROCEDURES_MUTATORCONTAINER_TOOLTIP),this.contextMenu=false,this.mustNotRenameCapturables=true},setProcBlock:function(s){this.procBlock_=s},getProcBlock:function(){return this.procBlock_},declaredNames:function(){const s=[];let n=this.getInputTargetBlock("STACK");for(;n;)s.push(n.getFieldValue("NAME")),n=n.nextConnection&&n.nextConnection.targetBlock();return s}};A.Blocks.procedures_mutatorarg={init:function(){this.setStyle("procedure_blocks");const s=new A.FieldTextInput("x",Ce.renameParam);s.onHtmlInputChange_=function(n){const i=this.getValue();vt.prototype.onHtmlInputChange_.call(this,n);const o=this.getValue();o&&i!==o&&A.Events.isEnabled()&&A.Events.fire(new A.Events.BlockChange(this.sourceBlock_,"field",this.name,i,o))},this.appendDummyInput().appendField(A.Msg.LANG_PROCEDURES_MUTATORARG_TITLE).appendField(s,"NAME"),this.setPreviousStatement(true),this.setNextStatement(true),this.setTooltip(A.Msg.LANG_PROCEDURES_MUTATORARG_TOOLTIP),this.contextMenu=false,this.lexicalVarPrefix=lI,this.mustNotRenameCapturables=true},getContainerBlock:function(){let s=this.getParent();for(;s&&s.type!=="procedures_mutatorcontainer";)s=s.getParent();return this.cachedContainerBlock_=s&&s.type==="procedures_mutatorcontainer"&&s||null,this.cachedContainerBlock_},getProcBlock:function(){const s=this.getContainerBlock();return s&&s.getProcBlock()||null},declaredNames:function(){const s=this.getContainerBlock();return s&&s.declaredNames()||[]},blocksInScope:function(){const s=this.getProcBlock();return s&&s.blocksInScope()||[]},onchange:function(){const s=this.getFieldValue("NAME");if(s){const n=this.cachedContainerBlock_,i=this.getContainerBlock();if(!n&&i){const o=this.declaredNames(),l=o.indexOf(s);if(l!=-1&&o.indexOf(s,l+1)!=-1){const m=bt.nameNotIn(s,o);this.setFieldValue(m,"NAME")}}}}};A.Blocks.procedures_mutatorarg.validator=function(s){return s=s.replace(/[\s\xa0]+/g," ").replace(/^ | $/g,""),s||null};A.Blocks.procedures_callnoreturn={category:"Procedures",helpUrl:A.Msg.LANG_PROCEDURES_CALLNORETURN_HELPURL,init:function(){this.setStyle("procedure_blocks");const s=this.workspace.getTopWorkspace().getProcedureDatabase();this.procNamesFxn=function(){const n=s.getMenuItems(false);return n.length>0?n:["",""]},this.procDropDown=new fa(this.procNamesFxn,sh),this.procDropDown.block=this,this.appendDummyInput().appendField(A.Msg.LANG_PROCEDURES_CALLNORETURN_CALL).appendField(this.procDropDown,"PROCNAME"),this.setPreviousStatement(true),this.setNextStatement(true),this.setTooltip(A.Msg.LANG_PROCEDURES_CALLNORETURN_TOOLTIP),this.arguments_=[],this.quarkConnections_=null,this.quarkArguments_=null,this.errors=[{func:pc},{func:gc,dropDowns:["PROCNAME"]}],this.setOnChange(function(n){_c(this)}),sh.call(this.getField("PROCNAME"),this.getField("PROCNAME").getValue())},getProcedureCall:function(){return this.getFieldValue("PROCNAME")},renameProcedure:function(s,n){(!s||A.Names.equals(s,this.getFieldValue("PROCNAME")))&&(this.getField("PROCNAME").getOptions(),this.setFieldValue(n,"PROCNAME"))},setProcedureParameters:function(s,n,i){let o,l,f;if(n||(this.quarkConnections_={},this.quarkArguments_=null,n=[].concat(s)),n.length!=s.length)throw Error("Error: paramNames and paramIds must be the same length.");const m={};for(let _=0;_<s.length;_++)m[n[_]]=s[_];typeof i>"u"&&(i=null),(!this.quarkArguments_||i)&&(this.quarkConnections_={},Ce.stringListsEqual(s,this.arguments_)||i?this.quarkArguments_=n:this.quarkArguments_=[]);const u=this.rendered;for(this.rendered=false,f=0;this.getInput("ARG"+f);f++)o=this.getInput("ARG"+f),o&&(l=o.connection.targetConnection,this.quarkConnections_[this.quarkArguments_[f]]=l,this.removeInput("ARG"+f));for(this.arguments_=[].concat(s),this.quarkArguments_=n,f=0;f<this.arguments_.length;f++)if(o=this.appendValueInput("ARG"+f).setAlign(A.ALIGN_RIGHT).appendField(this.arguments_[f]),this.quarkArguments_){const _=this.quarkArguments_[f];_ in this.quarkConnections_?(l=this.quarkConnections_[_],!l||l.targetConnection||l.sourceBlock_.workspace!=this.workspace?delete this.quarkConnections_[_]:o.connection.connect(l)):m[_]&&(l=this.quarkConnections_[m[_]],l&&o.connection.connect(l))}if(this.rendered=u,!!this.workspace.rendered){for(f=0;f<this.arguments_.length;f++)this.getInput("ARG"+f).init();this.rendered&&this.render()}},mutationToDom:function(){const s=document.createElement("mutation");s.setAttribute("name",this.getFieldValue("PROCNAME"));for(let n=0;this.getInput("ARG"+n);n++){const i=document.createElement("arg");i.setAttribute("name",this.getInput("ARG"+n).fieldRow[0].getText()),s.appendChild(i)}return s},domToMutation:function(s){const n=s.getAttribute("name");this.setFieldValue(n,"PROCNAME"),this.arguments_=[];const i=Th(s);for(let o=0,l;l=i[o];o++)l.nodeName.toLowerCase()=="arg"&&this.arguments_.push(l.getAttribute("name"));this.setProcedureParameters(this.arguments_,null,true)},renameVar:function(s,n){for(let i=0;i<this.arguments_.length;i++)A.Names.equals(s,this.arguments_[i])&&(this.arguments_[i]=n,this.getInput("ARG"+i).fieldRow[0].setValue(n))},procCustomContextMenu:function(s){const n={enabled:true};n.text=A.Msg.LANG_PROCEDURES_HIGHLIGHT_DEF;const i=this.getFieldValue("PROCNAME"),o=this.workspace;n.callback=function(){const l=A.Procedures.getDefinition(i,o);l&&(l.select(),o.centerOnBlock(l.id),o.getParentSvg().parentElement.focus())},s.push(n)},removeProcedureValue:function(){for(let s=0;this.getInput("ARG"+s)!==null;s++)this.removeInput("ARG"+s);this.setFieldValue("none","PROCNAME")}};A.Blocks.procedures_callreturn={category:"Procedures",helpUrl:A.Msg.LANG_PROCEDURES_CALLRETURN_HELPURL,init:function(){this.setStyle("procedure_blocks");const s=this.workspace.getTopWorkspace().getProcedureDatabase();this.procNamesFxn=function(){const n=s.getMenuItems(true);return n.length>0?n:["",""]},this.procDropDown=new fa(this.procNamesFxn,sh),this.procDropDown.block=this,this.appendDummyInput().appendField(A.Msg.LANG_PROCEDURES_CALLRETURN_CALL).appendField(this.procDropDown,"PROCNAME"),this.setOutput(true,null),this.setTooltip(A.Msg.LANG_PROCEDURES_CALLRETURN_TOOLTIP),this.arguments_=[],this.quarkConnections_=null,this.quarkArguments_=null,this.errors=[{func:pc},{func:gc,dropDowns:["PROCNAME"]}],this.setOnChange(function(n){_c(this)}),sh.call(this.getField("PROCNAME"),this.getField("PROCNAME").getValue())},getProcedureCall:A.Blocks.procedures_callnoreturn.getProcedureCall,renameProcedure:A.Blocks.procedures_callnoreturn.renameProcedure,setProcedureParameters:A.Blocks.procedures_callnoreturn.setProcedureParameters,mutationToDom:A.Blocks.procedures_callnoreturn.mutationToDom,domToMutation:A.Blocks.procedures_callnoreturn.domToMutation,renameVar:A.Blocks.procedures_callnoreturn.renameVar,procCustomContextMenu:A.Blocks.procedures_callnoreturn.procCustomContextMenu,removeProcedureValue:A.Blocks.procedures_callnoreturn.removeProcedureValue};se.javascriptGenerator.controls_for=function(s){const n=se.javascriptGenerator.nameDB_.getName(s.getFieldValue("VAR"),A.VARIABLE_CATEGORY_NAME),i=se.javascriptGenerator.valueToCode(s,"START",se.javascriptGenerator.ORDER_ASSIGNMENT)||"0",o=se.javascriptGenerator.valueToCode(s,"END",se.javascriptGenerator.ORDER_ASSIGNMENT)||"0",l=se.javascriptGenerator.valueToCode(s,"STEP",se.javascriptGenerator.ORDER_ASSIGNMENT)||"1";let f=se.javascriptGenerator.statementToCode(s,"DO");f=se.javascriptGenerator.addLoopTrap(f,s);let m;if(A.utils.string.isNumber(i)&&A.utils.string.isNumber(o)&&A.utils.string.isNumber(l)){const u=Number(i)<=Number(o);m="for (let "+n+" = "+i+"; "+n+(u?" <= ":" >= ")+o+"; "+n;const _=Math.abs(Number(l));_==1?m+=u?"++":"--":m+=(u?" += ":" -= ")+_,m+=`) {
`+f+`}
`}else{m="";let u=i;!i.match(/^\w+$/)&&!A.utils.string.isNumber(i)&&(u=se.javascriptGenerator.nameDB_.getDistinctName(n+"_start",A.VARIABLE_CATEGORY_NAME),m+="let "+u+" = "+i+`;
`);let _=o;!o.match(/^\w+$/)&&!A.utils.string.isNumber(o)&&(_=se.javascriptGenerator.nameDB_.getDistinctName(n+"_end",A.VARIABLE_CATEGORY_NAME),m+="let "+_+" = "+o+`;
`);const c=se.javascriptGenerator.nameDB_.getDistinctName(n+"_inc",A.VARIABLE_CATEGORY_NAME);m+="let "+c+" = ",A.utils.string.isNumber(l)?m+=Math.abs(l)+`;
`:m+="Math.abs("+l+`);
`,m+="if ("+u+" > "+_+`) {
`,m+=se.javascriptGenerator.INDENT+c+" = -"+c+`;
`,m+=`}
`,m+="for ("+n+" = "+u+"; "+c+" >= 0 ? "+n+" <= "+_+" : "+n+" >= "+_+"; "+n+" += "+c+`) {
`+f+`}
`}return m};se.javascriptGenerator.controls_forRange=se.javascriptGenerator.controls_for;se.javascriptGenerator.controls_forEach=function(s){const n=se.javascriptGenerator.nameDB_.getName(s.getFieldValue("VAR"),A.VARIABLE_CATEGORY_NAME),i=se.javascriptGenerator.valueToCode(s,"LIST",se.javascriptGenerator.ORDER_ASSIGNMENT)||"[]";let o=se.javascriptGenerator.statementToCode(s,"DO");o=se.javascriptGenerator.addLoopTrap(o,s);let l="",f=i;i.match(/^\w+$/)||(f=se.javascriptGenerator.nameDB_.getDistinctName(n+"_list",A.VARIABLE_CATEGORY_NAME),l+="const "+f+" = "+i+`;
`);const m=se.javascriptGenerator.nameDB_.getDistinctName(n+"_index",A.VARIABLE_CATEGORY_NAME);return o=se.javascriptGenerator.INDENT+"const "+n+" = "+f+"["+m+`];
`+o,l+="for (let "+m+" in "+f+`) {
`+o+`}
`,l};se.javascriptGenerator.procedures_callreturn=function(s){const n=se.javascriptGenerator.nameDB_.getName(s.getFieldValue("PROCNAME"),A.PROCEDURE_CATEGORY_NAME),i=[],o=s.arguments_;for(let f=0;f<o.length;f++)i[f]=se.javascriptGenerator.valueToCode(s,"ARG"+f,se.javascriptGenerator.ORDER_NONE)||"null";return[n+"("+i.join(", ")+")",se.javascriptGenerator.ORDER_FUNCTION_CALL]};se.javascriptGenerator.lexical_variable_get=function(s){return[dI(s.getFieldValue("VAR")),se.javascriptGenerator.ORDER_ATOMIC]};function dI(s){const n=uI(s),i=n[0],o=n[1];return i===A.Msg.LANG_VARIABLES_GLOBAL_PREFIX||i===sc?o:mB()(o)}function _I(s,n){const i=se.javascriptGenerator.valueToCode(s,"VALUE",se.javascriptGenerator.ORDER_ASSIGNMENT)||"0";return dI(s.getFieldValue(n))+" = "+i+`;
`}se.javascriptGenerator.lexical_variable_set=function(s){return _I(s,"VAR")};se.javascriptGenerator.global_declaration=function(s){return"var "+_I(s,"NAME")};se.javascriptGenerator.local_declaration_statement=function(){let s=`{
  let `;for(let n=0;this.getFieldValue("VAR"+n);n++)s+=""+this.getFieldValue("VAR"+n),s+=" = "+(se.javascriptGenerator.valueToCode(this,"DECL"+n,se.javascriptGenerator.ORDER_NONE)||"0"),s+=", ";return s=s.slice(0,-2),s+=`;
`,s+=se.javascriptGenerator.statementToCode(this,"STACK",se.javascriptGenerator.ORDER_NONE),s+=`}
`,s};se.javascriptGenerator.local_declaration_expression=function(){return"NOT IMPLEMENTED YET"};/**
 * @license
 * Copyright 2021 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */hB();function yB(s){const n=new gi(new A.Options({scrollbars:false,rtl:s.RTL,renderer:s.options.renderer,rendererOverrides:s.options.rendererOverrides}));s.flydown_=n,A.utils.dom.insertAfter(n.createDom("g"),s.svgBubbleCanvas_),n.init(s),n.autoClose=true}const RB=`<xml xmlns="https://developers.google.com/blockly/xml" id="toolbox" style="display: none">
  <category name="程序">
    <category name="逻辑" colour="#5b80a5">
      <block type="controls_if"/>
      <block type="logic_compare">
        <field name="OP">EQ</field>
      </block>
      <block type="logic_operation">
        <field name="OP">AND</field>
      </block>
      <block type="logic_negate"/>
      <block type="logic_boolean">
        <field name="BOOL">TRUE</field>
      </block>
      <block type="logic_null"/>
      <block type="logic_ternary"/>
      <block type="sleep">
        <value name="milliseconds">
          <shadow type="math_number">
            <field name="NUM">1000</field>
          </shadow>
        </value>
      </block>
    </category>
    <category name="循环" colour="#5ba55b">
      <block type="controls_repeat_ext">
        <value name="TIMES">
          <shadow type="math_number">
            <field name="NUM">10</field>
          </shadow>
        </value>
      </block>
      <block type="controls_whileUntil">
        <field name="MODE">WHILE</field>
      </block>
      <block type="controls_for">
        <field name="VAR" id="s~#wpBU?bO8qfKP2Fg54">i</field>
        <value name="FROM">
          <shadow type="math_number">
            <field name="NUM">1</field>
          </shadow>
        </value>
        <value name="TO">
          <shadow type="math_number">
            <field name="NUM">10</field>
          </shadow>
        </value>
        <value name="BY">
          <shadow type="math_number">
            <field name="NUM">1</field>
          </shadow>
        </value>
      </block>
      <block type="controls_forEach">
        <field name="VAR" id="rciFyVTbkL=@%u!{2zW#">j</field>
      </block>
      <block type="controls_flow_statements">
        <field name="FLOW">BREAK</field>
      </block>
    </category>
    <category name="数学" colour="#5b67a5">
      <block type="math_number">
        <field name="NUM">0</field>
      </block>
      <block type="to_number"/>
      <block type="math_arithmetic">
        <field name="OP">ADD</field>
        <value name="A">
          <shadow type="math_number">
            <field name="NUM">1</field>
          </shadow>
        </value>
        <value name="B">
          <shadow type="math_number">
            <field name="NUM">1</field>
          </shadow>
        </value>
      </block>
      <block type="math_single">
        <field name="OP">ROOT</field>
        <value name="NUM">
          <shadow type="math_number">
            <field name="NUM">9</field>
          </shadow>
        </value>
      </block>
      <block type="math_trig">
        <field name="OP">SIN</field>
        <value name="NUM">
          <shadow type="math_number">
            <field name="NUM">45</field>
          </shadow>
        </value>
      </block>
      <block type="math_constant">
        <field name="CONSTANT">PI</field>
      </block>
      <block type="math_number_property">
        <mutation divisor_input="false"/>
        <field name="PROPERTY">EVEN</field>
        <value name="NUMBER_TO_CHECK">
          <shadow type="math_number">
            <field name="NUM">0</field>
          </shadow>
        </value>
      </block>
      <block type="math_round">
        <field name="OP">ROUND</field>
        <value name="NUM">
          <shadow type="math_number">
            <field name="NUM">3.1</field>
          </shadow>
        </value>
      </block>
      <block type="math_on_list">
        <mutation op="SUM"/>
        <field name="OP">SUM</field>
      </block>
      <block type="math_modulo">
        <value name="DIVIDEND">
          <shadow type="math_number">
            <field name="NUM">64</field>
          </shadow>
        </value>
        <value name="DIVISOR">
          <shadow type="math_number">
            <field name="NUM">10</field>
          </shadow>
        </value>
      </block>
      <block type="math_constrain">
        <value name="VALUE">
          <shadow type="math_number">
            <field name="NUM">50</field>
          </shadow>
        </value>
        <value name="LOW">
          <shadow type="math_number">
            <field name="NUM">1</field>
          </shadow>
        </value>
        <value name="HIGH">
          <shadow type="math_number">
            <field name="NUM">100</field>
          </shadow>
        </value>
      </block>
      <block type="math_random_int">
        <value name="FROM">
          <shadow type="math_number">
            <field name="NUM">1</field>
          </shadow>
        </value>
        <value name="TO">
          <shadow type="math_number">
            <field name="NUM">100</field>
          </shadow>
        </value>
      </block>
      <block type="math_random_float"/>
    </category>
    <category name="文本" colour="#5ba58c">
      <block type="text">
        <field name="TEXT"/>
      </block>
      <block type="text_join">
        <mutation items="2"/>
      </block>
      <block type="text_append">
        <field name="VAR" id="ho\`IB%Dj!ZWh5[SE\`Ag^">item</field>
        <value name="TEXT">
          <shadow type="text">
            <field name="TEXT"/>
          </shadow>
        </value>
      </block>
      <block type="text_length">
        <value name="VALUE">
          <shadow type="text">
            <field name="TEXT">abc</field>
          </shadow>
        </value>
      </block>
      <block type="text_isEmpty">
        <value name="VALUE">
          <shadow type="text">
            <field name="TEXT"/>
          </shadow>
        </value>
      </block>
      <block type="text_indexOf">
        <field name="END">FIRST</field>
        <value name="VALUE">
          <block type="variables_get">
            <field name="VAR" id="oW~/D1yIDK![r#WDIF==">text</field>
          </block>
        </value>
        <value name="FIND">
          <shadow type="text">
            <field name="TEXT">abc</field>
          </shadow>
        </value>
      </block>
      <block type="text_charAt">
        <mutation at="true"/>
        <field name="WHERE">FROM_START</field>
        <value name="VALUE">
          <block type="variables_get">
            <field name="VAR" id="oW~/D1yIDK![r#WDIF==">text</field>
          </block>
        </value>
      </block>
      <block type="text_getSubstring">
        <mutation at1="true" at2="true"/>
        <field name="WHERE1">FROM_START</field>
        <field name="WHERE2">FROM_START</field>
        <value name="STRING">
          <block type="variables_get">
            <field name="VAR" id="oW~/D1yIDK![r#WDIF==">text</field>
          </block>
        </value>
      </block>
      <block type="text_changeCase">
        <field name="CASE">UPPERCASE</field>
        <value name="TEXT">
          <shadow type="text">
            <field name="TEXT">abc</field>
          </shadow>
        </value>
      </block>
      <block type="text_trim">
        <field name="MODE">BOTH</field>
        <value name="TEXT">
          <shadow type="text">
            <field name="TEXT">abc</field>
          </shadow>
        </value>
      </block>
      <block type="regular"/>
      <block type="template_string"/>
    </category>
    <category name="列表" colour="#745ba5">
      <block type="lists_create_with">
        <mutation items="0"/>
      </block>
      <block type="lists_create_with">
        <mutation items="3"/>
      </block>
      <block type="lists_repeat">
        <value name="NUM">
          <shadow type="math_number">
            <field name="NUM">5</field>
          </shadow>
        </value>
      </block>
      <block type="lists_length"/>
      <block type="lists_isEmpty"/>
      <block type="lists_indexOf">
        <field name="END">FIRST</field>
        <value name="VALUE">
          <block type="variables_get">
            <field name="VAR" id="Ao146IucY?bq?1qJRwJS">list</field>
          </block>
        </value>
      </block>
      <block type="lists_getIndex">
        <mutation statement="false" at="true"/>
        <field name="MODE">GET</field>
        <field name="WHERE">FROM_START</field>
        <value name="VALUE">
          <block type="variables_get">
            <field name="VAR" id="Ao146IucY?bq?1qJRwJS">list</field>
          </block>
        </value>
      </block>
      <block type="lists_setIndex">
        <mutation at="true"/>
        <field name="MODE">SET</field>
        <field name="WHERE">FROM_START</field>
        <value name="LIST">
          <block type="variables_get">
            <field name="VAR" id="Ao146IucY?bq?1qJRwJS">list</field>
          </block>
        </value>
      </block>
      <block type="lists_getSublist">
        <mutation at1="true" at2="true"/>
        <field name="WHERE1">FROM_START</field>
        <field name="WHERE2">FROM_START</field>
        <value name="LIST">
          <block type="variables_get">
            <field name="VAR" id="Ao146IucY?bq?1qJRwJS">list</field>
          </block>
        </value>
      </block>
      <block type="lists_split">
        <mutation mode="SPLIT"/>
        <field name="MODE">SPLIT</field>
        <value name="DELIM">
          <shadow type="text">
            <field name="TEXT">,</field>
          </shadow>
        </value>
      </block>
      <block type="lists_sort">
        <field name="TYPE">NUMERIC</field>
        <field name="DIRECTION">1</field>
      </block>
    </category>
    <category name="变量" colour="#a55b80">
      <block type="global_declaration"/>
      <block type="lexical_variable_get"/>
      <block type="lexical_variable_set"/>
      <block type="local_declaration_statement"/>
    </category>
    <category name="对象" colour="#5b80a5">
      <block type="Object"/>
      <block type="Keys"/>
      <block type="text_json"/>
    </category>
    <category name="颜色" colour="#a5745b">
      <block type="colour_picker">
      <field name="COLOUR">#ff0000</field>
     </block>
     <block type="colour_random"></block>
     <block type="colour_rgb">
      <value name="RED">
        <shadow type="math_number">
          <field name="NUM">100</field>
        </shadow>
      </value>
      <value name="GREEN">
        <shadow type="math_number">
          <field name="NUM">50</field>
        </shadow>
      </value>
      <value name="BLUE">
        <shadow type="math_number">
          <field name="NUM">0</field>
        </shadow>
      </value>
     </block>
     <block type="colour_blend">
      <value name="COLOUR1">
        <shadow type="colour_picker">
          <field name="COLOUR">#ff0000</field>
        </shadow>
      </value>
      <value name="COLOUR2">
        <shadow type="colour_picker">
          <field name="COLOUR">#3333ff</field>
        </shadow>
      </value>
      <value name="RATIO">
        <shadow type="math_number">
          <field name="NUM">0.5</field>
        </shadow>
      </value>
     </block>
    </category>
    <category name="函数" colour="#995ba5" custom="PROCEDURE"/>
  </category>
  <sep/>
  <category name="机器人">
    <category name="事件" colour="#5b80a5">
      <block type="middleware">
        <field name="NAME" id="j{f?,R~uQ{$}[B@0sUIA">item</field>
      </block>
      <block type="command"/>
      <block type="plugin_apply"/>
      <block type="on_message_event"/>
      <block type="on_guild_member_event"/>
      <block type="on_guild_event"/>
    </category>
    <category name="会话" colour="#5b80a5">
      <block type="get_argument"/>
      <block type="session_message"/>
      <block type="session_message_id"/>
      <block type="session_user_id"/>
      <block type="session_guild_id"/>
      <block type="session_channel_id"/>
      <block type="session_bot"/>
      <block type="session_elements"/>
      <block type="break_middleware"/>
      <block type="at_id"/>
      <block type="at_name"/>
      <block type="group_name"/>
      <block type="group_id"/>
    </category>
    <category name="消息" colour="#5b80a5">
      <block type="send_session_message"/>
      <block type="return_message"/>
      <block type="broadcast">
        <value name = "NAME">
          <shadow type="lists_create_with">
            <mutation items="0"/>
          </shadow>
        </value>
        <value name = "NAME1">
          <shadow type="text"/>
        </value>
      </block>
    </category>
    <category name="消息元素" colour="#5b80a5">
      <block type="segment_at">
        <value name="user">
          <shadow type="session_user_id"/>
        </value>
      </block>
      <block type="segment_image">
        <value name="image">
          <shadow type="text">
            <field name="TEXT">https://koishi.chat/logo.png</field>
          </shadow>
        </value>
      </block>
      <block type="segment_audio">
        <value name="audio">
          <shadow type="text">
            <field name="TEXT">https://example.org/example.mp3</field>
          </shadow>
        </value>
      </block>
      <block type="segment_video">
      <value name="video">
        <shadow type="text">
          <field name="TEXT">https://example.org/example.mp4</field>
        </shadow>
      </value>
      </block>
        <block type="parse_segment_list">
        <value name="segments">
          <shadow type="session_elements"/>
        </value>
      </block>
      <block type="current_segment"/>
    </category>
    <category name="数据" colour="#5b80a5">
      <block type="http_get">
        <value name="url">
          <shadow type="text">
            <field name="TEXT">https://koishi.chat/</field>
          </shadow>
        </value>
      </block>
      <block type="json_path_parse"/>
      <block type="key_value_write">
        <value name="scope_id">
          <shadow type="plugin_id"/>
        </value>
        <value name="key">
          <shadow type="text">
            <field name="TEXT">键值对键</field>
          </shadow>
        </value>

        <value name="value">
          <shadow type="text">
            <field name="TEXT">写入值</field>
          </shadow>
        </value>
      </block>
      <block type="key_value_read">
        <value name="scope_id">
          <shadow type="plugin_id"/>
        </value>
        <value name="key">
          <shadow type="text">
            <field name="TEXT">键值对键</field>
          </shadow>
        </value>
      </block>
      <block type="test">
       <value name = "WENJAN">
         <shadow type="text">
           <field name="TEXT">C:\\</field>
         </shadow>
       </value>
       <value name = "NAME1">
         <shadow type="lists_create_with">
           <mutation items="0"/>
         </shadow>
       </value>
      </block>
    </category>
    <category name="机器人操作" colour="#5b80a5">
      <block type="delete_message">
        <value name="bot">
          <shadow type="session_bot"/>
        </value>
        <value name="channel_id">
          <shadow type="session_channel_id"/>
        </value>
        <value name="message_id">
          <shadow type="session_message_id"/>
        </value>
      </block>
      <block type="mute_user">
        <value name="bot">
          <shadow type="session_bot"/>
        </value>
        <value name="guild_id">
          <shadow type="session_guild_id"/>
        </value>
        <value name="user_id">
          <shadow type="session_user_id"/>
        </value>
        <value name="time">
          <shadow type="math_number">
            <field name="NUM">60000</field>
          </shadow>
        </value>
      </block>
    </category>
    <category name="调试" colour="#5b80a5">
      <block type="logging">
        <value name = "log">
          <shadow type="text">
            <field name="TEXT">Hello,world</field>
          </shadow>
        </value>
      </block>
    </category>
    <category name="环境" colour="#5b80a5">
      <block type="time_stamp"/>
      <block type="time_format">
        <value name = "date">
          <shadow type="time_stamp"></shadow>
        </value>
      </block>
      <block type="plugin_id"/>
    </category>
  </category>
  <sep/>
  <category name="绘画">
   <category name="canvas" colour="#5b80a5">

   </category>
   <category name="html" colour="#5b80a5">
    <block type="pptr">
      <value name = "NAME">
        <shadow type="text">
          <field name="TEXT">&#60;html&#62; &#60;/html&#62;</field>
        </shadow>
      </value>
    </block>
   </category>
  </category>
  <sep/>
  <category name="空白块" colour="#5b80a5">
    <block type="null"/>
    <block type="null1"/>
    <block type="null2"/>
    <block type="import"/>
    <block type="export_const"/>
  </category>
  <category name="未分类" colour="#5b80a5">
    <block type="pptr">
      <value name = "NAME">
        <shadow type="text">
          <field name="TEXT">&#60;html&#62; &#60;/html&#62;</field>
        </shadow>
      </value>
    </block>
    <block type="zhiling">
      <value name = "NAME">
        <shadow type="text">
          <field name="TEXT">help</field>
        </shadow>
      </value>
    </block>
    <block type="fetchDataFromUrl">
      <value name = "NAME1">
        <shadow type="text">
          <field name="TEXT">https://koishi.chat/logo.png</field>
        </shadow>
      </value>
    </block>
    <block type="toString"/>
    <block type="MD5"/>
    <block type="buffer_from"/>
    <block type="http_post"/>
    <block type="session_prompt">
      <value name="time">
          <shadow type="math_number">
            <field name="NUM">6000</field>
          </shadow>
      </value>
    </block>
    <block  type="bot_sendmessage"/>
  </category>
</xml>
`,IB={type:"http_get",message0:"发送简单HTTP GET请求 %1 网址 %2 返回类型 %3",args0:[{type:"input_dummy"},{type:"input_value",name:"url"},{type:"field_dropdown",name:"response_type",options:[["默认类型",""],["JSON对象类型","json"],["文本类型","text"]]}],inputsInline:false,output:null,colour:230,tooltip:"",helpUrl:""};function CB(s){let n=se.javascriptGenerator.valueToCode(s,"url",se.javascriptGenerator.ORDER_ATOMIC),i=s.getFieldValue("response_type");return[`await ctx.http.get(${n},{responseType:"${i}"})`,se.javascriptGenerator.ORDER_NONE]}const OB={type:"http_post",message0:"发送简单HTTP Post请求 %1 网址 %2 参数 %3 返回类型 %4",args0:[{type:"input_dummy"},{type:"input_value",name:"url"},{type:"input_value",name:"data"},{type:"field_dropdown",name:"response_type",options:[["默认类型",""],["JSON对象类型","json"],["文本类型","text"]]}],inputsInline:false,output:null,colour:230,tooltip:"",helpUrl:""};function wB(s){let n=se.javascriptGenerator.valueToCode(s,"url",se.javascriptGenerator.ORDER_ATOMIC),i=se.javascriptGenerator.valueToCode(s,"data",se.javascriptGenerator.ORDER_ATOMIC),o=s.getFieldValue("response_type");return[`await ctx.http.post(${n},${i},{responseType:"${o}"})`,se.javascriptGenerator.ORDER_NONE]}const kB={type:"json_path_parse",message0:"解析JSON对象 %1 JSONPath %2",args0:[{type:"input_value",name:"value"},{type:"field_input",name:"path",text:"$"}],inputsInline:false,imports:{"jsonpath-plus":["JSONPath as parseJson"]},output:null,colour:230,tooltip:"",helpUrl:""};function AB(s){let n=se.javascriptGenerator.valueToCode(s,"value",se.javascriptGenerator.ORDER_ATOMIC);return[`await parseJson({path: "${s.getFieldValue("path")}", json: ${n}})`,se.javascriptGenerator.ORDER_NONE]}const LB={type:"key_value_write",message0:"写入键值对 作用域ID %1 键 %2 值 %3",args0:[{type:"input_value",name:"scope_id"},{type:"input_value",name:"key"},{type:"input_value",name:"value",align:"RIGHT"}],template:["key_value_initialize"],inputsInline:false,previousStatement:null,nextStatement:null,colour:230,tooltip:"",helpUrl:""};function NB(s){let n=se.javascriptGenerator.valueToCode(s,"key",se.javascriptGenerator.ORDER_ATOMIC),i=se.javascriptGenerator.valueToCode(s,"value",se.javascriptGenerator.ORDER_ATOMIC),o=se.javascriptGenerator.valueToCode(s,"scope_id",se.javascriptGenerator.ORDER_ATOMIC);return o.length&&(o+='+"."+'),`await ctx.database.upsert('blockly_key_value',[{key:${o}${n},value:${i}}],['key'])
`}const MB={type:"key_value_read",message0:"读取键值对 作用域ID %1 键 %2",args0:[{type:"input_value",name:"scope_id"},{type:"input_value",name:"key"}],template:["key_value_initialize"],inputsInline:false,output:null,colour:230,tooltip:"",helpUrl:""};function DB(s){let n=se.javascriptGenerator.valueToCode(s,"key",se.javascriptGenerator.ORDER_ATOMIC),i=se.javascriptGenerator.valueToCode(s,"scope_id",se.javascriptGenerator.ORDER_ATOMIC);return i.length&&(i+='+"."+'),[`(await ctx.database.get('blockly_key_value',{key:${i}${n}}))[0]?.value`,se.javascriptGenerator.ORDER_NONE]}const xB=[IB,kB,LB,MB,OB],BB={http_get:CB,json_path_parse:AB,key_value_write:NB,key_value_read:DB,http_post:wB},PB={type:"parameter_list",message0:"参数列表 %1",args0:[{type:"input_statement",name:"parameter_list",check:"Parameter"}],colour:230,tooltip:"",helpUrl:""},UB={type:"any_parameter",message0:"任何类型参数 %1 %2 参数必选 %3",args0:[{type:"field_input",name:"name",text:"参数名称"},{type:"input_dummy"},{type:"field_checkbox",name:"required",checked:true}],previousStatement:"Parameter",nextStatement:"Parameter",colour:230,tooltip:"",helpUrl:""},FB={type:"string_parameter",message0:"字符串类型参数 %1 %2 参数必选 %3",args0:[{type:"field_input",name:"name",text:"参数名称"},{type:"input_dummy"},{type:"field_checkbox",name:"required",checked:true}],previousStatement:"Parameter",nextStatement:"Parameter",colour:230,tooltip:"",helpUrl:""},GB={type:"number_parameter",message0:"数字类型参数 %1 %2 参数必选 %3",args0:[{type:"field_input",name:"name",text:"参数名称"},{type:"input_dummy"},{type:"field_checkbox",name:"required",checked:true}],previousStatement:"Parameter",nextStatement:"Parameter",colour:230,tooltip:"",helpUrl:""},HB={type:"int_parameter",message0:"整数类型参数 %1 %2 参数必选 %3",args0:[{type:"field_input",name:"name",text:"参数名称"},{type:"input_dummy"},{type:"field_checkbox",name:"required",checked:true}],previousStatement:"Parameter",nextStatement:"Parameter",colour:230,tooltip:"",helpUrl:""},VB={type:"boolean_parameter",message0:"布尔类型参数 %1 %2 参数必选 %3",args0:[{type:"field_input",name:"name",text:"参数名称"},{type:"input_dummy"},{type:"field_checkbox",name:"required",checked:true}],previousStatement:"Parameter",nextStatement:"Parameter",colour:230,tooltip:"",helpUrl:""},WB={type:"posint_parameter",message0:"正整数类型参数 %1 %2 参数必选 %3",args0:[{type:"field_input",name:"name",text:"参数名称"},{type:"input_dummy"},{type:"field_checkbox",name:"required",checked:true}],previousStatement:"Parameter",nextStatement:"Parameter",colour:230,tooltip:"",helpUrl:""},zB={type:"text_parameter",message0:"长文本类型参数 %1 %2 参数必选 %3",args0:[{type:"field_input",name:"name",text:"参数名称"},{type:"input_dummy"},{type:"field_checkbox",name:"required",checked:true}],previousStatement:"Parameter",nextStatement:"Parameter",colour:230,tooltip:"",helpUrl:""},jB=[PB,UB,FB,GB,HB,VB,WB,zB],XB={type:"get_argument",message0:"第 %1 个参数",args0:[{type:"field_number",name:"id",value:0}],output:"String",extensions:["argument_consumer"],colour:230,tooltip:"",helpUrl:""};function KB(s){return[`args[${s.getFieldValue("id")}]`,se.javascriptGenerator.ORDER_NONE]}const YB={type:"break_middleware",message0:"终止后续逻辑执行",previousStatement:null,extensions:["session_consumer"],colour:230,tooltip:"",helpUrl:""};function qB(){return`return null;
`}const JB={type:"session_message",message0:"发送消息的内容",extensions:["session_consumer"],output:"String",colour:230,tooltip:"",helpUrl:""};function ZB(){return["session.content",se.javascriptGenerator.ORDER_NONE]}const QB={type:"session_user_id",message0:"发送消息用户的平台用户ID",output:"String",extensions:["session_consumer"],colour:230,tooltip:"",helpUrl:""};function eP(){return["session.userId",se.javascriptGenerator.ORDER_NONE]}const tP={type:"session_bot",message0:"收到消息的机器人对象",output:"String",extensions:["session_consumer"],colour:230,tooltip:"",helpUrl:""};function sP(){return["session.bot",se.javascriptGenerator.ORDER_NONE]}const iP={type:"session_guild_id",message0:"消息来自的群组编号",output:"String",extensions:["session_consumer"],colour:230,tooltip:"",helpUrl:""};function nP(){return["session.channelId",se.javascriptGenerator.ORDER_NONE]}const rP={type:"session_channel_id",message0:"消息来自的频道编号(群号)",output:"String",extensions:["session_consumer"],colour:230,tooltip:"",helpUrl:""};function oP(){return["session.guildId",se.javascriptGenerator.ORDER_NONE]}const aP={type:"session_message_id",message0:"消息编号",output:"String",extensions:["session_consumer"],colour:230,tooltip:"",helpUrl:""};function lP(){return["session.messageId",se.javascriptGenerator.ORDER_NONE]}const cP={type:"session_elements",message0:"当前消息的消息元素列表",output:"Array",extensions:["session_consumer"],colour:230,tooltip:"",helpUrl:""};function uP(){return["session.elements",se.javascriptGenerator.ORDER_NONE]}const hP=[XB,YB,JB,QB,rP,iP,aP,tP,cP],dP={get_argument:KB,break_middleware:qB,session_message:ZB,session_user_id:eP,session_channel_id:nP,session_guild_id:oP,session_message_id:lP,session_bot:sP,session_elements:uP},_P={type:"delete_message",message0:"撤回消息 %1 机器人对象 %2 消息ID %3 频道ID %4",args0:[{type:"input_dummy"},{type:"input_value",name:"bot"},{type:"input_value",name:"message_id"},{type:"input_value",name:"channel_id"}],inputsInline:false,previousStatement:null,nextStatement:null,colour:230,tooltip:"",helpUrl:""};function pP(s){let n=se.javascriptGenerator.valueToCode(s,"bot",se.javascriptGenerator.ORDER_ATOMIC),i=se.javascriptGenerator.valueToCode(s,"message_id",se.javascriptGenerator.ORDER_ATOMIC),o=se.javascriptGenerator.valueToCode(s,"channel_id",se.javascriptGenerator.ORDER_ATOMIC);return`await ${n}.deleteMessage(${o},${i});
`}const gP={type:"mute_user",message0:"禁言用户 %1 机器人对象 %2 用户ID %3 群组ID %4 禁言时间(毫秒) %5",args0:[{type:"input_dummy"},{type:"input_value",name:"bot"},{type:"input_value",name:"user_id"},{type:"input_value",name:"guild_id"},{type:"input_value",name:"time"}],inputsInline:false,previousStatement:null,nextStatement:null,colour:230,tooltip:"",helpUrl:""};function fP(s){let n=se.javascriptGenerator.valueToCode(s,"bot",se.javascriptGenerator.ORDER_ATOMIC),i=se.javascriptGenerator.valueToCode(s,"user_id",se.javascriptGenerator.ORDER_ATOMIC),o=se.javascriptGenerator.valueToCode(s,"guild_id",se.javascriptGenerator.ORDER_ATOMIC),l=se.javascriptGenerator.valueToCode(s,"time",se.javascriptGenerator.ORDER_ATOMIC);return`await ${n}.muteGuildMember(${o},${i},${l});
`}const mP=[_P,gP],EP={delete_message:pP,mute_user:fP},vP={type:"logging",message0:"输出一个 %1 级别的日志 %2",args0:[{type:"field_dropdown",name:"level",options:[["调试","debug"],["提示","info"],["警告","warn"],["成功","success"],["错误","error"]]},{type:"input_value",name:"log"}],template:["logger_initialize"],previousStatement:null,nextStatement:null,colour:230,tooltip:"",helpUrl:""},bP=function(s){var n=s.getFieldValue("level"),i=se.javascriptGenerator.valueToCode(s,"log",se.javascriptGenerator.ORDER_ATOMIC);return`logger.${n}(${i});
`},TP=[vP],SP={logging:bP},$P={type:"middleware",message0:"当接受到聊天消息 %1 %2",args0:[{type:"input_dummy"},{type:"input_statement",name:"callback"}],extensions:["session_provider"],colour:230,tooltip:"",helpUrl:""};function yP(s){return`ctx.middleware(async (session,next)=>{
${se.javascriptGenerator.statementToCode(s,"callback")}  return next();
})`}const RP={type:"on_message_event",message0:"当消息 %1 %2 运行 %3",args0:[{type:"field_dropdown",name:"event_name",options:[["被删除(撤回)","message-deleted"],["消息被修改","message-updated"],["被机器人发送","send"]]},{type:"input_dummy"},{type:"input_statement",name:"listener"}],extensions:["session_provider"],colour:230,tooltip:"",helpUrl:""},IP={type:"on_guild_member_event",message0:"当群组成员 %1 %2 运行 %3",args0:[{type:"field_dropdown",name:"event_name",options:[["加入","guild-member-added"],["退出/踢出","guild-member-deleted"],["申请加入","guild-member-request"]]},{type:"input_dummy"},{type:"input_statement",name:"listener"}],extensions:["session_provider"],colour:230,tooltip:"",helpUrl:""},CP={type:"on_guild_event",message0:"当你的机器人 %1 群组 %2 运行 %3",args0:[{type:"field_dropdown",name:"event_name",options:[["加入","guild-added"],["退出/被踢出","guild-deleted"],["被邀请到一个","guild-request"]]},{type:"input_dummy"},{type:"input_statement",name:"listener"}],extensions:["session_provider"],colour:230,tooltip:"",helpUrl:""};function bg(s){var n=s.getFieldValue("event_name"),i=se.javascriptGenerator.statementToCode(s,"listener");return`ctx.on('${n}',async (session)=>{
${i}
})`}const OP={type:"plugin_apply",message0:"当启用插件时 %1 执行 %2",args0:[{type:"input_dummy"},{type:"input_statement",name:"apply"}],inputsInline:false,colour:230,tooltip:"",helpUrl:""};function wP(s){return se.javascriptGenerator.statementToCode(s,"apply")}const kP={type:"command",message0:"创建一个新的指令 %1 %2 调用函数 %3",args0:[{type:"field_input",name:"name",text:"指令名称"},{type:"input_dummy"},{type:"input_statement",name:"action"}],mutator:"parameter_list",extensions:["session_provider","argument_provider"],colour:230,tooltip:"",helpUrl:""};function AP(s){var _;let n=s.getFieldValue("name"),i=s.parameters??[],o=se.javascriptGenerator.statementToCode(s,"action");console.info(s.workspace.meta);let l=((_=s.workspace.meta.commands)==null?void 0:_[n])??{},f=l.description?`,\`${l.description.replace(`
`,"\\n")}\``:"";l.description&&delete l.description;let m=l&&Object.keys(l).length>0?`,${JSON.stringify(l)}`:"";return`ctx.command('${(n+" "+i.map(c=>{const{required:h,name:p,type:T}=c;return(h?"<":"[")+p+(T!="any_parameter"?":"+T.split("_")[0]:"")+(h?">":"]")}).join(" ")).trim()}'${f}${m}).action(async ({session},...args)=>{
${o}
});
`}const LP=[$P,RP,IP,CP,OP,kP],NP={middleware:yP,command:AP,plugin_apply:wP,on_message_event:bg,on_guild_member_event:bg,on_guild_event:bg},MP={type:"time_stamp",message0:"%1 时间戳",args0:[{type:"field_dropdown",name:"type",options:[["13位","13"],["11位","11"]]}],output:null,colour:230,tooltip:"",helpUrl:""};function DP(s){return[`Math.round(new Date() ${s.getFieldValue("type")==="11"?" / 1000":""})`,se.javascriptGenerator.ORDER_NONE]}const xP={type:"time_format",message0:"日期时间格式 %1 13位时间戳 %2",args0:[{type:"field_input",name:"fmt",text:"yyyy-MM-dd hh:mm:ss"},{type:"input_value",name:"date"}],output:null,imports:{koishi:["Time"]},colour:230,tooltip:"",helpUrl:""};function BP(s){var n=se.javascriptGenerator.valueToCode(s,"date",se.javascriptGenerator.ORDER_ATOMIC),i=s.getFieldValue("fmt");return[`Time.template('${i}',new Date(${n}))`,se.javascriptGenerator.ORDER_NONE]}const PP={type:"plugin_id",message0:"当前插件ID",output:null,colour:230,tooltip:"",template:["plugin_id"],helpUrl:""};function UP(s){return["plugin_id",se.javascriptGenerator.ORDER_NONE]}const FP=[MP,xP,PP],GP={time_stamp:DP,time_format:BP,plugin_id:UP},HP="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIiBmaWxsPSJ3aGl0ZSI+CiAgICA8cGF0aCBkPSJNMTg0IDE2MEMxOTMuNSAxNjAgMjAyLjEgMTY1LjYgMjA1LjkgMTc0LjNMMjY5LjkgMzE4LjNDMjc1LjMgMzMwLjQgMjY5LjkgMzQ0LjUgMjU3LjcgMzQ5LjlDMjQ1LjYgMzU1LjMgMjMxLjUgMzQ5LjkgMjI2LjEgMzM3LjdMMjIxLjcgMzI4SDE0Ni4zTDE0MS45IDMzNy43QzEzNi41IDM0OS45IDEyMi40IDM1NS4zIDExMC4zIDM0OS45Qzk4LjE0IDM0NC41IDkyLjY5IDMzMC40IDk4LjA3IDMxOC4zTDE2Mi4xIDE3NC4zQzE2NS45IDE2NS42IDE3NC41IDE2MCAxODQgMTYwSDE4NHpNMTY3LjYgMjgwSDIwMC40TDE4NCAyNDMuMUwxNjcuNiAyODB6TTMwNCAxODRDMzA0IDE3MC43IDMxNC43IDE2MCAzMjggMTYwSDM4MEM0MTMuMSAxNjAgNDQwIDE4Ni45IDQ0MCAyMjBDNDQwIDIyOS4yIDQzNy45IDIzNy45IDQzNC4yIDI0NS43QzQ0Ny41IDI1Ni43IDQ1NiAyNzMuNCA0NTYgMjkyQzQ1NiAzMjUuMSA0MjkuMSAzNTIgMzk2IDM1MkgzMjhDMzE0LjcgMzUyIDMwNCAzNDEuMyAzMDQgMzI4VjE4NHpNMzUyIDIwOFYyMzJIMzgwQzM4Ni42IDIzMiAzOTIgMjI2LjYgMzkyIDIyMEMzOTIgMjEzLjQgMzg2LjYgMjA4IDM4MCAyMDhIMzUyek0zNTIgMzA0SDM5NkM0MDIuNiAzMDQgNDA4IDI5OC42IDQwOCAyOTJDNDA4IDI4NS40IDQwMi42IDI4MCAzOTYgMjgwSDM1MlYzMDR6TTAgMTI4QzAgOTIuNjUgMjguNjUgNjQgNjQgNjRINTc2QzYxMS4zIDY0IDY0MCA5Mi42NSA2NDAgMTI4VjM4NEM2NDAgNDE5LjMgNjExLjMgNDQ4IDU3NiA0NDhINjRDMjguNjUgNDQ4IDAgNDE5LjMgMCAzODRWMTI4ek02NCAzODRINTc2VjEyOEg2NFYzODR6Ii8+Cjwvc3ZnPg==",VP={type:"regular",message0:"正则表达式 %1 %2",args0:[{type:"field_input",name:"regular",text:"/.*/g"},{type:"input_value",name:"str"}],output:null,colour:160,tooltip:"",helpUrl:""};function WP(s){let n=s.getFieldValue("regular"),i=se.javascriptGenerator.valueToCode(s,"str",se.javascriptGenerator.ORDER_ATOMIC),o=n==null?void 0:n.match("/(.*)/([gmiyusd]*)");return[`(${i}).match(new RegExp("${o[1]}", "${o[2]}"))`,se.javascriptGenerator.ORDER_ATOMIC]}const zP={type:"template_string",message0:"%1 模板字符串",args0:[{type:"field_image",name:"edit_template",src:HP,alt:"编辑模板",width:25,height:25}],output:null,colour:160,init(){this.loadSlotsWithTemplate=function(){this.inputList.filter(s=>s.name.startsWith("input_")).forEach(s=>this.removeInput(s.name)),this.text_template&&this.text_template.variables.forEach(s=>{this.appendValueInput(`input_${s}`).appendField(s)})},this.getField("edit_template").setOnClickHandler(async s=>{const n=s.getSourceBlock().workspace;this.text_template=await n.topLevel.openDialog("text-template",this.text_template??{variables:[]}),console.info(this.text_template),this.loadSlotsWithTemplate()}),this.saveExtraState=function(){return{template:this.text_template}},this.loadExtraState=function(s){this.text_template=s.template,this.loadSlotsWithTemplate()}}};function jP(s){if(!s.text_template)return['""',se.javascriptGenerator.ORDER_ATOMIC];const n=s.text_template.variables,i=n.map(l=>se.javascriptGenerator.valueToCode(s,`input_${l}`,se.javascriptGenerator.ORDER_ATOMIC));return[`\`${s.text_template.template.replace(/\$\{([^}]+)\}/g,(l,f)=>`\${${i[n.indexOf(f)]}}`).replaceAll(`
`,"\\n").replaceAll("`","\\`")}\``,se.javascriptGenerator.ORDER_ATOMIC]}const XP=[zP,VP],KP={regular:WP,template_string:jP},YP={type:"sleep",message0:"等待 %1 毫秒",args0:[{type:"input_value",name:"milliseconds",check:["Number"]}],previousStatement:null,nextStatement:null,colour:230,tooltip:"",helpUrl:""};function qP(s){return`await new Promise(resolve => ctx.setTimeout(resolve, ${se.javascriptGenerator.valueToCode(s,"milliseconds",se.javascriptGenerator.ORDER_ATOMIC)}));
`}const JP=[YP],ZP={sleep:qP},QP={type:"send_session_message",message0:"发送消息给事件发送者 %1",args0:[{type:"input_value",name:"content",check:["Boolean","String"]}],previousStatement:null,nextStatement:null,extensions:["session_consumer"],colour:230,tooltip:"",helpUrl:""};function e2(s){return`await session.send(${se.javascriptGenerator.valueToCode(s,"content",se.javascriptGenerator.ORDER_ATOMIC)});
`}const t2={type:"broadcast",message0:"广播 %1 群聊列表 %2 消息内容 %3",args0:[{type:"input_dummy"},{type:"input_value",name:"NAME"},{type:"input_value",name:"NAME1",align:"RIGHT"}],previousStatement:null,nextStatement:null,colour:230,tooltip:"发送广播消息到指定群聊",helpUrl:"https://forum.koishi.xyz/t/topic/6245"};function s2(s){let n=se.javascriptGenerator.valueToCode(s,"NAME",se.javascriptGenerator.ORDER_ATOMIC),i=se.javascriptGenerator.valueToCode(s,"NAME1",se.javascriptGenerator.ORDER_ATOMIC);return`await session.bot.broadcast(${n}, ${i});
`}const i2={type:"return_message",message0:"终止后续逻辑并发送消息 %1",args0:[{type:"input_value",name:"content",check:["Boolean","String"]}],previousStatement:null,extensions:["session_consumer"],colour:230,tooltip:"",helpUrl:""};function n2(s){return`return ${se.javascriptGenerator.valueToCode(s,"content",se.javascriptGenerator.ORDER_ATOMIC)};
`}const r2={type:"bot_sendmessage",message0:"发送消息给事件发送者并返回消息id %1",args0:[{type:"input_value",name:"NAME"}],output:null,colour:230,tooltip:"",helpUrl:""};function o2(s){return[`await bot.sendMessage(session.channelId , ${se.javascriptGenerator.valueToCode(s,"NAME",se.javascriptGenerator.ORDER_ATOMIC)})`,se.javascriptGenerator.ORDER_NONE]}const a2={type:"session_prompt",message0:"等待输入消息 %1 等待时间 %2",args0:[{type:"input_dummy"},{type:"input_value",name:"time",align:"RIGHT"}],output:null,colour:230,tooltip:"等待用户输入，返回输入文本。若超时未输入返回未定义undefined",helpUrl:""};function l2(s){return[`await session.prompt (${se.javascriptGenerator.valueToCode(s,"time",se.javascriptGenerator.ORDER_ATOMIC)})`,se.javascriptGenerator.ORDER_NONE]}const c2=[QP,i2,t2,a2,r2],u2={send_session_message:e2,return_message:n2,broadcast:s2,session_prompt:l2,bot_sendmessage:o2},h2={type:"segment_at",message0:"@ %1",args0:[{type:"input_value",name:"user",check:"String"}],output:"String",imports:{koishi:["h"]},colour:230,tooltip:"",helpUrl:""};function d2(s){return[`h('at',{ id: ${se.javascriptGenerator.valueToCode(s,"user",se.javascriptGenerator.ORDER_ATOMIC)} })`,se.javascriptGenerator.ORDER_NONE]}const _2={type:"segment_image",message0:"图片 %1",args0:[{type:"input_value",name:"image",check:"String"}],output:"String",imports:{koishi:["h"]},colour:230,tooltip:"",helpUrl:""};function p2(s){return[`h('image',{ url: ${se.javascriptGenerator.valueToCode(s,"image",se.javascriptGenerator.ORDER_ATOMIC)} })`,se.javascriptGenerator.ORDER_NONE]}const g2={type:"segment_audio",message0:"语音 %1",args0:[{type:"input_value",name:"audio",check:"String"}],output:"String",imports:{koishi:["h"]},colour:230,tooltip:"",helpUrl:""};function f2(s){return[`h('audio',{ url: ${se.javascriptGenerator.valueToCode(s,"audio",se.javascriptGenerator.ORDER_ATOMIC)} })`,se.javascriptGenerator.ORDER_NONE]}const m2={type:"segment_video",message0:"视频 %1",args0:[{type:"input_value",name:"video",check:"String"}],output:"String",imports:{koishi:["h"]},colour:230,tooltip:"",helpUrl:""};function E2(s){return[`h('video',{ url: ${se.javascriptGenerator.valueToCode(s,"video",se.javascriptGenerator.ORDER_ATOMIC)} })`,se.javascriptGenerator.ORDER_NONE]}const v2={type:"parse_segment_list",message0:"解析消息元素列表 %1 对每个元素按顺序执行:",args0:[{type:"input_value",name:"segments"}],colour:230,tooltip:"",helpUrl:"",inputsInline:false,mutator:"segment_parser",previousStatement:null,nextStatement:null};function b2(s){let n=se.javascriptGenerator.valueToCode(s,"segments",se.javascriptGenerator.ORDER_ATOMIC),i=s.inputList.filter(f=>f.name.startsWith("branch_type_")).map(f=>f.name.substring(12)),o=Object.fromEntries(i.map(f=>[f,s.getFieldValue(`branch_type_${f}_selector`)])),l=Object.fromEntries(i.map(f=>[f,se.javascriptGenerator.statementToCode(s,`branch_action_${f}`,se.javascriptGenerator.ORDER_ATOMIC)]));return`for(let current_segment of ${n}){
  switch(segment.type){
    ${Object.entries(o).map(([f,m])=>`case '${m}':
      ${l[f]}
        break;`).join(`
`)}
  }
}`}const T2={type:"current_segment",message0:"当前指向的消息元素",output:null,colour:230,tooltip:""};function S2(s){return["current_segment",se.javascriptGenerator.ORDER_NONE]}const $2=[h2,_2,g2,m2,v2,T2],y2={segment_at:d2,segment_image:p2,segment_audio:f2,segment_video:E2,parse_segment_list:b2,current_segment:S2},R2={type:"to_number",message0:"转换为数字 %1",args0:[{type:"input_value",name:"value"}],inputsInline:false,output:null,colour:230,tooltip:"",helpUrl:""};function I2(s){return[`Number(${se.javascriptGenerator.valueToCode(s,"value",se.javascriptGenerator.ORDER_ATOMIC)})`,se.javascriptGenerator.ORDER_ATOMIC]}const C2=[R2],O2={to_number:I2};class Sh extends A.FieldDropdown{constructor(n){super(A.Field.SKIP_SETUP),this.targets=n,this.trace=Symbol("Dropdown Tracing"),this.menuGenerator_=Sh.generateBindingMenu,n.forEach(i=>{this.traceReactive(i)}),n.addWatcher((i,o,l)=>{l==="add"?this.traceReactive(o):this.detachReactive(o)})}static generateBindingMenu(){return Array.from(this.targets).map(n=>[n.value,n.identifier])}traceReactive(n){n[this.trace]||(n[this.trace]=n.addWatcher(i=>{this.value_==n.identifier&&(this.value_=n.identifier,this.doValueUpdate_(n.identifier),this.forceRerender())}))}detachReactive(n){n[this.trace]&&(n.removeWatcher(n[this.trace]),this.value_==n.identifier&&(this.value_=void 0,this.forceRerender()),delete n[this.trace])}dispose(){this.targets.forEach(n=>{this.detachReactive(n)}),super.dispose()}getDisplayText_(){var n;return((n=this.menuGenerator_().find(i=>i[1]==this.value_))==null?void 0:n[0])??""}doClassValidation_(n){return n}getOptions(n){return this.menuGenerator_().length==0?[]:super.getOptions(n)}}class w2{constructor(n,i){this.value=n,this.identifier=i,this.watcher=new Set}set(n){this.value=n,this.watcher.forEach(i=>i(n))}addWatcher(n){return this.watcher.add(n),n}removeWatcher(n){this.watcher.delete(n)}}class k2 extends Set{constructor(){super(),this.watcher=new Set}add(n){return this.watcher.forEach(i=>i(this,n,"add")),super.add(n)}delete(n){return this.watcher.forEach(i=>i(this,n,"remove")),super.delete(n)}addWatcher(n){this.watcher.add(n)}removeWatcher(n){this.watcher.delete(n)}}const A2={type:"type_root",message0:"类型 %1",args0:[{type:"input_value",name:"type",check:"Type"}],colour:"#ce4bc9",tooltip:"",helpUrl:""},L2={type:"type_definition",message0:"定义类型 %1 %2",args0:[{type:"field_input",name:"name",text:"类型名称"},{type:"input_value",name:"type",check:"Type"}],colour:"#ce4bc9",tooltip:"",helpUrl:"",init(){if(!this.workspace.typings)return;this.type_value=new w2(this.getFieldValue("name"),this.id),this.workspace.typings.add(this.type_value),this.onchange=()=>{this.type_value.set(this.getFieldValue("name"))};const s=this.dispose;this.dispose=n=>{this.workspace.typings.delete(this.type_value),s.bind(this)(n)}}},N2={type:"type_any",message0:"任意类型",output:"Type",colour:"#ce4bc9",tooltip:""},M2={type:"type_never",message0:"永远不会出现的类型",output:"Type",colour:"#ce4bc9",tooltip:""},D2={type:"type_string",message0:"字符串",output:"Type",colour:"#ce4bc9",tooltip:""},x2={type:"type_number",message0:"数字",output:"Type",colour:"#ce4bc9",tooltip:""},B2={type:"type_boolean",message0:"布尔值",output:"Type",colour:"#ce4bc9",tooltip:""},P2={type:"type_array",message0:"由%1组成的数组",args0:[{type:"input_value",name:"type",check:"Type"}],output:"Type",colour:"#ce4bc9"},U2={type:"type_union_root",message0:"联合类型 %1",args0:[{type:"input_statement",name:"types",check:"Type"}]},F2={type:"type_union_entity",message0:"项目",previousStatement:"Type",nextStatement:"Type",colour:160},G2={type:"type_union",output:"Type",message0:"联合类型",args0:[],init(){this.updateShape_()},mutator:"union_mutator",colour:"#ce4bc9"},H2={type:"type_object_root",message0:"对象 %1",args0:[{type:"input_statement",name:"properties",check:"Type"}],colour:"#ce4bc9",tooltip:"",helpUrl:""},V2={type:"type_object_entity",message0:"属性 %1",args0:[{type:"field_input",name:"name",text:"属性名称"}],previousStatement:"Type",nextStatement:"Type",colour:160},W2={type:"type_object",message0:"对象",output:"Type",colour:"#ce4bc9",tooltip:"",helpUrl:"",mutator:"object_mutator"},z2={type:"type_getter",message0:"类型",output:"Type",colour:"#ce4bc9",tooltip:"",helpUrl:"",init(){let s;this.workspace.typings&&(s=new Sh(this.workspace.typings),this.inputList[0].appendField(s,"type"))}},j2=[A2,N2,M2,D2,x2,B2,P2,U2,F2,G2,L2,H2,V2,W2,z2],X2={type:"null",message0:"%1",args0:[{type:"field_multilinetext",name:"NAME",text:"空白"}],colour:230,tooltip:"啊，没有提示",helpUrl:""};function K2(s){return`${s.getFieldValue("NAME")};
`}const Y2={type:"null1",message0:"%1",args0:[{type:"field_multilinetext",name:"NAME",text:"空白"}],previousStatement:null,nextStatement:null,colour:230,tooltip:"啊，没有提示",helpUrl:""};function q2(s){return`${s.getFieldValue("NAME")};
`}const J2={type:"null2",message0:"%1",args0:[{type:"field_multilinetext",name:"NAME",text:"空白"}],output:null,colour:230,tooltip:"",helpUrl:""};function Z2(s){return[`${s.getFieldValue("NAME")}`,se.javascriptGenerator.ORDER_NONE]}const Q2=[X2,Y2,J2],eU={null:K2,null1:q2,null2:Z2},tU={type:"import",message0:'import { %1 } from " %2 "',args0:[{type:"field_input",name:"NAME",text:"a"},{type:"field_input",name:"NAME1",text:"b"}],colour:330,tooltip:"",helpUrl:""};function sU(s){let n=s.getFieldValue("NAME"),i=s.getFieldValue("NAME1");return`import {${n}} from "${i}"`}const iU={type:"export_const",message0:"export const %1 = %2 ",args0:[{type:"field_input",name:"NAME",text:"inject"},{type:"field_input",name:"NAME1",text:"{}"}],colour:330,tooltip:"",helpUrl:""};function nU(s){let n=s.getFieldValue("NAME"),i=s.getFieldValue("NAME1");return`export const ${n} = ${i}`}const rU=[tU,iU],oU={import:sU,export_const:nU},aU={type:"at_id",message0:"解析消息，获取第一个@的id",output:null,colour:230,tooltip:"",helpUrl:"https://forum.koishi.xyz/t/topic/6245"};function lU(s){return["session.elements.filter((element) => element.type == 'at')?.[0].attrs.id",se.javascriptGenerator.ORDER_NONE]}const cU={type:"at_name",message0:"解析消息，获取第一个@的昵称",output:null,colour:230,tooltip:"",helpUrl:"https://forum.koishi.xyz/t/topic/6245"};function uU(s){return["session.elements.filter((element) => element.type == 'at')?.[0].attrs.name",se.javascriptGenerator.ORDER_NONE]}const hU={type:"group_name",message0:"获取群聊名称",output:null,colour:230,tooltip:"",helpUrl:"https://forum.koishi.xyz/t/topic/6245"};function dU(s){return["session.event.guild.name",se.javascriptGenerator.ORDER_NONE]}const _U={type:"group_id",message0:"获取群聊id",output:null,colour:230,tooltip:"",helpUrl:"https://forum.koishi.xyz/t/topic/6245"};function pU(s){return["session.event.guild.id",se.javascriptGenerator.ORDER_NONE]}const gU=[aU,cU,hU,_U],fU={at_id:lU,at_name:uU,group_name:dU,group_id:pU},mU={type:"pptr",message0:"渲染html %1",args0:[{type:"input_value",name:"NAME"}],output:null,imports:{"koishi-plugin-puppeteer":[]},injects:["puppeteer"],template:["pptr"],colour:230,tooltip:"",helpUrl:"https://forum.koishi.xyz/t/topic/6244"};function EU(s){return[`await ctx.puppeteer.render (${se.javascriptGenerator.valueToCode(s,"NAME",se.javascriptGenerator.ORDER_ATOMIC)})`,se.javascriptGenerator.ORDER_NONE]}const vU=[mU],bU={pptr:EU},TU={type:"test",message0:"返回文件列表     输入路经 %1 文件后缀列表 %2",args0:[{type:"input_value",name:"WENJAN"},{type:"input_value",name:"NAME1"}],inputsInline:false,output:null,template:["test"],colour:225,tooltip:"",helpUrl:"https://forum.koishi.xyz/t/topic/6245"};function SU(s){let n=se.javascriptGenerator.valueToCode(s,"WENJAN",se.javascriptGenerator.ORDER_ATOMIC),i=se.javascriptGenerator.valueToCode(s,"NAME1",se.javascriptGenerator.ORDER_ATOMIC);return[`getFiles(${n}, ${i})`,se.javascriptGenerator.ORDER_NONE]}const $U={type:"MD5",message0:"MD5加密 %1",args0:[{type:"input_value",name:"NAME"}],output:null,template:["MD5"],colour:225,tooltip:"",helpUrl:"https://forum.koishi.xyz/t/topic/6245"};function yU(s){return[`x_MD5${se.javascriptGenerator.valueToCode(s,"NAME",se.javascriptGenerator.ORDER_ATOMIC)}`,se.javascriptGenerator.ORDER_NONE]}const RU={type:"toString",message0:"转换为 %1 编码 %2",args0:[{type:"field_dropdown",name:"NAME",options:[["utf8","utf8"],["ascii","ascii"],["latin1","latin1"],["hex","hex"],["base64","base64"]]},{type:"input_value",name:"NAME1"}],output:null,colour:230,tooltip:"",helpUrl:"https://forum.koishi.xyz/t/topic/6245"};function IU(s){let n=s.getFieldValue("NAME");return[`${se.javascriptGenerator.valueToCode(s,"NAME1",se.javascriptGenerator.ORDER_ATOMIC)}.toString('${n}')`,se.javascriptGenerator.ORDER_NONE]}const CU={type:"fetchDataFromUrl",message0:"文件读取 %1",args0:[{type:"input_value",name:"NAME1",check:"String"}],output:null,template:["fetchDataFromUrl"],colour:225,tooltip:"读取文件，支持http/https/file协议",helpUrl:"https://forum.koishi.xyz/t/topic/6245"};function OU(s){return[`await fetchDataFromUrl(${se.javascriptGenerator.valueToCode(s,"NAME1",se.javascriptGenerator.ORDER_ATOMIC)})`,se.javascriptGenerator.ORDER_NONE]}const wU={type:"buffer_from",message0:"创建Buffer对象 %1 编码 %2",args0:[{type:"field_dropdown",name:"NAME1",options:[["utf8","utf8"],["ascii","ascii"],["latin1","latin1"],["hex","hex"],["base64","base64"]]},{type:"input_value",name:"NAME",check:"String"}],output:"Object",colour:230,tooltip:"",helpUrl:""};function kU(s){let n=s.getFieldValue("NAME1");return[`Buffer.from(${se.javascriptGenerator.valueToCode(s,"NAME",se.javascriptGenerator.ORDER_ATOMIC)}, '${n}')`,se.javascriptGenerator.ORDER_NONE]}const AU=[TU,$U,RU,CU,wU],LU={test:SU,MD5:yU,toString:IU,fetchDataFromUrl:OU,buffer_from:kU},NU={type:"zhiling",message0:"调用指令%1",args0:[{type:"input_value",name:"NAME"}],output:null,colour:230,tooltip:"调用指令",helpUrl:"https://forum.koishi.xyz/t/topic/6245"};function MU(s){return[`session.execute(${se.javascriptGenerator.valueToCode(s,"NAME",se.javascriptGenerator.ORDER_ATOMIC)})`,se.javascriptGenerator.ORDER_NONE]}const DU=[NU],xU={zhiling:MU},BU={type:"Object",message0:"{ %1 %2 }",args0:[{type:"input_dummy"},{type:"input_statement",name:"action"}],output:null,colour:230,tooltip:"",helpUrl:""};function PU(s){return[`{
${se.javascriptGenerator.statementToCode(s,"action")}
}`,se.javascriptGenerator.ORDER_ATOMIC]}const UU={type:"Keys",message0:"%1 : %2",args0:[{type:"field_input",name:"NAME1",text:"键"},{type:"input_value",name:"NAME"}],previousStatement:null,nextStatement:null,colour:230,tooltip:"",helpUrl:""};function FU(s){let n=s.getFieldValue("NAME1"),i=se.javascriptGenerator.valueToCode(s,"NAME",se.javascriptGenerator.ORDER_ATOMIC);return`"${n}":${i},
`}const GU={type:"text_json",message0:"%1 %2",args0:[{type:"field_dropdown",name:"NAME1",options:[["文本转换为json对象","parse"],["json对象转换为文本","stringify"]]},{type:"input_value",name:"NAME"}],output:null,colour:230,tooltip:"",helpUrl:""};function HU(s){let n=s.getFieldValue("NAME1"),i=se.javascriptGenerator.valueToCode(s,"NAME",se.javascriptGenerator.ORDER_ATOMIC);return[`JSON.${n}(${i})
`,se.javascriptGenerator.ORDER_ATOMIC]}const VU=[BU,UU,GU],WU={Object:PU,Keys:FU,text_json:HU},zU=[...JP,...XP,...LP,...hP,...c2,...$2,...xB,...mP,...TP,...FP,...jB,...C2,...j2,...Q2,...rU,...gU,...vU,...AU,...DU,...VU],jU=Object.assign({},ZP,KP,NP,dP,u2,y2,BB,EP,SP,GP,O2,eU,oU,fU,bU,LU,xU,WU);function XU(){ma("parameter_list"),A.Extensions.registerMutator("parameter_list",{decompose:function(s){let n=s.newBlock("parameter_list");n.initSvg(),Array.isArray(this.parameters)||(this.parameters=[]);var i=n.getInput("parameter_list").connection;return this.parameters.forEach(o=>{let l=s.newBlock(o.type);l.setFieldValue(o.name,"name"),l.setFieldValue(o.required?"TRUE":"FALSE","required"),l.initSvg(),i.connect(l.previousConnection),i=l.nextConnection}),n},compose:function(s){const n=s.getChildren();if(console.info(n),!n.length||n.length<=0){this.parameters=[];return}const i=[];let o=n[0];for(;o;){console.info(o,o.type);const l=o.getFieldValue("name"),f=o.getFieldValue("required").toLowerCase()==="true",m=o.type;i.push({name:l,required:f,type:m}),o=o.getNextBlock()}this.parameters=i},saveExtraState:function(){return{parameters:this.parameters}},loadExtraState:function(s){this.parameters=s.parameters}},void 0,["any_parameter","string_parameter","number_parameter","boolean_parameter","int_parameter","posint_parameter","text_parameter"])}const KU=["session","argument","segment_item"];function YU(){KU.forEach(s=>{qU(s),JU(s)})}function qU(s){ma(s+"_consumer"),A.Extensions.register(s+"_consumer",function(){this.scope||(this.scope={}),this.scope.consumes||(this.scope.consumes=[]),this.scope.consumes.includes(s)||this.scope.consumes.push(s)})}function JU(s){ma(s+"_provider"),A.Extensions.register(s+"_provider",function(){this.scope||(this.scope={}),this.scope.provides||(this.scope.provides=[]),this.scope.provides.includes(s)||this.scope.provides.push(s)})}function ZU(){ma("union_mutator"),A.Extensions.registerMutator("union_mutator",{updateShape_:function(){this.inputList.filter(s=>s.name.startsWith("TYPE_")).filter(s=>parseInt(s.name.split("_")[1])<this.itemCount_).forEach(s=>this.removeInput(s.name));for(let s=0;s<this.itemCount_;s++)if(!this.getInput("TYPE_"+s)){const n=this.appendValueInput("TYPE_"+s);n.align=A.ALIGN_RIGHT,s==0?n.appendField("类型"):n.appendField("或")}},decompose:function(s){const n=s.newBlock("type_union_root");n.initSvg();let i=n.getInput("types").connection;for(let o=0;o<this.itemCount_;o++){const l=s.newBlock("type_union_entity");l.initSvg(),i.connect(l.previousConnection),i=l.nextConnection}return n},compose:function(s){this.itemCount_=0;let n=s.getInputTargetBlock("types");for(;n;)this.itemCount_++,n=n.nextConnection&&n.nextConnection.targetBlock();this.updateShape_()},saveExtraState:function(s){return{itemCount:this.itemCount_}},loadExtraState:function(s){this.itemCount_=s.itemCount,this.updateShape_()}},void 0,["type_union_entity"]),ma("object_mutator"),A.Extensions.registerMutator("object_mutator",{updateShape_:function(){var s;(s=this.properties_)==null||s.forEach((n,i)=>{if(!this.getInput("PROPERTY_"+n)){const o=this.appendValueInput("PROPERTY_"+n);o.align=A.ALIGN_RIGHT,o.appendField(n)}}),this.inputList.filter(n=>n.name.startsWith("PROPERTY_")).filter(n=>!this.properties_.includes(n.name.split("_")[1])).forEach(n=>this.removeInput(n.name))},decompose:function(s){var o;const n=s.newBlock("type_object_root");n.initSvg();let i=n.getInput("properties").connection;return(o=this.properties_)==null||o.forEach(l=>{const f=s.newBlock("type_object_entity");f.initSvg(),f.setFieldValue(l,"name"),i.connect(f.previousConnection),i=f.nextConnection}),n},compose:function(s){const n=[];let i=s.getInputTargetBlock("properties");for(;i;)n.push(i.getFieldValue("name")),i=i.nextConnection&&i.nextConnection.targetBlock();this.properties_=n,this.updateShape_()},saveExtraState:function(s){return{properties:this.properties_}},loadExtraState:function(s){this.properties_=s.properties,this.updateShape_()}},void 0,["type_object_entity"])}function QU(){ma("segment_parser"),A.Extensions.registerMutator("segment_parser",{decompose:function(s){let n=s.newBlock("parse_segment_root");n.initSvg();let i=n.getInput("types").connection;return this.inputList.filter(l=>l.name.startsWith("branch_type_")).forEach(l=>{const f=this.getFieldValue(l.name+"_selector");let m=s.newBlock("segment_type");m.setFieldValue(f,"type"),m.initSvg(),i.connect(m.previousConnection),i=m.nextConnection}),n},compose:function(s){this.inputList.filter(l=>l.name.startsWith("branch_type_")||l.name.startsWith("branch_action_")).forEach(l=>this.removeInput(l.name));const n=s.getChildren();if(!n.length||n.length<=0)return;let i=n[0],o=0;for(;i;)this.addBlockInput(i.getFieldValue("type"),o),i=i.getNextBlock(),o++},saveExtraState:function(){const s=this.inputList.filter(n=>n.name.startsWith("branch_type_")).map(n=>this.getFieldValue(n.name+"_selector"));return console.info(s),s},loadExtraState:function(s){s==null||s.forEach((n,i)=>this.addBlockInput(n,i)),console.info(s)},addBlockInput(s,n){if(this.inputList.some(l=>l.name=="branch_type_"+n))return;const i=this.appendDummyInput("branch_type_"+n);i.appendField("如果消息元素是"),i.appendField(new A.FieldDropdown([["at消息","at"],["引用回复","quote"],["图片","image"]]),"branch_type_"+n+"_selector"),this.setFieldValue(s,"branch_type_"+n+"_selector"),this.appendStatementInput("branch_action_"+n).appendField("则运行")}},void 0,["segment_type"]),A.defineBlocksWithJsonArray([{type:"segment_type",message0:"消息段类型 %1",args0:[{type:"field_dropdown",name:"type",options:[["at消息","at"],["引用回复","quote"],["图片","image"]]}],previousStatement:null,nextStatement:null,colour:230,tooltip:"",helpUrl:""},{type:"parse_segment_root",message0:"要解析的消息段类型 %1 %2",args0:[{type:"input_dummy"},{type:"input_statement",name:"types"}],colour:230,tooltip:"",helpUrl:""}])}function ma(s){A.Extensions.isRegistered(s)&&A.Extensions.unregister(s)}function eF(){XU(),YU(),ZU(),QU()}function tF(s){if(!(s.type==="move"||s.type==="create"))return;const n=s;if(!n.workspaceId||!n.blockId)return;const i=n.getEventWorkspace_();if(!i)return;let o=i.getBlockById(n.blockId);A.Events.disableOrphans(s),Nf(o)}function Nf(s){if(!s)return;const n=[].concat(s.getChildren(false));if(n&&n.forEach(f=>{Nf(f)}),!s||!s.scope||!s.scope.consumes)return;const i=new Map((Array.isArray(s.scope.consumes)?s.scope.consumes:[s.scope.consumes]).map(f=>[f,true]));s.setWarningText(null);let o=s;for(;o=o.getParent();){if(!o.scope||!o.scope.provides)continue;(Array.isArray(o.scope.provides)?o.scope.provides:[o.scope.provides]).forEach(m=>{i.delete(m)})}i.size&&(s.setEnabled(false),s.setWarningText("The consumer should be placed in the variable scope of the provider:"+Array.from(i.keys()).join(",")));const l=s.getNextBlock();l&&Nf(l)}function sF(s){(s.type==="create"||s.type==="move"||s.type==="delete"||s.type==="change")&&this.autoSave()}A.Msg.LANG_VARIABLES_GLOBAL_DECLARATION_TITLE_INIT="初始化全局变量";A.Msg.LANG_VARIABLES_GLOBAL_DECLARATION_NAME="变量名称";A.Msg.LANG_VARIABLES_GLOBAL_DECLARATION_TO="为";A.Msg.LANG_VARIABLES_GLOBAL_DECLARATION_COLLAPSED_TEXT="全局变量";A.Msg.LANG_VARIABLES_GLOBAL_DECLARATION_TOOLTIP="创建一个全局变量并赋值";A.Msg.LANG_VARIABLES_GLOBAL_PREFIX="[全局变量]";A.Msg.LANG_VARIABLES_GET_TITLE_GET="读取变量";A.Msg.LANG_VARIABLES_GET_COLLAPSED_TEXT="设置变量";A.Msg.LANG_VARIABLES_GET_TOOLTIP="返回变量的值";A.Msg.LANG_VARIABLES_SET_TITLE_SET="设置变量";A.Msg.LANG_VARIABLES_SET_TITLE_TO="为";A.Msg.LANG_VARIABLES_SET_COLLAPSED_TEXT="设置";A.Msg.LANG_VARIABLES_SET_TOOLTIP="设置变量";A.Msg.LANG_VARIABLES_VARIABLE=" 变量";A.Msg.LANG_VARIABLES_LOCAL_DECLARATION_TITLE_INIT="初始化局部变量";A.Msg.LANG_VARIABLES_LOCAL_DECLARATION_DEFAULT_NAME="局部变量1";A.Msg.LANG_VARIABLES_LOCAL_DECLARATION_INPUT_TO="为";A.Msg.LANG_VARIABLES_LOCAL_DECLARATION_IN_DO="作用域";A.Msg.LANG_VARIABLES_LOCAL_DECLARATION_COLLAPSED_TEXT="局部变量";A.Msg.LANG_VARIABLES_LOCAL_DECLARATION_TOOLTIP="Allows you to create variables that are only accessible in the do part of this block.";A.Msg.LANG_VARIABLES_LOCAL_DECLARATION_TRANSLATED_NAME="initialize local in do";A.Msg.LANG_VARIABLES_LOCAL_DECLARATION_EXPRESSION_IN_RETURN="in";A.Msg.LANG_VARIABLES_LOCAL_DECLARATION_EXPRESSION_COLLAPSED_TEXT="local";A.Msg.LANG_VARIABLES_LOCAL_DECLARATION_EXPRESSION_TOOLTIP="Allows you to create variables that are only accessible in the return part of this block.";A.Msg.LANG_VARIABLES_LOCAL_DECLARATION_EXPRESSION_TRANSLATED_NAME="initialize local in return";A.Msg.LANG_VARIABLES_LOCAL_MUTATOR_CONTAINER_TITLE_LOCAL_NAMES="local names";A.Msg.LANG_VARIABLES_LOCAL_MUTATOR_CONTAINER_TOOLTIP="";A.Msg.LANG_VARIABLES_LOCAL_MUTATOR_ARG_TITLE_NAME="name";A.Msg.LANG_VARIABLES_LOCAL_MUTATOR_ARG_DEFAULT_VARIABLE="x";A.Msg.LANG_PROCEDURES_DEFNORETURN_DEFINE="to";A.Msg.LANG_PROCEDURES_DEFNORETURN_PROCEDURE="procedure";A.Msg.LANG_PROCEDURES_DEFNORETURN_DO="do";A.Msg.LANG_PROCEDURES_DEFNORETURN_COLLAPSED_PREFIX="to ";A.Msg.LANG_PROCEDURES_DEFNORETURN_TOOLTIP="A procedure that does not return a value.";A.Msg.LANG_PROCEDURES_DOTHENRETURN_THEN_RETURN="result";A.Msg.LANG_PROCEDURES_DOTHENRETURN_DO="do";A.Msg.LANG_PROCEDURES_DOTHENRETURN_RETURN="result";A.Msg.LANG_PROCEDURES_DOTHENRETURN_TOOLTIP="Runs the blocks in 'do' and returns a statement. Useful if you need to run a procedure before returning a value to a variable.";A.Msg.LANG_PROCEDURES_DOTHENRETURN_COLLAPSED_TEXT="do/result";A.Msg.LANG_PROCEDURES_DEFRETURN_DEFINE="to";A.Msg.LANG_PROCEDURES_DEFRETURN_PROCEDURE="procedure";A.Msg.LANG_PROCEDURES_DEFRETURN_RETURN="result";A.Msg.LANG_PROCEDURES_DEFRETURN_COLLAPSED_PREFIX="to ";A.Msg.LANG_PROCEDURES_DEFRETURN_TOOLTIP="A procedure returning a result value.";A.Msg.LANG_PROCEDURES_DEF_DUPLICATE_WARNING=`Warning:
This procedure has
duplicate inputs.`;A.Msg.LANG_PROCEDURES_CALLNORETURN_CALL="call ";A.Msg.LANG_PROCEDURES_CALLNORETURN_PROCEDURE="procedure";A.Msg.LANG_PROCEDURES_CALLNORETURN_COLLAPSED_PREFIX="call ";A.Msg.LANG_PROCEDURES_CALLNORETURN_TOOLTIP="Call a procedure with no return value.";A.Msg.LANG_PROCEDURES_CALLNORETURN_TRANSLATED_NAME="call no return";A.Msg.LANG_PROCEDURES_CALLRETURN_COLLAPSED_PREFIX="call ";A.Msg.LANG_PROCEDURES_CALLRETURN_TOOLTIP="Call a procedure with a return value.";A.Msg.LANG_PROCEDURES_CALLRETURN_TRANSLATED_NAME="call return";A.Msg.LANG_PROCEDURES_MUTATORCONTAINER_TITLE="inputs";A.Msg.LANG_PROCEDURES_MUTATORARG_TITLE="input:";A.Msg.LANG_PROCEDURES_HIGHLIGHT_DEF="Highlight Procedure";A.Msg.LANG_PROCEDURES_MUTATORCONTAINER_TOOLTIP="";A.Msg.LANG_PROCEDURES_MUTATORARG_TOOLTIP="";A.Msg.LANG_CONTROLS_FOR_INPUT_WITH="count with";A.Msg.LANG_CONTROLS_FOR_INPUT_VAR="x";A.Msg.LANG_CONTROLS_FOR_INPUT_FROM="from";A.Msg.LANG_CONTROLS_FOR_INPUT_TO="to";A.Msg.LANG_CONTROLS_FOR_INPUT_DO="do";A.Msg.LANG_CONTROLS_FOR_TOOLTIP=`Count from a start number to an end number.
For each count, set the current count number to
variable '%1', and then do some statements.`;A.Msg.LANG_CONTROLS_FORRANGE_INPUT_ITEM="变量";A.Msg.LANG_CONTROLS_FORRANGE_INPUT_VAR="number";A.Msg.LANG_CONTROLS_FORRANGE_INPUT_START="从";A.Msg.LANG_CONTROLS_FORRANGE_INPUT_END="数到";A.Msg.LANG_CONTROLS_FORRANGE_INPUT_STEP="每次增加";A.Msg.LANG_CONTROLS_FORRANGE_INPUT_DO="执行";A.Msg.LANG_CONTROLS_FORRANGE_INPUT_COLLAPSED_TEXT="for number in range";A.Msg.LANG_CONTROLS_FORRANGE_INPUT_COLLAPSED_PREFIX="for";A.Msg.LANG_CONTROLS_FORRANGE_INPUT_COLLAPSED_SUFFIX=" in range";A.Msg.LANG_CONTROLS_FORRANGE_TOOLTIP='让变量"i"记录开始数到结束数之间指定间隔的值，并执行一些语句';A.Msg.LANG_CONTROLS_FOREACH_INPUT_ITEM="遍历列表里的每一项";A.Msg.LANG_CONTROLS_FOREACH_INPUT_VAR="item";A.Msg.LANG_CONTROLS_FOREACH_INPUT_INLIST="列表";A.Msg.LANG_CONTROLS_FOREACH_INPUT_DO="执行";A.Msg.LANG_CONTROLS_FOREACH_INPUT_COLLAPSED_TEXT="for item in list";A.Msg.LANG_CONTROLS_FOREACH_INPUT_COLLAPSED_PREFIX="for ";A.Msg.LANG_CONTROLS_FOREACH_INPUT_COLLAPSED_SUFFIX=" in list";A.Msg.LANG_CONTROLS_FOREACH_TOOLTIP='遍历列表中的每一项，将变量"j"设为所选项，并执行一些语句';A.Msg.LANG_CONTROLS_FOREACH_DICT_INPUT="for each %1 with %2 in dictionary %3";A.Msg.LANG_CONTROLS_FOREACH_DICT_INPUT_DO="do";A.Msg.LANG_CONTROLS_FOREACH_DICT_INPUT_KEY="key";A.Msg.LANG_CONTROLS_FOREACH_DICT_INPUT_VALUE="value";A.Msg.LANG_CONTROLS_FOREACH_DICT_TITLE="for each in dictionary";A.Msg.LANG_CONTROLS_FOREACH_DICT_TOOLTIP="Runs the blocks in the 'do' section for each key-value entry in the dictionary. Use the given variable names to refer to the key/value of the current dictionary item.";A.Msg.ERROR_SELECT_VALID_ITEM_FROM_DROPDOWN="Select a valid item in the drop down.";A.Msg.ERROR_BLOCK_CANNOT_BE_IN_DEFINITION="This block cannot be in a definition";A.Msg.HORIZONTAL_PARAMETERS="Arrange Parameters Horizontally";A.Msg.VERTICAL_PARAMETERS="Arrange Parameters Vertically";A.Msg.LANG_CONTROLS_DO_THEN_RETURN_INPUT_DO="do";A.Msg.LANG_CONTROLS_DO_THEN_RETURN_INPUT_RETURN="result";A.Msg.LANG_CONTROLS_DO_THEN_RETURN_TOOLTIP="Runs the blocks in 'do' and returns a statement. Useful if you need to run a procedure before returning a value to a variable.";A.Msg["LANG_CONTROLS_DO_THEN_ RETURN_COLLAPSED_TEXT"]="do/result";A.Msg.LANG_CONTROLS_DO_THEN_RETURN_TITLE="do result";function iF(s){A.Blocks[s.type]={init:function(){var n;this.jsonInit(s),this.imports=s.imports,this.template=s.template,(n=s.args0)==null||n.forEach(i=>{if(i.type==="input_value"){if(!i.input_type)return;const o=this.getInput(i.name);o&&(o.input_type=i.input_type)}}),s.init&&s.init.apply(this)}}}function nF(s){s.forEach(iF)}function rF(){if(!Ir.blockly_vendors)return[];const s=Object.values(Ir.blockly_vendors);return s.forEach(n=>{A.defineBlocksWithJsonArray(n.blocks.map(i=>i.definition))}),console.info(s.map(n=>n.blocks).flat(10).map(n=>n.definition).map(n=>n.type).map(n=>({kind:"block",type:n}))),s.map(n=>n.blocks).flat(10).map(n=>n.definition).map(n=>n.type).map(n=>({kind:"block",type:n}))}const oF=Ke({__name:"variable",props:["modelValue"],emits:["update:modelValue","tag-click","tag-removed"],setup(s,{emit:n}){const i=s,o=n,l=_e({get:()=>i.modelValue??[],set:$=>o("update:modelValue",$)}),f=me(""),m=l,u=me(false),_=me(),c=$=>{m.value.splice(m.value.indexOf($),1),o("tag-removed")},h=()=>{u.value=true,rs(()=>{_.value.input.focus()})},p=()=>{f.value&&m.value.push(f.value),u.value=false,f.value=""};function T($){o("tag-click",$)}return($,S)=>{const y=gt("el-tag"),g=gt("el-button");return ne(),ve(Pt,null,[(ne(true),ve(Pt,null,pi(ue(m),E=>(ne(),Ye(y,{key:E,color:"orange",closable:"","disable-transitions":false,onClose:v=>c(E),onClick:v=>T(E),style:{cursor:"pointer"}},{default:je(()=>[xt(Bt(E),1)]),_:2},1032,["onClose","onClick"]))),128)),u.value?(ne(),Ye(ue(uR),{key:0,ref_key:"InputRef",ref:_,modelValue:f.value,"onUpdate:modelValue":S[0]||(S[0]=E=>f.value=E),class:"ml-1 w-20",size:"small",onKeyup:lo(p,["enter"]),onBlur:p},null,8,["modelValue"])):(ne(),Ye(g,{key:1,class:"button-new-tag ml-1",size:"small",onClick:h},{default:je(()=>S[1]||(S[1]=[xt(" + New Tag ")])),_:1,__:[1]}))],64)}}}),aF=Ke({__name:"text-template",props:["current","modelValue"],emits:["update:current","update:modelValue"],setup(s,{emit:n}){const i=s,o=n,l=_e({get:()=>i.current=="text-template",set:$=>o("update:current",$?"text-template":void 0)}),f=_e({get:()=>i.modelValue,set:$=>o("update:modelValue",$)}),m=me(null);function u($,S=0){if($.nodeType==Node.TEXT_NODE)return[$.textContent];if($.nodeType==Node.ELEMENT_NODE){const y=$;if(y.className.includes("sp-tag"))return["${"+y.innerText+"}"];if(y.tagName=="DIV"){if(S++>=5)return;let g=[];return y.childNodes.forEach(E=>{g.push(u(E,S))}),[`
`,g.join("")]}}return[]}function _(){const $=m.value.innerHTML.replaceAll(/<!(-)+([^>]*)(-)+>/g,""),S=document.createElement("div");S.innerHTML=$;let y=[];S.childNodes.forEach(g=>{y.push(...u(g))}),f.value.template=y.join(""),h()}Rs(()=>{const $=kt(m,S=>{S!=null&&($(),m.value.addEventListener("input",()=>{_()}))})}),kt(l,$=>{$&&rs(()=>{console.info(f),m.value.innerHTML=(f.value.template??"").replaceAll(/\$\{([^}]+)}/g,"<span class='sp-tag' contenteditable='false'>$1</span>").split(`
`).map(S=>S.trim()).filter(S=>S.length>0).map(S=>"<div>"+S+"</div>").join("")})});let c=null;function h(){m.value&&m.value.contains(window.getSelection().focusNode)&&(c=window.getSelection().getRangeAt(0))}function p($){const S=document.createElement("span");S.className="sp-tag",S.contentEditable="false",S.innerText=$,c.insertNode(S),_()}function T(){const $=f.value.variables;if(!m)return;m.value.querySelectorAll(".sp-tag").forEach(y=>{y.tagName=="SPAN"&&(console.info(y.innerHTML),$.includes(y.innerHTML)||y.remove())}),_()}return console.info(p),($,S)=>{const y=gt("el-scrollbar"),g=gt("el-col"),E=gt("el-row"),v=gt("el-dialog");return ne(),Ye(v,{modelValue:l.value,"onUpdate:modelValue":S[1]||(S[1]=b=>l.value=b),title:"编辑字符串模板"},{default:je(()=>[De(E,null,{default:je(()=>[De(g,{span:16},{default:je(()=>[De(y,{height:"200px",style:{border:"1px lightgray solid","border-radius":"5px"},class:"editor-context"},{default:je(()=>[de("div",{contenteditable:"true",style:{"min-height":"200px"},class:"editor-content",ref_key:"inputModel",ref:m,onClick:h},null,512)]),_:1})]),_:1}),De(g,{span:8},{default:je(()=>[De(oF,{modelValue:f.value.variables,"onUpdate:modelValue":S[0]||(S[0]=b=>f.value.variables=b),onTagClick:p,onTagRemoved:T},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])}}});class I${constructor(n){this.block=n,this.cached_consuming=new Map,this.providing=[],this.consuming=[],this.consume_reload_callbacks=new Map}using(n,i){return this.consume_reload_callbacks.set(n,i),setTimeout(()=>this.addConsume(n),0),()=>{this.consume_reload_callbacks.delete(n),this.removeConsume(n)}}removeFromParent(n){n.block_state.removeChildren(this.block)}removeChildren(n){let i=[];n.block_state.cached_consuming.forEach((o,l)=>{o.forEach(f=>{this.removeCachedConsumeInternal(l,f)&&i.push(l)})}),i.forEach(o=>{var l;(l=this.block.getParent())==null||l.block_state.removeCachedConsume(o,n.id)})}removeCachedConsume(n,i){var o;this.removeCachedConsumeInternal(n,i)&&((o=this.block.getParent())==null||o.block_state.removeCachedConsume(n,i))}removeCachedConsumeInternal(n,i){var l;if(this.providing.includes(n)&&((l=this.block.workspace.getBlockById(i))==null||l.block_state.notifyConsumeReload(n)),!this.cached_consuming.has(n))return false;const o=this.cached_consuming.get(n);return o.delete(i),o.size<=0?(this.cached_consuming.delete(n),true):false}addConsume(n){this.consuming.includes(n)||(this.consuming.push(n),this.addCachedConsume(n,this.block.id))}removeConsume(n){this.consuming.includes(n)&&(this.consuming.splice(this.consuming.indexOf(n),1),this.removeCachedConsume(n,this.block.id))}addCachedConsume(n,i){var o,l;this.providing.includes(n)&&((o=this.block.workspace.getBlockById(i))==null||o.block_state.notifyConsumeReload(n)),this.cached_consuming.has(n)||this.cached_consuming.set(n,new Set),this.cached_consuming.get(n).add(i),(l=this.block.getParent())==null||l.block_state.addCachedConsume(n,i)}notifyConsumeReload(n){this.consume_reload_callbacks.has(n)&&this.consume_reload_callbacks.get(n)()}recoverCachedConsume(){this.cached_consuming.forEach((n,i)=>{n.forEach(o=>{var l;(l=this.block.getParent())==null||l.block_state.addCachedConsume(i,o)})})}}function lF(s){s.addChangeListener(n=>{if(n.type=="finished_loading"){s.getAllBlocks(false).forEach(f=>{f.block_state||(f.block_state=new I$(f))});return}if(!(n.type==="move"||n.type==="create"))return;const i=n,o=i.getEventWorkspace_().getBlockById(i.blockId);if(!o||(o.block_state||(o.block_state=new I$(o)),i.type!="move"))return;let l=i;l.oldParentId&&o.block_state.removeFromParent(o.workspace.getBlockById(l.oldParentId)),l.newParentId&&o.block_state.recoverCachedConsume()})}function Mf(s,n){if(!n)return s.newBlock("type_any");switch(n.getTypeName()){case"string":return s.newBlock("type_string");case"number":return s.newBlock("type_number");case"boolean":return s.newBlock("type_boolean");case"array":const i=s.newBlock("type_array"),o=Mf(s,n.getPrototype());return o.initSvg(),i.getInput("type").connection.connect(o.outputConnection),i;case"union":const l=s.newBlock("type_union"),f=n.getPrototype();l.itemCount_=f.length,l.initSvg(),l.updateShape_();for(let m=0;m<f.length;m++){const u=Mf(s,f[m]);u.initSvg(),l.getInput("TYPE_"+m).connection.connect(u.outputConnection)}return l;default:return s.newBlock("type_any")}}const{dom:xu,Svg:Bu,Coordinate:cF}=A.utils;function pI(s){s.setMovable(false),s.setEditable(false),s.setDeletable(false),s.getChildren(false).forEach(pI)}function gI(s){s.render(),s.getChildren(false).forEach(gI)}class uF extends A.Icon{constructor(){super(...arguments),this.workspaceWidth=0,this.workspaceHeight=0}drawIcon_(n){xu.createSvgElement(Bu.RECT,{class:"blocklyIconShape",rx:"4",ry:"4",height:"16",width:"16"},n);const i=xu.createSvgElement(Bu.G,{transform:"scale(0.024,0.024)translate(45,60)"},n);xu.createSvgElement(Bu.PATH,{class:"blocklyIconSymbol",d:"M118.6 80c-11.5 0-21.4 7.9-24 19.1L57 260.3c20.5-6.2 48.3-12.3 78.7-12.3c32.3 0 61.8 6.9 82.8 13.5c10.6 3.3 19.3 6.7 25.4 9.2c3.1 1.3 5.5 2.4 7.3 3.2c.9 .4 1.6 .7 2.1 1l.6 .3 .2 .1 .1 0 0 0 0 0s0 0-6.3 12.7h0l6.3-12.7c5.8 2.9 10.4 7.3 13.5 12.7h40.6c3.1-5.3 7.7-9.8 13.5-12.7l6.3 12.7h0c-6.3-12.7-6.3-12.7-6.3-12.7l0 0 0 0 .1 0 .2-.1 .6-.3c.5-.2 1.2-.6 2.1-1c1.8-.8 4.2-1.9 7.3-3.2c6.1-2.6 14.8-5.9 25.4-9.2c21-6.6 50.4-13.5 82.8-13.5c30.4 0 58.2 6.1 78.7 12.3L481.4 99.1c-2.6-11.2-12.6-19.1-24-19.1c-3.1 0-6.2 .6-9.2 1.8L416.9 94.3c-12.3 4.9-26.3-1.1-31.2-13.4s1.1-26.3 13.4-31.2l31.3-12.5c8.6-3.4 17.7-5.2 27-5.2c33.8 0 63.1 23.3 70.8 56.2l43.9 188c1.7 7.3 2.9 14.7 3.5 22.1c.3 1.9 .5 3.8 .5 5.7v6.7V352v16c0 61.9-50.1 112-112 112H419.7c-59.4 0-108.5-46.4-111.8-105.8L306.6 352H269.4l-1.2 22.2C264.9 433.6 215.8 480 156.3 480H112C50.1 480 0 429.9 0 368V352 310.7 304c0-1.9 .2-3.8 .5-5.7c.6-7.4 1.8-14.8 3.5-22.1l43.9-188C55.5 55.3 84.8 32 118.6 32c9.2 0 18.4 1.8 27 5.2l31.3 12.5c12.3 4.9 18.3 18.9 13.4 31.2s-18.9 18.3-31.2 13.4L127.8 81.8c-2.9-1.2-6-1.8-9.2-1.8zM64 325.4V368c0 26.5 21.5 48 48 48h44.3c25.5 0 46.5-19.9 47.9-45.3l2.5-45.6c-2.3-.8-4.9-1.7-7.5-2.5c-17.2-5.4-39.9-10.5-63.6-10.5c-23.7 0-46.2 5.1-63.2 10.5c-3.1 1-5.9 1.9-8.5 2.9zM512 368V325.4c-2.6-.9-5.5-1.9-8.5-2.9c-17-5.4-39.5-10.5-63.2-10.5c-23.7 0-46.4 5.1-63.6 10.5c-2.7 .8-5.2 1.7-7.5 2.5l2.5 45.6c1.4 25.4 22.5 45.3 47.9 45.3H464c26.5 0 48-21.5 48-48z"},i)}createDisplay(){this.svgDialog=xu.createSvgElement(Bu.SVG,{x:A.Bubble.BORDER_WIDTH,y:A.Bubble.BORDER_WIDTH});const n=this.getBlock(),i=new A.Options({disable:true,media:n.workspace.options.pathToMedia,rtl:n.RTL,horizontalLayout:false,renderer:n.workspace.options.renderer,rendererOverrides:n.workspace.options.rendererOverrides});this.display_workspace_=new A.WorkspaceSvg(i);const o=this.display_workspace_.createDom("blocklyMutatorBackground");return this.svgDialog.appendChild(o),this.svgDialog}setVisible(n){if(console.info("BP0"),n!=this.isVisible())if(n){const i=this.getBlock();console.info(this.iconXY_),this.bubble_=new A.Bubble(i.workspace,this.createDisplay(),i.pathObject.svgPath,this.iconXY_,null,null);const o=this.display_workspace_;this.bubble_.setSvgId(i.id),this.bubble_.registerMoveEvent(this.onBubbleMove.bind(this)),o.options.languageTree,o.getFlyout(),this.resizeBubble(),this.applyColour();const l=this.display_workspace_.newBlock("type_root");if(l.initSvg(),l.moveTo(new cF(10,10)),this.display_workspace_.addTopBlock(l),this.getBlock().getOutputType){const f=Mf(this.display_workspace_,this.getBlock().getOutputType());f&&(f.initSvg(),l.getInput("type").connection.connect(f.outputConnection),f.render())}else{const f=this.display_workspace_.newBlock("type_any");f.initSvg(),l.getInput("type").connection.connect(f.outputConnection),f.render()}gI(l),pI(l),this.display_workspace_.scrollCenter(),this.resizeBubble()}else this.display_workspace_.getTopBlocks(false).forEach(i=>{this.display_workspace_.removeTopBlock(i)}),this.svgDialog=null,this.display_workspace_.dispose(),this.display_workspace_=null,this.bubble_.dispose(),this.bubble_=null,this.workspaceWidth=0,this.workspaceHeight=0}resizeBubble(){if(!this.display_workspace_)return;const n=2*A.Bubble.BORDER_WIDTH,i=this.display_workspace_.getCanvas(),o=i.getBBox();let l=o.width+o.x,f=o.height+n*3;const m=this.display_workspace_.getFlyout();if(m){const _=m.getWorkspace().getMetricsManager().getScrollMetrics();f=Math.max(f,_.height+20),l+=m.getWidth()}const u=this.getBlock().RTL;u&&(l=-o.x),l+=n*3,(Math.abs(this.workspaceWidth-l)>n||Math.abs(this.workspaceHeight-f)>n)&&(this.workspaceWidth=l,this.workspaceHeight=f,this.bubble_.setBubbleSize(l+n,f+n),this.svgDialog.setAttribute("width",`${l}`),this.svgDialog.setAttribute("height",`${f}`),this.display_workspace_.setCachedParentSvgSize(l,f)),u&&i.setAttribute("transform",`translate(${this.workspaceWidth}, 0)`),this.display_workspace_.resize()}onBubbleMove(){var n;(n=this.display_workspace_)==null||n.recordDragTargets()}}class hF{constructor(n){this.block=n}}function dF(s){s.typings=new k2,Object.keys(A.Blocks).forEach(n=>{const i=A.Blocks[n].init;n.startsWith("type_")||(A.Blocks[n].init=function(){if(i.call(this),this.type_manager=new hF(this),!this.outputConnection)return;const o=new uF(this),l=this.getIcons.bind(this);this.getIcons=()=>[...l(),o]})})}const C$=Symbol("injected");function Al(s,n){if(s[C$])return s;const i=s.init;s[C$]=true,s.init=function(...o){i.apply(this,o),n.input&&Object.entries(n.input).forEach(([l,f])=>{const m=this.getInput(l);m&&(m.input_type=f)}),n.output&&(this.getOutputType=n.output.bind(this))}}function _F(){Al(A.Blocks.text,{output:()=>new Tg}),Al(A.Blocks.send_session_message,{input:{content:new Df([new Tg,new O$("Segment")])}}),Al(A.Blocks.segment_at,{input:{user:new Df([new Tg])},output:()=>new O$("Segment")}),Al(A.Blocks.lists_create_with,{output:function(){return new gF(mF(this.inputList.map(s=>s.name).filter(s=>s).map(s=>{var n;return(n=this.getInput(s).connection)==null?void 0:n.targetBlock()}).filter(s=>s).map(s=>{var n;return((n=s.getOutputType)==null?void 0:n.call(s))??new fF})))}}),Al(A.Blocks.math_number,{output:()=>new pF})}class $h{constructor(...n){this.prototype=void 0,n.length&&(this.prototype=n[0])}getPrototype(){return this.prototype}}class fI extends $h{canWriteTo(n){var i;return this.equalsTo(n)||((i=n.canWriteBy)==null?void 0:i.call(n,this))}equalsTo(n){return n.getTypeName()==this.getTypeName()}}class Tg extends fI{getTypeName(){return"string"}}class pF extends fI{getTypeName(){return"number"}}class mI extends $h{}class gF extends mI{getTypeName(){return"array"}canWriteTo(n){var i;return this.equalsTo(n)||((i=n.canWriteBy)==null?void 0:i.call(n,this))}equalsTo(n){return n.getTypeName()==this.getTypeName()&&this.getPrototype().equalsTo(n.getPrototype())}}class Df extends mI{getTypeName(){return"union"}canWriteTo(n){for(const i of this.prototype)if(!i.canWriteTo(n))return false;return true}equalsTo(n){if(n.getTypeName()!=this.getTypeName())return false;const i=n.getPrototype();if(i.length!=this.prototype.length)return false;for(const o of this.prototype){let l=i.findIndex(f=>f.equalsTo(o));if(l==-1)return false;i.splice(l,1)}return true}canWriteBy(n){return this.prototype.some(i=>n.canWriteTo(i))}}class O$ extends $h{getTypeName(){return"class"}canWriteTo(n){var i;return this.equalsTo(n)||((i=n.canWriteBy)==null?void 0:i.call(n,this))}equalsTo(n){return n.getTypeName()==this.getTypeName()&&this.prototype==n.getPrototype()}}class fF extends $h{getTypeName(){return"any"}canWriteTo(n){return true}canWriteBy(n){return true}equalsTo(n){return n.getTypeName()==this.getTypeName()}}function mF(s){return!Array.isArray(s)||s.length<=1?s[0]:new Df(s)}class EF extends A.ConnectionChecker{constructor(n){super(),this.workspace=n}doTypeChecks(n,i){var u,_;if(!(n.type==1||i.type==1))return super.doTypeChecks(n,i);const o=n.type==1?n:i,f=(_=(u=(n.type==1?i:n).getSourceBlock()).getOutputType)==null?void 0:_.call(u),m=o.getParentInput().input_type;return!f||!m?super.doTypeChecks(n,i):super.doTypeChecks(n,i)&&f.canWriteTo(m)}}const vF={style:{height:"100%",flex:"auto","margin-bottom":"35px"}},bF={style:{width:"100%",padding:"5px",height:"25px","border-bottom":"1px solid var(--bg1)",display:"flex","flex-direction":"row-reverse"}},TF=Ke({__name:"blockly",props:{modelValue:Object,workspace:String},emits:["update:modelValue","update:workspace"],setup(s,{expose:n,emit:i}){const o=me(null);let l=s,f=me(null),m=me(null);hn(l,"modelValue"),A.setLocale(cB),nF(zU),eF(),_F(),Object.entries(jU).forEach(([c,h])=>{se.javascriptGenerator[c]=h});let u=null,_={autoSave:()=>{}};return A.VerticalFlyout.prototype.getFlyoutScale=()=>1,Rs(()=>{rs(()=>{u=A.inject(o.value,{toolbox:RB,media:"/static/blockly/",grid:{spacing:20,length:1,colour:"#888",snap:false},zoom:{controls:true,wheel:true,startScale:1,maxScale:3,minScale:.3,scaleSpeed:1.2},plugins:{connectionChecker:EF}}),window.addEventListener("resize",()=>{A.svgResize(u)}),u.registerToolboxCategoryCallback("VENDOR_UNCATEGORIZED",rF),u.addChangeListener(tF),u.addChangeListener(sF.bind(_)),lF(u),dF(u),A.fieldRegistry.register("binding",Sh),yB(u),u.topLevel={openDialog(c,h){return f.value=c,m.value=h,new Promise(p=>{const T=kt(f,()=>{T(),p(df(m.value))})})}}})}),n({save(){return A.svgResize(u),A.serialization.workspaces.save(u)},load(c){return A.svgResize(u),A.serialization.workspaces.load(c,u)},setAutoSaveListener(c){_.autoSave=c},updateSize(){A.svgResize(u)},getWorkspaceSvg(){return u}}),(c,h)=>(ne(),ve("div",vF,[De(aF,{modelValue:ue(m),"onUpdate:modelValue":h[0]||(h[0]=p=>Vl(m)?m.value=p:m=p),current:ue(f),"onUpdate:current":h[1]||(h[1]=p=>Vl(f)?f.value=p:f=p)},null,8,["modelValue","current"]),de("div",bF,[de("button",{class:"menu-button",onClick:h[2]||(h[2]=p=>c.$emit("update:workspace","meta"))},"编辑插件元数据")]),de("div",{style:{height:"100%",flex:"auto"},ref_key:"blockly_workspace",ref:o},null,512)]))}}),SF=rr(TF,[["__scopeId","data-v-58804736"]]);var Sg={exports:{}},w$;function $F(){return w$||(w$=1,function(s,n){(function(i,o){s.exports=o()})(self,()=>(()=>{var i={4567:function(m,u,_){var c=this&&this.__decorate||function(b,R,O,w){var L,I=arguments.length,k=I<3?R:w===null?w=Object.getOwnPropertyDescriptor(R,O):w;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")k=Reflect.decorate(b,R,O,w);else for(var x=b.length-1;x>=0;x--)(L=b[x])&&(k=(I<3?L(k):I>3?L(R,O,k):L(R,O))||k);return I>3&&k&&Object.defineProperty(R,O,k),k},h=this&&this.__param||function(b,R){return function(O,w){R(O,w,b)}};Object.defineProperty(u,"__esModule",{value:true}),u.AccessibilityManager=void 0;const p=_(9042),T=_(6114),$=_(9924),S=_(844),y=_(5596),g=_(4725),E=_(3656);let v=u.AccessibilityManager=class extends S.Disposable{constructor(b,R){super(),this._terminal=b,this._renderService=R,this._liveRegionLineCount=0,this._charsToConsume=[],this._charsToAnnounce="",this._accessibilityContainer=document.createElement("div"),this._accessibilityContainer.classList.add("xterm-accessibility"),this._rowContainer=document.createElement("div"),this._rowContainer.setAttribute("role","list"),this._rowContainer.classList.add("xterm-accessibility-tree"),this._rowElements=[];for(let O=0;O<this._terminal.rows;O++)this._rowElements[O]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[O]);if(this._topBoundaryFocusListener=O=>this._handleBoundaryFocus(O,0),this._bottomBoundaryFocusListener=O=>this._handleBoundaryFocus(O,1),this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions(),this._accessibilityContainer.appendChild(this._rowContainer),this._liveRegion=document.createElement("div"),this._liveRegion.classList.add("live-region"),this._liveRegion.setAttribute("aria-live","assertive"),this._accessibilityContainer.appendChild(this._liveRegion),this._liveRegionDebouncer=this.register(new $.TimeBasedDebouncer(this._renderRows.bind(this))),!this._terminal.element)throw new Error("Cannot enable accessibility before Terminal.open");this._terminal.element.insertAdjacentElement("afterbegin",this._accessibilityContainer),this.register(this._terminal.onResize(O=>this._handleResize(O.rows))),this.register(this._terminal.onRender(O=>this._refreshRows(O.start,O.end))),this.register(this._terminal.onScroll(()=>this._refreshRows())),this.register(this._terminal.onA11yChar(O=>this._handleChar(O))),this.register(this._terminal.onLineFeed(()=>this._handleChar(`
`))),this.register(this._terminal.onA11yTab(O=>this._handleTab(O))),this.register(this._terminal.onKey(O=>this._handleKey(O.key))),this.register(this._terminal.onBlur(()=>this._clearLiveRegion())),this.register(this._renderService.onDimensionsChange(()=>this._refreshRowsDimensions())),this._screenDprMonitor=new y.ScreenDprMonitor(window),this.register(this._screenDprMonitor),this._screenDprMonitor.setListener(()=>this._refreshRowsDimensions()),this.register((0,E.addDisposableDomListener)(window,"resize",()=>this._refreshRowsDimensions())),this._refreshRows(),this.register((0,S.toDisposable)(()=>{this._accessibilityContainer.remove(),this._rowElements.length=0}))}_handleTab(b){for(let R=0;R<b;R++)this._handleChar(" ")}_handleChar(b){this._liveRegionLineCount<21&&(this._charsToConsume.length>0?this._charsToConsume.shift()!==b&&(this._charsToAnnounce+=b):this._charsToAnnounce+=b,b===`
`&&(this._liveRegionLineCount++,this._liveRegionLineCount===21&&(this._liveRegion.textContent+=p.tooMuchOutput)),T.isMac&&this._liveRegion.textContent&&this._liveRegion.textContent.length>0&&!this._liveRegion.parentNode&&setTimeout(()=>{this._accessibilityContainer.appendChild(this._liveRegion)},0))}_clearLiveRegion(){this._liveRegion.textContent="",this._liveRegionLineCount=0,T.isMac&&this._liveRegion.remove()}_handleKey(b){this._clearLiveRegion(),new RegExp("\\p{Control}","u").test(b)||this._charsToConsume.push(b)}_refreshRows(b,R){this._liveRegionDebouncer.refresh(b,R,this._terminal.rows)}_renderRows(b,R){const O=this._terminal.buffer,w=O.lines.length.toString();for(let L=b;L<=R;L++){const I=O.translateBufferLineToString(O.ydisp+L,true),k=(O.ydisp+L+1).toString(),x=this._rowElements[L];x&&(I.length===0?x.innerText=" ":x.textContent=I,x.setAttribute("aria-posinset",k),x.setAttribute("aria-setsize",w))}this._announceCharacters()}_announceCharacters(){this._charsToAnnounce.length!==0&&(this._liveRegion.textContent+=this._charsToAnnounce,this._charsToAnnounce="")}_handleBoundaryFocus(b,R){const O=b.target,w=this._rowElements[R===0?1:this._rowElements.length-2];if(O.getAttribute("aria-posinset")===(R===0?"1":`${this._terminal.buffer.lines.length}`)||b.relatedTarget!==w)return;let L,I;if(R===0?(L=O,I=this._rowElements.pop(),this._rowContainer.removeChild(I)):(L=this._rowElements.shift(),I=O,this._rowContainer.removeChild(L)),L.removeEventListener("focus",this._topBoundaryFocusListener),I.removeEventListener("focus",this._bottomBoundaryFocusListener),R===0){const k=this._createAccessibilityTreeNode();this._rowElements.unshift(k),this._rowContainer.insertAdjacentElement("afterbegin",k)}else{const k=this._createAccessibilityTreeNode();this._rowElements.push(k),this._rowContainer.appendChild(k)}this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._terminal.scrollLines(R===0?-1:1),this._rowElements[R===0?1:this._rowElements.length-2].focus(),b.preventDefault(),b.stopImmediatePropagation()}_handleResize(b){this._rowElements[this._rowElements.length-1].removeEventListener("focus",this._bottomBoundaryFocusListener);for(let R=this._rowContainer.children.length;R<this._terminal.rows;R++)this._rowElements[R]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[R]);for(;this._rowElements.length>b;)this._rowContainer.removeChild(this._rowElements.pop());this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions()}_createAccessibilityTreeNode(){const b=document.createElement("div");return b.setAttribute("role","listitem"),b.tabIndex=-1,this._refreshRowDimensions(b),b}_refreshRowsDimensions(){if(this._renderService.dimensions.css.cell.height){this._accessibilityContainer.style.width=`${this._renderService.dimensions.css.canvas.width}px`,this._rowElements.length!==this._terminal.rows&&this._handleResize(this._terminal.rows);for(let b=0;b<this._terminal.rows;b++)this._refreshRowDimensions(this._rowElements[b])}}_refreshRowDimensions(b){b.style.height=`${this._renderService.dimensions.css.cell.height}px`}};u.AccessibilityManager=v=c([h(1,g.IRenderService)],v)},3614:(m,u)=>{function _(T){return T.replace(/\r?\n/g,"\r")}function c(T,$){return $?"\x1B[200~"+T+"\x1B[201~":T}function h(T,$,S,y){T=c(T=_(T),S.decPrivateModes.bracketedPasteMode&&y.rawOptions.ignoreBracketedPasteMode!==true),S.triggerDataEvent(T,true),$.value=""}function p(T,$,S){const y=S.getBoundingClientRect(),g=T.clientX-y.left-10,E=T.clientY-y.top-10;$.style.width="20px",$.style.height="20px",$.style.left=`${g}px`,$.style.top=`${E}px`,$.style.zIndex="1000",$.focus()}Object.defineProperty(u,"__esModule",{value:true}),u.rightClickHandler=u.moveTextAreaUnderMouseCursor=u.paste=u.handlePasteEvent=u.copyHandler=u.bracketTextForPaste=u.prepareTextForTerminal=void 0,u.prepareTextForTerminal=_,u.bracketTextForPaste=c,u.copyHandler=function(T,$){T.clipboardData&&T.clipboardData.setData("text/plain",$.selectionText),T.preventDefault()},u.handlePasteEvent=function(T,$,S,y){T.stopPropagation(),T.clipboardData&&h(T.clipboardData.getData("text/plain"),$,S,y)},u.paste=h,u.moveTextAreaUnderMouseCursor=p,u.rightClickHandler=function(T,$,S,y,g){p(T,$,S),g&&y.rightClickSelect(T),$.value=y.selectionText,$.select()}},7239:(m,u,_)=>{Object.defineProperty(u,"__esModule",{value:true}),u.ColorContrastCache=void 0;const c=_(1505);u.ColorContrastCache=class{constructor(){this._color=new c.TwoKeyMap,this._css=new c.TwoKeyMap}setCss(h,p,T){this._css.set(h,p,T)}getCss(h,p){return this._css.get(h,p)}setColor(h,p,T){this._color.set(h,p,T)}getColor(h,p){return this._color.get(h,p)}clear(){this._color.clear(),this._css.clear()}}},3656:(m,u)=>{Object.defineProperty(u,"__esModule",{value:true}),u.addDisposableDomListener=void 0,u.addDisposableDomListener=function(_,c,h,p){_.addEventListener(c,h,p);let T=false;return{dispose:()=>{T||(T=true,_.removeEventListener(c,h,p))}}}},6465:function(m,u,_){var c=this&&this.__decorate||function(g,E,v,b){var R,O=arguments.length,w=O<3?E:b===null?b=Object.getOwnPropertyDescriptor(E,v):b;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")w=Reflect.decorate(g,E,v,b);else for(var L=g.length-1;L>=0;L--)(R=g[L])&&(w=(O<3?R(w):O>3?R(E,v,w):R(E,v))||w);return O>3&&w&&Object.defineProperty(E,v,w),w},h=this&&this.__param||function(g,E){return function(v,b){E(v,b,g)}};Object.defineProperty(u,"__esModule",{value:true}),u.Linkifier2=void 0;const p=_(3656),T=_(8460),$=_(844),S=_(2585);let y=u.Linkifier2=class extends $.Disposable{get currentLink(){return this._currentLink}constructor(g){super(),this._bufferService=g,this._linkProviders=[],this._linkCacheDisposables=[],this._isMouseOut=true,this._wasResized=false,this._activeLine=-1,this._onShowLinkUnderline=this.register(new T.EventEmitter),this.onShowLinkUnderline=this._onShowLinkUnderline.event,this._onHideLinkUnderline=this.register(new T.EventEmitter),this.onHideLinkUnderline=this._onHideLinkUnderline.event,this.register((0,$.getDisposeArrayDisposable)(this._linkCacheDisposables)),this.register((0,$.toDisposable)(()=>{this._lastMouseEvent=void 0})),this.register(this._bufferService.onResize(()=>{this._clearCurrentLink(),this._wasResized=true}))}registerLinkProvider(g){return this._linkProviders.push(g),{dispose:()=>{const E=this._linkProviders.indexOf(g);E!==-1&&this._linkProviders.splice(E,1)}}}attachToDom(g,E,v){this._element=g,this._mouseService=E,this._renderService=v,this.register((0,p.addDisposableDomListener)(this._element,"mouseleave",()=>{this._isMouseOut=true,this._clearCurrentLink()})),this.register((0,p.addDisposableDomListener)(this._element,"mousemove",this._handleMouseMove.bind(this))),this.register((0,p.addDisposableDomListener)(this._element,"mousedown",this._handleMouseDown.bind(this))),this.register((0,p.addDisposableDomListener)(this._element,"mouseup",this._handleMouseUp.bind(this)))}_handleMouseMove(g){if(this._lastMouseEvent=g,!this._element||!this._mouseService)return;const E=this._positionFromMouseEvent(g,this._element,this._mouseService);if(!E)return;this._isMouseOut=false;const v=g.composedPath();for(let b=0;b<v.length;b++){const R=v[b];if(R.classList.contains("xterm"))break;if(R.classList.contains("xterm-hover"))return}this._lastBufferCell&&E.x===this._lastBufferCell.x&&E.y===this._lastBufferCell.y||(this._handleHover(E),this._lastBufferCell=E)}_handleHover(g){if(this._activeLine!==g.y||this._wasResized)return this._clearCurrentLink(),this._askForLink(g,false),void(this._wasResized=false);this._currentLink&&this._linkAtPosition(this._currentLink.link,g)||(this._clearCurrentLink(),this._askForLink(g,true))}_askForLink(g,E){var v,b;this._activeProviderReplies&&E||((v=this._activeProviderReplies)===null||v===void 0||v.forEach(O=>{O==null||O.forEach(w=>{w.link.dispose&&w.link.dispose()})}),this._activeProviderReplies=new Map,this._activeLine=g.y);let R=false;for(const[O,w]of this._linkProviders.entries())E?!((b=this._activeProviderReplies)===null||b===void 0)&&b.get(O)&&(R=this._checkLinkProviderResult(O,g,R)):w.provideLinks(g.y,L=>{var I,k;if(this._isMouseOut)return;const x=L==null?void 0:L.map(P=>({link:P}));(I=this._activeProviderReplies)===null||I===void 0||I.set(O,x),R=this._checkLinkProviderResult(O,g,R),((k=this._activeProviderReplies)===null||k===void 0?void 0:k.size)===this._linkProviders.length&&this._removeIntersectingLinks(g.y,this._activeProviderReplies)})}_removeIntersectingLinks(g,E){const v=new Set;for(let b=0;b<E.size;b++){const R=E.get(b);if(R)for(let O=0;O<R.length;O++){const w=R[O],L=w.link.range.start.y<g?0:w.link.range.start.x,I=w.link.range.end.y>g?this._bufferService.cols:w.link.range.end.x;for(let k=L;k<=I;k++){if(v.has(k)){R.splice(O--,1);break}v.add(k)}}}}_checkLinkProviderResult(g,E,v){var b;if(!this._activeProviderReplies)return v;const R=this._activeProviderReplies.get(g);let O=false;for(let w=0;w<g;w++)this._activeProviderReplies.has(w)&&!this._activeProviderReplies.get(w)||(O=true);if(!O&&R){const w=R.find(L=>this._linkAtPosition(L.link,E));w&&(v=true,this._handleNewLink(w))}if(this._activeProviderReplies.size===this._linkProviders.length&&!v)for(let w=0;w<this._activeProviderReplies.size;w++){const L=(b=this._activeProviderReplies.get(w))===null||b===void 0?void 0:b.find(I=>this._linkAtPosition(I.link,E));if(L){v=true,this._handleNewLink(L);break}}return v}_handleMouseDown(){this._mouseDownLink=this._currentLink}_handleMouseUp(g){if(!this._element||!this._mouseService||!this._currentLink)return;const E=this._positionFromMouseEvent(g,this._element,this._mouseService);E&&this._mouseDownLink===this._currentLink&&this._linkAtPosition(this._currentLink.link,E)&&this._currentLink.link.activate(g,this._currentLink.link.text)}_clearCurrentLink(g,E){this._element&&this._currentLink&&this._lastMouseEvent&&(!g||!E||this._currentLink.link.range.start.y>=g&&this._currentLink.link.range.end.y<=E)&&(this._linkLeave(this._element,this._currentLink.link,this._lastMouseEvent),this._currentLink=void 0,(0,$.disposeArray)(this._linkCacheDisposables))}_handleNewLink(g){if(!this._element||!this._lastMouseEvent||!this._mouseService)return;const E=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);E&&this._linkAtPosition(g.link,E)&&(this._currentLink=g,this._currentLink.state={decorations:{underline:g.link.decorations===void 0||g.link.decorations.underline,pointerCursor:g.link.decorations===void 0||g.link.decorations.pointerCursor},isHovered:true},this._linkHover(this._element,g.link,this._lastMouseEvent),g.link.decorations={},Object.defineProperties(g.link.decorations,{pointerCursor:{get:()=>{var v,b;return(b=(v=this._currentLink)===null||v===void 0?void 0:v.state)===null||b===void 0?void 0:b.decorations.pointerCursor},set:v=>{var b,R;!((b=this._currentLink)===null||b===void 0)&&b.state&&this._currentLink.state.decorations.pointerCursor!==v&&(this._currentLink.state.decorations.pointerCursor=v,this._currentLink.state.isHovered&&((R=this._element)===null||R===void 0||R.classList.toggle("xterm-cursor-pointer",v)))}},underline:{get:()=>{var v,b;return(b=(v=this._currentLink)===null||v===void 0?void 0:v.state)===null||b===void 0?void 0:b.decorations.underline},set:v=>{var b,R,O;!((b=this._currentLink)===null||b===void 0)&&b.state&&((O=(R=this._currentLink)===null||R===void 0?void 0:R.state)===null||O===void 0?void 0:O.decorations.underline)!==v&&(this._currentLink.state.decorations.underline=v,this._currentLink.state.isHovered&&this._fireUnderlineEvent(g.link,v))}}}),this._renderService&&this._linkCacheDisposables.push(this._renderService.onRenderedViewportChange(v=>{if(!this._currentLink)return;const b=v.start===0?0:v.start+1+this._bufferService.buffer.ydisp,R=this._bufferService.buffer.ydisp+1+v.end;if(this._currentLink.link.range.start.y>=b&&this._currentLink.link.range.end.y<=R&&(this._clearCurrentLink(b,R),this._lastMouseEvent&&this._element)){const O=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);O&&this._askForLink(O,false)}})))}_linkHover(g,E,v){var b;!((b=this._currentLink)===null||b===void 0)&&b.state&&(this._currentLink.state.isHovered=true,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(E,true),this._currentLink.state.decorations.pointerCursor&&g.classList.add("xterm-cursor-pointer")),E.hover&&E.hover(v,E.text)}_fireUnderlineEvent(g,E){const v=g.range,b=this._bufferService.buffer.ydisp,R=this._createLinkUnderlineEvent(v.start.x-1,v.start.y-b-1,v.end.x,v.end.y-b-1,void 0);(E?this._onShowLinkUnderline:this._onHideLinkUnderline).fire(R)}_linkLeave(g,E,v){var b;!((b=this._currentLink)===null||b===void 0)&&b.state&&(this._currentLink.state.isHovered=false,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(E,false),this._currentLink.state.decorations.pointerCursor&&g.classList.remove("xterm-cursor-pointer")),E.leave&&E.leave(v,E.text)}_linkAtPosition(g,E){const v=g.range.start.y*this._bufferService.cols+g.range.start.x,b=g.range.end.y*this._bufferService.cols+g.range.end.x,R=E.y*this._bufferService.cols+E.x;return v<=R&&R<=b}_positionFromMouseEvent(g,E,v){const b=v.getCoords(g,E,this._bufferService.cols,this._bufferService.rows);if(b)return{x:b[0],y:b[1]+this._bufferService.buffer.ydisp}}_createLinkUnderlineEvent(g,E,v,b,R){return{x1:g,y1:E,x2:v,y2:b,cols:this._bufferService.cols,fg:R}}};u.Linkifier2=y=c([h(0,S.IBufferService)],y)},9042:(m,u)=>{Object.defineProperty(u,"__esModule",{value:true}),u.tooMuchOutput=u.promptLabel=void 0,u.promptLabel="Terminal input",u.tooMuchOutput="Too much output to announce, navigate to rows manually to read"},3730:function(m,u,_){var c=this&&this.__decorate||function(y,g,E,v){var b,R=arguments.length,O=R<3?g:v===null?v=Object.getOwnPropertyDescriptor(g,E):v;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")O=Reflect.decorate(y,g,E,v);else for(var w=y.length-1;w>=0;w--)(b=y[w])&&(O=(R<3?b(O):R>3?b(g,E,O):b(g,E))||O);return R>3&&O&&Object.defineProperty(g,E,O),O},h=this&&this.__param||function(y,g){return function(E,v){g(E,v,y)}};Object.defineProperty(u,"__esModule",{value:true}),u.OscLinkProvider=void 0;const p=_(511),T=_(2585);let $=u.OscLinkProvider=class{constructor(y,g,E){this._bufferService=y,this._optionsService=g,this._oscLinkService=E}provideLinks(y,g){var E;const v=this._bufferService.buffer.lines.get(y-1);if(!v)return void g(void 0);const b=[],R=this._optionsService.rawOptions.linkHandler,O=new p.CellData,w=v.getTrimmedLength();let L=-1,I=-1,k=false;for(let x=0;x<w;x++)if(I!==-1||v.hasContent(x)){if(v.loadCell(x,O),O.hasExtendedAttrs()&&O.extended.urlId){if(I===-1){I=x,L=O.extended.urlId;continue}k=O.extended.urlId!==L}else I!==-1&&(k=true);if(k||I!==-1&&x===w-1){const P=(E=this._oscLinkService.getLinkData(L))===null||E===void 0?void 0:E.uri;if(P){const F={start:{x:I+1,y},end:{x:x+(k||x!==w-1?0:1),y}};let X=false;if(!(R!=null&&R.allowNonHttpProtocols))try{const W=new URL(P);["http:","https:"].includes(W.protocol)||(X=true)}catch{X=true}X||b.push({text:P,range:F,activate:(W,z)=>R?R.activate(W,z,F):S(0,z),hover:(W,z)=>{var j;return(j=R==null?void 0:R.hover)===null||j===void 0?void 0:j.call(R,W,z,F)},leave:(W,z)=>{var j;return(j=R==null?void 0:R.leave)===null||j===void 0?void 0:j.call(R,W,z,F)}})}k=false,O.hasExtendedAttrs()&&O.extended.urlId?(I=x,L=O.extended.urlId):(I=-1,L=-1)}}g(b)}};function S(y,g){if(confirm(`Do you want to navigate to ${g}?

WARNING: This link could potentially be dangerous`)){const E=window.open();if(E){try{E.opener=null}catch{}E.location.href=g}else console.warn("Opening link blocked as opener could not be cleared")}}u.OscLinkProvider=$=c([h(0,T.IBufferService),h(1,T.IOptionsService),h(2,T.IOscLinkService)],$)},6193:(m,u)=>{Object.defineProperty(u,"__esModule",{value:true}),u.RenderDebouncer=void 0,u.RenderDebouncer=class{constructor(_,c){this._parentWindow=_,this._renderCallback=c,this._refreshCallbacks=[]}dispose(){this._animationFrame&&(this._parentWindow.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)}addRefreshCallback(_){return this._refreshCallbacks.push(_),this._animationFrame||(this._animationFrame=this._parentWindow.requestAnimationFrame(()=>this._innerRefresh())),this._animationFrame}refresh(_,c,h){this._rowCount=h,_=_!==void 0?_:0,c=c!==void 0?c:this._rowCount-1,this._rowStart=this._rowStart!==void 0?Math.min(this._rowStart,_):_,this._rowEnd=this._rowEnd!==void 0?Math.max(this._rowEnd,c):c,this._animationFrame||(this._animationFrame=this._parentWindow.requestAnimationFrame(()=>this._innerRefresh()))}_innerRefresh(){if(this._animationFrame=void 0,this._rowStart===void 0||this._rowEnd===void 0||this._rowCount===void 0)return void this._runRefreshCallbacks();const _=Math.max(this._rowStart,0),c=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(_,c),this._runRefreshCallbacks()}_runRefreshCallbacks(){for(const _ of this._refreshCallbacks)_(0);this._refreshCallbacks=[]}}},5596:(m,u,_)=>{Object.defineProperty(u,"__esModule",{value:true}),u.ScreenDprMonitor=void 0;const c=_(844);class h extends c.Disposable{constructor(T){super(),this._parentWindow=T,this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this.register((0,c.toDisposable)(()=>{this.clearListener()}))}setListener(T){this._listener&&this.clearListener(),this._listener=T,this._outerListener=()=>{this._listener&&(this._listener(this._parentWindow.devicePixelRatio,this._currentDevicePixelRatio),this._updateDpr())},this._updateDpr()}_updateDpr(){var T;this._outerListener&&((T=this._resolutionMediaMatchList)===null||T===void 0||T.removeListener(this._outerListener),this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this._resolutionMediaMatchList=this._parentWindow.matchMedia(`screen and (resolution: ${this._parentWindow.devicePixelRatio}dppx)`),this._resolutionMediaMatchList.addListener(this._outerListener))}clearListener(){this._resolutionMediaMatchList&&this._listener&&this._outerListener&&(this._resolutionMediaMatchList.removeListener(this._outerListener),this._resolutionMediaMatchList=void 0,this._listener=void 0,this._outerListener=void 0)}}u.ScreenDprMonitor=h},3236:(m,u,_)=>{Object.defineProperty(u,"__esModule",{value:true}),u.Terminal=void 0;const c=_(3614),h=_(3656),p=_(6465),T=_(9042),$=_(3730),S=_(1680),y=_(3107),g=_(5744),E=_(2950),v=_(1296),b=_(428),R=_(4269),O=_(5114),w=_(8934),L=_(3230),I=_(9312),k=_(4725),x=_(6731),P=_(8055),F=_(8969),X=_(8460),W=_(844),z=_(6114),j=_(8437),J=_(2584),M=_(7399),U=_(5941),V=_(9074),K=_(2585),H=_(5435),ie=_(4567),Ie=typeof window<"u"?window.document:null;class he extends F.CoreTerminal{get onFocus(){return this._onFocus.event}get onBlur(){return this._onBlur.event}get onA11yChar(){return this._onA11yCharEmitter.event}get onA11yTab(){return this._onA11yTabEmitter.event}get onWillOpen(){return this._onWillOpen.event}constructor(B={}){super(B),this.browser=z,this._keyDownHandled=false,this._keyDownSeen=false,this._keyPressHandled=false,this._unprocessedDeadKey=false,this._accessibilityManager=this.register(new W.MutableDisposable),this._onCursorMove=this.register(new X.EventEmitter),this.onCursorMove=this._onCursorMove.event,this._onKey=this.register(new X.EventEmitter),this.onKey=this._onKey.event,this._onRender=this.register(new X.EventEmitter),this.onRender=this._onRender.event,this._onSelectionChange=this.register(new X.EventEmitter),this.onSelectionChange=this._onSelectionChange.event,this._onTitleChange=this.register(new X.EventEmitter),this.onTitleChange=this._onTitleChange.event,this._onBell=this.register(new X.EventEmitter),this.onBell=this._onBell.event,this._onFocus=this.register(new X.EventEmitter),this._onBlur=this.register(new X.EventEmitter),this._onA11yCharEmitter=this.register(new X.EventEmitter),this._onA11yTabEmitter=this.register(new X.EventEmitter),this._onWillOpen=this.register(new X.EventEmitter),this._setup(),this.linkifier2=this.register(this._instantiationService.createInstance(p.Linkifier2)),this.linkifier2.registerLinkProvider(this._instantiationService.createInstance($.OscLinkProvider)),this._decorationService=this._instantiationService.createInstance(V.DecorationService),this._instantiationService.setService(K.IDecorationService,this._decorationService),this.register(this._inputHandler.onRequestBell(()=>this._onBell.fire())),this.register(this._inputHandler.onRequestRefreshRows((te,le)=>this.refresh(te,le))),this.register(this._inputHandler.onRequestSendFocus(()=>this._reportFocus())),this.register(this._inputHandler.onRequestReset(()=>this.reset())),this.register(this._inputHandler.onRequestWindowsOptionsReport(te=>this._reportWindowsOptions(te))),this.register(this._inputHandler.onColor(te=>this._handleColorEvent(te))),this.register((0,X.forwardEvent)(this._inputHandler.onCursorMove,this._onCursorMove)),this.register((0,X.forwardEvent)(this._inputHandler.onTitleChange,this._onTitleChange)),this.register((0,X.forwardEvent)(this._inputHandler.onA11yChar,this._onA11yCharEmitter)),this.register((0,X.forwardEvent)(this._inputHandler.onA11yTab,this._onA11yTabEmitter)),this.register(this._bufferService.onResize(te=>this._afterResize(te.cols,te.rows))),this.register((0,W.toDisposable)(()=>{var te,le;this._customKeyEventHandler=void 0,(le=(te=this.element)===null||te===void 0?void 0:te.parentNode)===null||le===void 0||le.removeChild(this.element)}))}_handleColorEvent(B){if(this._themeService)for(const te of B){let le,ae="";switch(te.index){case 256:le="foreground",ae="10";break;case 257:le="background",ae="11";break;case 258:le="cursor",ae="12";break;default:le="ansi",ae="4;"+te.index}switch(te.type){case 0:const Me=P.color.toColorRGB(le==="ansi"?this._themeService.colors.ansi[te.index]:this._themeService.colors[le]);this.coreService.triggerDataEvent(`${J.C0.ESC}]${ae};${(0,U.toRgbString)(Me)}${J.C1_ESCAPED.ST}`);break;case 1:if(le==="ansi")this._themeService.modifyColors(Se=>Se.ansi[te.index]=P.rgba.toColor(...te.color));else{const Se=le;this._themeService.modifyColors(nt=>nt[Se]=P.rgba.toColor(...te.color))}break;case 2:this._themeService.restoreColor(te.index)}}}_setup(){super._setup(),this._customKeyEventHandler=void 0}get buffer(){return this.buffers.active}focus(){this.textarea&&this.textarea.focus({preventScroll:true})}_handleScreenReaderModeOptionChange(B){B?!this._accessibilityManager.value&&this._renderService&&(this._accessibilityManager.value=this._instantiationService.createInstance(ie.AccessibilityManager,this)):this._accessibilityManager.clear()}_handleTextAreaFocus(B){this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(J.C0.ESC+"[I"),this.updateCursorStyle(B),this.element.classList.add("focus"),this._showCursor(),this._onFocus.fire()}blur(){var B;return(B=this.textarea)===null||B===void 0?void 0:B.blur()}_handleTextAreaBlur(){this.textarea.value="",this.refresh(this.buffer.y,this.buffer.y),this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(J.C0.ESC+"[O"),this.element.classList.remove("focus"),this._onBlur.fire()}_syncTextArea(){if(!this.textarea||!this.buffer.isCursorInViewport||this._compositionHelper.isComposing||!this._renderService)return;const B=this.buffer.ybase+this.buffer.y,te=this.buffer.lines.get(B);if(!te)return;const le=Math.min(this.buffer.x,this.cols-1),ae=this._renderService.dimensions.css.cell.height,Me=te.getWidth(le),Se=this._renderService.dimensions.css.cell.width*Me,nt=this.buffer.y*this._renderService.dimensions.css.cell.height,St=le*this._renderService.dimensions.css.cell.width;this.textarea.style.left=St+"px",this.textarea.style.top=nt+"px",this.textarea.style.width=Se+"px",this.textarea.style.height=ae+"px",this.textarea.style.lineHeight=ae+"px",this.textarea.style.zIndex="-5"}_initGlobal(){this._bindKeys(),this.register((0,h.addDisposableDomListener)(this.element,"copy",te=>{this.hasSelection()&&(0,c.copyHandler)(te,this._selectionService)}));const B=te=>(0,c.handlePasteEvent)(te,this.textarea,this.coreService,this.optionsService);this.register((0,h.addDisposableDomListener)(this.textarea,"paste",B)),this.register((0,h.addDisposableDomListener)(this.element,"paste",B)),z.isFirefox?this.register((0,h.addDisposableDomListener)(this.element,"mousedown",te=>{te.button===2&&(0,c.rightClickHandler)(te,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)})):this.register((0,h.addDisposableDomListener)(this.element,"contextmenu",te=>{(0,c.rightClickHandler)(te,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)})),z.isLinux&&this.register((0,h.addDisposableDomListener)(this.element,"auxclick",te=>{te.button===1&&(0,c.moveTextAreaUnderMouseCursor)(te,this.textarea,this.screenElement)}))}_bindKeys(){this.register((0,h.addDisposableDomListener)(this.textarea,"keyup",B=>this._keyUp(B),true)),this.register((0,h.addDisposableDomListener)(this.textarea,"keydown",B=>this._keyDown(B),true)),this.register((0,h.addDisposableDomListener)(this.textarea,"keypress",B=>this._keyPress(B),true)),this.register((0,h.addDisposableDomListener)(this.textarea,"compositionstart",()=>this._compositionHelper.compositionstart())),this.register((0,h.addDisposableDomListener)(this.textarea,"compositionupdate",B=>this._compositionHelper.compositionupdate(B))),this.register((0,h.addDisposableDomListener)(this.textarea,"compositionend",()=>this._compositionHelper.compositionend())),this.register((0,h.addDisposableDomListener)(this.textarea,"input",B=>this._inputEvent(B),true)),this.register(this.onRender(()=>this._compositionHelper.updateCompositionElements()))}open(B){var te;if(!B)throw new Error("Terminal requires a parent element.");B.isConnected||this._logService.debug("Terminal.open was called on an element that was not attached to the DOM"),this._document=B.ownerDocument,this.element=this._document.createElement("div"),this.element.dir="ltr",this.element.classList.add("terminal"),this.element.classList.add("xterm"),B.appendChild(this.element);const le=Ie.createDocumentFragment();this._viewportElement=Ie.createElement("div"),this._viewportElement.classList.add("xterm-viewport"),le.appendChild(this._viewportElement),this._viewportScrollArea=Ie.createElement("div"),this._viewportScrollArea.classList.add("xterm-scroll-area"),this._viewportElement.appendChild(this._viewportScrollArea),this.screenElement=Ie.createElement("div"),this.screenElement.classList.add("xterm-screen"),this._helperContainer=Ie.createElement("div"),this._helperContainer.classList.add("xterm-helpers"),this.screenElement.appendChild(this._helperContainer),le.appendChild(this.screenElement),this.textarea=Ie.createElement("textarea"),this.textarea.classList.add("xterm-helper-textarea"),this.textarea.setAttribute("aria-label",T.promptLabel),z.isChromeOS||this.textarea.setAttribute("aria-multiline","false"),this.textarea.setAttribute("autocorrect","off"),this.textarea.setAttribute("autocapitalize","off"),this.textarea.setAttribute("spellcheck","false"),this.textarea.tabIndex=0,this._coreBrowserService=this._instantiationService.createInstance(O.CoreBrowserService,this.textarea,(te=this._document.defaultView)!==null&&te!==void 0?te:window),this._instantiationService.setService(k.ICoreBrowserService,this._coreBrowserService),this.register((0,h.addDisposableDomListener)(this.textarea,"focus",ae=>this._handleTextAreaFocus(ae))),this.register((0,h.addDisposableDomListener)(this.textarea,"blur",()=>this._handleTextAreaBlur())),this._helperContainer.appendChild(this.textarea),this._charSizeService=this._instantiationService.createInstance(b.CharSizeService,this._document,this._helperContainer),this._instantiationService.setService(k.ICharSizeService,this._charSizeService),this._themeService=this._instantiationService.createInstance(x.ThemeService),this._instantiationService.setService(k.IThemeService,this._themeService),this._characterJoinerService=this._instantiationService.createInstance(R.CharacterJoinerService),this._instantiationService.setService(k.ICharacterJoinerService,this._characterJoinerService),this._renderService=this.register(this._instantiationService.createInstance(L.RenderService,this.rows,this.screenElement)),this._instantiationService.setService(k.IRenderService,this._renderService),this.register(this._renderService.onRenderedViewportChange(ae=>this._onRender.fire(ae))),this.onResize(ae=>this._renderService.resize(ae.cols,ae.rows)),this._compositionView=Ie.createElement("div"),this._compositionView.classList.add("composition-view"),this._compositionHelper=this._instantiationService.createInstance(E.CompositionHelper,this.textarea,this._compositionView),this._helperContainer.appendChild(this._compositionView),this.element.appendChild(le);try{this._onWillOpen.fire(this.element)}catch{}this._renderService.hasRenderer()||this._renderService.setRenderer(this._createRenderer()),this._mouseService=this._instantiationService.createInstance(w.MouseService),this._instantiationService.setService(k.IMouseService,this._mouseService),this.viewport=this._instantiationService.createInstance(S.Viewport,this._viewportElement,this._viewportScrollArea),this.viewport.onRequestScrollLines(ae=>this.scrollLines(ae.amount,ae.suppressScrollEvent,1)),this.register(this._inputHandler.onRequestSyncScrollBar(()=>this.viewport.syncScrollArea())),this.register(this.viewport),this.register(this.onCursorMove(()=>{this._renderService.handleCursorMove(),this._syncTextArea()})),this.register(this.onResize(()=>this._renderService.handleResize(this.cols,this.rows))),this.register(this.onBlur(()=>this._renderService.handleBlur())),this.register(this.onFocus(()=>this._renderService.handleFocus())),this.register(this._renderService.onDimensionsChange(()=>this.viewport.syncScrollArea())),this._selectionService=this.register(this._instantiationService.createInstance(I.SelectionService,this.element,this.screenElement,this.linkifier2)),this._instantiationService.setService(k.ISelectionService,this._selectionService),this.register(this._selectionService.onRequestScrollLines(ae=>this.scrollLines(ae.amount,ae.suppressScrollEvent))),this.register(this._selectionService.onSelectionChange(()=>this._onSelectionChange.fire())),this.register(this._selectionService.onRequestRedraw(ae=>this._renderService.handleSelectionChanged(ae.start,ae.end,ae.columnSelectMode))),this.register(this._selectionService.onLinuxMouseSelection(ae=>{this.textarea.value=ae,this.textarea.focus(),this.textarea.select()})),this.register(this._onScroll.event(ae=>{this.viewport.syncScrollArea(),this._selectionService.refresh()})),this.register((0,h.addDisposableDomListener)(this._viewportElement,"scroll",()=>this._selectionService.refresh())),this.linkifier2.attachToDom(this.screenElement,this._mouseService,this._renderService),this.register(this._instantiationService.createInstance(y.BufferDecorationRenderer,this.screenElement)),this.register((0,h.addDisposableDomListener)(this.element,"mousedown",ae=>this._selectionService.handleMouseDown(ae))),this.coreMouseService.areMouseEventsActive?(this._selectionService.disable(),this.element.classList.add("enable-mouse-events")):this._selectionService.enable(),this.options.screenReaderMode&&(this._accessibilityManager.value=this._instantiationService.createInstance(ie.AccessibilityManager,this)),this.register(this.optionsService.onSpecificOptionChange("screenReaderMode",ae=>this._handleScreenReaderModeOptionChange(ae))),this.options.overviewRulerWidth&&(this._overviewRulerRenderer=this.register(this._instantiationService.createInstance(g.OverviewRulerRenderer,this._viewportElement,this.screenElement))),this.optionsService.onSpecificOptionChange("overviewRulerWidth",ae=>{!this._overviewRulerRenderer&&ae&&this._viewportElement&&this.screenElement&&(this._overviewRulerRenderer=this.register(this._instantiationService.createInstance(g.OverviewRulerRenderer,this._viewportElement,this.screenElement)))}),this._charSizeService.measure(),this.refresh(0,this.rows-1),this._initGlobal(),this.bindMouse()}_createRenderer(){return this._instantiationService.createInstance(v.DomRenderer,this.element,this.screenElement,this._viewportElement,this.linkifier2)}bindMouse(){const B=this,te=this.element;function le(Se){const nt=B._mouseService.getMouseReportCoords(Se,B.screenElement);if(!nt)return false;let St,Ut;switch(Se.overrideType||Se.type){case"mousemove":Ut=32,Se.buttons===void 0?(St=3,Se.button!==void 0&&(St=Se.button<3?Se.button:3)):St=1&Se.buttons?0:4&Se.buttons?1:2&Se.buttons?2:3;break;case"mouseup":Ut=0,St=Se.button<3?Se.button:3;break;case"mousedown":Ut=1,St=Se.button<3?Se.button:3;break;case"wheel":if(B.viewport.getLinesScrolled(Se)===0)return false;Ut=Se.deltaY<0?0:1,St=4;break;default:return false}return!(Ut===void 0||St===void 0||St>4)&&B.coreMouseService.triggerMouseEvent({col:nt.col,row:nt.row,x:nt.x,y:nt.y,button:St,action:Ut,ctrl:Se.ctrlKey,alt:Se.altKey,shift:Se.shiftKey})}const ae={mouseup:null,wheel:null,mousedrag:null,mousemove:null},Me={mouseup:Se=>(le(Se),Se.buttons||(this._document.removeEventListener("mouseup",ae.mouseup),ae.mousedrag&&this._document.removeEventListener("mousemove",ae.mousedrag)),this.cancel(Se)),wheel:Se=>(le(Se),this.cancel(Se,true)),mousedrag:Se=>{Se.buttons&&le(Se)},mousemove:Se=>{Se.buttons||le(Se)}};this.register(this.coreMouseService.onProtocolChange(Se=>{Se?(this.optionsService.rawOptions.logLevel==="debug"&&this._logService.debug("Binding to mouse events:",this.coreMouseService.explainEvents(Se)),this.element.classList.add("enable-mouse-events"),this._selectionService.disable()):(this._logService.debug("Unbinding from mouse events."),this.element.classList.remove("enable-mouse-events"),this._selectionService.enable()),8&Se?ae.mousemove||(te.addEventListener("mousemove",Me.mousemove),ae.mousemove=Me.mousemove):(te.removeEventListener("mousemove",ae.mousemove),ae.mousemove=null),16&Se?ae.wheel||(te.addEventListener("wheel",Me.wheel,{passive:false}),ae.wheel=Me.wheel):(te.removeEventListener("wheel",ae.wheel),ae.wheel=null),2&Se?ae.mouseup||(te.addEventListener("mouseup",Me.mouseup),ae.mouseup=Me.mouseup):(this._document.removeEventListener("mouseup",ae.mouseup),te.removeEventListener("mouseup",ae.mouseup),ae.mouseup=null),4&Se?ae.mousedrag||(ae.mousedrag=Me.mousedrag):(this._document.removeEventListener("mousemove",ae.mousedrag),ae.mousedrag=null)})),this.coreMouseService.activeProtocol=this.coreMouseService.activeProtocol,this.register((0,h.addDisposableDomListener)(te,"mousedown",Se=>{if(Se.preventDefault(),this.focus(),this.coreMouseService.areMouseEventsActive&&!this._selectionService.shouldForceSelection(Se))return le(Se),ae.mouseup&&this._document.addEventListener("mouseup",ae.mouseup),ae.mousedrag&&this._document.addEventListener("mousemove",ae.mousedrag),this.cancel(Se)})),this.register((0,h.addDisposableDomListener)(te,"wheel",Se=>{if(!ae.wheel){if(!this.buffer.hasScrollback){const nt=this.viewport.getLinesScrolled(Se);if(nt===0)return;const St=J.C0.ESC+(this.coreService.decPrivateModes.applicationCursorKeys?"O":"[")+(Se.deltaY<0?"A":"B");let Ut="";for(let Jt=0;Jt<Math.abs(nt);Jt++)Ut+=St;return this.coreService.triggerDataEvent(Ut,true),this.cancel(Se,true)}return this.viewport.handleWheel(Se)?this.cancel(Se):void 0}},{passive:false})),this.register((0,h.addDisposableDomListener)(te,"touchstart",Se=>{if(!this.coreMouseService.areMouseEventsActive)return this.viewport.handleTouchStart(Se),this.cancel(Se)},{passive:true})),this.register((0,h.addDisposableDomListener)(te,"touchmove",Se=>{if(!this.coreMouseService.areMouseEventsActive)return this.viewport.handleTouchMove(Se)?void 0:this.cancel(Se)},{passive:false}))}refresh(B,te){var le;(le=this._renderService)===null||le===void 0||le.refreshRows(B,te)}updateCursorStyle(B){var te;!((te=this._selectionService)===null||te===void 0)&&te.shouldColumnSelect(B)?this.element.classList.add("column-select"):this.element.classList.remove("column-select")}_showCursor(){this.coreService.isCursorInitialized||(this.coreService.isCursorInitialized=true,this.refresh(this.buffer.y,this.buffer.y))}scrollLines(B,te,le=0){var ae;le===1?(super.scrollLines(B,te,le),this.refresh(0,this.rows-1)):(ae=this.viewport)===null||ae===void 0||ae.scrollLines(B)}paste(B){(0,c.paste)(B,this.textarea,this.coreService,this.optionsService)}attachCustomKeyEventHandler(B){this._customKeyEventHandler=B}registerLinkProvider(B){return this.linkifier2.registerLinkProvider(B)}registerCharacterJoiner(B){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");const te=this._characterJoinerService.register(B);return this.refresh(0,this.rows-1),te}deregisterCharacterJoiner(B){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");this._characterJoinerService.deregister(B)&&this.refresh(0,this.rows-1)}get markers(){return this.buffer.markers}registerMarker(B){return this.buffer.addMarker(this.buffer.ybase+this.buffer.y+B)}registerDecoration(B){return this._decorationService.registerDecoration(B)}hasSelection(){return!!this._selectionService&&this._selectionService.hasSelection}select(B,te,le){this._selectionService.setSelection(B,te,le)}getSelection(){return this._selectionService?this._selectionService.selectionText:""}getSelectionPosition(){if(this._selectionService&&this._selectionService.hasSelection)return{start:{x:this._selectionService.selectionStart[0],y:this._selectionService.selectionStart[1]},end:{x:this._selectionService.selectionEnd[0],y:this._selectionService.selectionEnd[1]}}}clearSelection(){var B;(B=this._selectionService)===null||B===void 0||B.clearSelection()}selectAll(){var B;(B=this._selectionService)===null||B===void 0||B.selectAll()}selectLines(B,te){var le;(le=this._selectionService)===null||le===void 0||le.selectLines(B,te)}_keyDown(B){if(this._keyDownHandled=false,this._keyDownSeen=true,this._customKeyEventHandler&&this._customKeyEventHandler(B)===false)return false;const te=this.browser.isMac&&this.options.macOptionIsMeta&&B.altKey;if(!te&&!this._compositionHelper.keydown(B))return this.options.scrollOnUserInput&&this.buffer.ybase!==this.buffer.ydisp&&this.scrollToBottom(),false;te||B.key!=="Dead"&&B.key!=="AltGraph"||(this._unprocessedDeadKey=true);const le=(0,M.evaluateKeyboardEvent)(B,this.coreService.decPrivateModes.applicationCursorKeys,this.browser.isMac,this.options.macOptionIsMeta);if(this.updateCursorStyle(B),le.type===3||le.type===2){const ae=this.rows-1;return this.scrollLines(le.type===2?-ae:ae),this.cancel(B,true)}return le.type===1&&this.selectAll(),!!this._isThirdLevelShift(this.browser,B)||(le.cancel&&this.cancel(B,true),!le.key||!!(B.key&&!B.ctrlKey&&!B.altKey&&!B.metaKey&&B.key.length===1&&B.key.charCodeAt(0)>=65&&B.key.charCodeAt(0)<=90)||(this._unprocessedDeadKey?(this._unprocessedDeadKey=false,true):(le.key!==J.C0.ETX&&le.key!==J.C0.CR||(this.textarea.value=""),this._onKey.fire({key:le.key,domEvent:B}),this._showCursor(),this.coreService.triggerDataEvent(le.key,true),!this.optionsService.rawOptions.screenReaderMode||B.altKey||B.ctrlKey?this.cancel(B,true):void(this._keyDownHandled=true))))}_isThirdLevelShift(B,te){const le=B.isMac&&!this.options.macOptionIsMeta&&te.altKey&&!te.ctrlKey&&!te.metaKey||B.isWindows&&te.altKey&&te.ctrlKey&&!te.metaKey||B.isWindows&&te.getModifierState("AltGraph");return te.type==="keypress"?le:le&&(!te.keyCode||te.keyCode>47)}_keyUp(B){this._keyDownSeen=false,this._customKeyEventHandler&&this._customKeyEventHandler(B)===false||(function(te){return te.keyCode===16||te.keyCode===17||te.keyCode===18}(B)||this.focus(),this.updateCursorStyle(B),this._keyPressHandled=false)}_keyPress(B){let te;if(this._keyPressHandled=false,this._keyDownHandled||this._customKeyEventHandler&&this._customKeyEventHandler(B)===false)return false;if(this.cancel(B),B.charCode)te=B.charCode;else if(B.which===null||B.which===void 0)te=B.keyCode;else{if(B.which===0||B.charCode===0)return false;te=B.which}return!(!te||(B.altKey||B.ctrlKey||B.metaKey)&&!this._isThirdLevelShift(this.browser,B)||(te=String.fromCharCode(te),this._onKey.fire({key:te,domEvent:B}),this._showCursor(),this.coreService.triggerDataEvent(te,true),this._keyPressHandled=true,this._unprocessedDeadKey=false,0))}_inputEvent(B){if(B.data&&B.inputType==="insertText"&&(!B.composed||!this._keyDownSeen)&&!this.optionsService.rawOptions.screenReaderMode){if(this._keyPressHandled)return false;this._unprocessedDeadKey=false;const te=B.data;return this.coreService.triggerDataEvent(te,true),this.cancel(B),true}return false}resize(B,te){B!==this.cols||te!==this.rows?super.resize(B,te):this._charSizeService&&!this._charSizeService.hasValidSize&&this._charSizeService.measure()}_afterResize(B,te){var le,ae;(le=this._charSizeService)===null||le===void 0||le.measure(),(ae=this.viewport)===null||ae===void 0||ae.syncScrollArea(true)}clear(){var B;if(this.buffer.ybase!==0||this.buffer.y!==0){this.buffer.clearAllMarkers(),this.buffer.lines.set(0,this.buffer.lines.get(this.buffer.ybase+this.buffer.y)),this.buffer.lines.length=1,this.buffer.ydisp=0,this.buffer.ybase=0,this.buffer.y=0;for(let te=1;te<this.rows;te++)this.buffer.lines.push(this.buffer.getBlankLine(j.DEFAULT_ATTR_DATA));this._onScroll.fire({position:this.buffer.ydisp,source:0}),(B=this.viewport)===null||B===void 0||B.reset(),this.refresh(0,this.rows-1)}}reset(){var B,te;this.options.rows=this.rows,this.options.cols=this.cols;const le=this._customKeyEventHandler;this._setup(),super.reset(),(B=this._selectionService)===null||B===void 0||B.reset(),this._decorationService.reset(),(te=this.viewport)===null||te===void 0||te.reset(),this._customKeyEventHandler=le,this.refresh(0,this.rows-1)}clearTextureAtlas(){var B;(B=this._renderService)===null||B===void 0||B.clearTextureAtlas()}_reportFocus(){var B;!((B=this.element)===null||B===void 0)&&B.classList.contains("focus")?this.coreService.triggerDataEvent(J.C0.ESC+"[I"):this.coreService.triggerDataEvent(J.C0.ESC+"[O")}_reportWindowsOptions(B){if(this._renderService)switch(B){case H.WindowsOptionsReportType.GET_WIN_SIZE_PIXELS:const te=this._renderService.dimensions.css.canvas.width.toFixed(0),le=this._renderService.dimensions.css.canvas.height.toFixed(0);this.coreService.triggerDataEvent(`${J.C0.ESC}[4;${le};${te}t`);break;case H.WindowsOptionsReportType.GET_CELL_SIZE_PIXELS:const ae=this._renderService.dimensions.css.cell.width.toFixed(0),Me=this._renderService.dimensions.css.cell.height.toFixed(0);this.coreService.triggerDataEvent(`${J.C0.ESC}[6;${Me};${ae}t`)}}cancel(B,te){if(this.options.cancelEvents||te)return B.preventDefault(),B.stopPropagation(),false}}u.Terminal=he},9924:(m,u)=>{Object.defineProperty(u,"__esModule",{value:true}),u.TimeBasedDebouncer=void 0,u.TimeBasedDebouncer=class{constructor(_,c=1e3){this._renderCallback=_,this._debounceThresholdMS=c,this._lastRefreshMs=0,this._additionalRefreshRequested=false}dispose(){this._refreshTimeoutID&&clearTimeout(this._refreshTimeoutID)}refresh(_,c,h){this._rowCount=h,_=_!==void 0?_:0,c=c!==void 0?c:this._rowCount-1,this._rowStart=this._rowStart!==void 0?Math.min(this._rowStart,_):_,this._rowEnd=this._rowEnd!==void 0?Math.max(this._rowEnd,c):c;const p=Date.now();if(p-this._lastRefreshMs>=this._debounceThresholdMS)this._lastRefreshMs=p,this._innerRefresh();else if(!this._additionalRefreshRequested){const T=p-this._lastRefreshMs,$=this._debounceThresholdMS-T;this._additionalRefreshRequested=true,this._refreshTimeoutID=window.setTimeout(()=>{this._lastRefreshMs=Date.now(),this._innerRefresh(),this._additionalRefreshRequested=false,this._refreshTimeoutID=void 0},$)}}_innerRefresh(){if(this._rowStart===void 0||this._rowEnd===void 0||this._rowCount===void 0)return;const _=Math.max(this._rowStart,0),c=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(_,c)}}},1680:function(m,u,_){var c=this&&this.__decorate||function(E,v,b,R){var O,w=arguments.length,L=w<3?v:R===null?R=Object.getOwnPropertyDescriptor(v,b):R;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")L=Reflect.decorate(E,v,b,R);else for(var I=E.length-1;I>=0;I--)(O=E[I])&&(L=(w<3?O(L):w>3?O(v,b,L):O(v,b))||L);return w>3&&L&&Object.defineProperty(v,b,L),L},h=this&&this.__param||function(E,v){return function(b,R){v(b,R,E)}};Object.defineProperty(u,"__esModule",{value:true}),u.Viewport=void 0;const p=_(3656),T=_(4725),$=_(8460),S=_(844),y=_(2585);let g=u.Viewport=class extends S.Disposable{constructor(E,v,b,R,O,w,L,I){super(),this._viewportElement=E,this._scrollArea=v,this._bufferService=b,this._optionsService=R,this._charSizeService=O,this._renderService=w,this._coreBrowserService=L,this.scrollBarWidth=0,this._currentRowHeight=0,this._currentDeviceCellHeight=0,this._lastRecordedBufferLength=0,this._lastRecordedViewportHeight=0,this._lastRecordedBufferHeight=0,this._lastTouchY=0,this._lastScrollTop=0,this._wheelPartialScroll=0,this._refreshAnimationFrame=null,this._ignoreNextScrollEvent=false,this._smoothScrollState={startTime:0,origin:-1,target:-1},this._onRequestScrollLines=this.register(new $.EventEmitter),this.onRequestScrollLines=this._onRequestScrollLines.event,this.scrollBarWidth=this._viewportElement.offsetWidth-this._scrollArea.offsetWidth||15,this.register((0,p.addDisposableDomListener)(this._viewportElement,"scroll",this._handleScroll.bind(this))),this._activeBuffer=this._bufferService.buffer,this.register(this._bufferService.buffers.onBufferActivate(k=>this._activeBuffer=k.activeBuffer)),this._renderDimensions=this._renderService.dimensions,this.register(this._renderService.onDimensionsChange(k=>this._renderDimensions=k)),this._handleThemeChange(I.colors),this.register(I.onChangeColors(k=>this._handleThemeChange(k))),this.register(this._optionsService.onSpecificOptionChange("scrollback",()=>this.syncScrollArea())),setTimeout(()=>this.syncScrollArea())}_handleThemeChange(E){this._viewportElement.style.backgroundColor=E.background.css}reset(){this._currentRowHeight=0,this._currentDeviceCellHeight=0,this._lastRecordedBufferLength=0,this._lastRecordedViewportHeight=0,this._lastRecordedBufferHeight=0,this._lastTouchY=0,this._lastScrollTop=0,this._coreBrowserService.window.requestAnimationFrame(()=>this.syncScrollArea())}_refresh(E){if(E)return this._innerRefresh(),void(this._refreshAnimationFrame!==null&&this._coreBrowserService.window.cancelAnimationFrame(this._refreshAnimationFrame));this._refreshAnimationFrame===null&&(this._refreshAnimationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._innerRefresh()))}_innerRefresh(){if(this._charSizeService.height>0){this._currentRowHeight=this._renderService.dimensions.device.cell.height/this._coreBrowserService.dpr,this._currentDeviceCellHeight=this._renderService.dimensions.device.cell.height,this._lastRecordedViewportHeight=this._viewportElement.offsetHeight;const v=Math.round(this._currentRowHeight*this._lastRecordedBufferLength)+(this._lastRecordedViewportHeight-this._renderService.dimensions.css.canvas.height);this._lastRecordedBufferHeight!==v&&(this._lastRecordedBufferHeight=v,this._scrollArea.style.height=this._lastRecordedBufferHeight+"px")}const E=this._bufferService.buffer.ydisp*this._currentRowHeight;this._viewportElement.scrollTop!==E&&(this._ignoreNextScrollEvent=true,this._viewportElement.scrollTop=E),this._refreshAnimationFrame=null}syncScrollArea(E=false){if(this._lastRecordedBufferLength!==this._bufferService.buffer.lines.length)return this._lastRecordedBufferLength=this._bufferService.buffer.lines.length,void this._refresh(E);this._lastRecordedViewportHeight===this._renderService.dimensions.css.canvas.height&&this._lastScrollTop===this._activeBuffer.ydisp*this._currentRowHeight&&this._renderDimensions.device.cell.height===this._currentDeviceCellHeight||this._refresh(E)}_handleScroll(E){if(this._lastScrollTop=this._viewportElement.scrollTop,!this._viewportElement.offsetParent)return;if(this._ignoreNextScrollEvent)return this._ignoreNextScrollEvent=false,void this._onRequestScrollLines.fire({amount:0,suppressScrollEvent:true});const v=Math.round(this._lastScrollTop/this._currentRowHeight)-this._bufferService.buffer.ydisp;this._onRequestScrollLines.fire({amount:v,suppressScrollEvent:true})}_smoothScroll(){if(this._isDisposed||this._smoothScrollState.origin===-1||this._smoothScrollState.target===-1)return;const E=this._smoothScrollPercent();this._viewportElement.scrollTop=this._smoothScrollState.origin+Math.round(E*(this._smoothScrollState.target-this._smoothScrollState.origin)),E<1?this._coreBrowserService.window.requestAnimationFrame(()=>this._smoothScroll()):this._clearSmoothScrollState()}_smoothScrollPercent(){return this._optionsService.rawOptions.smoothScrollDuration&&this._smoothScrollState.startTime?Math.max(Math.min((Date.now()-this._smoothScrollState.startTime)/this._optionsService.rawOptions.smoothScrollDuration,1),0):1}_clearSmoothScrollState(){this._smoothScrollState.startTime=0,this._smoothScrollState.origin=-1,this._smoothScrollState.target=-1}_bubbleScroll(E,v){const b=this._viewportElement.scrollTop+this._lastRecordedViewportHeight;return!(v<0&&this._viewportElement.scrollTop!==0||v>0&&b<this._lastRecordedBufferHeight)||(E.cancelable&&E.preventDefault(),false)}handleWheel(E){const v=this._getPixelsScrolled(E);return v!==0&&(this._optionsService.rawOptions.smoothScrollDuration?(this._smoothScrollState.startTime=Date.now(),this._smoothScrollPercent()<1?(this._smoothScrollState.origin=this._viewportElement.scrollTop,this._smoothScrollState.target===-1?this._smoothScrollState.target=this._viewportElement.scrollTop+v:this._smoothScrollState.target+=v,this._smoothScrollState.target=Math.max(Math.min(this._smoothScrollState.target,this._viewportElement.scrollHeight),0),this._smoothScroll()):this._clearSmoothScrollState()):this._viewportElement.scrollTop+=v,this._bubbleScroll(E,v))}scrollLines(E){if(E!==0)if(this._optionsService.rawOptions.smoothScrollDuration){const v=E*this._currentRowHeight;this._smoothScrollState.startTime=Date.now(),this._smoothScrollPercent()<1?(this._smoothScrollState.origin=this._viewportElement.scrollTop,this._smoothScrollState.target=this._smoothScrollState.origin+v,this._smoothScrollState.target=Math.max(Math.min(this._smoothScrollState.target,this._viewportElement.scrollHeight),0),this._smoothScroll()):this._clearSmoothScrollState()}else this._onRequestScrollLines.fire({amount:E,suppressScrollEvent:false})}_getPixelsScrolled(E){if(E.deltaY===0||E.shiftKey)return 0;let v=this._applyScrollModifier(E.deltaY,E);return E.deltaMode===WheelEvent.DOM_DELTA_LINE?v*=this._currentRowHeight:E.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(v*=this._currentRowHeight*this._bufferService.rows),v}getBufferElements(E,v){var b;let R,O="";const w=[],L=v??this._bufferService.buffer.lines.length,I=this._bufferService.buffer.lines;for(let k=E;k<L;k++){const x=I.get(k);if(!x)continue;const P=(b=I.get(k+1))===null||b===void 0?void 0:b.isWrapped;if(O+=x.translateToString(!P),!P||k===I.length-1){const F=document.createElement("div");F.textContent=O,w.push(F),O.length>0&&(R=F),O=""}}return{bufferElements:w,cursorElement:R}}getLinesScrolled(E){if(E.deltaY===0||E.shiftKey)return 0;let v=this._applyScrollModifier(E.deltaY,E);return E.deltaMode===WheelEvent.DOM_DELTA_PIXEL?(v/=this._currentRowHeight+0,this._wheelPartialScroll+=v,v=Math.floor(Math.abs(this._wheelPartialScroll))*(this._wheelPartialScroll>0?1:-1),this._wheelPartialScroll%=1):E.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(v*=this._bufferService.rows),v}_applyScrollModifier(E,v){const b=this._optionsService.rawOptions.fastScrollModifier;return b==="alt"&&v.altKey||b==="ctrl"&&v.ctrlKey||b==="shift"&&v.shiftKey?E*this._optionsService.rawOptions.fastScrollSensitivity*this._optionsService.rawOptions.scrollSensitivity:E*this._optionsService.rawOptions.scrollSensitivity}handleTouchStart(E){this._lastTouchY=E.touches[0].pageY}handleTouchMove(E){const v=this._lastTouchY-E.touches[0].pageY;return this._lastTouchY=E.touches[0].pageY,v!==0&&(this._viewportElement.scrollTop+=v,this._bubbleScroll(E,v))}};u.Viewport=g=c([h(2,y.IBufferService),h(3,y.IOptionsService),h(4,T.ICharSizeService),h(5,T.IRenderService),h(6,T.ICoreBrowserService),h(7,T.IThemeService)],g)},3107:function(m,u,_){var c=this&&this.__decorate||function(g,E,v,b){var R,O=arguments.length,w=O<3?E:b===null?b=Object.getOwnPropertyDescriptor(E,v):b;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")w=Reflect.decorate(g,E,v,b);else for(var L=g.length-1;L>=0;L--)(R=g[L])&&(w=(O<3?R(w):O>3?R(E,v,w):R(E,v))||w);return O>3&&w&&Object.defineProperty(E,v,w),w},h=this&&this.__param||function(g,E){return function(v,b){E(v,b,g)}};Object.defineProperty(u,"__esModule",{value:true}),u.BufferDecorationRenderer=void 0;const p=_(3656),T=_(4725),$=_(844),S=_(2585);let y=u.BufferDecorationRenderer=class extends $.Disposable{constructor(g,E,v,b){super(),this._screenElement=g,this._bufferService=E,this._decorationService=v,this._renderService=b,this._decorationElements=new Map,this._altBufferIsActive=false,this._dimensionsChanged=false,this._container=document.createElement("div"),this._container.classList.add("xterm-decoration-container"),this._screenElement.appendChild(this._container),this.register(this._renderService.onRenderedViewportChange(()=>this._doRefreshDecorations())),this.register(this._renderService.onDimensionsChange(()=>{this._dimensionsChanged=true,this._queueRefresh()})),this.register((0,p.addDisposableDomListener)(window,"resize",()=>this._queueRefresh())),this.register(this._bufferService.buffers.onBufferActivate(()=>{this._altBufferIsActive=this._bufferService.buffer===this._bufferService.buffers.alt})),this.register(this._decorationService.onDecorationRegistered(()=>this._queueRefresh())),this.register(this._decorationService.onDecorationRemoved(R=>this._removeDecoration(R))),this.register((0,$.toDisposable)(()=>{this._container.remove(),this._decorationElements.clear()}))}_queueRefresh(){this._animationFrame===void 0&&(this._animationFrame=this._renderService.addRefreshCallback(()=>{this._doRefreshDecorations(),this._animationFrame=void 0}))}_doRefreshDecorations(){for(const g of this._decorationService.decorations)this._renderDecoration(g);this._dimensionsChanged=false}_renderDecoration(g){this._refreshStyle(g),this._dimensionsChanged&&this._refreshXPosition(g)}_createElement(g){var E,v;const b=document.createElement("div");b.classList.add("xterm-decoration"),b.classList.toggle("xterm-decoration-top-layer",((E=g==null?void 0:g.options)===null||E===void 0?void 0:E.layer)==="top"),b.style.width=`${Math.round((g.options.width||1)*this._renderService.dimensions.css.cell.width)}px`,b.style.height=(g.options.height||1)*this._renderService.dimensions.css.cell.height+"px",b.style.top=(g.marker.line-this._bufferService.buffers.active.ydisp)*this._renderService.dimensions.css.cell.height+"px",b.style.lineHeight=`${this._renderService.dimensions.css.cell.height}px`;const R=(v=g.options.x)!==null&&v!==void 0?v:0;return R&&R>this._bufferService.cols&&(b.style.display="none"),this._refreshXPosition(g,b),b}_refreshStyle(g){const E=g.marker.line-this._bufferService.buffers.active.ydisp;if(E<0||E>=this._bufferService.rows)g.element&&(g.element.style.display="none",g.onRenderEmitter.fire(g.element));else{let v=this._decorationElements.get(g);v||(v=this._createElement(g),g.element=v,this._decorationElements.set(g,v),this._container.appendChild(v),g.onDispose(()=>{this._decorationElements.delete(g),v.remove()})),v.style.top=E*this._renderService.dimensions.css.cell.height+"px",v.style.display=this._altBufferIsActive?"none":"block",g.onRenderEmitter.fire(v)}}_refreshXPosition(g,E=g.element){var v;if(!E)return;const b=(v=g.options.x)!==null&&v!==void 0?v:0;(g.options.anchor||"left")==="right"?E.style.right=b?b*this._renderService.dimensions.css.cell.width+"px":"":E.style.left=b?b*this._renderService.dimensions.css.cell.width+"px":""}_removeDecoration(g){var E;(E=this._decorationElements.get(g))===null||E===void 0||E.remove(),this._decorationElements.delete(g),g.dispose()}};u.BufferDecorationRenderer=y=c([h(1,S.IBufferService),h(2,S.IDecorationService),h(3,T.IRenderService)],y)},5871:(m,u)=>{Object.defineProperty(u,"__esModule",{value:true}),u.ColorZoneStore=void 0,u.ColorZoneStore=class{constructor(){this._zones=[],this._zonePool=[],this._zonePoolIndex=0,this._linePadding={full:0,left:0,center:0,right:0}}get zones(){return this._zonePool.length=Math.min(this._zonePool.length,this._zones.length),this._zones}clear(){this._zones.length=0,this._zonePoolIndex=0}addDecoration(_){if(_.options.overviewRulerOptions){for(const c of this._zones)if(c.color===_.options.overviewRulerOptions.color&&c.position===_.options.overviewRulerOptions.position){if(this._lineIntersectsZone(c,_.marker.line))return;if(this._lineAdjacentToZone(c,_.marker.line,_.options.overviewRulerOptions.position))return void this._addLineToZone(c,_.marker.line)}if(this._zonePoolIndex<this._zonePool.length)return this._zonePool[this._zonePoolIndex].color=_.options.overviewRulerOptions.color,this._zonePool[this._zonePoolIndex].position=_.options.overviewRulerOptions.position,this._zonePool[this._zonePoolIndex].startBufferLine=_.marker.line,this._zonePool[this._zonePoolIndex].endBufferLine=_.marker.line,void this._zones.push(this._zonePool[this._zonePoolIndex++]);this._zones.push({color:_.options.overviewRulerOptions.color,position:_.options.overviewRulerOptions.position,startBufferLine:_.marker.line,endBufferLine:_.marker.line}),this._zonePool.push(this._zones[this._zones.length-1]),this._zonePoolIndex++}}setPadding(_){this._linePadding=_}_lineIntersectsZone(_,c){return c>=_.startBufferLine&&c<=_.endBufferLine}_lineAdjacentToZone(_,c,h){return c>=_.startBufferLine-this._linePadding[h||"full"]&&c<=_.endBufferLine+this._linePadding[h||"full"]}_addLineToZone(_,c){_.startBufferLine=Math.min(_.startBufferLine,c),_.endBufferLine=Math.max(_.endBufferLine,c)}}},5744:function(m,u,_){var c=this&&this.__decorate||function(R,O,w,L){var I,k=arguments.length,x=k<3?O:L===null?L=Object.getOwnPropertyDescriptor(O,w):L;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")x=Reflect.decorate(R,O,w,L);else for(var P=R.length-1;P>=0;P--)(I=R[P])&&(x=(k<3?I(x):k>3?I(O,w,x):I(O,w))||x);return k>3&&x&&Object.defineProperty(O,w,x),x},h=this&&this.__param||function(R,O){return function(w,L){O(w,L,R)}};Object.defineProperty(u,"__esModule",{value:true}),u.OverviewRulerRenderer=void 0;const p=_(5871),T=_(3656),$=_(4725),S=_(844),y=_(2585),g={full:0,left:0,center:0,right:0},E={full:0,left:0,center:0,right:0},v={full:0,left:0,center:0,right:0};let b=u.OverviewRulerRenderer=class extends S.Disposable{get _width(){return this._optionsService.options.overviewRulerWidth||0}constructor(R,O,w,L,I,k,x){var P;super(),this._viewportElement=R,this._screenElement=O,this._bufferService=w,this._decorationService=L,this._renderService=I,this._optionsService=k,this._coreBrowseService=x,this._colorZoneStore=new p.ColorZoneStore,this._shouldUpdateDimensions=true,this._shouldUpdateAnchor=true,this._lastKnownBufferLength=0,this._canvas=document.createElement("canvas"),this._canvas.classList.add("xterm-decoration-overview-ruler"),this._refreshCanvasDimensions(),(P=this._viewportElement.parentElement)===null||P===void 0||P.insertBefore(this._canvas,this._viewportElement);const F=this._canvas.getContext("2d");if(!F)throw new Error("Ctx cannot be null");this._ctx=F,this._registerDecorationListeners(),this._registerBufferChangeListeners(),this._registerDimensionChangeListeners(),this.register((0,S.toDisposable)(()=>{var X;(X=this._canvas)===null||X===void 0||X.remove()}))}_registerDecorationListeners(){this.register(this._decorationService.onDecorationRegistered(()=>this._queueRefresh(void 0,true))),this.register(this._decorationService.onDecorationRemoved(()=>this._queueRefresh(void 0,true)))}_registerBufferChangeListeners(){this.register(this._renderService.onRenderedViewportChange(()=>this._queueRefresh())),this.register(this._bufferService.buffers.onBufferActivate(()=>{this._canvas.style.display=this._bufferService.buffer===this._bufferService.buffers.alt?"none":"block"})),this.register(this._bufferService.onScroll(()=>{this._lastKnownBufferLength!==this._bufferService.buffers.normal.lines.length&&(this._refreshDrawHeightConstants(),this._refreshColorZonePadding())}))}_registerDimensionChangeListeners(){this.register(this._renderService.onRender(()=>{this._containerHeight&&this._containerHeight===this._screenElement.clientHeight||(this._queueRefresh(true),this._containerHeight=this._screenElement.clientHeight)})),this.register(this._optionsService.onSpecificOptionChange("overviewRulerWidth",()=>this._queueRefresh(true))),this.register((0,T.addDisposableDomListener)(this._coreBrowseService.window,"resize",()=>this._queueRefresh(true))),this._queueRefresh(true)}_refreshDrawConstants(){const R=Math.floor(this._canvas.width/3),O=Math.ceil(this._canvas.width/3);E.full=this._canvas.width,E.left=R,E.center=O,E.right=R,this._refreshDrawHeightConstants(),v.full=0,v.left=0,v.center=E.left,v.right=E.left+E.center}_refreshDrawHeightConstants(){g.full=Math.round(2*this._coreBrowseService.dpr);const R=this._canvas.height/this._bufferService.buffer.lines.length,O=Math.round(Math.max(Math.min(R,12),6)*this._coreBrowseService.dpr);g.left=O,g.center=O,g.right=O}_refreshColorZonePadding(){this._colorZoneStore.setPadding({full:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*g.full),left:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*g.left),center:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*g.center),right:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*g.right)}),this._lastKnownBufferLength=this._bufferService.buffers.normal.lines.length}_refreshCanvasDimensions(){this._canvas.style.width=`${this._width}px`,this._canvas.width=Math.round(this._width*this._coreBrowseService.dpr),this._canvas.style.height=`${this._screenElement.clientHeight}px`,this._canvas.height=Math.round(this._screenElement.clientHeight*this._coreBrowseService.dpr),this._refreshDrawConstants(),this._refreshColorZonePadding()}_refreshDecorations(){this._shouldUpdateDimensions&&this._refreshCanvasDimensions(),this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height),this._colorZoneStore.clear();for(const O of this._decorationService.decorations)this._colorZoneStore.addDecoration(O);this._ctx.lineWidth=1;const R=this._colorZoneStore.zones;for(const O of R)O.position!=="full"&&this._renderColorZone(O);for(const O of R)O.position==="full"&&this._renderColorZone(O);this._shouldUpdateDimensions=false,this._shouldUpdateAnchor=false}_renderColorZone(R){this._ctx.fillStyle=R.color,this._ctx.fillRect(v[R.position||"full"],Math.round((this._canvas.height-1)*(R.startBufferLine/this._bufferService.buffers.active.lines.length)-g[R.position||"full"]/2),E[R.position||"full"],Math.round((this._canvas.height-1)*((R.endBufferLine-R.startBufferLine)/this._bufferService.buffers.active.lines.length)+g[R.position||"full"]))}_queueRefresh(R,O){this._shouldUpdateDimensions=R||this._shouldUpdateDimensions,this._shouldUpdateAnchor=O||this._shouldUpdateAnchor,this._animationFrame===void 0&&(this._animationFrame=this._coreBrowseService.window.requestAnimationFrame(()=>{this._refreshDecorations(),this._animationFrame=void 0}))}};u.OverviewRulerRenderer=b=c([h(2,y.IBufferService),h(3,y.IDecorationService),h(4,$.IRenderService),h(5,y.IOptionsService),h(6,$.ICoreBrowserService)],b)},2950:function(m,u,_){var c=this&&this.__decorate||function(y,g,E,v){var b,R=arguments.length,O=R<3?g:v===null?v=Object.getOwnPropertyDescriptor(g,E):v;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")O=Reflect.decorate(y,g,E,v);else for(var w=y.length-1;w>=0;w--)(b=y[w])&&(O=(R<3?b(O):R>3?b(g,E,O):b(g,E))||O);return R>3&&O&&Object.defineProperty(g,E,O),O},h=this&&this.__param||function(y,g){return function(E,v){g(E,v,y)}};Object.defineProperty(u,"__esModule",{value:true}),u.CompositionHelper=void 0;const p=_(4725),T=_(2585),$=_(2584);let S=u.CompositionHelper=class{get isComposing(){return this._isComposing}constructor(y,g,E,v,b,R){this._textarea=y,this._compositionView=g,this._bufferService=E,this._optionsService=v,this._coreService=b,this._renderService=R,this._isComposing=false,this._isSendingComposition=false,this._compositionPosition={start:0,end:0},this._dataAlreadySent=""}compositionstart(){this._isComposing=true,this._compositionPosition.start=this._textarea.value.length,this._compositionView.textContent="",this._dataAlreadySent="",this._compositionView.classList.add("active")}compositionupdate(y){this._compositionView.textContent=y.data,this.updateCompositionElements(),setTimeout(()=>{this._compositionPosition.end=this._textarea.value.length},0)}compositionend(){this._finalizeComposition(true)}keydown(y){if(this._isComposing||this._isSendingComposition){if(y.keyCode===229||y.keyCode===16||y.keyCode===17||y.keyCode===18)return false;this._finalizeComposition(false)}return y.keyCode!==229||(this._handleAnyTextareaChanges(),false)}_finalizeComposition(y){if(this._compositionView.classList.remove("active"),this._isComposing=false,y){const g={start:this._compositionPosition.start,end:this._compositionPosition.end};this._isSendingComposition=true,setTimeout(()=>{if(this._isSendingComposition){let E;this._isSendingComposition=false,g.start+=this._dataAlreadySent.length,E=this._isComposing?this._textarea.value.substring(g.start,g.end):this._textarea.value.substring(g.start),E.length>0&&this._coreService.triggerDataEvent(E,true)}},0)}else{this._isSendingComposition=false;const g=this._textarea.value.substring(this._compositionPosition.start,this._compositionPosition.end);this._coreService.triggerDataEvent(g,true)}}_handleAnyTextareaChanges(){const y=this._textarea.value;setTimeout(()=>{if(!this._isComposing){const g=this._textarea.value,E=g.replace(y,"");this._dataAlreadySent=E,g.length>y.length?this._coreService.triggerDataEvent(E,true):g.length<y.length?this._coreService.triggerDataEvent(`${$.C0.DEL}`,true):g.length===y.length&&g!==y&&this._coreService.triggerDataEvent(g,true)}},0)}updateCompositionElements(y){if(this._isComposing){if(this._bufferService.buffer.isCursorInViewport){const g=Math.min(this._bufferService.buffer.x,this._bufferService.cols-1),E=this._renderService.dimensions.css.cell.height,v=this._bufferService.buffer.y*this._renderService.dimensions.css.cell.height,b=g*this._renderService.dimensions.css.cell.width;this._compositionView.style.left=b+"px",this._compositionView.style.top=v+"px",this._compositionView.style.height=E+"px",this._compositionView.style.lineHeight=E+"px",this._compositionView.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._compositionView.style.fontSize=this._optionsService.rawOptions.fontSize+"px";const R=this._compositionView.getBoundingClientRect();this._textarea.style.left=b+"px",this._textarea.style.top=v+"px",this._textarea.style.width=Math.max(R.width,1)+"px",this._textarea.style.height=Math.max(R.height,1)+"px",this._textarea.style.lineHeight=R.height+"px"}y||setTimeout(()=>this.updateCompositionElements(true),0)}}};u.CompositionHelper=S=c([h(2,T.IBufferService),h(3,T.IOptionsService),h(4,T.ICoreService),h(5,p.IRenderService)],S)},9806:(m,u)=>{function _(c,h,p){const T=p.getBoundingClientRect(),$=c.getComputedStyle(p),S=parseInt($.getPropertyValue("padding-left")),y=parseInt($.getPropertyValue("padding-top"));return[h.clientX-T.left-S,h.clientY-T.top-y]}Object.defineProperty(u,"__esModule",{value:true}),u.getCoords=u.getCoordsRelativeToElement=void 0,u.getCoordsRelativeToElement=_,u.getCoords=function(c,h,p,T,$,S,y,g,E){if(!S)return;const v=_(c,h,p);return v?(v[0]=Math.ceil((v[0]+(E?y/2:0))/y),v[1]=Math.ceil(v[1]/g),v[0]=Math.min(Math.max(v[0],1),T+(E?1:0)),v[1]=Math.min(Math.max(v[1],1),$),v):void 0}},9504:(m,u,_)=>{Object.defineProperty(u,"__esModule",{value:true}),u.moveToCellSequence=void 0;const c=_(2584);function h(g,E,v,b){const R=g-p(g,v),O=E-p(E,v),w=Math.abs(R-O)-function(L,I,k){let x=0;const P=L-p(L,k),F=I-p(I,k);for(let X=0;X<Math.abs(P-F);X++){const W=T(L,I)==="A"?-1:1,z=k.buffer.lines.get(P+W*X);z!=null&&z.isWrapped&&x++}return x}(g,E,v);return y(w,S(T(g,E),b))}function p(g,E){let v=0,b=E.buffer.lines.get(g),R=b==null?void 0:b.isWrapped;for(;R&&g>=0&&g<E.rows;)v++,b=E.buffer.lines.get(--g),R=b==null?void 0:b.isWrapped;return v}function T(g,E){return g>E?"A":"B"}function $(g,E,v,b,R,O){let w=g,L=E,I="";for(;w!==v||L!==b;)w+=R?1:-1,R&&w>O.cols-1?(I+=O.buffer.translateBufferLineToString(L,false,g,w),w=0,g=0,L++):!R&&w<0&&(I+=O.buffer.translateBufferLineToString(L,false,0,g+1),w=O.cols-1,g=w,L--);return I+O.buffer.translateBufferLineToString(L,false,g,w)}function S(g,E){const v=E?"O":"[";return c.C0.ESC+v+g}function y(g,E){g=Math.floor(g);let v="";for(let b=0;b<g;b++)v+=E;return v}u.moveToCellSequence=function(g,E,v,b){const R=v.buffer.x,O=v.buffer.y;if(!v.buffer.hasScrollback)return function(I,k,x,P,F,X){return h(k,P,F,X).length===0?"":y($(I,k,I,k-p(k,F),false,F).length,S("D",X))}(R,O,0,E,v,b)+h(O,E,v,b)+function(I,k,x,P,F,X){let W;W=h(k,P,F,X).length>0?P-p(P,F):k;const z=P,j=function(J,M,U,V,K,H){let ie;return ie=h(U,V,K,H).length>0?V-p(V,K):M,J<U&&ie<=V||J>=U&&ie<V?"C":"D"}(I,k,x,P,F,X);return y($(I,W,x,z,j==="C",F).length,S(j,X))}(R,O,g,E,v,b);let w;if(O===E)return w=R>g?"D":"C",y(Math.abs(R-g),S(w,b));w=O>E?"D":"C";const L=Math.abs(O-E);return y(function(I,k){return k.cols-I}(O>E?g:R,v)+(L-1)*v.cols+1+((O>E?R:g)-1),S(w,b))}},1296:function(m,u,_){var c=this&&this.__decorate||function(F,X,W,z){var j,J=arguments.length,M=J<3?X:z===null?z=Object.getOwnPropertyDescriptor(X,W):z;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")M=Reflect.decorate(F,X,W,z);else for(var U=F.length-1;U>=0;U--)(j=F[U])&&(M=(J<3?j(M):J>3?j(X,W,M):j(X,W))||M);return J>3&&M&&Object.defineProperty(X,W,M),M},h=this&&this.__param||function(F,X){return function(W,z){X(W,z,F)}};Object.defineProperty(u,"__esModule",{value:true}),u.DomRenderer=void 0;const p=_(3787),T=_(2550),$=_(2223),S=_(6171),y=_(4725),g=_(8055),E=_(8460),v=_(844),b=_(2585),R="xterm-dom-renderer-owner-",O="xterm-rows",w="xterm-fg-",L="xterm-bg-",I="xterm-focus",k="xterm-selection";let x=1,P=u.DomRenderer=class extends v.Disposable{constructor(F,X,W,z,j,J,M,U,V,K){super(),this._element=F,this._screenElement=X,this._viewportElement=W,this._linkifier2=z,this._charSizeService=J,this._optionsService=M,this._bufferService=U,this._coreBrowserService=V,this._themeService=K,this._terminalClass=x++,this._rowElements=[],this.onRequestRedraw=this.register(new E.EventEmitter).event,this._rowContainer=document.createElement("div"),this._rowContainer.classList.add(O),this._rowContainer.style.lineHeight="normal",this._rowContainer.setAttribute("aria-hidden","true"),this._refreshRowElements(this._bufferService.cols,this._bufferService.rows),this._selectionContainer=document.createElement("div"),this._selectionContainer.classList.add(k),this._selectionContainer.setAttribute("aria-hidden","true"),this.dimensions=(0,S.createRenderDimensions)(),this._updateDimensions(),this.register(this._optionsService.onOptionChange(()=>this._handleOptionsChanged())),this.register(this._themeService.onChangeColors(H=>this._injectCss(H))),this._injectCss(this._themeService.colors),this._rowFactory=j.createInstance(p.DomRendererRowFactory,document),this._element.classList.add(R+this._terminalClass),this._screenElement.appendChild(this._rowContainer),this._screenElement.appendChild(this._selectionContainer),this.register(this._linkifier2.onShowLinkUnderline(H=>this._handleLinkHover(H))),this.register(this._linkifier2.onHideLinkUnderline(H=>this._handleLinkLeave(H))),this.register((0,v.toDisposable)(()=>{this._element.classList.remove(R+this._terminalClass),this._rowContainer.remove(),this._selectionContainer.remove(),this._widthCache.dispose(),this._themeStyleElement.remove(),this._dimensionsStyleElement.remove()})),this._widthCache=new T.WidthCache(document),this._widthCache.setFont(this._optionsService.rawOptions.fontFamily,this._optionsService.rawOptions.fontSize,this._optionsService.rawOptions.fontWeight,this._optionsService.rawOptions.fontWeightBold),this._setDefaultSpacing()}_updateDimensions(){const F=this._coreBrowserService.dpr;this.dimensions.device.char.width=this._charSizeService.width*F,this.dimensions.device.char.height=Math.ceil(this._charSizeService.height*F),this.dimensions.device.cell.width=this.dimensions.device.char.width+Math.round(this._optionsService.rawOptions.letterSpacing),this.dimensions.device.cell.height=Math.floor(this.dimensions.device.char.height*this._optionsService.rawOptions.lineHeight),this.dimensions.device.char.left=0,this.dimensions.device.char.top=0,this.dimensions.device.canvas.width=this.dimensions.device.cell.width*this._bufferService.cols,this.dimensions.device.canvas.height=this.dimensions.device.cell.height*this._bufferService.rows,this.dimensions.css.canvas.width=Math.round(this.dimensions.device.canvas.width/F),this.dimensions.css.canvas.height=Math.round(this.dimensions.device.canvas.height/F),this.dimensions.css.cell.width=this.dimensions.css.canvas.width/this._bufferService.cols,this.dimensions.css.cell.height=this.dimensions.css.canvas.height/this._bufferService.rows;for(const W of this._rowElements)W.style.width=`${this.dimensions.css.canvas.width}px`,W.style.height=`${this.dimensions.css.cell.height}px`,W.style.lineHeight=`${this.dimensions.css.cell.height}px`,W.style.overflow="hidden";this._dimensionsStyleElement||(this._dimensionsStyleElement=document.createElement("style"),this._screenElement.appendChild(this._dimensionsStyleElement));const X=`${this._terminalSelector} .${O} span { display: inline-block; height: 100%; vertical-align: top;}`;this._dimensionsStyleElement.textContent=X,this._selectionContainer.style.height=this._viewportElement.style.height,this._screenElement.style.width=`${this.dimensions.css.canvas.width}px`,this._screenElement.style.height=`${this.dimensions.css.canvas.height}px`}_injectCss(F){this._themeStyleElement||(this._themeStyleElement=document.createElement("style"),this._screenElement.appendChild(this._themeStyleElement));let X=`${this._terminalSelector} .${O} { color: ${F.foreground.css}; font-family: ${this._optionsService.rawOptions.fontFamily}; font-size: ${this._optionsService.rawOptions.fontSize}px; font-kerning: none; white-space: pre}`;X+=`${this._terminalSelector} .${O} .xterm-dim { color: ${g.color.multiplyOpacity(F.foreground,.5).css};}`,X+=`${this._terminalSelector} span:not(.xterm-bold) { font-weight: ${this._optionsService.rawOptions.fontWeight};}${this._terminalSelector} span.xterm-bold { font-weight: ${this._optionsService.rawOptions.fontWeightBold};}${this._terminalSelector} span.xterm-italic { font-style: italic;}`,X+="@keyframes blink_box_shadow_"+this._terminalClass+" { 50% {  border-bottom-style: hidden; }}",X+="@keyframes blink_block_"+this._terminalClass+` { 0% {  background-color: ${F.cursor.css};  color: ${F.cursorAccent.css}; } 50% {  background-color: inherit;  color: ${F.cursor.css}; }}`,X+=`${this._terminalSelector} .${O}.${I} .xterm-cursor.xterm-cursor-blink:not(.xterm-cursor-block) { animation: blink_box_shadow_`+this._terminalClass+` 1s step-end infinite;}${this._terminalSelector} .${O}.${I} .xterm-cursor.xterm-cursor-blink.xterm-cursor-block { animation: blink_block_`+this._terminalClass+` 1s step-end infinite;}${this._terminalSelector} .${O} .xterm-cursor.xterm-cursor-block { background-color: ${F.cursor.css}; color: ${F.cursorAccent.css};}${this._terminalSelector} .${O} .xterm-cursor.xterm-cursor-outline { outline: 1px solid ${F.cursor.css}; outline-offset: -1px;}${this._terminalSelector} .${O} .xterm-cursor.xterm-cursor-bar { box-shadow: ${this._optionsService.rawOptions.cursorWidth}px 0 0 ${F.cursor.css} inset;}${this._terminalSelector} .${O} .xterm-cursor.xterm-cursor-underline { border-bottom: 1px ${F.cursor.css}; border-bottom-style: solid; height: calc(100% - 1px);}`,X+=`${this._terminalSelector} .${k} { position: absolute; top: 0; left: 0; z-index: 1; pointer-events: none;}${this._terminalSelector}.focus .${k} div { position: absolute; background-color: ${F.selectionBackgroundOpaque.css};}${this._terminalSelector} .${k} div { position: absolute; background-color: ${F.selectionInactiveBackgroundOpaque.css};}`;for(const[W,z]of F.ansi.entries())X+=`${this._terminalSelector} .${w}${W} { color: ${z.css}; }${this._terminalSelector} .${w}${W}.xterm-dim { color: ${g.color.multiplyOpacity(z,.5).css}; }${this._terminalSelector} .${L}${W} { background-color: ${z.css}; }`;X+=`${this._terminalSelector} .${w}${$.INVERTED_DEFAULT_COLOR} { color: ${g.color.opaque(F.background).css}; }${this._terminalSelector} .${w}${$.INVERTED_DEFAULT_COLOR}.xterm-dim { color: ${g.color.multiplyOpacity(g.color.opaque(F.background),.5).css}; }${this._terminalSelector} .${L}${$.INVERTED_DEFAULT_COLOR} { background-color: ${F.foreground.css}; }`,this._themeStyleElement.textContent=X}_setDefaultSpacing(){const F=this.dimensions.css.cell.width-this._widthCache.get("W",false,false);this._rowContainer.style.letterSpacing=`${F}px`,this._rowFactory.defaultSpacing=F}handleDevicePixelRatioChange(){this._updateDimensions(),this._widthCache.clear(),this._setDefaultSpacing()}_refreshRowElements(F,X){for(let W=this._rowElements.length;W<=X;W++){const z=document.createElement("div");this._rowContainer.appendChild(z),this._rowElements.push(z)}for(;this._rowElements.length>X;)this._rowContainer.removeChild(this._rowElements.pop())}handleResize(F,X){this._refreshRowElements(F,X),this._updateDimensions()}handleCharSizeChanged(){this._updateDimensions(),this._widthCache.clear(),this._setDefaultSpacing()}handleBlur(){this._rowContainer.classList.remove(I)}handleFocus(){this._rowContainer.classList.add(I),this.renderRows(this._bufferService.buffer.y,this._bufferService.buffer.y)}handleSelectionChanged(F,X,W){if(this._selectionContainer.replaceChildren(),this._rowFactory.handleSelectionChanged(F,X,W),this.renderRows(0,this._bufferService.rows-1),!F||!X)return;const z=F[1]-this._bufferService.buffer.ydisp,j=X[1]-this._bufferService.buffer.ydisp,J=Math.max(z,0),M=Math.min(j,this._bufferService.rows-1);if(J>=this._bufferService.rows||M<0)return;const U=document.createDocumentFragment();if(W){const V=F[0]>X[0];U.appendChild(this._createSelectionElement(J,V?X[0]:F[0],V?F[0]:X[0],M-J+1))}else{const V=z===J?F[0]:0,K=J===j?X[0]:this._bufferService.cols;U.appendChild(this._createSelectionElement(J,V,K));const H=M-J-1;if(U.appendChild(this._createSelectionElement(J+1,0,this._bufferService.cols,H)),J!==M){const ie=j===M?X[0]:this._bufferService.cols;U.appendChild(this._createSelectionElement(M,0,ie))}}this._selectionContainer.appendChild(U)}_createSelectionElement(F,X,W,z=1){const j=document.createElement("div");return j.style.height=z*this.dimensions.css.cell.height+"px",j.style.top=F*this.dimensions.css.cell.height+"px",j.style.left=X*this.dimensions.css.cell.width+"px",j.style.width=this.dimensions.css.cell.width*(W-X)+"px",j}handleCursorMove(){}_handleOptionsChanged(){this._updateDimensions(),this._injectCss(this._themeService.colors),this._widthCache.setFont(this._optionsService.rawOptions.fontFamily,this._optionsService.rawOptions.fontSize,this._optionsService.rawOptions.fontWeight,this._optionsService.rawOptions.fontWeightBold),this._setDefaultSpacing()}clear(){for(const F of this._rowElements)F.replaceChildren()}renderRows(F,X){const W=this._bufferService.buffer,z=W.ybase+W.y,j=Math.min(W.x,this._bufferService.cols-1),J=this._optionsService.rawOptions.cursorBlink,M=this._optionsService.rawOptions.cursorStyle,U=this._optionsService.rawOptions.cursorInactiveStyle;for(let V=F;V<=X;V++){const K=V+W.ydisp,H=this._rowElements[V],ie=W.lines.get(K);if(!H||!ie)break;H.replaceChildren(...this._rowFactory.createRow(ie,K,K===z,M,U,j,J,this.dimensions.css.cell.width,this._widthCache,-1,-1))}}get _terminalSelector(){return`.${R}${this._terminalClass}`}_handleLinkHover(F){this._setCellUnderline(F.x1,F.x2,F.y1,F.y2,F.cols,true)}_handleLinkLeave(F){this._setCellUnderline(F.x1,F.x2,F.y1,F.y2,F.cols,false)}_setCellUnderline(F,X,W,z,j,J){W<0&&(F=0),z<0&&(X=0);const M=this._bufferService.rows-1;W=Math.max(Math.min(W,M),0),z=Math.max(Math.min(z,M),0),j=Math.min(j,this._bufferService.cols);const U=this._bufferService.buffer,V=U.ybase+U.y,K=Math.min(U.x,j-1),H=this._optionsService.rawOptions.cursorBlink,ie=this._optionsService.rawOptions.cursorStyle,Ie=this._optionsService.rawOptions.cursorInactiveStyle;for(let he=W;he<=z;++he){const st=he+U.ydisp,B=this._rowElements[he],te=U.lines.get(st);if(!B||!te)break;B.replaceChildren(...this._rowFactory.createRow(te,st,st===V,ie,Ie,K,H,this.dimensions.css.cell.width,this._widthCache,J?he===W?F:0:-1,J?(he===z?X:j)-1:-1))}}};u.DomRenderer=P=c([h(4,b.IInstantiationService),h(5,y.ICharSizeService),h(6,b.IOptionsService),h(7,b.IBufferService),h(8,y.ICoreBrowserService),h(9,y.IThemeService)],P)},3787:function(m,u,_){var c=this&&this.__decorate||function(w,L,I,k){var x,P=arguments.length,F=P<3?L:k===null?k=Object.getOwnPropertyDescriptor(L,I):k;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")F=Reflect.decorate(w,L,I,k);else for(var X=w.length-1;X>=0;X--)(x=w[X])&&(F=(P<3?x(F):P>3?x(L,I,F):x(L,I))||F);return P>3&&F&&Object.defineProperty(L,I,F),F},h=this&&this.__param||function(w,L){return function(I,k){L(I,k,w)}};Object.defineProperty(u,"__esModule",{value:true}),u.DomRendererRowFactory=void 0;const p=_(2223),T=_(643),$=_(511),S=_(2585),y=_(8055),g=_(4725),E=_(4269),v=_(6171),b=_(3734);let R=u.DomRendererRowFactory=class{constructor(w,L,I,k,x,P,F){this._document=w,this._characterJoinerService=L,this._optionsService=I,this._coreBrowserService=k,this._coreService=x,this._decorationService=P,this._themeService=F,this._workCell=new $.CellData,this._columnSelectMode=false,this.defaultSpacing=0}handleSelectionChanged(w,L,I){this._selectionStart=w,this._selectionEnd=L,this._columnSelectMode=I}createRow(w,L,I,k,x,P,F,X,W,z,j){const J=[],M=this._characterJoinerService.getJoinedCharacters(L),U=this._themeService.colors;let V,K=w.getNoBgTrimmedLength();I&&K<P+1&&(K=P+1);let H=0,ie="",Ie=0,he=0,st=0,B=false,te=0,le=false,ae=0;const Me=[],Se=z!==-1&&j!==-1;for(let nt=0;nt<K;nt++){w.loadCell(nt,this._workCell);let St=this._workCell.getWidth();if(St===0)continue;let Ut=false,Jt=nt,We=this._workCell;if(M.length>0&&nt===M[0][0]){Ut=true;const Ot=M.shift();We=new E.JoinedCellData(this._workCell,w.translateToString(true,Ot[0],Ot[1]),Ot[1]-Ot[0]),Jt=Ot[1]-1,St=We.getWidth()}const Is=this._isCellInSelection(nt,L),Cs=I&&nt===P,Os=Se&&nt>=z&&nt<=j;let xs=false;this._decorationService.forEachDecorationAtCell(nt,L,void 0,Ot=>{xs=true});let Ws=We.getChars()||T.WHITESPACE_CELL_CHAR;if(Ws===" "&&(We.isUnderline()||We.isOverline())&&(Ws=" "),ae=St*X-W.get(Ws,We.isBold(),We.isItalic()),V){if(H&&(Is&&le||!Is&&!le&&We.bg===Ie)&&(Is&&le&&U.selectionForeground||We.fg===he)&&We.extended.ext===st&&Os===B&&ae===te&&!Cs&&!Ut&&!xs){ie+=Ws,H++;continue}H&&(V.textContent=ie),V=this._document.createElement("span"),H=0,ie=""}else V=this._document.createElement("span");if(Ie=We.bg,he=We.fg,st=We.extended.ext,B=Os,te=ae,le=Is,Ut&&P>=nt&&P<=Jt&&(P=nt),!this._coreService.isCursorHidden&&Cs){if(Me.push("xterm-cursor"),this._coreBrowserService.isFocused)F&&Me.push("xterm-cursor-blink"),Me.push(k==="bar"?"xterm-cursor-bar":k==="underline"?"xterm-cursor-underline":"xterm-cursor-block");else if(x)switch(x){case"outline":Me.push("xterm-cursor-outline");break;case"block":Me.push("xterm-cursor-block");break;case"bar":Me.push("xterm-cursor-bar");break;case"underline":Me.push("xterm-cursor-underline")}}if(We.isBold()&&Me.push("xterm-bold"),We.isItalic()&&Me.push("xterm-italic"),We.isDim()&&Me.push("xterm-dim"),ie=We.isInvisible()?T.WHITESPACE_CELL_CHAR:We.getChars()||T.WHITESPACE_CELL_CHAR,We.isUnderline()&&(Me.push(`xterm-underline-${We.extended.underlineStyle}`),ie===" "&&(ie=" "),!We.isUnderlineColorDefault()))if(We.isUnderlineColorRGB())V.style.textDecorationColor=`rgb(${b.AttributeData.toColorRGB(We.getUnderlineColor()).join(",")})`;else{let Ot=We.getUnderlineColor();this._optionsService.rawOptions.drawBoldTextInBrightColors&&We.isBold()&&Ot<8&&(Ot+=8),V.style.textDecorationColor=U.ansi[Ot].css}We.isOverline()&&(Me.push("xterm-overline"),ie===" "&&(ie=" ")),We.isStrikethrough()&&Me.push("xterm-strikethrough"),Os&&(V.style.textDecoration="underline");let At=We.getFgColor(),be=We.getFgColorMode(),qe=We.getBgColor(),ut=We.getBgColorMode();const jt=!!We.isInverse();if(jt){const Ot=At;At=qe,qe=Ot;const xi=be;be=ut,ut=xi}let Ee,fi,fs,ws=false;switch(this._decorationService.forEachDecorationAtCell(nt,L,void 0,Ot=>{Ot.options.layer!=="top"&&ws||(Ot.backgroundColorRGB&&(ut=50331648,qe=Ot.backgroundColorRGB.rgba>>8&16777215,Ee=Ot.backgroundColorRGB),Ot.foregroundColorRGB&&(be=50331648,At=Ot.foregroundColorRGB.rgba>>8&16777215,fi=Ot.foregroundColorRGB),ws=Ot.options.layer==="top")}),!ws&&Is&&(Ee=this._coreBrowserService.isFocused?U.selectionBackgroundOpaque:U.selectionInactiveBackgroundOpaque,qe=Ee.rgba>>8&16777215,ut=50331648,ws=true,U.selectionForeground&&(be=50331648,At=U.selectionForeground.rgba>>8&16777215,fi=U.selectionForeground)),ws&&Me.push("xterm-decoration-top"),ut){case 16777216:case 33554432:fs=U.ansi[qe],Me.push(`xterm-bg-${qe}`);break;case 50331648:fs=y.rgba.toColor(qe>>16,qe>>8&255,255&qe),this._addStyle(V,`background-color:#${O((qe>>>0).toString(16),"0",6)}`);break;default:jt?(fs=U.foreground,Me.push(`xterm-bg-${p.INVERTED_DEFAULT_COLOR}`)):fs=U.background}switch(Ee||We.isDim()&&(Ee=y.color.multiplyOpacity(fs,.5)),be){case 16777216:case 33554432:We.isBold()&&At<8&&this._optionsService.rawOptions.drawBoldTextInBrightColors&&(At+=8),this._applyMinimumContrast(V,fs,U.ansi[At],We,Ee,void 0)||Me.push(`xterm-fg-${At}`);break;case 50331648:const Ot=y.rgba.toColor(At>>16&255,At>>8&255,255&At);this._applyMinimumContrast(V,fs,Ot,We,Ee,fi)||this._addStyle(V,`color:#${O(At.toString(16),"0",6)}`);break;default:this._applyMinimumContrast(V,fs,U.foreground,We,Ee,void 0)||jt&&Me.push(`xterm-fg-${p.INVERTED_DEFAULT_COLOR}`)}Me.length&&(V.className=Me.join(" "),Me.length=0),Cs||Ut||xs?V.textContent=ie:H++,ae!==this.defaultSpacing&&(V.style.letterSpacing=`${ae}px`),J.push(V),nt=Jt}return V&&H&&(V.textContent=ie),J}_applyMinimumContrast(w,L,I,k,x,P){if(this._optionsService.rawOptions.minimumContrastRatio===1||(0,v.excludeFromContrastRatioDemands)(k.getCode()))return false;const F=this._getContrastCache(k);let X;if(x||P||(X=F.getColor(L.rgba,I.rgba)),X===void 0){const W=this._optionsService.rawOptions.minimumContrastRatio/(k.isDim()?2:1);X=y.color.ensureContrastRatio(x||L,P||I,W),F.setColor((x||L).rgba,(P||I).rgba,X??null)}return!!X&&(this._addStyle(w,`color:${X.css}`),true)}_getContrastCache(w){return w.isDim()?this._themeService.colors.halfContrastCache:this._themeService.colors.contrastCache}_addStyle(w,L){w.setAttribute("style",`${w.getAttribute("style")||""}${L};`)}_isCellInSelection(w,L){const I=this._selectionStart,k=this._selectionEnd;return!(!I||!k)&&(this._columnSelectMode?I[0]<=k[0]?w>=I[0]&&L>=I[1]&&w<k[0]&&L<=k[1]:w<I[0]&&L>=I[1]&&w>=k[0]&&L<=k[1]:L>I[1]&&L<k[1]||I[1]===k[1]&&L===I[1]&&w>=I[0]&&w<k[0]||I[1]<k[1]&&L===k[1]&&w<k[0]||I[1]<k[1]&&L===I[1]&&w>=I[0])}};function O(w,L,I){for(;w.length<I;)w=L+w;return w}u.DomRendererRowFactory=R=c([h(1,g.ICharacterJoinerService),h(2,S.IOptionsService),h(3,g.ICoreBrowserService),h(4,S.ICoreService),h(5,S.IDecorationService),h(6,g.IThemeService)],R)},2550:(m,u)=>{Object.defineProperty(u,"__esModule",{value:true}),u.WidthCache=void 0,u.WidthCache=class{constructor(_){this._flat=new Float32Array(256),this._font="",this._fontSize=0,this._weight="normal",this._weightBold="bold",this._measureElements=[],this._container=_.createElement("div"),this._container.style.position="absolute",this._container.style.top="-50000px",this._container.style.width="50000px",this._container.style.whiteSpace="pre",this._container.style.fontKerning="none";const c=_.createElement("span"),h=_.createElement("span");h.style.fontWeight="bold";const p=_.createElement("span");p.style.fontStyle="italic";const T=_.createElement("span");T.style.fontWeight="bold",T.style.fontStyle="italic",this._measureElements=[c,h,p,T],this._container.appendChild(c),this._container.appendChild(h),this._container.appendChild(p),this._container.appendChild(T),_.body.appendChild(this._container),this.clear()}dispose(){this._container.remove(),this._measureElements.length=0,this._holey=void 0}clear(){this._flat.fill(-9999),this._holey=new Map}setFont(_,c,h,p){_===this._font&&c===this._fontSize&&h===this._weight&&p===this._weightBold||(this._font=_,this._fontSize=c,this._weight=h,this._weightBold=p,this._container.style.fontFamily=this._font,this._container.style.fontSize=`${this._fontSize}px`,this._measureElements[0].style.fontWeight=`${h}`,this._measureElements[1].style.fontWeight=`${p}`,this._measureElements[2].style.fontWeight=`${h}`,this._measureElements[3].style.fontWeight=`${p}`,this.clear())}get(_,c,h){let p=0;if(!c&&!h&&_.length===1&&(p=_.charCodeAt(0))<256)return this._flat[p]!==-9999?this._flat[p]:this._flat[p]=this._measure(_,0);let T=_;c&&(T+="B"),h&&(T+="I");let $=this._holey.get(T);if($===void 0){let S=0;c&&(S|=1),h&&(S|=2),$=this._measure(_,S),this._holey.set(T,$)}return $}_measure(_,c){const h=this._measureElements[c];return h.textContent=_.repeat(32),h.offsetWidth/32}}},2223:(m,u,_)=>{Object.defineProperty(u,"__esModule",{value:true}),u.TEXT_BASELINE=u.DIM_OPACITY=u.INVERTED_DEFAULT_COLOR=void 0;const c=_(6114);u.INVERTED_DEFAULT_COLOR=257,u.DIM_OPACITY=.5,u.TEXT_BASELINE=c.isFirefox||c.isLegacyEdge?"bottom":"ideographic"},6171:(m,u)=>{function _(c){return 57508<=c&&c<=57558}Object.defineProperty(u,"__esModule",{value:true}),u.createRenderDimensions=u.excludeFromContrastRatioDemands=u.isRestrictedPowerlineGlyph=u.isPowerlineGlyph=u.throwIfFalsy=void 0,u.throwIfFalsy=function(c){if(!c)throw new Error("value must not be falsy");return c},u.isPowerlineGlyph=_,u.isRestrictedPowerlineGlyph=function(c){return 57520<=c&&c<=57527},u.excludeFromContrastRatioDemands=function(c){return _(c)||function(h){return 9472<=h&&h<=9631}(c)},u.createRenderDimensions=function(){return{css:{canvas:{width:0,height:0},cell:{width:0,height:0}},device:{canvas:{width:0,height:0},cell:{width:0,height:0},char:{width:0,height:0,left:0,top:0}}}}},456:(m,u)=>{Object.defineProperty(u,"__esModule",{value:true}),u.SelectionModel=void 0,u.SelectionModel=class{constructor(_){this._bufferService=_,this.isSelectAllActive=false,this.selectionStartLength=0}clearSelection(){this.selectionStart=void 0,this.selectionEnd=void 0,this.isSelectAllActive=false,this.selectionStartLength=0}get finalSelectionStart(){return this.isSelectAllActive?[0,0]:this.selectionEnd&&this.selectionStart&&this.areSelectionValuesReversed()?this.selectionEnd:this.selectionStart}get finalSelectionEnd(){if(this.isSelectAllActive)return[this._bufferService.cols,this._bufferService.buffer.ybase+this._bufferService.rows-1];if(this.selectionStart){if(!this.selectionEnd||this.areSelectionValuesReversed()){const _=this.selectionStart[0]+this.selectionStartLength;return _>this._bufferService.cols?_%this._bufferService.cols==0?[this._bufferService.cols,this.selectionStart[1]+Math.floor(_/this._bufferService.cols)-1]:[_%this._bufferService.cols,this.selectionStart[1]+Math.floor(_/this._bufferService.cols)]:[_,this.selectionStart[1]]}if(this.selectionStartLength&&this.selectionEnd[1]===this.selectionStart[1]){const _=this.selectionStart[0]+this.selectionStartLength;return _>this._bufferService.cols?[_%this._bufferService.cols,this.selectionStart[1]+Math.floor(_/this._bufferService.cols)]:[Math.max(_,this.selectionEnd[0]),this.selectionEnd[1]]}return this.selectionEnd}}areSelectionValuesReversed(){const _=this.selectionStart,c=this.selectionEnd;return!(!_||!c)&&(_[1]>c[1]||_[1]===c[1]&&_[0]>c[0])}handleTrim(_){return this.selectionStart&&(this.selectionStart[1]-=_),this.selectionEnd&&(this.selectionEnd[1]-=_),this.selectionEnd&&this.selectionEnd[1]<0?(this.clearSelection(),true):(this.selectionStart&&this.selectionStart[1]<0&&(this.selectionStart[1]=0),false)}}},428:function(m,u,_){var c=this&&this.__decorate||function(g,E,v,b){var R,O=arguments.length,w=O<3?E:b===null?b=Object.getOwnPropertyDescriptor(E,v):b;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")w=Reflect.decorate(g,E,v,b);else for(var L=g.length-1;L>=0;L--)(R=g[L])&&(w=(O<3?R(w):O>3?R(E,v,w):R(E,v))||w);return O>3&&w&&Object.defineProperty(E,v,w),w},h=this&&this.__param||function(g,E){return function(v,b){E(v,b,g)}};Object.defineProperty(u,"__esModule",{value:true}),u.CharSizeService=void 0;const p=_(2585),T=_(8460),$=_(844);let S=u.CharSizeService=class extends $.Disposable{get hasValidSize(){return this.width>0&&this.height>0}constructor(g,E,v){super(),this._optionsService=v,this.width=0,this.height=0,this._onCharSizeChange=this.register(new T.EventEmitter),this.onCharSizeChange=this._onCharSizeChange.event,this._measureStrategy=new y(g,E,this._optionsService),this.register(this._optionsService.onMultipleOptionChange(["fontFamily","fontSize"],()=>this.measure()))}measure(){const g=this._measureStrategy.measure();g.width===this.width&&g.height===this.height||(this.width=g.width,this.height=g.height,this._onCharSizeChange.fire())}};u.CharSizeService=S=c([h(2,p.IOptionsService)],S);class y{constructor(E,v,b){this._document=E,this._parentElement=v,this._optionsService=b,this._result={width:0,height:0},this._measureElement=this._document.createElement("span"),this._measureElement.classList.add("xterm-char-measure-element"),this._measureElement.textContent="W".repeat(32),this._measureElement.setAttribute("aria-hidden","true"),this._measureElement.style.whiteSpace="pre",this._measureElement.style.fontKerning="none",this._parentElement.appendChild(this._measureElement)}measure(){this._measureElement.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._measureElement.style.fontSize=`${this._optionsService.rawOptions.fontSize}px`;const E={height:Number(this._measureElement.offsetHeight),width:Number(this._measureElement.offsetWidth)};return E.width!==0&&E.height!==0&&(this._result.width=E.width/32,this._result.height=Math.ceil(E.height)),this._result}}},4269:function(m,u,_){var c=this&&this.__decorate||function(E,v,b,R){var O,w=arguments.length,L=w<3?v:R===null?R=Object.getOwnPropertyDescriptor(v,b):R;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")L=Reflect.decorate(E,v,b,R);else for(var I=E.length-1;I>=0;I--)(O=E[I])&&(L=(w<3?O(L):w>3?O(v,b,L):O(v,b))||L);return w>3&&L&&Object.defineProperty(v,b,L),L},h=this&&this.__param||function(E,v){return function(b,R){v(b,R,E)}};Object.defineProperty(u,"__esModule",{value:true}),u.CharacterJoinerService=u.JoinedCellData=void 0;const p=_(3734),T=_(643),$=_(511),S=_(2585);class y extends p.AttributeData{constructor(v,b,R){super(),this.content=0,this.combinedData="",this.fg=v.fg,this.bg=v.bg,this.combinedData=b,this._width=R}isCombined(){return 2097152}getWidth(){return this._width}getChars(){return this.combinedData}getCode(){return 2097151}setFromCharData(v){throw new Error("not implemented")}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}u.JoinedCellData=y;let g=u.CharacterJoinerService=class EI{constructor(v){this._bufferService=v,this._characterJoiners=[],this._nextCharacterJoinerId=0,this._workCell=new $.CellData}register(v){const b={id:this._nextCharacterJoinerId++,handler:v};return this._characterJoiners.push(b),b.id}deregister(v){for(let b=0;b<this._characterJoiners.length;b++)if(this._characterJoiners[b].id===v)return this._characterJoiners.splice(b,1),true;return false}getJoinedCharacters(v){if(this._characterJoiners.length===0)return[];const b=this._bufferService.buffer.lines.get(v);if(!b||b.length===0)return[];const R=[],O=b.translateToString(true);let w=0,L=0,I=0,k=b.getFg(0),x=b.getBg(0);for(let P=0;P<b.getTrimmedLength();P++)if(b.loadCell(P,this._workCell),this._workCell.getWidth()!==0){if(this._workCell.fg!==k||this._workCell.bg!==x){if(P-w>1){const F=this._getJoinedRanges(O,I,L,b,w);for(let X=0;X<F.length;X++)R.push(F[X])}w=P,I=L,k=this._workCell.fg,x=this._workCell.bg}L+=this._workCell.getChars().length||T.WHITESPACE_CELL_CHAR.length}if(this._bufferService.cols-w>1){const P=this._getJoinedRanges(O,I,L,b,w);for(let F=0;F<P.length;F++)R.push(P[F])}return R}_getJoinedRanges(v,b,R,O,w){const L=v.substring(b,R);let I=[];try{I=this._characterJoiners[0].handler(L)}catch(k){console.error(k)}for(let k=1;k<this._characterJoiners.length;k++)try{const x=this._characterJoiners[k].handler(L);for(let P=0;P<x.length;P++)EI._mergeRanges(I,x[P])}catch(x){console.error(x)}return this._stringRangesToCellRanges(I,O,w),I}_stringRangesToCellRanges(v,b,R){let O=0,w=false,L=0,I=v[O];if(I){for(let k=R;k<this._bufferService.cols;k++){const x=b.getWidth(k),P=b.getString(k).length||T.WHITESPACE_CELL_CHAR.length;if(x!==0){if(!w&&I[0]<=L&&(I[0]=k,w=true),I[1]<=L){if(I[1]=k,I=v[++O],!I)break;I[0]<=L?(I[0]=k,w=true):w=false}L+=P}}I&&(I[1]=this._bufferService.cols)}}static _mergeRanges(v,b){let R=false;for(let O=0;O<v.length;O++){const w=v[O];if(R){if(b[1]<=w[0])return v[O-1][1]=b[1],v;if(b[1]<=w[1])return v[O-1][1]=Math.max(b[1],w[1]),v.splice(O,1),v;v.splice(O,1),O--}else{if(b[1]<=w[0])return v.splice(O,0,b),v;if(b[1]<=w[1])return w[0]=Math.min(b[0],w[0]),v;b[0]<w[1]&&(w[0]=Math.min(b[0],w[0]),R=true)}}return R?v[v.length-1][1]=b[1]:v.push(b),v}};u.CharacterJoinerService=g=c([h(0,S.IBufferService)],g)},5114:(m,u)=>{Object.defineProperty(u,"__esModule",{value:true}),u.CoreBrowserService=void 0,u.CoreBrowserService=class{constructor(_,c){this._textarea=_,this.window=c,this._isFocused=false,this._cachedIsFocused=void 0,this._textarea.addEventListener("focus",()=>this._isFocused=true),this._textarea.addEventListener("blur",()=>this._isFocused=false)}get dpr(){return this.window.devicePixelRatio}get isFocused(){return this._cachedIsFocused===void 0&&(this._cachedIsFocused=this._isFocused&&this._textarea.ownerDocument.hasFocus(),queueMicrotask(()=>this._cachedIsFocused=void 0)),this._cachedIsFocused}}},8934:function(m,u,_){var c=this&&this.__decorate||function(S,y,g,E){var v,b=arguments.length,R=b<3?y:E===null?E=Object.getOwnPropertyDescriptor(y,g):E;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")R=Reflect.decorate(S,y,g,E);else for(var O=S.length-1;O>=0;O--)(v=S[O])&&(R=(b<3?v(R):b>3?v(y,g,R):v(y,g))||R);return b>3&&R&&Object.defineProperty(y,g,R),R},h=this&&this.__param||function(S,y){return function(g,E){y(g,E,S)}};Object.defineProperty(u,"__esModule",{value:true}),u.MouseService=void 0;const p=_(4725),T=_(9806);let $=u.MouseService=class{constructor(S,y){this._renderService=S,this._charSizeService=y}getCoords(S,y,g,E,v){return(0,T.getCoords)(window,S,y,g,E,this._charSizeService.hasValidSize,this._renderService.dimensions.css.cell.width,this._renderService.dimensions.css.cell.height,v)}getMouseReportCoords(S,y){const g=(0,T.getCoordsRelativeToElement)(window,S,y);if(this._charSizeService.hasValidSize)return g[0]=Math.min(Math.max(g[0],0),this._renderService.dimensions.css.canvas.width-1),g[1]=Math.min(Math.max(g[1],0),this._renderService.dimensions.css.canvas.height-1),{col:Math.floor(g[0]/this._renderService.dimensions.css.cell.width),row:Math.floor(g[1]/this._renderService.dimensions.css.cell.height),x:Math.floor(g[0]),y:Math.floor(g[1])}}};u.MouseService=$=c([h(0,p.IRenderService),h(1,p.ICharSizeService)],$)},3230:function(m,u,_){var c=this&&this.__decorate||function(R,O,w,L){var I,k=arguments.length,x=k<3?O:L===null?L=Object.getOwnPropertyDescriptor(O,w):L;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")x=Reflect.decorate(R,O,w,L);else for(var P=R.length-1;P>=0;P--)(I=R[P])&&(x=(k<3?I(x):k>3?I(O,w,x):I(O,w))||x);return k>3&&x&&Object.defineProperty(O,w,x),x},h=this&&this.__param||function(R,O){return function(w,L){O(w,L,R)}};Object.defineProperty(u,"__esModule",{value:true}),u.RenderService=void 0;const p=_(3656),T=_(6193),$=_(5596),S=_(4725),y=_(8460),g=_(844),E=_(7226),v=_(2585);let b=u.RenderService=class extends g.Disposable{get dimensions(){return this._renderer.value.dimensions}constructor(R,O,w,L,I,k,x,P){if(super(),this._rowCount=R,this._charSizeService=L,this._renderer=this.register(new g.MutableDisposable),this._pausedResizeTask=new E.DebouncedIdleTask,this._isPaused=false,this._needsFullRefresh=false,this._isNextRenderRedrawOnly=true,this._needsSelectionRefresh=false,this._canvasWidth=0,this._canvasHeight=0,this._selectionState={start:void 0,end:void 0,columnSelectMode:false},this._onDimensionsChange=this.register(new y.EventEmitter),this.onDimensionsChange=this._onDimensionsChange.event,this._onRenderedViewportChange=this.register(new y.EventEmitter),this.onRenderedViewportChange=this._onRenderedViewportChange.event,this._onRender=this.register(new y.EventEmitter),this.onRender=this._onRender.event,this._onRefreshRequest=this.register(new y.EventEmitter),this.onRefreshRequest=this._onRefreshRequest.event,this._renderDebouncer=new T.RenderDebouncer(x.window,(F,X)=>this._renderRows(F,X)),this.register(this._renderDebouncer),this._screenDprMonitor=new $.ScreenDprMonitor(x.window),this._screenDprMonitor.setListener(()=>this.handleDevicePixelRatioChange()),this.register(this._screenDprMonitor),this.register(k.onResize(()=>this._fullRefresh())),this.register(k.buffers.onBufferActivate(()=>{var F;return(F=this._renderer.value)===null||F===void 0?void 0:F.clear()})),this.register(w.onOptionChange(()=>this._handleOptionsChanged())),this.register(this._charSizeService.onCharSizeChange(()=>this.handleCharSizeChanged())),this.register(I.onDecorationRegistered(()=>this._fullRefresh())),this.register(I.onDecorationRemoved(()=>this._fullRefresh())),this.register(w.onMultipleOptionChange(["customGlyphs","drawBoldTextInBrightColors","letterSpacing","lineHeight","fontFamily","fontSize","fontWeight","fontWeightBold","minimumContrastRatio"],()=>{this.clear(),this.handleResize(k.cols,k.rows),this._fullRefresh()})),this.register(w.onMultipleOptionChange(["cursorBlink","cursorStyle"],()=>this.refreshRows(k.buffer.y,k.buffer.y,true))),this.register((0,p.addDisposableDomListener)(x.window,"resize",()=>this.handleDevicePixelRatioChange())),this.register(P.onChangeColors(()=>this._fullRefresh())),"IntersectionObserver"in x.window){const F=new x.window.IntersectionObserver(X=>this._handleIntersectionChange(X[X.length-1]),{threshold:0});F.observe(O),this.register({dispose:()=>F.disconnect()})}}_handleIntersectionChange(R){this._isPaused=R.isIntersecting===void 0?R.intersectionRatio===0:!R.isIntersecting,this._isPaused||this._charSizeService.hasValidSize||this._charSizeService.measure(),!this._isPaused&&this._needsFullRefresh&&(this._pausedResizeTask.flush(),this.refreshRows(0,this._rowCount-1),this._needsFullRefresh=false)}refreshRows(R,O,w=false){this._isPaused?this._needsFullRefresh=true:(w||(this._isNextRenderRedrawOnly=false),this._renderDebouncer.refresh(R,O,this._rowCount))}_renderRows(R,O){this._renderer.value&&(R=Math.min(R,this._rowCount-1),O=Math.min(O,this._rowCount-1),this._renderer.value.renderRows(R,O),this._needsSelectionRefresh&&(this._renderer.value.handleSelectionChanged(this._selectionState.start,this._selectionState.end,this._selectionState.columnSelectMode),this._needsSelectionRefresh=false),this._isNextRenderRedrawOnly||this._onRenderedViewportChange.fire({start:R,end:O}),this._onRender.fire({start:R,end:O}),this._isNextRenderRedrawOnly=true)}resize(R,O){this._rowCount=O,this._fireOnCanvasResize()}_handleOptionsChanged(){this._renderer.value&&(this.refreshRows(0,this._rowCount-1),this._fireOnCanvasResize())}_fireOnCanvasResize(){this._renderer.value&&(this._renderer.value.dimensions.css.canvas.width===this._canvasWidth&&this._renderer.value.dimensions.css.canvas.height===this._canvasHeight||this._onDimensionsChange.fire(this._renderer.value.dimensions))}hasRenderer(){return!!this._renderer.value}setRenderer(R){this._renderer.value=R,this._renderer.value.onRequestRedraw(O=>this.refreshRows(O.start,O.end,true)),this._needsSelectionRefresh=true,this._fullRefresh()}addRefreshCallback(R){return this._renderDebouncer.addRefreshCallback(R)}_fullRefresh(){this._isPaused?this._needsFullRefresh=true:this.refreshRows(0,this._rowCount-1)}clearTextureAtlas(){var R,O;this._renderer.value&&((O=(R=this._renderer.value).clearTextureAtlas)===null||O===void 0||O.call(R),this._fullRefresh())}handleDevicePixelRatioChange(){this._charSizeService.measure(),this._renderer.value&&(this._renderer.value.handleDevicePixelRatioChange(),this.refreshRows(0,this._rowCount-1))}handleResize(R,O){this._renderer.value&&(this._isPaused?this._pausedResizeTask.set(()=>this._renderer.value.handleResize(R,O)):this._renderer.value.handleResize(R,O),this._fullRefresh())}handleCharSizeChanged(){var R;(R=this._renderer.value)===null||R===void 0||R.handleCharSizeChanged()}handleBlur(){var R;(R=this._renderer.value)===null||R===void 0||R.handleBlur()}handleFocus(){var R;(R=this._renderer.value)===null||R===void 0||R.handleFocus()}handleSelectionChanged(R,O,w){var L;this._selectionState.start=R,this._selectionState.end=O,this._selectionState.columnSelectMode=w,(L=this._renderer.value)===null||L===void 0||L.handleSelectionChanged(R,O,w)}handleCursorMove(){var R;(R=this._renderer.value)===null||R===void 0||R.handleCursorMove()}clear(){var R;(R=this._renderer.value)===null||R===void 0||R.clear()}};u.RenderService=b=c([h(2,v.IOptionsService),h(3,S.ICharSizeService),h(4,v.IDecorationService),h(5,v.IBufferService),h(6,S.ICoreBrowserService),h(7,S.IThemeService)],b)},9312:function(m,u,_){var c=this&&this.__decorate||function(I,k,x,P){var F,X=arguments.length,W=X<3?k:P===null?P=Object.getOwnPropertyDescriptor(k,x):P;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")W=Reflect.decorate(I,k,x,P);else for(var z=I.length-1;z>=0;z--)(F=I[z])&&(W=(X<3?F(W):X>3?F(k,x,W):F(k,x))||W);return X>3&&W&&Object.defineProperty(k,x,W),W},h=this&&this.__param||function(I,k){return function(x,P){k(x,P,I)}};Object.defineProperty(u,"__esModule",{value:true}),u.SelectionService=void 0;const p=_(9806),T=_(9504),$=_(456),S=_(4725),y=_(8460),g=_(844),E=_(6114),v=_(4841),b=_(511),R=_(2585),O=" ",w=new RegExp(O,"g");let L=u.SelectionService=class extends g.Disposable{constructor(I,k,x,P,F,X,W,z,j){super(),this._element=I,this._screenElement=k,this._linkifier=x,this._bufferService=P,this._coreService=F,this._mouseService=X,this._optionsService=W,this._renderService=z,this._coreBrowserService=j,this._dragScrollAmount=0,this._enabled=true,this._workCell=new b.CellData,this._mouseDownTimeStamp=0,this._oldHasSelection=false,this._oldSelectionStart=void 0,this._oldSelectionEnd=void 0,this._onLinuxMouseSelection=this.register(new y.EventEmitter),this.onLinuxMouseSelection=this._onLinuxMouseSelection.event,this._onRedrawRequest=this.register(new y.EventEmitter),this.onRequestRedraw=this._onRedrawRequest.event,this._onSelectionChange=this.register(new y.EventEmitter),this.onSelectionChange=this._onSelectionChange.event,this._onRequestScrollLines=this.register(new y.EventEmitter),this.onRequestScrollLines=this._onRequestScrollLines.event,this._mouseMoveListener=J=>this._handleMouseMove(J),this._mouseUpListener=J=>this._handleMouseUp(J),this._coreService.onUserInput(()=>{this.hasSelection&&this.clearSelection()}),this._trimListener=this._bufferService.buffer.lines.onTrim(J=>this._handleTrim(J)),this.register(this._bufferService.buffers.onBufferActivate(J=>this._handleBufferActivate(J))),this.enable(),this._model=new $.SelectionModel(this._bufferService),this._activeSelectionMode=0,this.register((0,g.toDisposable)(()=>{this._removeMouseDownListeners()}))}reset(){this.clearSelection()}disable(){this.clearSelection(),this._enabled=false}enable(){this._enabled=true}get selectionStart(){return this._model.finalSelectionStart}get selectionEnd(){return this._model.finalSelectionEnd}get hasSelection(){const I=this._model.finalSelectionStart,k=this._model.finalSelectionEnd;return!(!I||!k||I[0]===k[0]&&I[1]===k[1])}get selectionText(){const I=this._model.finalSelectionStart,k=this._model.finalSelectionEnd;if(!I||!k)return"";const x=this._bufferService.buffer,P=[];if(this._activeSelectionMode===3){if(I[0]===k[0])return"";const F=I[0]<k[0]?I[0]:k[0],X=I[0]<k[0]?k[0]:I[0];for(let W=I[1];W<=k[1];W++){const z=x.translateBufferLineToString(W,true,F,X);P.push(z)}}else{const F=I[1]===k[1]?k[0]:void 0;P.push(x.translateBufferLineToString(I[1],true,I[0],F));for(let X=I[1]+1;X<=k[1]-1;X++){const W=x.lines.get(X),z=x.translateBufferLineToString(X,true);W!=null&&W.isWrapped?P[P.length-1]+=z:P.push(z)}if(I[1]!==k[1]){const X=x.lines.get(k[1]),W=x.translateBufferLineToString(k[1],true,0,k[0]);X&&X.isWrapped?P[P.length-1]+=W:P.push(W)}}return P.map(F=>F.replace(w," ")).join(E.isWindows?`\r
`:`
`)}clearSelection(){this._model.clearSelection(),this._removeMouseDownListeners(),this.refresh(),this._onSelectionChange.fire()}refresh(I){this._refreshAnimationFrame||(this._refreshAnimationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._refresh())),E.isLinux&&I&&this.selectionText.length&&this._onLinuxMouseSelection.fire(this.selectionText)}_refresh(){this._refreshAnimationFrame=void 0,this._onRedrawRequest.fire({start:this._model.finalSelectionStart,end:this._model.finalSelectionEnd,columnSelectMode:this._activeSelectionMode===3})}_isClickInSelection(I){const k=this._getMouseBufferCoords(I),x=this._model.finalSelectionStart,P=this._model.finalSelectionEnd;return!!(x&&P&&k)&&this._areCoordsInSelection(k,x,P)}isCellInSelection(I,k){const x=this._model.finalSelectionStart,P=this._model.finalSelectionEnd;return!(!x||!P)&&this._areCoordsInSelection([I,k],x,P)}_areCoordsInSelection(I,k,x){return I[1]>k[1]&&I[1]<x[1]||k[1]===x[1]&&I[1]===k[1]&&I[0]>=k[0]&&I[0]<x[0]||k[1]<x[1]&&I[1]===x[1]&&I[0]<x[0]||k[1]<x[1]&&I[1]===k[1]&&I[0]>=k[0]}_selectWordAtCursor(I,k){var x,P;const F=(P=(x=this._linkifier.currentLink)===null||x===void 0?void 0:x.link)===null||P===void 0?void 0:P.range;if(F)return this._model.selectionStart=[F.start.x-1,F.start.y-1],this._model.selectionStartLength=(0,v.getRangeLength)(F,this._bufferService.cols),this._model.selectionEnd=void 0,true;const X=this._getMouseBufferCoords(I);return!!X&&(this._selectWordAt(X,k),this._model.selectionEnd=void 0,true)}selectAll(){this._model.isSelectAllActive=true,this.refresh(),this._onSelectionChange.fire()}selectLines(I,k){this._model.clearSelection(),I=Math.max(I,0),k=Math.min(k,this._bufferService.buffer.lines.length-1),this._model.selectionStart=[0,I],this._model.selectionEnd=[this._bufferService.cols,k],this.refresh(),this._onSelectionChange.fire()}_handleTrim(I){this._model.handleTrim(I)&&this.refresh()}_getMouseBufferCoords(I){const k=this._mouseService.getCoords(I,this._screenElement,this._bufferService.cols,this._bufferService.rows,true);if(k)return k[0]--,k[1]--,k[1]+=this._bufferService.buffer.ydisp,k}_getMouseEventScrollAmount(I){let k=(0,p.getCoordsRelativeToElement)(this._coreBrowserService.window,I,this._screenElement)[1];const x=this._renderService.dimensions.css.canvas.height;return k>=0&&k<=x?0:(k>x&&(k-=x),k=Math.min(Math.max(k,-50),50),k/=50,k/Math.abs(k)+Math.round(14*k))}shouldForceSelection(I){return E.isMac?I.altKey&&this._optionsService.rawOptions.macOptionClickForcesSelection:I.shiftKey}handleMouseDown(I){if(this._mouseDownTimeStamp=I.timeStamp,(I.button!==2||!this.hasSelection)&&I.button===0){if(!this._enabled){if(!this.shouldForceSelection(I))return;I.stopPropagation()}I.preventDefault(),this._dragScrollAmount=0,this._enabled&&I.shiftKey?this._handleIncrementalClick(I):I.detail===1?this._handleSingleClick(I):I.detail===2?this._handleDoubleClick(I):I.detail===3&&this._handleTripleClick(I),this._addMouseDownListeners(),this.refresh(true)}}_addMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.addEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.addEventListener("mouseup",this._mouseUpListener)),this._dragScrollIntervalTimer=this._coreBrowserService.window.setInterval(()=>this._dragScroll(),50)}_removeMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.removeEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.removeEventListener("mouseup",this._mouseUpListener)),this._coreBrowserService.window.clearInterval(this._dragScrollIntervalTimer),this._dragScrollIntervalTimer=void 0}_handleIncrementalClick(I){this._model.selectionStart&&(this._model.selectionEnd=this._getMouseBufferCoords(I))}_handleSingleClick(I){if(this._model.selectionStartLength=0,this._model.isSelectAllActive=false,this._activeSelectionMode=this.shouldColumnSelect(I)?3:0,this._model.selectionStart=this._getMouseBufferCoords(I),!this._model.selectionStart)return;this._model.selectionEnd=void 0;const k=this._bufferService.buffer.lines.get(this._model.selectionStart[1]);k&&k.length!==this._model.selectionStart[0]&&k.hasWidth(this._model.selectionStart[0])===0&&this._model.selectionStart[0]++}_handleDoubleClick(I){this._selectWordAtCursor(I,true)&&(this._activeSelectionMode=1)}_handleTripleClick(I){const k=this._getMouseBufferCoords(I);k&&(this._activeSelectionMode=2,this._selectLineAt(k[1]))}shouldColumnSelect(I){return I.altKey&&!(E.isMac&&this._optionsService.rawOptions.macOptionClickForcesSelection)}_handleMouseMove(I){if(I.stopImmediatePropagation(),!this._model.selectionStart)return;const k=this._model.selectionEnd?[this._model.selectionEnd[0],this._model.selectionEnd[1]]:null;if(this._model.selectionEnd=this._getMouseBufferCoords(I),!this._model.selectionEnd)return void this.refresh(true);this._activeSelectionMode===2?this._model.selectionEnd[1]<this._model.selectionStart[1]?this._model.selectionEnd[0]=0:this._model.selectionEnd[0]=this._bufferService.cols:this._activeSelectionMode===1&&this._selectToWordAt(this._model.selectionEnd),this._dragScrollAmount=this._getMouseEventScrollAmount(I),this._activeSelectionMode!==3&&(this._dragScrollAmount>0?this._model.selectionEnd[0]=this._bufferService.cols:this._dragScrollAmount<0&&(this._model.selectionEnd[0]=0));const x=this._bufferService.buffer;if(this._model.selectionEnd[1]<x.lines.length){const P=x.lines.get(this._model.selectionEnd[1]);P&&P.hasWidth(this._model.selectionEnd[0])===0&&this._model.selectionEnd[0]++}k&&k[0]===this._model.selectionEnd[0]&&k[1]===this._model.selectionEnd[1]||this.refresh(true)}_dragScroll(){if(this._model.selectionEnd&&this._model.selectionStart&&this._dragScrollAmount){this._onRequestScrollLines.fire({amount:this._dragScrollAmount,suppressScrollEvent:false});const I=this._bufferService.buffer;this._dragScrollAmount>0?(this._activeSelectionMode!==3&&(this._model.selectionEnd[0]=this._bufferService.cols),this._model.selectionEnd[1]=Math.min(I.ydisp+this._bufferService.rows,I.lines.length-1)):(this._activeSelectionMode!==3&&(this._model.selectionEnd[0]=0),this._model.selectionEnd[1]=I.ydisp),this.refresh()}}_handleMouseUp(I){const k=I.timeStamp-this._mouseDownTimeStamp;if(this._removeMouseDownListeners(),this.selectionText.length<=1&&k<500&&I.altKey&&this._optionsService.rawOptions.altClickMovesCursor){if(this._bufferService.buffer.ybase===this._bufferService.buffer.ydisp){const x=this._mouseService.getCoords(I,this._element,this._bufferService.cols,this._bufferService.rows,false);if(x&&x[0]!==void 0&&x[1]!==void 0){const P=(0,T.moveToCellSequence)(x[0]-1,x[1]-1,this._bufferService,this._coreService.decPrivateModes.applicationCursorKeys);this._coreService.triggerDataEvent(P,true)}}}else this._fireEventIfSelectionChanged()}_fireEventIfSelectionChanged(){const I=this._model.finalSelectionStart,k=this._model.finalSelectionEnd,x=!(!I||!k||I[0]===k[0]&&I[1]===k[1]);x?I&&k&&(this._oldSelectionStart&&this._oldSelectionEnd&&I[0]===this._oldSelectionStart[0]&&I[1]===this._oldSelectionStart[1]&&k[0]===this._oldSelectionEnd[0]&&k[1]===this._oldSelectionEnd[1]||this._fireOnSelectionChange(I,k,x)):this._oldHasSelection&&this._fireOnSelectionChange(I,k,x)}_fireOnSelectionChange(I,k,x){this._oldSelectionStart=I,this._oldSelectionEnd=k,this._oldHasSelection=x,this._onSelectionChange.fire()}_handleBufferActivate(I){this.clearSelection(),this._trimListener.dispose(),this._trimListener=I.activeBuffer.lines.onTrim(k=>this._handleTrim(k))}_convertViewportColToCharacterIndex(I,k){let x=k;for(let P=0;k>=P;P++){const F=I.loadCell(P,this._workCell).getChars().length;this._workCell.getWidth()===0?x--:F>1&&k!==P&&(x+=F-1)}return x}setSelection(I,k,x){this._model.clearSelection(),this._removeMouseDownListeners(),this._model.selectionStart=[I,k],this._model.selectionStartLength=x,this.refresh(),this._fireEventIfSelectionChanged()}rightClickSelect(I){this._isClickInSelection(I)||(this._selectWordAtCursor(I,false)&&this.refresh(true),this._fireEventIfSelectionChanged())}_getWordAt(I,k,x=true,P=true){if(I[0]>=this._bufferService.cols)return;const F=this._bufferService.buffer,X=F.lines.get(I[1]);if(!X)return;const W=F.translateBufferLineToString(I[1],false);let z=this._convertViewportColToCharacterIndex(X,I[0]),j=z;const J=I[0]-z;let M=0,U=0,V=0,K=0;if(W.charAt(z)===" "){for(;z>0&&W.charAt(z-1)===" ";)z--;for(;j<W.length&&W.charAt(j+1)===" ";)j++}else{let Ie=I[0],he=I[0];X.getWidth(Ie)===0&&(M++,Ie--),X.getWidth(he)===2&&(U++,he++);const st=X.getString(he).length;for(st>1&&(K+=st-1,j+=st-1);Ie>0&&z>0&&!this._isCharWordSeparator(X.loadCell(Ie-1,this._workCell));){X.loadCell(Ie-1,this._workCell);const B=this._workCell.getChars().length;this._workCell.getWidth()===0?(M++,Ie--):B>1&&(V+=B-1,z-=B-1),z--,Ie--}for(;he<X.length&&j+1<W.length&&!this._isCharWordSeparator(X.loadCell(he+1,this._workCell));){X.loadCell(he+1,this._workCell);const B=this._workCell.getChars().length;this._workCell.getWidth()===2?(U++,he++):B>1&&(K+=B-1,j+=B-1),j++,he++}}j++;let H=z+J-M+V,ie=Math.min(this._bufferService.cols,j-z+M+U-V-K);if(k||W.slice(z,j).trim()!==""){if(x&&H===0&&X.getCodePoint(0)!==32){const Ie=F.lines.get(I[1]-1);if(Ie&&X.isWrapped&&Ie.getCodePoint(this._bufferService.cols-1)!==32){const he=this._getWordAt([this._bufferService.cols-1,I[1]-1],false,true,false);if(he){const st=this._bufferService.cols-he.start;H-=st,ie+=st}}}if(P&&H+ie===this._bufferService.cols&&X.getCodePoint(this._bufferService.cols-1)!==32){const Ie=F.lines.get(I[1]+1);if(Ie!=null&&Ie.isWrapped&&Ie.getCodePoint(0)!==32){const he=this._getWordAt([0,I[1]+1],false,false,true);he&&(ie+=he.length)}}return{start:H,length:ie}}}_selectWordAt(I,k){const x=this._getWordAt(I,k);if(x){for(;x.start<0;)x.start+=this._bufferService.cols,I[1]--;this._model.selectionStart=[x.start,I[1]],this._model.selectionStartLength=x.length}}_selectToWordAt(I){const k=this._getWordAt(I,true);if(k){let x=I[1];for(;k.start<0;)k.start+=this._bufferService.cols,x--;if(!this._model.areSelectionValuesReversed())for(;k.start+k.length>this._bufferService.cols;)k.length-=this._bufferService.cols,x++;this._model.selectionEnd=[this._model.areSelectionValuesReversed()?k.start:k.start+k.length,x]}}_isCharWordSeparator(I){return I.getWidth()!==0&&this._optionsService.rawOptions.wordSeparator.indexOf(I.getChars())>=0}_selectLineAt(I){const k=this._bufferService.buffer.getWrappedRangeForLine(I),x={start:{x:0,y:k.first},end:{x:this._bufferService.cols-1,y:k.last}};this._model.selectionStart=[0,k.first],this._model.selectionEnd=void 0,this._model.selectionStartLength=(0,v.getRangeLength)(x,this._bufferService.cols)}};u.SelectionService=L=c([h(3,R.IBufferService),h(4,R.ICoreService),h(5,S.IMouseService),h(6,R.IOptionsService),h(7,S.IRenderService),h(8,S.ICoreBrowserService)],L)},4725:(m,u,_)=>{Object.defineProperty(u,"__esModule",{value:true}),u.IThemeService=u.ICharacterJoinerService=u.ISelectionService=u.IRenderService=u.IMouseService=u.ICoreBrowserService=u.ICharSizeService=void 0;const c=_(8343);u.ICharSizeService=(0,c.createDecorator)("CharSizeService"),u.ICoreBrowserService=(0,c.createDecorator)("CoreBrowserService"),u.IMouseService=(0,c.createDecorator)("MouseService"),u.IRenderService=(0,c.createDecorator)("RenderService"),u.ISelectionService=(0,c.createDecorator)("SelectionService"),u.ICharacterJoinerService=(0,c.createDecorator)("CharacterJoinerService"),u.IThemeService=(0,c.createDecorator)("ThemeService")},6731:function(m,u,_){var c=this&&this.__decorate||function(L,I,k,x){var P,F=arguments.length,X=F<3?I:x===null?x=Object.getOwnPropertyDescriptor(I,k):x;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")X=Reflect.decorate(L,I,k,x);else for(var W=L.length-1;W>=0;W--)(P=L[W])&&(X=(F<3?P(X):F>3?P(I,k,X):P(I,k))||X);return F>3&&X&&Object.defineProperty(I,k,X),X},h=this&&this.__param||function(L,I){return function(k,x){I(k,x,L)}};Object.defineProperty(u,"__esModule",{value:true}),u.ThemeService=u.DEFAULT_ANSI_COLORS=void 0;const p=_(7239),T=_(8055),$=_(8460),S=_(844),y=_(2585),g=T.css.toColor("#ffffff"),E=T.css.toColor("#000000"),v=T.css.toColor("#ffffff"),b=T.css.toColor("#000000"),R={css:"rgba(255, 255, 255, 0.3)",rgba:4294967117};u.DEFAULT_ANSI_COLORS=Object.freeze((()=>{const L=[T.css.toColor("#2e3436"),T.css.toColor("#cc0000"),T.css.toColor("#4e9a06"),T.css.toColor("#c4a000"),T.css.toColor("#3465a4"),T.css.toColor("#75507b"),T.css.toColor("#06989a"),T.css.toColor("#d3d7cf"),T.css.toColor("#555753"),T.css.toColor("#ef2929"),T.css.toColor("#8ae234"),T.css.toColor("#fce94f"),T.css.toColor("#729fcf"),T.css.toColor("#ad7fa8"),T.css.toColor("#34e2e2"),T.css.toColor("#eeeeec")],I=[0,95,135,175,215,255];for(let k=0;k<216;k++){const x=I[k/36%6|0],P=I[k/6%6|0],F=I[k%6];L.push({css:T.channels.toCss(x,P,F),rgba:T.channels.toRgba(x,P,F)})}for(let k=0;k<24;k++){const x=8+10*k;L.push({css:T.channels.toCss(x,x,x),rgba:T.channels.toRgba(x,x,x)})}return L})());let O=u.ThemeService=class extends S.Disposable{get colors(){return this._colors}constructor(L){super(),this._optionsService=L,this._contrastCache=new p.ColorContrastCache,this._halfContrastCache=new p.ColorContrastCache,this._onChangeColors=this.register(new $.EventEmitter),this.onChangeColors=this._onChangeColors.event,this._colors={foreground:g,background:E,cursor:v,cursorAccent:b,selectionForeground:void 0,selectionBackgroundTransparent:R,selectionBackgroundOpaque:T.color.blend(E,R),selectionInactiveBackgroundTransparent:R,selectionInactiveBackgroundOpaque:T.color.blend(E,R),ansi:u.DEFAULT_ANSI_COLORS.slice(),contrastCache:this._contrastCache,halfContrastCache:this._halfContrastCache},this._updateRestoreColors(),this._setTheme(this._optionsService.rawOptions.theme),this.register(this._optionsService.onSpecificOptionChange("minimumContrastRatio",()=>this._contrastCache.clear())),this.register(this._optionsService.onSpecificOptionChange("theme",()=>this._setTheme(this._optionsService.rawOptions.theme)))}_setTheme(L={}){const I=this._colors;if(I.foreground=w(L.foreground,g),I.background=w(L.background,E),I.cursor=w(L.cursor,v),I.cursorAccent=w(L.cursorAccent,b),I.selectionBackgroundTransparent=w(L.selectionBackground,R),I.selectionBackgroundOpaque=T.color.blend(I.background,I.selectionBackgroundTransparent),I.selectionInactiveBackgroundTransparent=w(L.selectionInactiveBackground,I.selectionBackgroundTransparent),I.selectionInactiveBackgroundOpaque=T.color.blend(I.background,I.selectionInactiveBackgroundTransparent),I.selectionForeground=L.selectionForeground?w(L.selectionForeground,T.NULL_COLOR):void 0,I.selectionForeground===T.NULL_COLOR&&(I.selectionForeground=void 0),T.color.isOpaque(I.selectionBackgroundTransparent)&&(I.selectionBackgroundTransparent=T.color.opacity(I.selectionBackgroundTransparent,.3)),T.color.isOpaque(I.selectionInactiveBackgroundTransparent)&&(I.selectionInactiveBackgroundTransparent=T.color.opacity(I.selectionInactiveBackgroundTransparent,.3)),I.ansi=u.DEFAULT_ANSI_COLORS.slice(),I.ansi[0]=w(L.black,u.DEFAULT_ANSI_COLORS[0]),I.ansi[1]=w(L.red,u.DEFAULT_ANSI_COLORS[1]),I.ansi[2]=w(L.green,u.DEFAULT_ANSI_COLORS[2]),I.ansi[3]=w(L.yellow,u.DEFAULT_ANSI_COLORS[3]),I.ansi[4]=w(L.blue,u.DEFAULT_ANSI_COLORS[4]),I.ansi[5]=w(L.magenta,u.DEFAULT_ANSI_COLORS[5]),I.ansi[6]=w(L.cyan,u.DEFAULT_ANSI_COLORS[6]),I.ansi[7]=w(L.white,u.DEFAULT_ANSI_COLORS[7]),I.ansi[8]=w(L.brightBlack,u.DEFAULT_ANSI_COLORS[8]),I.ansi[9]=w(L.brightRed,u.DEFAULT_ANSI_COLORS[9]),I.ansi[10]=w(L.brightGreen,u.DEFAULT_ANSI_COLORS[10]),I.ansi[11]=w(L.brightYellow,u.DEFAULT_ANSI_COLORS[11]),I.ansi[12]=w(L.brightBlue,u.DEFAULT_ANSI_COLORS[12]),I.ansi[13]=w(L.brightMagenta,u.DEFAULT_ANSI_COLORS[13]),I.ansi[14]=w(L.brightCyan,u.DEFAULT_ANSI_COLORS[14]),I.ansi[15]=w(L.brightWhite,u.DEFAULT_ANSI_COLORS[15]),L.extendedAnsi){const k=Math.min(I.ansi.length-16,L.extendedAnsi.length);for(let x=0;x<k;x++)I.ansi[x+16]=w(L.extendedAnsi[x],u.DEFAULT_ANSI_COLORS[x+16])}this._contrastCache.clear(),this._halfContrastCache.clear(),this._updateRestoreColors(),this._onChangeColors.fire(this.colors)}restoreColor(L){this._restoreColor(L),this._onChangeColors.fire(this.colors)}_restoreColor(L){if(L!==void 0)switch(L){case 256:this._colors.foreground=this._restoreColors.foreground;break;case 257:this._colors.background=this._restoreColors.background;break;case 258:this._colors.cursor=this._restoreColors.cursor;break;default:this._colors.ansi[L]=this._restoreColors.ansi[L]}else for(let I=0;I<this._restoreColors.ansi.length;++I)this._colors.ansi[I]=this._restoreColors.ansi[I]}modifyColors(L){L(this._colors),this._onChangeColors.fire(this.colors)}_updateRestoreColors(){this._restoreColors={foreground:this._colors.foreground,background:this._colors.background,cursor:this._colors.cursor,ansi:this._colors.ansi.slice()}}};function w(L,I){if(L!==void 0)try{return T.css.toColor(L)}catch{}return I}u.ThemeService=O=c([h(0,y.IOptionsService)],O)},6349:(m,u,_)=>{Object.defineProperty(u,"__esModule",{value:true}),u.CircularList=void 0;const c=_(8460),h=_(844);class p extends h.Disposable{constructor($){super(),this._maxLength=$,this.onDeleteEmitter=this.register(new c.EventEmitter),this.onDelete=this.onDeleteEmitter.event,this.onInsertEmitter=this.register(new c.EventEmitter),this.onInsert=this.onInsertEmitter.event,this.onTrimEmitter=this.register(new c.EventEmitter),this.onTrim=this.onTrimEmitter.event,this._array=new Array(this._maxLength),this._startIndex=0,this._length=0}get maxLength(){return this._maxLength}set maxLength($){if(this._maxLength===$)return;const S=new Array($);for(let y=0;y<Math.min($,this.length);y++)S[y]=this._array[this._getCyclicIndex(y)];this._array=S,this._maxLength=$,this._startIndex=0}get length(){return this._length}set length($){if($>this._length)for(let S=this._length;S<$;S++)this._array[S]=void 0;this._length=$}get($){return this._array[this._getCyclicIndex($)]}set($,S){this._array[this._getCyclicIndex($)]=S}push($){this._array[this._getCyclicIndex(this._length)]=$,this._length===this._maxLength?(this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1)):this._length++}recycle(){if(this._length!==this._maxLength)throw new Error("Can only recycle when the buffer is full");return this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1),this._array[this._getCyclicIndex(this._length-1)]}get isFull(){return this._length===this._maxLength}pop(){return this._array[this._getCyclicIndex(this._length---1)]}splice($,S,...y){if(S){for(let g=$;g<this._length-S;g++)this._array[this._getCyclicIndex(g)]=this._array[this._getCyclicIndex(g+S)];this._length-=S,this.onDeleteEmitter.fire({index:$,amount:S})}for(let g=this._length-1;g>=$;g--)this._array[this._getCyclicIndex(g+y.length)]=this._array[this._getCyclicIndex(g)];for(let g=0;g<y.length;g++)this._array[this._getCyclicIndex($+g)]=y[g];if(y.length&&this.onInsertEmitter.fire({index:$,amount:y.length}),this._length+y.length>this._maxLength){const g=this._length+y.length-this._maxLength;this._startIndex+=g,this._length=this._maxLength,this.onTrimEmitter.fire(g)}else this._length+=y.length}trimStart($){$>this._length&&($=this._length),this._startIndex+=$,this._length-=$,this.onTrimEmitter.fire($)}shiftElements($,S,y){if(!(S<=0)){if($<0||$>=this._length)throw new Error("start argument out of range");if($+y<0)throw new Error("Cannot shift elements in list beyond index 0");if(y>0){for(let E=S-1;E>=0;E--)this.set($+E+y,this.get($+E));const g=$+S+y-this._length;if(g>0)for(this._length+=g;this._length>this._maxLength;)this._length--,this._startIndex++,this.onTrimEmitter.fire(1)}else for(let g=0;g<S;g++)this.set($+g+y,this.get($+g))}}_getCyclicIndex($){return(this._startIndex+$)%this._maxLength}}u.CircularList=p},1439:(m,u)=>{Object.defineProperty(u,"__esModule",{value:true}),u.clone=void 0,u.clone=function _(c,h=5){if(typeof c!="object")return c;const p=Array.isArray(c)?[]:{};for(const T in c)p[T]=h<=1?c[T]:c[T]&&_(c[T],h-1);return p}},8055:(m,u,_)=>{Object.defineProperty(u,"__esModule",{value:true}),u.contrastRatio=u.toPaddedHex=u.rgba=u.rgb=u.css=u.color=u.channels=u.NULL_COLOR=void 0;const c=_(6114);let h=0,p=0,T=0,$=0;var S,y,g,E,v;function b(O){const w=O.toString(16);return w.length<2?"0"+w:w}function R(O,w){return O<w?(w+.05)/(O+.05):(O+.05)/(w+.05)}u.NULL_COLOR={css:"#00000000",rgba:0},function(O){O.toCss=function(w,L,I,k){return k!==void 0?`#${b(w)}${b(L)}${b(I)}${b(k)}`:`#${b(w)}${b(L)}${b(I)}`},O.toRgba=function(w,L,I,k=255){return(w<<24|L<<16|I<<8|k)>>>0}}(S||(u.channels=S={})),function(O){function w(L,I){return $=Math.round(255*I),[h,p,T]=v.toChannels(L.rgba),{css:S.toCss(h,p,T,$),rgba:S.toRgba(h,p,T,$)}}O.blend=function(L,I){if($=(255&I.rgba)/255,$===1)return{css:I.css,rgba:I.rgba};const k=I.rgba>>24&255,x=I.rgba>>16&255,P=I.rgba>>8&255,F=L.rgba>>24&255,X=L.rgba>>16&255,W=L.rgba>>8&255;return h=F+Math.round((k-F)*$),p=X+Math.round((x-X)*$),T=W+Math.round((P-W)*$),{css:S.toCss(h,p,T),rgba:S.toRgba(h,p,T)}},O.isOpaque=function(L){return(255&L.rgba)==255},O.ensureContrastRatio=function(L,I,k){const x=v.ensureContrastRatio(L.rgba,I.rgba,k);if(x)return v.toColor(x>>24&255,x>>16&255,x>>8&255)},O.opaque=function(L){const I=(255|L.rgba)>>>0;return[h,p,T]=v.toChannels(I),{css:S.toCss(h,p,T),rgba:I}},O.opacity=w,O.multiplyOpacity=function(L,I){return $=255&L.rgba,w(L,$*I/255)},O.toColorRGB=function(L){return[L.rgba>>24&255,L.rgba>>16&255,L.rgba>>8&255]}}(y||(u.color=y={})),function(O){let w,L;if(!c.isNode){const I=document.createElement("canvas");I.width=1,I.height=1;const k=I.getContext("2d",{willReadFrequently:true});k&&(w=k,w.globalCompositeOperation="copy",L=w.createLinearGradient(0,0,1,1))}O.toColor=function(I){if(I.match(/#[\da-f]{3,8}/i))switch(I.length){case 4:return h=parseInt(I.slice(1,2).repeat(2),16),p=parseInt(I.slice(2,3).repeat(2),16),T=parseInt(I.slice(3,4).repeat(2),16),v.toColor(h,p,T);case 5:return h=parseInt(I.slice(1,2).repeat(2),16),p=parseInt(I.slice(2,3).repeat(2),16),T=parseInt(I.slice(3,4).repeat(2),16),$=parseInt(I.slice(4,5).repeat(2),16),v.toColor(h,p,T,$);case 7:return{css:I,rgba:(parseInt(I.slice(1),16)<<8|255)>>>0};case 9:return{css:I,rgba:parseInt(I.slice(1),16)>>>0}}const k=I.match(/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(,\s*(0|1|\d?\.(\d+))\s*)?\)/);if(k)return h=parseInt(k[1]),p=parseInt(k[2]),T=parseInt(k[3]),$=Math.round(255*(k[5]===void 0?1:parseFloat(k[5]))),v.toColor(h,p,T,$);if(!w||!L)throw new Error("css.toColor: Unsupported css format");if(w.fillStyle=L,w.fillStyle=I,typeof w.fillStyle!="string")throw new Error("css.toColor: Unsupported css format");if(w.fillRect(0,0,1,1),[h,p,T,$]=w.getImageData(0,0,1,1).data,$!==255)throw new Error("css.toColor: Unsupported css format");return{rgba:S.toRgba(h,p,T,$),css:I}}}(g||(u.css=g={})),function(O){function w(L,I,k){const x=L/255,P=I/255,F=k/255;return .2126*(x<=.03928?x/12.92:Math.pow((x+.055)/1.055,2.4))+.7152*(P<=.03928?P/12.92:Math.pow((P+.055)/1.055,2.4))+.0722*(F<=.03928?F/12.92:Math.pow((F+.055)/1.055,2.4))}O.relativeLuminance=function(L){return w(L>>16&255,L>>8&255,255&L)},O.relativeLuminance2=w}(E||(u.rgb=E={})),function(O){function w(I,k,x){const P=I>>24&255,F=I>>16&255,X=I>>8&255;let W=k>>24&255,z=k>>16&255,j=k>>8&255,J=R(E.relativeLuminance2(W,z,j),E.relativeLuminance2(P,F,X));for(;J<x&&(W>0||z>0||j>0);)W-=Math.max(0,Math.ceil(.1*W)),z-=Math.max(0,Math.ceil(.1*z)),j-=Math.max(0,Math.ceil(.1*j)),J=R(E.relativeLuminance2(W,z,j),E.relativeLuminance2(P,F,X));return(W<<24|z<<16|j<<8|255)>>>0}function L(I,k,x){const P=I>>24&255,F=I>>16&255,X=I>>8&255;let W=k>>24&255,z=k>>16&255,j=k>>8&255,J=R(E.relativeLuminance2(W,z,j),E.relativeLuminance2(P,F,X));for(;J<x&&(W<255||z<255||j<255);)W=Math.min(255,W+Math.ceil(.1*(255-W))),z=Math.min(255,z+Math.ceil(.1*(255-z))),j=Math.min(255,j+Math.ceil(.1*(255-j))),J=R(E.relativeLuminance2(W,z,j),E.relativeLuminance2(P,F,X));return(W<<24|z<<16|j<<8|255)>>>0}O.ensureContrastRatio=function(I,k,x){const P=E.relativeLuminance(I>>8),F=E.relativeLuminance(k>>8);if(R(P,F)<x){if(F<P){const z=w(I,k,x),j=R(P,E.relativeLuminance(z>>8));if(j<x){const J=L(I,k,x);return j>R(P,E.relativeLuminance(J>>8))?z:J}return z}const X=L(I,k,x),W=R(P,E.relativeLuminance(X>>8));if(W<x){const z=w(I,k,x);return W>R(P,E.relativeLuminance(z>>8))?X:z}return X}},O.reduceLuminance=w,O.increaseLuminance=L,O.toChannels=function(I){return[I>>24&255,I>>16&255,I>>8&255,255&I]},O.toColor=function(I,k,x,P){return{css:S.toCss(I,k,x,P),rgba:S.toRgba(I,k,x,P)}}}(v||(u.rgba=v={})),u.toPaddedHex=b,u.contrastRatio=R},8969:(m,u,_)=>{Object.defineProperty(u,"__esModule",{value:true}),u.CoreTerminal=void 0;const c=_(844),h=_(2585),p=_(4348),T=_(7866),$=_(744),S=_(7302),y=_(6975),g=_(8460),E=_(1753),v=_(1480),b=_(7994),R=_(9282),O=_(5435),w=_(5981),L=_(2660);let I=false;class k extends c.Disposable{get onScroll(){return this._onScrollApi||(this._onScrollApi=this.register(new g.EventEmitter),this._onScroll.event(P=>{var F;(F=this._onScrollApi)===null||F===void 0||F.fire(P.position)})),this._onScrollApi.event}get cols(){return this._bufferService.cols}get rows(){return this._bufferService.rows}get buffers(){return this._bufferService.buffers}get options(){return this.optionsService.options}set options(P){for(const F in P)this.optionsService.options[F]=P[F]}constructor(P){super(),this._windowsWrappingHeuristics=this.register(new c.MutableDisposable),this._onBinary=this.register(new g.EventEmitter),this.onBinary=this._onBinary.event,this._onData=this.register(new g.EventEmitter),this.onData=this._onData.event,this._onLineFeed=this.register(new g.EventEmitter),this.onLineFeed=this._onLineFeed.event,this._onResize=this.register(new g.EventEmitter),this.onResize=this._onResize.event,this._onWriteParsed=this.register(new g.EventEmitter),this.onWriteParsed=this._onWriteParsed.event,this._onScroll=this.register(new g.EventEmitter),this._instantiationService=new p.InstantiationService,this.optionsService=this.register(new S.OptionsService(P)),this._instantiationService.setService(h.IOptionsService,this.optionsService),this._bufferService=this.register(this._instantiationService.createInstance($.BufferService)),this._instantiationService.setService(h.IBufferService,this._bufferService),this._logService=this.register(this._instantiationService.createInstance(T.LogService)),this._instantiationService.setService(h.ILogService,this._logService),this.coreService=this.register(this._instantiationService.createInstance(y.CoreService)),this._instantiationService.setService(h.ICoreService,this.coreService),this.coreMouseService=this.register(this._instantiationService.createInstance(E.CoreMouseService)),this._instantiationService.setService(h.ICoreMouseService,this.coreMouseService),this.unicodeService=this.register(this._instantiationService.createInstance(v.UnicodeService)),this._instantiationService.setService(h.IUnicodeService,this.unicodeService),this._charsetService=this._instantiationService.createInstance(b.CharsetService),this._instantiationService.setService(h.ICharsetService,this._charsetService),this._oscLinkService=this._instantiationService.createInstance(L.OscLinkService),this._instantiationService.setService(h.IOscLinkService,this._oscLinkService),this._inputHandler=this.register(new O.InputHandler(this._bufferService,this._charsetService,this.coreService,this._logService,this.optionsService,this._oscLinkService,this.coreMouseService,this.unicodeService)),this.register((0,g.forwardEvent)(this._inputHandler.onLineFeed,this._onLineFeed)),this.register(this._inputHandler),this.register((0,g.forwardEvent)(this._bufferService.onResize,this._onResize)),this.register((0,g.forwardEvent)(this.coreService.onData,this._onData)),this.register((0,g.forwardEvent)(this.coreService.onBinary,this._onBinary)),this.register(this.coreService.onRequestScrollToBottom(()=>this.scrollToBottom())),this.register(this.coreService.onUserInput(()=>this._writeBuffer.handleUserInput())),this.register(this.optionsService.onMultipleOptionChange(["windowsMode","windowsPty"],()=>this._handleWindowsPtyOptionChange())),this.register(this._bufferService.onScroll(F=>{this._onScroll.fire({position:this._bufferService.buffer.ydisp,source:0}),this._inputHandler.markRangeDirty(this._bufferService.buffer.scrollTop,this._bufferService.buffer.scrollBottom)})),this.register(this._inputHandler.onScroll(F=>{this._onScroll.fire({position:this._bufferService.buffer.ydisp,source:0}),this._inputHandler.markRangeDirty(this._bufferService.buffer.scrollTop,this._bufferService.buffer.scrollBottom)})),this._writeBuffer=this.register(new w.WriteBuffer((F,X)=>this._inputHandler.parse(F,X))),this.register((0,g.forwardEvent)(this._writeBuffer.onWriteParsed,this._onWriteParsed))}write(P,F){this._writeBuffer.write(P,F)}writeSync(P,F){this._logService.logLevel<=h.LogLevelEnum.WARN&&!I&&(this._logService.warn("writeSync is unreliable and will be removed soon."),I=true),this._writeBuffer.writeSync(P,F)}resize(P,F){isNaN(P)||isNaN(F)||(P=Math.max(P,$.MINIMUM_COLS),F=Math.max(F,$.MINIMUM_ROWS),this._bufferService.resize(P,F))}scroll(P,F=false){this._bufferService.scroll(P,F)}scrollLines(P,F,X){this._bufferService.scrollLines(P,F,X)}scrollPages(P){this.scrollLines(P*(this.rows-1))}scrollToTop(){this.scrollLines(-this._bufferService.buffer.ydisp)}scrollToBottom(){this.scrollLines(this._bufferService.buffer.ybase-this._bufferService.buffer.ydisp)}scrollToLine(P){const F=P-this._bufferService.buffer.ydisp;F!==0&&this.scrollLines(F)}registerEscHandler(P,F){return this._inputHandler.registerEscHandler(P,F)}registerDcsHandler(P,F){return this._inputHandler.registerDcsHandler(P,F)}registerCsiHandler(P,F){return this._inputHandler.registerCsiHandler(P,F)}registerOscHandler(P,F){return this._inputHandler.registerOscHandler(P,F)}_setup(){this._handleWindowsPtyOptionChange()}reset(){this._inputHandler.reset(),this._bufferService.reset(),this._charsetService.reset(),this.coreService.reset(),this.coreMouseService.reset()}_handleWindowsPtyOptionChange(){let P=false;const F=this.optionsService.rawOptions.windowsPty;F&&F.buildNumber!==void 0&&F.buildNumber!==void 0?P=F.backend==="conpty"&&F.buildNumber<21376:this.optionsService.rawOptions.windowsMode&&(P=true),P?this._enableWindowsWrappingHeuristics():this._windowsWrappingHeuristics.clear()}_enableWindowsWrappingHeuristics(){if(!this._windowsWrappingHeuristics.value){const P=[];P.push(this.onLineFeed(R.updateWindowsModeWrappedState.bind(null,this._bufferService))),P.push(this.registerCsiHandler({final:"H"},()=>((0,R.updateWindowsModeWrappedState)(this._bufferService),false))),this._windowsWrappingHeuristics.value=(0,c.toDisposable)(()=>{for(const F of P)F.dispose()})}}}u.CoreTerminal=k},8460:(m,u)=>{Object.defineProperty(u,"__esModule",{value:true}),u.forwardEvent=u.EventEmitter=void 0,u.EventEmitter=class{constructor(){this._listeners=[],this._disposed=false}get event(){return this._event||(this._event=_=>(this._listeners.push(_),{dispose:()=>{if(!this._disposed){for(let c=0;c<this._listeners.length;c++)if(this._listeners[c]===_)return void this._listeners.splice(c,1)}}})),this._event}fire(_,c){const h=[];for(let p=0;p<this._listeners.length;p++)h.push(this._listeners[p]);for(let p=0;p<h.length;p++)h[p].call(void 0,_,c)}dispose(){this.clearListeners(),this._disposed=true}clearListeners(){this._listeners&&(this._listeners.length=0)}},u.forwardEvent=function(_,c){return _(h=>c.fire(h))}},5435:function(m,u,_){var c=this&&this.__decorate||function(J,M,U,V){var K,H=arguments.length,ie=H<3?M:V===null?V=Object.getOwnPropertyDescriptor(M,U):V;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")ie=Reflect.decorate(J,M,U,V);else for(var Ie=J.length-1;Ie>=0;Ie--)(K=J[Ie])&&(ie=(H<3?K(ie):H>3?K(M,U,ie):K(M,U))||ie);return H>3&&ie&&Object.defineProperty(M,U,ie),ie},h=this&&this.__param||function(J,M){return function(U,V){M(U,V,J)}};Object.defineProperty(u,"__esModule",{value:true}),u.InputHandler=u.WindowsOptionsReportType=void 0;const p=_(2584),T=_(7116),$=_(2015),S=_(844),y=_(482),g=_(8437),E=_(8460),v=_(643),b=_(511),R=_(3734),O=_(2585),w=_(6242),L=_(6351),I=_(5941),k={"(":0,")":1,"*":2,"+":3,"-":1,".":2},x=131072;function P(J,M){if(J>24)return M.setWinLines||false;switch(J){case 1:return!!M.restoreWin;case 2:return!!M.minimizeWin;case 3:return!!M.setWinPosition;case 4:return!!M.setWinSizePixels;case 5:return!!M.raiseWin;case 6:return!!M.lowerWin;case 7:return!!M.refreshWin;case 8:return!!M.setWinSizeChars;case 9:return!!M.maximizeWin;case 10:return!!M.fullscreenWin;case 11:return!!M.getWinState;case 13:return!!M.getWinPosition;case 14:return!!M.getWinSizePixels;case 15:return!!M.getScreenSizePixels;case 16:return!!M.getCellSizePixels;case 18:return!!M.getWinSizeChars;case 19:return!!M.getScreenSizeChars;case 20:return!!M.getIconTitle;case 21:return!!M.getWinTitle;case 22:return!!M.pushTitle;case 23:return!!M.popTitle;case 24:return!!M.setWinLines}return false}var F;(function(J){J[J.GET_WIN_SIZE_PIXELS=0]="GET_WIN_SIZE_PIXELS",J[J.GET_CELL_SIZE_PIXELS=1]="GET_CELL_SIZE_PIXELS"})(F||(u.WindowsOptionsReportType=F={}));let X=0;class W extends S.Disposable{getAttrData(){return this._curAttrData}constructor(M,U,V,K,H,ie,Ie,he,st=new $.EscapeSequenceParser){super(),this._bufferService=M,this._charsetService=U,this._coreService=V,this._logService=K,this._optionsService=H,this._oscLinkService=ie,this._coreMouseService=Ie,this._unicodeService=he,this._parser=st,this._parseBuffer=new Uint32Array(4096),this._stringDecoder=new y.StringToUtf32,this._utf8Decoder=new y.Utf8ToUtf32,this._workCell=new b.CellData,this._windowTitle="",this._iconName="",this._windowTitleStack=[],this._iconNameStack=[],this._curAttrData=g.DEFAULT_ATTR_DATA.clone(),this._eraseAttrDataInternal=g.DEFAULT_ATTR_DATA.clone(),this._onRequestBell=this.register(new E.EventEmitter),this.onRequestBell=this._onRequestBell.event,this._onRequestRefreshRows=this.register(new E.EventEmitter),this.onRequestRefreshRows=this._onRequestRefreshRows.event,this._onRequestReset=this.register(new E.EventEmitter),this.onRequestReset=this._onRequestReset.event,this._onRequestSendFocus=this.register(new E.EventEmitter),this.onRequestSendFocus=this._onRequestSendFocus.event,this._onRequestSyncScrollBar=this.register(new E.EventEmitter),this.onRequestSyncScrollBar=this._onRequestSyncScrollBar.event,this._onRequestWindowsOptionsReport=this.register(new E.EventEmitter),this.onRequestWindowsOptionsReport=this._onRequestWindowsOptionsReport.event,this._onA11yChar=this.register(new E.EventEmitter),this.onA11yChar=this._onA11yChar.event,this._onA11yTab=this.register(new E.EventEmitter),this.onA11yTab=this._onA11yTab.event,this._onCursorMove=this.register(new E.EventEmitter),this.onCursorMove=this._onCursorMove.event,this._onLineFeed=this.register(new E.EventEmitter),this.onLineFeed=this._onLineFeed.event,this._onScroll=this.register(new E.EventEmitter),this.onScroll=this._onScroll.event,this._onTitleChange=this.register(new E.EventEmitter),this.onTitleChange=this._onTitleChange.event,this._onColor=this.register(new E.EventEmitter),this.onColor=this._onColor.event,this._parseStack={paused:false,cursorStartX:0,cursorStartY:0,decodedLength:0,position:0},this._specialColors=[256,257,258],this.register(this._parser),this._dirtyRowTracker=new z(this._bufferService),this._activeBuffer=this._bufferService.buffer,this.register(this._bufferService.buffers.onBufferActivate(B=>this._activeBuffer=B.activeBuffer)),this._parser.setCsiHandlerFallback((B,te)=>{this._logService.debug("Unknown CSI code: ",{identifier:this._parser.identToString(B),params:te.toArray()})}),this._parser.setEscHandlerFallback(B=>{this._logService.debug("Unknown ESC code: ",{identifier:this._parser.identToString(B)})}),this._parser.setExecuteHandlerFallback(B=>{this._logService.debug("Unknown EXECUTE code: ",{code:B})}),this._parser.setOscHandlerFallback((B,te,le)=>{this._logService.debug("Unknown OSC code: ",{identifier:B,action:te,data:le})}),this._parser.setDcsHandlerFallback((B,te,le)=>{te==="HOOK"&&(le=le.toArray()),this._logService.debug("Unknown DCS code: ",{identifier:this._parser.identToString(B),action:te,payload:le})}),this._parser.setPrintHandler((B,te,le)=>this.print(B,te,le)),this._parser.registerCsiHandler({final:"@"},B=>this.insertChars(B)),this._parser.registerCsiHandler({intermediates:" ",final:"@"},B=>this.scrollLeft(B)),this._parser.registerCsiHandler({final:"A"},B=>this.cursorUp(B)),this._parser.registerCsiHandler({intermediates:" ",final:"A"},B=>this.scrollRight(B)),this._parser.registerCsiHandler({final:"B"},B=>this.cursorDown(B)),this._parser.registerCsiHandler({final:"C"},B=>this.cursorForward(B)),this._parser.registerCsiHandler({final:"D"},B=>this.cursorBackward(B)),this._parser.registerCsiHandler({final:"E"},B=>this.cursorNextLine(B)),this._parser.registerCsiHandler({final:"F"},B=>this.cursorPrecedingLine(B)),this._parser.registerCsiHandler({final:"G"},B=>this.cursorCharAbsolute(B)),this._parser.registerCsiHandler({final:"H"},B=>this.cursorPosition(B)),this._parser.registerCsiHandler({final:"I"},B=>this.cursorForwardTab(B)),this._parser.registerCsiHandler({final:"J"},B=>this.eraseInDisplay(B,false)),this._parser.registerCsiHandler({prefix:"?",final:"J"},B=>this.eraseInDisplay(B,true)),this._parser.registerCsiHandler({final:"K"},B=>this.eraseInLine(B,false)),this._parser.registerCsiHandler({prefix:"?",final:"K"},B=>this.eraseInLine(B,true)),this._parser.registerCsiHandler({final:"L"},B=>this.insertLines(B)),this._parser.registerCsiHandler({final:"M"},B=>this.deleteLines(B)),this._parser.registerCsiHandler({final:"P"},B=>this.deleteChars(B)),this._parser.registerCsiHandler({final:"S"},B=>this.scrollUp(B)),this._parser.registerCsiHandler({final:"T"},B=>this.scrollDown(B)),this._parser.registerCsiHandler({final:"X"},B=>this.eraseChars(B)),this._parser.registerCsiHandler({final:"Z"},B=>this.cursorBackwardTab(B)),this._parser.registerCsiHandler({final:"`"},B=>this.charPosAbsolute(B)),this._parser.registerCsiHandler({final:"a"},B=>this.hPositionRelative(B)),this._parser.registerCsiHandler({final:"b"},B=>this.repeatPrecedingCharacter(B)),this._parser.registerCsiHandler({final:"c"},B=>this.sendDeviceAttributesPrimary(B)),this._parser.registerCsiHandler({prefix:">",final:"c"},B=>this.sendDeviceAttributesSecondary(B)),this._parser.registerCsiHandler({final:"d"},B=>this.linePosAbsolute(B)),this._parser.registerCsiHandler({final:"e"},B=>this.vPositionRelative(B)),this._parser.registerCsiHandler({final:"f"},B=>this.hVPosition(B)),this._parser.registerCsiHandler({final:"g"},B=>this.tabClear(B)),this._parser.registerCsiHandler({final:"h"},B=>this.setMode(B)),this._parser.registerCsiHandler({prefix:"?",final:"h"},B=>this.setModePrivate(B)),this._parser.registerCsiHandler({final:"l"},B=>this.resetMode(B)),this._parser.registerCsiHandler({prefix:"?",final:"l"},B=>this.resetModePrivate(B)),this._parser.registerCsiHandler({final:"m"},B=>this.charAttributes(B)),this._parser.registerCsiHandler({final:"n"},B=>this.deviceStatus(B)),this._parser.registerCsiHandler({prefix:"?",final:"n"},B=>this.deviceStatusPrivate(B)),this._parser.registerCsiHandler({intermediates:"!",final:"p"},B=>this.softReset(B)),this._parser.registerCsiHandler({intermediates:" ",final:"q"},B=>this.setCursorStyle(B)),this._parser.registerCsiHandler({final:"r"},B=>this.setScrollRegion(B)),this._parser.registerCsiHandler({final:"s"},B=>this.saveCursor(B)),this._parser.registerCsiHandler({final:"t"},B=>this.windowOptions(B)),this._parser.registerCsiHandler({final:"u"},B=>this.restoreCursor(B)),this._parser.registerCsiHandler({intermediates:"'",final:"}"},B=>this.insertColumns(B)),this._parser.registerCsiHandler({intermediates:"'",final:"~"},B=>this.deleteColumns(B)),this._parser.registerCsiHandler({intermediates:'"',final:"q"},B=>this.selectProtected(B)),this._parser.registerCsiHandler({intermediates:"$",final:"p"},B=>this.requestMode(B,true)),this._parser.registerCsiHandler({prefix:"?",intermediates:"$",final:"p"},B=>this.requestMode(B,false)),this._parser.setExecuteHandler(p.C0.BEL,()=>this.bell()),this._parser.setExecuteHandler(p.C0.LF,()=>this.lineFeed()),this._parser.setExecuteHandler(p.C0.VT,()=>this.lineFeed()),this._parser.setExecuteHandler(p.C0.FF,()=>this.lineFeed()),this._parser.setExecuteHandler(p.C0.CR,()=>this.carriageReturn()),this._parser.setExecuteHandler(p.C0.BS,()=>this.backspace()),this._parser.setExecuteHandler(p.C0.HT,()=>this.tab()),this._parser.setExecuteHandler(p.C0.SO,()=>this.shiftOut()),this._parser.setExecuteHandler(p.C0.SI,()=>this.shiftIn()),this._parser.setExecuteHandler(p.C1.IND,()=>this.index()),this._parser.setExecuteHandler(p.C1.NEL,()=>this.nextLine()),this._parser.setExecuteHandler(p.C1.HTS,()=>this.tabSet()),this._parser.registerOscHandler(0,new w.OscHandler(B=>(this.setTitle(B),this.setIconName(B),true))),this._parser.registerOscHandler(1,new w.OscHandler(B=>this.setIconName(B))),this._parser.registerOscHandler(2,new w.OscHandler(B=>this.setTitle(B))),this._parser.registerOscHandler(4,new w.OscHandler(B=>this.setOrReportIndexedColor(B))),this._parser.registerOscHandler(8,new w.OscHandler(B=>this.setHyperlink(B))),this._parser.registerOscHandler(10,new w.OscHandler(B=>this.setOrReportFgColor(B))),this._parser.registerOscHandler(11,new w.OscHandler(B=>this.setOrReportBgColor(B))),this._parser.registerOscHandler(12,new w.OscHandler(B=>this.setOrReportCursorColor(B))),this._parser.registerOscHandler(104,new w.OscHandler(B=>this.restoreIndexedColor(B))),this._parser.registerOscHandler(110,new w.OscHandler(B=>this.restoreFgColor(B))),this._parser.registerOscHandler(111,new w.OscHandler(B=>this.restoreBgColor(B))),this._parser.registerOscHandler(112,new w.OscHandler(B=>this.restoreCursorColor(B))),this._parser.registerEscHandler({final:"7"},()=>this.saveCursor()),this._parser.registerEscHandler({final:"8"},()=>this.restoreCursor()),this._parser.registerEscHandler({final:"D"},()=>this.index()),this._parser.registerEscHandler({final:"E"},()=>this.nextLine()),this._parser.registerEscHandler({final:"H"},()=>this.tabSet()),this._parser.registerEscHandler({final:"M"},()=>this.reverseIndex()),this._parser.registerEscHandler({final:"="},()=>this.keypadApplicationMode()),this._parser.registerEscHandler({final:">"},()=>this.keypadNumericMode()),this._parser.registerEscHandler({final:"c"},()=>this.fullReset()),this._parser.registerEscHandler({final:"n"},()=>this.setgLevel(2)),this._parser.registerEscHandler({final:"o"},()=>this.setgLevel(3)),this._parser.registerEscHandler({final:"|"},()=>this.setgLevel(3)),this._parser.registerEscHandler({final:"}"},()=>this.setgLevel(2)),this._parser.registerEscHandler({final:"~"},()=>this.setgLevel(1)),this._parser.registerEscHandler({intermediates:"%",final:"@"},()=>this.selectDefaultCharset()),this._parser.registerEscHandler({intermediates:"%",final:"G"},()=>this.selectDefaultCharset());for(const B in T.CHARSETS)this._parser.registerEscHandler({intermediates:"(",final:B},()=>this.selectCharset("("+B)),this._parser.registerEscHandler({intermediates:")",final:B},()=>this.selectCharset(")"+B)),this._parser.registerEscHandler({intermediates:"*",final:B},()=>this.selectCharset("*"+B)),this._parser.registerEscHandler({intermediates:"+",final:B},()=>this.selectCharset("+"+B)),this._parser.registerEscHandler({intermediates:"-",final:B},()=>this.selectCharset("-"+B)),this._parser.registerEscHandler({intermediates:".",final:B},()=>this.selectCharset("."+B)),this._parser.registerEscHandler({intermediates:"/",final:B},()=>this.selectCharset("/"+B));this._parser.registerEscHandler({intermediates:"#",final:"8"},()=>this.screenAlignmentPattern()),this._parser.setErrorHandler(B=>(this._logService.error("Parsing error: ",B),B)),this._parser.registerDcsHandler({intermediates:"$",final:"q"},new L.DcsHandler((B,te)=>this.requestStatusString(B,te)))}_preserveStack(M,U,V,K){this._parseStack.paused=true,this._parseStack.cursorStartX=M,this._parseStack.cursorStartY=U,this._parseStack.decodedLength=V,this._parseStack.position=K}_logSlowResolvingAsync(M){this._logService.logLevel<=O.LogLevelEnum.WARN&&Promise.race([M,new Promise((U,V)=>setTimeout(()=>V("#SLOW_TIMEOUT"),5e3))]).catch(U=>{if(U!=="#SLOW_TIMEOUT")throw U;console.warn("async parser handler taking longer than 5000 ms")})}_getCurrentLinkId(){return this._curAttrData.extended.urlId}parse(M,U){let V,K=this._activeBuffer.x,H=this._activeBuffer.y,ie=0;const Ie=this._parseStack.paused;if(Ie){if(V=this._parser.parse(this._parseBuffer,this._parseStack.decodedLength,U))return this._logSlowResolvingAsync(V),V;K=this._parseStack.cursorStartX,H=this._parseStack.cursorStartY,this._parseStack.paused=false,M.length>x&&(ie=this._parseStack.position+x)}if(this._logService.logLevel<=O.LogLevelEnum.DEBUG&&this._logService.debug("parsing data"+(typeof M=="string"?` "${M}"`:` "${Array.prototype.map.call(M,he=>String.fromCharCode(he)).join("")}"`),typeof M=="string"?M.split("").map(he=>he.charCodeAt(0)):M),this._parseBuffer.length<M.length&&this._parseBuffer.length<x&&(this._parseBuffer=new Uint32Array(Math.min(M.length,x))),Ie||this._dirtyRowTracker.clearRange(),M.length>x)for(let he=ie;he<M.length;he+=x){const st=he+x<M.length?he+x:M.length,B=typeof M=="string"?this._stringDecoder.decode(M.substring(he,st),this._parseBuffer):this._utf8Decoder.decode(M.subarray(he,st),this._parseBuffer);if(V=this._parser.parse(this._parseBuffer,B))return this._preserveStack(K,H,B,he),this._logSlowResolvingAsync(V),V}else if(!Ie){const he=typeof M=="string"?this._stringDecoder.decode(M,this._parseBuffer):this._utf8Decoder.decode(M,this._parseBuffer);if(V=this._parser.parse(this._parseBuffer,he))return this._preserveStack(K,H,he,0),this._logSlowResolvingAsync(V),V}this._activeBuffer.x===K&&this._activeBuffer.y===H||this._onCursorMove.fire(),this._onRequestRefreshRows.fire(this._dirtyRowTracker.start,this._dirtyRowTracker.end)}print(M,U,V){let K,H;const ie=this._charsetService.charset,Ie=this._optionsService.rawOptions.screenReaderMode,he=this._bufferService.cols,st=this._coreService.decPrivateModes.wraparound,B=this._coreService.modes.insertMode,te=this._curAttrData;let le=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._activeBuffer.x&&V-U>0&&le.getWidth(this._activeBuffer.x-1)===2&&le.setCellFromCodePoint(this._activeBuffer.x-1,0,1,te.fg,te.bg,te.extended);for(let ae=U;ae<V;++ae){if(K=M[ae],H=this._unicodeService.wcwidth(K),K<127&&ie){const Me=ie[String.fromCharCode(K)];Me&&(K=Me.charCodeAt(0))}if(Ie&&this._onA11yChar.fire((0,y.stringFromCodePoint)(K)),this._getCurrentLinkId()&&this._oscLinkService.addLineToLink(this._getCurrentLinkId(),this._activeBuffer.ybase+this._activeBuffer.y),H||!this._activeBuffer.x){if(this._activeBuffer.x+H-1>=he){if(st){for(;this._activeBuffer.x<he;)le.setCellFromCodePoint(this._activeBuffer.x++,0,1,te.fg,te.bg,te.extended);this._activeBuffer.x=0,this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData(),true)):(this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=true),le=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y)}else if(this._activeBuffer.x=he-1,H===2)continue}if(B&&(le.insertCells(this._activeBuffer.x,H,this._activeBuffer.getNullCell(te),te),le.getWidth(he-1)===2&&le.setCellFromCodePoint(he-1,v.NULL_CELL_CODE,v.NULL_CELL_WIDTH,te.fg,te.bg,te.extended)),le.setCellFromCodePoint(this._activeBuffer.x++,K,H,te.fg,te.bg,te.extended),H>0)for(;--H;)le.setCellFromCodePoint(this._activeBuffer.x++,0,0,te.fg,te.bg,te.extended)}else le.getWidth(this._activeBuffer.x-1)?le.addCodepointToCell(this._activeBuffer.x-1,K):le.addCodepointToCell(this._activeBuffer.x-2,K)}V-U>0&&(le.loadCell(this._activeBuffer.x-1,this._workCell),this._workCell.getWidth()===2||this._workCell.getCode()>65535?this._parser.precedingCodepoint=0:this._workCell.isCombined()?this._parser.precedingCodepoint=this._workCell.getChars().charCodeAt(0):this._parser.precedingCodepoint=this._workCell.content),this._activeBuffer.x<he&&V-U>0&&le.getWidth(this._activeBuffer.x)===0&&!le.hasContent(this._activeBuffer.x)&&le.setCellFromCodePoint(this._activeBuffer.x,0,1,te.fg,te.bg,te.extended),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}registerCsiHandler(M,U){return M.final!=="t"||M.prefix||M.intermediates?this._parser.registerCsiHandler(M,U):this._parser.registerCsiHandler(M,V=>!P(V.params[0],this._optionsService.rawOptions.windowOptions)||U(V))}registerDcsHandler(M,U){return this._parser.registerDcsHandler(M,new L.DcsHandler(U))}registerEscHandler(M,U){return this._parser.registerEscHandler(M,U)}registerOscHandler(M,U){return this._parser.registerOscHandler(M,new w.OscHandler(U))}bell(){return this._onRequestBell.fire(),true}lineFeed(){return this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._optionsService.rawOptions.convertEol&&(this._activeBuffer.x=0),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows?this._activeBuffer.y=this._bufferService.rows-1:this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=false,this._activeBuffer.x>=this._bufferService.cols&&this._activeBuffer.x--,this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._onLineFeed.fire(),true}carriageReturn(){return this._activeBuffer.x=0,true}backspace(){var M;if(!this._coreService.decPrivateModes.reverseWraparound)return this._restrictCursor(),this._activeBuffer.x>0&&this._activeBuffer.x--,true;if(this._restrictCursor(this._bufferService.cols),this._activeBuffer.x>0)this._activeBuffer.x--;else if(this._activeBuffer.x===0&&this._activeBuffer.y>this._activeBuffer.scrollTop&&this._activeBuffer.y<=this._activeBuffer.scrollBottom&&(!((M=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y))===null||M===void 0)&&M.isWrapped)){this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=false,this._activeBuffer.y--,this._activeBuffer.x=this._bufferService.cols-1;const U=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);U.hasWidth(this._activeBuffer.x)&&!U.hasContent(this._activeBuffer.x)&&this._activeBuffer.x--}return this._restrictCursor(),true}tab(){if(this._activeBuffer.x>=this._bufferService.cols)return true;const M=this._activeBuffer.x;return this._activeBuffer.x=this._activeBuffer.nextStop(),this._optionsService.rawOptions.screenReaderMode&&this._onA11yTab.fire(this._activeBuffer.x-M),true}shiftOut(){return this._charsetService.setgLevel(1),true}shiftIn(){return this._charsetService.setgLevel(0),true}_restrictCursor(M=this._bufferService.cols-1){this._activeBuffer.x=Math.min(M,Math.max(0,this._activeBuffer.x)),this._activeBuffer.y=this._coreService.decPrivateModes.origin?Math.min(this._activeBuffer.scrollBottom,Math.max(this._activeBuffer.scrollTop,this._activeBuffer.y)):Math.min(this._bufferService.rows-1,Math.max(0,this._activeBuffer.y)),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_setCursor(M,U){this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._coreService.decPrivateModes.origin?(this._activeBuffer.x=M,this._activeBuffer.y=this._activeBuffer.scrollTop+U):(this._activeBuffer.x=M,this._activeBuffer.y=U),this._restrictCursor(),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_moveCursor(M,U){this._restrictCursor(),this._setCursor(this._activeBuffer.x+M,this._activeBuffer.y+U)}cursorUp(M){const U=this._activeBuffer.y-this._activeBuffer.scrollTop;return U>=0?this._moveCursor(0,-Math.min(U,M.params[0]||1)):this._moveCursor(0,-(M.params[0]||1)),true}cursorDown(M){const U=this._activeBuffer.scrollBottom-this._activeBuffer.y;return U>=0?this._moveCursor(0,Math.min(U,M.params[0]||1)):this._moveCursor(0,M.params[0]||1),true}cursorForward(M){return this._moveCursor(M.params[0]||1,0),true}cursorBackward(M){return this._moveCursor(-(M.params[0]||1),0),true}cursorNextLine(M){return this.cursorDown(M),this._activeBuffer.x=0,true}cursorPrecedingLine(M){return this.cursorUp(M),this._activeBuffer.x=0,true}cursorCharAbsolute(M){return this._setCursor((M.params[0]||1)-1,this._activeBuffer.y),true}cursorPosition(M){return this._setCursor(M.length>=2?(M.params[1]||1)-1:0,(M.params[0]||1)-1),true}charPosAbsolute(M){return this._setCursor((M.params[0]||1)-1,this._activeBuffer.y),true}hPositionRelative(M){return this._moveCursor(M.params[0]||1,0),true}linePosAbsolute(M){return this._setCursor(this._activeBuffer.x,(M.params[0]||1)-1),true}vPositionRelative(M){return this._moveCursor(0,M.params[0]||1),true}hVPosition(M){return this.cursorPosition(M),true}tabClear(M){const U=M.params[0];return U===0?delete this._activeBuffer.tabs[this._activeBuffer.x]:U===3&&(this._activeBuffer.tabs={}),true}cursorForwardTab(M){if(this._activeBuffer.x>=this._bufferService.cols)return true;let U=M.params[0]||1;for(;U--;)this._activeBuffer.x=this._activeBuffer.nextStop();return true}cursorBackwardTab(M){if(this._activeBuffer.x>=this._bufferService.cols)return true;let U=M.params[0]||1;for(;U--;)this._activeBuffer.x=this._activeBuffer.prevStop();return true}selectProtected(M){const U=M.params[0];return U===1&&(this._curAttrData.bg|=536870912),U!==2&&U!==0||(this._curAttrData.bg&=-536870913),true}_eraseInBufferLine(M,U,V,K=false,H=false){const ie=this._activeBuffer.lines.get(this._activeBuffer.ybase+M);ie.replaceCells(U,V,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData(),H),K&&(ie.isWrapped=false)}_resetBufferLine(M,U=false){const V=this._activeBuffer.lines.get(this._activeBuffer.ybase+M);V&&(V.fill(this._activeBuffer.getNullCell(this._eraseAttrData()),U),this._bufferService.buffer.clearMarkers(this._activeBuffer.ybase+M),V.isWrapped=false)}eraseInDisplay(M,U=false){let V;switch(this._restrictCursor(this._bufferService.cols),M.params[0]){case 0:for(V=this._activeBuffer.y,this._dirtyRowTracker.markDirty(V),this._eraseInBufferLine(V++,this._activeBuffer.x,this._bufferService.cols,this._activeBuffer.x===0,U);V<this._bufferService.rows;V++)this._resetBufferLine(V,U);this._dirtyRowTracker.markDirty(V);break;case 1:for(V=this._activeBuffer.y,this._dirtyRowTracker.markDirty(V),this._eraseInBufferLine(V,0,this._activeBuffer.x+1,true,U),this._activeBuffer.x+1>=this._bufferService.cols&&(this._activeBuffer.lines.get(V+1).isWrapped=false);V--;)this._resetBufferLine(V,U);this._dirtyRowTracker.markDirty(0);break;case 2:for(V=this._bufferService.rows,this._dirtyRowTracker.markDirty(V-1);V--;)this._resetBufferLine(V,U);this._dirtyRowTracker.markDirty(0);break;case 3:const K=this._activeBuffer.lines.length-this._bufferService.rows;K>0&&(this._activeBuffer.lines.trimStart(K),this._activeBuffer.ybase=Math.max(this._activeBuffer.ybase-K,0),this._activeBuffer.ydisp=Math.max(this._activeBuffer.ydisp-K,0),this._onScroll.fire(0))}return true}eraseInLine(M,U=false){switch(this._restrictCursor(this._bufferService.cols),M.params[0]){case 0:this._eraseInBufferLine(this._activeBuffer.y,this._activeBuffer.x,this._bufferService.cols,this._activeBuffer.x===0,U);break;case 1:this._eraseInBufferLine(this._activeBuffer.y,0,this._activeBuffer.x+1,false,U);break;case 2:this._eraseInBufferLine(this._activeBuffer.y,0,this._bufferService.cols,true,U)}return this._dirtyRowTracker.markDirty(this._activeBuffer.y),true}insertLines(M){this._restrictCursor();let U=M.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return true;const V=this._activeBuffer.ybase+this._activeBuffer.y,K=this._bufferService.rows-1-this._activeBuffer.scrollBottom,H=this._bufferService.rows-1+this._activeBuffer.ybase-K+1;for(;U--;)this._activeBuffer.lines.splice(H-1,1),this._activeBuffer.lines.splice(V,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,true}deleteLines(M){this._restrictCursor();let U=M.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return true;const V=this._activeBuffer.ybase+this._activeBuffer.y;let K;for(K=this._bufferService.rows-1-this._activeBuffer.scrollBottom,K=this._bufferService.rows-1+this._activeBuffer.ybase-K;U--;)this._activeBuffer.lines.splice(V,1),this._activeBuffer.lines.splice(K,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,true}insertChars(M){this._restrictCursor();const U=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return U&&(U.insertCells(this._activeBuffer.x,M.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),true}deleteChars(M){this._restrictCursor();const U=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return U&&(U.deleteCells(this._activeBuffer.x,M.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),true}scrollUp(M){let U=M.params[0]||1;for(;U--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),true}scrollDown(M){let U=M.params[0]||1;for(;U--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,0,this._activeBuffer.getBlankLine(g.DEFAULT_ATTR_DATA));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),true}scrollLeft(M){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return true;const U=M.params[0]||1;for(let V=this._activeBuffer.scrollTop;V<=this._activeBuffer.scrollBottom;++V){const K=this._activeBuffer.lines.get(this._activeBuffer.ybase+V);K.deleteCells(0,U,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),K.isWrapped=false}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),true}scrollRight(M){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return true;const U=M.params[0]||1;for(let V=this._activeBuffer.scrollTop;V<=this._activeBuffer.scrollBottom;++V){const K=this._activeBuffer.lines.get(this._activeBuffer.ybase+V);K.insertCells(0,U,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),K.isWrapped=false}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),true}insertColumns(M){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return true;const U=M.params[0]||1;for(let V=this._activeBuffer.scrollTop;V<=this._activeBuffer.scrollBottom;++V){const K=this._activeBuffer.lines.get(this._activeBuffer.ybase+V);K.insertCells(this._activeBuffer.x,U,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),K.isWrapped=false}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),true}deleteColumns(M){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return true;const U=M.params[0]||1;for(let V=this._activeBuffer.scrollTop;V<=this._activeBuffer.scrollBottom;++V){const K=this._activeBuffer.lines.get(this._activeBuffer.ybase+V);K.deleteCells(this._activeBuffer.x,U,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),K.isWrapped=false}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),true}eraseChars(M){this._restrictCursor();const U=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return U&&(U.replaceCells(this._activeBuffer.x,this._activeBuffer.x+(M.params[0]||1),this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),true}repeatPrecedingCharacter(M){if(!this._parser.precedingCodepoint)return true;const U=M.params[0]||1,V=new Uint32Array(U);for(let K=0;K<U;++K)V[K]=this._parser.precedingCodepoint;return this.print(V,0,V.length),true}sendDeviceAttributesPrimary(M){return M.params[0]>0||(this._is("xterm")||this._is("rxvt-unicode")||this._is("screen")?this._coreService.triggerDataEvent(p.C0.ESC+"[?1;2c"):this._is("linux")&&this._coreService.triggerDataEvent(p.C0.ESC+"[?6c")),true}sendDeviceAttributesSecondary(M){return M.params[0]>0||(this._is("xterm")?this._coreService.triggerDataEvent(p.C0.ESC+"[>0;276;0c"):this._is("rxvt-unicode")?this._coreService.triggerDataEvent(p.C0.ESC+"[>85;95;0c"):this._is("linux")?this._coreService.triggerDataEvent(M.params[0]+"c"):this._is("screen")&&this._coreService.triggerDataEvent(p.C0.ESC+"[>83;40003;0c")),true}_is(M){return(this._optionsService.rawOptions.termName+"").indexOf(M)===0}setMode(M){for(let U=0;U<M.length;U++)switch(M.params[U]){case 4:this._coreService.modes.insertMode=true;break;case 20:this._optionsService.options.convertEol=true}return true}setModePrivate(M){for(let U=0;U<M.length;U++)switch(M.params[U]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=true;break;case 2:this._charsetService.setgCharset(0,T.DEFAULT_CHARSET),this._charsetService.setgCharset(1,T.DEFAULT_CHARSET),this._charsetService.setgCharset(2,T.DEFAULT_CHARSET),this._charsetService.setgCharset(3,T.DEFAULT_CHARSET);break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(132,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=true,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=true;break;case 12:this._optionsService.options.cursorBlink=true;break;case 45:this._coreService.decPrivateModes.reverseWraparound=true;break;case 66:this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=true,this._onRequestSyncScrollBar.fire();break;case 9:this._coreMouseService.activeProtocol="X10";break;case 1e3:this._coreMouseService.activeProtocol="VT200";break;case 1002:this._coreMouseService.activeProtocol="DRAG";break;case 1003:this._coreMouseService.activeProtocol="ANY";break;case 1004:this._coreService.decPrivateModes.sendFocus=true,this._onRequestSendFocus.fire();break;case 1005:this._logService.debug("DECSET 1005 not supported (see #2507)");break;case 1006:this._coreMouseService.activeEncoding="SGR";break;case 1015:this._logService.debug("DECSET 1015 not supported (see #2507)");break;case 1016:this._coreMouseService.activeEncoding="SGR_PIXELS";break;case 25:this._coreService.isCursorHidden=false;break;case 1048:this.saveCursor();break;case 1049:this.saveCursor();case 47:case 1047:this._bufferService.buffers.activateAltBuffer(this._eraseAttrData()),this._coreService.isCursorInitialized=true,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=true}return true}resetMode(M){for(let U=0;U<M.length;U++)switch(M.params[U]){case 4:this._coreService.modes.insertMode=false;break;case 20:this._optionsService.options.convertEol=false}return true}resetModePrivate(M){for(let U=0;U<M.length;U++)switch(M.params[U]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=false;break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(80,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=false,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=false;break;case 12:this._optionsService.options.cursorBlink=false;break;case 45:this._coreService.decPrivateModes.reverseWraparound=false;break;case 66:this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=false,this._onRequestSyncScrollBar.fire();break;case 9:case 1e3:case 1002:case 1003:this._coreMouseService.activeProtocol="NONE";break;case 1004:this._coreService.decPrivateModes.sendFocus=false;break;case 1005:this._logService.debug("DECRST 1005 not supported (see #2507)");break;case 1006:case 1016:this._coreMouseService.activeEncoding="DEFAULT";break;case 1015:this._logService.debug("DECRST 1015 not supported (see #2507)");break;case 25:this._coreService.isCursorHidden=true;break;case 1048:this.restoreCursor();break;case 1049:case 47:case 1047:this._bufferService.buffers.activateNormalBuffer(),M.params[U]===1049&&this.restoreCursor(),this._coreService.isCursorInitialized=true,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=false}return true}requestMode(M,U){const V=this._coreService.decPrivateModes,{activeProtocol:K,activeEncoding:H}=this._coreMouseService,ie=this._coreService,{buffers:Ie,cols:he}=this._bufferService,{active:st,alt:B}=Ie,te=this._optionsService.rawOptions,le=nt=>nt?1:2,ae=M.params[0];return Me=ae,Se=U?ae===2?4:ae===4?le(ie.modes.insertMode):ae===12?3:ae===20?le(te.convertEol):0:ae===1?le(V.applicationCursorKeys):ae===3?te.windowOptions.setWinLines?he===80?2:he===132?1:0:0:ae===6?le(V.origin):ae===7?le(V.wraparound):ae===8?3:ae===9?le(K==="X10"):ae===12?le(te.cursorBlink):ae===25?le(!ie.isCursorHidden):ae===45?le(V.reverseWraparound):ae===66?le(V.applicationKeypad):ae===67?4:ae===1e3?le(K==="VT200"):ae===1002?le(K==="DRAG"):ae===1003?le(K==="ANY"):ae===1004?le(V.sendFocus):ae===1005?4:ae===1006?le(H==="SGR"):ae===1015?4:ae===1016?le(H==="SGR_PIXELS"):ae===1048?1:ae===47||ae===1047||ae===1049?le(st===B):ae===2004?le(V.bracketedPasteMode):0,ie.triggerDataEvent(`${p.C0.ESC}[${U?"":"?"}${Me};${Se}$y`),true;var Me,Se}_updateAttrColor(M,U,V,K,H){return U===2?(M|=50331648,M&=-16777216,M|=R.AttributeData.fromColorRGB([V,K,H])):U===5&&(M&=-50331904,M|=33554432|255&V),M}_extractColor(M,U,V){const K=[0,0,-1,0,0,0];let H=0,ie=0;do{if(K[ie+H]=M.params[U+ie],M.hasSubParams(U+ie)){const Ie=M.getSubParams(U+ie);let he=0;do K[1]===5&&(H=1),K[ie+he+1+H]=Ie[he];while(++he<Ie.length&&he+ie+1+H<K.length);break}if(K[1]===5&&ie+H>=2||K[1]===2&&ie+H>=5)break;K[1]&&(H=1)}while(++ie+U<M.length&&ie+H<K.length);for(let Ie=2;Ie<K.length;++Ie)K[Ie]===-1&&(K[Ie]=0);switch(K[0]){case 38:V.fg=this._updateAttrColor(V.fg,K[1],K[3],K[4],K[5]);break;case 48:V.bg=this._updateAttrColor(V.bg,K[1],K[3],K[4],K[5]);break;case 58:V.extended=V.extended.clone(),V.extended.underlineColor=this._updateAttrColor(V.extended.underlineColor,K[1],K[3],K[4],K[5])}return ie}_processUnderline(M,U){U.extended=U.extended.clone(),(!~M||M>5)&&(M=1),U.extended.underlineStyle=M,U.fg|=268435456,M===0&&(U.fg&=-268435457),U.updateExtended()}_processSGR0(M){M.fg=g.DEFAULT_ATTR_DATA.fg,M.bg=g.DEFAULT_ATTR_DATA.bg,M.extended=M.extended.clone(),M.extended.underlineStyle=0,M.extended.underlineColor&=-67108864,M.updateExtended()}charAttributes(M){if(M.length===1&&M.params[0]===0)return this._processSGR0(this._curAttrData),true;const U=M.length;let V;const K=this._curAttrData;for(let H=0;H<U;H++)V=M.params[H],V>=30&&V<=37?(K.fg&=-50331904,K.fg|=16777216|V-30):V>=40&&V<=47?(K.bg&=-50331904,K.bg|=16777216|V-40):V>=90&&V<=97?(K.fg&=-50331904,K.fg|=16777224|V-90):V>=100&&V<=107?(K.bg&=-50331904,K.bg|=16777224|V-100):V===0?this._processSGR0(K):V===1?K.fg|=134217728:V===3?K.bg|=67108864:V===4?(K.fg|=268435456,this._processUnderline(M.hasSubParams(H)?M.getSubParams(H)[0]:1,K)):V===5?K.fg|=536870912:V===7?K.fg|=67108864:V===8?K.fg|=1073741824:V===9?K.fg|=2147483648:V===2?K.bg|=134217728:V===21?this._processUnderline(2,K):V===22?(K.fg&=-134217729,K.bg&=-134217729):V===23?K.bg&=-67108865:V===24?(K.fg&=-268435457,this._processUnderline(0,K)):V===25?K.fg&=-536870913:V===27?K.fg&=-67108865:V===28?K.fg&=-1073741825:V===29?K.fg&=2147483647:V===39?(K.fg&=-67108864,K.fg|=16777215&g.DEFAULT_ATTR_DATA.fg):V===49?(K.bg&=-67108864,K.bg|=16777215&g.DEFAULT_ATTR_DATA.bg):V===38||V===48||V===58?H+=this._extractColor(M,H,K):V===53?K.bg|=1073741824:V===55?K.bg&=-1073741825:V===59?(K.extended=K.extended.clone(),K.extended.underlineColor=-1,K.updateExtended()):V===100?(K.fg&=-67108864,K.fg|=16777215&g.DEFAULT_ATTR_DATA.fg,K.bg&=-67108864,K.bg|=16777215&g.DEFAULT_ATTR_DATA.bg):this._logService.debug("Unknown SGR attribute: %d.",V);return true}deviceStatus(M){switch(M.params[0]){case 5:this._coreService.triggerDataEvent(`${p.C0.ESC}[0n`);break;case 6:const U=this._activeBuffer.y+1,V=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${p.C0.ESC}[${U};${V}R`)}return true}deviceStatusPrivate(M){if(M.params[0]===6){const U=this._activeBuffer.y+1,V=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${p.C0.ESC}[?${U};${V}R`)}return true}softReset(M){return this._coreService.isCursorHidden=false,this._onRequestSyncScrollBar.fire(),this._activeBuffer.scrollTop=0,this._activeBuffer.scrollBottom=this._bufferService.rows-1,this._curAttrData=g.DEFAULT_ATTR_DATA.clone(),this._coreService.reset(),this._charsetService.reset(),this._activeBuffer.savedX=0,this._activeBuffer.savedY=this._activeBuffer.ybase,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,this._coreService.decPrivateModes.origin=false,true}setCursorStyle(M){const U=M.params[0]||1;switch(U){case 1:case 2:this._optionsService.options.cursorStyle="block";break;case 3:case 4:this._optionsService.options.cursorStyle="underline";break;case 5:case 6:this._optionsService.options.cursorStyle="bar"}const V=U%2==1;return this._optionsService.options.cursorBlink=V,true}setScrollRegion(M){const U=M.params[0]||1;let V;return(M.length<2||(V=M.params[1])>this._bufferService.rows||V===0)&&(V=this._bufferService.rows),V>U&&(this._activeBuffer.scrollTop=U-1,this._activeBuffer.scrollBottom=V-1,this._setCursor(0,0)),true}windowOptions(M){if(!P(M.params[0],this._optionsService.rawOptions.windowOptions))return true;const U=M.length>1?M.params[1]:0;switch(M.params[0]){case 14:U!==2&&this._onRequestWindowsOptionsReport.fire(F.GET_WIN_SIZE_PIXELS);break;case 16:this._onRequestWindowsOptionsReport.fire(F.GET_CELL_SIZE_PIXELS);break;case 18:this._bufferService&&this._coreService.triggerDataEvent(`${p.C0.ESC}[8;${this._bufferService.rows};${this._bufferService.cols}t`);break;case 22:U!==0&&U!==2||(this._windowTitleStack.push(this._windowTitle),this._windowTitleStack.length>10&&this._windowTitleStack.shift()),U!==0&&U!==1||(this._iconNameStack.push(this._iconName),this._iconNameStack.length>10&&this._iconNameStack.shift());break;case 23:U!==0&&U!==2||this._windowTitleStack.length&&this.setTitle(this._windowTitleStack.pop()),U!==0&&U!==1||this._iconNameStack.length&&this.setIconName(this._iconNameStack.pop())}return true}saveCursor(M){return this._activeBuffer.savedX=this._activeBuffer.x,this._activeBuffer.savedY=this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,true}restoreCursor(M){return this._activeBuffer.x=this._activeBuffer.savedX||0,this._activeBuffer.y=Math.max(this._activeBuffer.savedY-this._activeBuffer.ybase,0),this._curAttrData.fg=this._activeBuffer.savedCurAttrData.fg,this._curAttrData.bg=this._activeBuffer.savedCurAttrData.bg,this._charsetService.charset=this._savedCharset,this._activeBuffer.savedCharset&&(this._charsetService.charset=this._activeBuffer.savedCharset),this._restrictCursor(),true}setTitle(M){return this._windowTitle=M,this._onTitleChange.fire(M),true}setIconName(M){return this._iconName=M,true}setOrReportIndexedColor(M){const U=[],V=M.split(";");for(;V.length>1;){const K=V.shift(),H=V.shift();if(/^\d+$/.exec(K)){const ie=parseInt(K);if(j(ie))if(H==="?")U.push({type:0,index:ie});else{const Ie=(0,I.parseColor)(H);Ie&&U.push({type:1,index:ie,color:Ie})}}}return U.length&&this._onColor.fire(U),true}setHyperlink(M){const U=M.split(";");return!(U.length<2)&&(U[1]?this._createHyperlink(U[0],U[1]):!U[0]&&this._finishHyperlink())}_createHyperlink(M,U){this._getCurrentLinkId()&&this._finishHyperlink();const V=M.split(":");let K;const H=V.findIndex(ie=>ie.startsWith("id="));return H!==-1&&(K=V[H].slice(3)||void 0),this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=this._oscLinkService.registerLink({id:K,uri:U}),this._curAttrData.updateExtended(),true}_finishHyperlink(){return this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=0,this._curAttrData.updateExtended(),true}_setOrReportSpecialColor(M,U){const V=M.split(";");for(let K=0;K<V.length&&!(U>=this._specialColors.length);++K,++U)if(V[K]==="?")this._onColor.fire([{type:0,index:this._specialColors[U]}]);else{const H=(0,I.parseColor)(V[K]);H&&this._onColor.fire([{type:1,index:this._specialColors[U],color:H}])}return true}setOrReportFgColor(M){return this._setOrReportSpecialColor(M,0)}setOrReportBgColor(M){return this._setOrReportSpecialColor(M,1)}setOrReportCursorColor(M){return this._setOrReportSpecialColor(M,2)}restoreIndexedColor(M){if(!M)return this._onColor.fire([{type:2}]),true;const U=[],V=M.split(";");for(let K=0;K<V.length;++K)if(/^\d+$/.exec(V[K])){const H=parseInt(V[K]);j(H)&&U.push({type:2,index:H})}return U.length&&this._onColor.fire(U),true}restoreFgColor(M){return this._onColor.fire([{type:2,index:256}]),true}restoreBgColor(M){return this._onColor.fire([{type:2,index:257}]),true}restoreCursorColor(M){return this._onColor.fire([{type:2,index:258}]),true}nextLine(){return this._activeBuffer.x=0,this.index(),true}keypadApplicationMode(){return this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=true,this._onRequestSyncScrollBar.fire(),true}keypadNumericMode(){return this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=false,this._onRequestSyncScrollBar.fire(),true}selectDefaultCharset(){return this._charsetService.setgLevel(0),this._charsetService.setgCharset(0,T.DEFAULT_CHARSET),true}selectCharset(M){return M.length!==2?(this.selectDefaultCharset(),true):(M[0]==="/"||this._charsetService.setgCharset(k[M[0]],T.CHARSETS[M[1]]||T.DEFAULT_CHARSET),true)}index(){return this._restrictCursor(),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._restrictCursor(),true}tabSet(){return this._activeBuffer.tabs[this._activeBuffer.x]=true,true}reverseIndex(){if(this._restrictCursor(),this._activeBuffer.y===this._activeBuffer.scrollTop){const M=this._activeBuffer.scrollBottom-this._activeBuffer.scrollTop;this._activeBuffer.lines.shiftElements(this._activeBuffer.ybase+this._activeBuffer.y,M,1),this._activeBuffer.lines.set(this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.getBlankLine(this._eraseAttrData())),this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom)}else this._activeBuffer.y--,this._restrictCursor();return true}fullReset(){return this._parser.reset(),this._onRequestReset.fire(),true}reset(){this._curAttrData=g.DEFAULT_ATTR_DATA.clone(),this._eraseAttrDataInternal=g.DEFAULT_ATTR_DATA.clone()}_eraseAttrData(){return this._eraseAttrDataInternal.bg&=-67108864,this._eraseAttrDataInternal.bg|=67108863&this._curAttrData.bg,this._eraseAttrDataInternal}setgLevel(M){return this._charsetService.setgLevel(M),true}screenAlignmentPattern(){const M=new b.CellData;M.content=4194373,M.fg=this._curAttrData.fg,M.bg=this._curAttrData.bg,this._setCursor(0,0);for(let U=0;U<this._bufferService.rows;++U){const V=this._activeBuffer.ybase+this._activeBuffer.y+U,K=this._activeBuffer.lines.get(V);K&&(K.fill(M),K.isWrapped=false)}return this._dirtyRowTracker.markAllDirty(),this._setCursor(0,0),true}requestStatusString(M,U){const V=this._bufferService.buffer,K=this._optionsService.rawOptions;return(H=>(this._coreService.triggerDataEvent(`${p.C0.ESC}${H}${p.C0.ESC}\\`),true))(M==='"q'?`P1$r${this._curAttrData.isProtected()?1:0}"q`:M==='"p'?'P1$r61;1"p':M==="r"?`P1$r${V.scrollTop+1};${V.scrollBottom+1}r`:M==="m"?"P1$r0m":M===" q"?`P1$r${{block:2,underline:4,bar:6}[K.cursorStyle]-(K.cursorBlink?1:0)} q`:"P0$r")}markRangeDirty(M,U){this._dirtyRowTracker.markRangeDirty(M,U)}}u.InputHandler=W;let z=class{constructor(J){this._bufferService=J,this.clearRange()}clearRange(){this.start=this._bufferService.buffer.y,this.end=this._bufferService.buffer.y}markDirty(J){J<this.start?this.start=J:J>this.end&&(this.end=J)}markRangeDirty(J,M){J>M&&(X=J,J=M,M=X),J<this.start&&(this.start=J),M>this.end&&(this.end=M)}markAllDirty(){this.markRangeDirty(0,this._bufferService.rows-1)}};function j(J){return 0<=J&&J<256}z=c([h(0,O.IBufferService)],z)},844:(m,u)=>{function _(c){for(const h of c)h.dispose();c.length=0}Object.defineProperty(u,"__esModule",{value:true}),u.getDisposeArrayDisposable=u.disposeArray=u.toDisposable=u.MutableDisposable=u.Disposable=void 0,u.Disposable=class{constructor(){this._disposables=[],this._isDisposed=false}dispose(){this._isDisposed=true;for(const c of this._disposables)c.dispose();this._disposables.length=0}register(c){return this._disposables.push(c),c}unregister(c){const h=this._disposables.indexOf(c);h!==-1&&this._disposables.splice(h,1)}},u.MutableDisposable=class{constructor(){this._isDisposed=false}get value(){return this._isDisposed?void 0:this._value}set value(c){var h;this._isDisposed||c===this._value||((h=this._value)===null||h===void 0||h.dispose(),this._value=c)}clear(){this.value=void 0}dispose(){var c;this._isDisposed=true,(c=this._value)===null||c===void 0||c.dispose(),this._value=void 0}},u.toDisposable=function(c){return{dispose:c}},u.disposeArray=_,u.getDisposeArrayDisposable=function(c){return{dispose:()=>_(c)}}},1505:(m,u)=>{Object.defineProperty(u,"__esModule",{value:true}),u.FourKeyMap=u.TwoKeyMap=void 0;class _{constructor(){this._data={}}set(h,p,T){this._data[h]||(this._data[h]={}),this._data[h][p]=T}get(h,p){return this._data[h]?this._data[h][p]:void 0}clear(){this._data={}}}u.TwoKeyMap=_,u.FourKeyMap=class{constructor(){this._data=new _}set(c,h,p,T,$){this._data.get(c,h)||this._data.set(c,h,new _),this._data.get(c,h).set(p,T,$)}get(c,h,p,T){var $;return($=this._data.get(c,h))===null||$===void 0?void 0:$.get(p,T)}clear(){this._data.clear()}}},6114:(m,u)=>{Object.defineProperty(u,"__esModule",{value:true}),u.isChromeOS=u.isLinux=u.isWindows=u.isIphone=u.isIpad=u.isMac=u.getSafariVersion=u.isSafari=u.isLegacyEdge=u.isFirefox=u.isNode=void 0,u.isNode=typeof navigator>"u";const _=u.isNode?"node":navigator.userAgent,c=u.isNode?"node":navigator.platform;u.isFirefox=_.includes("Firefox"),u.isLegacyEdge=_.includes("Edge"),u.isSafari=/^((?!chrome|android).)*safari/i.test(_),u.getSafariVersion=function(){if(!u.isSafari)return 0;const h=_.match(/Version\/(\d+)/);return h===null||h.length<2?0:parseInt(h[1])},u.isMac=["Macintosh","MacIntel","MacPPC","Mac68K"].includes(c),u.isIpad=c==="iPad",u.isIphone=c==="iPhone",u.isWindows=["Windows","Win16","Win32","WinCE"].includes(c),u.isLinux=c.indexOf("Linux")>=0,u.isChromeOS=/\bCrOS\b/.test(_)},6106:(m,u)=>{Object.defineProperty(u,"__esModule",{value:true}),u.SortedList=void 0;let _=0;u.SortedList=class{constructor(c){this._getKey=c,this._array=[]}clear(){this._array.length=0}insert(c){this._array.length!==0?(_=this._search(this._getKey(c)),this._array.splice(_,0,c)):this._array.push(c)}delete(c){if(this._array.length===0)return false;const h=this._getKey(c);if(h===void 0||(_=this._search(h),_===-1)||this._getKey(this._array[_])!==h)return false;do if(this._array[_]===c)return this._array.splice(_,1),true;while(++_<this._array.length&&this._getKey(this._array[_])===h);return false}*getKeyIterator(c){if(this._array.length!==0&&(_=this._search(c),!(_<0||_>=this._array.length)&&this._getKey(this._array[_])===c))do yield this._array[_];while(++_<this._array.length&&this._getKey(this._array[_])===c)}forEachByKey(c,h){if(this._array.length!==0&&(_=this._search(c),!(_<0||_>=this._array.length)&&this._getKey(this._array[_])===c))do h(this._array[_]);while(++_<this._array.length&&this._getKey(this._array[_])===c)}values(){return[...this._array].values()}_search(c){let h=0,p=this._array.length-1;for(;p>=h;){let T=h+p>>1;const $=this._getKey(this._array[T]);if($>c)p=T-1;else{if(!($<c)){for(;T>0&&this._getKey(this._array[T-1])===c;)T--;return T}h=T+1}}return h}}},7226:(m,u,_)=>{Object.defineProperty(u,"__esModule",{value:true}),u.DebouncedIdleTask=u.IdleTaskQueue=u.PriorityTaskQueue=void 0;const c=_(6114);class h{constructor(){this._tasks=[],this._i=0}enqueue($){this._tasks.push($),this._start()}flush(){for(;this._i<this._tasks.length;)this._tasks[this._i]()||this._i++;this.clear()}clear(){this._idleCallback&&(this._cancelCallback(this._idleCallback),this._idleCallback=void 0),this._i=0,this._tasks.length=0}_start(){this._idleCallback||(this._idleCallback=this._requestCallback(this._process.bind(this)))}_process($){this._idleCallback=void 0;let S=0,y=0,g=$.timeRemaining(),E=0;for(;this._i<this._tasks.length;){if(S=Date.now(),this._tasks[this._i]()||this._i++,S=Math.max(1,Date.now()-S),y=Math.max(S,y),E=$.timeRemaining(),1.5*y>E)return g-S<-20&&console.warn(`task queue exceeded allotted deadline by ${Math.abs(Math.round(g-S))}ms`),void this._start();g=E}this.clear()}}class p extends h{_requestCallback($){return setTimeout(()=>$(this._createDeadline(16)))}_cancelCallback($){clearTimeout($)}_createDeadline($){const S=Date.now()+$;return{timeRemaining:()=>Math.max(0,S-Date.now())}}}u.PriorityTaskQueue=p,u.IdleTaskQueue=!c.isNode&&"requestIdleCallback"in window?class extends h{_requestCallback(T){return requestIdleCallback(T)}_cancelCallback(T){cancelIdleCallback(T)}}:p,u.DebouncedIdleTask=class{constructor(){this._queue=new u.IdleTaskQueue}set(T){this._queue.clear(),this._queue.enqueue(T)}flush(){this._queue.flush()}}},9282:(m,u,_)=>{Object.defineProperty(u,"__esModule",{value:true}),u.updateWindowsModeWrappedState=void 0;const c=_(643);u.updateWindowsModeWrappedState=function(h){const p=h.buffer.lines.get(h.buffer.ybase+h.buffer.y-1),T=p==null?void 0:p.get(h.cols-1),$=h.buffer.lines.get(h.buffer.ybase+h.buffer.y);$&&T&&($.isWrapped=T[c.CHAR_DATA_CODE_INDEX]!==c.NULL_CELL_CODE&&T[c.CHAR_DATA_CODE_INDEX]!==c.WHITESPACE_CELL_CODE)}},3734:(m,u)=>{Object.defineProperty(u,"__esModule",{value:true}),u.ExtendedAttrs=u.AttributeData=void 0;class _{constructor(){this.fg=0,this.bg=0,this.extended=new c}static toColorRGB(p){return[p>>>16&255,p>>>8&255,255&p]}static fromColorRGB(p){return(255&p[0])<<16|(255&p[1])<<8|255&p[2]}clone(){const p=new _;return p.fg=this.fg,p.bg=this.bg,p.extended=this.extended.clone(),p}isInverse(){return 67108864&this.fg}isBold(){return 134217728&this.fg}isUnderline(){return this.hasExtendedAttrs()&&this.extended.underlineStyle!==0?1:268435456&this.fg}isBlink(){return 536870912&this.fg}isInvisible(){return 1073741824&this.fg}isItalic(){return 67108864&this.bg}isDim(){return 134217728&this.bg}isStrikethrough(){return 2147483648&this.fg}isProtected(){return 536870912&this.bg}isOverline(){return 1073741824&this.bg}getFgColorMode(){return 50331648&this.fg}getBgColorMode(){return 50331648&this.bg}isFgRGB(){return(50331648&this.fg)==50331648}isBgRGB(){return(50331648&this.bg)==50331648}isFgPalette(){return(50331648&this.fg)==16777216||(50331648&this.fg)==33554432}isBgPalette(){return(50331648&this.bg)==16777216||(50331648&this.bg)==33554432}isFgDefault(){return(50331648&this.fg)==0}isBgDefault(){return(50331648&this.bg)==0}isAttributeDefault(){return this.fg===0&&this.bg===0}getFgColor(){switch(50331648&this.fg){case 16777216:case 33554432:return 255&this.fg;case 50331648:return 16777215&this.fg;default:return-1}}getBgColor(){switch(50331648&this.bg){case 16777216:case 33554432:return 255&this.bg;case 50331648:return 16777215&this.bg;default:return-1}}hasExtendedAttrs(){return 268435456&this.bg}updateExtended(){this.extended.isEmpty()?this.bg&=-268435457:this.bg|=268435456}getUnderlineColor(){if(268435456&this.bg&&~this.extended.underlineColor)switch(50331648&this.extended.underlineColor){case 16777216:case 33554432:return 255&this.extended.underlineColor;case 50331648:return 16777215&this.extended.underlineColor;default:return this.getFgColor()}return this.getFgColor()}getUnderlineColorMode(){return 268435456&this.bg&&~this.extended.underlineColor?50331648&this.extended.underlineColor:this.getFgColorMode()}isUnderlineColorRGB(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==50331648:this.isFgRGB()}isUnderlineColorPalette(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==16777216||(50331648&this.extended.underlineColor)==33554432:this.isFgPalette()}isUnderlineColorDefault(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==0:this.isFgDefault()}getUnderlineStyle(){return 268435456&this.fg?268435456&this.bg?this.extended.underlineStyle:1:0}}u.AttributeData=_;class c{get ext(){return this._urlId?-469762049&this._ext|this.underlineStyle<<26:this._ext}set ext(p){this._ext=p}get underlineStyle(){return this._urlId?5:(469762048&this._ext)>>26}set underlineStyle(p){this._ext&=-469762049,this._ext|=p<<26&469762048}get underlineColor(){return 67108863&this._ext}set underlineColor(p){this._ext&=-67108864,this._ext|=67108863&p}get urlId(){return this._urlId}set urlId(p){this._urlId=p}constructor(p=0,T=0){this._ext=0,this._urlId=0,this._ext=p,this._urlId=T}clone(){return new c(this._ext,this._urlId)}isEmpty(){return this.underlineStyle===0&&this._urlId===0}}u.ExtendedAttrs=c},9092:(m,u,_)=>{Object.defineProperty(u,"__esModule",{value:true}),u.Buffer=u.MAX_BUFFER_SIZE=void 0;const c=_(6349),h=_(7226),p=_(3734),T=_(8437),$=_(4634),S=_(511),y=_(643),g=_(4863),E=_(7116);u.MAX_BUFFER_SIZE=4294967295,u.Buffer=class{constructor(v,b,R){this._hasScrollback=v,this._optionsService=b,this._bufferService=R,this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.tabs={},this.savedY=0,this.savedX=0,this.savedCurAttrData=T.DEFAULT_ATTR_DATA.clone(),this.savedCharset=E.DEFAULT_CHARSET,this.markers=[],this._nullCell=S.CellData.fromCharData([0,y.NULL_CELL_CHAR,y.NULL_CELL_WIDTH,y.NULL_CELL_CODE]),this._whitespaceCell=S.CellData.fromCharData([0,y.WHITESPACE_CELL_CHAR,y.WHITESPACE_CELL_WIDTH,y.WHITESPACE_CELL_CODE]),this._isClearing=false,this._memoryCleanupQueue=new h.IdleTaskQueue,this._memoryCleanupPosition=0,this._cols=this._bufferService.cols,this._rows=this._bufferService.rows,this.lines=new c.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}getNullCell(v){return v?(this._nullCell.fg=v.fg,this._nullCell.bg=v.bg,this._nullCell.extended=v.extended):(this._nullCell.fg=0,this._nullCell.bg=0,this._nullCell.extended=new p.ExtendedAttrs),this._nullCell}getWhitespaceCell(v){return v?(this._whitespaceCell.fg=v.fg,this._whitespaceCell.bg=v.bg,this._whitespaceCell.extended=v.extended):(this._whitespaceCell.fg=0,this._whitespaceCell.bg=0,this._whitespaceCell.extended=new p.ExtendedAttrs),this._whitespaceCell}getBlankLine(v,b){return new T.BufferLine(this._bufferService.cols,this.getNullCell(v),b)}get hasScrollback(){return this._hasScrollback&&this.lines.maxLength>this._rows}get isCursorInViewport(){const v=this.ybase+this.y-this.ydisp;return v>=0&&v<this._rows}_getCorrectBufferLength(v){if(!this._hasScrollback)return v;const b=v+this._optionsService.rawOptions.scrollback;return b>u.MAX_BUFFER_SIZE?u.MAX_BUFFER_SIZE:b}fillViewportRows(v){if(this.lines.length===0){v===void 0&&(v=T.DEFAULT_ATTR_DATA);let b=this._rows;for(;b--;)this.lines.push(this.getBlankLine(v))}}clear(){this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.lines=new c.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}resize(v,b){const R=this.getNullCell(T.DEFAULT_ATTR_DATA);let O=0;const w=this._getCorrectBufferLength(b);if(w>this.lines.maxLength&&(this.lines.maxLength=w),this.lines.length>0){if(this._cols<v)for(let I=0;I<this.lines.length;I++)O+=+this.lines.get(I).resize(v,R);let L=0;if(this._rows<b)for(let I=this._rows;I<b;I++)this.lines.length<b+this.ybase&&(this._optionsService.rawOptions.windowsMode||this._optionsService.rawOptions.windowsPty.backend!==void 0||this._optionsService.rawOptions.windowsPty.buildNumber!==void 0?this.lines.push(new T.BufferLine(v,R)):this.ybase>0&&this.lines.length<=this.ybase+this.y+L+1?(this.ybase--,L++,this.ydisp>0&&this.ydisp--):this.lines.push(new T.BufferLine(v,R)));else for(let I=this._rows;I>b;I--)this.lines.length>b+this.ybase&&(this.lines.length>this.ybase+this.y+1?this.lines.pop():(this.ybase++,this.ydisp++));if(w<this.lines.maxLength){const I=this.lines.length-w;I>0&&(this.lines.trimStart(I),this.ybase=Math.max(this.ybase-I,0),this.ydisp=Math.max(this.ydisp-I,0),this.savedY=Math.max(this.savedY-I,0)),this.lines.maxLength=w}this.x=Math.min(this.x,v-1),this.y=Math.min(this.y,b-1),L&&(this.y+=L),this.savedX=Math.min(this.savedX,v-1),this.scrollTop=0}if(this.scrollBottom=b-1,this._isReflowEnabled&&(this._reflow(v,b),this._cols>v))for(let L=0;L<this.lines.length;L++)O+=+this.lines.get(L).resize(v,R);this._cols=v,this._rows=b,this._memoryCleanupQueue.clear(),O>.1*this.lines.length&&(this._memoryCleanupPosition=0,this._memoryCleanupQueue.enqueue(()=>this._batchedMemoryCleanup()))}_batchedMemoryCleanup(){let v=true;this._memoryCleanupPosition>=this.lines.length&&(this._memoryCleanupPosition=0,v=false);let b=0;for(;this._memoryCleanupPosition<this.lines.length;)if(b+=this.lines.get(this._memoryCleanupPosition++).cleanupMemory(),b>100)return true;return v}get _isReflowEnabled(){const v=this._optionsService.rawOptions.windowsPty;return v&&v.buildNumber?this._hasScrollback&&v.backend==="conpty"&&v.buildNumber>=21376:this._hasScrollback&&!this._optionsService.rawOptions.windowsMode}_reflow(v,b){this._cols!==v&&(v>this._cols?this._reflowLarger(v,b):this._reflowSmaller(v,b))}_reflowLarger(v,b){const R=(0,$.reflowLargerGetLinesToRemove)(this.lines,this._cols,v,this.ybase+this.y,this.getNullCell(T.DEFAULT_ATTR_DATA));if(R.length>0){const O=(0,$.reflowLargerCreateNewLayout)(this.lines,R);(0,$.reflowLargerApplyNewLayout)(this.lines,O.layout),this._reflowLargerAdjustViewport(v,b,O.countRemoved)}}_reflowLargerAdjustViewport(v,b,R){const O=this.getNullCell(T.DEFAULT_ATTR_DATA);let w=R;for(;w-- >0;)this.ybase===0?(this.y>0&&this.y--,this.lines.length<b&&this.lines.push(new T.BufferLine(v,O))):(this.ydisp===this.ybase&&this.ydisp--,this.ybase--);this.savedY=Math.max(this.savedY-R,0)}_reflowSmaller(v,b){const R=this.getNullCell(T.DEFAULT_ATTR_DATA),O=[];let w=0;for(let L=this.lines.length-1;L>=0;L--){let I=this.lines.get(L);if(!I||!I.isWrapped&&I.getTrimmedLength()<=v)continue;const k=[I];for(;I.isWrapped&&L>0;)I=this.lines.get(--L),k.unshift(I);const x=this.ybase+this.y;if(x>=L&&x<L+k.length)continue;const P=k[k.length-1].getTrimmedLength(),F=(0,$.reflowSmallerGetNewLineLengths)(k,this._cols,v),X=F.length-k.length;let W;W=this.ybase===0&&this.y!==this.lines.length-1?Math.max(0,this.y-this.lines.maxLength+X):Math.max(0,this.lines.length-this.lines.maxLength+X);const z=[];for(let K=0;K<X;K++){const H=this.getBlankLine(T.DEFAULT_ATTR_DATA,true);z.push(H)}z.length>0&&(O.push({start:L+k.length+w,newLines:z}),w+=z.length),k.push(...z);let j=F.length-1,J=F[j];J===0&&(j--,J=F[j]);let M=k.length-X-1,U=P;for(;M>=0;){const K=Math.min(U,J);if(k[j]===void 0)break;if(k[j].copyCellsFrom(k[M],U-K,J-K,K,true),J-=K,J===0&&(j--,J=F[j]),U-=K,U===0){M--;const H=Math.max(M,0);U=(0,$.getWrappedLineTrimmedLength)(k,H,this._cols)}}for(let K=0;K<k.length;K++)F[K]<v&&k[K].setCell(F[K],R);let V=X-W;for(;V-- >0;)this.ybase===0?this.y<b-1?(this.y++,this.lines.pop()):(this.ybase++,this.ydisp++):this.ybase<Math.min(this.lines.maxLength,this.lines.length+w)-b&&(this.ybase===this.ydisp&&this.ydisp++,this.ybase++);this.savedY=Math.min(this.savedY+X,this.ybase+b-1)}if(O.length>0){const L=[],I=[];for(let j=0;j<this.lines.length;j++)I.push(this.lines.get(j));const k=this.lines.length;let x=k-1,P=0,F=O[P];this.lines.length=Math.min(this.lines.maxLength,this.lines.length+w);let X=0;for(let j=Math.min(this.lines.maxLength-1,k+w-1);j>=0;j--)if(F&&F.start>x+X){for(let J=F.newLines.length-1;J>=0;J--)this.lines.set(j--,F.newLines[J]);j++,L.push({index:x+1,amount:F.newLines.length}),X+=F.newLines.length,F=O[++P]}else this.lines.set(j,I[x--]);let W=0;for(let j=L.length-1;j>=0;j--)L[j].index+=W,this.lines.onInsertEmitter.fire(L[j]),W+=L[j].amount;const z=Math.max(0,k+w-this.lines.maxLength);z>0&&this.lines.onTrimEmitter.fire(z)}}translateBufferLineToString(v,b,R=0,O){const w=this.lines.get(v);return w?w.translateToString(b,R,O):""}getWrappedRangeForLine(v){let b=v,R=v;for(;b>0&&this.lines.get(b).isWrapped;)b--;for(;R+1<this.lines.length&&this.lines.get(R+1).isWrapped;)R++;return{first:b,last:R}}setupTabStops(v){for(v!=null?this.tabs[v]||(v=this.prevStop(v)):(this.tabs={},v=0);v<this._cols;v+=this._optionsService.rawOptions.tabStopWidth)this.tabs[v]=true}prevStop(v){for(v==null&&(v=this.x);!this.tabs[--v]&&v>0;);return v>=this._cols?this._cols-1:v<0?0:v}nextStop(v){for(v==null&&(v=this.x);!this.tabs[++v]&&v<this._cols;);return v>=this._cols?this._cols-1:v<0?0:v}clearMarkers(v){this._isClearing=true;for(let b=0;b<this.markers.length;b++)this.markers[b].line===v&&(this.markers[b].dispose(),this.markers.splice(b--,1));this._isClearing=false}clearAllMarkers(){this._isClearing=true;for(let v=0;v<this.markers.length;v++)this.markers[v].dispose(),this.markers.splice(v--,1);this._isClearing=false}addMarker(v){const b=new g.Marker(v);return this.markers.push(b),b.register(this.lines.onTrim(R=>{b.line-=R,b.line<0&&b.dispose()})),b.register(this.lines.onInsert(R=>{b.line>=R.index&&(b.line+=R.amount)})),b.register(this.lines.onDelete(R=>{b.line>=R.index&&b.line<R.index+R.amount&&b.dispose(),b.line>R.index&&(b.line-=R.amount)})),b.register(b.onDispose(()=>this._removeMarker(b))),b}_removeMarker(v){this._isClearing||this.markers.splice(this.markers.indexOf(v),1)}}},8437:(m,u,_)=>{Object.defineProperty(u,"__esModule",{value:true}),u.BufferLine=u.DEFAULT_ATTR_DATA=void 0;const c=_(3734),h=_(511),p=_(643),T=_(482);u.DEFAULT_ATTR_DATA=Object.freeze(new c.AttributeData);let $=0;class S{constructor(g,E,v=false){this.isWrapped=v,this._combined={},this._extendedAttrs={},this._data=new Uint32Array(3*g);const b=E||h.CellData.fromCharData([0,p.NULL_CELL_CHAR,p.NULL_CELL_WIDTH,p.NULL_CELL_CODE]);for(let R=0;R<g;++R)this.setCell(R,b);this.length=g}get(g){const E=this._data[3*g+0],v=2097151&E;return[this._data[3*g+1],2097152&E?this._combined[g]:v?(0,T.stringFromCodePoint)(v):"",E>>22,2097152&E?this._combined[g].charCodeAt(this._combined[g].length-1):v]}set(g,E){this._data[3*g+1]=E[p.CHAR_DATA_ATTR_INDEX],E[p.CHAR_DATA_CHAR_INDEX].length>1?(this._combined[g]=E[1],this._data[3*g+0]=2097152|g|E[p.CHAR_DATA_WIDTH_INDEX]<<22):this._data[3*g+0]=E[p.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|E[p.CHAR_DATA_WIDTH_INDEX]<<22}getWidth(g){return this._data[3*g+0]>>22}hasWidth(g){return 12582912&this._data[3*g+0]}getFg(g){return this._data[3*g+1]}getBg(g){return this._data[3*g+2]}hasContent(g){return 4194303&this._data[3*g+0]}getCodePoint(g){const E=this._data[3*g+0];return 2097152&E?this._combined[g].charCodeAt(this._combined[g].length-1):2097151&E}isCombined(g){return 2097152&this._data[3*g+0]}getString(g){const E=this._data[3*g+0];return 2097152&E?this._combined[g]:2097151&E?(0,T.stringFromCodePoint)(2097151&E):""}isProtected(g){return 536870912&this._data[3*g+2]}loadCell(g,E){return $=3*g,E.content=this._data[$+0],E.fg=this._data[$+1],E.bg=this._data[$+2],2097152&E.content&&(E.combinedData=this._combined[g]),268435456&E.bg&&(E.extended=this._extendedAttrs[g]),E}setCell(g,E){2097152&E.content&&(this._combined[g]=E.combinedData),268435456&E.bg&&(this._extendedAttrs[g]=E.extended),this._data[3*g+0]=E.content,this._data[3*g+1]=E.fg,this._data[3*g+2]=E.bg}setCellFromCodePoint(g,E,v,b,R,O){268435456&R&&(this._extendedAttrs[g]=O),this._data[3*g+0]=E|v<<22,this._data[3*g+1]=b,this._data[3*g+2]=R}addCodepointToCell(g,E){let v=this._data[3*g+0];2097152&v?this._combined[g]+=(0,T.stringFromCodePoint)(E):(2097151&v?(this._combined[g]=(0,T.stringFromCodePoint)(2097151&v)+(0,T.stringFromCodePoint)(E),v&=-2097152,v|=2097152):v=E|4194304,this._data[3*g+0]=v)}insertCells(g,E,v,b){if((g%=this.length)&&this.getWidth(g-1)===2&&this.setCellFromCodePoint(g-1,0,1,(b==null?void 0:b.fg)||0,(b==null?void 0:b.bg)||0,(b==null?void 0:b.extended)||new c.ExtendedAttrs),E<this.length-g){const R=new h.CellData;for(let O=this.length-g-E-1;O>=0;--O)this.setCell(g+E+O,this.loadCell(g+O,R));for(let O=0;O<E;++O)this.setCell(g+O,v)}else for(let R=g;R<this.length;++R)this.setCell(R,v);this.getWidth(this.length-1)===2&&this.setCellFromCodePoint(this.length-1,0,1,(b==null?void 0:b.fg)||0,(b==null?void 0:b.bg)||0,(b==null?void 0:b.extended)||new c.ExtendedAttrs)}deleteCells(g,E,v,b){if(g%=this.length,E<this.length-g){const R=new h.CellData;for(let O=0;O<this.length-g-E;++O)this.setCell(g+O,this.loadCell(g+E+O,R));for(let O=this.length-E;O<this.length;++O)this.setCell(O,v)}else for(let R=g;R<this.length;++R)this.setCell(R,v);g&&this.getWidth(g-1)===2&&this.setCellFromCodePoint(g-1,0,1,(b==null?void 0:b.fg)||0,(b==null?void 0:b.bg)||0,(b==null?void 0:b.extended)||new c.ExtendedAttrs),this.getWidth(g)!==0||this.hasContent(g)||this.setCellFromCodePoint(g,0,1,(b==null?void 0:b.fg)||0,(b==null?void 0:b.bg)||0,(b==null?void 0:b.extended)||new c.ExtendedAttrs)}replaceCells(g,E,v,b,R=false){if(R)for(g&&this.getWidth(g-1)===2&&!this.isProtected(g-1)&&this.setCellFromCodePoint(g-1,0,1,(b==null?void 0:b.fg)||0,(b==null?void 0:b.bg)||0,(b==null?void 0:b.extended)||new c.ExtendedAttrs),E<this.length&&this.getWidth(E-1)===2&&!this.isProtected(E)&&this.setCellFromCodePoint(E,0,1,(b==null?void 0:b.fg)||0,(b==null?void 0:b.bg)||0,(b==null?void 0:b.extended)||new c.ExtendedAttrs);g<E&&g<this.length;)this.isProtected(g)||this.setCell(g,v),g++;else for(g&&this.getWidth(g-1)===2&&this.setCellFromCodePoint(g-1,0,1,(b==null?void 0:b.fg)||0,(b==null?void 0:b.bg)||0,(b==null?void 0:b.extended)||new c.ExtendedAttrs),E<this.length&&this.getWidth(E-1)===2&&this.setCellFromCodePoint(E,0,1,(b==null?void 0:b.fg)||0,(b==null?void 0:b.bg)||0,(b==null?void 0:b.extended)||new c.ExtendedAttrs);g<E&&g<this.length;)this.setCell(g++,v)}resize(g,E){if(g===this.length)return 4*this._data.length*2<this._data.buffer.byteLength;const v=3*g;if(g>this.length){if(this._data.buffer.byteLength>=4*v)this._data=new Uint32Array(this._data.buffer,0,v);else{const b=new Uint32Array(v);b.set(this._data),this._data=b}for(let b=this.length;b<g;++b)this.setCell(b,E)}else{this._data=this._data.subarray(0,v);const b=Object.keys(this._combined);for(let O=0;O<b.length;O++){const w=parseInt(b[O],10);w>=g&&delete this._combined[w]}const R=Object.keys(this._extendedAttrs);for(let O=0;O<R.length;O++){const w=parseInt(R[O],10);w>=g&&delete this._extendedAttrs[w]}}return this.length=g,4*v*2<this._data.buffer.byteLength}cleanupMemory(){if(4*this._data.length*2<this._data.buffer.byteLength){const g=new Uint32Array(this._data.length);return g.set(this._data),this._data=g,1}return 0}fill(g,E=false){if(E)for(let v=0;v<this.length;++v)this.isProtected(v)||this.setCell(v,g);else{this._combined={},this._extendedAttrs={};for(let v=0;v<this.length;++v)this.setCell(v,g)}}copyFrom(g){this.length!==g.length?this._data=new Uint32Array(g._data):this._data.set(g._data),this.length=g.length,this._combined={};for(const E in g._combined)this._combined[E]=g._combined[E];this._extendedAttrs={};for(const E in g._extendedAttrs)this._extendedAttrs[E]=g._extendedAttrs[E];this.isWrapped=g.isWrapped}clone(){const g=new S(0);g._data=new Uint32Array(this._data),g.length=this.length;for(const E in this._combined)g._combined[E]=this._combined[E];for(const E in this._extendedAttrs)g._extendedAttrs[E]=this._extendedAttrs[E];return g.isWrapped=this.isWrapped,g}getTrimmedLength(){for(let g=this.length-1;g>=0;--g)if(4194303&this._data[3*g+0])return g+(this._data[3*g+0]>>22);return 0}getNoBgTrimmedLength(){for(let g=this.length-1;g>=0;--g)if(4194303&this._data[3*g+0]||50331648&this._data[3*g+2])return g+(this._data[3*g+0]>>22);return 0}copyCellsFrom(g,E,v,b,R){const O=g._data;if(R)for(let L=b-1;L>=0;L--){for(let I=0;I<3;I++)this._data[3*(v+L)+I]=O[3*(E+L)+I];268435456&O[3*(E+L)+2]&&(this._extendedAttrs[v+L]=g._extendedAttrs[E+L])}else for(let L=0;L<b;L++){for(let I=0;I<3;I++)this._data[3*(v+L)+I]=O[3*(E+L)+I];268435456&O[3*(E+L)+2]&&(this._extendedAttrs[v+L]=g._extendedAttrs[E+L])}const w=Object.keys(g._combined);for(let L=0;L<w.length;L++){const I=parseInt(w[L],10);I>=E&&(this._combined[I-E+v]=g._combined[I])}}translateToString(g=false,E=0,v=this.length){g&&(v=Math.min(v,this.getTrimmedLength()));let b="";for(;E<v;){const R=this._data[3*E+0],O=2097151&R;b+=2097152&R?this._combined[E]:O?(0,T.stringFromCodePoint)(O):p.WHITESPACE_CELL_CHAR,E+=R>>22||1}return b}}u.BufferLine=S},4841:(m,u)=>{Object.defineProperty(u,"__esModule",{value:true}),u.getRangeLength=void 0,u.getRangeLength=function(_,c){if(_.start.y>_.end.y)throw new Error(`Buffer range end (${_.end.x}, ${_.end.y}) cannot be before start (${_.start.x}, ${_.start.y})`);return c*(_.end.y-_.start.y)+(_.end.x-_.start.x+1)}},4634:(m,u)=>{function _(c,h,p){if(h===c.length-1)return c[h].getTrimmedLength();const T=!c[h].hasContent(p-1)&&c[h].getWidth(p-1)===1,$=c[h+1].getWidth(0)===2;return T&&$?p-1:p}Object.defineProperty(u,"__esModule",{value:true}),u.getWrappedLineTrimmedLength=u.reflowSmallerGetNewLineLengths=u.reflowLargerApplyNewLayout=u.reflowLargerCreateNewLayout=u.reflowLargerGetLinesToRemove=void 0,u.reflowLargerGetLinesToRemove=function(c,h,p,T,$){const S=[];for(let y=0;y<c.length-1;y++){let g=y,E=c.get(++g);if(!E.isWrapped)continue;const v=[c.get(y)];for(;g<c.length&&E.isWrapped;)v.push(E),E=c.get(++g);if(T>=y&&T<g){y+=v.length-1;continue}let b=0,R=_(v,b,h),O=1,w=0;for(;O<v.length;){const I=_(v,O,h),k=I-w,x=p-R,P=Math.min(k,x);v[b].copyCellsFrom(v[O],w,R,P,false),R+=P,R===p&&(b++,R=0),w+=P,w===I&&(O++,w=0),R===0&&b!==0&&v[b-1].getWidth(p-1)===2&&(v[b].copyCellsFrom(v[b-1],p-1,R++,1,false),v[b-1].setCell(p-1,$))}v[b].replaceCells(R,p,$);let L=0;for(let I=v.length-1;I>0&&(I>b||v[I].getTrimmedLength()===0);I--)L++;L>0&&(S.push(y+v.length-L),S.push(L)),y+=v.length-1}return S},u.reflowLargerCreateNewLayout=function(c,h){const p=[];let T=0,$=h[T],S=0;for(let y=0;y<c.length;y++)if($===y){const g=h[++T];c.onDeleteEmitter.fire({index:y-S,amount:g}),y+=g-1,S+=g,$=h[++T]}else p.push(y);return{layout:p,countRemoved:S}},u.reflowLargerApplyNewLayout=function(c,h){const p=[];for(let T=0;T<h.length;T++)p.push(c.get(h[T]));for(let T=0;T<p.length;T++)c.set(T,p[T]);c.length=h.length},u.reflowSmallerGetNewLineLengths=function(c,h,p){const T=[],$=c.map((E,v)=>_(c,v,h)).reduce((E,v)=>E+v);let S=0,y=0,g=0;for(;g<$;){if($-g<p){T.push($-g);break}S+=p;const E=_(c,y,h);S>E&&(S-=E,y++);const v=c[y].getWidth(S-1)===2;v&&S--;const b=v?p-1:p;T.push(b),g+=b}return T},u.getWrappedLineTrimmedLength=_},5295:(m,u,_)=>{Object.defineProperty(u,"__esModule",{value:true}),u.BufferSet=void 0;const c=_(8460),h=_(844),p=_(9092);class T extends h.Disposable{constructor(S,y){super(),this._optionsService=S,this._bufferService=y,this._onBufferActivate=this.register(new c.EventEmitter),this.onBufferActivate=this._onBufferActivate.event,this.reset(),this.register(this._optionsService.onSpecificOptionChange("scrollback",()=>this.resize(this._bufferService.cols,this._bufferService.rows))),this.register(this._optionsService.onSpecificOptionChange("tabStopWidth",()=>this.setupTabStops()))}reset(){this._normal=new p.Buffer(true,this._optionsService,this._bufferService),this._normal.fillViewportRows(),this._alt=new p.Buffer(false,this._optionsService,this._bufferService),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}),this.setupTabStops()}get alt(){return this._alt}get active(){return this._activeBuffer}get normal(){return this._normal}activateNormalBuffer(){this._activeBuffer!==this._normal&&(this._normal.x=this._alt.x,this._normal.y=this._alt.y,this._alt.clearAllMarkers(),this._alt.clear(),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}))}activateAltBuffer(S){this._activeBuffer!==this._alt&&(this._alt.fillViewportRows(S),this._alt.x=this._normal.x,this._alt.y=this._normal.y,this._activeBuffer=this._alt,this._onBufferActivate.fire({activeBuffer:this._alt,inactiveBuffer:this._normal}))}resize(S,y){this._normal.resize(S,y),this._alt.resize(S,y),this.setupTabStops(S)}setupTabStops(S){this._normal.setupTabStops(S),this._alt.setupTabStops(S)}}u.BufferSet=T},511:(m,u,_)=>{Object.defineProperty(u,"__esModule",{value:true}),u.CellData=void 0;const c=_(482),h=_(643),p=_(3734);class T extends p.AttributeData{constructor(){super(...arguments),this.content=0,this.fg=0,this.bg=0,this.extended=new p.ExtendedAttrs,this.combinedData=""}static fromCharData(S){const y=new T;return y.setFromCharData(S),y}isCombined(){return 2097152&this.content}getWidth(){return this.content>>22}getChars(){return 2097152&this.content?this.combinedData:2097151&this.content?(0,c.stringFromCodePoint)(2097151&this.content):""}getCode(){return this.isCombined()?this.combinedData.charCodeAt(this.combinedData.length-1):2097151&this.content}setFromCharData(S){this.fg=S[h.CHAR_DATA_ATTR_INDEX],this.bg=0;let y=false;if(S[h.CHAR_DATA_CHAR_INDEX].length>2)y=true;else if(S[h.CHAR_DATA_CHAR_INDEX].length===2){const g=S[h.CHAR_DATA_CHAR_INDEX].charCodeAt(0);if(55296<=g&&g<=56319){const E=S[h.CHAR_DATA_CHAR_INDEX].charCodeAt(1);56320<=E&&E<=57343?this.content=1024*(g-55296)+E-56320+65536|S[h.CHAR_DATA_WIDTH_INDEX]<<22:y=true}else y=true}else this.content=S[h.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|S[h.CHAR_DATA_WIDTH_INDEX]<<22;y&&(this.combinedData=S[h.CHAR_DATA_CHAR_INDEX],this.content=2097152|S[h.CHAR_DATA_WIDTH_INDEX]<<22)}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}u.CellData=T},643:(m,u)=>{Object.defineProperty(u,"__esModule",{value:true}),u.WHITESPACE_CELL_CODE=u.WHITESPACE_CELL_WIDTH=u.WHITESPACE_CELL_CHAR=u.NULL_CELL_CODE=u.NULL_CELL_WIDTH=u.NULL_CELL_CHAR=u.CHAR_DATA_CODE_INDEX=u.CHAR_DATA_WIDTH_INDEX=u.CHAR_DATA_CHAR_INDEX=u.CHAR_DATA_ATTR_INDEX=u.DEFAULT_EXT=u.DEFAULT_ATTR=u.DEFAULT_COLOR=void 0,u.DEFAULT_COLOR=0,u.DEFAULT_ATTR=256|u.DEFAULT_COLOR<<9,u.DEFAULT_EXT=0,u.CHAR_DATA_ATTR_INDEX=0,u.CHAR_DATA_CHAR_INDEX=1,u.CHAR_DATA_WIDTH_INDEX=2,u.CHAR_DATA_CODE_INDEX=3,u.NULL_CELL_CHAR="",u.NULL_CELL_WIDTH=1,u.NULL_CELL_CODE=0,u.WHITESPACE_CELL_CHAR=" ",u.WHITESPACE_CELL_WIDTH=1,u.WHITESPACE_CELL_CODE=32},4863:(m,u,_)=>{Object.defineProperty(u,"__esModule",{value:true}),u.Marker=void 0;const c=_(8460),h=_(844);class p{get id(){return this._id}constructor($){this.line=$,this.isDisposed=false,this._disposables=[],this._id=p._nextId++,this._onDispose=this.register(new c.EventEmitter),this.onDispose=this._onDispose.event}dispose(){this.isDisposed||(this.isDisposed=true,this.line=-1,this._onDispose.fire(),(0,h.disposeArray)(this._disposables),this._disposables.length=0)}register($){return this._disposables.push($),$}}u.Marker=p,p._nextId=1},7116:(m,u)=>{Object.defineProperty(u,"__esModule",{value:true}),u.DEFAULT_CHARSET=u.CHARSETS=void 0,u.CHARSETS={},u.DEFAULT_CHARSET=u.CHARSETS.B,u.CHARSETS[0]={"`":"◆",a:"▒",b:"␉",c:"␌",d:"␍",e:"␊",f:"°",g:"±",h:"␤",i:"␋",j:"┘",k:"┐",l:"┌",m:"└",n:"┼",o:"⎺",p:"⎻",q:"─",r:"⎼",s:"⎽",t:"├",u:"┤",v:"┴",w:"┬",x:"│",y:"≤",z:"≥","{":"π","|":"≠","}":"£","~":"·"},u.CHARSETS.A={"#":"£"},u.CHARSETS.B=void 0,u.CHARSETS[4]={"#":"£","@":"¾","[":"ij","\\":"½","]":"|","{":"¨","|":"f","}":"¼","~":"´"},u.CHARSETS.C=u.CHARSETS[5]={"[":"Ä","\\":"Ö","]":"Å","^":"Ü","`":"é","{":"ä","|":"ö","}":"å","~":"ü"},u.CHARSETS.R={"#":"£","@":"à","[":"°","\\":"ç","]":"§","{":"é","|":"ù","}":"è","~":"¨"},u.CHARSETS.Q={"@":"à","[":"â","\\":"ç","]":"ê","^":"î","`":"ô","{":"é","|":"ù","}":"è","~":"û"},u.CHARSETS.K={"@":"§","[":"Ä","\\":"Ö","]":"Ü","{":"ä","|":"ö","}":"ü","~":"ß"},u.CHARSETS.Y={"#":"£","@":"§","[":"°","\\":"ç","]":"é","`":"ù","{":"à","|":"ò","}":"è","~":"ì"},u.CHARSETS.E=u.CHARSETS[6]={"@":"Ä","[":"Æ","\\":"Ø","]":"Å","^":"Ü","`":"ä","{":"æ","|":"ø","}":"å","~":"ü"},u.CHARSETS.Z={"#":"£","@":"§","[":"¡","\\":"Ñ","]":"¿","{":"°","|":"ñ","}":"ç"},u.CHARSETS.H=u.CHARSETS[7]={"@":"É","[":"Ä","\\":"Ö","]":"Å","^":"Ü","`":"é","{":"ä","|":"ö","}":"å","~":"ü"},u.CHARSETS["="]={"#":"ù","@":"à","[":"é","\\":"ç","]":"ê","^":"î",_:"è","`":"ô","{":"ä","|":"ö","}":"ü","~":"û"}},2584:(m,u)=>{var _,c,h;Object.defineProperty(u,"__esModule",{value:true}),u.C1_ESCAPED=u.C1=u.C0=void 0,function(p){p.NUL="\0",p.SOH="",p.STX="",p.ETX="",p.EOT="",p.ENQ="",p.ACK="",p.BEL="\x07",p.BS="\b",p.HT="	",p.LF=`
`,p.VT="\v",p.FF="\f",p.CR="\r",p.SO="",p.SI="",p.DLE="",p.DC1="",p.DC2="",p.DC3="",p.DC4="",p.NAK="",p.SYN="",p.ETB="",p.CAN="",p.EM="",p.SUB="",p.ESC="\x1B",p.FS="",p.GS="",p.RS="",p.US="",p.SP=" ",p.DEL=""}(_||(u.C0=_={})),function(p){p.PAD="",p.HOP="",p.BPH="",p.NBH="",p.IND="",p.NEL="",p.SSA="",p.ESA="",p.HTS="",p.HTJ="",p.VTS="",p.PLD="",p.PLU="",p.RI="",p.SS2="",p.SS3="",p.DCS="",p.PU1="",p.PU2="",p.STS="",p.CCH="",p.MW="",p.SPA="",p.EPA="",p.SOS="",p.SGCI="",p.SCI="",p.CSI="",p.ST="",p.OSC="",p.PM="",p.APC=""}(c||(u.C1=c={})),function(p){p.ST=`${_.ESC}\\`}(h||(u.C1_ESCAPED=h={}))},7399:(m,u,_)=>{Object.defineProperty(u,"__esModule",{value:true}),u.evaluateKeyboardEvent=void 0;const c=_(2584),h={48:["0",")"],49:["1","!"],50:["2","@"],51:["3","#"],52:["4","$"],53:["5","%"],54:["6","^"],55:["7","&"],56:["8","*"],57:["9","("],186:[";",":"],187:["=","+"],188:[",","<"],189:["-","_"],190:[".",">"],191:["/","?"],192:["`","~"],219:["[","{"],220:["\\","|"],221:["]","}"],222:["'",'"']};u.evaluateKeyboardEvent=function(p,T,$,S){const y={type:0,cancel:false,key:void 0},g=(p.shiftKey?1:0)|(p.altKey?2:0)|(p.ctrlKey?4:0)|(p.metaKey?8:0);switch(p.keyCode){case 0:p.key==="UIKeyInputUpArrow"?y.key=T?c.C0.ESC+"OA":c.C0.ESC+"[A":p.key==="UIKeyInputLeftArrow"?y.key=T?c.C0.ESC+"OD":c.C0.ESC+"[D":p.key==="UIKeyInputRightArrow"?y.key=T?c.C0.ESC+"OC":c.C0.ESC+"[C":p.key==="UIKeyInputDownArrow"&&(y.key=T?c.C0.ESC+"OB":c.C0.ESC+"[B");break;case 8:if(p.altKey){y.key=c.C0.ESC+c.C0.DEL;break}y.key=c.C0.DEL;break;case 9:if(p.shiftKey){y.key=c.C0.ESC+"[Z";break}y.key=c.C0.HT,y.cancel=true;break;case 13:y.key=p.altKey?c.C0.ESC+c.C0.CR:c.C0.CR,y.cancel=true;break;case 27:y.key=c.C0.ESC,p.altKey&&(y.key=c.C0.ESC+c.C0.ESC),y.cancel=true;break;case 37:if(p.metaKey)break;g?(y.key=c.C0.ESC+"[1;"+(g+1)+"D",y.key===c.C0.ESC+"[1;3D"&&(y.key=c.C0.ESC+($?"b":"[1;5D"))):y.key=T?c.C0.ESC+"OD":c.C0.ESC+"[D";break;case 39:if(p.metaKey)break;g?(y.key=c.C0.ESC+"[1;"+(g+1)+"C",y.key===c.C0.ESC+"[1;3C"&&(y.key=c.C0.ESC+($?"f":"[1;5C"))):y.key=T?c.C0.ESC+"OC":c.C0.ESC+"[C";break;case 38:if(p.metaKey)break;g?(y.key=c.C0.ESC+"[1;"+(g+1)+"A",$||y.key!==c.C0.ESC+"[1;3A"||(y.key=c.C0.ESC+"[1;5A")):y.key=T?c.C0.ESC+"OA":c.C0.ESC+"[A";break;case 40:if(p.metaKey)break;g?(y.key=c.C0.ESC+"[1;"+(g+1)+"B",$||y.key!==c.C0.ESC+"[1;3B"||(y.key=c.C0.ESC+"[1;5B")):y.key=T?c.C0.ESC+"OB":c.C0.ESC+"[B";break;case 45:p.shiftKey||p.ctrlKey||(y.key=c.C0.ESC+"[2~");break;case 46:y.key=g?c.C0.ESC+"[3;"+(g+1)+"~":c.C0.ESC+"[3~";break;case 36:y.key=g?c.C0.ESC+"[1;"+(g+1)+"H":T?c.C0.ESC+"OH":c.C0.ESC+"[H";break;case 35:y.key=g?c.C0.ESC+"[1;"+(g+1)+"F":T?c.C0.ESC+"OF":c.C0.ESC+"[F";break;case 33:p.shiftKey?y.type=2:p.ctrlKey?y.key=c.C0.ESC+"[5;"+(g+1)+"~":y.key=c.C0.ESC+"[5~";break;case 34:p.shiftKey?y.type=3:p.ctrlKey?y.key=c.C0.ESC+"[6;"+(g+1)+"~":y.key=c.C0.ESC+"[6~";break;case 112:y.key=g?c.C0.ESC+"[1;"+(g+1)+"P":c.C0.ESC+"OP";break;case 113:y.key=g?c.C0.ESC+"[1;"+(g+1)+"Q":c.C0.ESC+"OQ";break;case 114:y.key=g?c.C0.ESC+"[1;"+(g+1)+"R":c.C0.ESC+"OR";break;case 115:y.key=g?c.C0.ESC+"[1;"+(g+1)+"S":c.C0.ESC+"OS";break;case 116:y.key=g?c.C0.ESC+"[15;"+(g+1)+"~":c.C0.ESC+"[15~";break;case 117:y.key=g?c.C0.ESC+"[17;"+(g+1)+"~":c.C0.ESC+"[17~";break;case 118:y.key=g?c.C0.ESC+"[18;"+(g+1)+"~":c.C0.ESC+"[18~";break;case 119:y.key=g?c.C0.ESC+"[19;"+(g+1)+"~":c.C0.ESC+"[19~";break;case 120:y.key=g?c.C0.ESC+"[20;"+(g+1)+"~":c.C0.ESC+"[20~";break;case 121:y.key=g?c.C0.ESC+"[21;"+(g+1)+"~":c.C0.ESC+"[21~";break;case 122:y.key=g?c.C0.ESC+"[23;"+(g+1)+"~":c.C0.ESC+"[23~";break;case 123:y.key=g?c.C0.ESC+"[24;"+(g+1)+"~":c.C0.ESC+"[24~";break;default:if(!p.ctrlKey||p.shiftKey||p.altKey||p.metaKey)if($&&!S||!p.altKey||p.metaKey)!$||p.altKey||p.ctrlKey||p.shiftKey||!p.metaKey?p.key&&!p.ctrlKey&&!p.altKey&&!p.metaKey&&p.keyCode>=48&&p.key.length===1?y.key=p.key:p.key&&p.ctrlKey&&(p.key==="_"&&(y.key=c.C0.US),p.key==="@"&&(y.key=c.C0.NUL)):p.keyCode===65&&(y.type=1);else{const E=h[p.keyCode],v=E==null?void 0:E[p.shiftKey?1:0];if(v)y.key=c.C0.ESC+v;else if(p.keyCode>=65&&p.keyCode<=90){const b=p.ctrlKey?p.keyCode-64:p.keyCode+32;let R=String.fromCharCode(b);p.shiftKey&&(R=R.toUpperCase()),y.key=c.C0.ESC+R}else if(p.keyCode===32)y.key=c.C0.ESC+(p.ctrlKey?c.C0.NUL:" ");else if(p.key==="Dead"&&p.code.startsWith("Key")){let b=p.code.slice(3,4);p.shiftKey||(b=b.toLowerCase()),y.key=c.C0.ESC+b,y.cancel=true}}else p.keyCode>=65&&p.keyCode<=90?y.key=String.fromCharCode(p.keyCode-64):p.keyCode===32?y.key=c.C0.NUL:p.keyCode>=51&&p.keyCode<=55?y.key=String.fromCharCode(p.keyCode-51+27):p.keyCode===56?y.key=c.C0.DEL:p.keyCode===219?y.key=c.C0.ESC:p.keyCode===220?y.key=c.C0.FS:p.keyCode===221&&(y.key=c.C0.GS)}return y}},482:(m,u)=>{Object.defineProperty(u,"__esModule",{value:true}),u.Utf8ToUtf32=u.StringToUtf32=u.utf32ToString=u.stringFromCodePoint=void 0,u.stringFromCodePoint=function(_){return _>65535?(_-=65536,String.fromCharCode(55296+(_>>10))+String.fromCharCode(_%1024+56320)):String.fromCharCode(_)},u.utf32ToString=function(_,c=0,h=_.length){let p="";for(let T=c;T<h;++T){let $=_[T];$>65535?($-=65536,p+=String.fromCharCode(55296+($>>10))+String.fromCharCode($%1024+56320)):p+=String.fromCharCode($)}return p},u.StringToUtf32=class{constructor(){this._interim=0}clear(){this._interim=0}decode(_,c){const h=_.length;if(!h)return 0;let p=0,T=0;if(this._interim){const $=_.charCodeAt(T++);56320<=$&&$<=57343?c[p++]=1024*(this._interim-55296)+$-56320+65536:(c[p++]=this._interim,c[p++]=$),this._interim=0}for(let $=T;$<h;++$){const S=_.charCodeAt($);if(55296<=S&&S<=56319){if(++$>=h)return this._interim=S,p;const y=_.charCodeAt($);56320<=y&&y<=57343?c[p++]=1024*(S-55296)+y-56320+65536:(c[p++]=S,c[p++]=y)}else S!==65279&&(c[p++]=S)}return p}},u.Utf8ToUtf32=class{constructor(){this.interim=new Uint8Array(3)}clear(){this.interim.fill(0)}decode(_,c){const h=_.length;if(!h)return 0;let p,T,$,S,y=0,g=0,E=0;if(this.interim[0]){let R=false,O=this.interim[0];O&=(224&O)==192?31:(240&O)==224?15:7;let w,L=0;for(;(w=63&this.interim[++L])&&L<4;)O<<=6,O|=w;const I=(224&this.interim[0])==192?2:(240&this.interim[0])==224?3:4,k=I-L;for(;E<k;){if(E>=h)return 0;if(w=_[E++],(192&w)!=128){E--,R=true;break}this.interim[L++]=w,O<<=6,O|=63&w}R||(I===2?O<128?E--:c[y++]=O:I===3?O<2048||O>=55296&&O<=57343||O===65279||(c[y++]=O):O<65536||O>1114111||(c[y++]=O)),this.interim.fill(0)}const v=h-4;let b=E;for(;b<h;){for(;!(!(b<v)||128&(p=_[b])||128&(T=_[b+1])||128&($=_[b+2])||128&(S=_[b+3]));)c[y++]=p,c[y++]=T,c[y++]=$,c[y++]=S,b+=4;if(p=_[b++],p<128)c[y++]=p;else if((224&p)==192){if(b>=h)return this.interim[0]=p,y;if(T=_[b++],(192&T)!=128){b--;continue}if(g=(31&p)<<6|63&T,g<128){b--;continue}c[y++]=g}else if((240&p)==224){if(b>=h)return this.interim[0]=p,y;if(T=_[b++],(192&T)!=128){b--;continue}if(b>=h)return this.interim[0]=p,this.interim[1]=T,y;if($=_[b++],(192&$)!=128){b--;continue}if(g=(15&p)<<12|(63&T)<<6|63&$,g<2048||g>=55296&&g<=57343||g===65279)continue;c[y++]=g}else if((248&p)==240){if(b>=h)return this.interim[0]=p,y;if(T=_[b++],(192&T)!=128){b--;continue}if(b>=h)return this.interim[0]=p,this.interim[1]=T,y;if($=_[b++],(192&$)!=128){b--;continue}if(b>=h)return this.interim[0]=p,this.interim[1]=T,this.interim[2]=$,y;if(S=_[b++],(192&S)!=128){b--;continue}if(g=(7&p)<<18|(63&T)<<12|(63&$)<<6|63&S,g<65536||g>1114111)continue;c[y++]=g}}return y}}},225:(m,u)=>{Object.defineProperty(u,"__esModule",{value:true}),u.UnicodeV6=void 0;const _=[[768,879],[1155,1158],[1160,1161],[1425,1469],[1471,1471],[1473,1474],[1476,1477],[1479,1479],[1536,1539],[1552,1557],[1611,1630],[1648,1648],[1750,1764],[1767,1768],[1770,1773],[1807,1807],[1809,1809],[1840,1866],[1958,1968],[2027,2035],[2305,2306],[2364,2364],[2369,2376],[2381,2381],[2385,2388],[2402,2403],[2433,2433],[2492,2492],[2497,2500],[2509,2509],[2530,2531],[2561,2562],[2620,2620],[2625,2626],[2631,2632],[2635,2637],[2672,2673],[2689,2690],[2748,2748],[2753,2757],[2759,2760],[2765,2765],[2786,2787],[2817,2817],[2876,2876],[2879,2879],[2881,2883],[2893,2893],[2902,2902],[2946,2946],[3008,3008],[3021,3021],[3134,3136],[3142,3144],[3146,3149],[3157,3158],[3260,3260],[3263,3263],[3270,3270],[3276,3277],[3298,3299],[3393,3395],[3405,3405],[3530,3530],[3538,3540],[3542,3542],[3633,3633],[3636,3642],[3655,3662],[3761,3761],[3764,3769],[3771,3772],[3784,3789],[3864,3865],[3893,3893],[3895,3895],[3897,3897],[3953,3966],[3968,3972],[3974,3975],[3984,3991],[3993,4028],[4038,4038],[4141,4144],[4146,4146],[4150,4151],[4153,4153],[4184,4185],[4448,4607],[4959,4959],[5906,5908],[5938,5940],[5970,5971],[6002,6003],[6068,6069],[6071,6077],[6086,6086],[6089,6099],[6109,6109],[6155,6157],[6313,6313],[6432,6434],[6439,6440],[6450,6450],[6457,6459],[6679,6680],[6912,6915],[6964,6964],[6966,6970],[6972,6972],[6978,6978],[7019,7027],[7616,7626],[7678,7679],[8203,8207],[8234,8238],[8288,8291],[8298,8303],[8400,8431],[12330,12335],[12441,12442],[43014,43014],[43019,43019],[43045,43046],[64286,64286],[65024,65039],[65056,65059],[65279,65279],[65529,65531]],c=[[68097,68099],[68101,68102],[68108,68111],[68152,68154],[68159,68159],[119143,119145],[119155,119170],[119173,119179],[119210,119213],[119362,119364],[917505,917505],[917536,917631],[917760,917999]];let h;u.UnicodeV6=class{constructor(){if(this.version="6",!h){h=new Uint8Array(65536),h.fill(1),h[0]=0,h.fill(0,1,32),h.fill(0,127,160),h.fill(2,4352,4448),h[9001]=2,h[9002]=2,h.fill(2,11904,42192),h[12351]=1,h.fill(2,44032,55204),h.fill(2,63744,64256),h.fill(2,65040,65050),h.fill(2,65072,65136),h.fill(2,65280,65377),h.fill(2,65504,65511);for(let p=0;p<_.length;++p)h.fill(0,_[p][0],_[p][1]+1)}}wcwidth(p){return p<32?0:p<127?1:p<65536?h[p]:function(T,$){let S,y=0,g=$.length-1;if(T<$[0][0]||T>$[g][1])return false;for(;g>=y;)if(S=y+g>>1,T>$[S][1])y=S+1;else{if(!(T<$[S][0]))return true;g=S-1}return false}(p,c)?0:p>=131072&&p<=196605||p>=196608&&p<=262141?2:1}}},5981:(m,u,_)=>{Object.defineProperty(u,"__esModule",{value:true}),u.WriteBuffer=void 0;const c=_(8460),h=_(844);class p extends h.Disposable{constructor($){super(),this._action=$,this._writeBuffer=[],this._callbacks=[],this._pendingData=0,this._bufferOffset=0,this._isSyncWriting=false,this._syncCalls=0,this._didUserInput=false,this._onWriteParsed=this.register(new c.EventEmitter),this.onWriteParsed=this._onWriteParsed.event}handleUserInput(){this._didUserInput=true}writeSync($,S){if(S!==void 0&&this._syncCalls>S)return void(this._syncCalls=0);if(this._pendingData+=$.length,this._writeBuffer.push($),this._callbacks.push(void 0),this._syncCalls++,this._isSyncWriting)return;let y;for(this._isSyncWriting=true;y=this._writeBuffer.shift();){this._action(y);const g=this._callbacks.shift();g&&g()}this._pendingData=0,this._bufferOffset=2147483647,this._isSyncWriting=false,this._syncCalls=0}write($,S){if(this._pendingData>5e7)throw new Error("write data discarded, use flow control to avoid losing data");if(!this._writeBuffer.length){if(this._bufferOffset=0,this._didUserInput)return this._didUserInput=false,this._pendingData+=$.length,this._writeBuffer.push($),this._callbacks.push(S),void this._innerWrite();setTimeout(()=>this._innerWrite())}this._pendingData+=$.length,this._writeBuffer.push($),this._callbacks.push(S)}_innerWrite($=0,S=true){const y=$||Date.now();for(;this._writeBuffer.length>this._bufferOffset;){const g=this._writeBuffer[this._bufferOffset],E=this._action(g,S);if(E){const b=R=>Date.now()-y>=12?setTimeout(()=>this._innerWrite(0,R)):this._innerWrite(y,R);return void E.catch(R=>(queueMicrotask(()=>{throw R}),Promise.resolve(false))).then(b)}const v=this._callbacks[this._bufferOffset];if(v&&v(),this._bufferOffset++,this._pendingData-=g.length,Date.now()-y>=12)break}this._writeBuffer.length>this._bufferOffset?(this._bufferOffset>50&&(this._writeBuffer=this._writeBuffer.slice(this._bufferOffset),this._callbacks=this._callbacks.slice(this._bufferOffset),this._bufferOffset=0),setTimeout(()=>this._innerWrite())):(this._writeBuffer.length=0,this._callbacks.length=0,this._pendingData=0,this._bufferOffset=0),this._onWriteParsed.fire()}}u.WriteBuffer=p},5941:(m,u)=>{Object.defineProperty(u,"__esModule",{value:true}),u.toRgbString=u.parseColor=void 0;const _=/^([\da-f])\/([\da-f])\/([\da-f])$|^([\da-f]{2})\/([\da-f]{2})\/([\da-f]{2})$|^([\da-f]{3})\/([\da-f]{3})\/([\da-f]{3})$|^([\da-f]{4})\/([\da-f]{4})\/([\da-f]{4})$/,c=/^[\da-f]+$/;function h(p,T){const $=p.toString(16),S=$.length<2?"0"+$:$;switch(T){case 4:return $[0];case 8:return S;case 12:return(S+S).slice(0,3);default:return S+S}}u.parseColor=function(p){if(!p)return;let T=p.toLowerCase();if(T.indexOf("rgb:")===0){T=T.slice(4);const $=_.exec(T);if($){const S=$[1]?15:$[4]?255:$[7]?4095:65535;return[Math.round(parseInt($[1]||$[4]||$[7]||$[10],16)/S*255),Math.round(parseInt($[2]||$[5]||$[8]||$[11],16)/S*255),Math.round(parseInt($[3]||$[6]||$[9]||$[12],16)/S*255)]}}else if(T.indexOf("#")===0&&(T=T.slice(1),c.exec(T)&&[3,6,9,12].includes(T.length))){const $=T.length/3,S=[0,0,0];for(let y=0;y<3;++y){const g=parseInt(T.slice($*y,$*y+$),16);S[y]=$===1?g<<4:$===2?g:$===3?g>>4:g>>8}return S}},u.toRgbString=function(p,T=16){const[$,S,y]=p;return`rgb:${h($,T)}/${h(S,T)}/${h(y,T)}`}},5770:(m,u)=>{Object.defineProperty(u,"__esModule",{value:true}),u.PAYLOAD_LIMIT=void 0,u.PAYLOAD_LIMIT=1e7},6351:(m,u,_)=>{Object.defineProperty(u,"__esModule",{value:true}),u.DcsHandler=u.DcsParser=void 0;const c=_(482),h=_(8742),p=_(5770),T=[];u.DcsParser=class{constructor(){this._handlers=Object.create(null),this._active=T,this._ident=0,this._handlerFb=()=>{},this._stack={paused:false,loopPosition:0,fallThrough:false}}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=T}registerHandler(S,y){this._handlers[S]===void 0&&(this._handlers[S]=[]);const g=this._handlers[S];return g.push(y),{dispose:()=>{const E=g.indexOf(y);E!==-1&&g.splice(E,1)}}}clearHandler(S){this._handlers[S]&&delete this._handlers[S]}setHandlerFallback(S){this._handlerFb=S}reset(){if(this._active.length)for(let S=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;S>=0;--S)this._active[S].unhook(false);this._stack.paused=false,this._active=T,this._ident=0}hook(S,y){if(this.reset(),this._ident=S,this._active=this._handlers[S]||T,this._active.length)for(let g=this._active.length-1;g>=0;g--)this._active[g].hook(y);else this._handlerFb(this._ident,"HOOK",y)}put(S,y,g){if(this._active.length)for(let E=this._active.length-1;E>=0;E--)this._active[E].put(S,y,g);else this._handlerFb(this._ident,"PUT",(0,c.utf32ToString)(S,y,g))}unhook(S,y=true){if(this._active.length){let g=false,E=this._active.length-1,v=false;if(this._stack.paused&&(E=this._stack.loopPosition-1,g=y,v=this._stack.fallThrough,this._stack.paused=false),!v&&g===false){for(;E>=0&&(g=this._active[E].unhook(S),g!==true);E--)if(g instanceof Promise)return this._stack.paused=true,this._stack.loopPosition=E,this._stack.fallThrough=false,g;E--}for(;E>=0;E--)if(g=this._active[E].unhook(false),g instanceof Promise)return this._stack.paused=true,this._stack.loopPosition=E,this._stack.fallThrough=true,g}else this._handlerFb(this._ident,"UNHOOK",S);this._active=T,this._ident=0}};const $=new h.Params;$.addParam(0),u.DcsHandler=class{constructor(S){this._handler=S,this._data="",this._params=$,this._hitLimit=false}hook(S){this._params=S.length>1||S.params[0]?S.clone():$,this._data="",this._hitLimit=false}put(S,y,g){this._hitLimit||(this._data+=(0,c.utf32ToString)(S,y,g),this._data.length>p.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=true))}unhook(S){let y=false;if(this._hitLimit)y=false;else if(S&&(y=this._handler(this._data,this._params),y instanceof Promise))return y.then(g=>(this._params=$,this._data="",this._hitLimit=false,g));return this._params=$,this._data="",this._hitLimit=false,y}}},2015:(m,u,_)=>{Object.defineProperty(u,"__esModule",{value:true}),u.EscapeSequenceParser=u.VT500_TRANSITION_TABLE=u.TransitionTable=void 0;const c=_(844),h=_(8742),p=_(6242),T=_(6351);class ${constructor(E){this.table=new Uint8Array(E)}setDefault(E,v){this.table.fill(E<<4|v)}add(E,v,b,R){this.table[v<<8|E]=b<<4|R}addMany(E,v,b,R){for(let O=0;O<E.length;O++)this.table[v<<8|E[O]]=b<<4|R}}u.TransitionTable=$;const S=160;u.VT500_TRANSITION_TABLE=function(){const g=new $(4095),E=Array.apply(null,Array(256)).map((L,I)=>I),v=(L,I)=>E.slice(L,I),b=v(32,127),R=v(0,24);R.push(25),R.push.apply(R,v(28,32));const O=v(0,14);let w;for(w in g.setDefault(1,0),g.addMany(b,0,2,0),O)g.addMany([24,26,153,154],w,3,0),g.addMany(v(128,144),w,3,0),g.addMany(v(144,152),w,3,0),g.add(156,w,0,0),g.add(27,w,11,1),g.add(157,w,4,8),g.addMany([152,158,159],w,0,7),g.add(155,w,11,3),g.add(144,w,11,9);return g.addMany(R,0,3,0),g.addMany(R,1,3,1),g.add(127,1,0,1),g.addMany(R,8,0,8),g.addMany(R,3,3,3),g.add(127,3,0,3),g.addMany(R,4,3,4),g.add(127,4,0,4),g.addMany(R,6,3,6),g.addMany(R,5,3,5),g.add(127,5,0,5),g.addMany(R,2,3,2),g.add(127,2,0,2),g.add(93,1,4,8),g.addMany(b,8,5,8),g.add(127,8,5,8),g.addMany([156,27,24,26,7],8,6,0),g.addMany(v(28,32),8,0,8),g.addMany([88,94,95],1,0,7),g.addMany(b,7,0,7),g.addMany(R,7,0,7),g.add(156,7,0,0),g.add(127,7,0,7),g.add(91,1,11,3),g.addMany(v(64,127),3,7,0),g.addMany(v(48,60),3,8,4),g.addMany([60,61,62,63],3,9,4),g.addMany(v(48,60),4,8,4),g.addMany(v(64,127),4,7,0),g.addMany([60,61,62,63],4,0,6),g.addMany(v(32,64),6,0,6),g.add(127,6,0,6),g.addMany(v(64,127),6,0,0),g.addMany(v(32,48),3,9,5),g.addMany(v(32,48),5,9,5),g.addMany(v(48,64),5,0,6),g.addMany(v(64,127),5,7,0),g.addMany(v(32,48),4,9,5),g.addMany(v(32,48),1,9,2),g.addMany(v(32,48),2,9,2),g.addMany(v(48,127),2,10,0),g.addMany(v(48,80),1,10,0),g.addMany(v(81,88),1,10,0),g.addMany([89,90,92],1,10,0),g.addMany(v(96,127),1,10,0),g.add(80,1,11,9),g.addMany(R,9,0,9),g.add(127,9,0,9),g.addMany(v(28,32),9,0,9),g.addMany(v(32,48),9,9,12),g.addMany(v(48,60),9,8,10),g.addMany([60,61,62,63],9,9,10),g.addMany(R,11,0,11),g.addMany(v(32,128),11,0,11),g.addMany(v(28,32),11,0,11),g.addMany(R,10,0,10),g.add(127,10,0,10),g.addMany(v(28,32),10,0,10),g.addMany(v(48,60),10,8,10),g.addMany([60,61,62,63],10,0,11),g.addMany(v(32,48),10,9,12),g.addMany(R,12,0,12),g.add(127,12,0,12),g.addMany(v(28,32),12,0,12),g.addMany(v(32,48),12,9,12),g.addMany(v(48,64),12,0,11),g.addMany(v(64,127),12,12,13),g.addMany(v(64,127),10,12,13),g.addMany(v(64,127),9,12,13),g.addMany(R,13,13,13),g.addMany(b,13,13,13),g.add(127,13,0,13),g.addMany([27,156,24,26],13,14,0),g.add(S,0,2,0),g.add(S,8,5,8),g.add(S,6,0,6),g.add(S,11,0,11),g.add(S,13,13,13),g}();class y extends c.Disposable{constructor(E=u.VT500_TRANSITION_TABLE){super(),this._transitions=E,this._parseStack={state:0,handlers:[],handlerPos:0,transition:0,chunkPos:0},this.initialState=0,this.currentState=this.initialState,this._params=new h.Params,this._params.addParam(0),this._collect=0,this.precedingCodepoint=0,this._printHandlerFb=(v,b,R)=>{},this._executeHandlerFb=v=>{},this._csiHandlerFb=(v,b)=>{},this._escHandlerFb=v=>{},this._errorHandlerFb=v=>v,this._printHandler=this._printHandlerFb,this._executeHandlers=Object.create(null),this._csiHandlers=Object.create(null),this._escHandlers=Object.create(null),this.register((0,c.toDisposable)(()=>{this._csiHandlers=Object.create(null),this._executeHandlers=Object.create(null),this._escHandlers=Object.create(null)})),this._oscParser=this.register(new p.OscParser),this._dcsParser=this.register(new T.DcsParser),this._errorHandler=this._errorHandlerFb,this.registerEscHandler({final:"\\"},()=>true)}_identifier(E,v=[64,126]){let b=0;if(E.prefix){if(E.prefix.length>1)throw new Error("only one byte as prefix supported");if(b=E.prefix.charCodeAt(0),b&&60>b||b>63)throw new Error("prefix must be in range 0x3c .. 0x3f")}if(E.intermediates){if(E.intermediates.length>2)throw new Error("only two bytes as intermediates are supported");for(let O=0;O<E.intermediates.length;++O){const w=E.intermediates.charCodeAt(O);if(32>w||w>47)throw new Error("intermediate must be in range 0x20 .. 0x2f");b<<=8,b|=w}}if(E.final.length!==1)throw new Error("final must be a single byte");const R=E.final.charCodeAt(0);if(v[0]>R||R>v[1])throw new Error(`final must be in range ${v[0]} .. ${v[1]}`);return b<<=8,b|=R,b}identToString(E){const v=[];for(;E;)v.push(String.fromCharCode(255&E)),E>>=8;return v.reverse().join("")}setPrintHandler(E){this._printHandler=E}clearPrintHandler(){this._printHandler=this._printHandlerFb}registerEscHandler(E,v){const b=this._identifier(E,[48,126]);this._escHandlers[b]===void 0&&(this._escHandlers[b]=[]);const R=this._escHandlers[b];return R.push(v),{dispose:()=>{const O=R.indexOf(v);O!==-1&&R.splice(O,1)}}}clearEscHandler(E){this._escHandlers[this._identifier(E,[48,126])]&&delete this._escHandlers[this._identifier(E,[48,126])]}setEscHandlerFallback(E){this._escHandlerFb=E}setExecuteHandler(E,v){this._executeHandlers[E.charCodeAt(0)]=v}clearExecuteHandler(E){this._executeHandlers[E.charCodeAt(0)]&&delete this._executeHandlers[E.charCodeAt(0)]}setExecuteHandlerFallback(E){this._executeHandlerFb=E}registerCsiHandler(E,v){const b=this._identifier(E);this._csiHandlers[b]===void 0&&(this._csiHandlers[b]=[]);const R=this._csiHandlers[b];return R.push(v),{dispose:()=>{const O=R.indexOf(v);O!==-1&&R.splice(O,1)}}}clearCsiHandler(E){this._csiHandlers[this._identifier(E)]&&delete this._csiHandlers[this._identifier(E)]}setCsiHandlerFallback(E){this._csiHandlerFb=E}registerDcsHandler(E,v){return this._dcsParser.registerHandler(this._identifier(E),v)}clearDcsHandler(E){this._dcsParser.clearHandler(this._identifier(E))}setDcsHandlerFallback(E){this._dcsParser.setHandlerFallback(E)}registerOscHandler(E,v){return this._oscParser.registerHandler(E,v)}clearOscHandler(E){this._oscParser.clearHandler(E)}setOscHandlerFallback(E){this._oscParser.setHandlerFallback(E)}setErrorHandler(E){this._errorHandler=E}clearErrorHandler(){this._errorHandler=this._errorHandlerFb}reset(){this.currentState=this.initialState,this._oscParser.reset(),this._dcsParser.reset(),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingCodepoint=0,this._parseStack.state!==0&&(this._parseStack.state=2,this._parseStack.handlers=[])}_preserveStack(E,v,b,R,O){this._parseStack.state=E,this._parseStack.handlers=v,this._parseStack.handlerPos=b,this._parseStack.transition=R,this._parseStack.chunkPos=O}parse(E,v,b){let R,O=0,w=0,L=0;if(this._parseStack.state)if(this._parseStack.state===2)this._parseStack.state=0,L=this._parseStack.chunkPos+1;else{if(b===void 0||this._parseStack.state===1)throw this._parseStack.state=1,new Error("improper continuation due to previous async handler, giving up parsing");const I=this._parseStack.handlers;let k=this._parseStack.handlerPos-1;switch(this._parseStack.state){case 3:if(b===false&&k>-1){for(;k>=0&&(R=I[k](this._params),R!==true);k--)if(R instanceof Promise)return this._parseStack.handlerPos=k,R}this._parseStack.handlers=[];break;case 4:if(b===false&&k>-1){for(;k>=0&&(R=I[k](),R!==true);k--)if(R instanceof Promise)return this._parseStack.handlerPos=k,R}this._parseStack.handlers=[];break;case 6:if(O=E[this._parseStack.chunkPos],R=this._dcsParser.unhook(O!==24&&O!==26,b),R)return R;O===27&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0;break;case 5:if(O=E[this._parseStack.chunkPos],R=this._oscParser.end(O!==24&&O!==26,b),R)return R;O===27&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0}this._parseStack.state=0,L=this._parseStack.chunkPos+1,this.precedingCodepoint=0,this.currentState=15&this._parseStack.transition}for(let I=L;I<v;++I){switch(O=E[I],w=this._transitions.table[this.currentState<<8|(O<160?O:S)],w>>4){case 2:for(let X=I+1;;++X){if(X>=v||(O=E[X])<32||O>126&&O<S){this._printHandler(E,I,X),I=X-1;break}if(++X>=v||(O=E[X])<32||O>126&&O<S){this._printHandler(E,I,X),I=X-1;break}if(++X>=v||(O=E[X])<32||O>126&&O<S){this._printHandler(E,I,X),I=X-1;break}if(++X>=v||(O=E[X])<32||O>126&&O<S){this._printHandler(E,I,X),I=X-1;break}}break;case 3:this._executeHandlers[O]?this._executeHandlers[O]():this._executeHandlerFb(O),this.precedingCodepoint=0;break;case 0:break;case 1:if(this._errorHandler({position:I,code:O,currentState:this.currentState,collect:this._collect,params:this._params,abort:false}).abort)return;break;case 7:const k=this._csiHandlers[this._collect<<8|O];let x=k?k.length-1:-1;for(;x>=0&&(R=k[x](this._params),R!==true);x--)if(R instanceof Promise)return this._preserveStack(3,k,x,w,I),R;x<0&&this._csiHandlerFb(this._collect<<8|O,this._params),this.precedingCodepoint=0;break;case 8:do switch(O){case 59:this._params.addParam(0);break;case 58:this._params.addSubParam(-1);break;default:this._params.addDigit(O-48)}while(++I<v&&(O=E[I])>47&&O<60);I--;break;case 9:this._collect<<=8,this._collect|=O;break;case 10:const P=this._escHandlers[this._collect<<8|O];let F=P?P.length-1:-1;for(;F>=0&&(R=P[F](),R!==true);F--)if(R instanceof Promise)return this._preserveStack(4,P,F,w,I),R;F<0&&this._escHandlerFb(this._collect<<8|O),this.precedingCodepoint=0;break;case 11:this._params.reset(),this._params.addParam(0),this._collect=0;break;case 12:this._dcsParser.hook(this._collect<<8|O,this._params);break;case 13:for(let X=I+1;;++X)if(X>=v||(O=E[X])===24||O===26||O===27||O>127&&O<S){this._dcsParser.put(E,I,X),I=X-1;break}break;case 14:if(R=this._dcsParser.unhook(O!==24&&O!==26),R)return this._preserveStack(6,[],0,w,I),R;O===27&&(w|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingCodepoint=0;break;case 4:this._oscParser.start();break;case 5:for(let X=I+1;;X++)if(X>=v||(O=E[X])<32||O>127&&O<S){this._oscParser.put(E,I,X),I=X-1;break}break;case 6:if(R=this._oscParser.end(O!==24&&O!==26),R)return this._preserveStack(5,[],0,w,I),R;O===27&&(w|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingCodepoint=0}this.currentState=15&w}}}u.EscapeSequenceParser=y},6242:(m,u,_)=>{Object.defineProperty(u,"__esModule",{value:true}),u.OscHandler=u.OscParser=void 0;const c=_(5770),h=_(482),p=[];u.OscParser=class{constructor(){this._state=0,this._active=p,this._id=-1,this._handlers=Object.create(null),this._handlerFb=()=>{},this._stack={paused:false,loopPosition:0,fallThrough:false}}registerHandler(T,$){this._handlers[T]===void 0&&(this._handlers[T]=[]);const S=this._handlers[T];return S.push($),{dispose:()=>{const y=S.indexOf($);y!==-1&&S.splice(y,1)}}}clearHandler(T){this._handlers[T]&&delete this._handlers[T]}setHandlerFallback(T){this._handlerFb=T}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=p}reset(){if(this._state===2)for(let T=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;T>=0;--T)this._active[T].end(false);this._stack.paused=false,this._active=p,this._id=-1,this._state=0}_start(){if(this._active=this._handlers[this._id]||p,this._active.length)for(let T=this._active.length-1;T>=0;T--)this._active[T].start();else this._handlerFb(this._id,"START")}_put(T,$,S){if(this._active.length)for(let y=this._active.length-1;y>=0;y--)this._active[y].put(T,$,S);else this._handlerFb(this._id,"PUT",(0,h.utf32ToString)(T,$,S))}start(){this.reset(),this._state=1}put(T,$,S){if(this._state!==3){if(this._state===1)for(;$<S;){const y=T[$++];if(y===59){this._state=2,this._start();break}if(y<48||57<y)return void(this._state=3);this._id===-1&&(this._id=0),this._id=10*this._id+y-48}this._state===2&&S-$>0&&this._put(T,$,S)}}end(T,$=true){if(this._state!==0){if(this._state!==3)if(this._state===1&&this._start(),this._active.length){let S=false,y=this._active.length-1,g=false;if(this._stack.paused&&(y=this._stack.loopPosition-1,S=$,g=this._stack.fallThrough,this._stack.paused=false),!g&&S===false){for(;y>=0&&(S=this._active[y].end(T),S!==true);y--)if(S instanceof Promise)return this._stack.paused=true,this._stack.loopPosition=y,this._stack.fallThrough=false,S;y--}for(;y>=0;y--)if(S=this._active[y].end(false),S instanceof Promise)return this._stack.paused=true,this._stack.loopPosition=y,this._stack.fallThrough=true,S}else this._handlerFb(this._id,"END",T);this._active=p,this._id=-1,this._state=0}}},u.OscHandler=class{constructor(T){this._handler=T,this._data="",this._hitLimit=false}start(){this._data="",this._hitLimit=false}put(T,$,S){this._hitLimit||(this._data+=(0,h.utf32ToString)(T,$,S),this._data.length>c.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=true))}end(T){let $=false;if(this._hitLimit)$=false;else if(T&&($=this._handler(this._data),$ instanceof Promise))return $.then(S=>(this._data="",this._hitLimit=false,S));return this._data="",this._hitLimit=false,$}}},8742:(m,u)=>{Object.defineProperty(u,"__esModule",{value:true}),u.Params=void 0;const _=2147483647;class c{static fromArray(p){const T=new c;if(!p.length)return T;for(let $=Array.isArray(p[0])?1:0;$<p.length;++$){const S=p[$];if(Array.isArray(S))for(let y=0;y<S.length;++y)T.addSubParam(S[y]);else T.addParam(S)}return T}constructor(p=32,T=32){if(this.maxLength=p,this.maxSubParamsLength=T,T>256)throw new Error("maxSubParamsLength must not be greater than 256");this.params=new Int32Array(p),this.length=0,this._subParams=new Int32Array(T),this._subParamsLength=0,this._subParamsIdx=new Uint16Array(p),this._rejectDigits=false,this._rejectSubDigits=false,this._digitIsSub=false}clone(){const p=new c(this.maxLength,this.maxSubParamsLength);return p.params.set(this.params),p.length=this.length,p._subParams.set(this._subParams),p._subParamsLength=this._subParamsLength,p._subParamsIdx.set(this._subParamsIdx),p._rejectDigits=this._rejectDigits,p._rejectSubDigits=this._rejectSubDigits,p._digitIsSub=this._digitIsSub,p}toArray(){const p=[];for(let T=0;T<this.length;++T){p.push(this.params[T]);const $=this._subParamsIdx[T]>>8,S=255&this._subParamsIdx[T];S-$>0&&p.push(Array.prototype.slice.call(this._subParams,$,S))}return p}reset(){this.length=0,this._subParamsLength=0,this._rejectDigits=false,this._rejectSubDigits=false,this._digitIsSub=false}addParam(p){if(this._digitIsSub=false,this.length>=this.maxLength)this._rejectDigits=true;else{if(p<-1)throw new Error("values lesser than -1 are not allowed");this._subParamsIdx[this.length]=this._subParamsLength<<8|this._subParamsLength,this.params[this.length++]=p>_?_:p}}addSubParam(p){if(this._digitIsSub=true,this.length)if(this._rejectDigits||this._subParamsLength>=this.maxSubParamsLength)this._rejectSubDigits=true;else{if(p<-1)throw new Error("values lesser than -1 are not allowed");this._subParams[this._subParamsLength++]=p>_?_:p,this._subParamsIdx[this.length-1]++}}hasSubParams(p){return(255&this._subParamsIdx[p])-(this._subParamsIdx[p]>>8)>0}getSubParams(p){const T=this._subParamsIdx[p]>>8,$=255&this._subParamsIdx[p];return $-T>0?this._subParams.subarray(T,$):null}getSubParamsAll(){const p={};for(let T=0;T<this.length;++T){const $=this._subParamsIdx[T]>>8,S=255&this._subParamsIdx[T];S-$>0&&(p[T]=this._subParams.slice($,S))}return p}addDigit(p){let T;if(this._rejectDigits||!(T=this._digitIsSub?this._subParamsLength:this.length)||this._digitIsSub&&this._rejectSubDigits)return;const $=this._digitIsSub?this._subParams:this.params,S=$[T-1];$[T-1]=~S?Math.min(10*S+p,_):p}}u.Params=c},5741:(m,u)=>{Object.defineProperty(u,"__esModule",{value:true}),u.AddonManager=void 0,u.AddonManager=class{constructor(){this._addons=[]}dispose(){for(let _=this._addons.length-1;_>=0;_--)this._addons[_].instance.dispose()}loadAddon(_,c){const h={instance:c,dispose:c.dispose,isDisposed:false};this._addons.push(h),c.dispose=()=>this._wrappedAddonDispose(h),c.activate(_)}_wrappedAddonDispose(_){if(_.isDisposed)return;let c=-1;for(let h=0;h<this._addons.length;h++)if(this._addons[h]===_){c=h;break}if(c===-1)throw new Error("Could not dispose an addon that has not been loaded");_.isDisposed=true,_.dispose.apply(_.instance),this._addons.splice(c,1)}}},8771:(m,u,_)=>{Object.defineProperty(u,"__esModule",{value:true}),u.BufferApiView=void 0;const c=_(3785),h=_(511);u.BufferApiView=class{constructor(p,T){this._buffer=p,this.type=T}init(p){return this._buffer=p,this}get cursorY(){return this._buffer.y}get cursorX(){return this._buffer.x}get viewportY(){return this._buffer.ydisp}get baseY(){return this._buffer.ybase}get length(){return this._buffer.lines.length}getLine(p){const T=this._buffer.lines.get(p);if(T)return new c.BufferLineApiView(T)}getNullCell(){return new h.CellData}}},3785:(m,u,_)=>{Object.defineProperty(u,"__esModule",{value:true}),u.BufferLineApiView=void 0;const c=_(511);u.BufferLineApiView=class{constructor(h){this._line=h}get isWrapped(){return this._line.isWrapped}get length(){return this._line.length}getCell(h,p){if(!(h<0||h>=this._line.length))return p?(this._line.loadCell(h,p),p):this._line.loadCell(h,new c.CellData)}translateToString(h,p,T){return this._line.translateToString(h,p,T)}}},8285:(m,u,_)=>{Object.defineProperty(u,"__esModule",{value:true}),u.BufferNamespaceApi=void 0;const c=_(8771),h=_(8460),p=_(844);class T extends p.Disposable{constructor(S){super(),this._core=S,this._onBufferChange=this.register(new h.EventEmitter),this.onBufferChange=this._onBufferChange.event,this._normal=new c.BufferApiView(this._core.buffers.normal,"normal"),this._alternate=new c.BufferApiView(this._core.buffers.alt,"alternate"),this._core.buffers.onBufferActivate(()=>this._onBufferChange.fire(this.active))}get active(){if(this._core.buffers.active===this._core.buffers.normal)return this.normal;if(this._core.buffers.active===this._core.buffers.alt)return this.alternate;throw new Error("Active buffer is neither normal nor alternate")}get normal(){return this._normal.init(this._core.buffers.normal)}get alternate(){return this._alternate.init(this._core.buffers.alt)}}u.BufferNamespaceApi=T},7975:(m,u)=>{Object.defineProperty(u,"__esModule",{value:true}),u.ParserApi=void 0,u.ParserApi=class{constructor(_){this._core=_}registerCsiHandler(_,c){return this._core.registerCsiHandler(_,h=>c(h.toArray()))}addCsiHandler(_,c){return this.registerCsiHandler(_,c)}registerDcsHandler(_,c){return this._core.registerDcsHandler(_,(h,p)=>c(h,p.toArray()))}addDcsHandler(_,c){return this.registerDcsHandler(_,c)}registerEscHandler(_,c){return this._core.registerEscHandler(_,c)}addEscHandler(_,c){return this.registerEscHandler(_,c)}registerOscHandler(_,c){return this._core.registerOscHandler(_,c)}addOscHandler(_,c){return this.registerOscHandler(_,c)}}},7090:(m,u)=>{Object.defineProperty(u,"__esModule",{value:true}),u.UnicodeApi=void 0,u.UnicodeApi=class{constructor(_){this._core=_}register(_){this._core.unicodeService.register(_)}get versions(){return this._core.unicodeService.versions}get activeVersion(){return this._core.unicodeService.activeVersion}set activeVersion(_){this._core.unicodeService.activeVersion=_}}},744:function(m,u,_){var c=this&&this.__decorate||function(g,E,v,b){var R,O=arguments.length,w=O<3?E:b===null?b=Object.getOwnPropertyDescriptor(E,v):b;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")w=Reflect.decorate(g,E,v,b);else for(var L=g.length-1;L>=0;L--)(R=g[L])&&(w=(O<3?R(w):O>3?R(E,v,w):R(E,v))||w);return O>3&&w&&Object.defineProperty(E,v,w),w},h=this&&this.__param||function(g,E){return function(v,b){E(v,b,g)}};Object.defineProperty(u,"__esModule",{value:true}),u.BufferService=u.MINIMUM_ROWS=u.MINIMUM_COLS=void 0;const p=_(8460),T=_(844),$=_(5295),S=_(2585);u.MINIMUM_COLS=2,u.MINIMUM_ROWS=1;let y=u.BufferService=class extends T.Disposable{get buffer(){return this.buffers.active}constructor(g){super(),this.isUserScrolling=false,this._onResize=this.register(new p.EventEmitter),this.onResize=this._onResize.event,this._onScroll=this.register(new p.EventEmitter),this.onScroll=this._onScroll.event,this.cols=Math.max(g.rawOptions.cols||0,u.MINIMUM_COLS),this.rows=Math.max(g.rawOptions.rows||0,u.MINIMUM_ROWS),this.buffers=this.register(new $.BufferSet(g,this))}resize(g,E){this.cols=g,this.rows=E,this.buffers.resize(g,E),this._onResize.fire({cols:g,rows:E})}reset(){this.buffers.reset(),this.isUserScrolling=false}scroll(g,E=false){const v=this.buffer;let b;b=this._cachedBlankLine,b&&b.length===this.cols&&b.getFg(0)===g.fg&&b.getBg(0)===g.bg||(b=v.getBlankLine(g,E),this._cachedBlankLine=b),b.isWrapped=E;const R=v.ybase+v.scrollTop,O=v.ybase+v.scrollBottom;if(v.scrollTop===0){const w=v.lines.isFull;O===v.lines.length-1?w?v.lines.recycle().copyFrom(b):v.lines.push(b.clone()):v.lines.splice(O+1,0,b.clone()),w?this.isUserScrolling&&(v.ydisp=Math.max(v.ydisp-1,0)):(v.ybase++,this.isUserScrolling||v.ydisp++)}else{const w=O-R+1;v.lines.shiftElements(R+1,w-1,-1),v.lines.set(O,b.clone())}this.isUserScrolling||(v.ydisp=v.ybase),this._onScroll.fire(v.ydisp)}scrollLines(g,E,v){const b=this.buffer;if(g<0){if(b.ydisp===0)return;this.isUserScrolling=true}else g+b.ydisp>=b.ybase&&(this.isUserScrolling=false);const R=b.ydisp;b.ydisp=Math.max(Math.min(b.ydisp+g,b.ybase),0),R!==b.ydisp&&(E||this._onScroll.fire(b.ydisp))}};u.BufferService=y=c([h(0,S.IOptionsService)],y)},7994:(m,u)=>{Object.defineProperty(u,"__esModule",{value:true}),u.CharsetService=void 0,u.CharsetService=class{constructor(){this.glevel=0,this._charsets=[]}reset(){this.charset=void 0,this._charsets=[],this.glevel=0}setgLevel(_){this.glevel=_,this.charset=this._charsets[_]}setgCharset(_,c){this._charsets[_]=c,this.glevel===_&&(this.charset=c)}}},1753:function(m,u,_){var c=this&&this.__decorate||function(b,R,O,w){var L,I=arguments.length,k=I<3?R:w===null?w=Object.getOwnPropertyDescriptor(R,O):w;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")k=Reflect.decorate(b,R,O,w);else for(var x=b.length-1;x>=0;x--)(L=b[x])&&(k=(I<3?L(k):I>3?L(R,O,k):L(R,O))||k);return I>3&&k&&Object.defineProperty(R,O,k),k},h=this&&this.__param||function(b,R){return function(O,w){R(O,w,b)}};Object.defineProperty(u,"__esModule",{value:true}),u.CoreMouseService=void 0;const p=_(2585),T=_(8460),$=_(844),S={NONE:{events:0,restrict:()=>false},X10:{events:1,restrict:b=>b.button!==4&&b.action===1&&(b.ctrl=false,b.alt=false,b.shift=false,true)},VT200:{events:19,restrict:b=>b.action!==32},DRAG:{events:23,restrict:b=>b.action!==32||b.button!==3},ANY:{events:31,restrict:b=>true}};function y(b,R){let O=(b.ctrl?16:0)|(b.shift?4:0)|(b.alt?8:0);return b.button===4?(O|=64,O|=b.action):(O|=3&b.button,4&b.button&&(O|=64),8&b.button&&(O|=128),b.action===32?O|=32:b.action!==0||R||(O|=3)),O}const g=String.fromCharCode,E={DEFAULT:b=>{const R=[y(b,false)+32,b.col+32,b.row+32];return R[0]>255||R[1]>255||R[2]>255?"":`\x1B[M${g(R[0])}${g(R[1])}${g(R[2])}`},SGR:b=>{const R=b.action===0&&b.button!==4?"m":"M";return`\x1B[<${y(b,true)};${b.col};${b.row}${R}`},SGR_PIXELS:b=>{const R=b.action===0&&b.button!==4?"m":"M";return`\x1B[<${y(b,true)};${b.x};${b.y}${R}`}};let v=u.CoreMouseService=class extends $.Disposable{constructor(b,R){super(),this._bufferService=b,this._coreService=R,this._protocols={},this._encodings={},this._activeProtocol="",this._activeEncoding="",this._lastEvent=null,this._onProtocolChange=this.register(new T.EventEmitter),this.onProtocolChange=this._onProtocolChange.event;for(const O of Object.keys(S))this.addProtocol(O,S[O]);for(const O of Object.keys(E))this.addEncoding(O,E[O]);this.reset()}addProtocol(b,R){this._protocols[b]=R}addEncoding(b,R){this._encodings[b]=R}get activeProtocol(){return this._activeProtocol}get areMouseEventsActive(){return this._protocols[this._activeProtocol].events!==0}set activeProtocol(b){if(!this._protocols[b])throw new Error(`unknown protocol "${b}"`);this._activeProtocol=b,this._onProtocolChange.fire(this._protocols[b].events)}get activeEncoding(){return this._activeEncoding}set activeEncoding(b){if(!this._encodings[b])throw new Error(`unknown encoding "${b}"`);this._activeEncoding=b}reset(){this.activeProtocol="NONE",this.activeEncoding="DEFAULT",this._lastEvent=null}triggerMouseEvent(b){if(b.col<0||b.col>=this._bufferService.cols||b.row<0||b.row>=this._bufferService.rows||b.button===4&&b.action===32||b.button===3&&b.action!==32||b.button!==4&&(b.action===2||b.action===3)||(b.col++,b.row++,b.action===32&&this._lastEvent&&this._equalEvents(this._lastEvent,b,this._activeEncoding==="SGR_PIXELS"))||!this._protocols[this._activeProtocol].restrict(b))return false;const R=this._encodings[this._activeEncoding](b);return R&&(this._activeEncoding==="DEFAULT"?this._coreService.triggerBinaryEvent(R):this._coreService.triggerDataEvent(R,true)),this._lastEvent=b,true}explainEvents(b){return{down:!!(1&b),up:!!(2&b),drag:!!(4&b),move:!!(8&b),wheel:!!(16&b)}}_equalEvents(b,R,O){if(O){if(b.x!==R.x||b.y!==R.y)return false}else if(b.col!==R.col||b.row!==R.row)return false;return b.button===R.button&&b.action===R.action&&b.ctrl===R.ctrl&&b.alt===R.alt&&b.shift===R.shift}};u.CoreMouseService=v=c([h(0,p.IBufferService),h(1,p.ICoreService)],v)},6975:function(m,u,_){var c=this&&this.__decorate||function(v,b,R,O){var w,L=arguments.length,I=L<3?b:O===null?O=Object.getOwnPropertyDescriptor(b,R):O;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")I=Reflect.decorate(v,b,R,O);else for(var k=v.length-1;k>=0;k--)(w=v[k])&&(I=(L<3?w(I):L>3?w(b,R,I):w(b,R))||I);return L>3&&I&&Object.defineProperty(b,R,I),I},h=this&&this.__param||function(v,b){return function(R,O){b(R,O,v)}};Object.defineProperty(u,"__esModule",{value:true}),u.CoreService=void 0;const p=_(1439),T=_(8460),$=_(844),S=_(2585),y=Object.freeze({insertMode:false}),g=Object.freeze({applicationCursorKeys:false,applicationKeypad:false,bracketedPasteMode:false,origin:false,reverseWraparound:false,sendFocus:false,wraparound:true});let E=u.CoreService=class extends $.Disposable{constructor(v,b,R){super(),this._bufferService=v,this._logService=b,this._optionsService=R,this.isCursorInitialized=false,this.isCursorHidden=false,this._onData=this.register(new T.EventEmitter),this.onData=this._onData.event,this._onUserInput=this.register(new T.EventEmitter),this.onUserInput=this._onUserInput.event,this._onBinary=this.register(new T.EventEmitter),this.onBinary=this._onBinary.event,this._onRequestScrollToBottom=this.register(new T.EventEmitter),this.onRequestScrollToBottom=this._onRequestScrollToBottom.event,this.modes=(0,p.clone)(y),this.decPrivateModes=(0,p.clone)(g)}reset(){this.modes=(0,p.clone)(y),this.decPrivateModes=(0,p.clone)(g)}triggerDataEvent(v,b=false){if(this._optionsService.rawOptions.disableStdin)return;const R=this._bufferService.buffer;b&&this._optionsService.rawOptions.scrollOnUserInput&&R.ybase!==R.ydisp&&this._onRequestScrollToBottom.fire(),b&&this._onUserInput.fire(),this._logService.debug(`sending data "${v}"`,()=>v.split("").map(O=>O.charCodeAt(0))),this._onData.fire(v)}triggerBinaryEvent(v){this._optionsService.rawOptions.disableStdin||(this._logService.debug(`sending binary "${v}"`,()=>v.split("").map(b=>b.charCodeAt(0))),this._onBinary.fire(v))}};u.CoreService=E=c([h(0,S.IBufferService),h(1,S.ILogService),h(2,S.IOptionsService)],E)},9074:(m,u,_)=>{Object.defineProperty(u,"__esModule",{value:true}),u.DecorationService=void 0;const c=_(8055),h=_(8460),p=_(844),T=_(6106);let $=0,S=0;class y extends p.Disposable{get decorations(){return this._decorations.values()}constructor(){super(),this._decorations=new T.SortedList(v=>v==null?void 0:v.marker.line),this._onDecorationRegistered=this.register(new h.EventEmitter),this.onDecorationRegistered=this._onDecorationRegistered.event,this._onDecorationRemoved=this.register(new h.EventEmitter),this.onDecorationRemoved=this._onDecorationRemoved.event,this.register((0,p.toDisposable)(()=>this.reset()))}registerDecoration(v){if(v.marker.isDisposed)return;const b=new g(v);if(b){const R=b.marker.onDispose(()=>b.dispose());b.onDispose(()=>{b&&(this._decorations.delete(b)&&this._onDecorationRemoved.fire(b),R.dispose())}),this._decorations.insert(b),this._onDecorationRegistered.fire(b)}return b}reset(){for(const v of this._decorations.values())v.dispose();this._decorations.clear()}*getDecorationsAtCell(v,b,R){var O,w,L;let I=0,k=0;for(const x of this._decorations.getKeyIterator(b))I=(O=x.options.x)!==null&&O!==void 0?O:0,k=I+((w=x.options.width)!==null&&w!==void 0?w:1),v>=I&&v<k&&(!R||((L=x.options.layer)!==null&&L!==void 0?L:"bottom")===R)&&(yield x)}forEachDecorationAtCell(v,b,R,O){this._decorations.forEachByKey(b,w=>{var L,I,k;$=(L=w.options.x)!==null&&L!==void 0?L:0,S=$+((I=w.options.width)!==null&&I!==void 0?I:1),v>=$&&v<S&&(!R||((k=w.options.layer)!==null&&k!==void 0?k:"bottom")===R)&&O(w)})}}u.DecorationService=y;class g extends p.Disposable{get isDisposed(){return this._isDisposed}get backgroundColorRGB(){return this._cachedBg===null&&(this.options.backgroundColor?this._cachedBg=c.css.toColor(this.options.backgroundColor):this._cachedBg=void 0),this._cachedBg}get foregroundColorRGB(){return this._cachedFg===null&&(this.options.foregroundColor?this._cachedFg=c.css.toColor(this.options.foregroundColor):this._cachedFg=void 0),this._cachedFg}constructor(v){super(),this.options=v,this.onRenderEmitter=this.register(new h.EventEmitter),this.onRender=this.onRenderEmitter.event,this._onDispose=this.register(new h.EventEmitter),this.onDispose=this._onDispose.event,this._cachedBg=null,this._cachedFg=null,this.marker=v.marker,this.options.overviewRulerOptions&&!this.options.overviewRulerOptions.position&&(this.options.overviewRulerOptions.position="full")}dispose(){this._onDispose.fire(),super.dispose()}}},4348:(m,u,_)=>{Object.defineProperty(u,"__esModule",{value:true}),u.InstantiationService=u.ServiceCollection=void 0;const c=_(2585),h=_(8343);class p{constructor(...$){this._entries=new Map;for(const[S,y]of $)this.set(S,y)}set($,S){const y=this._entries.get($);return this._entries.set($,S),y}forEach($){for(const[S,y]of this._entries.entries())$(S,y)}has($){return this._entries.has($)}get($){return this._entries.get($)}}u.ServiceCollection=p,u.InstantiationService=class{constructor(){this._services=new p,this._services.set(c.IInstantiationService,this)}setService(T,$){this._services.set(T,$)}getService(T){return this._services.get(T)}createInstance(T,...$){const S=(0,h.getServiceDependencies)(T).sort((E,v)=>E.index-v.index),y=[];for(const E of S){const v=this._services.get(E.id);if(!v)throw new Error(`[createInstance] ${T.name} depends on UNKNOWN service ${E.id}.`);y.push(v)}const g=S.length>0?S[0].index:$.length;if($.length!==g)throw new Error(`[createInstance] First service dependency of ${T.name} at position ${g+1} conflicts with ${$.length} static arguments`);return new T(...$,...y)}}},7866:function(m,u,_){var c=this&&this.__decorate||function(g,E,v,b){var R,O=arguments.length,w=O<3?E:b===null?b=Object.getOwnPropertyDescriptor(E,v):b;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")w=Reflect.decorate(g,E,v,b);else for(var L=g.length-1;L>=0;L--)(R=g[L])&&(w=(O<3?R(w):O>3?R(E,v,w):R(E,v))||w);return O>3&&w&&Object.defineProperty(E,v,w),w},h=this&&this.__param||function(g,E){return function(v,b){E(v,b,g)}};Object.defineProperty(u,"__esModule",{value:true}),u.traceCall=u.setTraceLogger=u.LogService=void 0;const p=_(844),T=_(2585),$={trace:T.LogLevelEnum.TRACE,debug:T.LogLevelEnum.DEBUG,info:T.LogLevelEnum.INFO,warn:T.LogLevelEnum.WARN,error:T.LogLevelEnum.ERROR,off:T.LogLevelEnum.OFF};let S,y=u.LogService=class extends p.Disposable{get logLevel(){return this._logLevel}constructor(g){super(),this._optionsService=g,this._logLevel=T.LogLevelEnum.OFF,this._updateLogLevel(),this.register(this._optionsService.onSpecificOptionChange("logLevel",()=>this._updateLogLevel())),S=this}_updateLogLevel(){this._logLevel=$[this._optionsService.rawOptions.logLevel]}_evalLazyOptionalParams(g){for(let E=0;E<g.length;E++)typeof g[E]=="function"&&(g[E]=g[E]())}_log(g,E,v){this._evalLazyOptionalParams(v),g.call(console,(this._optionsService.options.logger?"":"xterm.js: ")+E,...v)}trace(g,...E){var v,b;this._logLevel<=T.LogLevelEnum.TRACE&&this._log((b=(v=this._optionsService.options.logger)===null||v===void 0?void 0:v.trace.bind(this._optionsService.options.logger))!==null&&b!==void 0?b:console.log,g,E)}debug(g,...E){var v,b;this._logLevel<=T.LogLevelEnum.DEBUG&&this._log((b=(v=this._optionsService.options.logger)===null||v===void 0?void 0:v.debug.bind(this._optionsService.options.logger))!==null&&b!==void 0?b:console.log,g,E)}info(g,...E){var v,b;this._logLevel<=T.LogLevelEnum.INFO&&this._log((b=(v=this._optionsService.options.logger)===null||v===void 0?void 0:v.info.bind(this._optionsService.options.logger))!==null&&b!==void 0?b:console.info,g,E)}warn(g,...E){var v,b;this._logLevel<=T.LogLevelEnum.WARN&&this._log((b=(v=this._optionsService.options.logger)===null||v===void 0?void 0:v.warn.bind(this._optionsService.options.logger))!==null&&b!==void 0?b:console.warn,g,E)}error(g,...E){var v,b;this._logLevel<=T.LogLevelEnum.ERROR&&this._log((b=(v=this._optionsService.options.logger)===null||v===void 0?void 0:v.error.bind(this._optionsService.options.logger))!==null&&b!==void 0?b:console.error,g,E)}};u.LogService=y=c([h(0,T.IOptionsService)],y),u.setTraceLogger=function(g){S=g},u.traceCall=function(g,E,v){if(typeof v.value!="function")throw new Error("not supported");const b=v.value;v.value=function(...R){if(S.logLevel!==T.LogLevelEnum.TRACE)return b.apply(this,R);S.trace(`GlyphRenderer#${b.name}(${R.map(w=>JSON.stringify(w)).join(", ")})`);const O=b.apply(this,R);return S.trace(`GlyphRenderer#${b.name} return`,O),O}}},7302:(m,u,_)=>{Object.defineProperty(u,"__esModule",{value:true}),u.OptionsService=u.DEFAULT_OPTIONS=void 0;const c=_(8460),h=_(844),p=_(6114);u.DEFAULT_OPTIONS={cols:80,rows:24,cursorBlink:false,cursorStyle:"block",cursorWidth:1,cursorInactiveStyle:"outline",customGlyphs:true,drawBoldTextInBrightColors:true,fastScrollModifier:"alt",fastScrollSensitivity:5,fontFamily:"courier-new, courier, monospace",fontSize:15,fontWeight:"normal",fontWeightBold:"bold",ignoreBracketedPasteMode:false,lineHeight:1,letterSpacing:0,linkHandler:null,logLevel:"info",logger:null,scrollback:1e3,scrollOnUserInput:true,scrollSensitivity:1,screenReaderMode:false,smoothScrollDuration:0,macOptionIsMeta:false,macOptionClickForcesSelection:false,minimumContrastRatio:1,disableStdin:false,allowProposedApi:false,allowTransparency:false,tabStopWidth:8,theme:{},rightClickSelectsWord:p.isMac,windowOptions:{},windowsMode:false,windowsPty:{},wordSeparator:" ()[]{}',\"`",altClickMovesCursor:true,convertEol:false,termName:"xterm",cancelEvents:false,overviewRulerWidth:0};const T=["normal","bold","100","200","300","400","500","600","700","800","900"];class $ extends h.Disposable{constructor(y){super(),this._onOptionChange=this.register(new c.EventEmitter),this.onOptionChange=this._onOptionChange.event;const g=Object.assign({},u.DEFAULT_OPTIONS);for(const E in y)if(E in g)try{const v=y[E];g[E]=this._sanitizeAndValidateOption(E,v)}catch(v){console.error(v)}this.rawOptions=g,this.options=Object.assign({},g),this._setupOptions()}onSpecificOptionChange(y,g){return this.onOptionChange(E=>{E===y&&g(this.rawOptions[y])})}onMultipleOptionChange(y,g){return this.onOptionChange(E=>{y.indexOf(E)!==-1&&g()})}_setupOptions(){const y=E=>{if(!(E in u.DEFAULT_OPTIONS))throw new Error(`No option with key "${E}"`);return this.rawOptions[E]},g=(E,v)=>{if(!(E in u.DEFAULT_OPTIONS))throw new Error(`No option with key "${E}"`);v=this._sanitizeAndValidateOption(E,v),this.rawOptions[E]!==v&&(this.rawOptions[E]=v,this._onOptionChange.fire(E))};for(const E in this.rawOptions){const v={get:y.bind(this,E),set:g.bind(this,E)};Object.defineProperty(this.options,E,v)}}_sanitizeAndValidateOption(y,g){switch(y){case"cursorStyle":if(g||(g=u.DEFAULT_OPTIONS[y]),!function(E){return E==="block"||E==="underline"||E==="bar"}(g))throw new Error(`"${g}" is not a valid value for ${y}`);break;case"wordSeparator":g||(g=u.DEFAULT_OPTIONS[y]);break;case"fontWeight":case"fontWeightBold":if(typeof g=="number"&&1<=g&&g<=1e3)break;g=T.includes(g)?g:u.DEFAULT_OPTIONS[y];break;case"cursorWidth":g=Math.floor(g);case"lineHeight":case"tabStopWidth":if(g<1)throw new Error(`${y} cannot be less than 1, value: ${g}`);break;case"minimumContrastRatio":g=Math.max(1,Math.min(21,Math.round(10*g)/10));break;case"scrollback":if((g=Math.min(g,4294967295))<0)throw new Error(`${y} cannot be less than 0, value: ${g}`);break;case"fastScrollSensitivity":case"scrollSensitivity":if(g<=0)throw new Error(`${y} cannot be less than or equal to 0, value: ${g}`);break;case"rows":case"cols":if(!g&&g!==0)throw new Error(`${y} must be numeric, value: ${g}`);break;case"windowsPty":g=g??{}}return g}}u.OptionsService=$},2660:function(m,u,_){var c=this&&this.__decorate||function($,S,y,g){var E,v=arguments.length,b=v<3?S:g===null?g=Object.getOwnPropertyDescriptor(S,y):g;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")b=Reflect.decorate($,S,y,g);else for(var R=$.length-1;R>=0;R--)(E=$[R])&&(b=(v<3?E(b):v>3?E(S,y,b):E(S,y))||b);return v>3&&b&&Object.defineProperty(S,y,b),b},h=this&&this.__param||function($,S){return function(y,g){S(y,g,$)}};Object.defineProperty(u,"__esModule",{value:true}),u.OscLinkService=void 0;const p=_(2585);let T=u.OscLinkService=class{constructor($){this._bufferService=$,this._nextId=1,this._entriesWithId=new Map,this._dataByLinkId=new Map}registerLink($){const S=this._bufferService.buffer;if($.id===void 0){const R=S.addMarker(S.ybase+S.y),O={data:$,id:this._nextId++,lines:[R]};return R.onDispose(()=>this._removeMarkerFromLink(O,R)),this._dataByLinkId.set(O.id,O),O.id}const y=$,g=this._getEntryIdKey(y),E=this._entriesWithId.get(g);if(E)return this.addLineToLink(E.id,S.ybase+S.y),E.id;const v=S.addMarker(S.ybase+S.y),b={id:this._nextId++,key:this._getEntryIdKey(y),data:y,lines:[v]};return v.onDispose(()=>this._removeMarkerFromLink(b,v)),this._entriesWithId.set(b.key,b),this._dataByLinkId.set(b.id,b),b.id}addLineToLink($,S){const y=this._dataByLinkId.get($);if(y&&y.lines.every(g=>g.line!==S)){const g=this._bufferService.buffer.addMarker(S);y.lines.push(g),g.onDispose(()=>this._removeMarkerFromLink(y,g))}}getLinkData($){var S;return(S=this._dataByLinkId.get($))===null||S===void 0?void 0:S.data}_getEntryIdKey($){return`${$.id};;${$.uri}`}_removeMarkerFromLink($,S){const y=$.lines.indexOf(S);y!==-1&&($.lines.splice(y,1),$.lines.length===0&&($.data.id!==void 0&&this._entriesWithId.delete($.key),this._dataByLinkId.delete($.id)))}};u.OscLinkService=T=c([h(0,p.IBufferService)],T)},8343:(m,u)=>{Object.defineProperty(u,"__esModule",{value:true}),u.createDecorator=u.getServiceDependencies=u.serviceRegistry=void 0;const _="di$target",c="di$dependencies";u.serviceRegistry=new Map,u.getServiceDependencies=function(h){return h[c]||[]},u.createDecorator=function(h){if(u.serviceRegistry.has(h))return u.serviceRegistry.get(h);const p=function(T,$,S){if(arguments.length!==3)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");(function(y,g,E){g[_]===g?g[c].push({id:y,index:E}):(g[c]=[{id:y,index:E}],g[_]=g)})(p,T,S)};return p.toString=()=>h,u.serviceRegistry.set(h,p),p}},2585:(m,u,_)=>{Object.defineProperty(u,"__esModule",{value:true}),u.IDecorationService=u.IUnicodeService=u.IOscLinkService=u.IOptionsService=u.ILogService=u.LogLevelEnum=u.IInstantiationService=u.ICharsetService=u.ICoreService=u.ICoreMouseService=u.IBufferService=void 0;const c=_(8343);var h;u.IBufferService=(0,c.createDecorator)("BufferService"),u.ICoreMouseService=(0,c.createDecorator)("CoreMouseService"),u.ICoreService=(0,c.createDecorator)("CoreService"),u.ICharsetService=(0,c.createDecorator)("CharsetService"),u.IInstantiationService=(0,c.createDecorator)("InstantiationService"),function(p){p[p.TRACE=0]="TRACE",p[p.DEBUG=1]="DEBUG",p[p.INFO=2]="INFO",p[p.WARN=3]="WARN",p[p.ERROR=4]="ERROR",p[p.OFF=5]="OFF"}(h||(u.LogLevelEnum=h={})),u.ILogService=(0,c.createDecorator)("LogService"),u.IOptionsService=(0,c.createDecorator)("OptionsService"),u.IOscLinkService=(0,c.createDecorator)("OscLinkService"),u.IUnicodeService=(0,c.createDecorator)("UnicodeService"),u.IDecorationService=(0,c.createDecorator)("DecorationService")},1480:(m,u,_)=>{Object.defineProperty(u,"__esModule",{value:true}),u.UnicodeService=void 0;const c=_(8460),h=_(225);u.UnicodeService=class{constructor(){this._providers=Object.create(null),this._active="",this._onChange=new c.EventEmitter,this.onChange=this._onChange.event;const p=new h.UnicodeV6;this.register(p),this._active=p.version,this._activeProvider=p}dispose(){this._onChange.dispose()}get versions(){return Object.keys(this._providers)}get activeVersion(){return this._active}set activeVersion(p){if(!this._providers[p])throw new Error(`unknown Unicode version "${p}"`);this._active=p,this._activeProvider=this._providers[p],this._onChange.fire(p)}register(p){this._providers[p.version]=p}wcwidth(p){return this._activeProvider.wcwidth(p)}getStringCellWidth(p){let T=0;const $=p.length;for(let S=0;S<$;++S){let y=p.charCodeAt(S);if(55296<=y&&y<=56319){if(++S>=$)return T+this.wcwidth(y);const g=p.charCodeAt(S);56320<=g&&g<=57343?y=1024*(y-55296)+g-56320+65536:T+=this.wcwidth(g)}T+=this.wcwidth(y)}return T}}}},o={};function l(m){var u=o[m];if(u!==void 0)return u.exports;var _=o[m]={exports:{}};return i[m].call(_.exports,_,_.exports,l),_.exports}var f={};return(()=>{var m=f;Object.defineProperty(m,"__esModule",{value:true}),m.Terminal=void 0;const u=l(9042),_=l(3236),c=l(844),h=l(5741),p=l(8285),T=l(7975),$=l(7090),S=["cols","rows"];class y extends c.Disposable{constructor(E){super(),this._core=this.register(new _.Terminal(E)),this._addonManager=this.register(new h.AddonManager),this._publicOptions=Object.assign({},this._core.options);const v=R=>this._core.options[R],b=(R,O)=>{this._checkReadonlyOptions(R),this._core.options[R]=O};for(const R in this._core.options){const O={get:v.bind(this,R),set:b.bind(this,R)};Object.defineProperty(this._publicOptions,R,O)}}_checkReadonlyOptions(E){if(S.includes(E))throw new Error(`Option "${E}" can only be set in the constructor`)}_checkProposedApi(){if(!this._core.optionsService.rawOptions.allowProposedApi)throw new Error("You must set the allowProposedApi option to true to use proposed API")}get onBell(){return this._core.onBell}get onBinary(){return this._core.onBinary}get onCursorMove(){return this._core.onCursorMove}get onData(){return this._core.onData}get onKey(){return this._core.onKey}get onLineFeed(){return this._core.onLineFeed}get onRender(){return this._core.onRender}get onResize(){return this._core.onResize}get onScroll(){return this._core.onScroll}get onSelectionChange(){return this._core.onSelectionChange}get onTitleChange(){return this._core.onTitleChange}get onWriteParsed(){return this._core.onWriteParsed}get element(){return this._core.element}get parser(){return this._parser||(this._parser=new T.ParserApi(this._core)),this._parser}get unicode(){return this._checkProposedApi(),new $.UnicodeApi(this._core)}get textarea(){return this._core.textarea}get rows(){return this._core.rows}get cols(){return this._core.cols}get buffer(){return this._buffer||(this._buffer=this.register(new p.BufferNamespaceApi(this._core))),this._buffer}get markers(){return this._checkProposedApi(),this._core.markers}get modes(){const E=this._core.coreService.decPrivateModes;let v="none";switch(this._core.coreMouseService.activeProtocol){case"X10":v="x10";break;case"VT200":v="vt200";break;case"DRAG":v="drag";break;case"ANY":v="any"}return{applicationCursorKeysMode:E.applicationCursorKeys,applicationKeypadMode:E.applicationKeypad,bracketedPasteMode:E.bracketedPasteMode,insertMode:this._core.coreService.modes.insertMode,mouseTrackingMode:v,originMode:E.origin,reverseWraparoundMode:E.reverseWraparound,sendFocusMode:E.sendFocus,wraparoundMode:E.wraparound}}get options(){return this._publicOptions}set options(E){for(const v in E)this._publicOptions[v]=E[v]}blur(){this._core.blur()}focus(){this._core.focus()}resize(E,v){this._verifyIntegers(E,v),this._core.resize(E,v)}open(E){this._core.open(E)}attachCustomKeyEventHandler(E){this._core.attachCustomKeyEventHandler(E)}registerLinkProvider(E){return this._core.registerLinkProvider(E)}registerCharacterJoiner(E){return this._checkProposedApi(),this._core.registerCharacterJoiner(E)}deregisterCharacterJoiner(E){this._checkProposedApi(),this._core.deregisterCharacterJoiner(E)}registerMarker(E=0){return this._verifyIntegers(E),this._core.registerMarker(E)}registerDecoration(E){var v,b,R;return this._checkProposedApi(),this._verifyPositiveIntegers((v=E.x)!==null&&v!==void 0?v:0,(b=E.width)!==null&&b!==void 0?b:0,(R=E.height)!==null&&R!==void 0?R:0),this._core.registerDecoration(E)}hasSelection(){return this._core.hasSelection()}select(E,v,b){this._verifyIntegers(E,v,b),this._core.select(E,v,b)}getSelection(){return this._core.getSelection()}getSelectionPosition(){return this._core.getSelectionPosition()}clearSelection(){this._core.clearSelection()}selectAll(){this._core.selectAll()}selectLines(E,v){this._verifyIntegers(E,v),this._core.selectLines(E,v)}dispose(){super.dispose()}scrollLines(E){this._verifyIntegers(E),this._core.scrollLines(E)}scrollPages(E){this._verifyIntegers(E),this._core.scrollPages(E)}scrollToTop(){this._core.scrollToTop()}scrollToBottom(){this._core.scrollToBottom()}scrollToLine(E){this._verifyIntegers(E),this._core.scrollToLine(E)}clear(){this._core.clear()}write(E,v){this._core.write(E,v)}writeln(E,v){this._core.write(E),this._core.write(`\r
`,v)}paste(E){this._core.paste(E)}refresh(E,v){this._verifyIntegers(E,v),this._core.refresh(E,v)}reset(){this._core.reset()}clearTextureAtlas(){this._core.clearTextureAtlas()}loadAddon(E){this._addonManager.loadAddon(this,E)}static get strings(){return u}_verifyIntegers(...E){for(const v of E)if(v===1/0||isNaN(v)||v%1!=0)throw new Error("This API only accepts integers")}_verifyPositiveIntegers(...E){for(const v of E)if(v&&(v===1/0||isNaN(v)||v%1!=0||v<0))throw new Error("This API only accepts positive integers")}}m.Terminal=y})(),f})())}(Sg)),Sg.exports}var yF=$F();const RF=Ke({__name:"build",props:["blocklyInformation","current"],setup(s,{expose:n}){const i=new yF.Terminal,o=me(null),l={log:(...f)=>{i.writeln(f.join(" "))},error:(...f)=>{i.writeln("\x1B[1;1;30m["+new Date().toLocaleString()+"] \x1B[1;1;31m"+f.join(" ")+"\x1B[0m")},warn:(...f)=>{i.writeln("\x1B[1;1;30m["+new Date().toLocaleString()+"] \x1B[1;1;33m"+f.join(" ")+"\x1B[0m")},success:(...f)=>{i.writeln("\x1B[1;1;30m["+new Date().toLocaleString()+"] \x1B[1;1;32m"+f.join(" ")+"\x1B[0m")},info:(...f)=>{i.writeln("\x1B[1;1;30m["+new Date().toLocaleString()+"] \x1B[1;1;32m"+f.join(" ")+"\x1B[0m")},clear:()=>{i.clear()}};return Rs(()=>{i.open(o.value),l.info('请点击左侧"编译插件"开始编译')}),n({logger:l}),(f,m)=>(ne(),ve("div",{ref_key:"terminalRef",ref:o},null,512))}});var $g,k$;function vI(){if(k$)return $g;k$=1;function s(q){return q instanceof Map?q.clear=q.delete=q.set=function(){throw new Error("map is read-only")}:q instanceof Set&&(q.add=q.clear=q.delete=function(){throw new Error("set is read-only")}),Object.freeze(q),Object.getOwnPropertyNames(q).forEach(fe=>{const ke=q[fe],et=typeof ke;(et==="object"||et==="function")&&!Object.isFrozen(ke)&&s(ke)}),q}class n{constructor(fe){fe.data===void 0&&(fe.data={}),this.data=fe.data,this.isMatchIgnored=false}ignoreMatch(){this.isMatchIgnored=true}}function i(q){return q.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;")}function o(q,...fe){const ke=Object.create(null);for(const et in q)ke[et]=q[et];return fe.forEach(function(et){for(const Ht in et)ke[Ht]=et[Ht]}),ke}const l="</span>",f=q=>!!q.scope,m=(q,{prefix:fe})=>{if(q.startsWith("language:"))return q.replace("language:","language-");if(q.includes(".")){const ke=q.split(".");return[`${fe}${ke.shift()}`,...ke.map((et,Ht)=>`${et}${"_".repeat(Ht+1)}`)].join(" ")}return`${fe}${q}`};class u{constructor(fe,ke){this.buffer="",this.classPrefix=ke.classPrefix,fe.walk(this)}addText(fe){this.buffer+=i(fe)}openNode(fe){if(!f(fe))return;const ke=m(fe.scope,{prefix:this.classPrefix});this.span(ke)}closeNode(fe){f(fe)&&(this.buffer+=l)}value(){return this.buffer}span(fe){this.buffer+=`<span class="${fe}">`}}const _=(q={})=>{const fe={children:[]};return Object.assign(fe,q),fe};class c{constructor(){this.rootNode=_(),this.stack=[this.rootNode]}get top(){return this.stack[this.stack.length-1]}get root(){return this.rootNode}add(fe){this.top.children.push(fe)}openNode(fe){const ke=_({scope:fe});this.add(ke),this.stack.push(ke)}closeNode(){if(this.stack.length>1)return this.stack.pop()}closeAllNodes(){for(;this.closeNode(););}toJSON(){return JSON.stringify(this.rootNode,null,4)}walk(fe){return this.constructor._walk(fe,this.rootNode)}static _walk(fe,ke){return typeof ke=="string"?fe.addText(ke):ke.children&&(fe.openNode(ke),ke.children.forEach(et=>this._walk(fe,et)),fe.closeNode(ke)),fe}static _collapse(fe){typeof fe!="string"&&fe.children&&(fe.children.every(ke=>typeof ke=="string")?fe.children=[fe.children.join("")]:fe.children.forEach(ke=>{c._collapse(ke)}))}}class h extends c{constructor(fe){super(),this.options=fe}addText(fe){fe!==""&&this.add(fe)}startScope(fe){this.openNode(fe)}endScope(){this.closeNode()}__addSublanguage(fe,ke){const et=fe.root;ke&&(et.scope=`language:${ke}`),this.add(et)}toHTML(){return new u(this,this.options).value()}finalize(){return this.closeAllNodes(),true}}function p(q){return q?typeof q=="string"?q:q.source:null}function T(q){return y("(?=",q,")")}function $(q){return y("(?:",q,")*")}function S(q){return y("(?:",q,")?")}function y(...q){return q.map(ke=>p(ke)).join("")}function g(q){const fe=q[q.length-1];return typeof fe=="object"&&fe.constructor===Object?(q.splice(q.length-1,1),fe):{}}function E(...q){return"("+(g(q).capture?"":"?:")+q.map(et=>p(et)).join("|")+")"}function v(q){return new RegExp(q.toString()+"|").exec("").length-1}function b(q,fe){const ke=q&&q.exec(fe);return ke&&ke.index===0}const R=/\[(?:[^\\\]]|\\.)*\]|\(\??|\\([1-9][0-9]*)|\\./;function O(q,{joinWith:fe}){let ke=0;return q.map(et=>{ke+=1;const Ht=ke;let Lt=p(et),Ge="";for(;Lt.length>0;){const Be=R.exec(Lt);if(!Be){Ge+=Lt;break}Ge+=Lt.substring(0,Be.index),Lt=Lt.substring(Be.index+Be[0].length),Be[0][0]==="\\"&&Be[1]?Ge+="\\"+String(Number(Be[1])+Ht):(Ge+=Be[0],Be[0]==="("&&ke++)}return Ge}).map(et=>`(${et})`).join(fe)}const w=/\b\B/,L="[a-zA-Z]\\w*",I="[a-zA-Z_]\\w*",k="\\b\\d+(\\.\\d+)?",x="(-?)(\\b0[xX][a-fA-F0-9]+|(\\b\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)",P="\\b(0b[01]+)",F="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|-|-=|/=|/|:|;|<<|<<=|<=|<|===|==|=|>>>=|>>=|>=|>>>|>>|>|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~",X=(q={})=>{const fe=/^#![ ]*\//;return q.binary&&(q.begin=y(fe,/.*\b/,q.binary,/\b.*/)),o({scope:"meta",begin:fe,end:/$/,relevance:0,"on:begin":(ke,et)=>{ke.index!==0&&et.ignoreMatch()}},q)},W={begin:"\\\\[\\s\\S]",relevance:0},z={scope:"string",begin:"'",end:"'",illegal:"\\n",contains:[W]},j={scope:"string",begin:'"',end:'"',illegal:"\\n",contains:[W]},J={begin:/\b(a|an|the|are|I'm|isn't|don't|doesn't|won't|but|just|should|pretty|simply|enough|gonna|going|wtf|so|such|will|you|your|they|like|more)\b/},M=function(q,fe,ke={}){const et=o({scope:"comment",begin:q,end:fe,contains:[]},ke);et.contains.push({scope:"doctag",begin:"[ ]*(?=(TODO|FIXME|NOTE|BUG|OPTIMIZE|HACK|XXX):)",end:/(TODO|FIXME|NOTE|BUG|OPTIMIZE|HACK|XXX):/,excludeBegin:true,relevance:0});const Ht=E("I","a","is","so","us","to","at","if","in","it","on",/[A-Za-z]+['](d|ve|re|ll|t|s|n)/,/[A-Za-z]+[-][a-z]+/,/[A-Za-z][a-z]{2,}/);return et.contains.push({begin:y(/[ ]+/,"(",Ht,/[.]?[:]?([.][ ]|[ ])/,"){3}")}),et},U=M("//","$"),V=M("/\\*","\\*/"),K=M("#","$"),H={scope:"number",begin:k,relevance:0},ie={scope:"number",begin:x,relevance:0},Ie={scope:"number",begin:P,relevance:0},he={scope:"regexp",begin:/\/(?=[^/\n]*\/)/,end:/\/[gimuy]*/,contains:[W,{begin:/\[/,end:/\]/,relevance:0,contains:[W]}]},st={scope:"title",begin:L,relevance:0},B={scope:"title",begin:I,relevance:0},te={begin:"\\.\\s*"+I,relevance:0};var ae=Object.freeze({__proto__:null,APOS_STRING_MODE:z,BACKSLASH_ESCAPE:W,BINARY_NUMBER_MODE:Ie,BINARY_NUMBER_RE:P,COMMENT:M,C_BLOCK_COMMENT_MODE:V,C_LINE_COMMENT_MODE:U,C_NUMBER_MODE:ie,C_NUMBER_RE:x,END_SAME_AS_BEGIN:function(q){return Object.assign(q,{"on:begin":(fe,ke)=>{ke.data._beginMatch=fe[1]},"on:end":(fe,ke)=>{ke.data._beginMatch!==fe[1]&&ke.ignoreMatch()}})},HASH_COMMENT_MODE:K,IDENT_RE:L,MATCH_NOTHING_RE:w,METHOD_GUARD:te,NUMBER_MODE:H,NUMBER_RE:k,PHRASAL_WORDS_MODE:J,QUOTE_STRING_MODE:j,REGEXP_MODE:he,RE_STARTERS_RE:F,SHEBANG:X,TITLE_MODE:st,UNDERSCORE_IDENT_RE:I,UNDERSCORE_TITLE_MODE:B});function Me(q,fe){q.input[q.index-1]==="."&&fe.ignoreMatch()}function Se(q,fe){q.className!==void 0&&(q.scope=q.className,delete q.className)}function nt(q,fe){fe&&q.beginKeywords&&(q.begin="\\b("+q.beginKeywords.split(" ").join("|")+")(?!\\.)(?=\\b|\\s)",q.__beforeBegin=Me,q.keywords=q.keywords||q.beginKeywords,delete q.beginKeywords,q.relevance===void 0&&(q.relevance=0))}function St(q,fe){Array.isArray(q.illegal)&&(q.illegal=E(...q.illegal))}function Ut(q,fe){if(q.match){if(q.begin||q.end)throw new Error("begin & end are not supported with match");q.begin=q.match,delete q.match}}function Jt(q,fe){q.relevance===void 0&&(q.relevance=1)}const We=(q,fe)=>{if(!q.beforeMatch)return;if(q.starts)throw new Error("beforeMatch cannot be used with starts");const ke=Object.assign({},q);Object.keys(q).forEach(et=>{delete q[et]}),q.keywords=ke.keywords,q.begin=y(ke.beforeMatch,T(ke.begin)),q.starts={relevance:0,contains:[Object.assign(ke,{endsParent:true})]},q.relevance=0,delete ke.beforeMatch},Is=["of","and","for","in","not","or","if","then","parent","list","value"],Cs="keyword";function Os(q,fe,ke=Cs){const et=Object.create(null);return typeof q=="string"?Ht(ke,q.split(" ")):Array.isArray(q)?Ht(ke,q):Object.keys(q).forEach(function(Lt){Object.assign(et,Os(q[Lt],fe,Lt))}),et;function Ht(Lt,Ge){fe&&(Ge=Ge.map(Be=>Be.toLowerCase())),Ge.forEach(function(Be){const $e=Be.split("|");et[$e[0]]=[Lt,xs($e[0],$e[1])]})}}function xs(q,fe){return fe?Number(fe):Ws(q)?0:1}function Ws(q){return Is.includes(q.toLowerCase())}const At={},be=q=>{console.error(q)},qe=(q,...fe)=>{console.log(`WARN: ${q}`,...fe)},ut=(q,fe)=>{At[`${q}/${fe}`]||(console.log(`Deprecated as of ${q}. ${fe}`),At[`${q}/${fe}`]=true)},jt=new Error;function Ee(q,fe,{key:ke}){let et=0;const Ht=q[ke],Lt={},Ge={};for(let Be=1;Be<=fe.length;Be++)Ge[Be+et]=Ht[Be],Lt[Be+et]=true,et+=v(fe[Be-1]);q[ke]=Ge,q[ke]._emit=Lt,q[ke]._multi=true}function fi(q){if(Array.isArray(q.begin)){if(q.skip||q.excludeBegin||q.returnBegin)throw be("skip, excludeBegin, returnBegin not compatible with beginScope: {}"),jt;if(typeof q.beginScope!="object"||q.beginScope===null)throw be("beginScope must be object"),jt;Ee(q,q.begin,{key:"beginScope"}),q.begin=O(q.begin,{joinWith:""})}}function fs(q){if(Array.isArray(q.end)){if(q.skip||q.excludeEnd||q.returnEnd)throw be("skip, excludeEnd, returnEnd not compatible with endScope: {}"),jt;if(typeof q.endScope!="object"||q.endScope===null)throw be("endScope must be object"),jt;Ee(q,q.end,{key:"endScope"}),q.end=O(q.end,{joinWith:""})}}function ws(q){q.scope&&typeof q.scope=="object"&&q.scope!==null&&(q.beginScope=q.scope,delete q.scope)}function Ot(q){ws(q),typeof q.beginScope=="string"&&(q.beginScope={_wrap:q.beginScope}),typeof q.endScope=="string"&&(q.endScope={_wrap:q.endScope}),fi(q),fs(q)}function xi(q){function fe(Ge,Be){return new RegExp(p(Ge),"m"+(q.case_insensitive?"i":"")+(q.unicodeRegex?"u":"")+(Be?"g":""))}class ke{constructor(){this.matchIndexes={},this.regexes=[],this.matchAt=1,this.position=0}addRule(Be,$e){$e.position=this.position++,this.matchIndexes[this.matchAt]=$e,this.regexes.push([$e,Be]),this.matchAt+=v(Be)+1}compile(){this.regexes.length===0&&(this.exec=()=>null);const Be=this.regexes.map($e=>$e[1]);this.matcherRe=fe(O(Be,{joinWith:"|"}),true),this.lastIndex=0}exec(Be){this.matcherRe.lastIndex=this.lastIndex;const $e=this.matcherRe.exec(Be);if(!$e)return null;const _s=$e.findIndex((or,$o)=>$o>0&&or!==void 0),Vt=this.matchIndexes[_s];return $e.splice(0,_s),Object.assign($e,Vt)}}class et{constructor(){this.rules=[],this.multiRegexes=[],this.count=0,this.lastIndex=0,this.regexIndex=0}getMatcher(Be){if(this.multiRegexes[Be])return this.multiRegexes[Be];const $e=new ke;return this.rules.slice(Be).forEach(([_s,Vt])=>$e.addRule(_s,Vt)),$e.compile(),this.multiRegexes[Be]=$e,$e}resumingScanAtSamePosition(){return this.regexIndex!==0}considerAll(){this.regexIndex=0}addRule(Be,$e){this.rules.push([Be,$e]),$e.type==="begin"&&this.count++}exec(Be){const $e=this.getMatcher(this.regexIndex);$e.lastIndex=this.lastIndex;let _s=$e.exec(Be);if(this.resumingScanAtSamePosition()&&!(_s&&_s.index===this.lastIndex)){const Vt=this.getMatcher(0);Vt.lastIndex=this.lastIndex+1,_s=Vt.exec(Be)}return _s&&(this.regexIndex+=_s.position+1,this.regexIndex===this.count&&this.considerAll()),_s}}function Ht(Ge){const Be=new et;return Ge.contains.forEach($e=>Be.addRule($e.begin,{rule:$e,type:"begin"})),Ge.terminatorEnd&&Be.addRule(Ge.terminatorEnd,{type:"end"}),Ge.illegal&&Be.addRule(Ge.illegal,{type:"illegal"}),Be}function Lt(Ge,Be){const $e=Ge;if(Ge.isCompiled)return $e;[Se,Ut,Ot,We].forEach(Vt=>Vt(Ge,Be)),q.compilerExtensions.forEach(Vt=>Vt(Ge,Be)),Ge.__beforeBegin=null,[nt,St,Jt].forEach(Vt=>Vt(Ge,Be)),Ge.isCompiled=true;let _s=null;return typeof Ge.keywords=="object"&&Ge.keywords.$pattern&&(Ge.keywords=Object.assign({},Ge.keywords),_s=Ge.keywords.$pattern,delete Ge.keywords.$pattern),_s=_s||/\w+/,Ge.keywords&&(Ge.keywords=Os(Ge.keywords,q.case_insensitive)),$e.keywordPatternRe=fe(_s,true),Be&&(Ge.begin||(Ge.begin=/\B|\b/),$e.beginRe=fe($e.begin),!Ge.end&&!Ge.endsWithParent&&(Ge.end=/\B|\b/),Ge.end&&($e.endRe=fe($e.end)),$e.terminatorEnd=p($e.end)||"",Ge.endsWithParent&&Be.terminatorEnd&&($e.terminatorEnd+=(Ge.end?"|":"")+Be.terminatorEnd)),Ge.illegal&&($e.illegalRe=fe(Ge.illegal)),Ge.contains||(Ge.contains=[]),Ge.contains=[].concat(...Ge.contains.map(function(Vt){return N(Vt==="self"?Ge:Vt)})),Ge.contains.forEach(function(Vt){Lt(Vt,$e)}),Ge.starts&&Lt(Ge.starts,Be),$e.matcher=Ht($e),$e}if(q.compilerExtensions||(q.compilerExtensions=[]),q.contains&&q.contains.includes("self"))throw new Error("ERR: contains `self` is not supported at the top-level of a language.  See documentation.");return q.classNameAliases=o(q.classNameAliases||{}),Lt(q)}function as(q){return q?q.endsWithParent||as(q.starts):false}function N(q){return q.variants&&!q.cachedVariants&&(q.cachedVariants=q.variants.map(function(fe){return o(q,{variants:null},fe)})),q.cachedVariants?q.cachedVariants:as(q)?o(q,{starts:q.starts?o(q.starts):null}):Object.isFrozen(q)?o(q):q}var G="11.11.1";class Z extends Error{constructor(fe,ke){super(fe),this.name="HTMLInjectionError",this.html=ke}}const oe=i,ce=o,Ue=Symbol("nomatch"),ti=7,Yi=function(q){const fe=Object.create(null),ke=Object.create(null),et=[];let Ht=true;const Lt="Could not find the language '{}', did you forget to load/include a language module?",Ge={disableAutodetect:true,name:"Plain text",contains:[]};let Be={ignoreUnescapedHTML:false,throwUnescapedHTML:false,noHighlightRe:/^(no-?highlight)$/i,languageDetectRe:/\blang(?:uage)?-([\w-]+)\b/i,classPrefix:"hljs-",cssSelector:"pre code",languages:null,__emitter:h};function $e(ye){return Be.noHighlightRe.test(ye)}function _s(ye){let Xe=ye.className+" ";Xe+=ye.parentNode?ye.parentNode.className:"";const ft=Be.languageDetectRe.exec(Xe);if(ft){const Re=Ei(ft[1]);return Re||(qe(Lt.replace("{}",ft[1])),qe("Falling back to no-highlight mode for this block.",ye)),Re?ft[1]:"no-highlight"}return Xe.split(/\s+/).find(Re=>$e(Re)||Ei(Re))}function Vt(ye,Xe,ft){let Re="",Qt="";typeof Xe=="object"?(Re=ye,ft=Xe.ignoreIllegals,Qt=Xe.language):(ut("10.7.0","highlight(lang, code, ...args) has been deprecated."),ut("10.7.0",`Please use highlight(code, options) instead.
https://github.com/highlightjs/highlight.js/issues/2277`),Qt=ye,Re=Xe),ft===void 0&&(ft=true);const vi={code:Re,language:Qt};He("before:highlight",vi);const gn=vi.result?vi.result:or(vi.language,vi.code,ft);return gn.code=vi.code,He("after:highlight",gn),gn}function or(ye,Xe,ft,Re){const Qt=Object.create(null);function vi(Ae,Fe){return Ae.keywords[Fe]}function gn(){if(!at.keywords){Es.addText(Mt);return}let Ae=0;at.keywordPatternRe.lastIndex=0;let Fe=at.keywordPatternRe.exec(Mt),ht="";for(;Fe;){ht+=Mt.substring(Ae,Fe.index);const $t=ii.case_insensitive?Fe[0].toLowerCase():Fe[0],Ts=vi(at,$t);if(Ts){const[bi,Ti]=Ts;if(Es.addText(ht),ht="",Qt[$t]=(Qt[$t]||0)+1,Qt[$t]<=ti&&(fn+=Ti),bi.startsWith("_"))ht+=Fe[0];else{const Ec=ii.classNameAliases[bi]||bi;ms(Fe[0],Ec)}}else ht+=Fe[0];Ae=at.keywordPatternRe.lastIndex,Fe=at.keywordPatternRe.exec(Mt)}ht+=Mt.substring(Ae),Es.addText(ht)}function Io(){if(Mt==="")return;let Ae=null;if(typeof at.subLanguage=="string"){if(!fe[at.subLanguage]){Es.addText(Mt);return}Ae=or(at.subLanguage,Mt,true,Na[at.subLanguage]),Na[at.subLanguage]=Ae._top}else Ae=pn(Mt,at.subLanguage.length?at.subLanguage:null);at.relevance>0&&(fn+=Ae.relevance),Es.__addSublanguage(Ae._emitter,Ae.language)}function ot(){at.subLanguage!=null?Io():gn(),Mt=""}function ms(Ae,Fe){Ae!==""&&(Es.startScope(Fe),Es.addText(Ae),Es.endScope())}function ka(Ae,Fe){let ht=1;const $t=Fe.length-1;for(;ht<=$t;){if(!Ae._emit[ht]){ht++;continue}const Ts=ii.classNameAliases[Ae[ht]]||Ae[ht],bi=Fe[ht];Ts?ms(bi,Ts):(Mt=bi,gn(),Mt=""),ht++}}function Aa(Ae,Fe){return Ae.scope&&typeof Ae.scope=="string"&&Es.openNode(ii.classNameAliases[Ae.scope]||Ae.scope),Ae.beginScope&&(Ae.beginScope._wrap?(ms(Mt,ii.classNameAliases[Ae.beginScope._wrap]||Ae.beginScope._wrap),Mt=""):Ae.beginScope._multi&&(ka(Ae.beginScope,Fe),Mt="")),at=Object.create(Ae,{parent:{value:at}}),at}function xr(Ae,Fe,ht){let $t=b(Ae.endRe,ht);if($t){if(Ae["on:end"]){const Ts=new n(Ae);Ae["on:end"](Fe,Ts),Ts.isMatchIgnored&&($t=false)}if($t){for(;Ae.endsParent&&Ae.parent;)Ae=Ae.parent;return Ae}}if(Ae.endsWithParent)return xr(Ae.parent,Fe,ht)}function Oh(Ae){return at.matcher.regexIndex===0?(Mt+=Ae[0],1):(Ma=true,0)}function La(Ae){const Fe=Ae[0],ht=Ae.rule,$t=new n(ht),Ts=[ht.__beforeBegin,ht["on:begin"]];for(const bi of Ts)if(bi&&(bi(Ae,$t),$t.isMatchIgnored))return Oh(Fe);return ht.skip?Mt+=Fe:(ht.excludeBegin&&(Mt+=Fe),ot(),!ht.returnBegin&&!ht.excludeBegin&&(Mt=Fe)),Aa(ht,Ae),ht.returnBegin?0:Fe.length}function wh(Ae){const Fe=Ae[0],ht=Xe.substring(Ae.index),$t=xr(at,Ae,ht);if(!$t)return Ue;const Ts=at;at.endScope&&at.endScope._wrap?(ot(),ms(Fe,at.endScope._wrap)):at.endScope&&at.endScope._multi?(ot(),ka(at.endScope,Ae)):Ts.skip?Mt+=Fe:(Ts.returnEnd||Ts.excludeEnd||(Mt+=Fe),ot(),Ts.excludeEnd&&(Mt=Fe));do at.scope&&Es.closeNode(),!at.skip&&!at.subLanguage&&(fn+=at.relevance),at=at.parent;while(at!==$t.parent);return $t.starts&&Aa($t.starts,Ae),Ts.returnEnd?0:Fe.length}function kh(){const Ae=[];for(let Fe=at;Fe!==ii;Fe=Fe.parent)Fe.scope&&Ae.unshift(Fe.scope);Ae.forEach(Fe=>Es.openNode(Fe))}let ar={};function mc(Ae,Fe){const ht=Fe&&Fe[0];if(Mt+=Ae,ht==null)return ot(),0;if(ar.type==="begin"&&Fe.type==="end"&&ar.index===Fe.index&&ht===""){if(Mt+=Xe.slice(Fe.index,Fe.index+1),!Ht){const $t=new Error(`0 width match regex (${ye})`);throw $t.languageName=ye,$t.badRule=ar.rule,$t}return 1}if(ar=Fe,Fe.type==="begin")return La(Fe);if(Fe.type==="illegal"&&!ft){const $t=new Error('Illegal lexeme "'+ht+'" for mode "'+(at.scope||"<unnamed>")+'"');throw $t.mode=at,$t}else if(Fe.type==="end"){const $t=wh(Fe);if($t!==Ue)return $t}if(Fe.type==="illegal"&&ht==="")return Mt+=`
`,1;if(Pr>1e5&&Pr>Fe.index*3)throw new Error("potential infinite loop, way more iterations than matches");return Mt+=ht,ht.length}const ii=Ei(ye);if(!ii)throw be(Lt.replace("{}",ye)),new Error('Unknown language: "'+ye+'"');const Ah=xi(ii);let Br="",at=Re||Ah;const Na={},Es=new Be.__emitter(Be);kh();let Mt="",fn=0,mn=0,Pr=0,Ma=false;try{if(ii.__emitTokens)ii.__emitTokens(Xe,Es);else{for(at.matcher.considerAll();;){Pr++,Ma?Ma=false:at.matcher.considerAll(),at.matcher.lastIndex=mn;const Ae=at.matcher.exec(Xe);if(!Ae)break;const Fe=Xe.substring(mn,Ae.index),ht=mc(Fe,Ae);mn=Ae.index+ht}mc(Xe.substring(mn))}return Es.finalize(),Br=Es.toHTML(),{language:ye,value:Br,relevance:fn,illegal:false,_emitter:Es,_top:at}}catch(Ae){if(Ae.message&&Ae.message.includes("Illegal"))return{language:ye,value:oe(Xe),illegal:true,relevance:0,_illegalBy:{message:Ae.message,index:mn,context:Xe.slice(mn-100,mn+100),mode:Ae.mode,resultSoFar:Br},_emitter:Es};if(Ht)return{language:ye,value:oe(Xe),illegal:false,relevance:0,errorRaised:Ae,_emitter:Es,_top:at};throw Ae}}function $o(ye){const Xe={value:oe(ye),illegal:false,relevance:0,_top:Ge,_emitter:new Be.__emitter(Be)};return Xe._emitter.addText(ye),Xe}function pn(ye,Xe){Xe=Xe||Be.languages||Object.keys(fe);const ft=$o(ye),Re=Xe.filter(Ei).filter(Zt).map(ot=>or(ot,ye,false));Re.unshift(ft);const Qt=Re.sort((ot,ms)=>{if(ot.relevance!==ms.relevance)return ms.relevance-ot.relevance;if(ot.language&&ms.language){if(Ei(ot.language).supersetOf===ms.language)return 1;if(Ei(ms.language).supersetOf===ot.language)return-1}return 0}),[vi,gn]=Qt,Io=vi;return Io.secondBest=gn,Io}function yo(ye,Xe,ft){const Re=Xe&&ke[Xe]||ft;ye.classList.add("hljs"),ye.classList.add(`language-${Re}`)}function Mr(ye){let Xe=null;const ft=_s(ye);if($e(ft))return;if(He("before:highlightElement",{el:ye,language:ft}),ye.dataset.highlighted){console.log("Element previously highlighted. To highlight again, first unset `dataset.highlighted`.",ye);return}if(ye.children.length>0&&(Be.ignoreUnescapedHTML||(console.warn("One of your code blocks includes unescaped HTML. This is a potentially serious security risk."),console.warn("https://github.com/highlightjs/highlight.js/wiki/security"),console.warn("The element with unescaped HTML:"),console.warn(ye)),Be.throwUnescapedHTML))throw new Z("One of your code blocks includes unescaped HTML.",ye.innerHTML);Xe=ye;const Re=Xe.textContent,Qt=ft?Vt(Re,{language:ft,ignoreIllegals:true}):pn(Re);ye.innerHTML=Qt.value,ye.dataset.highlighted="yes",yo(ye,ft,Qt.language),ye.result={language:Qt.language,re:Qt.relevance,relevance:Qt.relevance},Qt.secondBest&&(ye.secondBest={language:Qt.secondBest.language,relevance:Qt.secondBest.relevance}),He("after:highlightElement",{el:ye,result:Qt,text:Re})}function si(ye){Be=ce(Be,ye)}const Dr=()=>{Ps(),ut("10.6.0","initHighlighting() deprecated.  Use highlightAll() now.")};function mi(){Ps(),ut("10.6.0","initHighlightingOnLoad() deprecated.  Use highlightAll() now.")}let Bs=false;function Ps(){function ye(){Ps()}if(document.readyState==="loading"){Bs||window.addEventListener("DOMContentLoaded",ye,false),Bs=true;return}document.querySelectorAll(Be.cssSelector).forEach(Mr)}function Pe(ye,Xe){let ft=null;try{ft=Xe(q)}catch(Re){if(be("Language definition for '{}' could not be registered.".replace("{}",ye)),Ht)be(Re);else throw Re;ft=Ge}ft.name||(ft.name=ye),fe[ye]=ft,ft.rawDefinition=Xe.bind(null,q),ft.aliases&&Ro(ft.aliases,{languageName:ye})}function Ih(ye){delete fe[ye];for(const Xe of Object.keys(ke))ke[Xe]===ye&&delete ke[Xe]}function fc(){return Object.keys(fe)}function Ei(ye){return ye=(ye||"").toLowerCase(),fe[ye]||fe[ke[ye]]}function Ro(ye,{languageName:Xe}){typeof ye=="string"&&(ye=[ye]),ye.forEach(ft=>{ke[ft.toLowerCase()]=Xe})}function Zt(ye){const Xe=Ei(ye);return Xe&&!Xe.disableAutodetect}function ss(ye){ye["before:highlightBlock"]&&!ye["before:highlightElement"]&&(ye["before:highlightElement"]=Xe=>{ye["before:highlightBlock"](Object.assign({block:Xe.el},Xe))}),ye["after:highlightBlock"]&&!ye["after:highlightElement"]&&(ye["after:highlightElement"]=Xe=>{ye["after:highlightBlock"](Object.assign({block:Xe.el},Xe))})}function ls(ye){ss(ye),et.push(ye)}function Ft(ye){const Xe=et.indexOf(ye);Xe!==-1&&et.splice(Xe,1)}function He(ye,Xe){const ft=ye;et.forEach(function(Re){Re[ft]&&Re[ft](Xe)})}function Ch(ye){return ut("10.7.0","highlightBlock will be removed entirely in v12.0"),ut("10.7.0","Please use highlightElement now."),Mr(ye)}Object.assign(q,{highlight:Vt,highlightAuto:pn,highlightAll:Ps,highlightElement:Mr,highlightBlock:Ch,configure:si,initHighlighting:Dr,initHighlightingOnLoad:mi,registerLanguage:Pe,unregisterLanguage:Ih,listLanguages:fc,getLanguage:Ei,registerAliases:Ro,autoDetection:Zt,inherit:ce,addPlugin:ls,removePlugin:Ft}),q.debugMode=function(){Ht=false},q.safeMode=function(){Ht=true},q.versionString=G,q.regex={concat:y,lookahead:T,either:E,optional:S,anyNumberOfTimes:$};for(const ye in ae)typeof ae[ye]=="object"&&s(ae[ye]);return Object.assign(q,ae),q},qi=Yi({});return qi.newInstance=()=>Yi({}),$g=qi,qi.HighlightJS=qi,qi.default=qi,$g}var yg,A$;function IF(){if(A$)return yg;A$=1;function s(n){const i=n.regex,o=i.concat(/[\p{L}_]/u,i.optional(/[\p{L}0-9_.-]*:/u),/[\p{L}0-9_.-]*/u),l=/[\p{L}0-9._:-]+/u,f={className:"symbol",begin:/&[a-z]+;|&#[0-9]+;|&#x[a-f0-9]+;/},m={begin:/\s/,contains:[{className:"keyword",begin:/#?[a-z_][a-z1-9_-]+/,illegal:/\n/}]},u=n.inherit(m,{begin:/\(/,end:/\)/}),_=n.inherit(n.APOS_STRING_MODE,{className:"string"}),c=n.inherit(n.QUOTE_STRING_MODE,{className:"string"}),h={endsWithParent:true,illegal:/</,relevance:0,contains:[{className:"attr",begin:l,relevance:0},{begin:/=\s*/,relevance:0,contains:[{className:"string",endsParent:true,variants:[{begin:/"/,end:/"/,contains:[f]},{begin:/'/,end:/'/,contains:[f]},{begin:/[^\s"'=<>`]+/}]}]}]};return{name:"HTML, XML",aliases:["html","xhtml","rss","atom","xjb","xsd","xsl","plist","wsf","svg"],case_insensitive:true,unicodeRegex:true,contains:[{className:"meta",begin:/<![a-z]/,end:/>/,relevance:10,contains:[m,c,_,u,{begin:/\[/,end:/\]/,contains:[{className:"meta",begin:/<![a-z]/,end:/>/,contains:[m,u,c,_]}]}]},n.COMMENT(/<!--/,/-->/,{relevance:10}),{begin:/<!\[CDATA\[/,end:/\]\]>/,relevance:10},f,{className:"meta",end:/\?>/,variants:[{begin:/<\?xml/,relevance:10,contains:[c]},{begin:/<\?[a-z][a-z0-9]+/}]},{className:"tag",begin:/<style(?=\s|>)/,end:/>/,keywords:{name:"style"},contains:[h],starts:{end:/<\/style>/,returnEnd:true,subLanguage:["css","xml"]}},{className:"tag",begin:/<script(?=\s|>)/,end:/>/,keywords:{name:"script"},contains:[h],starts:{end:/<\/script>/,returnEnd:true,subLanguage:["javascript","handlebars","xml"]}},{className:"tag",begin:/<>|<\/>/},{className:"tag",begin:i.concat(/</,i.lookahead(i.concat(o,i.either(/\/>/,/>/,/\s/)))),end:/\/?>/,contains:[{className:"name",begin:o,relevance:0,starts:h}]},{className:"tag",begin:i.concat(/<\//,i.lookahead(i.concat(o,/>/))),contains:[{className:"name",begin:o,relevance:0},{begin:/>/,relevance:0,endsParent:true}]}]}}return yg=s,yg}var Rg,L$;function CF(){if(L$)return Rg;L$=1;function s(n){const i=n.regex,o={},l={begin:/\$\{/,end:/\}/,contains:["self",{begin:/:-/,contains:[o]}]};Object.assign(o,{className:"variable",variants:[{begin:i.concat(/\$[\w\d#@][\w\d_]*/,"(?![\\w\\d])(?![$])")},l]});const f={className:"subst",begin:/\$\(/,end:/\)/,contains:[n.BACKSLASH_ESCAPE]},m=n.inherit(n.COMMENT(),{match:[/(^|\s)/,/#.*$/],scope:{2:"comment"}}),u={begin:/<<-?\s*(?=\w+)/,starts:{contains:[n.END_SAME_AS_BEGIN({begin:/(\w+)/,end:/(\w+)/,className:"string"})]}},_={className:"string",begin:/"/,end:/"/,contains:[n.BACKSLASH_ESCAPE,o,f]};f.contains.push(_);const c={match:/\\"/},h={className:"string",begin:/'/,end:/'/},p={match:/\\'/},T={begin:/\$?\(\(/,end:/\)\)/,contains:[{begin:/\d+#[0-9a-f]+/,className:"number"},n.NUMBER_MODE,o]},$=["fish","bash","zsh","sh","csh","ksh","tcsh","dash","scsh"],S=n.SHEBANG({binary:`(${$.join("|")})`,relevance:10}),y={className:"function",begin:/\w[\w\d_]*\s*\(\s*\)\s*\{/,returnBegin:true,contains:[n.inherit(n.TITLE_MODE,{begin:/\w[\w\d_]*/})],relevance:0},g=["if","then","else","elif","fi","time","for","while","until","in","do","done","case","esac","coproc","function","select"],E=["true","false"],v={match:/(\/[a-z._-]+)+/},b=["break","cd","continue","eval","exec","exit","export","getopts","hash","pwd","readonly","return","shift","test","times","trap","umask","unset"],R=["alias","bind","builtin","caller","command","declare","echo","enable","help","let","local","logout","mapfile","printf","read","readarray","source","sudo","type","typeset","ulimit","unalias"],O=["autoload","bg","bindkey","bye","cap","chdir","clone","comparguments","compcall","compctl","compdescribe","compfiles","compgroups","compquote","comptags","comptry","compvalues","dirs","disable","disown","echotc","echoti","emulate","fc","fg","float","functions","getcap","getln","history","integer","jobs","kill","limit","log","noglob","popd","print","pushd","pushln","rehash","sched","setcap","setopt","stat","suspend","ttyctl","unfunction","unhash","unlimit","unsetopt","vared","wait","whence","where","which","zcompile","zformat","zftp","zle","zmodload","zparseopts","zprof","zpty","zregexparse","zsocket","zstyle","ztcp"],w=["chcon","chgrp","chown","chmod","cp","dd","df","dir","dircolors","ln","ls","mkdir","mkfifo","mknod","mktemp","mv","realpath","rm","rmdir","shred","sync","touch","truncate","vdir","b2sum","base32","base64","cat","cksum","comm","csplit","cut","expand","fmt","fold","head","join","md5sum","nl","numfmt","od","paste","ptx","pr","sha1sum","sha224sum","sha256sum","sha384sum","sha512sum","shuf","sort","split","sum","tac","tail","tr","tsort","unexpand","uniq","wc","arch","basename","chroot","date","dirname","du","echo","env","expr","factor","groups","hostid","id","link","logname","nice","nohup","nproc","pathchk","pinky","printenv","printf","pwd","readlink","runcon","seq","sleep","stat","stdbuf","stty","tee","test","timeout","tty","uname","unlink","uptime","users","who","whoami","yes"];return{name:"Bash",aliases:["sh","zsh"],keywords:{$pattern:/\b[a-z][a-z0-9._-]+\b/,keyword:g,literal:E,built_in:[...b,...R,"set","shopt",...O,...w]},contains:[S,n.SHEBANG(),y,T,m,u,v,_,c,h,p,o]}}return Rg=s,Rg}var Ig,N$;function OF(){if(N$)return Ig;N$=1;function s(n){const i=n.regex,o=n.COMMENT("//","$",{contains:[{begin:/\\\n/}]}),l="decltype\\(auto\\)",f="[a-zA-Z_]\\w*::",u="("+l+"|"+i.optional(f)+"[a-zA-Z_]\\w*"+i.optional("<[^<>]+>")+")",_={className:"type",variants:[{begin:"\\b[a-z\\d_]*_t\\b"},{match:/\batomic_[a-z]{3,6}\b/}]},h={className:"string",variants:[{begin:'(u8?|U|L)?"',end:'"',illegal:"\\n",contains:[n.BACKSLASH_ESCAPE]},{begin:"(u8?|U|L)?'(\\\\(x[0-9A-Fa-f]{2}|u[0-9A-Fa-f]{4,8}|[0-7]{3}|\\S)|.)",end:"'",illegal:"."},n.END_SAME_AS_BEGIN({begin:/(?:u8?|U|L)?R"([^()\\ ]{0,16})\(/,end:/\)([^()\\ ]{0,16})"/})]},p={className:"number",variants:[{match:/\b(0b[01']+)/},{match:/(-?)\b([\d']+(\.[\d']*)?|\.[\d']+)((ll|LL|l|L)(u|U)?|(u|U)(ll|LL|l|L)?|f|F|b|B)/},{match:/(-?)\b(0[xX][a-fA-F0-9]+(?:'[a-fA-F0-9]+)*(?:\.[a-fA-F0-9]*(?:'[a-fA-F0-9]*)*)?(?:[pP][-+]?[0-9]+)?(l|L)?(u|U)?)/},{match:/(-?)\b\d+(?:'\d+)*(?:\.\d*(?:'\d*)*)?(?:[eE][-+]?\d+)?/}],relevance:0},T={className:"meta",begin:/#\s*[a-z]+\b/,end:/$/,keywords:{keyword:"if else elif endif define undef warning error line pragma _Pragma ifdef ifndef elifdef elifndef include"},contains:[{begin:/\\\n/,relevance:0},n.inherit(h,{className:"string"}),{className:"string",begin:/<.*?>/},o,n.C_BLOCK_COMMENT_MODE]},$={className:"title",begin:i.optional(f)+n.IDENT_RE,relevance:0},S=i.optional(f)+n.IDENT_RE+"\\s*\\(",E={keyword:["asm","auto","break","case","continue","default","do","else","enum","extern","for","fortran","goto","if","inline","register","restrict","return","sizeof","typeof","typeof_unqual","struct","switch","typedef","union","volatile","while","_Alignas","_Alignof","_Atomic","_Generic","_Noreturn","_Static_assert","_Thread_local","alignas","alignof","noreturn","static_assert","thread_local","_Pragma"],type:["float","double","signed","unsigned","int","short","long","char","void","_Bool","_BitInt","_Complex","_Imaginary","_Decimal32","_Decimal64","_Decimal96","_Decimal128","_Decimal64x","_Decimal128x","_Float16","_Float32","_Float64","_Float128","_Float32x","_Float64x","_Float128x","const","static","constexpr","complex","bool","imaginary"],literal:"true false NULL",built_in:"std string wstring cin cout cerr clog stdin stdout stderr stringstream istringstream ostringstream auto_ptr deque list queue stack vector map set pair bitset multiset multimap unordered_set unordered_map unordered_multiset unordered_multimap priority_queue make_pair array shared_ptr abort terminate abs acos asin atan2 atan calloc ceil cosh cos exit exp fabs floor fmod fprintf fputs free frexp fscanf future isalnum isalpha iscntrl isdigit isgraph islower isprint ispunct isspace isupper isxdigit tolower toupper labs ldexp log10 log malloc realloc memchr memcmp memcpy memset modf pow printf putchar puts scanf sinh sin snprintf sprintf sqrt sscanf strcat strchr strcmp strcpy strcspn strlen strncat strncmp strncpy strpbrk strrchr strspn strstr tanh tan vfprintf vprintf vsprintf endl initializer_list unique_ptr"},v=[T,_,o,n.C_BLOCK_COMMENT_MODE,p,h],b={variants:[{begin:/=/,end:/;/},{begin:/\(/,end:/\)/},{beginKeywords:"new throw return else",end:/;/}],keywords:E,contains:v.concat([{begin:/\(/,end:/\)/,keywords:E,contains:v.concat(["self"]),relevance:0}]),relevance:0},R={begin:"("+u+"[\\*&\\s]+)+"+S,returnBegin:true,end:/[{;=]/,excludeEnd:true,keywords:E,illegal:/[^\w\s\*&:<>.]/,contains:[{begin:l,keywords:E,relevance:0},{begin:S,returnBegin:true,contains:[n.inherit($,{className:"title.function"})],relevance:0},{relevance:0,match:/,/},{className:"params",begin:/\(/,end:/\)/,keywords:E,relevance:0,contains:[o,n.C_BLOCK_COMMENT_MODE,h,p,_,{begin:/\(/,end:/\)/,keywords:E,relevance:0,contains:["self",o,n.C_BLOCK_COMMENT_MODE,h,p,_]}]},_,o,n.C_BLOCK_COMMENT_MODE,T]};return{name:"C",aliases:["h"],keywords:E,disableAutodetect:true,illegal:"</",contains:[].concat(b,R,v,[T,{begin:n.IDENT_RE+"::",keywords:E},{className:"class",beginKeywords:"enum class struct union",end:/[{;:<>=]/,contains:[{beginKeywords:"final class struct"},n.TITLE_MODE]}]),exports:{preprocessor:T,strings:h,keywords:E}}}return Ig=s,Ig}var Cg,M$;function wF(){if(M$)return Cg;M$=1;function s(n){const i=n.regex,o=n.COMMENT("//","$",{contains:[{begin:/\\\n/}]}),l="decltype\\(auto\\)",f="[a-zA-Z_]\\w*::",u="(?!struct)("+l+"|"+i.optional(f)+"[a-zA-Z_]\\w*"+i.optional("<[^<>]+>")+")",_={className:"type",begin:"\\b[a-z\\d_]*_t\\b"},h={className:"string",variants:[{begin:'(u8?|U|L)?"',end:'"',illegal:"\\n",contains:[n.BACKSLASH_ESCAPE]},{begin:"(u8?|U|L)?'(\\\\(x[0-9A-Fa-f]{2}|u[0-9A-Fa-f]{4,8}|[0-7]{3}|\\S)|.)",end:"'",illegal:"."},n.END_SAME_AS_BEGIN({begin:/(?:u8?|U|L)?R"([^()\\ ]{0,16})\(/,end:/\)([^()\\ ]{0,16})"/})]},p={className:"number",variants:[{begin:"[+-]?(?:(?:[0-9](?:'?[0-9])*\\.(?:[0-9](?:'?[0-9])*)?|\\.[0-9](?:'?[0-9])*)(?:[Ee][+-]?[0-9](?:'?[0-9])*)?|[0-9](?:'?[0-9])*[Ee][+-]?[0-9](?:'?[0-9])*|0[Xx](?:[0-9A-Fa-f](?:'?[0-9A-Fa-f])*(?:\\.(?:[0-9A-Fa-f](?:'?[0-9A-Fa-f])*)?)?|\\.[0-9A-Fa-f](?:'?[0-9A-Fa-f])*)[Pp][+-]?[0-9](?:'?[0-9])*)(?:[Ff](?:16|32|64|128)?|(BF|bf)16|[Ll]|)"},{begin:"[+-]?\\b(?:0[Bb][01](?:'?[01])*|0[Xx][0-9A-Fa-f](?:'?[0-9A-Fa-f])*|0(?:'?[0-7])*|[1-9](?:'?[0-9])*)(?:[Uu](?:LL?|ll?)|[Uu][Zz]?|(?:LL?|ll?)[Uu]?|[Zz][Uu]|)"}],relevance:0},T={className:"meta",begin:/#\s*[a-z]+\b/,end:/$/,keywords:{keyword:"if else elif endif define undef warning error line pragma _Pragma ifdef ifndef include"},contains:[{begin:/\\\n/,relevance:0},n.inherit(h,{className:"string"}),{className:"string",begin:/<.*?>/},o,n.C_BLOCK_COMMENT_MODE]},$={className:"title",begin:i.optional(f)+n.IDENT_RE,relevance:0},S=i.optional(f)+n.IDENT_RE+"\\s*\\(",y=["alignas","alignof","and","and_eq","asm","atomic_cancel","atomic_commit","atomic_noexcept","auto","bitand","bitor","break","case","catch","class","co_await","co_return","co_yield","compl","concept","const_cast|10","consteval","constexpr","constinit","continue","decltype","default","delete","do","dynamic_cast|10","else","enum","explicit","export","extern","false","final","for","friend","goto","if","import","inline","module","mutable","namespace","new","noexcept","not","not_eq","nullptr","operator","or","or_eq","override","private","protected","public","reflexpr","register","reinterpret_cast|10","requires","return","sizeof","static_assert","static_cast|10","struct","switch","synchronized","template","this","thread_local","throw","transaction_safe","transaction_safe_dynamic","true","try","typedef","typeid","typename","union","using","virtual","volatile","while","xor","xor_eq"],g=["bool","char","char16_t","char32_t","char8_t","double","float","int","long","short","void","wchar_t","unsigned","signed","const","static"],E=["any","auto_ptr","barrier","binary_semaphore","bitset","complex","condition_variable","condition_variable_any","counting_semaphore","deque","false_type","flat_map","flat_set","future","imaginary","initializer_list","istringstream","jthread","latch","lock_guard","multimap","multiset","mutex","optional","ostringstream","packaged_task","pair","promise","priority_queue","queue","recursive_mutex","recursive_timed_mutex","scoped_lock","set","shared_future","shared_lock","shared_mutex","shared_timed_mutex","shared_ptr","stack","string_view","stringstream","timed_mutex","thread","true_type","tuple","unique_lock","unique_ptr","unordered_map","unordered_multimap","unordered_multiset","unordered_set","variant","vector","weak_ptr","wstring","wstring_view"],v=["abort","abs","acos","apply","as_const","asin","atan","atan2","calloc","ceil","cerr","cin","clog","cos","cosh","cout","declval","endl","exchange","exit","exp","fabs","floor","fmod","forward","fprintf","fputs","free","frexp","fscanf","future","invoke","isalnum","isalpha","iscntrl","isdigit","isgraph","islower","isprint","ispunct","isspace","isupper","isxdigit","labs","launder","ldexp","log","log10","make_pair","make_shared","make_shared_for_overwrite","make_tuple","make_unique","malloc","memchr","memcmp","memcpy","memset","modf","move","pow","printf","putchar","puts","realloc","scanf","sin","sinh","snprintf","sprintf","sqrt","sscanf","std","stderr","stdin","stdout","strcat","strchr","strcmp","strcpy","strcspn","strlen","strncat","strncmp","strncpy","strpbrk","strrchr","strspn","strstr","swap","tan","tanh","terminate","to_underlying","tolower","toupper","vfprintf","visit","vprintf","vsprintf"],O={type:g,keyword:y,literal:["NULL","false","nullopt","nullptr","true"],built_in:["_Pragma"],_type_hints:E},w={className:"function.dispatch",relevance:0,keywords:{_hint:v},begin:i.concat(/\b/,/(?!decltype)/,/(?!if)/,/(?!for)/,/(?!switch)/,/(?!while)/,n.IDENT_RE,i.lookahead(/(<[^<>]+>|)\s*\(/))},L=[w,T,_,o,n.C_BLOCK_COMMENT_MODE,p,h],I={variants:[{begin:/=/,end:/;/},{begin:/\(/,end:/\)/},{beginKeywords:"new throw return else",end:/;/}],keywords:O,contains:L.concat([{begin:/\(/,end:/\)/,keywords:O,contains:L.concat(["self"]),relevance:0}]),relevance:0},k={className:"function",begin:"("+u+"[\\*&\\s]+)+"+S,returnBegin:true,end:/[{;=]/,excludeEnd:true,keywords:O,illegal:/[^\w\s\*&:<>.]/,contains:[{begin:l,keywords:O,relevance:0},{begin:S,returnBegin:true,contains:[$],relevance:0},{begin:/::/,relevance:0},{begin:/:/,endsWithParent:true,contains:[h,p]},{relevance:0,match:/,/},{className:"params",begin:/\(/,end:/\)/,keywords:O,relevance:0,contains:[o,n.C_BLOCK_COMMENT_MODE,h,p,_,{begin:/\(/,end:/\)/,keywords:O,relevance:0,contains:["self",o,n.C_BLOCK_COMMENT_MODE,h,p,_]}]},_,o,n.C_BLOCK_COMMENT_MODE,T]};return{name:"C++",aliases:["cc","c++","h++","hpp","hh","hxx","cxx"],keywords:O,illegal:"</",classNameAliases:{"function.dispatch":"built_in"},contains:[].concat(I,k,w,L,[T,{begin:"\\b(deque|list|queue|priority_queue|pair|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array|tuple|optional|variant|function|flat_map|flat_set)\\s*<(?!<)",end:">",keywords:O,contains:["self",_]},{begin:n.IDENT_RE+"::",keywords:O},{match:[/\b(?:enum(?:\s+(?:class|struct))?|class|struct|union)/,/\s+/,/\w+/],className:{1:"keyword",3:"title.class"}}])}}return Cg=s,Cg}var Og,D$;function kF(){if(D$)return Og;D$=1;function s(n){const i=["bool","byte","char","decimal","delegate","double","dynamic","enum","float","int","long","nint","nuint","object","sbyte","short","string","ulong","uint","ushort"],o=["public","private","protected","static","internal","protected","abstract","async","extern","override","unsafe","virtual","new","sealed","partial"],l=["default","false","null","true"],f=["abstract","as","base","break","case","catch","class","const","continue","do","else","event","explicit","extern","finally","fixed","for","foreach","goto","if","implicit","in","interface","internal","is","lock","namespace","new","operator","out","override","params","private","protected","public","readonly","record","ref","return","scoped","sealed","sizeof","stackalloc","static","struct","switch","this","throw","try","typeof","unchecked","unsafe","using","virtual","void","volatile","while"],m=["add","alias","and","ascending","args","async","await","by","descending","dynamic","equals","file","from","get","global","group","init","into","join","let","nameof","not","notnull","on","or","orderby","partial","record","remove","required","scoped","select","set","unmanaged","value|0","var","when","where","with","yield"],u={keyword:f.concat(m),built_in:i,literal:l},_=n.inherit(n.TITLE_MODE,{begin:"[a-zA-Z](\\.?\\w)*"}),c={className:"number",variants:[{begin:"\\b(0b[01']+)"},{begin:"(-?)\\b([\\d']+(\\.[\\d']*)?|\\.[\\d']+)(u|U|l|L|ul|UL|f|F|b|B)"},{begin:"(-?)(\\b0[xX][a-fA-F0-9']+|(\\b[\\d']+(\\.[\\d']*)?|\\.[\\d']+)([eE][-+]?[\\d']+)?)"}],relevance:0},h={className:"string",begin:/"""("*)(?!")(.|\n)*?"""\1/,relevance:1},p={className:"string",begin:'@"',end:'"',contains:[{begin:'""'}]},T=n.inherit(p,{illegal:/\n/}),$={className:"subst",begin:/\{/,end:/\}/,keywords:u},S=n.inherit($,{illegal:/\n/}),y={className:"string",begin:/\$"/,end:'"',illegal:/\n/,contains:[{begin:/\{\{/},{begin:/\}\}/},n.BACKSLASH_ESCAPE,S]},g={className:"string",begin:/\$@"/,end:'"',contains:[{begin:/\{\{/},{begin:/\}\}/},{begin:'""'},$]},E=n.inherit(g,{illegal:/\n/,contains:[{begin:/\{\{/},{begin:/\}\}/},{begin:'""'},S]});$.contains=[g,y,p,n.APOS_STRING_MODE,n.QUOTE_STRING_MODE,c,n.C_BLOCK_COMMENT_MODE],S.contains=[E,y,T,n.APOS_STRING_MODE,n.QUOTE_STRING_MODE,c,n.inherit(n.C_BLOCK_COMMENT_MODE,{illegal:/\n/})];const v={variants:[h,g,y,p,n.APOS_STRING_MODE,n.QUOTE_STRING_MODE]},b={begin:"<",end:">",contains:[{beginKeywords:"in out"},_]},R=n.IDENT_RE+"(<"+n.IDENT_RE+"(\\s*,\\s*"+n.IDENT_RE+")*>)?(\\[\\])?",O={begin:"@"+n.IDENT_RE,relevance:0};return{name:"C#",aliases:["cs","c#"],keywords:u,illegal:/::/,contains:[n.COMMENT("///","$",{returnBegin:true,contains:[{className:"doctag",variants:[{begin:"///",relevance:0},{begin:"<!--|-->"},{begin:"</?",end:">"}]}]}),n.C_LINE_COMMENT_MODE,n.C_BLOCK_COMMENT_MODE,{className:"meta",begin:"#",end:"$",keywords:{keyword:"if else elif endif define undef warning error line region endregion pragma checksum"}},v,c,{beginKeywords:"class interface",relevance:0,end:/[{;=]/,illegal:/[^\s:,]/,contains:[{beginKeywords:"where class"},_,b,n.C_LINE_COMMENT_MODE,n.C_BLOCK_COMMENT_MODE]},{beginKeywords:"namespace",relevance:0,end:/[{;=]/,illegal:/[^\s:]/,contains:[_,n.C_LINE_COMMENT_MODE,n.C_BLOCK_COMMENT_MODE]},{beginKeywords:"record",relevance:0,end:/[{;=]/,illegal:/[^\s:]/,contains:[_,b,n.C_LINE_COMMENT_MODE,n.C_BLOCK_COMMENT_MODE]},{className:"meta",begin:"^\\s*\\[(?=[\\w])",excludeBegin:true,end:"\\]",excludeEnd:true,contains:[{className:"string",begin:/"/,end:/"/}]},{beginKeywords:"new return throw await else",relevance:0},{className:"function",begin:"("+R+"\\s+)+"+n.IDENT_RE+"\\s*(<[^=]+>\\s*)?\\(",returnBegin:true,end:/\s*[{;=]/,excludeEnd:true,keywords:u,contains:[{beginKeywords:o.join(" "),relevance:0},{begin:n.IDENT_RE+"\\s*(<[^=]+>\\s*)?\\(",returnBegin:true,contains:[n.TITLE_MODE,b],relevance:0},{match:/\(\)/},{className:"params",begin:/\(/,end:/\)/,excludeBegin:true,excludeEnd:true,keywords:u,relevance:0,contains:[v,c,n.C_BLOCK_COMMENT_MODE]},n.C_LINE_COMMENT_MODE,n.C_BLOCK_COMMENT_MODE]},O]}}return Og=s,Og}var wg,x$;function AF(){if(x$)return wg;x$=1;const s=c=>({IMPORTANT:{scope:"meta",begin:"!important"},BLOCK_COMMENT:c.C_BLOCK_COMMENT_MODE,HEXCOLOR:{scope:"number",begin:/#(([0-9a-fA-F]{3,4})|(([0-9a-fA-F]{2}){3,4}))\b/},FUNCTION_DISPATCH:{className:"built_in",begin:/[\w-]+(?=\()/},ATTRIBUTE_SELECTOR_MODE:{scope:"selector-attr",begin:/\[/,end:/\]/,illegal:"$",contains:[c.APOS_STRING_MODE,c.QUOTE_STRING_MODE]},CSS_NUMBER_MODE:{scope:"number",begin:c.NUMBER_RE+"(%|em|ex|ch|rem|vw|vh|vmin|vmax|cm|mm|in|pt|pc|px|deg|grad|rad|turn|s|ms|Hz|kHz|dpi|dpcm|dppx)?",relevance:0},CSS_VARIABLE:{className:"attr",begin:/--[A-Za-z_][A-Za-z0-9_-]*/}}),n=["a","abbr","address","article","aside","audio","b","blockquote","body","button","canvas","caption","cite","code","dd","del","details","dfn","div","dl","dt","em","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","html","i","iframe","img","input","ins","kbd","label","legend","li","main","mark","menu","nav","object","ol","optgroup","option","p","picture","q","quote","samp","section","select","source","span","strong","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","tr","ul","var","video"],i=["defs","g","marker","mask","pattern","svg","switch","symbol","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feFlood","feGaussianBlur","feImage","feMerge","feMorphology","feOffset","feSpecularLighting","feTile","feTurbulence","linearGradient","radialGradient","stop","circle","ellipse","image","line","path","polygon","polyline","rect","text","use","textPath","tspan","foreignObject","clipPath"],o=[...n,...i],l=["any-hover","any-pointer","aspect-ratio","color","color-gamut","color-index","device-aspect-ratio","device-height","device-width","display-mode","forced-colors","grid","height","hover","inverted-colors","monochrome","orientation","overflow-block","overflow-inline","pointer","prefers-color-scheme","prefers-contrast","prefers-reduced-motion","prefers-reduced-transparency","resolution","scan","scripting","update","width","min-width","max-width","min-height","max-height"].sort().reverse(),f=["active","any-link","blank","checked","current","default","defined","dir","disabled","drop","empty","enabled","first","first-child","first-of-type","fullscreen","future","focus","focus-visible","focus-within","has","host","host-context","hover","indeterminate","in-range","invalid","is","lang","last-child","last-of-type","left","link","local-link","not","nth-child","nth-col","nth-last-child","nth-last-col","nth-last-of-type","nth-of-type","only-child","only-of-type","optional","out-of-range","past","placeholder-shown","read-only","read-write","required","right","root","scope","target","target-within","user-invalid","valid","visited","where"].sort().reverse(),m=["after","backdrop","before","cue","cue-region","first-letter","first-line","grammar-error","marker","part","placeholder","selection","slotted","spelling-error"].sort().reverse(),u=["accent-color","align-content","align-items","align-self","alignment-baseline","all","anchor-name","animation","animation-composition","animation-delay","animation-direction","animation-duration","animation-fill-mode","animation-iteration-count","animation-name","animation-play-state","animation-range","animation-range-end","animation-range-start","animation-timeline","animation-timing-function","appearance","aspect-ratio","backdrop-filter","backface-visibility","background","background-attachment","background-blend-mode","background-clip","background-color","background-image","background-origin","background-position","background-position-x","background-position-y","background-repeat","background-size","baseline-shift","block-size","border","border-block","border-block-color","border-block-end","border-block-end-color","border-block-end-style","border-block-end-width","border-block-start","border-block-start-color","border-block-start-style","border-block-start-width","border-block-style","border-block-width","border-bottom","border-bottom-color","border-bottom-left-radius","border-bottom-right-radius","border-bottom-style","border-bottom-width","border-collapse","border-color","border-end-end-radius","border-end-start-radius","border-image","border-image-outset","border-image-repeat","border-image-slice","border-image-source","border-image-width","border-inline","border-inline-color","border-inline-end","border-inline-end-color","border-inline-end-style","border-inline-end-width","border-inline-start","border-inline-start-color","border-inline-start-style","border-inline-start-width","border-inline-style","border-inline-width","border-left","border-left-color","border-left-style","border-left-width","border-radius","border-right","border-right-color","border-right-style","border-right-width","border-spacing","border-start-end-radius","border-start-start-radius","border-style","border-top","border-top-color","border-top-left-radius","border-top-right-radius","border-top-style","border-top-width","border-width","bottom","box-align","box-decoration-break","box-direction","box-flex","box-flex-group","box-lines","box-ordinal-group","box-orient","box-pack","box-shadow","box-sizing","break-after","break-before","break-inside","caption-side","caret-color","clear","clip","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","color-scheme","column-count","column-fill","column-gap","column-rule","column-rule-color","column-rule-style","column-rule-width","column-span","column-width","columns","contain","contain-intrinsic-block-size","contain-intrinsic-height","contain-intrinsic-inline-size","contain-intrinsic-size","contain-intrinsic-width","container","container-name","container-type","content","content-visibility","counter-increment","counter-reset","counter-set","cue","cue-after","cue-before","cursor","cx","cy","direction","display","dominant-baseline","empty-cells","enable-background","field-sizing","fill","fill-opacity","fill-rule","filter","flex","flex-basis","flex-direction","flex-flow","flex-grow","flex-shrink","flex-wrap","float","flood-color","flood-opacity","flow","font","font-display","font-family","font-feature-settings","font-kerning","font-language-override","font-optical-sizing","font-palette","font-size","font-size-adjust","font-smooth","font-smoothing","font-stretch","font-style","font-synthesis","font-synthesis-position","font-synthesis-small-caps","font-synthesis-style","font-synthesis-weight","font-variant","font-variant-alternates","font-variant-caps","font-variant-east-asian","font-variant-emoji","font-variant-ligatures","font-variant-numeric","font-variant-position","font-variation-settings","font-weight","forced-color-adjust","gap","glyph-orientation-horizontal","glyph-orientation-vertical","grid","grid-area","grid-auto-columns","grid-auto-flow","grid-auto-rows","grid-column","grid-column-end","grid-column-start","grid-gap","grid-row","grid-row-end","grid-row-start","grid-template","grid-template-areas","grid-template-columns","grid-template-rows","hanging-punctuation","height","hyphenate-character","hyphenate-limit-chars","hyphens","icon","image-orientation","image-rendering","image-resolution","ime-mode","initial-letter","initial-letter-align","inline-size","inset","inset-area","inset-block","inset-block-end","inset-block-start","inset-inline","inset-inline-end","inset-inline-start","isolation","justify-content","justify-items","justify-self","kerning","left","letter-spacing","lighting-color","line-break","line-height","line-height-step","list-style","list-style-image","list-style-position","list-style-type","margin","margin-block","margin-block-end","margin-block-start","margin-bottom","margin-inline","margin-inline-end","margin-inline-start","margin-left","margin-right","margin-top","margin-trim","marker","marker-end","marker-mid","marker-start","marks","mask","mask-border","mask-border-mode","mask-border-outset","mask-border-repeat","mask-border-slice","mask-border-source","mask-border-width","mask-clip","mask-composite","mask-image","mask-mode","mask-origin","mask-position","mask-repeat","mask-size","mask-type","masonry-auto-flow","math-depth","math-shift","math-style","max-block-size","max-height","max-inline-size","max-width","min-block-size","min-height","min-inline-size","min-width","mix-blend-mode","nav-down","nav-index","nav-left","nav-right","nav-up","none","normal","object-fit","object-position","offset","offset-anchor","offset-distance","offset-path","offset-position","offset-rotate","opacity","order","orphans","outline","outline-color","outline-offset","outline-style","outline-width","overflow","overflow-anchor","overflow-block","overflow-clip-margin","overflow-inline","overflow-wrap","overflow-x","overflow-y","overlay","overscroll-behavior","overscroll-behavior-block","overscroll-behavior-inline","overscroll-behavior-x","overscroll-behavior-y","padding","padding-block","padding-block-end","padding-block-start","padding-bottom","padding-inline","padding-inline-end","padding-inline-start","padding-left","padding-right","padding-top","page","page-break-after","page-break-before","page-break-inside","paint-order","pause","pause-after","pause-before","perspective","perspective-origin","place-content","place-items","place-self","pointer-events","position","position-anchor","position-visibility","print-color-adjust","quotes","r","resize","rest","rest-after","rest-before","right","rotate","row-gap","ruby-align","ruby-position","scale","scroll-behavior","scroll-margin","scroll-margin-block","scroll-margin-block-end","scroll-margin-block-start","scroll-margin-bottom","scroll-margin-inline","scroll-margin-inline-end","scroll-margin-inline-start","scroll-margin-left","scroll-margin-right","scroll-margin-top","scroll-padding","scroll-padding-block","scroll-padding-block-end","scroll-padding-block-start","scroll-padding-bottom","scroll-padding-inline","scroll-padding-inline-end","scroll-padding-inline-start","scroll-padding-left","scroll-padding-right","scroll-padding-top","scroll-snap-align","scroll-snap-stop","scroll-snap-type","scroll-timeline","scroll-timeline-axis","scroll-timeline-name","scrollbar-color","scrollbar-gutter","scrollbar-width","shape-image-threshold","shape-margin","shape-outside","shape-rendering","speak","speak-as","src","stop-color","stop-opacity","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","tab-size","table-layout","text-align","text-align-all","text-align-last","text-anchor","text-combine-upright","text-decoration","text-decoration-color","text-decoration-line","text-decoration-skip","text-decoration-skip-ink","text-decoration-style","text-decoration-thickness","text-emphasis","text-emphasis-color","text-emphasis-position","text-emphasis-style","text-indent","text-justify","text-orientation","text-overflow","text-rendering","text-shadow","text-size-adjust","text-transform","text-underline-offset","text-underline-position","text-wrap","text-wrap-mode","text-wrap-style","timeline-scope","top","touch-action","transform","transform-box","transform-origin","transform-style","transition","transition-behavior","transition-delay","transition-duration","transition-property","transition-timing-function","translate","unicode-bidi","user-modify","user-select","vector-effect","vertical-align","view-timeline","view-timeline-axis","view-timeline-inset","view-timeline-name","view-transition-name","visibility","voice-balance","voice-duration","voice-family","voice-pitch","voice-range","voice-rate","voice-stress","voice-volume","white-space","white-space-collapse","widows","width","will-change","word-break","word-spacing","word-wrap","writing-mode","x","y","z-index","zoom"].sort().reverse();function _(c){const h=c.regex,p=s(c),T={begin:/-(webkit|moz|ms|o)-(?=[a-z])/},$="and or not only",S=/@-?\w[\w]*(-\w+)*/,y="[a-zA-Z-][a-zA-Z0-9_-]*",g=[c.APOS_STRING_MODE,c.QUOTE_STRING_MODE];return{name:"CSS",case_insensitive:true,illegal:/[=|'\$]/,keywords:{keyframePosition:"from to"},classNameAliases:{keyframePosition:"selector-tag"},contains:[p.BLOCK_COMMENT,T,p.CSS_NUMBER_MODE,{className:"selector-id",begin:/#[A-Za-z0-9_-]+/,relevance:0},{className:"selector-class",begin:"\\."+y,relevance:0},p.ATTRIBUTE_SELECTOR_MODE,{className:"selector-pseudo",variants:[{begin:":("+f.join("|")+")"},{begin:":(:)?("+m.join("|")+")"}]},p.CSS_VARIABLE,{className:"attribute",begin:"\\b("+u.join("|")+")\\b"},{begin:/:/,end:/[;}{]/,contains:[p.BLOCK_COMMENT,p.HEXCOLOR,p.IMPORTANT,p.CSS_NUMBER_MODE,...g,{begin:/(url|data-uri)\(/,end:/\)/,relevance:0,keywords:{built_in:"url data-uri"},contains:[...g,{className:"string",begin:/[^)]/,endsWithParent:true,excludeEnd:true}]},p.FUNCTION_DISPATCH]},{begin:h.lookahead(/@/),end:"[{;]",relevance:0,illegal:/:/,contains:[{className:"keyword",begin:S},{begin:/\s/,endsWithParent:true,excludeEnd:true,relevance:0,keywords:{$pattern:/[a-z-]+/,keyword:$,attribute:l.join(" ")},contains:[{begin:/[a-z-]+(?=:)/,className:"attribute"},...g,p.CSS_NUMBER_MODE]}]},{className:"selector-tag",begin:"\\b("+o.join("|")+")\\b"}]}}return wg=_,wg}var kg,B$;function LF(){if(B$)return kg;B$=1;function s(n){const i=n.regex,o={begin:/<\/?[A-Za-z_]/,end:">",subLanguage:"xml",relevance:0},l={begin:"^[-\\*]{3,}",end:"$"},f={className:"code",variants:[{begin:"(`{3,})[^`](.|\\n)*?\\1`*[ ]*"},{begin:"(~{3,})[^~](.|\\n)*?\\1~*[ ]*"},{begin:"```",end:"```+[ ]*$"},{begin:"~~~",end:"~~~+[ ]*$"},{begin:"`.+?`"},{begin:"(?=^( {4}|\\t))",contains:[{begin:"^( {4}|\\t)",end:"(\\n)$"}],relevance:0}]},m={className:"bullet",begin:"^[ 	]*([*+-]|(\\d+\\.))(?=\\s+)",end:"\\s+",excludeEnd:true},u={begin:/^\[[^\n]+\]:/,returnBegin:true,contains:[{className:"symbol",begin:/\[/,end:/\]/,excludeBegin:true,excludeEnd:true},{className:"link",begin:/:\s*/,end:/$/,excludeBegin:true}]},_=/[A-Za-z][A-Za-z0-9+.-]*/,c={variants:[{begin:/\[.+?\]\[.*?\]/,relevance:0},{begin:/\[.+?\]\(((data|javascript|mailto):|(?:http|ftp)s?:\/\/).*?\)/,relevance:2},{begin:i.concat(/\[.+?\]\(/,_,/:\/\/.*?\)/),relevance:2},{begin:/\[.+?\]\([./?&#].*?\)/,relevance:1},{begin:/\[.*?\]\(.*?\)/,relevance:0}],returnBegin:true,contains:[{match:/\[(?=\])/},{className:"string",relevance:0,begin:"\\[",end:"\\]",excludeBegin:true,returnEnd:true},{className:"link",relevance:0,begin:"\\]\\(",end:"\\)",excludeBegin:true,excludeEnd:true},{className:"symbol",relevance:0,begin:"\\]\\[",end:"\\]",excludeBegin:true,excludeEnd:true}]},h={className:"strong",contains:[],variants:[{begin:/_{2}(?!\s)/,end:/_{2}/},{begin:/\*{2}(?!\s)/,end:/\*{2}/}]},p={className:"emphasis",contains:[],variants:[{begin:/\*(?![*\s])/,end:/\*/},{begin:/_(?![_\s])/,end:/_/,relevance:0}]},T=n.inherit(h,{contains:[]}),$=n.inherit(p,{contains:[]});h.contains.push($),p.contains.push(T);let S=[o,c];return[h,p,T,$].forEach(v=>{v.contains=v.contains.concat(S)}),S=S.concat(h,p),{name:"Markdown",aliases:["md","mkdown","mkd"],contains:[{className:"section",variants:[{begin:"^#{1,6}",end:"$",contains:S},{begin:"(?=^.+?\\n[=-]{2,}$)",contains:[{begin:"^[=-]*$"},{begin:"^",end:"\\n",contains:S}]}]},o,m,h,p,{className:"quote",begin:"^>\\s+",contains:S,end:"$"},f,l,c,u,{scope:"literal",match:/&([a-zA-Z0-9]+|#[0-9]{1,7}|#[Xx][0-9a-fA-F]{1,6});/}]}}return kg=s,kg}var Ag,P$;function NF(){if(P$)return Ag;P$=1;function s(n){const i=n.regex;return{name:"Diff",aliases:["patch"],contains:[{className:"meta",relevance:10,match:i.either(/^@@ +-\d+,\d+ +\+\d+,\d+ +@@/,/^\*\*\* +\d+,\d+ +\*\*\*\*$/,/^--- +\d+,\d+ +----$/)},{className:"comment",variants:[{begin:i.either(/Index: /,/^index/,/={3,}/,/^-{3}/,/^\*{3} /,/^\+{3}/,/^diff --git/),end:/$/},{match:/^\*{15}$/}]},{className:"addition",begin:/^\+/,end:/$/},{className:"deletion",begin:/^-/,end:/$/},{className:"addition",begin:/^!/,end:/$/}]}}return Ag=s,Ag}var Lg,U$;function MF(){if(U$)return Lg;U$=1;function s(n){const i=n.regex,o="([a-zA-Z_]\\w*[!?=]?|[-+~]@|<<|>>|=~|===?|<=>|[<>]=?|\\*\\*|[-/+%^&*~`|]|\\[\\]=?)",l=i.either(/\b([A-Z]+[a-z0-9]+)+/,/\b([A-Z]+[a-z0-9]+)+[A-Z]+/),f=i.concat(l,/(::\w+)*/),u={"variable.constant":["__FILE__","__LINE__","__ENCODING__"],"variable.language":["self","super"],keyword:["alias","and","begin","BEGIN","break","case","class","defined","do","else","elsif","end","END","ensure","for","if","in","module","next","not","or","redo","require","rescue","retry","return","then","undef","unless","until","when","while","yield",...["include","extend","prepend","public","private","protected","raise","throw"]],built_in:["proc","lambda","attr_accessor","attr_reader","attr_writer","define_method","private_constant","module_function"],literal:["true","false","nil"]},_={className:"doctag",begin:"@[A-Za-z]+"},c={begin:"#<",end:">"},h=[n.COMMENT("#","$",{contains:[_]}),n.COMMENT("^=begin","^=end",{contains:[_],relevance:10}),n.COMMENT("^__END__",n.MATCH_NOTHING_RE)],p={className:"subst",begin:/#\{/,end:/\}/,keywords:u},T={className:"string",contains:[n.BACKSLASH_ESCAPE,p],variants:[{begin:/'/,end:/'/},{begin:/"/,end:/"/},{begin:/`/,end:/`/},{begin:/%[qQwWx]?\(/,end:/\)/},{begin:/%[qQwWx]?\[/,end:/\]/},{begin:/%[qQwWx]?\{/,end:/\}/},{begin:/%[qQwWx]?</,end:/>/},{begin:/%[qQwWx]?\//,end:/\//},{begin:/%[qQwWx]?%/,end:/%/},{begin:/%[qQwWx]?-/,end:/-/},{begin:/%[qQwWx]?\|/,end:/\|/},{begin:/\B\?(\\\d{1,3})/},{begin:/\B\?(\\x[A-Fa-f0-9]{1,2})/},{begin:/\B\?(\\u\{?[A-Fa-f0-9]{1,6}\}?)/},{begin:/\B\?(\\M-\\C-|\\M-\\c|\\c\\M-|\\M-|\\C-\\M-)[\x20-\x7e]/},{begin:/\B\?\\(c|C-)[\x20-\x7e]/},{begin:/\B\?\\?\S/},{begin:i.concat(/<<[-~]?'?/,i.lookahead(/(\w+)(?=\W)[^\n]*\n(?:[^\n]*\n)*?\s*\1\b/)),contains:[n.END_SAME_AS_BEGIN({begin:/(\w+)/,end:/(\w+)/,contains:[n.BACKSLASH_ESCAPE,p]})]}]},$="[1-9](_?[0-9])*|0",S="[0-9](_?[0-9])*",y={className:"number",relevance:0,variants:[{begin:`\\b(${$})(\\.(${S}))?([eE][+-]?(${S})|r)?i?\\b`},{begin:"\\b0[dD][0-9](_?[0-9])*r?i?\\b"},{begin:"\\b0[bB][0-1](_?[0-1])*r?i?\\b"},{begin:"\\b0[oO][0-7](_?[0-7])*r?i?\\b"},{begin:"\\b0[xX][0-9a-fA-F](_?[0-9a-fA-F])*r?i?\\b"},{begin:"\\b0(_?[0-7])+r?i?\\b"}]},g={variants:[{match:/\(\)/},{className:"params",begin:/\(/,end:/(?=\))/,excludeBegin:true,endsParent:true,keywords:u}]},L=[T,{variants:[{match:[/class\s+/,f,/\s+<\s+/,f]},{match:[/\b(class|module)\s+/,f]}],scope:{2:"title.class",4:"title.class.inherited"},keywords:u},{match:[/(include|extend)\s+/,f],scope:{2:"title.class"},keywords:u},{relevance:0,match:[f,/\.new[. (]/],scope:{1:"title.class"}},{relevance:0,match:/\b[A-Z][A-Z_0-9]+\b/,className:"variable.constant"},{relevance:0,match:l,scope:"title.class"},{match:[/def/,/\s+/,o],scope:{1:"keyword",3:"title.function"},contains:[g]},{begin:n.IDENT_RE+"::"},{className:"symbol",begin:n.UNDERSCORE_IDENT_RE+"(!|\\?)?:",relevance:0},{className:"symbol",begin:":(?!\\s)",contains:[T,{begin:o}],relevance:0},y,{className:"variable",begin:"(\\$\\W)|((\\$|@@?)(\\w+))(?=[^@$?])(?![A-Za-z])(?![@$?'])"},{className:"params",begin:/\|(?!=)/,end:/\|/,excludeBegin:true,excludeEnd:true,relevance:0,keywords:u},{begin:"("+n.RE_STARTERS_RE+"|unless)\\s*",keywords:"unless",contains:[{className:"regexp",contains:[n.BACKSLASH_ESCAPE,p],illegal:/\n/,variants:[{begin:"/",end:"/[a-z]*"},{begin:/%r\{/,end:/\}[a-z]*/},{begin:"%r\\(",end:"\\)[a-z]*"},{begin:"%r!",end:"![a-z]*"},{begin:"%r\\[",end:"\\][a-z]*"}]}].concat(c,h),relevance:0}].concat(c,h);p.contains=L,g.contains=L;const P=[{begin:/^\s*=>/,starts:{end:"$",contains:L}},{className:"meta.prompt",begin:"^([>?]>|[\\w#]+\\(\\w+\\):\\d+:\\d+[>*]|(\\w+-)?\\d+\\.\\d+\\.\\d+(p\\d+)?[^\\d][^>]+>)(?=[ ])",starts:{end:"$",keywords:u,contains:L}}];return h.unshift(c),{name:"Ruby",aliases:["rb","gemspec","podspec","thor","irb"],keywords:u,illegal:/\/\*/,contains:[n.SHEBANG({binary:"ruby"})].concat(P).concat(h).concat(L)}}return Lg=s,Lg}var Ng,F$;function DF(){if(F$)return Ng;F$=1;function s(n){const m={keyword:["break","case","chan","const","continue","default","defer","else","fallthrough","for","func","go","goto","if","import","interface","map","package","range","return","select","struct","switch","type","var"],type:["bool","byte","complex64","complex128","error","float32","float64","int8","int16","int32","int64","string","uint8","uint16","uint32","uint64","int","uint","uintptr","rune"],literal:["true","false","iota","nil"],built_in:["append","cap","close","complex","copy","imag","len","make","new","panic","print","println","real","recover","delete"]};return{name:"Go",aliases:["golang"],keywords:m,illegal:"</",contains:[n.C_LINE_COMMENT_MODE,n.C_BLOCK_COMMENT_MODE,{className:"string",variants:[n.QUOTE_STRING_MODE,n.APOS_STRING_MODE,{begin:"`",end:"`"}]},{className:"number",variants:[{match:/-?\b0[xX]\.[a-fA-F0-9](_?[a-fA-F0-9])*[pP][+-]?\d(_?\d)*i?/,relevance:0},{match:/-?\b0[xX](_?[a-fA-F0-9])+((\.([a-fA-F0-9](_?[a-fA-F0-9])*)?)?[pP][+-]?\d(_?\d)*)?i?/,relevance:0},{match:/-?\b0[oO](_?[0-7])*i?/,relevance:0},{match:/-?\.\d(_?\d)*([eE][+-]?\d(_?\d)*)?i?/,relevance:0},{match:/-?\b\d(_?\d)*(\.(\d(_?\d)*)?)?([eE][+-]?\d(_?\d)*)?i?/,relevance:0}]},{begin:/:=/},{className:"function",beginKeywords:"func",end:"\\s*(\\{|$)",excludeEnd:true,contains:[n.TITLE_MODE,{className:"params",begin:/\(/,end:/\)/,endsParent:true,keywords:m,illegal:/["']/}]}]}}return Ng=s,Ng}var Mg,G$;function xF(){if(G$)return Mg;G$=1;function s(n){const i=n.regex,o=/[_A-Za-z][_0-9A-Za-z]*/;return{name:"GraphQL",aliases:["gql"],case_insensitive:true,disableAutodetect:false,keywords:{keyword:["query","mutation","subscription","type","input","schema","directive","interface","union","scalar","fragment","enum","on"],literal:["true","false","null"]},contains:[n.HASH_COMMENT_MODE,n.QUOTE_STRING_MODE,n.NUMBER_MODE,{scope:"punctuation",match:/[.]{3}/,relevance:0},{scope:"punctuation",begin:/[\!\(\)\:\=\[\]\{\|\}]{1}/,relevance:0},{scope:"variable",begin:/\$/,end:/\W/,excludeEnd:true,relevance:0},{scope:"meta",match:/@\w+/,excludeEnd:true},{scope:"symbol",begin:i.concat(o,i.lookahead(/\s*:/)),relevance:0}],illegal:[/[;<']/,/BEGIN/]}}return Mg=s,Mg}var Dg,H$;function BF(){if(H$)return Dg;H$=1;function s(n){const i=n.regex,o={className:"number",relevance:0,variants:[{begin:/([+-]+)?[\d]+_[\d_]+/},{begin:n.NUMBER_RE}]},l=n.COMMENT();l.variants=[{begin:/;/,end:/$/},{begin:/#/,end:/$/}];const f={className:"variable",variants:[{begin:/\$[\w\d"][\w\d_]*/},{begin:/\$\{(.*?)\}/}]},m={className:"literal",begin:/\bon|off|true|false|yes|no\b/},u={className:"string",contains:[n.BACKSLASH_ESCAPE],variants:[{begin:"'''",end:"'''",relevance:10},{begin:'"""',end:'"""',relevance:10},{begin:'"',end:'"'},{begin:"'",end:"'"}]},_={begin:/\[/,end:/\]/,contains:[l,m,f,u,o,"self"],relevance:0},c=/[A-Za-z0-9_-]+/,h=/"(\\"|[^"])*"/,p=/'[^']*'/,T=i.either(c,h,p),$=i.concat(T,"(\\s*\\.\\s*",T,")*",i.lookahead(/\s*=\s*[^#\s]/));return{name:"TOML, also INI",aliases:["toml"],case_insensitive:true,illegal:/\S/,contains:[l,{className:"section",begin:/\[+/,end:/\]+/},{begin:$,className:"attr",starts:{end:/$/,contains:[l,_,m,f,u,o]}}]}}return Dg=s,Dg}var xg,V$;function PF(){if(V$)return xg;V$=1;var s="[0-9](_*[0-9])*",n=`\\.(${s})`,i="[0-9a-fA-F](_*[0-9a-fA-F])*",o={className:"number",variants:[{begin:`(\\b(${s})((${n})|\\.)?|(${n}))[eE][+-]?(${s})[fFdD]?\\b`},{begin:`\\b(${s})((${n})[fFdD]?\\b|\\.([fFdD]\\b)?)`},{begin:`(${n})[fFdD]?\\b`},{begin:`\\b(${s})[fFdD]\\b`},{begin:`\\b0[xX]((${i})\\.?|(${i})?\\.(${i}))[pP][+-]?(${s})[fFdD]?\\b`},{begin:"\\b(0|[1-9](_*[0-9])*)[lL]?\\b"},{begin:`\\b0[xX](${i})[lL]?\\b`},{begin:"\\b0(_*[0-7])*[lL]?\\b"},{begin:"\\b0[bB][01](_*[01])*[lL]?\\b"}],relevance:0};function l(m,u,_){return _===-1?"":m.replace(u,c=>l(m,u,_-1))}function f(m){const u=m.regex,_="[À-ʸa-zA-Z_$][À-ʸa-zA-Z_$0-9]*",c=_+l("(?:<"+_+"~~~(?:\\s*,\\s*"+_+"~~~)*>)?",/~~~/g,2),S={keyword:["synchronized","abstract","private","var","static","if","const ","for","while","strictfp","finally","protected","import","native","final","void","enum","else","break","transient","catch","instanceof","volatile","case","assert","package","default","public","try","switch","continue","throws","protected","public","private","module","requires","exports","do","sealed","yield","permits","goto","when"],literal:["false","true","null"],type:["char","boolean","long","float","int","byte","short","double"],built_in:["super","this"]},y={className:"meta",begin:"@"+_,contains:[{begin:/\(/,end:/\)/,contains:["self"]}]},g={className:"params",begin:/\(/,end:/\)/,keywords:S,relevance:0,contains:[m.C_BLOCK_COMMENT_MODE],endsParent:true};return{name:"Java",aliases:["jsp"],keywords:S,illegal:/<\/|#/,contains:[m.COMMENT("/\\*\\*","\\*/",{relevance:0,contains:[{begin:/\w+@/,relevance:0},{className:"doctag",begin:"@[A-Za-z]+"}]}),{begin:/import java\.[a-z]+\./,keywords:"import",relevance:2},m.C_LINE_COMMENT_MODE,m.C_BLOCK_COMMENT_MODE,{begin:/"""/,end:/"""/,className:"string",contains:[m.BACKSLASH_ESCAPE]},m.APOS_STRING_MODE,m.QUOTE_STRING_MODE,{match:[/\b(?:class|interface|enum|extends|implements|new)/,/\s+/,_],className:{1:"keyword",3:"title.class"}},{match:/non-sealed/,scope:"keyword"},{begin:[u.concat(/(?!else)/,_),/\s+/,_,/\s+/,/=(?!=)/],className:{1:"type",3:"variable",5:"operator"}},{begin:[/record/,/\s+/,_],className:{1:"keyword",3:"title.class"},contains:[g,m.C_LINE_COMMENT_MODE,m.C_BLOCK_COMMENT_MODE]},{beginKeywords:"new throw return else",relevance:0},{begin:["(?:"+c+"\\s+)",m.UNDERSCORE_IDENT_RE,/\s*(?=\()/],className:{2:"title.function"},keywords:S,contains:[{className:"params",begin:/\(/,end:/\)/,keywords:S,relevance:0,contains:[y,m.APOS_STRING_MODE,m.QUOTE_STRING_MODE,o,m.C_BLOCK_COMMENT_MODE]},m.C_LINE_COMMENT_MODE,m.C_BLOCK_COMMENT_MODE]},o,y]}}return xg=f,xg}var Bg,W$;function UF(){if(W$)return Bg;W$=1;const s="[A-Za-z$_][0-9A-Za-z$_]*",n=["as","in","of","if","for","while","finally","var","new","function","do","return","void","else","break","catch","instanceof","with","throw","case","default","try","switch","continue","typeof","delete","let","yield","const","class","debugger","async","await","static","import","from","export","extends","using"],i=["true","false","null","undefined","NaN","Infinity"],o=["Object","Function","Boolean","Symbol","Math","Date","Number","BigInt","String","RegExp","Array","Float32Array","Float64Array","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Int32Array","Uint16Array","Uint32Array","BigInt64Array","BigUint64Array","Set","Map","WeakSet","WeakMap","ArrayBuffer","SharedArrayBuffer","Atomics","DataView","JSON","Promise","Generator","GeneratorFunction","AsyncFunction","Reflect","Proxy","Intl","WebAssembly"],l=["Error","EvalError","InternalError","RangeError","ReferenceError","SyntaxError","TypeError","URIError"],f=["setInterval","setTimeout","clearInterval","clearTimeout","require","exports","eval","isFinite","isNaN","parseFloat","parseInt","decodeURI","decodeURIComponent","encodeURI","encodeURIComponent","escape","unescape"],m=["arguments","this","super","console","window","document","localStorage","sessionStorage","module","global"],u=[].concat(f,o,l);function _(c){const h=c.regex,p=(B,{after:te})=>{const le="</"+B[0].slice(1);return B.input.indexOf(le,te)!==-1},T=s,$={begin:"<>",end:"</>"},S=/<[A-Za-z0-9\\._:-]+\s*\/>/,y={begin:/<[A-Za-z0-9\\._:-]+/,end:/\/[A-Za-z0-9\\._:-]+>|\/>/,isTrulyOpeningTag:(B,te)=>{const le=B[0].length+B.index,ae=B.input[le];if(ae==="<"||ae===","){te.ignoreMatch();return}ae===">"&&(p(B,{after:le})||te.ignoreMatch());let Me;const Se=B.input.substring(le);if(Me=Se.match(/^\s*=/)){te.ignoreMatch();return}if((Me=Se.match(/^\s+extends\s+/))&&Me.index===0){te.ignoreMatch();return}}},g={$pattern:s,keyword:n,literal:i,built_in:u,"variable.language":m},E="[0-9](_?[0-9])*",v=`\\.(${E})`,b="0|[1-9](_?[0-9])*|0[0-7]*[89][0-9]*",R={className:"number",variants:[{begin:`(\\b(${b})((${v})|\\.)?|(${v}))[eE][+-]?(${E})\\b`},{begin:`\\b(${b})\\b((${v})\\b|\\.)?|(${v})\\b`},{begin:"\\b(0|[1-9](_?[0-9])*)n\\b"},{begin:"\\b0[xX][0-9a-fA-F](_?[0-9a-fA-F])*n?\\b"},{begin:"\\b0[bB][0-1](_?[0-1])*n?\\b"},{begin:"\\b0[oO][0-7](_?[0-7])*n?\\b"},{begin:"\\b0[0-7]+n?\\b"}],relevance:0},O={className:"subst",begin:"\\$\\{",end:"\\}",keywords:g,contains:[]},w={begin:".?html`",end:"",starts:{end:"`",returnEnd:false,contains:[c.BACKSLASH_ESCAPE,O],subLanguage:"xml"}},L={begin:".?css`",end:"",starts:{end:"`",returnEnd:false,contains:[c.BACKSLASH_ESCAPE,O],subLanguage:"css"}},I={begin:".?gql`",end:"",starts:{end:"`",returnEnd:false,contains:[c.BACKSLASH_ESCAPE,O],subLanguage:"graphql"}},k={className:"string",begin:"`",end:"`",contains:[c.BACKSLASH_ESCAPE,O]},P={className:"comment",variants:[c.COMMENT(/\/\*\*(?!\/)/,"\\*/",{relevance:0,contains:[{begin:"(?=@[A-Za-z]+)",relevance:0,contains:[{className:"doctag",begin:"@[A-Za-z]+"},{className:"type",begin:"\\{",end:"\\}",excludeEnd:true,excludeBegin:true,relevance:0},{className:"variable",begin:T+"(?=\\s*(-)|$)",endsParent:true,relevance:0},{begin:/(?=[^\n])\s/,relevance:0}]}]}),c.C_BLOCK_COMMENT_MODE,c.C_LINE_COMMENT_MODE]},F=[c.APOS_STRING_MODE,c.QUOTE_STRING_MODE,w,L,I,k,{match:/\$\d+/},R];O.contains=F.concat({begin:/\{/,end:/\}/,keywords:g,contains:["self"].concat(F)});const X=[].concat(P,O.contains),W=X.concat([{begin:/(\s*)\(/,end:/\)/,keywords:g,contains:["self"].concat(X)}]),z={className:"params",begin:/(\s*)\(/,end:/\)/,excludeBegin:true,excludeEnd:true,keywords:g,contains:W},j={variants:[{match:[/class/,/\s+/,T,/\s+/,/extends/,/\s+/,h.concat(T,"(",h.concat(/\./,T),")*")],scope:{1:"keyword",3:"title.class",5:"keyword",7:"title.class.inherited"}},{match:[/class/,/\s+/,T],scope:{1:"keyword",3:"title.class"}}]},J={relevance:0,match:h.either(/\bJSON/,/\b[A-Z][a-z]+([A-Z][a-z]*|\d)*/,/\b[A-Z]{2,}([A-Z][a-z]+|\d)+([A-Z][a-z]*)*/,/\b[A-Z]{2,}[a-z]+([A-Z][a-z]+|\d)*([A-Z][a-z]*)*/),className:"title.class",keywords:{_:[...o,...l]}},M={label:"use_strict",className:"meta",relevance:10,begin:/^\s*['"]use (strict|asm)['"]/},U={variants:[{match:[/function/,/\s+/,T,/(?=\s*\()/]},{match:[/function/,/\s*(?=\()/]}],className:{1:"keyword",3:"title.function"},label:"func.def",contains:[z],illegal:/%/},V={relevance:0,match:/\b[A-Z][A-Z_0-9]+\b/,className:"variable.constant"};function K(B){return h.concat("(?!",B.join("|"),")")}const H={match:h.concat(/\b/,K([...f,"super","import"].map(B=>`${B}\\s*\\(`)),T,h.lookahead(/\s*\(/)),className:"title.function",relevance:0},ie={begin:h.concat(/\./,h.lookahead(h.concat(T,/(?![0-9A-Za-z$_(])/))),end:T,excludeBegin:true,keywords:"prototype",className:"property",relevance:0},Ie={match:[/get|set/,/\s+/,T,/(?=\()/],className:{1:"keyword",3:"title.function"},contains:[{begin:/\(\)/},z]},he="(\\([^()]*(\\([^()]*(\\([^()]*\\)[^()]*)*\\)[^()]*)*\\)|"+c.UNDERSCORE_IDENT_RE+")\\s*=>",st={match:[/const|var|let/,/\s+/,T,/\s*/,/=\s*/,/(async\s*)?/,h.lookahead(he)],keywords:"async",className:{1:"keyword",3:"title.function"},contains:[z]};return{name:"JavaScript",aliases:["js","jsx","mjs","cjs"],keywords:g,exports:{PARAMS_CONTAINS:W,CLASS_REFERENCE:J},illegal:/#(?![$_A-z])/,contains:[c.SHEBANG({label:"shebang",binary:"node",relevance:5}),M,c.APOS_STRING_MODE,c.QUOTE_STRING_MODE,w,L,I,k,P,{match:/\$\d+/},R,J,{scope:"attr",match:T+h.lookahead(":"),relevance:0},st,{begin:"("+c.RE_STARTERS_RE+"|\\b(case|return|throw)\\b)\\s*",keywords:"return throw case",relevance:0,contains:[P,c.REGEXP_MODE,{className:"function",begin:he,returnBegin:true,end:"\\s*=>",contains:[{className:"params",variants:[{begin:c.UNDERSCORE_IDENT_RE,relevance:0},{className:null,begin:/\(\s*\)/,skip:true},{begin:/(\s*)\(/,end:/\)/,excludeBegin:true,excludeEnd:true,keywords:g,contains:W}]}]},{begin:/,/,relevance:0},{match:/\s+/,relevance:0},{variants:[{begin:$.begin,end:$.end},{match:S},{begin:y.begin,"on:begin":y.isTrulyOpeningTag,end:y.end}],subLanguage:"xml",contains:[{begin:y.begin,end:y.end,skip:true,contains:["self"]}]}]},U,{beginKeywords:"while if switch catch for"},{begin:"\\b(?!function)"+c.UNDERSCORE_IDENT_RE+"\\([^()]*(\\([^()]*(\\([^()]*\\)[^()]*)*\\)[^()]*)*\\)\\s*\\{",returnBegin:true,label:"func.def",contains:[z,c.inherit(c.TITLE_MODE,{begin:T,className:"title.function"})]},{match:/\.\.\./,relevance:0},ie,{match:"\\$"+T,relevance:0},{match:[/\bconstructor(?=\s*\()/],className:{1:"title.function"},contains:[z]},H,V,j,Ie,{match:/\$[(.]/}]}}return Bg=_,Bg}var Pg,z$;function FF(){if(z$)return Pg;z$=1;function s(n){const i={className:"attr",begin:/"(\\.|[^\\"\r\n])*"(?=\s*:)/,relevance:1.01},o={match:/[{}[\],:]/,className:"punctuation",relevance:0},l=["true","false","null"],f={scope:"literal",beginKeywords:l.join(" ")};return{name:"JSON",aliases:["jsonc"],keywords:{literal:l},contains:[i,o,n.QUOTE_STRING_MODE,f,n.C_NUMBER_MODE,n.C_LINE_COMMENT_MODE,n.C_BLOCK_COMMENT_MODE],illegal:"\\S"}}return Pg=s,Pg}var Ug,j$;function GF(){if(j$)return Ug;j$=1;var s="[0-9](_*[0-9])*",n=`\\.(${s})`,i="[0-9a-fA-F](_*[0-9a-fA-F])*",o={className:"number",variants:[{begin:`(\\b(${s})((${n})|\\.)?|(${n}))[eE][+-]?(${s})[fFdD]?\\b`},{begin:`\\b(${s})((${n})[fFdD]?\\b|\\.([fFdD]\\b)?)`},{begin:`(${n})[fFdD]?\\b`},{begin:`\\b(${s})[fFdD]\\b`},{begin:`\\b0[xX]((${i})\\.?|(${i})?\\.(${i}))[pP][+-]?(${s})[fFdD]?\\b`},{begin:"\\b(0|[1-9](_*[0-9])*)[lL]?\\b"},{begin:`\\b0[xX](${i})[lL]?\\b`},{begin:"\\b0(_*[0-7])*[lL]?\\b"},{begin:"\\b0[bB][01](_*[01])*[lL]?\\b"}],relevance:0};function l(f){const m={keyword:"abstract as val var vararg get set class object open private protected public noinline crossinline dynamic final enum if else do while for when throw try catch finally import package is in fun override companion reified inline lateinit init interface annotation data sealed internal infix operator out by constructor super tailrec where const inner suspend typealias external expect actual",built_in:"Byte Short Char Int Long Boolean Float Double Void Unit Nothing",literal:"true false null"},u={className:"keyword",begin:/\b(break|continue|return|this)\b/,starts:{contains:[{className:"symbol",begin:/@\w+/}]}},_={className:"symbol",begin:f.UNDERSCORE_IDENT_RE+"@"},c={className:"subst",begin:/\$\{/,end:/\}/,contains:[f.C_NUMBER_MODE]},h={className:"variable",begin:"\\$"+f.UNDERSCORE_IDENT_RE},p={className:"string",variants:[{begin:'"""',end:'"""(?=[^"])',contains:[h,c]},{begin:"'",end:"'",illegal:/\n/,contains:[f.BACKSLASH_ESCAPE]},{begin:'"',end:'"',illegal:/\n/,contains:[f.BACKSLASH_ESCAPE,h,c]}]};c.contains.push(p);const T={className:"meta",begin:"@(?:file|property|field|get|set|receiver|param|setparam|delegate)\\s*:(?:\\s*"+f.UNDERSCORE_IDENT_RE+")?"},$={className:"meta",begin:"@"+f.UNDERSCORE_IDENT_RE,contains:[{begin:/\(/,end:/\)/,contains:[f.inherit(p,{className:"string"}),"self"]}]},S=o,y=f.COMMENT("/\\*","\\*/",{contains:[f.C_BLOCK_COMMENT_MODE]}),g={variants:[{className:"type",begin:f.UNDERSCORE_IDENT_RE},{begin:/\(/,end:/\)/,contains:[]}]},E=g;return E.variants[1].contains=[g],g.variants[1].contains=[E],{name:"Kotlin",aliases:["kt","kts"],keywords:m,contains:[f.COMMENT("/\\*\\*","\\*/",{relevance:0,contains:[{className:"doctag",begin:"@[A-Za-z]+"}]}),f.C_LINE_COMMENT_MODE,y,u,_,T,$,{className:"function",beginKeywords:"fun",end:"[(]|$",returnBegin:true,excludeEnd:true,keywords:m,relevance:5,contains:[{begin:f.UNDERSCORE_IDENT_RE+"\\s*\\(",returnBegin:true,relevance:0,contains:[f.UNDERSCORE_TITLE_MODE]},{className:"type",begin:/</,end:/>/,keywords:"reified",relevance:0},{className:"params",begin:/\(/,end:/\)/,endsParent:true,keywords:m,relevance:0,contains:[{begin:/:/,end:/[=,\/]/,endsWithParent:true,contains:[g,f.C_LINE_COMMENT_MODE,y],relevance:0},f.C_LINE_COMMENT_MODE,y,T,$,p,f.C_NUMBER_MODE]},y]},{begin:[/class|interface|trait/,/\s+/,f.UNDERSCORE_IDENT_RE],beginScope:{3:"title.class"},keywords:"class interface trait",end:/[:\{(]|$/,excludeEnd:true,illegal:"extends implements",contains:[{beginKeywords:"public protected internal private constructor"},f.UNDERSCORE_TITLE_MODE,{className:"type",begin:/</,end:/>/,excludeBegin:true,excludeEnd:true,relevance:0},{className:"type",begin:/[,:]\s*/,end:/[<\(,){\s]|$/,excludeBegin:true,returnEnd:true},T,$]},p,{className:"meta",begin:"^#!/usr/bin/env",end:"$",illegal:`
`},S]}}return Ug=l,Ug}var Fg,X$;function HF(){if(X$)return Fg;X$=1;const s=h=>({IMPORTANT:{scope:"meta",begin:"!important"},BLOCK_COMMENT:h.C_BLOCK_COMMENT_MODE,HEXCOLOR:{scope:"number",begin:/#(([0-9a-fA-F]{3,4})|(([0-9a-fA-F]{2}){3,4}))\b/},FUNCTION_DISPATCH:{className:"built_in",begin:/[\w-]+(?=\()/},ATTRIBUTE_SELECTOR_MODE:{scope:"selector-attr",begin:/\[/,end:/\]/,illegal:"$",contains:[h.APOS_STRING_MODE,h.QUOTE_STRING_MODE]},CSS_NUMBER_MODE:{scope:"number",begin:h.NUMBER_RE+"(%|em|ex|ch|rem|vw|vh|vmin|vmax|cm|mm|in|pt|pc|px|deg|grad|rad|turn|s|ms|Hz|kHz|dpi|dpcm|dppx)?",relevance:0},CSS_VARIABLE:{className:"attr",begin:/--[A-Za-z_][A-Za-z0-9_-]*/}}),n=["a","abbr","address","article","aside","audio","b","blockquote","body","button","canvas","caption","cite","code","dd","del","details","dfn","div","dl","dt","em","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","html","i","iframe","img","input","ins","kbd","label","legend","li","main","mark","menu","nav","object","ol","optgroup","option","p","picture","q","quote","samp","section","select","source","span","strong","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","tr","ul","var","video"],i=["defs","g","marker","mask","pattern","svg","switch","symbol","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feFlood","feGaussianBlur","feImage","feMerge","feMorphology","feOffset","feSpecularLighting","feTile","feTurbulence","linearGradient","radialGradient","stop","circle","ellipse","image","line","path","polygon","polyline","rect","text","use","textPath","tspan","foreignObject","clipPath"],o=[...n,...i],l=["any-hover","any-pointer","aspect-ratio","color","color-gamut","color-index","device-aspect-ratio","device-height","device-width","display-mode","forced-colors","grid","height","hover","inverted-colors","monochrome","orientation","overflow-block","overflow-inline","pointer","prefers-color-scheme","prefers-contrast","prefers-reduced-motion","prefers-reduced-transparency","resolution","scan","scripting","update","width","min-width","max-width","min-height","max-height"].sort().reverse(),f=["active","any-link","blank","checked","current","default","defined","dir","disabled","drop","empty","enabled","first","first-child","first-of-type","fullscreen","future","focus","focus-visible","focus-within","has","host","host-context","hover","indeterminate","in-range","invalid","is","lang","last-child","last-of-type","left","link","local-link","not","nth-child","nth-col","nth-last-child","nth-last-col","nth-last-of-type","nth-of-type","only-child","only-of-type","optional","out-of-range","past","placeholder-shown","read-only","read-write","required","right","root","scope","target","target-within","user-invalid","valid","visited","where"].sort().reverse(),m=["after","backdrop","before","cue","cue-region","first-letter","first-line","grammar-error","marker","part","placeholder","selection","slotted","spelling-error"].sort().reverse(),u=["accent-color","align-content","align-items","align-self","alignment-baseline","all","anchor-name","animation","animation-composition","animation-delay","animation-direction","animation-duration","animation-fill-mode","animation-iteration-count","animation-name","animation-play-state","animation-range","animation-range-end","animation-range-start","animation-timeline","animation-timing-function","appearance","aspect-ratio","backdrop-filter","backface-visibility","background","background-attachment","background-blend-mode","background-clip","background-color","background-image","background-origin","background-position","background-position-x","background-position-y","background-repeat","background-size","baseline-shift","block-size","border","border-block","border-block-color","border-block-end","border-block-end-color","border-block-end-style","border-block-end-width","border-block-start","border-block-start-color","border-block-start-style","border-block-start-width","border-block-style","border-block-width","border-bottom","border-bottom-color","border-bottom-left-radius","border-bottom-right-radius","border-bottom-style","border-bottom-width","border-collapse","border-color","border-end-end-radius","border-end-start-radius","border-image","border-image-outset","border-image-repeat","border-image-slice","border-image-source","border-image-width","border-inline","border-inline-color","border-inline-end","border-inline-end-color","border-inline-end-style","border-inline-end-width","border-inline-start","border-inline-start-color","border-inline-start-style","border-inline-start-width","border-inline-style","border-inline-width","border-left","border-left-color","border-left-style","border-left-width","border-radius","border-right","border-right-color","border-right-style","border-right-width","border-spacing","border-start-end-radius","border-start-start-radius","border-style","border-top","border-top-color","border-top-left-radius","border-top-right-radius","border-top-style","border-top-width","border-width","bottom","box-align","box-decoration-break","box-direction","box-flex","box-flex-group","box-lines","box-ordinal-group","box-orient","box-pack","box-shadow","box-sizing","break-after","break-before","break-inside","caption-side","caret-color","clear","clip","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","color-scheme","column-count","column-fill","column-gap","column-rule","column-rule-color","column-rule-style","column-rule-width","column-span","column-width","columns","contain","contain-intrinsic-block-size","contain-intrinsic-height","contain-intrinsic-inline-size","contain-intrinsic-size","contain-intrinsic-width","container","container-name","container-type","content","content-visibility","counter-increment","counter-reset","counter-set","cue","cue-after","cue-before","cursor","cx","cy","direction","display","dominant-baseline","empty-cells","enable-background","field-sizing","fill","fill-opacity","fill-rule","filter","flex","flex-basis","flex-direction","flex-flow","flex-grow","flex-shrink","flex-wrap","float","flood-color","flood-opacity","flow","font","font-display","font-family","font-feature-settings","font-kerning","font-language-override","font-optical-sizing","font-palette","font-size","font-size-adjust","font-smooth","font-smoothing","font-stretch","font-style","font-synthesis","font-synthesis-position","font-synthesis-small-caps","font-synthesis-style","font-synthesis-weight","font-variant","font-variant-alternates","font-variant-caps","font-variant-east-asian","font-variant-emoji","font-variant-ligatures","font-variant-numeric","font-variant-position","font-variation-settings","font-weight","forced-color-adjust","gap","glyph-orientation-horizontal","glyph-orientation-vertical","grid","grid-area","grid-auto-columns","grid-auto-flow","grid-auto-rows","grid-column","grid-column-end","grid-column-start","grid-gap","grid-row","grid-row-end","grid-row-start","grid-template","grid-template-areas","grid-template-columns","grid-template-rows","hanging-punctuation","height","hyphenate-character","hyphenate-limit-chars","hyphens","icon","image-orientation","image-rendering","image-resolution","ime-mode","initial-letter","initial-letter-align","inline-size","inset","inset-area","inset-block","inset-block-end","inset-block-start","inset-inline","inset-inline-end","inset-inline-start","isolation","justify-content","justify-items","justify-self","kerning","left","letter-spacing","lighting-color","line-break","line-height","line-height-step","list-style","list-style-image","list-style-position","list-style-type","margin","margin-block","margin-block-end","margin-block-start","margin-bottom","margin-inline","margin-inline-end","margin-inline-start","margin-left","margin-right","margin-top","margin-trim","marker","marker-end","marker-mid","marker-start","marks","mask","mask-border","mask-border-mode","mask-border-outset","mask-border-repeat","mask-border-slice","mask-border-source","mask-border-width","mask-clip","mask-composite","mask-image","mask-mode","mask-origin","mask-position","mask-repeat","mask-size","mask-type","masonry-auto-flow","math-depth","math-shift","math-style","max-block-size","max-height","max-inline-size","max-width","min-block-size","min-height","min-inline-size","min-width","mix-blend-mode","nav-down","nav-index","nav-left","nav-right","nav-up","none","normal","object-fit","object-position","offset","offset-anchor","offset-distance","offset-path","offset-position","offset-rotate","opacity","order","orphans","outline","outline-color","outline-offset","outline-style","outline-width","overflow","overflow-anchor","overflow-block","overflow-clip-margin","overflow-inline","overflow-wrap","overflow-x","overflow-y","overlay","overscroll-behavior","overscroll-behavior-block","overscroll-behavior-inline","overscroll-behavior-x","overscroll-behavior-y","padding","padding-block","padding-block-end","padding-block-start","padding-bottom","padding-inline","padding-inline-end","padding-inline-start","padding-left","padding-right","padding-top","page","page-break-after","page-break-before","page-break-inside","paint-order","pause","pause-after","pause-before","perspective","perspective-origin","place-content","place-items","place-self","pointer-events","position","position-anchor","position-visibility","print-color-adjust","quotes","r","resize","rest","rest-after","rest-before","right","rotate","row-gap","ruby-align","ruby-position","scale","scroll-behavior","scroll-margin","scroll-margin-block","scroll-margin-block-end","scroll-margin-block-start","scroll-margin-bottom","scroll-margin-inline","scroll-margin-inline-end","scroll-margin-inline-start","scroll-margin-left","scroll-margin-right","scroll-margin-top","scroll-padding","scroll-padding-block","scroll-padding-block-end","scroll-padding-block-start","scroll-padding-bottom","scroll-padding-inline","scroll-padding-inline-end","scroll-padding-inline-start","scroll-padding-left","scroll-padding-right","scroll-padding-top","scroll-snap-align","scroll-snap-stop","scroll-snap-type","scroll-timeline","scroll-timeline-axis","scroll-timeline-name","scrollbar-color","scrollbar-gutter","scrollbar-width","shape-image-threshold","shape-margin","shape-outside","shape-rendering","speak","speak-as","src","stop-color","stop-opacity","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","tab-size","table-layout","text-align","text-align-all","text-align-last","text-anchor","text-combine-upright","text-decoration","text-decoration-color","text-decoration-line","text-decoration-skip","text-decoration-skip-ink","text-decoration-style","text-decoration-thickness","text-emphasis","text-emphasis-color","text-emphasis-position","text-emphasis-style","text-indent","text-justify","text-orientation","text-overflow","text-rendering","text-shadow","text-size-adjust","text-transform","text-underline-offset","text-underline-position","text-wrap","text-wrap-mode","text-wrap-style","timeline-scope","top","touch-action","transform","transform-box","transform-origin","transform-style","transition","transition-behavior","transition-delay","transition-duration","transition-property","transition-timing-function","translate","unicode-bidi","user-modify","user-select","vector-effect","vertical-align","view-timeline","view-timeline-axis","view-timeline-inset","view-timeline-name","view-transition-name","visibility","voice-balance","voice-duration","voice-family","voice-pitch","voice-range","voice-rate","voice-stress","voice-volume","white-space","white-space-collapse","widows","width","will-change","word-break","word-spacing","word-wrap","writing-mode","x","y","z-index","zoom"].sort().reverse(),_=f.concat(m).sort().reverse();function c(h){const p=s(h),T=_,$="and or not only",S="[\\w-]+",y="("+S+"|@\\{"+S+"\\})",g=[],E=[],v=function(X){return{className:"string",begin:"~?"+X+".*?"+X}},b=function(X,W,z){return{className:X,begin:W,relevance:z}},R={$pattern:/[a-z-]+/,keyword:$,attribute:l.join(" ")},O={begin:"\\(",end:"\\)",contains:E,keywords:R,relevance:0};E.push(h.C_LINE_COMMENT_MODE,h.C_BLOCK_COMMENT_MODE,v("'"),v('"'),p.CSS_NUMBER_MODE,{begin:"(url|data-uri)\\(",starts:{className:"string",end:"[\\)\\n]",excludeEnd:true}},p.HEXCOLOR,O,b("variable","@@?"+S,10),b("variable","@\\{"+S+"\\}"),b("built_in","~?`[^`]*?`"),{className:"attribute",begin:S+"\\s*:",end:":",returnBegin:true,excludeEnd:true},p.IMPORTANT,{beginKeywords:"and not"},p.FUNCTION_DISPATCH);const w=E.concat({begin:/\{/,end:/\}/,contains:g}),L={beginKeywords:"when",endsWithParent:true,contains:[{beginKeywords:"and not"}].concat(E)},I={begin:y+"\\s*:",returnBegin:true,end:/[;}]/,relevance:0,contains:[{begin:/-(webkit|moz|ms|o)-/},p.CSS_VARIABLE,{className:"attribute",begin:"\\b("+u.join("|")+")\\b",end:/(?=:)/,starts:{endsWithParent:true,illegal:"[<=$]",relevance:0,contains:E}}]},k={className:"keyword",begin:"@(import|media|charset|font-face|(-[a-z]+-)?keyframes|supports|document|namespace|page|viewport|host)\\b",starts:{end:"[;{}]",keywords:R,returnEnd:true,contains:E,relevance:0}},x={className:"variable",variants:[{begin:"@"+S+"\\s*:",relevance:15},{begin:"@"+S}],starts:{end:"[;}]",returnEnd:true,contains:w}},P={variants:[{begin:"[\\.#:&\\[>]",end:"[;{}]"},{begin:y,end:/\{/}],returnBegin:true,returnEnd:true,illegal:`[<='$"]`,relevance:0,contains:[h.C_LINE_COMMENT_MODE,h.C_BLOCK_COMMENT_MODE,L,b("keyword","all\\b"),b("variable","@\\{"+S+"\\}"),{begin:"\\b("+o.join("|")+")\\b",className:"selector-tag"},p.CSS_NUMBER_MODE,b("selector-tag",y,0),b("selector-id","#"+y),b("selector-class","\\."+y,0),b("selector-tag","&",0),p.ATTRIBUTE_SELECTOR_MODE,{className:"selector-pseudo",begin:":("+f.join("|")+")"},{className:"selector-pseudo",begin:":(:)?("+m.join("|")+")"},{begin:/\(/,end:/\)/,relevance:0,contains:w},{begin:"!important"},p.FUNCTION_DISPATCH]},F={begin:S+`:(:)?(${T.join("|")})`,returnBegin:true,contains:[P]};return g.push(h.C_LINE_COMMENT_MODE,h.C_BLOCK_COMMENT_MODE,k,x,F,I,P,L,p.FUNCTION_DISPATCH),{name:"Less",case_insensitive:true,illegal:`[=>'/<($"]`,contains:g}}return Fg=c,Fg}var Gg,K$;function VF(){if(K$)return Gg;K$=1;function s(n){const i="\\[=*\\[",o="\\]=*\\]",l={begin:i,end:o,contains:["self"]},f=[n.COMMENT("--(?!"+i+")","$"),n.COMMENT("--"+i,o,{contains:[l],relevance:10})];return{name:"Lua",aliases:["pluto"],keywords:{$pattern:n.UNDERSCORE_IDENT_RE,literal:"true false nil",keyword:"and break do else elseif end for goto if in local not or repeat return then until while",built_in:"_G _ENV _VERSION __index __newindex __mode __call __metatable __tostring __len __gc __add __sub __mul __div __mod __pow __concat __unm __eq __lt __le assert collectgarbage dofile error getfenv getmetatable ipairs load loadfile loadstring module next pairs pcall print rawequal rawget rawset require select setfenv setmetatable tonumber tostring type unpack xpcall arg self coroutine resume yield status wrap create running debug getupvalue debug sethook getmetatable gethook setmetatable setlocal traceback setfenv getinfo setupvalue getlocal getregistry getfenv io lines write close flush open output type read stderr stdin input stdout popen tmpfile math log max acos huge ldexp pi cos tanh pow deg tan cosh sinh random randomseed frexp ceil floor rad abs sqrt modf asin min mod fmod log10 atan2 exp sin atan os exit setlocale date getenv difftime remove time clock tmpname rename execute package preload loadlib loaded loaders cpath config path seeall string sub upper len gfind rep find match char dump gmatch reverse byte format gsub lower table setn insert getn foreachi maxn foreach concat sort remove"},contains:f.concat([{className:"function",beginKeywords:"function",end:"\\)",contains:[n.inherit(n.TITLE_MODE,{begin:"([_a-zA-Z]\\w*\\.)*([_a-zA-Z]\\w*:)?[_a-zA-Z]\\w*"}),{className:"params",begin:"\\(",endsWithParent:true,contains:f}].concat(f)},n.C_NUMBER_MODE,n.APOS_STRING_MODE,n.QUOTE_STRING_MODE,{className:"string",begin:i,end:o,contains:[l],relevance:5}])}}return Gg=s,Gg}var Hg,Y$;function WF(){if(Y$)return Hg;Y$=1;function s(n){const i={className:"variable",variants:[{begin:"\\$\\("+n.UNDERSCORE_IDENT_RE+"\\)",contains:[n.BACKSLASH_ESCAPE]},{begin:/\$[@%<?\^\+\*]/}]},o={className:"string",begin:/"/,end:/"/,contains:[n.BACKSLASH_ESCAPE,i]},l={className:"variable",begin:/\$\([\w-]+\s/,end:/\)/,keywords:{built_in:"subst patsubst strip findstring filter filter-out sort word wordlist firstword lastword dir notdir suffix basename addsuffix addprefix join wildcard realpath abspath error warning shell origin flavor foreach if or and call eval file value"},contains:[i,o]},f={begin:"^"+n.UNDERSCORE_IDENT_RE+"\\s*(?=[:+?]?=)"},m={className:"meta",begin:/^\.PHONY:/,end:/$/,keywords:{$pattern:/[\.\w]+/,keyword:".PHONY"}},u={className:"section",begin:/^[^\s]+:/,end:/$/,contains:[i]};return{name:"Makefile",aliases:["mk","mak","make"],keywords:{$pattern:/[\w-]+/,keyword:"define endef undefine ifdef ifndef ifeq ifneq else endif include -include sinclude override export unexport private vpath"},contains:[n.HASH_COMMENT_MODE,i,o,l,f,m,u]}}return Hg=s,Hg}var Vg,q$;function zF(){if(q$)return Vg;q$=1;function s(n){const i=n.regex,o=["abs","accept","alarm","and","atan2","bind","binmode","bless","break","caller","chdir","chmod","chomp","chop","chown","chr","chroot","class","close","closedir","connect","continue","cos","crypt","dbmclose","dbmopen","defined","delete","die","do","dump","each","else","elsif","endgrent","endhostent","endnetent","endprotoent","endpwent","endservent","eof","eval","exec","exists","exit","exp","fcntl","field","fileno","flock","for","foreach","fork","format","formline","getc","getgrent","getgrgid","getgrnam","gethostbyaddr","gethostbyname","gethostent","getlogin","getnetbyaddr","getnetbyname","getnetent","getpeername","getpgrp","getpriority","getprotobyname","getprotobynumber","getprotoent","getpwent","getpwnam","getpwuid","getservbyname","getservbyport","getservent","getsockname","getsockopt","given","glob","gmtime","goto","grep","gt","hex","if","index","int","ioctl","join","keys","kill","last","lc","lcfirst","length","link","listen","local","localtime","log","lstat","lt","ma","map","method","mkdir","msgctl","msgget","msgrcv","msgsnd","my","ne","next","no","not","oct","open","opendir","or","ord","our","pack","package","pipe","pop","pos","print","printf","prototype","push","q|0","qq","quotemeta","qw","qx","rand","read","readdir","readline","readlink","readpipe","recv","redo","ref","rename","require","reset","return","reverse","rewinddir","rindex","rmdir","say","scalar","seek","seekdir","select","semctl","semget","semop","send","setgrent","sethostent","setnetent","setpgrp","setpriority","setprotoent","setpwent","setservent","setsockopt","shift","shmctl","shmget","shmread","shmwrite","shutdown","sin","sleep","socket","socketpair","sort","splice","split","sprintf","sqrt","srand","stat","state","study","sub","substr","symlink","syscall","sysopen","sysread","sysseek","system","syswrite","tell","telldir","tie","tied","time","times","tr","truncate","uc","ucfirst","umask","undef","unless","unlink","unpack","unshift","untie","until","use","utime","values","vec","wait","waitpid","wantarray","warn","when","while","write","x|0","xor","y|0"],l=/[dualxmsipngr]{0,12}/,f={$pattern:/[\w.]+/,keyword:o.join(" ")},m={className:"subst",begin:"[$@]\\{",end:"\\}",keywords:f},u={begin:/->\{/,end:/\}/},_={scope:"attr",match:/\s+:\s*\w+(\s*\(.*?\))?/},c={scope:"variable",variants:[{begin:/\$\d/},{begin:i.concat(/[$%@](?!")(\^\w\b|#\w+(::\w+)*|\{\w+\}|\w+(::\w*)*)/,"(?![A-Za-z])(?![@$%])")},{begin:/[$%@](?!")[^\s\w{=]|\$=/,relevance:0}],contains:[_]},h={className:"number",variants:[{match:/0?\.[0-9][0-9_]+\b/},{match:/\bv?(0|[1-9][0-9_]*(\.[0-9_]+)?|[1-9][0-9_]*)\b/},{match:/\b0[0-7][0-7_]*\b/},{match:/\b0x[0-9a-fA-F][0-9a-fA-F_]*\b/},{match:/\b0b[0-1][0-1_]*\b/}],relevance:0},p=[n.BACKSLASH_ESCAPE,m,c],T=[/!/,/\//,/\|/,/\?/,/'/,/"/,/#/],$=(g,E,v="\\1")=>{const b=v==="\\1"?v:i.concat(v,E);return i.concat(i.concat("(?:",g,")"),E,/(?:\\.|[^\\\/])*?/,b,/(?:\\.|[^\\\/])*?/,v,l)},S=(g,E,v)=>i.concat(i.concat("(?:",g,")"),E,/(?:\\.|[^\\\/])*?/,v,l),y=[c,n.HASH_COMMENT_MODE,n.COMMENT(/^=\w/,/=cut/,{endsWithParent:true}),u,{className:"string",contains:p,variants:[{begin:"q[qwxr]?\\s*\\(",end:"\\)",relevance:5},{begin:"q[qwxr]?\\s*\\[",end:"\\]",relevance:5},{begin:"q[qwxr]?\\s*\\{",end:"\\}",relevance:5},{begin:"q[qwxr]?\\s*\\|",end:"\\|",relevance:5},{begin:"q[qwxr]?\\s*<",end:">",relevance:5},{begin:"qw\\s+q",end:"q",relevance:5},{begin:"'",end:"'",contains:[n.BACKSLASH_ESCAPE]},{begin:'"',end:'"'},{begin:"`",end:"`",contains:[n.BACKSLASH_ESCAPE]},{begin:/\{\w+\}/,relevance:0},{begin:"-?\\w+\\s*=>",relevance:0}]},h,{begin:"(\\/\\/|"+n.RE_STARTERS_RE+"|\\b(split|return|print|reverse|grep)\\b)\\s*",keywords:"split return print reverse grep",relevance:0,contains:[n.HASH_COMMENT_MODE,{className:"regexp",variants:[{begin:$("s|tr|y",i.either(...T,{capture:true}))},{begin:$("s|tr|y","\\(","\\)")},{begin:$("s|tr|y","\\[","\\]")},{begin:$("s|tr|y","\\{","\\}")}],relevance:2},{className:"regexp",variants:[{begin:/(m|qr)\/\//,relevance:0},{begin:S("(?:m|qr)?",/\//,/\//)},{begin:S("m|qr",i.either(...T,{capture:true}),/\1/)},{begin:S("m|qr",/\(/,/\)/)},{begin:S("m|qr",/\[/,/\]/)},{begin:S("m|qr",/\{/,/\}/)}]}]},{className:"function",beginKeywords:"sub method",end:"(\\s*\\(.*?\\))?[;{]",excludeEnd:true,relevance:5,contains:[n.TITLE_MODE,_]},{className:"class",beginKeywords:"class",end:"[;{]",excludeEnd:true,relevance:5,contains:[n.TITLE_MODE,_,h]},{begin:"-\\w\\b",relevance:0},{begin:"^__DATA__$",end:"^__END__$",subLanguage:"mojolicious",contains:[{begin:"^@@.*",end:"$",className:"comment"}]}];return m.contains=y,u.contains=y,{name:"Perl",aliases:["pl","pm"],keywords:f,contains:y}}return Vg=s,Vg}var Wg,J$;function jF(){if(J$)return Wg;J$=1;function s(n){const i={className:"built_in",begin:"\\b(AV|CA|CF|CG|CI|CL|CM|CN|CT|MK|MP|MTK|MTL|NS|SCN|SK|UI|WK|XC)\\w+"},o=/[a-zA-Z@][a-zA-Z0-9_]*/,_={"variable.language":["this","super"],$pattern:o,keyword:["while","export","sizeof","typedef","const","struct","for","union","volatile","static","mutable","if","do","return","goto","enum","else","break","extern","asm","case","default","register","explicit","typename","switch","continue","inline","readonly","assign","readwrite","self","@synchronized","id","typeof","nonatomic","IBOutlet","IBAction","strong","weak","copy","in","out","inout","bycopy","byref","oneway","__strong","__weak","__block","__autoreleasing","@private","@protected","@public","@try","@property","@end","@throw","@catch","@finally","@autoreleasepool","@synthesize","@dynamic","@selector","@optional","@required","@encode","@package","@import","@defs","@compatibility_alias","__bridge","__bridge_transfer","__bridge_retained","__bridge_retain","__covariant","__contravariant","__kindof","_Nonnull","_Nullable","_Null_unspecified","__FUNCTION__","__PRETTY_FUNCTION__","__attribute__","getter","setter","retain","unsafe_unretained","nonnull","nullable","null_unspecified","null_resettable","class","instancetype","NS_DESIGNATED_INITIALIZER","NS_UNAVAILABLE","NS_REQUIRES_SUPER","NS_RETURNS_INNER_POINTER","NS_INLINE","NS_AVAILABLE","NS_DEPRECATED","NS_ENUM","NS_OPTIONS","NS_SWIFT_UNAVAILABLE","NS_ASSUME_NONNULL_BEGIN","NS_ASSUME_NONNULL_END","NS_REFINED_FOR_SWIFT","NS_SWIFT_NAME","NS_SWIFT_NOTHROW","NS_DURING","NS_HANDLER","NS_ENDHANDLER","NS_VALUERETURN","NS_VOIDRETURN"],literal:["false","true","FALSE","TRUE","nil","YES","NO","NULL"],built_in:["dispatch_once_t","dispatch_queue_t","dispatch_sync","dispatch_async","dispatch_once"],type:["int","float","char","unsigned","signed","short","long","double","wchar_t","unichar","void","bool","BOOL","id|0","_Bool"]},c={$pattern:o,keyword:["@interface","@class","@protocol","@implementation"]};return{name:"Objective-C",aliases:["mm","objc","obj-c","obj-c++","objective-c++"],keywords:_,illegal:"</",contains:[i,n.C_LINE_COMMENT_MODE,n.C_BLOCK_COMMENT_MODE,n.C_NUMBER_MODE,n.QUOTE_STRING_MODE,n.APOS_STRING_MODE,{className:"string",variants:[{begin:'@"',end:'"',illegal:"\\n",contains:[n.BACKSLASH_ESCAPE]}]},{className:"meta",begin:/#\s*[a-z]+\b/,end:/$/,keywords:{keyword:"if else elif endif define undef warning error line pragma ifdef ifndef include"},contains:[{begin:/\\\n/,relevance:0},n.inherit(n.QUOTE_STRING_MODE,{className:"string"}),{className:"string",begin:/<.*?>/,end:/$/,illegal:"\\n"},n.C_LINE_COMMENT_MODE,n.C_BLOCK_COMMENT_MODE]},{className:"class",begin:"("+c.keyword.join("|")+")\\b",end:/(\{|$)/,excludeEnd:true,keywords:c,contains:[n.UNDERSCORE_TITLE_MODE]},{begin:"\\."+n.UNDERSCORE_IDENT_RE,relevance:0}]}}return Wg=s,Wg}var zg,Z$;function XF(){if(Z$)return zg;Z$=1;function s(n){const i=n.regex,o=/(?![A-Za-z0-9])(?![$])/,l=i.concat(/[a-zA-Z_\x7f-\xff][a-zA-Z0-9_\x7f-\xff]*/,o),f=i.concat(/(\\?[A-Z][a-z0-9_\x7f-\xff]+|\\?[A-Z]+(?=[A-Z][a-z0-9_\x7f-\xff])){1,}/,o),m=i.concat(/[A-Z]+/,o),u={scope:"variable",match:"\\$+"+l},_={scope:"meta",variants:[{begin:/<\?php/,relevance:10},{begin:/<\?=/},{begin:/<\?/,relevance:.1},{begin:/\?>/}]},c={scope:"subst",variants:[{begin:/\$\w+/},{begin:/\{\$/,end:/\}/}]},h=n.inherit(n.APOS_STRING_MODE,{illegal:null}),p=n.inherit(n.QUOTE_STRING_MODE,{illegal:null,contains:n.QUOTE_STRING_MODE.contains.concat(c)}),T={begin:/<<<[ \t]*(?:(\w+)|"(\w+)")\n/,end:/[ \t]*(\w+)\b/,contains:n.QUOTE_STRING_MODE.contains.concat(c),"on:begin":(z,j)=>{j.data._beginMatch=z[1]||z[2]},"on:end":(z,j)=>{j.data._beginMatch!==z[1]&&j.ignoreMatch()}},$=n.END_SAME_AS_BEGIN({begin:/<<<[ \t]*'(\w+)'\n/,end:/[ \t]*(\w+)\b/}),S=`[ 	
]`,y={scope:"string",variants:[p,h,T,$]},g={scope:"number",variants:[{begin:"\\b0[bB][01]+(?:_[01]+)*\\b"},{begin:"\\b0[oO][0-7]+(?:_[0-7]+)*\\b"},{begin:"\\b0[xX][\\da-fA-F]+(?:_[\\da-fA-F]+)*\\b"},{begin:"(?:\\b\\d+(?:_\\d+)*(\\.(?:\\d+(?:_\\d+)*))?|\\B\\.\\d+)(?:[eE][+-]?\\d+)?"}],relevance:0},E=["false","null","true"],v=["__CLASS__","__DIR__","__FILE__","__FUNCTION__","__COMPILER_HALT_OFFSET__","__LINE__","__METHOD__","__NAMESPACE__","__TRAIT__","die","echo","exit","include","include_once","print","require","require_once","array","abstract","and","as","binary","bool","boolean","break","callable","case","catch","class","clone","const","continue","declare","default","do","double","else","elseif","empty","enddeclare","endfor","endforeach","endif","endswitch","endwhile","enum","eval","extends","final","finally","float","for","foreach","from","global","goto","if","implements","instanceof","insteadof","int","integer","interface","isset","iterable","list","match|0","mixed","new","never","object","or","private","protected","public","readonly","real","return","string","switch","throw","trait","try","unset","use","var","void","while","xor","yield"],b=["Error|0","AppendIterator","ArgumentCountError","ArithmeticError","ArrayIterator","ArrayObject","AssertionError","BadFunctionCallException","BadMethodCallException","CachingIterator","CallbackFilterIterator","CompileError","Countable","DirectoryIterator","DivisionByZeroError","DomainException","EmptyIterator","ErrorException","Exception","FilesystemIterator","FilterIterator","GlobIterator","InfiniteIterator","InvalidArgumentException","IteratorIterator","LengthException","LimitIterator","LogicException","MultipleIterator","NoRewindIterator","OutOfBoundsException","OutOfRangeException","OuterIterator","OverflowException","ParentIterator","ParseError","RangeException","RecursiveArrayIterator","RecursiveCachingIterator","RecursiveCallbackFilterIterator","RecursiveDirectoryIterator","RecursiveFilterIterator","RecursiveIterator","RecursiveIteratorIterator","RecursiveRegexIterator","RecursiveTreeIterator","RegexIterator","RuntimeException","SeekableIterator","SplDoublyLinkedList","SplFileInfo","SplFileObject","SplFixedArray","SplHeap","SplMaxHeap","SplMinHeap","SplObjectStorage","SplObserver","SplPriorityQueue","SplQueue","SplStack","SplSubject","SplTempFileObject","TypeError","UnderflowException","UnexpectedValueException","UnhandledMatchError","ArrayAccess","BackedEnum","Closure","Fiber","Generator","Iterator","IteratorAggregate","Serializable","Stringable","Throwable","Traversable","UnitEnum","WeakReference","WeakMap","Directory","__PHP_Incomplete_Class","parent","php_user_filter","self","static","stdClass"],O={keyword:v,literal:(z=>{const j=[];return z.forEach(J=>{j.push(J),J.toLowerCase()===J?j.push(J.toUpperCase()):j.push(J.toLowerCase())}),j})(E),built_in:b},w=z=>z.map(j=>j.replace(/\|\d+$/,"")),L={variants:[{match:[/new/,i.concat(S,"+"),i.concat("(?!",w(b).join("\\b|"),"\\b)"),f],scope:{1:"keyword",4:"title.class"}}]},I=i.concat(l,"\\b(?!\\()"),k={variants:[{match:[i.concat(/::/,i.lookahead(/(?!class\b)/)),I],scope:{2:"variable.constant"}},{match:[/::/,/class/],scope:{2:"variable.language"}},{match:[f,i.concat(/::/,i.lookahead(/(?!class\b)/)),I],scope:{1:"title.class",3:"variable.constant"}},{match:[f,i.concat("::",i.lookahead(/(?!class\b)/))],scope:{1:"title.class"}},{match:[f,/::/,/class/],scope:{1:"title.class",3:"variable.language"}}]},x={scope:"attr",match:i.concat(l,i.lookahead(":"),i.lookahead(/(?!::)/))},P={relevance:0,begin:/\(/,end:/\)/,keywords:O,contains:[x,u,k,n.C_BLOCK_COMMENT_MODE,y,g,L]},F={relevance:0,match:[/\b/,i.concat("(?!fn\\b|function\\b|",w(v).join("\\b|"),"|",w(b).join("\\b|"),"\\b)"),l,i.concat(S,"*"),i.lookahead(/(?=\()/)],scope:{3:"title.function.invoke"},contains:[P]};P.contains.push(F);const X=[x,k,n.C_BLOCK_COMMENT_MODE,y,g,L],W={begin:i.concat(/#\[\s*\\?/,i.either(f,m)),beginScope:"meta",end:/]/,endScope:"meta",keywords:{literal:E,keyword:["new","array"]},contains:[{begin:/\[/,end:/]/,keywords:{literal:E,keyword:["new","array"]},contains:["self",...X]},...X,{scope:"meta",variants:[{match:f},{match:m}]}]};return{case_insensitive:false,keywords:O,contains:[W,n.HASH_COMMENT_MODE,n.COMMENT("//","$"),n.COMMENT("/\\*","\\*/",{contains:[{scope:"doctag",match:"@[A-Za-z]+"}]}),{match:/__halt_compiler\(\);/,keywords:"__halt_compiler",starts:{scope:"comment",end:n.MATCH_NOTHING_RE,contains:[{match:/\?>/,scope:"meta",endsParent:true}]}},_,{scope:"variable.language",match:/\$this\b/},u,F,k,{match:[/const/,/\s/,l],scope:{1:"keyword",3:"variable.constant"}},L,{scope:"function",relevance:0,beginKeywords:"fn function",end:/[;{]/,excludeEnd:true,illegal:"[$%\\[]",contains:[{beginKeywords:"use"},n.UNDERSCORE_TITLE_MODE,{begin:"=>",endsParent:true},{scope:"params",begin:"\\(",end:"\\)",excludeBegin:true,excludeEnd:true,keywords:O,contains:["self",W,u,k,n.C_BLOCK_COMMENT_MODE,y,g]}]},{scope:"class",variants:[{beginKeywords:"enum",illegal:/[($"]/},{beginKeywords:"class interface trait",illegal:/[:($"]/}],relevance:0,end:/\{/,excludeEnd:true,contains:[{beginKeywords:"extends implements"},n.UNDERSCORE_TITLE_MODE]},{beginKeywords:"namespace",relevance:0,end:";",illegal:/[.']/,contains:[n.inherit(n.UNDERSCORE_TITLE_MODE,{scope:"title.class"})]},{beginKeywords:"use",relevance:0,end:";",contains:[{match:/\b(as|const|function)\b/,scope:"keyword"},n.UNDERSCORE_TITLE_MODE]},y,g]}}return zg=s,zg}var jg,Q$;function KF(){if(Q$)return jg;Q$=1;function s(n){return{name:"PHP template",subLanguage:"xml",contains:[{begin:/<\?(php|=)?/,end:/\?>/,subLanguage:"php",contains:[{begin:"/\\*",end:"\\*/",skip:true},{begin:'b"',end:'"',skip:true},{begin:"b'",end:"'",skip:true},n.inherit(n.APOS_STRING_MODE,{illegal:null,className:null,contains:null,skip:true}),n.inherit(n.QUOTE_STRING_MODE,{illegal:null,className:null,contains:null,skip:true})]}]}}return jg=s,jg}var Xg,ey;function YF(){if(ey)return Xg;ey=1;function s(n){return{name:"Plain text",aliases:["text","txt"],disableAutodetect:true}}return Xg=s,Xg}var Kg,ty;function qF(){if(ty)return Kg;ty=1;function s(n){const i=n.regex,o=new RegExp("[\\p{XID_Start}_]\\p{XID_Continue}*","u"),l=["and","as","assert","async","await","break","case","class","continue","def","del","elif","else","except","finally","for","from","global","if","import","in","is","lambda","match","nonlocal|10","not","or","pass","raise","return","try","while","with","yield"],_={$pattern:/[A-Za-z]\w+|__\w+__/,keyword:l,built_in:["__import__","abs","all","any","ascii","bin","bool","breakpoint","bytearray","bytes","callable","chr","classmethod","compile","complex","delattr","dict","dir","divmod","enumerate","eval","exec","filter","float","format","frozenset","getattr","globals","hasattr","hash","help","hex","id","input","int","isinstance","issubclass","iter","len","list","locals","map","max","memoryview","min","next","object","oct","open","ord","pow","print","property","range","repr","reversed","round","set","setattr","slice","sorted","staticmethod","str","sum","super","tuple","type","vars","zip"],literal:["__debug__","Ellipsis","False","None","NotImplemented","True"],type:["Any","Callable","Coroutine","Dict","List","Literal","Generic","Optional","Sequence","Set","Tuple","Type","Union"]},c={className:"meta",begin:/^(>>>|\.\.\.) /},h={className:"subst",begin:/\{/,end:/\}/,keywords:_,illegal:/#/},p={begin:/\{\{/,relevance:0},T={className:"string",contains:[n.BACKSLASH_ESCAPE],variants:[{begin:/([uU]|[bB]|[rR]|[bB][rR]|[rR][bB])?'''/,end:/'''/,contains:[n.BACKSLASH_ESCAPE,c],relevance:10},{begin:/([uU]|[bB]|[rR]|[bB][rR]|[rR][bB])?"""/,end:/"""/,contains:[n.BACKSLASH_ESCAPE,c],relevance:10},{begin:/([fF][rR]|[rR][fF]|[fF])'''/,end:/'''/,contains:[n.BACKSLASH_ESCAPE,c,p,h]},{begin:/([fF][rR]|[rR][fF]|[fF])"""/,end:/"""/,contains:[n.BACKSLASH_ESCAPE,c,p,h]},{begin:/([uU]|[rR])'/,end:/'/,relevance:10},{begin:/([uU]|[rR])"/,end:/"/,relevance:10},{begin:/([bB]|[bB][rR]|[rR][bB])'/,end:/'/},{begin:/([bB]|[bB][rR]|[rR][bB])"/,end:/"/},{begin:/([fF][rR]|[rR][fF]|[fF])'/,end:/'/,contains:[n.BACKSLASH_ESCAPE,p,h]},{begin:/([fF][rR]|[rR][fF]|[fF])"/,end:/"/,contains:[n.BACKSLASH_ESCAPE,p,h]},n.APOS_STRING_MODE,n.QUOTE_STRING_MODE]},$="[0-9](_?[0-9])*",S=`(\\b(${$}))?\\.(${$})|\\b(${$})\\.`,y=`\\b|${l.join("|")}`,g={className:"number",relevance:0,variants:[{begin:`(\\b(${$})|(${S}))[eE][+-]?(${$})[jJ]?(?=${y})`},{begin:`(${S})[jJ]?`},{begin:`\\b([1-9](_?[0-9])*|0+(_?0)*)[lLjJ]?(?=${y})`},{begin:`\\b0[bB](_?[01])+[lL]?(?=${y})`},{begin:`\\b0[oO](_?[0-7])+[lL]?(?=${y})`},{begin:`\\b0[xX](_?[0-9a-fA-F])+[lL]?(?=${y})`},{begin:`\\b(${$})[jJ](?=${y})`}]},E={className:"comment",begin:i.lookahead(/# type:/),end:/$/,keywords:_,contains:[{begin:/# type:/},{begin:/#/,end:/\b\B/,endsWithParent:true}]},v={className:"params",variants:[{className:"",begin:/\(\s*\)/,skip:true},{begin:/\(/,end:/\)/,excludeBegin:true,excludeEnd:true,keywords:_,contains:["self",c,g,T,n.HASH_COMMENT_MODE]}]};return h.contains=[T,g,c],{name:"Python",aliases:["py","gyp","ipython"],unicodeRegex:true,keywords:_,illegal:/(<\/|\?)|=>/,contains:[c,g,{scope:"variable.language",match:/\bself\b/},{beginKeywords:"if",relevance:0},{match:/\bor\b/,scope:"keyword"},T,E,n.HASH_COMMENT_MODE,{match:[/\bdef/,/\s+/,o],scope:{1:"keyword",3:"title.function"},contains:[v]},{variants:[{match:[/\bclass/,/\s+/,o,/\s*/,/\(\s*/,o,/\s*\)/]},{match:[/\bclass/,/\s+/,o]}],scope:{1:"keyword",3:"title.class",6:"title.class.inherited"}},{className:"meta",begin:/^[\t ]*@/,end:/(?=#)|$/,contains:[g,v,T]}]}}return Kg=s,Kg}var Yg,sy;function JF(){if(sy)return Yg;sy=1;function s(n){return{aliases:["pycon"],contains:[{className:"meta.prompt",starts:{end:/ |$/,starts:{end:"$",subLanguage:"python"}},variants:[{begin:/^>>>(?=[ ]|$)/},{begin:/^\.\.\.(?=[ ]|$)/}]}]}}return Yg=s,Yg}var qg,iy;function ZF(){if(iy)return qg;iy=1;function s(n){const i=n.regex,o=/(?:(?:[a-zA-Z]|\.[._a-zA-Z])[._a-zA-Z0-9]*)|\.(?!\d)/,l=i.either(/0[xX][0-9a-fA-F]+\.[0-9a-fA-F]*[pP][+-]?\d+i?/,/0[xX][0-9a-fA-F]+(?:[pP][+-]?\d+)?[Li]?/,/(?:\d+(?:\.\d*)?|\.\d+)(?:[eE][+-]?\d+)?[Li]?/),f=/[=!<>:]=|\|\||&&|:::?|<-|<<-|->>|->|\|>|[-+*\/?!$&|:<=>@^~]|\*\*/,m=i.either(/[()]/,/[{}]/,/\[\[/,/[[\]]/,/\\/,/,/);return{name:"R",keywords:{$pattern:o,keyword:"function if in break next repeat else for while",literal:"NULL NA TRUE FALSE Inf NaN NA_integer_|10 NA_real_|10 NA_character_|10 NA_complex_|10",built_in:"LETTERS letters month.abb month.name pi T F abs acos acosh all any anyNA Arg as.call as.character as.complex as.double as.environment as.integer as.logical as.null.default as.numeric as.raw asin asinh atan atanh attr attributes baseenv browser c call ceiling class Conj cos cosh cospi cummax cummin cumprod cumsum digamma dim dimnames emptyenv exp expression floor forceAndCall gamma gc.time globalenv Im interactive invisible is.array is.atomic is.call is.character is.complex is.double is.environment is.expression is.finite is.function is.infinite is.integer is.language is.list is.logical is.matrix is.na is.name is.nan is.null is.numeric is.object is.pairlist is.raw is.recursive is.single is.symbol lazyLoadDBfetch length lgamma list log max min missing Mod names nargs nzchar oldClass on.exit pos.to.env proc.time prod quote range Re rep retracemem return round seq_along seq_len seq.int sign signif sin sinh sinpi sqrt standardGeneric substitute sum switch tan tanh tanpi tracemem trigamma trunc unclass untracemem UseMethod xtfrm"},contains:[n.COMMENT(/#'/,/$/,{contains:[{scope:"doctag",match:/@examples/,starts:{end:i.lookahead(i.either(/\n^#'\s*(?=@[a-zA-Z]+)/,/\n^(?!#')/)),endsParent:true}},{scope:"doctag",begin:"@param",end:/$/,contains:[{scope:"variable",variants:[{match:o},{match:/`(?:\\.|[^`\\])+`/}],endsParent:true}]},{scope:"doctag",match:/@[a-zA-Z]+/},{scope:"keyword",match:/\\[a-zA-Z]+/}]}),n.HASH_COMMENT_MODE,{scope:"string",contains:[n.BACKSLASH_ESCAPE],variants:[n.END_SAME_AS_BEGIN({begin:/[rR]"(-*)\(/,end:/\)(-*)"/}),n.END_SAME_AS_BEGIN({begin:/[rR]"(-*)\{/,end:/\}(-*)"/}),n.END_SAME_AS_BEGIN({begin:/[rR]"(-*)\[/,end:/\](-*)"/}),n.END_SAME_AS_BEGIN({begin:/[rR]'(-*)\(/,end:/\)(-*)'/}),n.END_SAME_AS_BEGIN({begin:/[rR]'(-*)\{/,end:/\}(-*)'/}),n.END_SAME_AS_BEGIN({begin:/[rR]'(-*)\[/,end:/\](-*)'/}),{begin:'"',end:'"',relevance:0},{begin:"'",end:"'",relevance:0}]},{relevance:0,variants:[{scope:{1:"operator",2:"number"},match:[f,l]},{scope:{1:"operator",2:"number"},match:[/%[^%]*%/,l]},{scope:{1:"punctuation",2:"number"},match:[m,l]},{scope:{2:"number"},match:[/[^a-zA-Z0-9._]|^/,l]}]},{scope:{3:"operator"},match:[o,/\s+/,/<-/,/\s+/]},{scope:"operator",relevance:0,variants:[{match:f},{match:/%[^%]*%/}]},{scope:"punctuation",relevance:0,match:m},{begin:"`",end:"`",contains:[{begin:/\\./}]}]}}return qg=s,qg}var Jg,ny;function QF(){if(ny)return Jg;ny=1;function s(n){const i=n.regex,o=/(r#)?/,l=i.concat(o,n.UNDERSCORE_IDENT_RE),f=i.concat(o,n.IDENT_RE),m={className:"title.function.invoke",relevance:0,begin:i.concat(/\b/,/(?!let|for|while|if|else|match\b)/,f,i.lookahead(/\s*\(/))},u="([ui](8|16|32|64|128|size)|f(32|64))?",_=["abstract","as","async","await","become","box","break","const","continue","crate","do","dyn","else","enum","extern","false","final","fn","for","if","impl","in","let","loop","macro","match","mod","move","mut","override","priv","pub","ref","return","self","Self","static","struct","super","trait","true","try","type","typeof","union","unsafe","unsized","use","virtual","where","while","yield"],c=["true","false","Some","None","Ok","Err"],h=["drop ","Copy","Send","Sized","Sync","Drop","Fn","FnMut","FnOnce","ToOwned","Clone","Debug","PartialEq","PartialOrd","Eq","Ord","AsRef","AsMut","Into","From","Default","Iterator","Extend","IntoIterator","DoubleEndedIterator","ExactSizeIterator","SliceConcatExt","ToString","assert!","assert_eq!","bitflags!","bytes!","cfg!","col!","concat!","concat_idents!","debug_assert!","debug_assert_eq!","env!","eprintln!","panic!","file!","format!","format_args!","include_bytes!","include_str!","line!","local_data_key!","module_path!","option_env!","print!","println!","select!","stringify!","try!","unimplemented!","unreachable!","vec!","write!","writeln!","macro_rules!","assert_ne!","debug_assert_ne!"],p=["i8","i16","i32","i64","i128","isize","u8","u16","u32","u64","u128","usize","f32","f64","str","char","bool","Box","Option","Result","String","Vec"];return{name:"Rust",aliases:["rs"],keywords:{$pattern:n.IDENT_RE+"!?",type:p,keyword:_,literal:c,built_in:h},illegal:"</",contains:[n.C_LINE_COMMENT_MODE,n.COMMENT("/\\*","\\*/",{contains:["self"]}),n.inherit(n.QUOTE_STRING_MODE,{begin:/b?"/,illegal:null}),{className:"symbol",begin:/'[a-zA-Z_][a-zA-Z0-9_]*(?!')/},{scope:"string",variants:[{begin:/b?r(#*)"(.|\n)*?"\1(?!#)/},{begin:/b?'/,end:/'/,contains:[{scope:"char.escape",match:/\\('|\w|x\w{2}|u\w{4}|U\w{8})/}]}]},{className:"number",variants:[{begin:"\\b0b([01_]+)"+u},{begin:"\\b0o([0-7_]+)"+u},{begin:"\\b0x([A-Fa-f0-9_]+)"+u},{begin:"\\b(\\d[\\d_]*(\\.[0-9_]+)?([eE][+-]?[0-9_]+)?)"+u}],relevance:0},{begin:[/fn/,/\s+/,l],className:{1:"keyword",3:"title.function"}},{className:"meta",begin:"#!?\\[",end:"\\]",contains:[{className:"string",begin:/"/,end:/"/,contains:[n.BACKSLASH_ESCAPE]}]},{begin:[/let/,/\s+/,/(?:mut\s+)?/,l],className:{1:"keyword",3:"keyword",4:"variable"}},{begin:[/for/,/\s+/,l,/\s+/,/in/],className:{1:"keyword",3:"variable",5:"keyword"}},{begin:[/type/,/\s+/,l],className:{1:"keyword",3:"title.class"}},{begin:[/(?:trait|enum|struct|union|impl|for)/,/\s+/,l],className:{1:"keyword",3:"title.class"}},{begin:n.IDENT_RE+"::",keywords:{keyword:"Self",built_in:h,type:p}},{className:"punctuation",begin:"->"},m]}}return Jg=s,Jg}var Zg,ry;function eG(){if(ry)return Zg;ry=1;const s=c=>({IMPORTANT:{scope:"meta",begin:"!important"},BLOCK_COMMENT:c.C_BLOCK_COMMENT_MODE,HEXCOLOR:{scope:"number",begin:/#(([0-9a-fA-F]{3,4})|(([0-9a-fA-F]{2}){3,4}))\b/},FUNCTION_DISPATCH:{className:"built_in",begin:/[\w-]+(?=\()/},ATTRIBUTE_SELECTOR_MODE:{scope:"selector-attr",begin:/\[/,end:/\]/,illegal:"$",contains:[c.APOS_STRING_MODE,c.QUOTE_STRING_MODE]},CSS_NUMBER_MODE:{scope:"number",begin:c.NUMBER_RE+"(%|em|ex|ch|rem|vw|vh|vmin|vmax|cm|mm|in|pt|pc|px|deg|grad|rad|turn|s|ms|Hz|kHz|dpi|dpcm|dppx)?",relevance:0},CSS_VARIABLE:{className:"attr",begin:/--[A-Za-z_][A-Za-z0-9_-]*/}}),n=["a","abbr","address","article","aside","audio","b","blockquote","body","button","canvas","caption","cite","code","dd","del","details","dfn","div","dl","dt","em","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","html","i","iframe","img","input","ins","kbd","label","legend","li","main","mark","menu","nav","object","ol","optgroup","option","p","picture","q","quote","samp","section","select","source","span","strong","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","tr","ul","var","video"],i=["defs","g","marker","mask","pattern","svg","switch","symbol","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feFlood","feGaussianBlur","feImage","feMerge","feMorphology","feOffset","feSpecularLighting","feTile","feTurbulence","linearGradient","radialGradient","stop","circle","ellipse","image","line","path","polygon","polyline","rect","text","use","textPath","tspan","foreignObject","clipPath"],o=[...n,...i],l=["any-hover","any-pointer","aspect-ratio","color","color-gamut","color-index","device-aspect-ratio","device-height","device-width","display-mode","forced-colors","grid","height","hover","inverted-colors","monochrome","orientation","overflow-block","overflow-inline","pointer","prefers-color-scheme","prefers-contrast","prefers-reduced-motion","prefers-reduced-transparency","resolution","scan","scripting","update","width","min-width","max-width","min-height","max-height"].sort().reverse(),f=["active","any-link","blank","checked","current","default","defined","dir","disabled","drop","empty","enabled","first","first-child","first-of-type","fullscreen","future","focus","focus-visible","focus-within","has","host","host-context","hover","indeterminate","in-range","invalid","is","lang","last-child","last-of-type","left","link","local-link","not","nth-child","nth-col","nth-last-child","nth-last-col","nth-last-of-type","nth-of-type","only-child","only-of-type","optional","out-of-range","past","placeholder-shown","read-only","read-write","required","right","root","scope","target","target-within","user-invalid","valid","visited","where"].sort().reverse(),m=["after","backdrop","before","cue","cue-region","first-letter","first-line","grammar-error","marker","part","placeholder","selection","slotted","spelling-error"].sort().reverse(),u=["accent-color","align-content","align-items","align-self","alignment-baseline","all","anchor-name","animation","animation-composition","animation-delay","animation-direction","animation-duration","animation-fill-mode","animation-iteration-count","animation-name","animation-play-state","animation-range","animation-range-end","animation-range-start","animation-timeline","animation-timing-function","appearance","aspect-ratio","backdrop-filter","backface-visibility","background","background-attachment","background-blend-mode","background-clip","background-color","background-image","background-origin","background-position","background-position-x","background-position-y","background-repeat","background-size","baseline-shift","block-size","border","border-block","border-block-color","border-block-end","border-block-end-color","border-block-end-style","border-block-end-width","border-block-start","border-block-start-color","border-block-start-style","border-block-start-width","border-block-style","border-block-width","border-bottom","border-bottom-color","border-bottom-left-radius","border-bottom-right-radius","border-bottom-style","border-bottom-width","border-collapse","border-color","border-end-end-radius","border-end-start-radius","border-image","border-image-outset","border-image-repeat","border-image-slice","border-image-source","border-image-width","border-inline","border-inline-color","border-inline-end","border-inline-end-color","border-inline-end-style","border-inline-end-width","border-inline-start","border-inline-start-color","border-inline-start-style","border-inline-start-width","border-inline-style","border-inline-width","border-left","border-left-color","border-left-style","border-left-width","border-radius","border-right","border-right-color","border-right-style","border-right-width","border-spacing","border-start-end-radius","border-start-start-radius","border-style","border-top","border-top-color","border-top-left-radius","border-top-right-radius","border-top-style","border-top-width","border-width","bottom","box-align","box-decoration-break","box-direction","box-flex","box-flex-group","box-lines","box-ordinal-group","box-orient","box-pack","box-shadow","box-sizing","break-after","break-before","break-inside","caption-side","caret-color","clear","clip","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","color-scheme","column-count","column-fill","column-gap","column-rule","column-rule-color","column-rule-style","column-rule-width","column-span","column-width","columns","contain","contain-intrinsic-block-size","contain-intrinsic-height","contain-intrinsic-inline-size","contain-intrinsic-size","contain-intrinsic-width","container","container-name","container-type","content","content-visibility","counter-increment","counter-reset","counter-set","cue","cue-after","cue-before","cursor","cx","cy","direction","display","dominant-baseline","empty-cells","enable-background","field-sizing","fill","fill-opacity","fill-rule","filter","flex","flex-basis","flex-direction","flex-flow","flex-grow","flex-shrink","flex-wrap","float","flood-color","flood-opacity","flow","font","font-display","font-family","font-feature-settings","font-kerning","font-language-override","font-optical-sizing","font-palette","font-size","font-size-adjust","font-smooth","font-smoothing","font-stretch","font-style","font-synthesis","font-synthesis-position","font-synthesis-small-caps","font-synthesis-style","font-synthesis-weight","font-variant","font-variant-alternates","font-variant-caps","font-variant-east-asian","font-variant-emoji","font-variant-ligatures","font-variant-numeric","font-variant-position","font-variation-settings","font-weight","forced-color-adjust","gap","glyph-orientation-horizontal","glyph-orientation-vertical","grid","grid-area","grid-auto-columns","grid-auto-flow","grid-auto-rows","grid-column","grid-column-end","grid-column-start","grid-gap","grid-row","grid-row-end","grid-row-start","grid-template","grid-template-areas","grid-template-columns","grid-template-rows","hanging-punctuation","height","hyphenate-character","hyphenate-limit-chars","hyphens","icon","image-orientation","image-rendering","image-resolution","ime-mode","initial-letter","initial-letter-align","inline-size","inset","inset-area","inset-block","inset-block-end","inset-block-start","inset-inline","inset-inline-end","inset-inline-start","isolation","justify-content","justify-items","justify-self","kerning","left","letter-spacing","lighting-color","line-break","line-height","line-height-step","list-style","list-style-image","list-style-position","list-style-type","margin","margin-block","margin-block-end","margin-block-start","margin-bottom","margin-inline","margin-inline-end","margin-inline-start","margin-left","margin-right","margin-top","margin-trim","marker","marker-end","marker-mid","marker-start","marks","mask","mask-border","mask-border-mode","mask-border-outset","mask-border-repeat","mask-border-slice","mask-border-source","mask-border-width","mask-clip","mask-composite","mask-image","mask-mode","mask-origin","mask-position","mask-repeat","mask-size","mask-type","masonry-auto-flow","math-depth","math-shift","math-style","max-block-size","max-height","max-inline-size","max-width","min-block-size","min-height","min-inline-size","min-width","mix-blend-mode","nav-down","nav-index","nav-left","nav-right","nav-up","none","normal","object-fit","object-position","offset","offset-anchor","offset-distance","offset-path","offset-position","offset-rotate","opacity","order","orphans","outline","outline-color","outline-offset","outline-style","outline-width","overflow","overflow-anchor","overflow-block","overflow-clip-margin","overflow-inline","overflow-wrap","overflow-x","overflow-y","overlay","overscroll-behavior","overscroll-behavior-block","overscroll-behavior-inline","overscroll-behavior-x","overscroll-behavior-y","padding","padding-block","padding-block-end","padding-block-start","padding-bottom","padding-inline","padding-inline-end","padding-inline-start","padding-left","padding-right","padding-top","page","page-break-after","page-break-before","page-break-inside","paint-order","pause","pause-after","pause-before","perspective","perspective-origin","place-content","place-items","place-self","pointer-events","position","position-anchor","position-visibility","print-color-adjust","quotes","r","resize","rest","rest-after","rest-before","right","rotate","row-gap","ruby-align","ruby-position","scale","scroll-behavior","scroll-margin","scroll-margin-block","scroll-margin-block-end","scroll-margin-block-start","scroll-margin-bottom","scroll-margin-inline","scroll-margin-inline-end","scroll-margin-inline-start","scroll-margin-left","scroll-margin-right","scroll-margin-top","scroll-padding","scroll-padding-block","scroll-padding-block-end","scroll-padding-block-start","scroll-padding-bottom","scroll-padding-inline","scroll-padding-inline-end","scroll-padding-inline-start","scroll-padding-left","scroll-padding-right","scroll-padding-top","scroll-snap-align","scroll-snap-stop","scroll-snap-type","scroll-timeline","scroll-timeline-axis","scroll-timeline-name","scrollbar-color","scrollbar-gutter","scrollbar-width","shape-image-threshold","shape-margin","shape-outside","shape-rendering","speak","speak-as","src","stop-color","stop-opacity","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","tab-size","table-layout","text-align","text-align-all","text-align-last","text-anchor","text-combine-upright","text-decoration","text-decoration-color","text-decoration-line","text-decoration-skip","text-decoration-skip-ink","text-decoration-style","text-decoration-thickness","text-emphasis","text-emphasis-color","text-emphasis-position","text-emphasis-style","text-indent","text-justify","text-orientation","text-overflow","text-rendering","text-shadow","text-size-adjust","text-transform","text-underline-offset","text-underline-position","text-wrap","text-wrap-mode","text-wrap-style","timeline-scope","top","touch-action","transform","transform-box","transform-origin","transform-style","transition","transition-behavior","transition-delay","transition-duration","transition-property","transition-timing-function","translate","unicode-bidi","user-modify","user-select","vector-effect","vertical-align","view-timeline","view-timeline-axis","view-timeline-inset","view-timeline-name","view-transition-name","visibility","voice-balance","voice-duration","voice-family","voice-pitch","voice-range","voice-rate","voice-stress","voice-volume","white-space","white-space-collapse","widows","width","will-change","word-break","word-spacing","word-wrap","writing-mode","x","y","z-index","zoom"].sort().reverse();function _(c){const h=s(c),p=m,T=f,$="@[a-z-]+",S="and or not only",g={className:"variable",begin:"(\\$[a-zA-Z-][a-zA-Z0-9_-]*)\\b",relevance:0};return{name:"SCSS",case_insensitive:true,illegal:"[=/|']",contains:[c.C_LINE_COMMENT_MODE,c.C_BLOCK_COMMENT_MODE,h.CSS_NUMBER_MODE,{className:"selector-id",begin:"#[A-Za-z0-9_-]+",relevance:0},{className:"selector-class",begin:"\\.[A-Za-z0-9_-]+",relevance:0},h.ATTRIBUTE_SELECTOR_MODE,{className:"selector-tag",begin:"\\b("+o.join("|")+")\\b",relevance:0},{className:"selector-pseudo",begin:":("+T.join("|")+")"},{className:"selector-pseudo",begin:":(:)?("+p.join("|")+")"},g,{begin:/\(/,end:/\)/,contains:[h.CSS_NUMBER_MODE]},h.CSS_VARIABLE,{className:"attribute",begin:"\\b("+u.join("|")+")\\b"},{begin:"\\b(whitespace|wait|w-resize|visible|vertical-text|vertical-ideographic|uppercase|upper-roman|upper-alpha|underline|transparent|top|thin|thick|text|text-top|text-bottom|tb-rl|table-header-group|table-footer-group|sw-resize|super|strict|static|square|solid|small-caps|separate|se-resize|scroll|s-resize|rtl|row-resize|ridge|right|repeat|repeat-y|repeat-x|relative|progress|pointer|overline|outside|outset|oblique|nowrap|not-allowed|normal|none|nw-resize|no-repeat|no-drop|newspaper|ne-resize|n-resize|move|middle|medium|ltr|lr-tb|lowercase|lower-roman|lower-alpha|loose|list-item|line|line-through|line-edge|lighter|left|keep-all|justify|italic|inter-word|inter-ideograph|inside|inset|inline|inline-block|inherit|inactive|ideograph-space|ideograph-parenthesis|ideograph-numeric|ideograph-alpha|horizontal|hidden|help|hand|groove|fixed|ellipsis|e-resize|double|dotted|distribute|distribute-space|distribute-letter|distribute-all-lines|disc|disabled|default|decimal|dashed|crosshair|collapse|col-resize|circle|char|center|capitalize|break-word|break-all|bottom|both|bolder|bold|block|bidi-override|below|baseline|auto|always|all-scroll|absolute|table|table-cell)\\b"},{begin:/:/,end:/[;}{]/,relevance:0,contains:[h.BLOCK_COMMENT,g,h.HEXCOLOR,h.CSS_NUMBER_MODE,c.QUOTE_STRING_MODE,c.APOS_STRING_MODE,h.IMPORTANT,h.FUNCTION_DISPATCH]},{begin:"@(page|font-face)",keywords:{$pattern:$,keyword:"@page @font-face"}},{begin:"@",end:"[{;]",returnBegin:true,keywords:{$pattern:/[a-z-]+/,keyword:S,attribute:l.join(" ")},contains:[{begin:$,className:"keyword"},{begin:/[a-z-]+(?=:)/,className:"attribute"},g,c.QUOTE_STRING_MODE,c.APOS_STRING_MODE,h.HEXCOLOR,h.CSS_NUMBER_MODE]},h.FUNCTION_DISPATCH]}}return Zg=_,Zg}var Qg,oy;function tG(){if(oy)return Qg;oy=1;function s(n){return{name:"Shell Session",aliases:["console","shellsession"],contains:[{className:"meta.prompt",begin:/^\s{0,3}[/~\w\d[\]()@-]*[>%$#][ ]?/,starts:{end:/[^\\](?=\s*$)/,subLanguage:"bash"}}]}}return Qg=s,Qg}var ef,ay;function sG(){if(ay)return ef;ay=1;function s(n){const i=n.regex,o=n.COMMENT("--","$"),l={scope:"string",variants:[{begin:/'/,end:/'/,contains:[{match:/''/}]}]},f={begin:/"/,end:/"/,contains:[{match:/""/}]},m=["true","false","unknown"],u=["double precision","large object","with timezone","without timezone"],_=["bigint","binary","blob","boolean","char","character","clob","date","dec","decfloat","decimal","float","int","integer","interval","nchar","nclob","national","numeric","real","row","smallint","time","timestamp","varchar","varying","varbinary"],c=["add","asc","collation","desc","final","first","last","view"],h=["abs","acos","all","allocate","alter","and","any","are","array","array_agg","array_max_cardinality","as","asensitive","asin","asymmetric","at","atan","atomic","authorization","avg","begin","begin_frame","begin_partition","between","bigint","binary","blob","boolean","both","by","call","called","cardinality","cascaded","case","cast","ceil","ceiling","char","char_length","character","character_length","check","classifier","clob","close","coalesce","collate","collect","column","commit","condition","connect","constraint","contains","convert","copy","corr","corresponding","cos","cosh","count","covar_pop","covar_samp","create","cross","cube","cume_dist","current","current_catalog","current_date","current_default_transform_group","current_path","current_role","current_row","current_schema","current_time","current_timestamp","current_path","current_role","current_transform_group_for_type","current_user","cursor","cycle","date","day","deallocate","dec","decimal","decfloat","declare","default","define","delete","dense_rank","deref","describe","deterministic","disconnect","distinct","double","drop","dynamic","each","element","else","empty","end","end_frame","end_partition","end-exec","equals","escape","every","except","exec","execute","exists","exp","external","extract","false","fetch","filter","first_value","float","floor","for","foreign","frame_row","free","from","full","function","fusion","get","global","grant","group","grouping","groups","having","hold","hour","identity","in","indicator","initial","inner","inout","insensitive","insert","int","integer","intersect","intersection","interval","into","is","join","json_array","json_arrayagg","json_exists","json_object","json_objectagg","json_query","json_table","json_table_primitive","json_value","lag","language","large","last_value","lateral","lead","leading","left","like","like_regex","listagg","ln","local","localtime","localtimestamp","log","log10","lower","match","match_number","match_recognize","matches","max","member","merge","method","min","minute","mod","modifies","module","month","multiset","national","natural","nchar","nclob","new","no","none","normalize","not","nth_value","ntile","null","nullif","numeric","octet_length","occurrences_regex","of","offset","old","omit","on","one","only","open","or","order","out","outer","over","overlaps","overlay","parameter","partition","pattern","per","percent","percent_rank","percentile_cont","percentile_disc","period","portion","position","position_regex","power","precedes","precision","prepare","primary","procedure","ptf","range","rank","reads","real","recursive","ref","references","referencing","regr_avgx","regr_avgy","regr_count","regr_intercept","regr_r2","regr_slope","regr_sxx","regr_sxy","regr_syy","release","result","return","returns","revoke","right","rollback","rollup","row","row_number","rows","running","savepoint","scope","scroll","search","second","seek","select","sensitive","session_user","set","show","similar","sin","sinh","skip","smallint","some","specific","specifictype","sql","sqlexception","sqlstate","sqlwarning","sqrt","start","static","stddev_pop","stddev_samp","submultiset","subset","substring","substring_regex","succeeds","sum","symmetric","system","system_time","system_user","table","tablesample","tan","tanh","then","time","timestamp","timezone_hour","timezone_minute","to","trailing","translate","translate_regex","translation","treat","trigger","trim","trim_array","true","truncate","uescape","union","unique","unknown","unnest","update","upper","user","using","value","values","value_of","var_pop","var_samp","varbinary","varchar","varying","versioning","when","whenever","where","width_bucket","window","with","within","without","year"],p=["abs","acos","array_agg","asin","atan","avg","cast","ceil","ceiling","coalesce","corr","cos","cosh","count","covar_pop","covar_samp","cume_dist","dense_rank","deref","element","exp","extract","first_value","floor","json_array","json_arrayagg","json_exists","json_object","json_objectagg","json_query","json_table","json_table_primitive","json_value","lag","last_value","lead","listagg","ln","log","log10","lower","max","min","mod","nth_value","ntile","nullif","percent_rank","percentile_cont","percentile_disc","position","position_regex","power","rank","regr_avgx","regr_avgy","regr_count","regr_intercept","regr_r2","regr_slope","regr_sxx","regr_sxy","regr_syy","row_number","sin","sinh","sqrt","stddev_pop","stddev_samp","substring","substring_regex","sum","tan","tanh","translate","translate_regex","treat","trim","trim_array","unnest","upper","value_of","var_pop","var_samp","width_bucket"],T=["current_catalog","current_date","current_default_transform_group","current_path","current_role","current_schema","current_transform_group_for_type","current_user","session_user","system_time","system_user","current_time","localtime","current_timestamp","localtimestamp"],$=["create table","insert into","primary key","foreign key","not null","alter table","add constraint","grouping sets","on overflow","character set","respect nulls","ignore nulls","nulls first","nulls last","depth first","breadth first"],S=p,y=[...h,...c].filter(w=>!p.includes(w)),g={scope:"variable",match:/@[a-z0-9][a-z0-9_]*/},E={scope:"operator",match:/[-+*/=%^~]|&&?|\|\|?|!=?|<(?:=>?|<|>)?|>[>=]?/,relevance:0},v={match:i.concat(/\b/,i.either(...S),/\s*\(/),relevance:0,keywords:{built_in:S}};function b(w){return i.concat(/\b/,i.either(...w.map(L=>L.replace(/\s+/,"\\s+"))),/\b/)}const R={scope:"keyword",match:b($),relevance:0};function O(w,{exceptions:L,when:I}={}){const k=I;return L=L||[],w.map(x=>x.match(/\|\d+$/)||L.includes(x)?x:k(x)?`${x}|0`:x)}return{name:"SQL",case_insensitive:true,illegal:/[{}]|<\//,keywords:{$pattern:/\b[\w\.]+/,keyword:O(y,{when:w=>w.length<3}),literal:m,type:_,built_in:T},contains:[{scope:"type",match:b(u)},R,v,g,l,f,n.C_NUMBER_MODE,n.C_BLOCK_COMMENT_MODE,o,E]}}return ef=s,ef}var tf,ly;function iG(){if(ly)return tf;ly=1;function s(I){return I?typeof I=="string"?I:I.source:null}function n(I){return i("(?=",I,")")}function i(...I){return I.map(x=>s(x)).join("")}function o(I){const k=I[I.length-1];return typeof k=="object"&&k.constructor===Object?(I.splice(I.length-1,1),k):{}}function l(...I){return"("+(o(I).capture?"":"?:")+I.map(P=>s(P)).join("|")+")"}const f=I=>i(/\b/,I,/\w$/.test(I)?/\b/:/\B/),m=["Protocol","Type"].map(f),u=["init","self"].map(f),_=["Any","Self"],c=["actor","any","associatedtype","async","await",/as\?/,/as!/,"as","borrowing","break","case","catch","class","consume","consuming","continue","convenience","copy","default","defer","deinit","didSet","distributed","do","dynamic","each","else","enum","extension","fallthrough",/fileprivate\(set\)/,"fileprivate","final","for","func","get","guard","if","import","indirect","infix",/init\?/,/init!/,"inout",/internal\(set\)/,"internal","in","is","isolated","nonisolated","lazy","let","macro","mutating","nonmutating",/open\(set\)/,"open","operator","optional","override","package","postfix","precedencegroup","prefix",/private\(set\)/,"private","protocol",/public\(set\)/,"public","repeat","required","rethrows","return","set","some","static","struct","subscript","super","switch","throws","throw",/try\?/,/try!/,"try","typealias",/unowned\(safe\)/,/unowned\(unsafe\)/,"unowned","var","weak","where","while","willSet"],h=["false","nil","true"],p=["assignment","associativity","higherThan","left","lowerThan","none","right"],T=["#colorLiteral","#column","#dsohandle","#else","#elseif","#endif","#error","#file","#fileID","#fileLiteral","#filePath","#function","#if","#imageLiteral","#keyPath","#line","#selector","#sourceLocation","#warning"],$=["abs","all","any","assert","assertionFailure","debugPrint","dump","fatalError","getVaList","isKnownUniquelyReferenced","max","min","numericCast","pointwiseMax","pointwiseMin","precondition","preconditionFailure","print","readLine","repeatElement","sequence","stride","swap","swift_unboxFromSwiftValueWithType","transcode","type","unsafeBitCast","unsafeDowncast","withExtendedLifetime","withUnsafeMutablePointer","withUnsafePointer","withVaList","withoutActuallyEscaping","zip"],S=l(/[/=\-+!*%<>&|^~?]/,/[\u00A1-\u00A7]/,/[\u00A9\u00AB]/,/[\u00AC\u00AE]/,/[\u00B0\u00B1]/,/[\u00B6\u00BB\u00BF\u00D7\u00F7]/,/[\u2016-\u2017]/,/[\u2020-\u2027]/,/[\u2030-\u203E]/,/[\u2041-\u2053]/,/[\u2055-\u205E]/,/[\u2190-\u23FF]/,/[\u2500-\u2775]/,/[\u2794-\u2BFF]/,/[\u2E00-\u2E7F]/,/[\u3001-\u3003]/,/[\u3008-\u3020]/,/[\u3030]/),y=l(S,/[\u0300-\u036F]/,/[\u1DC0-\u1DFF]/,/[\u20D0-\u20FF]/,/[\uFE00-\uFE0F]/,/[\uFE20-\uFE2F]/),g=i(S,y,"*"),E=l(/[a-zA-Z_]/,/[\u00A8\u00AA\u00AD\u00AF\u00B2-\u00B5\u00B7-\u00BA]/,/[\u00BC-\u00BE\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u00FF]/,/[\u0100-\u02FF\u0370-\u167F\u1681-\u180D\u180F-\u1DBF]/,/[\u1E00-\u1FFF]/,/[\u200B-\u200D\u202A-\u202E\u203F-\u2040\u2054\u2060-\u206F]/,/[\u2070-\u20CF\u2100-\u218F\u2460-\u24FF\u2776-\u2793]/,/[\u2C00-\u2DFF\u2E80-\u2FFF]/,/[\u3004-\u3007\u3021-\u302F\u3031-\u303F\u3040-\uD7FF]/,/[\uF900-\uFD3D\uFD40-\uFDCF\uFDF0-\uFE1F\uFE30-\uFE44]/,/[\uFE47-\uFEFE\uFF00-\uFFFD]/),v=l(E,/\d/,/[\u0300-\u036F\u1DC0-\u1DFF\u20D0-\u20FF\uFE20-\uFE2F]/),b=i(E,v,"*"),R=i(/[A-Z]/,v,"*"),O=["attached","autoclosure",i(/convention\(/,l("swift","block","c"),/\)/),"discardableResult","dynamicCallable","dynamicMemberLookup","escaping","freestanding","frozen","GKInspectable","IBAction","IBDesignable","IBInspectable","IBOutlet","IBSegueAction","inlinable","main","nonobjc","NSApplicationMain","NSCopying","NSManaged",i(/objc\(/,b,/\)/),"objc","objcMembers","propertyWrapper","requires_stored_property_inits","resultBuilder","Sendable","testable","UIApplicationMain","unchecked","unknown","usableFromInline","warn_unqualified_access"],w=["iOS","iOSApplicationExtension","macOS","macOSApplicationExtension","macCatalyst","macCatalystApplicationExtension","watchOS","watchOSApplicationExtension","tvOS","tvOSApplicationExtension","swift"];function L(I){const k={match:/\s+/,relevance:0},x=I.COMMENT("/\\*","\\*/",{contains:["self"]}),P=[I.C_LINE_COMMENT_MODE,x],F={match:[/\./,l(...m,...u)],className:{2:"keyword"}},X={match:i(/\./,l(...c)),relevance:0},W=c.filter(Ue=>typeof Ue=="string").concat(["_|0"]),z=c.filter(Ue=>typeof Ue!="string").concat(_).map(f),j={variants:[{className:"keyword",match:l(...z,...u)}]},J={$pattern:l(/\b\w+/,/#\w+/),keyword:W.concat(T),literal:h},M=[F,X,j],U={match:i(/\./,l(...$)),relevance:0},V={className:"built_in",match:i(/\b/,l(...$),/(?=\()/)},K=[U,V],H={match:/->/,relevance:0},ie={className:"operator",relevance:0,variants:[{match:g},{match:`\\.(\\.|${y})+`}]},Ie=[H,ie],he="([0-9]_*)+",st="([0-9a-fA-F]_*)+",B={className:"number",relevance:0,variants:[{match:`\\b(${he})(\\.(${he}))?([eE][+-]?(${he}))?\\b`},{match:`\\b0x(${st})(\\.(${st}))?([pP][+-]?(${he}))?\\b`},{match:/\b0o([0-7]_*)+\b/},{match:/\b0b([01]_*)+\b/}]},te=(Ue="")=>({className:"subst",variants:[{match:i(/\\/,Ue,/[0\\tnr"']/)},{match:i(/\\/,Ue,/u\{[0-9a-fA-F]{1,8}\}/)}]}),le=(Ue="")=>({className:"subst",match:i(/\\/,Ue,/[\t ]*(?:[\r\n]|\r\n)/)}),ae=(Ue="")=>({className:"subst",label:"interpol",begin:i(/\\/,Ue,/\(/),end:/\)/}),Me=(Ue="")=>({begin:i(Ue,/"""/),end:i(/"""/,Ue),contains:[te(Ue),le(Ue),ae(Ue)]}),Se=(Ue="")=>({begin:i(Ue,/"/),end:i(/"/,Ue),contains:[te(Ue),ae(Ue)]}),nt={className:"string",variants:[Me(),Me("#"),Me("##"),Me("###"),Se(),Se("#"),Se("##"),Se("###")]},St=[I.BACKSLASH_ESCAPE,{begin:/\[/,end:/\]/,relevance:0,contains:[I.BACKSLASH_ESCAPE]}],Ut={begin:/\/[^\s](?=[^/\n]*\/)/,end:/\//,contains:St},Jt=Ue=>{const ti=i(Ue,/\//),Yi=i(/\//,Ue);return{begin:ti,end:Yi,contains:[...St,{scope:"comment",begin:`#(?!.*${Yi})`,end:/$/}]}},We={scope:"regexp",variants:[Jt("###"),Jt("##"),Jt("#"),Ut]},Is={match:i(/`/,b,/`/)},Cs={className:"variable",match:/\$\d+/},Os={className:"variable",match:`\\$${v}+`},xs=[Is,Cs,Os],Ws={match:/(@|#(un)?)available/,scope:"keyword",starts:{contains:[{begin:/\(/,end:/\)/,keywords:w,contains:[...Ie,B,nt]}]}},At={scope:"keyword",match:i(/@/,l(...O),n(l(/\(/,/\s+/)))},be={scope:"meta",match:i(/@/,b)},qe=[Ws,At,be],ut={match:n(/\b[A-Z]/),relevance:0,contains:[{className:"type",match:i(/(AV|CA|CF|CG|CI|CL|CM|CN|CT|MK|MP|MTK|MTL|NS|SCN|SK|UI|WK|XC)/,v,"+")},{className:"type",match:R,relevance:0},{match:/[?!]+/,relevance:0},{match:/\.\.\./,relevance:0},{match:i(/\s+&\s+/,n(R)),relevance:0}]},jt={begin:/</,end:/>/,keywords:J,contains:[...P,...M,...qe,H,ut]};ut.contains.push(jt);const Ee={match:i(b,/\s*:/),keywords:"_|0",relevance:0},fi={begin:/\(/,end:/\)/,relevance:0,keywords:J,contains:["self",Ee,...P,We,...M,...K,...Ie,B,nt,...xs,...qe,ut]},fs={begin:/</,end:/>/,keywords:"repeat each",contains:[...P,ut]},ws={begin:l(n(i(b,/\s*:/)),n(i(b,/\s+/,b,/\s*:/))),end:/:/,relevance:0,contains:[{className:"keyword",match:/\b_\b/},{className:"params",match:b}]},Ot={begin:/\(/,end:/\)/,keywords:J,contains:[ws,...P,...M,...Ie,B,nt,...qe,ut,fi],endsParent:true,illegal:/["']/},xi={match:[/(func|macro)/,/\s+/,l(Is.match,b,g)],className:{1:"keyword",3:"title.function"},contains:[fs,Ot,k],illegal:[/\[/,/%/]},as={match:[/\b(?:subscript|init[?!]?)/,/\s*(?=[<(])/],className:{1:"keyword"},contains:[fs,Ot,k],illegal:/\[|%/},N={match:[/operator/,/\s+/,g],className:{1:"keyword",3:"title"}},G={begin:[/precedencegroup/,/\s+/,R],className:{1:"keyword",3:"title"},contains:[ut],keywords:[...p,...h],end:/}/},Z={match:[/class\b/,/\s+/,/func\b/,/\s+/,/\b[A-Za-z_][A-Za-z0-9_]*\b/],scope:{1:"keyword",3:"keyword",5:"title.function"}},oe={match:[/class\b/,/\s+/,/var\b/],scope:{1:"keyword",3:"keyword"}},ce={begin:[/(struct|protocol|class|extension|enum|actor)/,/\s+/,b,/\s*/],beginScope:{1:"keyword",3:"title.class"},keywords:J,contains:[fs,...M,{begin:/:/,end:/\{/,keywords:J,contains:[{scope:"title.class.inherited",match:R},...M],relevance:0}]};for(const Ue of nt.variants){const ti=Ue.contains.find(qi=>qi.label==="interpol");ti.keywords=J;const Yi=[...M,...K,...Ie,B,nt,...xs];ti.contains=[...Yi,{begin:/\(/,end:/\)/,contains:["self",...Yi]}]}return{name:"Swift",keywords:J,contains:[...P,xi,as,Z,oe,ce,N,G,{beginKeywords:"import",end:/$/,contains:[...P],relevance:0},We,...M,...K,...Ie,B,nt,...xs,...qe,ut,fi]}}return tf=L,tf}var sf,cy;function nG(){if(cy)return sf;cy=1;function s(n){const i="true false yes no null",o="[\\w#;/?:@&=+$,.~*'()[\\]]+",l={className:"attr",variants:[{begin:/[\w*@][\w*@ :()\./-]*:(?=[ \t]|$)/},{begin:/"[\w*@][\w*@ :()\./-]*":(?=[ \t]|$)/},{begin:/'[\w*@][\w*@ :()\./-]*':(?=[ \t]|$)/}]},f={className:"template-variable",variants:[{begin:/\{\{/,end:/\}\}/},{begin:/%\{/,end:/\}/}]},m={className:"string",relevance:0,begin:/'/,end:/'/,contains:[{match:/''/,scope:"char.escape",relevance:0}]},u={className:"string",relevance:0,variants:[{begin:/"/,end:/"/},{begin:/\S+/}],contains:[n.BACKSLASH_ESCAPE,f]},_=n.inherit(u,{variants:[{begin:/'/,end:/'/,contains:[{begin:/''/,relevance:0}]},{begin:/"/,end:/"/},{begin:/[^\s,{}[\]]+/}]}),$={className:"number",begin:"\\b[0-9]{4}(-[0-9][0-9]){0,2}([Tt \\t][0-9][0-9]?(:[0-9][0-9]){2})?(\\.[0-9]*)?([ \\t])*(Z|[-+][0-9][0-9]?(:[0-9][0-9])?)?\\b"},S={end:",",endsWithParent:true,excludeEnd:true,keywords:i,relevance:0},y={begin:/\{/,end:/\}/,contains:[S],illegal:"\\n",relevance:0},g={begin:"\\[",end:"\\]",contains:[S],illegal:"\\n",relevance:0},E=[l,{className:"meta",begin:"^---\\s*$",relevance:10},{className:"string",begin:"[\\|>]([1-9]?[+-])?[ ]*\\n( +)[^ ][^\\n]*\\n(\\2[^\\n]+\\n?)*"},{begin:"<%[%=-]?",end:"[%-]?%>",subLanguage:"ruby",excludeBegin:true,excludeEnd:true,relevance:0},{className:"type",begin:"!\\w+!"+o},{className:"type",begin:"!<"+o+">"},{className:"type",begin:"!"+o},{className:"type",begin:"!!"+o},{className:"meta",begin:"&"+n.UNDERSCORE_IDENT_RE+"$"},{className:"meta",begin:"\\*"+n.UNDERSCORE_IDENT_RE+"$"},{className:"bullet",begin:"-(?=[ ]|$)",relevance:0},n.HASH_COMMENT_MODE,{beginKeywords:i,keywords:{literal:i}},$,{className:"number",begin:n.C_NUMBER_RE+"\\b",relevance:0},y,g,m,u],v=[...E];return v.pop(),v.push(_),S.contains=v,{name:"YAML",case_insensitive:true,aliases:["yml"],contains:E}}return sf=s,sf}var nf,uy;function rG(){if(uy)return nf;uy=1;const s="[A-Za-z$_][0-9A-Za-z$_]*",n=["as","in","of","if","for","while","finally","var","new","function","do","return","void","else","break","catch","instanceof","with","throw","case","default","try","switch","continue","typeof","delete","let","yield","const","class","debugger","async","await","static","import","from","export","extends","using"],i=["true","false","null","undefined","NaN","Infinity"],o=["Object","Function","Boolean","Symbol","Math","Date","Number","BigInt","String","RegExp","Array","Float32Array","Float64Array","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Int32Array","Uint16Array","Uint32Array","BigInt64Array","BigUint64Array","Set","Map","WeakSet","WeakMap","ArrayBuffer","SharedArrayBuffer","Atomics","DataView","JSON","Promise","Generator","GeneratorFunction","AsyncFunction","Reflect","Proxy","Intl","WebAssembly"],l=["Error","EvalError","InternalError","RangeError","ReferenceError","SyntaxError","TypeError","URIError"],f=["setInterval","setTimeout","clearInterval","clearTimeout","require","exports","eval","isFinite","isNaN","parseFloat","parseInt","decodeURI","decodeURIComponent","encodeURI","encodeURIComponent","escape","unescape"],m=["arguments","this","super","console","window","document","localStorage","sessionStorage","module","global"],u=[].concat(f,o,l);function _(h){const p=h.regex,T=(te,{after:le})=>{const ae="</"+te[0].slice(1);return te.input.indexOf(ae,le)!==-1},$=s,S={begin:"<>",end:"</>"},y=/<[A-Za-z0-9\\._:-]+\s*\/>/,g={begin:/<[A-Za-z0-9\\._:-]+/,end:/\/[A-Za-z0-9\\._:-]+>|\/>/,isTrulyOpeningTag:(te,le)=>{const ae=te[0].length+te.index,Me=te.input[ae];if(Me==="<"||Me===","){le.ignoreMatch();return}Me===">"&&(T(te,{after:ae})||le.ignoreMatch());let Se;const nt=te.input.substring(ae);if(Se=nt.match(/^\s*=/)){le.ignoreMatch();return}if((Se=nt.match(/^\s+extends\s+/))&&Se.index===0){le.ignoreMatch();return}}},E={$pattern:s,keyword:n,literal:i,built_in:u,"variable.language":m},v="[0-9](_?[0-9])*",b=`\\.(${v})`,R="0|[1-9](_?[0-9])*|0[0-7]*[89][0-9]*",O={className:"number",variants:[{begin:`(\\b(${R})((${b})|\\.)?|(${b}))[eE][+-]?(${v})\\b`},{begin:`\\b(${R})\\b((${b})\\b|\\.)?|(${b})\\b`},{begin:"\\b(0|[1-9](_?[0-9])*)n\\b"},{begin:"\\b0[xX][0-9a-fA-F](_?[0-9a-fA-F])*n?\\b"},{begin:"\\b0[bB][0-1](_?[0-1])*n?\\b"},{begin:"\\b0[oO][0-7](_?[0-7])*n?\\b"},{begin:"\\b0[0-7]+n?\\b"}],relevance:0},w={className:"subst",begin:"\\$\\{",end:"\\}",keywords:E,contains:[]},L={begin:".?html`",end:"",starts:{end:"`",returnEnd:false,contains:[h.BACKSLASH_ESCAPE,w],subLanguage:"xml"}},I={begin:".?css`",end:"",starts:{end:"`",returnEnd:false,contains:[h.BACKSLASH_ESCAPE,w],subLanguage:"css"}},k={begin:".?gql`",end:"",starts:{end:"`",returnEnd:false,contains:[h.BACKSLASH_ESCAPE,w],subLanguage:"graphql"}},x={className:"string",begin:"`",end:"`",contains:[h.BACKSLASH_ESCAPE,w]},F={className:"comment",variants:[h.COMMENT(/\/\*\*(?!\/)/,"\\*/",{relevance:0,contains:[{begin:"(?=@[A-Za-z]+)",relevance:0,contains:[{className:"doctag",begin:"@[A-Za-z]+"},{className:"type",begin:"\\{",end:"\\}",excludeEnd:true,excludeBegin:true,relevance:0},{className:"variable",begin:$+"(?=\\s*(-)|$)",endsParent:true,relevance:0},{begin:/(?=[^\n])\s/,relevance:0}]}]}),h.C_BLOCK_COMMENT_MODE,h.C_LINE_COMMENT_MODE]},X=[h.APOS_STRING_MODE,h.QUOTE_STRING_MODE,L,I,k,x,{match:/\$\d+/},O];w.contains=X.concat({begin:/\{/,end:/\}/,keywords:E,contains:["self"].concat(X)});const W=[].concat(F,w.contains),z=W.concat([{begin:/(\s*)\(/,end:/\)/,keywords:E,contains:["self"].concat(W)}]),j={className:"params",begin:/(\s*)\(/,end:/\)/,excludeBegin:true,excludeEnd:true,keywords:E,contains:z},J={variants:[{match:[/class/,/\s+/,$,/\s+/,/extends/,/\s+/,p.concat($,"(",p.concat(/\./,$),")*")],scope:{1:"keyword",3:"title.class",5:"keyword",7:"title.class.inherited"}},{match:[/class/,/\s+/,$],scope:{1:"keyword",3:"title.class"}}]},M={relevance:0,match:p.either(/\bJSON/,/\b[A-Z][a-z]+([A-Z][a-z]*|\d)*/,/\b[A-Z]{2,}([A-Z][a-z]+|\d)+([A-Z][a-z]*)*/,/\b[A-Z]{2,}[a-z]+([A-Z][a-z]+|\d)*([A-Z][a-z]*)*/),className:"title.class",keywords:{_:[...o,...l]}},U={label:"use_strict",className:"meta",relevance:10,begin:/^\s*['"]use (strict|asm)['"]/},V={variants:[{match:[/function/,/\s+/,$,/(?=\s*\()/]},{match:[/function/,/\s*(?=\()/]}],className:{1:"keyword",3:"title.function"},label:"func.def",contains:[j],illegal:/%/},K={relevance:0,match:/\b[A-Z][A-Z_0-9]+\b/,className:"variable.constant"};function H(te){return p.concat("(?!",te.join("|"),")")}const ie={match:p.concat(/\b/,H([...f,"super","import"].map(te=>`${te}\\s*\\(`)),$,p.lookahead(/\s*\(/)),className:"title.function",relevance:0},Ie={begin:p.concat(/\./,p.lookahead(p.concat($,/(?![0-9A-Za-z$_(])/))),end:$,excludeBegin:true,keywords:"prototype",className:"property",relevance:0},he={match:[/get|set/,/\s+/,$,/(?=\()/],className:{1:"keyword",3:"title.function"},contains:[{begin:/\(\)/},j]},st="(\\([^()]*(\\([^()]*(\\([^()]*\\)[^()]*)*\\)[^()]*)*\\)|"+h.UNDERSCORE_IDENT_RE+")\\s*=>",B={match:[/const|var|let/,/\s+/,$,/\s*/,/=\s*/,/(async\s*)?/,p.lookahead(st)],keywords:"async",className:{1:"keyword",3:"title.function"},contains:[j]};return{name:"JavaScript",aliases:["js","jsx","mjs","cjs"],keywords:E,exports:{PARAMS_CONTAINS:z,CLASS_REFERENCE:M},illegal:/#(?![$_A-z])/,contains:[h.SHEBANG({label:"shebang",binary:"node",relevance:5}),U,h.APOS_STRING_MODE,h.QUOTE_STRING_MODE,L,I,k,x,F,{match:/\$\d+/},O,M,{scope:"attr",match:$+p.lookahead(":"),relevance:0},B,{begin:"("+h.RE_STARTERS_RE+"|\\b(case|return|throw)\\b)\\s*",keywords:"return throw case",relevance:0,contains:[F,h.REGEXP_MODE,{className:"function",begin:st,returnBegin:true,end:"\\s*=>",contains:[{className:"params",variants:[{begin:h.UNDERSCORE_IDENT_RE,relevance:0},{className:null,begin:/\(\s*\)/,skip:true},{begin:/(\s*)\(/,end:/\)/,excludeBegin:true,excludeEnd:true,keywords:E,contains:z}]}]},{begin:/,/,relevance:0},{match:/\s+/,relevance:0},{variants:[{begin:S.begin,end:S.end},{match:y},{begin:g.begin,"on:begin":g.isTrulyOpeningTag,end:g.end}],subLanguage:"xml",contains:[{begin:g.begin,end:g.end,skip:true,contains:["self"]}]}]},V,{beginKeywords:"while if switch catch for"},{begin:"\\b(?!function)"+h.UNDERSCORE_IDENT_RE+"\\([^()]*(\\([^()]*(\\([^()]*\\)[^()]*)*\\)[^()]*)*\\)\\s*\\{",returnBegin:true,label:"func.def",contains:[j,h.inherit(h.TITLE_MODE,{begin:$,className:"title.function"})]},{match:/\.\.\./,relevance:0},Ie,{match:"\\$"+$,relevance:0},{match:[/\bconstructor(?=\s*\()/],className:{1:"title.function"},contains:[j]},ie,K,J,he,{match:/\$[(.]/}]}}function c(h){const p=h.regex,T=_(h),$=s,S=["any","void","number","boolean","string","object","never","symbol","bigint","unknown"],y={begin:[/namespace/,/\s+/,h.IDENT_RE],beginScope:{1:"keyword",3:"title.class"}},g={beginKeywords:"interface",end:/\{/,excludeEnd:true,keywords:{keyword:"interface extends",built_in:S},contains:[T.exports.CLASS_REFERENCE]},E={className:"meta",relevance:10,begin:/^\s*['"]use strict['"]/},v=["type","interface","public","private","protected","implements","declare","abstract","readonly","enum","override","satisfies"],b={$pattern:s,keyword:n.concat(v),literal:i,built_in:u.concat(S),"variable.language":m},R={className:"meta",begin:"@"+$},O=(k,x,P)=>{const F=k.contains.findIndex(X=>X.label===x);if(F===-1)throw new Error("can not find mode to replace");k.contains.splice(F,1,P)};Object.assign(T.keywords,b),T.exports.PARAMS_CONTAINS.push(R);const w=T.contains.find(k=>k.scope==="attr"),L=Object.assign({},w,{match:p.concat($,p.lookahead(/\s*\?:/))});T.exports.PARAMS_CONTAINS.push([T.exports.CLASS_REFERENCE,w,L]),T.contains=T.contains.concat([R,y,g,L]),O(T,"shebang",h.SHEBANG()),O(T,"use_strict",E);const I=T.contains.find(k=>k.label==="func.def");return I.relevance=0,Object.assign(T,{name:"TypeScript",aliases:["ts","tsx","mts","cts"]}),T}return nf=c,nf}var rf,hy;function oG(){if(hy)return rf;hy=1;function s(n){const i=n.regex,o={className:"string",begin:/"(""|[^/n])"C\b/},l={className:"string",begin:/"/,end:/"/,illegal:/\n/,contains:[{begin:/""/}]},f=/\d{1,2}\/\d{1,2}\/\d{4}/,m=/\d{4}-\d{1,2}-\d{1,2}/,u=/(\d|1[012])(:\d+){0,2} *(AM|PM)/,_=/\d{1,2}(:\d{1,2}){1,2}/,c={className:"literal",variants:[{begin:i.concat(/# */,i.either(m,f),/ *#/)},{begin:i.concat(/# */,_,/ *#/)},{begin:i.concat(/# */,u,/ *#/)},{begin:i.concat(/# */,i.either(m,f),/ +/,i.either(u,_),/ *#/)}]},h={className:"number",relevance:0,variants:[{begin:/\b\d[\d_]*((\.[\d_]+(E[+-]?[\d_]+)?)|(E[+-]?[\d_]+))[RFD@!#]?/},{begin:/\b\d[\d_]*((U?[SIL])|[%&])?/},{begin:/&H[\dA-F_]+((U?[SIL])|[%&])?/},{begin:/&O[0-7_]+((U?[SIL])|[%&])?/},{begin:/&B[01_]+((U?[SIL])|[%&])?/}]},p={className:"label",begin:/^\w+:/},T=n.COMMENT(/'''/,/$/,{contains:[{className:"doctag",begin:/<\/?/,end:/>/}]}),$=n.COMMENT(null,/$/,{variants:[{begin:/'/},{begin:/([\t ]|^)REM(?=\s)/}]});return{name:"Visual Basic .NET",aliases:["vb"],case_insensitive:true,classNameAliases:{label:"symbol"},keywords:{keyword:"addhandler alias aggregate ansi as async assembly auto binary by byref byval call case catch class compare const continue custom declare default delegate dim distinct do each equals else elseif end enum erase error event exit explicit finally for friend from function get global goto group handles if implements imports in inherits interface into iterator join key let lib loop me mid module mustinherit mustoverride mybase myclass namespace narrowing new next notinheritable notoverridable of off on operator option optional order overloads overridable overrides paramarray partial preserve private property protected public raiseevent readonly redim removehandler resume return select set shadows shared skip static step stop structure strict sub synclock take text then throw to try unicode until using when where while widening with withevents writeonly yield",built_in:"addressof and andalso await directcast gettype getxmlnamespace is isfalse isnot istrue like mod nameof new not or orelse trycast typeof xor cbool cbyte cchar cdate cdbl cdec cint clng cobj csbyte cshort csng cstr cuint culng cushort",type:"boolean byte char date decimal double integer long object sbyte short single string uinteger ulong ushort",literal:"true false nothing"},illegal:"//|\\{|\\}|endif|gosub|variant|wend|^\\$ ",contains:[o,l,c,h,p,T,$,{className:"meta",begin:/[\t ]*#(const|disable|else|elseif|enable|end|externalsource|if|region)\b/,end:/$/,keywords:{keyword:"const disable else elseif enable end externalsource if region then"},contains:[$]}]}}return rf=s,rf}var of,dy;function aG(){if(dy)return of;dy=1;function s(n){n.regex;const i=n.COMMENT(/\(;/,/;\)/);i.contains.push("self");const o=n.COMMENT(/;;/,/$/),l=["anyfunc","block","br","br_if","br_table","call","call_indirect","data","drop","elem","else","end","export","func","global.get","global.set","local.get","local.set","local.tee","get_global","get_local","global","if","import","local","loop","memory","memory.grow","memory.size","module","mut","nop","offset","param","result","return","select","set_global","set_local","start","table","tee_local","then","type","unreachable"],f={begin:[/(?:func|call|call_indirect)/,/\s+/,/\$[^\s)]+/],className:{1:"keyword",3:"title.function"}},m={className:"variable",begin:/\$[\w_]+/},u={match:/(\((?!;)|\))+/,className:"punctuation",relevance:0},_={className:"number",relevance:0,match:/[+-]?\b(?:\d(?:_?\d)*(?:\.\d(?:_?\d)*)?(?:[eE][+-]?\d(?:_?\d)*)?|0x[\da-fA-F](?:_?[\da-fA-F])*(?:\.[\da-fA-F](?:_?[\da-fA-D])*)?(?:[pP][+-]?\d(?:_?\d)*)?)\b|\binf\b|\bnan(?::0x[\da-fA-F](?:_?[\da-fA-D])*)?\b/},c={match:/(i32|i64|f32|f64)(?!\.)/,className:"type"},h={className:"keyword",match:/\b(f32|f64|i32|i64)(?:\.(?:abs|add|and|ceil|clz|const|convert_[su]\/i(?:32|64)|copysign|ctz|demote\/f64|div(?:_[su])?|eqz?|extend_[su]\/i32|floor|ge(?:_[su])?|gt(?:_[su])?|le(?:_[su])?|load(?:(?:8|16|32)_[su])?|lt(?:_[su])?|max|min|mul|nearest|neg?|or|popcnt|promote\/f32|reinterpret\/[fi](?:32|64)|rem_[su]|rot[lr]|shl|shr_[su]|store(?:8|16|32)?|sqrt|sub|trunc(?:_[su]\/f(?:32|64))?|wrap\/i64|xor))\b/};return{name:"WebAssembly",keywords:{$pattern:/[\w.]+/,keyword:l},contains:[o,i,{match:[/(?:offset|align)/,/\s*/,/=/],className:{1:"keyword",3:"operator"}},m,u,f,n.QUOTE_STRING_MODE,c,h,_]}}return of=s,of}var af,_y;function lG(){if(_y)return af;_y=1;var s=vI();return s.registerLanguage("xml",IF()),s.registerLanguage("bash",CF()),s.registerLanguage("c",OF()),s.registerLanguage("cpp",wF()),s.registerLanguage("csharp",kF()),s.registerLanguage("css",AF()),s.registerLanguage("markdown",LF()),s.registerLanguage("diff",NF()),s.registerLanguage("ruby",MF()),s.registerLanguage("go",DF()),s.registerLanguage("graphql",xF()),s.registerLanguage("ini",BF()),s.registerLanguage("java",PF()),s.registerLanguage("javascript",UF()),s.registerLanguage("json",FF()),s.registerLanguage("kotlin",GF()),s.registerLanguage("less",HF()),s.registerLanguage("lua",VF()),s.registerLanguage("makefile",WF()),s.registerLanguage("perl",zF()),s.registerLanguage("objectivec",jF()),s.registerLanguage("php",XF()),s.registerLanguage("php-template",KF()),s.registerLanguage("plaintext",YF()),s.registerLanguage("python",qF()),s.registerLanguage("python-repl",JF()),s.registerLanguage("r",ZF()),s.registerLanguage("rust",QF()),s.registerLanguage("scss",eG()),s.registerLanguage("shell",tG()),s.registerLanguage("sql",sG()),s.registerLanguage("swift",iG()),s.registerLanguage("yaml",nG()),s.registerLanguage("typescript",rG()),s.registerLanguage("vbnet",oG()),s.registerLanguage("wasm",aG()),s.HighlightJS=s,s.default=s,af=s,af}var cG=lG();const uG=rm(cG),py="[A-Za-z$_][0-9A-Za-z$_]*",hG=["as","in","of","if","for","while","finally","var","new","function","do","return","void","else","break","catch","instanceof","with","throw","case","default","try","switch","continue","typeof","delete","let","yield","const","class","debugger","async","await","static","import","from","export","extends","using"],dG=["true","false","null","undefined","NaN","Infinity"],bI=["Object","Function","Boolean","Symbol","Math","Date","Number","BigInt","String","RegExp","Array","Float32Array","Float64Array","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Int32Array","Uint16Array","Uint32Array","BigInt64Array","BigUint64Array","Set","Map","WeakSet","WeakMap","ArrayBuffer","SharedArrayBuffer","Atomics","DataView","JSON","Promise","Generator","GeneratorFunction","AsyncFunction","Reflect","Proxy","Intl","WebAssembly"],TI=["Error","EvalError","InternalError","RangeError","ReferenceError","SyntaxError","TypeError","URIError"],SI=["setInterval","setTimeout","clearInterval","clearTimeout","require","exports","eval","isFinite","isNaN","parseFloat","parseInt","decodeURI","decodeURIComponent","encodeURI","encodeURIComponent","escape","unescape"],_G=["arguments","this","super","console","window","document","localStorage","sessionStorage","module","global"],pG=[].concat(SI,bI,TI);function gG(s){const n=s.regex,i=(M,{after:U})=>{const V="</"+M[0].slice(1);return M.input.indexOf(V,U)!==-1},o=py,l={begin:"<>",end:"</>"},f=/<[A-Za-z0-9\\._:-]+\s*\/>/,m={begin:/<[A-Za-z0-9\\._:-]+/,end:/\/[A-Za-z0-9\\._:-]+>|\/>/,isTrulyOpeningTag:(M,U)=>{const V=M[0].length+M.index,K=M.input[V];if(K==="<"||K===","){U.ignoreMatch();return}K===">"&&(i(M,{after:V})||U.ignoreMatch());let H;const ie=M.input.substring(V);if(H=ie.match(/^\s*=/)){U.ignoreMatch();return}if((H=ie.match(/^\s+extends\s+/))&&H.index===0){U.ignoreMatch();return}}},u={$pattern:py,keyword:hG,literal:dG,built_in:pG,"variable.language":_G},_="[0-9](_?[0-9])*",c=`\\.(${_})`,h="0|[1-9](_?[0-9])*|0[0-7]*[89][0-9]*",p={className:"number",variants:[{begin:`(\\b(${h})((${c})|\\.)?|(${c}))[eE][+-]?(${_})\\b`},{begin:`\\b(${h})\\b((${c})\\b|\\.)?|(${c})\\b`},{begin:"\\b(0|[1-9](_?[0-9])*)n\\b"},{begin:"\\b0[xX][0-9a-fA-F](_?[0-9a-fA-F])*n?\\b"},{begin:"\\b0[bB][0-1](_?[0-1])*n?\\b"},{begin:"\\b0[oO][0-7](_?[0-7])*n?\\b"},{begin:"\\b0[0-7]+n?\\b"}],relevance:0},T={className:"subst",begin:"\\$\\{",end:"\\}",keywords:u,contains:[]},$={begin:".?html`",end:"",starts:{end:"`",returnEnd:false,contains:[s.BACKSLASH_ESCAPE,T],subLanguage:"xml"}},S={begin:".?css`",end:"",starts:{end:"`",returnEnd:false,contains:[s.BACKSLASH_ESCAPE,T],subLanguage:"css"}},y={begin:".?gql`",end:"",starts:{end:"`",returnEnd:false,contains:[s.BACKSLASH_ESCAPE,T],subLanguage:"graphql"}},g={className:"string",begin:"`",end:"`",contains:[s.BACKSLASH_ESCAPE,T]},v={className:"comment",variants:[s.COMMENT(/\/\*\*(?!\/)/,"\\*/",{relevance:0,contains:[{begin:"(?=@[A-Za-z]+)",relevance:0,contains:[{className:"doctag",begin:"@[A-Za-z]+"},{className:"type",begin:"\\{",end:"\\}",excludeEnd:true,excludeBegin:true,relevance:0},{className:"variable",begin:o+"(?=\\s*(-)|$)",endsParent:true,relevance:0},{begin:/(?=[^\n])\s/,relevance:0}]}]}),s.C_BLOCK_COMMENT_MODE,s.C_LINE_COMMENT_MODE]},b=[s.APOS_STRING_MODE,s.QUOTE_STRING_MODE,$,S,y,g,{match:/\$\d+/},p];T.contains=b.concat({begin:/\{/,end:/\}/,keywords:u,contains:["self"].concat(b)});const R=[].concat(v,T.contains),O=R.concat([{begin:/(\s*)\(/,end:/\)/,keywords:u,contains:["self"].concat(R)}]),w={className:"params",begin:/(\s*)\(/,end:/\)/,excludeBegin:true,excludeEnd:true,keywords:u,contains:O},L={variants:[{match:[/class/,/\s+/,o,/\s+/,/extends/,/\s+/,n.concat(o,"(",n.concat(/\./,o),")*")],scope:{1:"keyword",3:"title.class",5:"keyword",7:"title.class.inherited"}},{match:[/class/,/\s+/,o],scope:{1:"keyword",3:"title.class"}}]},I={relevance:0,match:n.either(/\bJSON/,/\b[A-Z][a-z]+([A-Z][a-z]*|\d)*/,/\b[A-Z]{2,}([A-Z][a-z]+|\d)+([A-Z][a-z]*)*/,/\b[A-Z]{2,}[a-z]+([A-Z][a-z]+|\d)*([A-Z][a-z]*)*/),className:"title.class",keywords:{_:[...bI,...TI]}},k={label:"use_strict",className:"meta",relevance:10,begin:/^\s*['"]use (strict|asm)['"]/},x={variants:[{match:[/function/,/\s+/,o,/(?=\s*\()/]},{match:[/function/,/\s*(?=\()/]}],className:{1:"keyword",3:"title.function"},label:"func.def",contains:[w],illegal:/%/},P={relevance:0,match:/\b[A-Z][A-Z_0-9]+\b/,className:"variable.constant"};function F(M){return n.concat("(?!",M.join("|"),")")}const X={match:n.concat(/\b/,F([...SI,"super","import"].map(M=>`${M}\\s*\\(`)),o,n.lookahead(/\s*\(/)),className:"title.function",relevance:0},W={begin:n.concat(/\./,n.lookahead(n.concat(o,/(?![0-9A-Za-z$_(])/))),end:o,excludeBegin:true,keywords:"prototype",className:"property",relevance:0},z={match:[/get|set/,/\s+/,o,/(?=\()/],className:{1:"keyword",3:"title.function"},contains:[{begin:/\(\)/},w]},j="(\\([^()]*(\\([^()]*(\\([^()]*\\)[^()]*)*\\)[^()]*)*\\)|"+s.UNDERSCORE_IDENT_RE+")\\s*=>",J={match:[/const|var|let/,/\s+/,o,/\s*/,/=\s*/,/(async\s*)?/,n.lookahead(j)],keywords:"async",className:{1:"keyword",3:"title.function"},contains:[w]};return{name:"JavaScript",aliases:["js","jsx","mjs","cjs"],keywords:u,exports:{PARAMS_CONTAINS:O,CLASS_REFERENCE:I},illegal:/#(?![$_A-z])/,contains:[s.SHEBANG({label:"shebang",binary:"node",relevance:5}),k,s.APOS_STRING_MODE,s.QUOTE_STRING_MODE,$,S,y,g,v,{match:/\$\d+/},p,I,{scope:"attr",match:o+n.lookahead(":"),relevance:0},J,{begin:"("+s.RE_STARTERS_RE+"|\\b(case|return|throw)\\b)\\s*",keywords:"return throw case",relevance:0,contains:[v,s.REGEXP_MODE,{className:"function",begin:j,returnBegin:true,end:"\\s*=>",contains:[{className:"params",variants:[{begin:s.UNDERSCORE_IDENT_RE,relevance:0},{className:null,begin:/\(\s*\)/,skip:true},{begin:/(\s*)\(/,end:/\)/,excludeBegin:true,excludeEnd:true,keywords:u,contains:O}]}]},{begin:/,/,relevance:0},{match:/\s+/,relevance:0},{variants:[{begin:l.begin,end:l.end},{match:f},{begin:m.begin,"on:begin":m.isTrulyOpeningTag,end:m.end}],subLanguage:"xml",contains:[{begin:m.begin,end:m.end,skip:true,contains:["self"]}]}]},x,{beginKeywords:"while if switch catch for"},{begin:"\\b(?!function)"+s.UNDERSCORE_IDENT_RE+"\\([^()]*(\\([^()]*(\\([^()]*\\)[^()]*)*\\)[^()]*)*\\)\\s*\\{",returnBegin:true,label:"func.def",contains:[w,s.inherit(s.TITLE_MODE,{begin:o,className:"title.function"})]},{match:/\.\.\./,relevance:0},W,{match:"\\$"+o,relevance:0},{match:[/\bconstructor(?=\s*\()/],className:{1:"title.function"},contains:[w]},X,P,L,z,{match:/\$[(.]/}]}}var fG=vI();const lf=rm(fG);var mG=Ke({props:{code:{type:String,required:true},language:{type:String,default:""},autodetect:{type:Boolean,default:true},ignoreIllegals:{type:Boolean,default:true}},setup:function(s){var n=me(s.language);kt(function(){return s.language},function(l){n.value=l});var i=_e(function(){return s.autodetect||!n.value}),o=_e(function(){return!i.value&&!lf.getLanguage(n.value)});return{className:_e(function(){return o.value?"":"hljs "+n.value}),highlightedCode:_e(function(){var l;if(o.value)return console.warn('The language "'+n.value+'" you specified could not be found.'),s.code.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;");if(i.value){var f=lf.highlightAuto(s.code);return n.value=(l=f.language)!==null&&l!==void 0?l:"",f.value}return(f=lf.highlight(s.code,{language:n.value,ignoreIllegals:s.ignoreIllegals})).value})}},render:function(){return Wu("pre",{},[Wu("code",{class:this.className,innerHTML:this.highlightedCode,tabindex:"0"})])}}),EG={component:mG};const vG=Ke({__name:"code",props:["blocklyInformation","current"],setup(s){uG.registerLanguage("javascript",gG);const n=EG.component;return(i,o)=>s.blocklyInformation.code?(ne(),Ye(ue(n),{key:0,code:s.blocklyInformation.code,lang:"javascript"},null,8,["code"])):Ze("v-if",true)}}),bG={},TG={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"};function SG(s,n){return ne(),ve("svg",TG,[Ze("! Font Awesome Pro 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. "),n[0]||(n[0]=de("path",{d:"M7.724 65.49C13.36 55.11 21.79 46.47 32 40.56C39.63 36.15 48.25 33.26 57.46 32.33C59.61 32.11 61.79 32 64 32H448C483.3 32 512 60.65 512 96V416C512 451.3 483.3 480 448 480H64C28.65 480 0 451.3 0 416V96C0 93.79 .112 91.61 .3306 89.46C1.204 80.85 3.784 72.75 7.724 65.49V65.49zM48 416C48 424.8 55.16 432 64 432H448C456.8 432 464 424.8 464 416V224H48V416z"},null,-1))])}const $G=rr(bG,[["render",SG]]),Ls=[];for(let s=0;s<256;++s)Ls.push((s+256).toString(16).slice(1));function yG(s,n=0){return(Ls[s[n+0]]+Ls[s[n+1]]+Ls[s[n+2]]+Ls[s[n+3]]+"-"+Ls[s[n+4]]+Ls[s[n+5]]+"-"+Ls[s[n+6]]+Ls[s[n+7]]+"-"+Ls[s[n+8]]+Ls[s[n+9]]+"-"+Ls[s[n+10]]+Ls[s[n+11]]+Ls[s[n+12]]+Ls[s[n+13]]+Ls[s[n+14]]+Ls[s[n+15]]).toLowerCase()}let cf;const RG=new Uint8Array(16);function IG(){if(!cf){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");cf=crypto.getRandomValues.bind(crypto)}return cf(RG)}const CG=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),gy={randomUUID:CG};function tr(s,n,i){var l;if(gy.randomUUID&&!s)return gy.randomUUID();s=s||{};const o=s.random??((l=s.rng)==null?void 0:l.call(s))??IG();if(o.length<16)throw new Error("Random bytes length must be >= 16");return o[6]=o[6]&15|64,o[8]=o[8]&63|128,yG(o)}class go{constructor(){this.listenerMap=new Map,this._listeners=[],this.proxyMap=new Map,this.proxies=[]}get listeners(){return this._listeners.concat(this.proxies.flatMap(n=>n()))}subscribe(n,i){this.listenerMap.has(n)&&(console.warn(`Already subscribed. Unsubscribing for you.
Please check that you don't accidentally use the same token twice to register two different handlers for the same event/hook.`),this.unsubscribe(n)),this.listenerMap.set(n,i),this._listeners.push(i)}unsubscribe(n){if(this.listenerMap.has(n)){const i=this.listenerMap.get(n);this.listenerMap.delete(n);const o=this._listeners.indexOf(i);o>=0&&this._listeners.splice(o,1)}}registerProxy(n,i){this.proxyMap.has(n)&&(console.warn(`Already subscribed. Unsubscribing for you.
Please check that you don't accidentally use the same token twice to register two different proxies for the same event/hook.`),this.unregisterProxy(n)),this.proxyMap.set(n,i),this.proxies.push(i)}unregisterProxy(n){if(!this.proxyMap.has(n))return;const i=this.proxyMap.get(n);this.proxyMap.delete(n);const o=this.proxies.indexOf(i);o>=0&&this.proxies.splice(o,1)}}class qt extends go{constructor(n){super(),this.entity=n}emit(n){this.listeners.forEach(i=>i(n,this.entity))}}class Js extends go{constructor(n){super(),this.entity=n}emit(n){let i=false;const o=()=>[i=true];for(const l of Array.from(this.listeners.values()))if(l(n,o,this.entity),i)return{prevented:true};return{prevented:false}}}class OG extends go{execute(n,i){let o=n;for(const l of this.listeners)o=l(o,i);return o}}class Xi extends OG{constructor(n){super(),this.entity=n}execute(n){return super.execute(n,this.entity)}}class wG extends go{constructor(n){super(),this.entity=n}execute(n){const i=[];for(const o of this.listeners)i.push(o(n,this.entity));return i}}function kn(){const s=Symbol(),n=new Map,i=new Set,o=(_,c)=>{c instanceof go&&c.registerProxy(s,()=>{var h,p;return(p=(h=n.get(_))===null||h===void 0?void 0:h.listeners)!==null&&p!==void 0?p:[]})},l=_=>{const c=new go;n.set(_,c),i.forEach(h=>o(_,h[_]))},f=_=>{i.add(_);for(const c of n.keys())o(c,_[c])},m=_=>{for(const c of n.keys())_[c]instanceof go&&_[c].unregisterProxy(s);i.delete(_)},u=()=>{i.forEach(_=>m(_)),n.clear()};return new Proxy({},{get(_,c){return c==="addTarget"?f:c==="removeTarget"?m:c==="destroy"?u:typeof c!="string"||c.startsWith("_")?_[c]:(n.has(c)||l(c),n.get(c))}})}class fy{constructor(n,i){if(this.destructed=false,this.events={destruct:new qt(this)},!n||!i)throw new Error("Cannot initialize connection with null/undefined for 'from' or 'to' values");this.id=tr(),this.from=n,this.to=i,this.from.connectionCount++,this.to.connectionCount++}destruct(){this.events.destruct.emit(),this.from.connectionCount--,this.to.connectionCount--,this.destructed=true}}class kG{constructor(n,i){if(!n||!i)throw new Error("Cannot initialize connection with null/undefined for 'from' or 'to' values");this.id=tr(),this.from=n,this.to=i}}function xf(s,n){return Object.fromEntries(Object.entries(s).map(([i,o])=>[i,n(o)]))}class $I{constructor(){this._title="",this.id=tr(),this.events={loaded:new qt(this),beforeAddInput:new Js(this),addInput:new qt(this),beforeRemoveInput:new Js(this),removeInput:new qt(this),beforeAddOutput:new Js(this),addOutput:new qt(this),beforeRemoveOutput:new Js(this),removeOutput:new qt(this),beforeTitleChanged:new Js(this),titleChanged:new qt(this),update:new qt(this)},this.hooks={beforeLoad:new Xi(this),afterSave:new Xi(this)}}get graph(){return this.graphInstance}get title(){return this._title}set title(n){this.events.beforeTitleChanged.emit(n).prevented||(this._title=n,this.events.titleChanged.emit(n))}addInput(n,i){return this.addInterface("input",n,i)}addOutput(n,i){return this.addInterface("output",n,i)}removeInput(n){return this.removeInterface("input",n)}removeOutput(n){return this.removeInterface("output",n)}registerGraph(n){this.graphInstance=n}load(n){this.hooks.beforeLoad.execute(n),this.id=n.id,this._title=n.title,Object.entries(n.inputs).forEach(([i,o])=>{this.inputs[i]&&(this.inputs[i].load(o),this.inputs[i].nodeId=this.id)}),Object.entries(n.outputs).forEach(([i,o])=>{this.outputs[i]&&(this.outputs[i].load(o),this.outputs[i].nodeId=this.id)}),this.events.loaded.emit(this)}save(){const n=xf(this.inputs,l=>l.save()),i=xf(this.outputs,l=>l.save()),o={type:this.type,id:this.id,title:this.title,inputs:n,outputs:i};return this.hooks.afterSave.execute(o)}onPlaced(){}onDestroy(){}initializeIo(){Object.entries(this.inputs).forEach(([n,i])=>this.initializeIntf("input",n,i)),Object.entries(this.outputs).forEach(([n,i])=>this.initializeIntf("output",n,i))}initializeIntf(n,i,o){o.isInput=n==="input",o.nodeId=this.id,o.events.setValue.subscribe(this,()=>this.events.update.emit({type:n,name:i,intf:o}))}addInterface(n,i,o){const l=n==="input"?this.events.beforeAddInput:this.events.beforeAddOutput,f=n==="input"?this.events.addInput:this.events.addOutput,m=n==="input"?this.inputs:this.outputs;return l.emit(o).prevented?false:(m[i]=o,this.initializeIntf(n,i,o),f.emit(o),true)}removeInterface(n,i){const o=n==="input"?this.events.beforeRemoveInput:this.events.beforeRemoveOutput,l=n==="input"?this.events.removeInput:this.events.removeOutput,f=n==="input"?this.inputs[i]:this.outputs[i];if(!f||o.emit(f).prevented)return false;if(f.connectionCount>0)if(this.graphInstance)this.graphInstance.connections.filter(u=>u.from===f||u.to===f).forEach(u=>{this.graphInstance.removeConnection(u)});else throw new Error("Interface is connected, but no graph instance is specified. Unable to delete interface");return f.events.setValue.unsubscribe(this),n==="input"?delete this.inputs[i]:delete this.outputs[i],l.emit(f),true}}let bm=class extends $I{load(n){super.load(n)}save(){return super.save()}};function Mn(s){return class extends bm{constructor(){var n,i;super(),this.type=s.type,this.inputs={},this.outputs={},this.calculate=s.calculate?(o,l)=>s.calculate.call(this,o,l):void 0,this._title=(n=s.title)!==null&&n!==void 0?n:s.type,this.executeFactory("input",s.inputs),this.executeFactory("output",s.outputs),(i=s.onCreate)===null||i===void 0||i.call(this)}onPlaced(){var n;(n=s.onPlaced)===null||n===void 0||n.call(this)}onDestroy(){var n;(n=s.onDestroy)===null||n===void 0||n.call(this)}executeFactory(n,i){Object.keys(i||{}).forEach(o=>{const l=i[o]();n==="input"?this.addInput(o,l):this.addOutput(o,l)})}}}class AG extends bm{}function Tm(s){return class extends AG{constructor(){var n,i,o,l;super(),this.type=s.type,this.inputs={},this.outputs={},this.preventUpdate=false,this.staticInputKeys=Object.keys((n=s.inputs)!==null&&n!==void 0?n:{}),this.staticOutputKeys=Object.keys((i=s.outputs)!==null&&i!==void 0?i:{}),this._title=(o=s.title)!==null&&o!==void 0?o:s.type,this.executeFactory("input",s.inputs),this.executeFactory("output",s.outputs),s.calculate&&(this.calculate=(f,m)=>{var u;return(u=s.calculate)===null||u===void 0?void 0:u.call(this,f,m)}),(l=s.onCreate)===null||l===void 0||l.call(this)}onPlaced(){var n;this.events.update.subscribe(this,i=>{i&&(i.type==="input"&&this.staticInputKeys.includes(i.name)||i.type==="output"&&this.staticOutputKeys.includes(i.name))&&this.onUpdate()}),this.onUpdate(),(n=s.onPlaced)===null||n===void 0||n.call(this)}onDestroy(){var n;(n=s.onDestroy)===null||n===void 0||n.call(this)}load(n){this.preventUpdate=true,this.hooks.beforeLoad.execute(n),this.id=n.id,this.title=n.title;for(const i of this.staticInputKeys)this.inputs[i].load(n.inputs[i]),this.inputs[i].nodeId=this.id;for(const i of this.staticOutputKeys)this.outputs[i].load(n.outputs[i]),this.outputs[i].nodeId=this.id;this.preventUpdate=false,this.onUpdate(),this.preventUpdate=true;for(const i of Object.keys(n.inputs))this.staticInputKeys.includes(i)||(this.inputs[i].load(n.inputs[i]),this.inputs[i].nodeId=this.id);for(const i of Object.keys(n.outputs))this.staticOutputKeys.includes(i)||(this.outputs[i].load(n.outputs[i]),this.outputs[i].nodeId=this.id);this.preventUpdate=false,this.events.loaded.emit(this)}onUpdate(){var n,i,o,l;if(this.preventUpdate)return;this.graph&&this.graph.activeTransactions++;const f=this.getStaticValues(this.staticInputKeys,this.inputs),m=this.getStaticValues(this.staticOutputKeys,this.outputs),u=s.onUpdate.call(this,f,m);this.updateInterfaces("input",(n=u.inputs)!==null&&n!==void 0?n:{},(i=u.forceUpdateInputs)!==null&&i!==void 0?i:[]),this.updateInterfaces("output",(o=u.outputs)!==null&&o!==void 0?o:{},(l=u.forceUpdateOutputs)!==null&&l!==void 0?l:[]),this.graph&&this.graph.activeTransactions--}getStaticValues(n,i){const o={};for(const l of n)o[l]=i[l].value;return o}updateInterfaces(n,i,o){const l=n==="input"?this.staticInputKeys:this.staticOutputKeys,f=n==="input"?this.inputs:this.outputs;for(const m of Object.keys(f))l.includes(m)||i[m]&&!o.includes(m)||(n==="input"?this.removeInput(m):this.removeOutput(m));for(const m of Object.keys(i)){if(f[m])continue;const u=i[m]();n==="input"?this.addInput(m,u):this.addOutput(m,u)}}executeFactory(n,i){Object.keys(i||{}).forEach(o=>{const l=i[o]();n==="input"?this.addInput(o,l):this.addOutput(o,l)})}}}class _t{set connectionCount(n){this._connectionCount=n,this.events.setConnectionCount.emit(n)}get connectionCount(){return this._connectionCount}set value(n){this.events.beforeSetValue.emit(n).prevented||(this._value=n,this.events.setValue.emit(n))}get value(){return this._value}constructor(n,i){this.id=tr(),this.nodeId="",this.port=true,this.hidden=false,this.events={setConnectionCount:new qt(this),beforeSetValue:new Js(this),setValue:new qt(this),updated:new qt(this)},this.hooks={load:new Xi(this),save:new Xi(this)},this._connectionCount=0,this.name=n,this._value=i}load(n){this.id=n.id,this.templateId=n.templateId,this.value=n.value,this.hooks.load.execute(n)}save(){const n={id:this.id,templateId:this.templateId,value:this.value};return this.hooks.save.execute(n)}setComponent(n){return this.component=n,this}setPort(n){return this.port=n,this}setHidden(n){return this.hidden=n,this}use(n,...i){return n(this,...i),this}}const Ea="__baklava_SubgraphInputNode",va="__baklava_SubgraphOutputNode";class yI extends bm{constructor(){super(),this.graphInterfaceId=tr()}onPlaced(){super.onPlaced(),this.initializeIo()}save(){return{...super.save(),graphInterfaceId:this.graphInterfaceId}}load(n){super.load(n),this.graphInterfaceId=n.graphInterfaceId}}class Sm extends yI{constructor(){super(...arguments),this.type=Ea,this.inputs={name:new _t("Name","Input")},this.outputs={placeholder:new _t("Value",void 0)}}static isGraphInputNode(n){return n.type===Ea}}class $m extends yI{constructor(){super(...arguments),this.type=va,this.inputs={name:new _t("Name","Output"),placeholder:new _t("Value",void 0)},this.outputs={output:new _t("Output",void 0).setHidden(true)},this.calculate=({placeholder:n})=>({output:n})}static isGraphOutputNode(n){return n.type===va}}class yh{get nodes(){return this._nodes}get connections(){return this._connections}get loading(){return this._loading}get destroying(){return this._destroying}get inputs(){return this.nodes.filter(i=>i.type===Ea).map(i=>({id:i.graphInterfaceId,name:i.inputs.name.value,nodeId:i.id,nodeInterfaceId:i.outputs.placeholder.id}))}get outputs(){return this.nodes.filter(i=>i.type===va).map(i=>({id:i.graphInterfaceId,name:i.inputs.name.value,nodeId:i.id,nodeInterfaceId:i.outputs.output.id}))}constructor(n,i){this.id=tr(),this.activeTransactions=0,this._nodes=[],this._connections=[],this._loading=false,this._destroying=false,this.events={beforeAddNode:new Js(this),addNode:new qt(this),beforeRemoveNode:new Js(this),removeNode:new qt(this),beforeAddConnection:new Js(this),addConnection:new qt(this),checkConnection:new Js(this),beforeRemoveConnection:new Js(this),removeConnection:new qt(this)},this.hooks={save:new Xi(this),load:new Xi(this),checkConnection:new wG(this)},this.nodeEvents=kn(),this.nodeHooks=kn(),this.connectionEvents=kn(),this.editor=n,this.template=i,n.registerGraph(this)}addNode(n){if(!this.events.beforeAddNode.emit(n).prevented)return this.nodeEvents.addTarget(n.events),this.nodeHooks.addTarget(n.hooks),n.registerGraph(this),this._nodes.push(n),n=this.nodes.find(i=>i.id===n.id),n.onPlaced(),this.events.addNode.emit(n),n}removeNode(n){if(this.nodes.includes(n)){if(this.events.beforeRemoveNode.emit(n).prevented)return;const i=[...Object.values(n.inputs),...Object.values(n.outputs)];this.connections.filter(o=>i.includes(o.from)||i.includes(o.to)).forEach(o=>this.removeConnection(o)),this._nodes.splice(this.nodes.indexOf(n),1),this.events.removeNode.emit(n),n.onDestroy(),this.nodeEvents.removeTarget(n.events),this.nodeHooks.removeTarget(n.hooks)}}addConnection(n,i){const o=this.checkConnection(n,i);if(!o.connectionAllowed||this.events.beforeAddConnection.emit({from:n,to:i}).prevented)return;for(const f of o.connectionsInDanger){const m=this.connections.find(u=>u.id===f.id);m&&this.removeConnection(m)}const l=new fy(o.dummyConnection.from,o.dummyConnection.to);return this.internalAddConnection(l),l}removeConnection(n){if(this.connections.includes(n)){if(this.events.beforeRemoveConnection.emit(n).prevented)return;n.destruct(),this._connections.splice(this.connections.indexOf(n),1),this.events.removeConnection.emit(n),this.connectionEvents.removeTarget(n.events)}}checkConnection(n,i){if(!n||!i)return{connectionAllowed:false};const o=this.findNodeById(n.nodeId),l=this.findNodeById(i.nodeId);if(o&&l&&o===l)return{connectionAllowed:false};if(n.isInput&&!i.isInput){const u=n;n=i,i=u}if(n.isInput||!i.isInput)return{connectionAllowed:false};if(this.connections.some(u=>u.from===n&&u.to===i))return{connectionAllowed:false};if(this.events.checkConnection.emit({from:n,to:i}).prevented)return{connectionAllowed:false};const f=this.hooks.checkConnection.execute({from:n,to:i});if(f.some(u=>!u.connectionAllowed))return{connectionAllowed:false};const m=Array.from(new Set(f.flatMap(u=>u.connectionsInDanger)));return{connectionAllowed:true,dummyConnection:new kG(n,i),connectionsInDanger:m}}findNodeInterface(n){for(const i of this.nodes){for(const o in i.inputs){const l=i.inputs[o];if(l.id===n)return l}for(const o in i.outputs){const l=i.outputs[o];if(l.id===n)return l}}}findNodeById(n){return this.nodes.find(i=>i.id===n)}load(n){try{this._loading=true;const i=[];for(let o=this.connections.length-1;o>=0;o--)this.removeConnection(this.connections[o]);for(let o=this.nodes.length-1;o>=0;o--)this.removeNode(this.nodes[o]);this.id=n.id;for(const o of n.nodes){const l=this.editor.nodeTypes.get(o.type);if(!l){i.push(`Node type ${o.type} is not registered`);continue}const f=new l.type;this.addNode(f),f.load(o)}for(const o of n.connections){const l=this.findNodeInterface(o.from),f=this.findNodeInterface(o.to);if(l)if(f){const m=new fy(l,f);m.id=o.id,this.internalAddConnection(m)}else{i.push(`Could not find interface with id ${o.to}`);continue}else{i.push(`Could not find interface with id ${o.from}`);continue}}return this.hooks.load.execute(n),i}finally{this._loading=false}}save(){const n={id:this.id,nodes:this.nodes.map(i=>i.save()),connections:this.connections.map(i=>({id:i.id,from:i.from.id,to:i.to.id})),inputs:this.inputs,outputs:this.outputs};return this.hooks.save.execute(n)}destroy(){this._destroying=true;for(const n of this.nodes)this.removeNode(n);this.editor.unregisterGraph(this)}internalAddConnection(n){this.connectionEvents.addTarget(n.events),this._connections.push(n),this.events.addConnection.emit(n)}}const nc="__baklava_GraphNode-";function ba(s){return nc+s.id}const LG=["component","connectionCount","events","hidden","hooks","id","isInput","name","nodeId","port","templateId","value"];function NG(s){return class extends $I{constructor(){super(...arguments),this.type=ba(s),this.inputs={},this.outputs={},this.template=s,this.calculate=async(i,o)=>{var l;if(!this.subgraph)throw new Error(`GraphNode ${this.id}: calculate called without subgraph being initialized`);if(!o.engine||typeof o.engine!="object")throw new Error(`GraphNode ${this.id}: calculate called but no engine provided in context`);const f=o.engine.getInputValues(this.subgraph);for(const _ of this.subgraph.inputs)f.set(_.nodeInterfaceId,i[_.id]);const m=await o.engine.runGraph(this.subgraph,f,o.globalValues),u={};for(const _ of this.subgraph.outputs)u[_.id]=(l=m.get(_.nodeId))===null||l===void 0?void 0:l.get("output");return u._calculationResults=m,u}}get title(){return this._title}set title(i){this.template.name=i}load(i){if(!this.subgraph)throw new Error("Cannot load a graph node without a graph");if(!this.template)throw new Error("Unable to load graph node without graph template");this.subgraph.load(i.graphState),super.load(i)}save(){if(!this.subgraph)throw new Error("Cannot save a graph node without a graph");return{...super.save(),graphState:this.subgraph.save()}}onPlaced(){this.template.events.updated.subscribe(this,()=>this.initialize()),this.template.events.nameChanged.subscribe(this,i=>{this._title=i}),this.initialize()}onDestroy(){var i;this.template.events.updated.unsubscribe(this),this.template.events.nameChanged.unsubscribe(this),(i=this.subgraph)===null||i===void 0||i.destroy()}initialize(){this.subgraph&&this.subgraph.destroy(),this.subgraph=this.template.createGraph(),this._title=this.template.name,this.updateInterfaces(),this.events.update.emit(null)}updateInterfaces(){if(!this.subgraph)throw new Error("Trying to update interfaces without graph instance");for(const i of this.subgraph.inputs)i.id in this.inputs?this.inputs[i.id].name=i.name:this.addInput(i.id,this.createProxyInterface(i,true));for(const i of Object.keys(this.inputs))this.subgraph.inputs.some(o=>o.id===i)||this.removeInput(i);for(const i of this.subgraph.outputs)i.id in this.outputs?this.outputs[i.id].name=i.name:this.addOutput(i.id,this.createProxyInterface(i,false));for(const i of Object.keys(this.outputs))this.subgraph.outputs.some(o=>o.id===i)||this.removeOutput(i);this.addOutput("_calculationResults",new _t("_calculationResults",void 0).setHidden(true))}createProxyInterface(i,o){const l=new _t(i.name,void 0);return new Proxy(l,{get:(f,m)=>{var u,_,c;if(LG.includes(m)||m in f||typeof m=="string"&&m.startsWith("__v_"))return Reflect.get(f,m);let h;if(o){const $=(u=this.subgraph)===null||u===void 0?void 0:u.nodes.find(S=>Sm.isGraphInputNode(S)&&S.graphInterfaceId===i.id);h=$==null?void 0:$.outputs.placeholder.id}else{const $=(_=this.subgraph)===null||_===void 0?void 0:_.nodes.find(S=>$m.isGraphOutputNode(S)&&S.graphInterfaceId===i.id);h=$==null?void 0:$.inputs.placeholder.id}const p=(c=this.subgraph)===null||c===void 0?void 0:c.connections.find($=>{var S;return h===((S=o?$.from:$.to)===null||S===void 0?void 0:S.id)}),T=o?p==null?void 0:p.to:p==null?void 0:p.from;if(T)return Reflect.get(T,m)}})}}}class Rh{static fromGraph(n,i){return new Rh(n.save(),i)}get name(){return this._name}set name(n){this._name=n,this.events.nameChanged.emit(n);const i=this.editor.nodeTypes.get(ba(this));i&&(i.title=n)}get inputs(){return this.nodes.filter(i=>i.type===Ea).map(i=>({id:i.graphInterfaceId,name:i.inputs.name.value,nodeId:i.id,nodeInterfaceId:i.outputs.placeholder.id}))}get outputs(){return this.nodes.filter(i=>i.type===va).map(i=>({id:i.graphInterfaceId,name:i.inputs.name.value,nodeId:i.id,nodeInterfaceId:i.outputs.output.id}))}constructor(n,i){this.id=tr(),this._name="Subgraph",this.events={nameChanged:new qt(this),updated:new qt(this)},this.hooks={beforeLoad:new Xi(this),afterSave:new Xi(this)},this.editor=i,n.id&&(this.id=n.id),n.name&&(this._name=n.name),this.update(n)}update(n){this.nodes=n.nodes,this.connections=n.connections,this.events.updated.emit()}save(){return{id:this.id,name:this.name,nodes:this.nodes,connections:this.connections,inputs:this.inputs,outputs:this.outputs}}createGraph(n){const i=new Map,o=T=>{const $=tr();return i.set(T,$),$},l=T=>{const $=i.get(T);if(!$)throw new Error(`Unable to create graph from template: Could not map old id ${T} to new id`);return $},f=T=>xf(T,$=>({id:o($.id),templateId:$.id,value:$.value})),m=this.nodes.map(T=>({...T,id:o(T.id),inputs:f(T.inputs),outputs:f(T.outputs)})),u=this.connections.map(T=>({id:o(T.id),from:l(T.from),to:l(T.to)})),_=this.inputs.map(T=>({id:T.id,name:T.name,nodeId:l(T.nodeId),nodeInterfaceId:l(T.nodeInterfaceId)})),c=this.outputs.map(T=>({id:T.id,name:T.name,nodeId:l(T.nodeId),nodeInterfaceId:l(T.nodeInterfaceId)})),h={id:tr(),nodes:m,connections:u,inputs:_,outputs:c};return n||(n=new yh(this.editor)),n.load(h).forEach(T=>console.warn(T)),n.template=this,n}}class MG{get nodeTypes(){return this._nodeTypes}get graph(){return this._graph}get graphTemplates(){return this._graphTemplates}get graphs(){return this._graphs}get loading(){return this._loading}constructor(){this.events={loaded:new qt(this),beforeRegisterNodeType:new Js(this),registerNodeType:new qt(this),beforeUnregisterNodeType:new Js(this),unregisterNodeType:new qt(this),beforeAddGraphTemplate:new Js(this),addGraphTemplate:new qt(this),beforeRemoveGraphTemplate:new Js(this),removeGraphTemplate:new qt(this),registerGraph:new qt(this),unregisterGraph:new qt(this)},this.hooks={save:new Xi(this),load:new Xi(this)},this.graphTemplateEvents=kn(),this.graphTemplateHooks=kn(),this.graphEvents=kn(),this.graphHooks=kn(),this.nodeEvents=kn(),this.nodeHooks=kn(),this.connectionEvents=kn(),this._graphs=new Set,this._nodeTypes=new Map,this._graph=new yh(this),this._graphTemplates=[],this._loading=false,this.registerNodeType(Sm),this.registerNodeType($m)}registerNodeType(n,i){var o,l;if(this.events.beforeRegisterNodeType.emit({type:n,options:i}).prevented)return;const f=new n;this._nodeTypes.set(f.type,{type:n,category:(o=i==null?void 0:i.category)!==null&&o!==void 0?o:"default",title:(l=i==null?void 0:i.title)!==null&&l!==void 0?l:f.title}),this.events.registerNodeType.emit({type:n,options:i})}unregisterNodeType(n){const i=typeof n=="string"?n:new n().type;if(this.nodeTypes.has(i)){if(this.events.beforeUnregisterNodeType.emit(i).prevented)return;this._nodeTypes.delete(i),this.events.unregisterNodeType.emit(i)}}addGraphTemplate(n){if(this.events.beforeAddGraphTemplate.emit(n).prevented)return;this._graphTemplates.push(n),this.graphTemplateEvents.addTarget(n.events),this.graphTemplateHooks.addTarget(n.hooks);const i=NG(n);this.registerNodeType(i,{category:"Subgraphs",title:n.name}),this.events.addGraphTemplate.emit(n)}removeGraphTemplate(n){if(this.graphTemplates.includes(n)){if(this.events.beforeRemoveGraphTemplate.emit(n).prevented)return;const i=ba(n);for(const o of[this.graph,...this.graphs.values()]){const l=o.nodes.filter(f=>f.type===i);for(const f of l)o.removeNode(f)}this.unregisterNodeType(i),this._graphTemplates.splice(this._graphTemplates.indexOf(n),1),this.graphTemplateEvents.removeTarget(n.events),this.graphTemplateHooks.removeTarget(n.hooks),this.events.removeGraphTemplate.emit(n)}}registerGraph(n){this.graphEvents.addTarget(n.events),this.graphHooks.addTarget(n.hooks),this.nodeEvents.addTarget(n.nodeEvents),this.nodeHooks.addTarget(n.nodeHooks),this.connectionEvents.addTarget(n.connectionEvents),this.events.registerGraph.emit(n),this._graphs.add(n)}unregisterGraph(n){this.graphEvents.removeTarget(n.events),this.graphHooks.removeTarget(n.hooks),this.nodeEvents.removeTarget(n.nodeEvents),this.nodeHooks.removeTarget(n.nodeHooks),this.connectionEvents.removeTarget(n.connectionEvents),this.events.unregisterGraph.emit(n),this._graphs.delete(n)}load(n){try{for(this._loading=true,n=this.hooks.load.execute(n);this.graphTemplates.length>0;)this.removeGraphTemplate(this.graphTemplates[0]);n.graphTemplates.forEach(o=>{const l=new Rh(o,this);this.addGraphTemplate(l)});const i=this._graph.load(n.graph);return this.events.loaded.emit(),i.forEach(o=>console.warn(o)),i}finally{this._loading=false}}save(){const n={graph:this.graph.save(),graphTemplates:this.graphTemplates.map(i=>i.save())};return this.hooks.save.execute(n)}}var my;(function(s){s.Running="Running",s.Idle="Idle",s.Paused="Paused",s.Stopped="Stopped"})(my||(my={}));const DG=["INPUT","TEXTAREA","SELECT"];function RI(s){return DG.includes(s.tagName)}let Bf=null;function xG(s){Bf=s}function Di(){if(!Bf)throw new Error("providePlugin() must be called before usePlugin()");return{viewModel:Bf}}function Ki(){const{viewModel:s}=Di();return{graph:hn(s.value,"displayedGraph"),switchGraph:s.value.switchGraph}}function II(s){const{graph:n}=Ki(),i=me(null),o=me(null);return{dragging:_e(()=>!!i.value),onPointerDown:_=>{i.value={x:_.pageX,y:_.pageY},o.value={x:s.value.x,y:s.value.y}},onPointerMove:_=>{if(i.value){const c=_.pageX-i.value.x,h=_.pageY-i.value.y;s.value.x=o.value.x+c/n.value.scaling,s.value.y=o.value.y+h/n.value.scaling}},onPointerUp:()=>{i.value=null,o.value=null}}}function CI(s,n,i){if(!n.template)return false;if(ba(n.template)===i)return true;const o=s.graphTemplates.find(f=>ba(f)===i);return o?o.nodes.filter(f=>f.type.startsWith(nc)).some(f=>CI(s,n,f.type)):false}function OI(s){return _e(()=>{const n=Array.from(s.value.editor.nodeTypes.entries()),i=new Set(n.map(([,l])=>l.category)),o=[];for(const l of i.values()){let f=n.filter(([,m])=>m.category===l);s.value.displayedGraph.template?f=f.filter(([m])=>!CI(s.value.editor,s.value.displayedGraph,m)):f=f.filter(([m])=>![Ea,va].includes(m)),f.length>0&&o.push({name:l,nodeTypes:Object.fromEntries(f)})}return o.sort((l,f)=>l.name==="default"?-1:f.name==="default"||l.name>f.name?1:-1),o})}function wI(){const{graph:s}=Ki();return{transform:(i,o)=>{const l=i/s.value.scaling-s.value.panning.x,f=o/s.value.scaling-s.value.panning.y;return[l,f]}}}function BG(){const{graph:s}=Ki();let n=[],i=-1,o={x:0,y:0};const l=_e(()=>s.value.panning),f=II(l),m=_e(()=>({"transform-origin":"0 0",transform:`scale(${s.value.scaling}) translate(${s.value.panning.x}px, ${s.value.panning.y}px)`})),u=($,S,y)=>{const g=[$/s.value.scaling-s.value.panning.x,S/s.value.scaling-s.value.panning.y],E=[$/y-s.value.panning.x,S/y-s.value.panning.y],v=[E[0]-g[0],E[1]-g[1]];s.value.panning.x+=v[0],s.value.panning.y+=v[1],s.value.scaling=y},_=$=>{$.preventDefault();let S=$.deltaY;$.deltaMode===1&&(S*=32);const y=s.value.scaling*(1-S/3e3);u($.offsetX,$.offsetY,y)},c=()=>({ax:n[0].clientX,ay:n[0].clientY,bx:n[1].clientX,by:n[1].clientY});return{styles:m,...f,onPointerDown:$=>{if(n.push($),f.onPointerDown($),n.length===2){const{ax:S,ay:y,bx:g,by:E}=c();o={x:S+(g-S)/2,y:y+(E-y)/2}}},onPointerMove:$=>{for(let S=0;S<n.length;S++)if($.pointerId==n[S].pointerId){n[S]=$;break}if(n.length==2){const{ax:S,ay:y,bx:g,by:E}=c(),v=S-g,b=y-E,R=Math.sqrt(v*v+b*b);if(i>0){const O=s.value.scaling*(1+(R-i)/500);u(o.x,o.y,O)}i=R}else f.onPointerMove($)},onPointerUp:$=>{n=n.filter(S=>S.pointerId!==$.pointerId),i=-1,f.onPointerUp()},onMouseWheel:_}}var Wi=(s=>(s[s.NONE=0]="NONE",s[s.ALLOWED=1]="ALLOWED",s[s.FORBIDDEN=2]="FORBIDDEN",s))(Wi||{});const kI=Symbol();function PG(){const{graph:s}=Ki(),n=me(null),i=me(null),o=u=>{n.value&&(n.value.mx=u.offsetX/s.value.scaling-s.value.panning.x,n.value.my=u.offsetY/s.value.scaling-s.value.panning.y)},l=()=>{if(i.value){if(n.value)return;const u=s.value.connections.find(_=>_.to===i.value);i.value.isInput&&u?(n.value={status:Wi.NONE,from:u.from},s.value.removeConnection(u)):n.value={status:Wi.NONE,from:i.value},n.value.mx=void 0,n.value.my=void 0}},f=()=>{if(n.value&&i.value){if(n.value.from===i.value)return;s.value.addConnection(n.value.from,n.value.to)}n.value=null},m=u=>{if(i.value=u??null,u&&n.value){n.value.to=u;const _=s.value.checkConnection(n.value.from,n.value.to);if(n.value.status=_.connectionAllowed?Wi.ALLOWED:Wi.FORBIDDEN,_.connectionAllowed){const c=_.connectionsInDanger.map(h=>h.id);s.value.connections.forEach(h=>{c.includes(h.id)&&(h.isInDanger=true)})}}else!u&&n.value&&(n.value.to=void 0,n.value.status=Wi.NONE,s.value.connections.forEach(_=>{_.isInDanger=false}))};return oc(kI,{temporaryConnection:n,hoveredOver:m}),{temporaryConnection:n,onMouseMove:o,onMouseDown:l,onMouseUp:f,hoveredOver:m}}function UG(){const s=Vs(kI);if(!s)throw new Error("useTemporaryConnection must be used within a BaklavaEditor");return s}function FG(s){const n=me(false),i=me(0),o=me(0),l=OI(s),{transform:f}=wI(),m=_e(()=>{let h=[];const p={};for(const $ of l.value){const S=Object.entries($.nodeTypes).map(([y,g])=>({label:g.title,value:"addNode:"+y}));$.name==="default"?h=S:p[$.name]=S}const T=[...Object.entries(p).map(([$,S])=>({label:$,submenu:S}))];return T.length>0&&h.length>0&&T.push({isDivider:true}),T.push(...h),T}),u=_e(()=>s.value.settings.contextMenu.additionalItems.length===0?m.value:[{label:"Add node",submenu:m.value},...s.value.settings.contextMenu.additionalItems.map(h=>"isDivider"in h||"submenu"in h?h:{label:h.label,value:"command:"+h.command,disabled:!s.value.commandHandler.canExecuteCommand(h.command)})]);function _(h){const p=h.target;if(!(p instanceof Element)||RI(p))return;h.preventDefault(),n.value=true;const T=p.getBoundingClientRect(),S=p.closest(".baklava-editor").getBoundingClientRect();i.value=T.x+h.offsetX-S.x,o.value=T.y+h.offsetY-S.y}function c(h){if(h.startsWith("addNode:")){const p=h.substring(8),T=s.value.editor.nodeTypes.get(p);if(!T)return;const $=zi(new T.type);s.value.displayedGraph.addNode($);const[S,y]=f(i.value,o.value);$.position.x=S,$.position.y=y}else if(h.startsWith("command:")){const p=h.substring(8);s.value.commandHandler.canExecuteCommand(p)&&s.value.commandHandler.executeCommand(p)}}return{show:n,x:i,y:o,items:u,open:_,onClick:c}}const Vu="START_SELECTION_BOX";function GG(s){const{viewModel:n}=Di(),{graph:i}=Ki(),o=_e(()=>i.value.nodes),l=me(false),f=me(false),m=me([0,0]),u=me([0,0]);kt(n,()=>{n.value.commandHandler.hasCommand(Vu)||(n.value.commandHandler.registerCommand(Vu,{canExecute:()=>true,execute(){l.value=true}}),n.value.commandHandler.registerHotkey(["b"],Vu))},{immediate:true});function _(E){return[E.clientX-s.value.getBoundingClientRect().left,E.clientY-s.value.getBoundingClientRect().top]}function c(E){return l.value?(f.value=true,l.value=false,m.value=_(E),u.value=_(E),document.addEventListener("pointermove",h),document.addEventListener("pointerup",p),true):false}function h(E){m.value=_(E)}function p(E){document.removeEventListener("pointermove",h),document.removeEventListener("pointerup",p),m.value=_(E),f.value=false;const v=T();for(const b of v)n.value.displayedGraph.selectedNodes.push(b)}function T(){const E=$(),b=document.querySelector(".baklava-editor").getBoundingClientRect();return o.value.filter(R=>{const O=S(R,b);return y(E,O)})}function $(){return{left:Math.min(m.value[0],u.value[0]),top:Math.min(m.value[1],u.value[1]),right:Math.max(m.value[0],u.value[0]),bottom:Math.max(m.value[1],u.value[1])}}function S(E,v){const b=document.getElementById(E.id),R=b?b.getBoundingClientRect():{x:0,y:0,width:0,height:0},O=R.x-v.left,w=R.y-v.top;return{left:O,top:w,right:O+R.width,bottom:w+R.height}}function y(E,v){return E.left<v.right&&E.right>v.left&&E.top<v.bottom&&E.bottom>v.top}function g(){return{width:Math.abs(u.value[0]-m.value[0])+"px",height:Math.abs(u.value[1]-m.value[1])+"px",left:(u.value[0]>m.value[0]?m.value[0]:u.value[0])+"px",top:(u.value[1]>m.value[1]?m.value[1]:u.value[1])+"px"}}return zi({startSelection:l,isSelecting:f,start:m,end:u,onPointerDown:c,getStyles:g})}const HG=Ke({setup(){const{viewModel:s}=Di(),{graph:n}=Ki();return{styles:_e(()=>{const o=s.value.settings.background,l=n.value.panning.x*n.value.scaling,f=n.value.panning.y*n.value.scaling,m=n.value.scaling*o.gridSize,u=m/o.gridDivision,_=`${m}px ${m}px, ${m}px ${m}px`,c=n.value.scaling>o.subGridVisibleThreshold?`, ${u}px ${u}px, ${u}px ${u}px`:"";return{backgroundPosition:`left ${l}px top ${f}px`,backgroundSize:`${_} ${c}`}})}}}),ds=(s,n)=>{const i=s.__vccOpts||s;for(const[o,l]of n)i[o]=l;return i};function VG(s,n,i,o,l,f){return ne(),ve("div",{class:"background",style:Hs(s.styles)},null,4)}const WG=ds(HG,[["render",VG]]);function zG(s){return _w()?(Oy(s),true):false}const AI=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const jG=Object.prototype.toString,XG=s=>jG.call(s)==="[object Object]",la=()=>{},KG=YG();function YG(){var s,n;return AI&&((s=window==null?void 0:window.navigator)==null?void 0:s.userAgent)&&(/iP(?:ad|hone|od)/.test(window.navigator.userAgent)||((n=window==null?void 0:window.navigator)==null?void 0:n.maxTouchPoints)>2&&/iPad|Macintosh/.test(window==null?void 0:window.navigator.userAgent))}function qG(s,n,i=false){return n.reduce((o,l)=>(l in s&&(!i||s[l]!==void 0)&&(o[l]=s[l]),o),{})}function uf(s){return Array.isArray(s)?s:[s]}function JG(s,n={}){if(!Vl(s))return wy(s);const i=Array.isArray(s.value)?Array.from({length:s.value.length}):{};for(const o in s.value)i[o]=fw(()=>({get(){return s.value[o]},set(l){var f;if((f=Cr(n.replaceRef))!=null?f:true)if(Array.isArray(s.value)){const u=[...s.value];u[o]=l,s.value=u}else{const u={...s.value,[o]:l};Object.setPrototypeOf(u,Object.getPrototypeOf(s.value)),s.value=u}else s.value[o]=l}}));return i}function ZG(s,n,i){return kt(s,n,{...i,immediate:true})}const ym=AI?window:void 0;function Dl(s){var n;const i=Cr(s);return(n=i==null?void 0:i.$el)!=null?n:i}function Gl(...s){const n=[],i=()=>{n.forEach(u=>u()),n.length=0},o=(u,_,c,h)=>(u.addEventListener(_,c,h),()=>u.removeEventListener(_,c,h)),l=_e(()=>{const u=uf(Cr(s[0])).filter(_=>_!=null);return u.every(_=>typeof _!="string")?u:void 0}),f=ZG(()=>{var u,_;return[(_=(u=l.value)==null?void 0:u.map(c=>Dl(c)))!=null?_:[ym].filter(c=>c!=null),uf(Cr(l.value?s[1]:s[0])),uf(ue(l.value?s[2]:s[1])),Cr(l.value?s[3]:s[2])]},([u,_,c,h])=>{if(i(),!(u!=null&&u.length)||!(_!=null&&_.length)||!(c!=null&&c.length))return;const p=XG(h)?{...h}:h;n.push(...u.flatMap(T=>_.flatMap($=>c.map(S=>o(T,$,S,p)))))},{flush:"post"}),m=()=>{f(),i()};return zG(i),m}let Ey=false;function LI(s,n,i={}){const{window:o=ym,ignore:l=[],capture:f=true,detectIframe:m=false,controls:u=false}=i;if(!o)return u?{stop:la,cancel:la,trigger:la}:la;if(KG&&!Ey){Ey=true;const g={passive:true};Array.from(o.document.body.children).forEach(E=>E.addEventListener("click",la,g)),o.document.documentElement.addEventListener("click",la,g)}let _=true;const c=g=>Cr(l).some(E=>{if(typeof E=="string")return Array.from(o.document.querySelectorAll(E)).some(v=>v===g.target||g.composedPath().includes(v));{const v=Dl(E);return v&&(g.target===v||g.composedPath().includes(v))}});function h(g){const E=Cr(g);return E&&E.$.subTree.shapeFlag===16}function p(g,E){const v=Cr(g),b=v.$.subTree&&v.$.subTree.children;return b==null||!Array.isArray(b)?false:b.some(R=>R.el===E.target||E.composedPath().includes(R.el))}const T=g=>{const E=Dl(s);if(g.target!=null&&!(!(E instanceof Element)&&h(s)&&p(s,g))&&!(!E||E===g.target||g.composedPath().includes(E))){if("detail"in g&&g.detail===0&&(_=!c(g)),!_){_=true;return}n(g)}};let $=false;const S=[Gl(o,"click",g=>{$||($=true,setTimeout(()=>{$=false},0),T(g))},{passive:true,capture:f}),Gl(o,"pointerdown",g=>{const E=Dl(s);_=!c(g)&&!!(E&&!g.composedPath().includes(E))},{passive:true}),m&&Gl(o,"blur",g=>{setTimeout(()=>{var E;const v=Dl(s);((E=o.document.activeElement)==null?void 0:E.tagName)==="IFRAME"&&!(v!=null&&v.contains(o.document.activeElement))&&n(g)},0)},{passive:true})].filter(Boolean),y=()=>S.forEach(g=>g());return u?{stop:y,cancel:()=>{_=false},trigger:g=>{_=true,T(g),_=false}}:y}const NI={x:0,y:0,pointerId:0,pressure:0,tiltX:0,tiltY:0,width:0,height:0,twist:0,pointerType:null},QG=Object.keys(NI);function eH(s={}){const{target:n=ym}=s,i=xl(false),o=me(s.initialValue||{});Object.assign(o.value,NI,o.value);const l=f=>{i.value=true,!(s.pointerTypes&&!s.pointerTypes.includes(f.pointerType))&&(o.value=qG(f,QG,false))};if(n){const f={passive:true};Gl(n,["pointerdown","pointermove","pointerup"],l,f),Gl(n,"pointerleave",()=>i.value=false,f)}return{...JG(o),isInside:i}}const tH=["onMouseenter","onMouseleave","onClick"],sH={class:"flex-fill"},iH={key:0,class:"__submenu-icon",style:{"line-height":"1em"}},Rm=Ke({__name:"ContextMenu",props:{modelValue:{type:Boolean},items:{},x:{default:0},y:{default:0},isNested:{type:Boolean,default:false},isFlipped:{default:()=>({x:false,y:false})},flippable:{type:Boolean,default:false}},emits:["update:modelValue","click"],setup(s,{emit:n}){const i=s,o=n;let l=null;const f=me(null),m=me(-1),u=me(0),_=me({x:false,y:false}),c=_e(()=>i.flippable&&(_.value.x||i.isFlipped.x)),h=_e(()=>i.flippable&&(_.value.y||i.isFlipped.y)),p=_e(()=>{const v={};return i.isNested||(v.top=(h.value?i.y-u.value:i.y)+"px",v.left=i.x+"px"),v}),T=_e(()=>({"--flipped-x":c.value,"--flipped-y":h.value,"--nested":i.isNested})),$=_e(()=>i.items.map(v=>({...v,hover:false})));kt([()=>i.y,()=>i.items],()=>{var v,b,R,O;u.value=i.items.length*30;const w=((b=(v=f.value)==null?void 0:v.parentElement)==null?void 0:b.offsetWidth)??0,L=((O=(R=f.value)==null?void 0:R.parentElement)==null?void 0:O.offsetHeight)??0;_.value.x=!i.isNested&&i.x>w*.75,_.value.y=!i.isNested&&i.y+u.value>L-20}),LI(f,()=>{i.modelValue&&o("update:modelValue",false)});const S=v=>{!v.submenu&&v.value&&(o("click",v.value),o("update:modelValue",false))},y=v=>{o("click",v),m.value=-1,i.isNested||o("update:modelValue",false)},g=(v,b)=>{i.items[b].submenu&&(m.value=b,l!==null&&(clearTimeout(l),l=null))},E=(v,b)=>{i.items[b].submenu&&(l=window.setTimeout(()=>{m.value=-1,l=null},200))};return(v,b)=>{const R=gt("ContextMenu",true);return ne(),Ye(ac,{name:"slide-fade"},{default:je(()=>[hi(de("div",{ref_key:"el",ref:f,class:tt(["baklava-context-menu",T.value]),style:Hs(p.value)},[(ne(true),ve(Pt,null,pi($.value,(O,w)=>(ne(),ve(Pt,null,[O.isDivider?(ne(),ve("div",{key:`d-${w}`,class:"divider"})):(ne(),ve("div",{key:`i-${w}`,class:tt(["item",{submenu:!!O.submenu,"--disabled":!!O.disabled}]),onMouseenter:L=>g(L,w),onMouseleave:L=>E(L,w),onClick:gs(L=>S(O),["stop","prevent"])},[de("div",sH,Bt(O.label),1),O.submenu?(ne(),ve("div",iH,b[0]||(b[0]=[de("svg",{width:"13",height:"13",viewBox:"-60 120 250 250"},[de("path",{d:"M160.875 279.5625 L70.875 369.5625 L70.875 189.5625 L160.875 279.5625 Z",stroke:"none",fill:"white"})],-1)]))):Ze("",true),O.submenu?(ne(),Ye(R,{key:1,"model-value":m.value===w,items:O.submenu,"is-nested":true,"is-flipped":{x:c.value,y:h.value},flippable:v.flippable,onClick:y},null,8,["model-value","items","is-flipped","flippable"])):Ze("",true)],42,tH))],64))),256))],6),[[Hi,v.modelValue]])]),_:1})}}}),nH={},rH={xmlns:"http://www.w3.org/2000/svg",class:"baklava-icon",width:"16",height:"16",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"};function oH(s,n){return ne(),ve("svg",rH,n[0]||(n[0]=[de("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"},null,-1),de("circle",{cx:"12",cy:"12",r:"1"},null,-1),de("circle",{cx:"12",cy:"19",r:"1"},null,-1),de("circle",{cx:"12",cy:"5",r:"1"},null,-1)]))}const MI=ds(nH,[["render",oH]]),aH=["id"],lH={key:0,class:"__tooltip"},cH={key:2,class:"align-middle"},vy=Ke({__name:"NodeInterface",props:{node:{},intf:{}},setup(s){const n=(g,E=100)=>{const v=typeof(g==null?void 0:g.toString)=="function"?String(g):"";return v.length>E?v.slice(0,E)+"...":v},i=s,{viewModel:o}=Di(),{hoveredOver:l,temporaryConnection:f}=UG(),m=me(null),u=_e(()=>i.intf.connectionCount>0),_=me(false),c=_e(()=>o.value.settings.displayValueOnHover&&_.value),h=_e(()=>({"--input":i.intf.isInput,"--output":!i.intf.isInput,"--connected":u.value})),p=_e(()=>i.intf.component&&(!i.intf.isInput||!i.intf.port||i.intf.connectionCount===0)),T=()=>{_.value=true,l(i.intf)},$=()=>{_.value=false,l(void 0)},S=()=>{m.value&&o.value.hooks.renderInterface.execute({intf:i.intf,el:m.value})},y=()=>{const g=o.value.displayedGraph.sidebar;g.nodeId=i.node.id,g.optionName=i.intf.name,g.visible=true};return Rs(S),Ly(S),(g,E)=>{var v;return ne(),ve("div",{id:g.intf.id,ref_key:"el",ref:m,class:tt(["baklava-node-interface",h.value])},[g.intf.port?(ne(),ve("div",{key:0,class:tt(["__port",{"--selected":((v=ue(f))==null?void 0:v.from)===g.intf}]),onPointerover:T,onPointerout:$},[Dt(g.$slots,"portTooltip",{showTooltip:c.value},()=>[c.value===true?(ne(),ve("span",lH,Bt(n(g.intf.value)),1)):Ze("",true)])],34)):Ze("",true),p.value?(ne(),Ye(qs(g.intf.component),{key:1,modelValue:g.intf.value,"onUpdate:modelValue":E[0]||(E[0]=b=>g.intf.value=b),node:g.node,intf:g.intf,onOpenSidebar:y},null,40,["modelValue","node","intf"])):(ne(),ve("span",cH,Bt(g.intf.name),1))],10,aH)}}}),uH=["id","data-node-type"],hH={class:"__title-label"},dH={class:"__menu"},_H={class:"__outputs"},pH={class:"__inputs"},gH=Ke({__name:"Node",props:{node:{},selected:{type:Boolean,default:false},dragging:{type:Boolean}},emits:["select","start-drag"],setup(s,{emit:n}){const i=s,o=n,{viewModel:l}=Di(),{graph:f,switchGraph:m}=Ki(),u=me(null),_=me(false),c=me(""),h=me(null),p=me(false);let T=0,$=0;const S=me(false),y=_e(()=>{const W=[{value:"rename",label:"Rename"},{value:"delete",label:"Delete"}];return i.node.type.startsWith(nc)&&W.push({value:"editSubgraph",label:"Edit Subgraph"}),W}),g=_e(()=>({"--selected":i.selected,"--dragging":i.dragging,"--two-column":!!i.node.twoColumn})),E=_e(()=>({"--reverse-y":i.node.reverseY??l.value.settings.nodes.reverseY})),v=_e(()=>{var W,z;return{top:`${((W=i.node.position)==null?void 0:W.y)??0}px`,left:`${((z=i.node.position)==null?void 0:z.x)??0}px`,"--width":`${i.node.width??l.value.settings.nodes.defaultWidth}px`}}),b=_e(()=>Object.values(i.node.inputs).filter(W=>!W.hidden)),R=_e(()=>Object.values(i.node.outputs).filter(W=>!W.hidden)),O=()=>{o("select")},w=W=>{i.selected||O(),o("start-drag",W)},L=()=>{S.value=true},I=async W=>{var z;switch(W){case"delete":f.value.removeNode(i.node);break;case"rename":c.value=i.node.title,_.value=true,await rs(),(z=h.value)==null||z.focus();break;case"editSubgraph":m(i.node.template);break}},k=()=>{i.node.title=c.value,_.value=false},x=()=>{u.value&&l.value.hooks.renderNode.execute({node:i.node,el:u.value})},P=W=>{p.value=true,T=i.node.width,$=W.clientX,W.preventDefault()},F=W=>{if(!p.value)return;const z=W.clientX-$,j=T+z/f.value.scaling,J=l.value.settings.nodes.minWidth,M=l.value.settings.nodes.maxWidth;i.node.width=Math.max(J,Math.min(M,j))},X=()=>{p.value=false};return Rs(()=>{x(),window.addEventListener("mousemove",F),window.addEventListener("mouseup",X)}),Ly(x),Nr(()=>{window.removeEventListener("mousemove",F),window.removeEventListener("mouseup",X)}),(W,z)=>(ne(),ve("div",{id:W.node.id,ref_key:"el",ref:u,class:tt(["baklava-node",g.value]),style:Hs(v.value),"data-node-type":W.node.type,onPointerdown:O},[ue(l).settings.nodes.resizable?(ne(),ve("div",{key:0,class:"__resize-handle",onMousedown:P},null,32)):Ze("",true),Dt(W.$slots,"title",{},()=>[de("div",{class:"__title",onPointerdown:gs(w,["self","stop"]),onContextmenu:gs(L,["prevent"])},[_.value?hi((ne(),ve("input",{key:1,ref_key:"renameInputEl",ref:h,"onUpdate:modelValue":z[1]||(z[1]=j=>c.value=j),type:"text",class:"baklava-input",placeholder:"Node Name",onBlur:k,onKeydown:lo(k,["enter"])},null,544)),[[Ny,c.value]]):(ne(),ve(Pt,{key:0},[de("div",hH,Bt(W.node.title),1),de("div",dH,[De(MI,{class:"--clickable",onClick:L}),De(ue(Rm),{modelValue:S.value,"onUpdate:modelValue":z[0]||(z[0]=j=>S.value=j),x:0,y:0,items:y.value,onClick:I},null,8,["modelValue","items"])])],64))],32)]),Dt(W.$slots,"content",{},()=>[de("div",{class:tt(["__content",E.value]),onKeydown:z[2]||(z[2]=lo(gs(()=>{},["stop"]),["delete"]))},[de("div",_H,[(ne(true),ve(Pt,null,pi(R.value,j=>Dt(W.$slots,"nodeInterface",{key:j.id,type:"output",node:W.node,intf:j},()=>[De(vy,{node:W.node,intf:j},null,8,["node","intf"])])),128))]),de("div",pH,[(ne(true),ve(Pt,null,pi(b.value,j=>Dt(W.$slots,"nodeInterface",{key:j.id,type:"input",node:W.node,intf:j},()=>[De(vy,{node:W.node,intf:j},null,8,["node","intf"])])),128))])],34)])],46,uH))}}),fH=Ke({props:{x1:{type:Number,required:true},y1:{type:Number,required:true},x2:{type:Number,required:true},y2:{type:Number,required:true},state:{type:Number,default:Wi.NONE},isTemporary:{type:Boolean,default:false}},setup(s){const{viewModel:n}=Di(),{graph:i}=Ki(),o=(m,u)=>{const _=(m+i.value.panning.x)*i.value.scaling,c=(u+i.value.panning.y)*i.value.scaling;return[_,c]},l=_e(()=>{const[m,u]=o(s.x1,s.y1),[_,c]=o(s.x2,s.y2);if(n.value.settings.useStraightConnections)return`M ${m} ${u} L ${_} ${c}`;{const h=.3*Math.abs(m-_);return`M ${m} ${u} C ${m+h} ${u}, ${_-h} ${c}, ${_} ${c}`}}),f=_e(()=>({"--temporary":s.isTemporary,"--allowed":s.state===Wi.ALLOWED,"--forbidden":s.state===Wi.FORBIDDEN}));return{d:l,classes:f}}}),mH=["d"];function EH(s,n,i,o,l,f){return ne(),ve("path",{class:tt(["baklava-connection",s.classes]),d:s.d},null,10,mH)}const DI=ds(fH,[["render",EH]]);function vH(s){return document.getElementById(s.id)}function Ta(s){const n=document.getElementById(s.id),i=n==null?void 0:n.getElementsByClassName("__port");return{node:(n==null?void 0:n.closest(".baklava-node"))??null,interface:n,port:i&&i.length>0?i[0]:null}}const bH=Ke({components:{"connection-view":DI},props:{connection:{type:Object,required:true}},setup(s){const{graph:n}=Ki();let i;const o=me({x1:0,y1:0,x2:0,y2:0}),l=_e(()=>s.connection.isInDanger?Wi.FORBIDDEN:Wi.NONE),f=_e(()=>{var c;return(c=n.value.findNodeById(s.connection.from.nodeId))==null?void 0:c.position}),m=_e(()=>{var c;return(c=n.value.findNodeById(s.connection.to.nodeId))==null?void 0:c.position}),u=c=>c.node&&c.interface&&c.port?[c.node.offsetLeft+c.interface.offsetLeft+c.port.offsetLeft+c.port.clientWidth/2,c.node.offsetTop+c.interface.offsetTop+c.port.offsetTop+c.port.clientHeight/2]:[0,0],_=()=>{const c=Ta(s.connection.from),h=Ta(s.connection.to);c.node&&h.node&&(i||(i=new ResizeObserver(()=>{_()}),i.observe(c.node),i.observe(h.node)));const[p,T]=u(c),[$,S]=u(h);o.value={x1:p,y1:T,x2:$,y2:S}};return Rs(async()=>{await rs(),_()}),Nr(()=>{i&&i.disconnect()}),kt([f,m],()=>_(),{deep:true}),{d:o,state:l}}});function TH(s,n,i,o,l,f){const m=gt("connection-view");return ne(),Ye(m,{x1:s.d.x1,y1:s.d.y1,x2:s.d.x2,y2:s.d.y2,state:s.state},null,8,["x1","y1","x2","y2","state"])}const SH=ds(bH,[["render",TH]]);function ih(s){return s.node&&s.interface&&s.port?[s.node.offsetLeft+s.interface.offsetLeft+s.port.offsetLeft+s.port.clientWidth/2,s.node.offsetTop+s.interface.offsetTop+s.port.offsetTop+s.port.clientHeight/2]:[0,0]}const $H=Ke({components:{"connection-view":DI},props:{connection:{type:Object,required:true}},setup(s){const n=_e(()=>s.connection?s.connection.status:Wi.NONE);return{d:_e(()=>{if(!s.connection)return{input:[0,0],output:[0,0]};const o=ih(Ta(s.connection.from)),l=s.connection.to?ih(Ta(s.connection.to)):[s.connection.mx||o[0],s.connection.my||o[1]];return s.connection.from.isInput?{input:l,output:o}:{input:o,output:l}}),status:n}}});function yH(s,n,i,o,l,f){const m=gt("connection-view");return ne(),Ye(m,{x1:s.d.input[0],y1:s.d.input[1],x2:s.d.output[0],y2:s.d.output[1],state:s.status,"is-temporary":""},null,8,["x1","y1","x2","y2","state"])}const RH=ds($H,[["render",yH]]),IH=Ke({setup(){const{viewModel:s}=Di(),{graph:n}=Ki(),i=me(null),o=hn(s.value.settings.sidebar,"width"),l=_e(()=>s.value.settings.sidebar.resizable);let f=0,m=0;const u=_e(()=>{const $=n.value.sidebar.nodeId;return n.value.nodes.find(S=>S.id===$)}),_=_e(()=>({width:`${o.value}px`})),c=_e(()=>u.value?[...Object.values(u.value.inputs),...Object.values(u.value.outputs)].filter(S=>S.displayInSidebar&&S.component):[]),h=()=>{n.value.sidebar.visible=false},p=$=>{f=o.value,m=$.clientX,window.addEventListener("mousemove",T),window.addEventListener("mouseup",()=>{window.removeEventListener("mousemove",T)},{once:true})},T=$=>{var S,y;const g=((y=(S=i.value)==null?void 0:S.parentElement)==null?void 0:y.getBoundingClientRect().width)??500,E=$.clientX-m;let v=f-E;v<300?v=300:v>.9*g&&(v=.9*g),o.value=v};return{el:i,graph:n,resizable:l,node:u,styles:_,displayedInterfaces:c,startResize:p,close:h}}}),CH={class:"__header"},OH={class:"__node-name"};function wH(s,n,i,o,l,f){return ne(),ve("div",{ref:"el",class:tt(["baklava-sidebar",{"--open":s.graph.sidebar.visible}]),style:Hs(s.styles)},[s.resizable?(ne(),ve("div",{key:0,class:"__resizer",onMousedown:n[0]||(n[0]=(...m)=>s.startResize&&s.startResize(...m))},null,32)):Ze("",true),de("div",CH,[de("button",{tabindex:"-1",class:"__close",onClick:n[1]||(n[1]=(...m)=>s.close&&s.close(...m))},"×"),de("div",OH,[de("b",null,Bt(s.node?s.node.title:""),1)])]),(ne(true),ve(Pt,null,pi(s.displayedInterfaces,m=>(ne(),ve("div",{key:m.id,class:"__interface"},[(ne(),Ye(qs(m.component),{modelValue:m.value,"onUpdate:modelValue":u=>m.value=u,node:s.node,intf:m},null,8,["modelValue","onUpdate:modelValue","node","intf"]))]))),128))],6)}const kH=ds(IH,[["render",wH]]),AH=Ke({__name:"Minimap",setup(s){const{viewModel:n}=Di(),{graph:i}=Ki(),o=me(null),l=me(false);let f,m=false,u={x1:0,y1:0,x2:0,y2:0},_;const c=()=>{var w,L;if(!f)return;f.canvas.width=o.value.offsetWidth,f.canvas.height=o.value.offsetHeight;const I=new Map,k=new Map;for(const W of i.value.nodes){const z=vH(W),j=(z==null?void 0:z.offsetWidth)??0,J=(z==null?void 0:z.offsetHeight)??0,M=((w=W.position)==null?void 0:w.x)??0,U=((L=W.position)==null?void 0:L.y)??0;I.set(W,{x1:M,y1:U,x2:M+j,y2:U+J}),k.set(W,z)}const x={x1:Number.MAX_SAFE_INTEGER,y1:Number.MAX_SAFE_INTEGER,x2:Number.MIN_SAFE_INTEGER,y2:Number.MIN_SAFE_INTEGER};for(const W of I.values())W.x1<x.x1&&(x.x1=W.x1),W.y1<x.y1&&(x.y1=W.y1),W.x2>x.x2&&(x.x2=W.x2),W.y2>x.y2&&(x.y2=W.y2);const P=50;x.x1-=P,x.y1-=P,x.x2+=P,x.y2+=P,u=x;const F=f.canvas.width/f.canvas.height,X=(u.x2-u.x1)/(u.y2-u.y1);if(F>X){const W=(F-X)*(u.y2-u.y1)*.5;u.x1-=W,u.x2+=W}else{const W=u.x2-u.x1,z=u.y2-u.y1,j=(W-F*z)/F*.5;u.y1-=j,u.y2+=j}f.clearRect(0,0,f.canvas.width,f.canvas.height),f.strokeStyle="white";for(const W of i.value.connections){const[z,j]=ih(Ta(W.from)),[J,M]=ih(Ta(W.to)),[U,V]=h(z,j),[K,H]=h(J,M);if(f.beginPath(),f.moveTo(U,V),n.value.settings.useStraightConnections)f.lineTo(K,H);else{const ie=.3*Math.abs(U-K);f.bezierCurveTo(U+ie,V,K-ie,H,K,H)}f.stroke()}f.strokeStyle="lightgray";for(const[W,z]of I.entries()){const[j,J]=h(z.x1,z.y1),[M,U]=h(z.x2,z.y2);f.fillStyle=T(k.get(W)),f.beginPath(),f.rect(j,J,M-j,U-J),f.fill(),f.stroke()}if(l.value){const W=S(),[z,j]=h(W.x1,W.y1),[J,M]=h(W.x2,W.y2);f.fillStyle="rgba(255, 255, 255, 0.2)",f.fillRect(z,j,J-z,M-j)}},h=(w,L)=>[(w-u.x1)/(u.x2-u.x1)*f.canvas.width,(L-u.y1)/(u.y2-u.y1)*f.canvas.height],p=(w,L)=>[w*(u.x2-u.x1)/f.canvas.width+u.x1,L*(u.y2-u.y1)/f.canvas.height+u.y1],T=w=>{if(w){const L=w.querySelector(".__content");if(L){const k=$(L);if(k)return k}const I=$(w);if(I)return I}return"gray"},$=w=>{const L=getComputedStyle(w).backgroundColor;if(L&&L!=="rgba(0, 0, 0, 0)")return L},S=()=>{const w=o.value.parentElement.offsetWidth,L=o.value.parentElement.offsetHeight,I=w/i.value.scaling-i.value.panning.x,k=L/i.value.scaling-i.value.panning.y;return{x1:-i.value.panning.x,y1:-i.value.panning.y,x2:I,y2:k}},y=w=>{w.button===0&&(m=true,g(w))},g=w=>{if(m){const[L,I]=p(w.offsetX,w.offsetY),k=S(),x=(k.x2-k.x1)/2,P=(k.y2-k.y1)/2;i.value.panning.x=-(L-x),i.value.panning.y=-(I-P)}},E=()=>{m=false},v=()=>{l.value=true},b=()=>{l.value=false,E()};kt([l,i.value.panning,()=>i.value.scaling,()=>i.value.connections.length],()=>{c()});const R=_e(()=>i.value.nodes.map(w=>w.position)),O=_e(()=>i.value.nodes.map(w=>w.width));return kt([R,O],()=>{c()},{deep:true}),Rs(()=>{f=o.value.getContext("2d"),f.imageSmoothingQuality="high",c(),_=setInterval(c,500)}),Nr(()=>{clearInterval(_)}),(w,L)=>(ne(),ve("canvas",{ref_key:"canvas",ref:o,class:"baklava-minimap",onMouseenter:v,onMouseleave:b,onMousedown:gs(y,["self"]),onMousemove:gs(g,["self"]),onMouseup:E,onContextmenu:L[0]||(L[0]=gs(()=>{},["stop","prevent"]))},null,544))}}),LH=Ke({components:{ContextMenu:Rm,VerticalDots:MI},props:{type:{type:String,required:true},title:{type:String,required:true}},setup(s){const{viewModel:n}=Di(),{switchGraph:i}=Ki(),o=me(false),l=_e(()=>s.type.startsWith(nc));return{showContextMenu:o,hasContextMenu:l,contextMenuItems:[{label:"Edit Subgraph",value:"editSubgraph"},{label:"Delete Subgraph",value:"deleteSubgraph"}],openContextMenu:()=>{o.value=true},onContextMenuClick:_=>{const c=s.type.substring(nc.length),h=n.value.editor.graphTemplates.find(p=>p.id===c);if(h)switch(_){case"editSubgraph":i(h);break;case"deleteSubgraph":n.value.editor.removeGraphTemplate(h);break}}}}}),NH=["data-node-type"],MH={class:"__title"},DH={class:"__title-label"},xH={key:0,class:"__menu"};function BH(s,n,i,o,l,f){const m=gt("vertical-dots"),u=gt("context-menu");return ne(),ve("div",{class:"baklava-node --palette","data-node-type":s.type},[de("div",MH,[de("div",DH,Bt(s.title),1),s.hasContextMenu?(ne(),ve("div",xH,[De(m,{class:"--clickable",onPointerdown:n[0]||(n[0]=gs(()=>{},["stop","prevent"])),onClick:gs(s.openContextMenu,["stop","prevent"])},null,8,["onClick"]),De(u,{modelValue:s.showContextMenu,"onUpdate:modelValue":n[1]||(n[1]=_=>s.showContextMenu=_),x:-100,y:0,items:s.contextMenuItems,onClick:s.onContextMenuClick,onPointerdown:n[2]||(n[2]=gs(()=>{},["stop","prevent"]))},null,8,["modelValue","items","onClick"])])):Ze("",true)])],8,NH)}const by=ds(LH,[["render",BH]]),PH={key:0},UH=Ke({__name:"NodePalette",setup(s){const{viewModel:n}=Di(),{x:i,y:o}=eH(),{transform:l}=wI(),f=OI(n),m=Vs("editorEl"),u=me(null),_=_e(()=>{if(!u.value||!(m!=null&&m.value))return{};const{left:h,top:p}=m.value.getBoundingClientRect();return{top:`${o.value-p}px`,left:`${i.value-h}px`}}),c=(h,p)=>{u.value={type:h,nodeInformation:p};const T=()=>{const $=zi(new p.type);n.value.displayedGraph.addNode($);const S=m.value.getBoundingClientRect(),[y,g]=l(i.value-S.left,o.value-S.top);$.position.x=y,$.position.y=g,u.value=null,document.removeEventListener("pointerup",T)};document.addEventListener("pointerup",T)};return(h,p)=>(ne(),ve(Pt,null,[de("div",{class:"baklava-node-palette",onContextmenu:p[0]||(p[0]=gs(()=>{},["stop","prevent"]))},[(ne(true),ve(Pt,null,pi(ue(f),T=>(ne(),ve("section",{key:T.name},[T.name!=="default"?(ne(),ve("h1",PH,Bt(T.name),1)):Ze("",true),(ne(true),ve(Pt,null,pi(T.nodeTypes,($,S)=>(ne(),Ye(by,{key:S,type:S,title:$.title,onPointerdown:y=>c(S,$)},null,8,["type","title","onPointerdown"]))),128))]))),128))],32),De(ac,{name:"fade"},{default:je(()=>[u.value?(ne(),ve("div",{key:0,class:"baklava-dragged-node",style:Hs(_.value)},[De(by,{type:u.value.type,title:u.value.nodeInformation.title},null,8,["type","title"])],4)):Ze("",true)]),_:1})],64))}}),FH=Ke({props:{command:{type:String,required:true},title:{type:String,required:true},icon:{type:Object,required:false,default:void 0}},setup(){const{viewModel:s}=Di();return{viewModel:s}}}),GH=["disabled","title"];function HH(s,n,i,o,l,f){return ne(),ve("button",{class:"baklava-toolbar-entry baklava-toolbar-button",disabled:!s.viewModel.commandHandler.canExecuteCommand(s.command),title:s.title,onClick:n[0]||(n[0]=m=>s.viewModel.commandHandler.executeCommand(s.command))},[s.icon?(ne(),Ye(qs(s.icon),{key:0})):(ne(),ve(Pt,{key:1},[xt(Bt(s.title),1)],64))],8,GH)}const Ty=ds(FH,[["render",HH]]),VH=Ke({__name:"Toolbar",setup(s){const{viewModel:n}=Di(),i=_e(()=>n.value.displayedGraph!==n.value.editor.graph),o=_e(()=>n.value.settings.toolbar.commands),l=_e(()=>n.value.settings.toolbar.subgraphCommands);return(f,m)=>(ne(),ve("div",{class:"baklava-toolbar",onContextmenu:m[0]||(m[0]=gs(()=>{},["stop","prevent"]))},[(ne(true),ve(Pt,null,pi(o.value,u=>(ne(),Ye(Ty,{key:u.command,command:u.command,title:u.title,icon:u.icon},null,8,["command","title","icon"]))),128)),i.value?(ne(true),ve(Pt,{key:0},pi(l.value,u=>(ne(),Ye(Ty,{key:u.command,command:u.command,title:u.title,icon:u.icon},null,8,["command","title","icon"]))),128)):Ze("",true)],32))}}),WH={class:"connections-container"},zH=Ke({__name:"Editor",props:{viewModel:{}},setup(s){const n=s,i=Symbol("EditorToken"),o=hn(n,"viewModel");xG(o);const l=me(null);oc("editorEl",l);const f=_e(()=>n.viewModel.displayedGraph.nodes),m=_e(()=>n.viewModel.displayedGraph.nodes.map(I=>II(hn(I,"position")))),u=_e(()=>n.viewModel.displayedGraph.connections),_=_e(()=>n.viewModel.displayedGraph.selectedNodes),c=BG(),h=PG(),p=FG(o),T=GG(l),$=_e(()=>({...c.styles.value})),S=me(0);n.viewModel.editor.hooks.load.subscribe(i,I=>(S.value++,I));const y=I=>{c.onPointerMove(I),h.onMouseMove(I)},g=I=>{if(I.button===0){if(T.onPointerDown(I))return;I.target===l.value&&(O(),c.onPointerDown(I)),h.onMouseDown()}},E=I=>{c.onPointerUp(I),h.onMouseUp()},v=I=>{I.key==="Tab"&&I.preventDefault(),n.viewModel.commandHandler.handleKeyDown(I)},b=I=>{n.viewModel.commandHandler.handleKeyUp(I)},R=I=>{["Control","Shift"].some(k=>n.viewModel.commandHandler.pressedKeys.includes(k))||O(),n.viewModel.displayedGraph.selectedNodes.push(I)},O=()=>{n.viewModel.displayedGraph.selectedNodes=[]},w=I=>{for(const k of n.viewModel.displayedGraph.selectedNodes){const x=f.value.indexOf(k),P=m.value[x];P.onPointerDown(I),document.addEventListener("pointermove",P.onPointerMove)}document.addEventListener("pointerup",L)},L=()=>{for(const I of n.viewModel.displayedGraph.selectedNodes){const k=f.value.indexOf(I),x=m.value[k];x.onPointerUp(),document.removeEventListener("pointermove",x.onPointerMove)}document.removeEventListener("pointerup",L)};return(I,k)=>(ne(),ve("div",{ref_key:"el",ref:l,tabindex:"-1",class:tt(["baklava-editor",{"baklava-ignore-mouse":!!ue(h).temporaryConnection.value||ue(c).dragging.value,"--temporary-connection":!!ue(h).temporaryConnection.value,"--start-selection-box":ue(T).startSelection}]),onPointermove:gs(y,["self"]),onPointerdown:g,onPointerup:E,onWheel:k[1]||(k[1]=gs((...x)=>ue(c).onMouseWheel&&ue(c).onMouseWheel(...x),["self"])),onKeydown:v,onKeyup:b,onContextmenu:k[2]||(k[2]=gs((...x)=>ue(p).open&&ue(p).open(...x),["self"]))},[Dt(I.$slots,"background",{},()=>[De(WG)]),Dt(I.$slots,"toolbar",{},()=>[I.viewModel.settings.toolbar.enabled?(ne(),Ye(VH,{key:0})):Ze("",true)]),Dt(I.$slots,"palette",{},()=>[I.viewModel.settings.palette.enabled?(ne(),Ye(UH,{key:0})):Ze("",true)]),(ne(),ve("svg",WH,[(ne(true),ve(Pt,null,pi(u.value,x=>(ne(),ve("g",{key:x.id+S.value.toString()},[Dt(I.$slots,"connection",{connection:x},()=>[De(SH,{connection:x},null,8,["connection"])])]))),128)),Dt(I.$slots,"temporaryConnection",{temporaryConnection:ue(h).temporaryConnection.value},()=>[ue(h).temporaryConnection.value?(ne(),Ye(RH,{key:0,connection:ue(h).temporaryConnection.value},null,8,["connection"])):Ze("",true)])])),de("div",{class:"node-container",style:Hs($.value)},[De(pw,{name:"fade"},{default:je(()=>[(ne(true),ve(Pt,null,pi(f.value,(x,P)=>Dt(I.$slots,"node",{key:x.id+S.value.toString(),node:x,selected:_.value.includes(x),dragging:m.value[P].dragging.value,onSelect:F=>R(x),onStartDrag:w},()=>[De(gH,{node:x,selected:_.value.includes(x),dragging:m.value[P].dragging.value,onSelect:F=>R(x),onStartDrag:w},null,8,["node","selected","dragging","onSelect"])])),128))]),_:3})],4),Dt(I.$slots,"sidebar",{},()=>[I.viewModel.settings.sidebar.enabled?(ne(),Ye(kH,{key:0})):Ze("",true)]),Dt(I.$slots,"minimap",{},()=>[I.viewModel.settings.enableMinimap?(ne(),Ye(AH,{key:0})):Ze("",true)]),Dt(I.$slots,"contextMenu",{contextMenu:ue(p)},()=>[I.viewModel.settings.contextMenu.enabled?(ne(),Ye(Rm,{key:0,modelValue:ue(p).show.value,"onUpdate:modelValue":k[0]||(k[0]=x=>ue(p).show.value=x),items:ue(p).items.value,x:ue(p).x.value,y:ue(p).y.value,onClick:ue(p).onClick},null,8,["modelValue","items","x","y","onClick"])):Ze("",true)]),ue(T).isSelecting?(ne(),ve("div",{key:0,class:"selection-box",style:Hs(ue(T).getStyles())},null,4)):Ze("",true)],34))}});function jH(s){const n=me([]),i=me([]);return{pressedKeys:n,handleKeyDown:m=>{n.value.includes(m.key)||n.value.push(m.key),!(document.activeElement&&RI(document.activeElement))&&i.value.forEach(u=>{var _,c;u.keys.every(h=>n.value.includes(h))&&((_=u.options)!=null&&_.preventDefault&&m.preventDefault(),(c=u.options)!=null&&c.stopPropagation&&m.stopPropagation(),s(u.commandName))})},handleKeyUp:m=>{const u=n.value.indexOf(m.key);u>=0&&n.value.splice(u,1)},registerHotkey:(m,u,_)=>{i.value.push({keys:m,commandName:u,options:_})}}}const XH=()=>{const s=me(new Map),n=m=>s.value.has(m),i=(m,u)=>{if(s.value.has(m))throw new Error(`Command "${m}" already exists`);s.value.set(m,u)},o=(m,u=false,..._)=>{if(!s.value.has(m)){if(u)throw new Error(`[CommandHandler] Command ${m} not registered`);return}return s.value.get(m).execute(..._)},l=(m,u=false,..._)=>{if(!s.value.has(m)){if(u)throw new Error(`[CommandHandler] Command ${m} not registered`);return false}return s.value.get(m).canExecute(_)},f=jH(o);return zi({hasCommand:n,registerCommand:i,executeCommand:o,canExecuteCommand:l,...f})};Ke({props:{intf:{type:Object,required:true}},setup(s){return{onClick:()=>{s.intf.callback&&s.intf.callback()}}}});const Sy=9;function KH(s){return"validate"in s}const xI=(s,n=3)=>{const i=me(null),o=me(false),l=me(false),f=me("0"),m=_e(()=>{const p=s.value.value.toFixed(n);return p.length>Sy?s.value.value.toExponential(Sy-5):p}),u=p=>Number.isNaN(p)?false:KH(s.value)?s.value.validate(p):true,_=p=>{u(p)&&(s.value.value=p)};return kt(f,()=>{l.value=false}),{editMode:o,invalid:l,tempValue:f,inputEl:i,stringRepresentation:m,validate:u,setValue:_,enterEditMode:async()=>{f.value=s.value.value.toFixed(n),o.value=true,await rs(),i.value&&i.value.focus()},leaveEditMode:()=>{const p=parseFloat(f.value);u(p)?(_(p),o.value=false):l.value=true}}},YH={},qH={xmlns:"http://www.w3.org/2000/svg",class:"baklava-icon",width:"24",height:"24",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"};function JH(s,n){return ne(),ve("svg",qH,n[0]||(n[0]=[de("polyline",{points:"6 9 12 15 18 9"},null,-1)]))}const BI=ds(YH,[["render",JH]]);Ke({components:{"i-arrow":BI},props:{intf:{type:Object,required:true}},setup(s){const n=xI(hn(s,"intf"),0);return{...n,increment:()=>{n.setValue(s.intf.value+1)},decrement:()=>{n.setValue(s.intf.value-1)}}}});const ZH=Ke({components:{"i-arrow":BI},props:{intf:{type:Object,required:true}},setup(s){const n=me(null),i=me(false),o=_e(()=>s.intf.items.find(m=>typeof m=="string"?m===s.intf.value:m.value===s.intf.value)),l=_e(()=>o.value?typeof o.value=="string"?o.value:o.value.text:""),f=m=>{s.intf.value=typeof m=="string"?m:m.value};return LI(n,()=>{i.value=false}),{el:n,open:i,selectedItem:o,selectedText:l,setSelected:f}}}),QH=["title"],eV={class:"__selected"},tV={class:"__text"},sV={class:"__icon"},iV={class:"__dropdown"},nV={class:"item --header"},rV=["onClick"];function oV(s,n,i,o,l,f){const m=gt("i-arrow");return ne(),ve("div",{ref:"el",class:tt(["baklava-select",{"--open":s.open}]),title:s.intf.name,onClick:n[0]||(n[0]=u=>s.open=!s.open)},[de("div",eV,[de("div",tV,Bt(s.selectedText),1),de("div",sV,[De(m)])]),De(ac,{name:"slide-fade"},{default:je(()=>[hi(de("div",iV,[de("div",nV,Bt(s.intf.name),1),(ne(true),ve(Pt,null,pi(s.intf.items,(u,_)=>(ne(),ve("div",{key:_,class:tt(["item",{"--active":u===s.selectedItem}]),onClick:c=>s.setSelected(u)},Bt(typeof u=="string"?u:u.text),11,rV))),128))],512),[[Hi,s.open]])]),_:1})],10,QH)}const aV=ds(ZH,[["render",oV]]);class Im extends _t{constructor(n,i,o){super(n,i),this.component=Wl(aV),this.items=o}}Ke({props:{intf:{type:Object,required:true}},setup(s){const n=me(null),i=xI(hn(s,"intf")),o=me(false),l=me(false),f=_e(()=>Math.min(100,Math.max(0,(s.intf.value-s.intf.min)*100/(s.intf.max-s.intf.min))));return{...i,el:n,percentage:f,mousedown:()=>{i.editMode.value||(l.value=true)},mouseup:()=>{i.editMode.value||(o.value||i.enterEditMode(),l.value=false,o.value=false)},mousemove:h=>{if(i.editMode.value)return;const p=Math.max(s.intf.min,Math.min(s.intf.max,(s.intf.max-s.intf.min)*(h.offsetX/n.value.clientWidth)+s.intf.min));l.value&&(i.setValue(p),o.value=true)},mouseleave:h=>{i.editMode.value||(l.value&&(h.offsetX>=n.value.clientWidth?i.setValue(s.intf.max):h.offsetX<=0&&i.setValue(s.intf.min)),l.value=false,o.value=false)}}}});Ke({props:{intf:{type:Object,required:true}}});const lV=Ke({props:{intf:{type:Object,required:true},modelValue:{type:String,required:true}},emits:["update:modelValue"],setup(s,{emit:n}){return{v:_e({get:()=>s.modelValue,set:o=>{n("update:modelValue",o)}})}}}),cV=["placeholder","title"];function uV(s,n,i,o,l,f){return ne(),ve("div",null,[hi(de("input",{"onUpdate:modelValue":n[0]||(n[0]=m=>s.v=m),type:"text",class:"baklava-input",placeholder:s.intf.name,title:s.intf.name},null,8,cV),[[Ny,s.v]])])}const hV=ds(lV,[["render",uV]]);class Qs extends _t{constructor(){super(...arguments),this.component=Wl(hV)}}Ke({props:{intf:{type:Object,required:true},modelValue:{type:String,required:true}},emits:["update:modelValue"],setup(s,{emit:n}){return{v:_e({get:()=>s.modelValue,set:o=>{n("update:modelValue",o)}})}}});const Ns=[];for(let s=0;s<256;++s)Ns.push((s+256).toString(16).slice(1));function dV(s,n=0){return(Ns[s[n+0]]+Ns[s[n+1]]+Ns[s[n+2]]+Ns[s[n+3]]+"-"+Ns[s[n+4]]+Ns[s[n+5]]+"-"+Ns[s[n+6]]+Ns[s[n+7]]+"-"+Ns[s[n+8]]+Ns[s[n+9]]+"-"+Ns[s[n+10]]+Ns[s[n+11]]+Ns[s[n+12]]+Ns[s[n+13]]+Ns[s[n+14]]+Ns[s[n+15]]).toLowerCase()}let hf;const _V=new Uint8Array(16);function pV(){if(!hf){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");hf=crypto.getRandomValues.bind(crypto)}return hf(_V)}const gV=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),$y={randomUUID:gV};function nh(s,n,i){var o;if($y.randomUUID&&!s)return $y.randomUUID();s=s||{};const l=s.random??((o=s.rng)==null?void 0:o.call(s))??pV();if(l.length<16)throw new Error("Random bytes length must be >= 16");return l[6]=l[6]&15|64,l[8]=l[8]&63|128,dV(l)}const rc="SAVE_SUBGRAPH";function fV(s,n){const i=()=>{const o=s.value;if(!o.template)throw new Error("Graph template property not set");o.template.update(o.save()),o.template.panning=o.panning,o.template.scaling=o.scaling};n.registerCommand(rc,{canExecute:()=>{var o;return s.value!==((o=s.value.editor)==null?void 0:o.graph)},execute:i})}class PI extends Sm{constructor(){super(...arguments),this._title="Subgraph Input",this.inputs={name:new Qs("Name","Input").setPort(false)},this.outputs={placeholder:new _t("Connection",void 0)}}}class UI extends $m{constructor(){super(...arguments),this._title="Subgraph Output",this.inputs={name:new Qs("Name","Output").setPort(false),placeholder:new _t("Connection",void 0)},this.outputs={output:new _t("Output",void 0).setHidden(true)}}}const FI="CREATE_SUBGRAPH",yy=[Ea,va];function mV(s,n,i){const o=()=>s.value.selectedNodes.filter(f=>!yy.includes(f.type)).length>0,l=()=>{const{viewModel:f}=Di(),m=s.value,u=s.value.editor;if(m.selectedNodes.length===0)return;const _=m.selectedNodes.filter(k=>!yy.includes(k.type)),c=_.flatMap(k=>Object.values(k.inputs)),h=_.flatMap(k=>Object.values(k.outputs)),p=m.connections.filter(k=>!h.includes(k.from)&&c.includes(k.to)),T=m.connections.filter(k=>h.includes(k.from)&&!c.includes(k.to)),$=m.connections.filter(k=>h.includes(k.from)&&c.includes(k.to)),S=_.map(k=>k.save()),y=$.map(k=>({id:k.id,from:k.from.id,to:k.to.id})),g=new Map,{xLeft:E,xRight:v,yTop:b}=EV(_);for(const[k,x]of p.entries()){const P=new PI;P.inputs.name.value=x.to.name,S.push({...P.save(),position:{x:v-f.value.settings.nodes.defaultWidth-100,y:b+k*200}}),y.push({id:nh(),from:P.outputs.placeholder.id,to:x.to.id}),g.set(x.to.id,P.graphInterfaceId)}for(const[k,x]of T.entries()){const P=new UI;P.inputs.name.value=x.from.name,S.push({...P.save(),position:{x:E+100,y:b+k*200}}),y.push({id:nh(),from:x.from.id,to:P.inputs.placeholder.id}),g.set(x.from.id,P.graphInterfaceId)}const R=zi(new Rh({connections:y,nodes:S,inputs:[],outputs:[]},u));u.addGraphTemplate(R);const O=u.nodeTypes.get(ba(R));if(!O)throw new Error("Unable to create subgraph: Could not find corresponding graph node type");m.activeTransactions++;const w=zi(new O.type);m.addNode(w);const L=Math.round(_.map(k=>k.position.x).reduce((k,x)=>k+x,0)/_.length),I=Math.round(_.map(k=>k.position.y).reduce((k,x)=>k+x,0)/_.length);w.position.x=L,w.position.y=I,p.forEach(k=>{m.removeConnection(k),m.addConnection(k.from,w.inputs[g.get(k.to.id)])}),T.forEach(k=>{m.removeConnection(k),m.addConnection(w.outputs[g.get(k.from.id)],k.to)}),_.forEach(k=>m.removeNode(k)),m.activeTransactions--,n.canExecuteCommand(rc)&&n.executeCommand(rc),i(R),s.value.panning={...m.panning},s.value.scaling=m.scaling};n.registerCommand(FI,{canExecute:o,execute:l})}function EV(s){const n=s.reduce((l,f)=>{const m=f.position.x;return m<l?m:l},1/0),i=s.reduce((l,f)=>{const m=f.position.y;return m<l?m:l},1/0);return{xLeft:s.reduce((l,f)=>{const m=f.position.x+f.width;return m>l?m:l},-1/0),xRight:n,yTop:i}}class Ry{constructor(n,i){this.type=n,n==="addNode"?this.nodeId=i:this.nodeState=i}undo(n){this.type==="addNode"?this.removeNode(n):this.addNode(n)}redo(n){this.type==="addNode"&&this.nodeState?this.addNode(n):this.type==="removeNode"&&this.nodeId&&this.removeNode(n)}addNode(n){const i=n.editor.nodeTypes.get(this.nodeState.type);if(!i)return;const o=new i.type;n.addNode(o),o.load(this.nodeState),this.nodeId=o.id}removeNode(n){const i=n.nodes.find(o=>o.id===this.nodeId);i&&(this.nodeState=i.save(),n.removeNode(i))}}class Iy{constructor(n,i){if(this.type=n,n==="addConnection")this.connectionId=i;else{const o=i;this.connectionState={id:o.id,from:o.from.id,to:o.to.id}}}undo(n){this.type==="addConnection"?this.removeConnection(n):this.addConnection(n)}redo(n){this.type==="addConnection"&&this.connectionState?this.addConnection(n):this.type==="removeConnection"&&this.connectionId&&this.removeConnection(n)}addConnection(n){const i=n.findNodeInterface(this.connectionState.from),o=n.findNodeInterface(this.connectionState.to);if(!i||!o)return;const l=n.addConnection(i,o);l&&(l.id=this.connectionState.id),this.connectionId=l==null?void 0:l.id}removeConnection(n){const i=n.connections.find(o=>o.id===this.connectionId);i&&(this.connectionState={id:i.id,from:i.from.id,to:i.to.id},n.removeConnection(i))}}class vV{constructor(n){if(this.type="transaction",n.length===0)throw new Error("Can't create a transaction with no steps");this.steps=n}undo(n){for(let i=this.steps.length-1;i>=0;i--)this.steps[i].undo(n)}redo(n){for(let i=0;i<this.steps.length;i++)this.steps[i].redo(n)}}const Pf="UNDO",Uf="REDO",Cm="START_TRANSACTION",Om="COMMIT_TRANSACTION",bV="CLEAR_HISTORY";function TV(s,n){const i=Symbol("HistoryToken"),o=me(200),l=me([]),f=me(false),m=me(-1),u=me(false),_=me([]),c=E=>{if(!f.value)if(u.value)_.value.push(E);else{for(m.value!==l.value.length-1&&(l.value=l.value.slice(0,m.value+1)),l.value.push(E);l.value.length>o.value;)l.value.shift();m.value=l.value.length-1}},h=()=>{u.value=true},p=()=>{u.value=false,_.value.length>0&&(c(new vV(_.value)),_.value=[])},T=()=>l.value.length!==0&&m.value!==-1,$=()=>{T()&&(f.value=true,l.value[m.value--].undo(s.value),f.value=false)},S=()=>l.value.length!==0&&m.value<l.value.length-1,y=()=>{S()&&(f.value=true,l.value[++m.value].redo(s.value),f.value=false)},g=()=>{l.value=[],m.value=-1};return kt(s,(E,v)=>{v&&(v.events.addNode.unsubscribe(i),v.events.removeNode.unsubscribe(i),v.events.addConnection.unsubscribe(i),v.events.removeConnection.unsubscribe(i)),E&&(E.events.addNode.subscribe(i,b=>{c(new Ry("addNode",b.id))}),E.events.removeNode.subscribe(i,b=>{c(new Ry("removeNode",b.save()))}),E.events.addConnection.subscribe(i,b=>{c(new Iy("addConnection",b.id))}),E.events.removeConnection.subscribe(i,b=>{c(new Iy("removeConnection",b))}))},{immediate:true}),n.registerCommand(Pf,{canExecute:T,execute:$}),n.registerCommand(Uf,{canExecute:S,execute:y}),n.registerCommand(Cm,{canExecute:()=>!u.value,execute:h}),n.registerCommand(Om,{canExecute:()=>u.value,execute:p}),n.registerCommand(bV,{canExecute:()=>l.value.length>0,execute:g}),n.registerHotkey(["Control","z"],Pf),n.registerHotkey(["Control","y"],Uf),zi({maxSteps:o})}const Ff="DELETE_NODES";function SV(s,n){n.registerCommand(Ff,{canExecute:()=>s.value.selectedNodes.length>0,execute(){n.executeCommand(Cm);for(let i=s.value.selectedNodes.length-1;i>=0;i--){const o=s.value.selectedNodes[i];s.value.removeNode(o)}n.executeCommand(Om)}}),n.registerHotkey(["Delete"],Ff)}const GI="SWITCH_TO_MAIN_GRAPH";function $V(s,n,i){n.registerCommand(GI,{canExecute:()=>s.value!==s.value.editor.graph,execute:()=>{n.executeCommand(rc),i(s.value.editor.graph)}})}function yV(s,n,i){SV(s,n),mV(s,n,i),fV(s,n),$V(s,n,i)}const Gf="COPY",Hf="PASTE",RV="CLEAR_CLIPBOARD";function IV(s,n,i){const o=Symbol("ClipboardToken"),l=me(""),f=me(""),m=_e(()=>!l.value),u=()=>{l.value="",f.value=""},_=()=>{const p=s.value.selectedNodes.flatMap($=>[...Object.values($.inputs),...Object.values($.outputs)]),T=s.value.connections.filter($=>p.includes($.from)||p.includes($.to)).map($=>({from:$.from.id,to:$.to.id}));f.value=JSON.stringify(T),l.value=JSON.stringify(s.value.selectedNodes.map($=>$.save()))},c=(p,T,$)=>{for(const S of p){let y;if((!$||$==="input")&&(y=Object.values(S.inputs).find(g=>g.id===T)),!y&&(!$||$==="output")&&(y=Object.values(S.outputs).find(g=>g.id===T)),y)return y}},h=()=>{if(m.value)return;const p=new Map,T=JSON.parse(l.value),$=JSON.parse(f.value),S=[],y=[],g=s.value;i.executeCommand(Cm);for(const E of T){const v=n.value.nodeTypes.get(E.type);if(!v){console.warn(`Node type ${E.type} not registered`);return}const b=new v.type,R=b.id;S.push(b),b.hooks.beforeLoad.subscribe(o,O=>{const w=O;return w.position&&(w.position.x+=100,w.position.y+=100),b.hooks.beforeLoad.unsubscribe(o),w}),g.addNode(b),b.load({...E,id:R}),b.id=R,p.set(E.id,R);for(const O of Object.values(b.inputs)){const w=nh();p.set(O.id,w),O.id=w}for(const O of Object.values(b.outputs)){const w=nh();p.set(O.id,w),O.id=w}}for(const E of $){const v=c(S,p.get(E.from),"output"),b=c(S,p.get(E.to),"input");if(!v||!b)continue;const R=g.addConnection(v,b);R&&y.push(R)}return s.value.selectedNodes=S,i.executeCommand(Om),{newNodes:S,newConnections:y}};return i.registerCommand(Gf,{canExecute:()=>s.value.selectedNodes.length>0,execute:_}),i.registerHotkey(["Control","c"],Gf),i.registerCommand(Hf,{canExecute:()=>!m.value,execute:h}),i.registerHotkey(["Control","v"],Hf),i.registerCommand(RV,{canExecute:()=>true,execute:u}),zi({isEmpty:m})}const CV="OPEN_SIDEBAR";function OV(s,n){n.registerCommand(CV,{execute:i=>{s.value.sidebar.nodeId=i,s.value.sidebar.visible=true},canExecute:()=>true})}function wV(s,n){OV(s,n)}const kV="ZOOM_TO_FIT_RECT",AV="ZOOM_TO_FIT_NODES",Vf="ZOOM_TO_FIT_GRAPH";function LV(s,n,i){n.registerCommand(kV,{canExecute:()=>true,execute:o=>HI(s.value,i,o)}),n.registerCommand(AV,{canExecute:()=>true,execute:o=>VI(s.value,i,o)}),n.registerCommand(Vf,{canExecute:()=>s.value.nodes.length>0,execute:()=>NV(s.value,i)}),n.registerHotkey(["f"],Vf)}function HI(s,n,i){const o={left:n.zoomToFit.paddingLeft,right:n.zoomToFit.paddingRight,top:n.zoomToFit.paddingTop,bottom:n.zoomToFit.paddingBottom},f=document.querySelector(".baklava-editor").getBoundingClientRect(),m=Math.max(0,f.width-o.left-o.right),u=Math.max(0,f.height-o.top-o.bottom);i=DV(i);const _=i.x2-i.x1,c=i.y2-i.y1,h=_===0?1/0:m/_,p=c==0?1/0:u/c;let T=Math.min(h,p);(T===0||!Number.isFinite(T))&&(T=1);const $=Math.max(0,m/T-_),S=Math.max(0,u/T-c),y=-i.x1+o.left/T+$/2,g=-i.y1+o.top/T+S/2;s.panning.x=y,s.panning.y=g,s.scaling=T}function VI(s,n,i){if(i.length===0)return;const o=i.map(MV),l={x1:Math.min(...o.map(f=>f.x1)),y1:Math.min(...o.map(f=>f.y1)),x2:Math.max(...o.map(f=>f.x2)),y2:Math.max(...o.map(f=>f.y2))};HI(s,n,l)}function NV(s,n){VI(s,n,s.nodes)}function MV(s){var n,i;const o=document.getElementById(s.id),l=(o==null?void 0:o.offsetWidth)??0,f=(o==null?void 0:o.offsetHeight)??0,m=((n=s.position)==null?void 0:n.x)??0,u=((i=s.position)==null?void 0:i.y)??0;return{x1:m,y1:u,x2:m+l,y2:u+f}}function DV(s){return{x1:Math.min(s.x1,s.x2),y1:Math.min(s.y1,s.y2),x2:Math.max(s.x1,s.x2),y2:Math.max(s.y1,s.y2)}}const xV={},BV={xmlns:"http://www.w3.org/2000/svg",class:"baklava-icon",width:"24",height:"24",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"};function PV(s,n){return ne(),ve("svg",BV,n[0]||(n[0]=[de("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"},null,-1),de("path",{d:"M9 13l-4 -4l4 -4m-4 4h11a4 4 0 0 1 0 8h-1"},null,-1)]))}const UV=ds(xV,[["render",PV]]),FV={},GV={xmlns:"http://www.w3.org/2000/svg",class:"baklava-icon",width:"24",height:"24",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"};function HV(s,n){return ne(),ve("svg",GV,n[0]||(n[0]=[de("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"},null,-1),de("path",{d:"M15 13l4 -4l-4 -4m4 4h-11a4 4 0 0 0 0 8h1"},null,-1)]))}const VV=ds(FV,[["render",HV]]),WV={},zV={xmlns:"http://www.w3.org/2000/svg",class:"baklava-icon",width:"24",height:"24",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"};function jV(s,n){return ne(),ve("svg",zV,n[0]||(n[0]=[de("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"},null,-1),de("line",{x1:"5",y1:"12",x2:"19",y2:"12"},null,-1),de("line",{x1:"5",y1:"12",x2:"11",y2:"18"},null,-1),de("line",{x1:"5",y1:"12",x2:"11",y2:"6"},null,-1)]))}const XV=ds(WV,[["render",jV]]),KV={},YV={xmlns:"http://www.w3.org/2000/svg",class:"baklava-icon",width:"24",height:"24",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"};function qV(s,n){return ne(),ve("svg",YV,n[0]||(n[0]=[de("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"},null,-1),de("path",{d:"M9 5h-2a2 2 0 0 0 -2 2v12a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-12a2 2 0 0 0 -2 -2h-2"},null,-1),de("rect",{x:"9",y:"3",width:"6",height:"4",rx:"2"},null,-1)]))}const JV=ds(KV,[["render",qV]]),ZV={},QV={xmlns:"http://www.w3.org/2000/svg",class:"baklava-icon",width:"24",height:"24",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"};function e3(s,n){return ne(),ve("svg",QV,n[0]||(n[0]=[de("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"},null,-1),de("rect",{x:"8",y:"8",width:"12",height:"12",rx:"2"},null,-1),de("path",{d:"M16 8v-2a2 2 0 0 0 -2 -2h-8a2 2 0 0 0 -2 2v8a2 2 0 0 0 2 2h2"},null,-1)]))}const t3=ds(ZV,[["render",e3]]),s3={},i3={xmlns:"http://www.w3.org/2000/svg",class:"baklava-icon",width:"24",height:"24",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"};function n3(s,n){return ne(),ve("svg",i3,n[0]||(n[0]=[de("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"},null,-1),de("path",{d:"M6 4h10l4 4v10a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2"},null,-1),de("circle",{cx:"12",cy:"14",r:"2"},null,-1),de("polyline",{points:"14 4 14 8 8 8 8 4"},null,-1)]))}const r3=ds(s3,[["render",n3]]),o3={},a3={xmlns:"http://www.w3.org/2000/svg",class:"baklava-icon",width:"24",height:"24",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"};function l3(s,n){return ne(),ve("svg",a3,n[0]||(n[0]=[rh('<path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M10 3h4v4h-4z"></path><path d="M3 17h4v4h-4z"></path><path d="M17 17h4v4h-4z"></path><path d="M7 17l5 -4l5 4"></path><line x1="12" y1="7" x2="12" y2="13"></line>',6)]))}const c3=ds(o3,[["render",l3]]),u3={},h3={xmlns:"http://www.w3.org/2000/svg",class:"baklava-icon",width:"24",height:"24",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"};function d3(s,n){return ne(),ve("svg",h3,n[0]||(n[0]=[rh('<path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M8 8m0 1a1 1 0 0 1 1 -1h6a1 1 0 0 1 1 1v6a1 1 0 0 1 -1 1h-6a1 1 0 0 1 -1 -1z"></path><path d="M12 20v.01"></path><path d="M16 20v.01"></path><path d="M8 20v.01"></path><path d="M4 20v.01"></path><path d="M4 16v.01"></path><path d="M4 12v.01"></path><path d="M4 8v.01"></path><path d="M4 4v.01"></path><path d="M8 4v.01"></path><path d="M12 4v.01"></path><path d="M16 4v.01"></path><path d="M20 4v.01"></path><path d="M20 8v.01"></path><path d="M20 12v.01"></path><path d="M20 16v.01"></path><path d="M20 20v.01"></path>',18)]))}const _3=ds(u3,[["render",d3]]),p3={},g3={xmlns:"http://www.w3.org/2000/svg",class:"baklava-icon",width:"24",height:"24",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"};function f3(s,n){return ne(),ve("svg",g3,n[0]||(n[0]=[rh('<path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M4 7l16 0"></path><path d="M10 11l0 6"></path><path d="M14 11l0 6"></path><path d="M5 7l1 12a2 2 0 0 0 2 2h8a2 2 0 0 0 2 -2l1 -12"></path><path d="M9 7v-3a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v3"></path>',6)]))}const m3=ds(p3,[["render",f3]]),E3={},v3={xmlns:"http://www.w3.org/2000/svg",class:"baklava-icon",width:"24",height:"24",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"};function b3(s,n){return ne(),ve("svg",v3,n[0]||(n[0]=[rh('<path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M4 8v-2a2 2 0 0 1 2 -2h2"></path><path d="M4 16v2a2 2 0 0 0 2 2h2"></path><path d="M16 4h2a2 2 0 0 1 2 2v2"></path><path d="M16 20h2a2 2 0 0 0 2 -2v-2"></path><path d="M8 11a3 3 0 1 0 6 0a3 3 0 0 0 -6 0"></path><path d="M16 16l-2.5 -2.5"></path>',7)]))}const T3=ds(E3,[["render",b3]]),S3={COPY:{command:Gf,title:"Copy",icon:t3},PASTE:{command:Hf,title:"Paste",icon:JV},DELETE_NODES:{command:Ff,title:"Delete selected nodes",icon:m3},UNDO:{command:Pf,title:"Undo",icon:UV},REDO:{command:Uf,title:"Redo",icon:VV},ZOOM_TO_FIT_GRAPH:{command:Vf,title:"Zoom to Fit",icon:T3},START_SELECTION_BOX:{command:Vu,title:"Box Select",icon:_3},CREATE_SUBGRAPH:{command:FI,title:"Create Subgraph",icon:c3}},$3=Object.values(S3),y3={SAVE_SUBGRAPH:{command:rc,title:"Save Subgraph",icon:r3},SWITCH_TO_MAIN_GRAPH:{command:GI,title:"Back to Main Graph",icon:XV}},R3=Object.values(y3),I3=s=>!(s instanceof yh);function C3(s,n){return{switchGraph:o=>{let l;if(I3(o))l=new yh(s.value),o.createGraph(l);else{if(o!==s.value.graph)throw new Error("Can only switch using 'Graph' instance when it is the root graph. Otherwise a 'GraphTemplate' must be used.");l=o}n.value&&n.value!==s.value.graph&&n.value.destroy(),l.panning=l.panning??o.panning??{x:0,y:0},l.scaling=l.scaling??o.scaling??1,l.selectedNodes=l.selectedNodes??[],l.sidebar=l.sidebar??{visible:false,nodeId:"",optionName:""},n.value=l}}}function O3(s,n){s.position=s.position??{x:0,y:0},s.disablePointerEvents=false,s.twoColumn=s.twoColumn??false,s.width=s.width??n.defaultWidth}const w3=()=>({useStraightConnections:false,enableMinimap:false,toolbar:{enabled:true,commands:$3,subgraphCommands:R3},palette:{enabled:true},background:{gridSize:100,gridDivision:5,subGridVisibleThreshold:.6},sidebar:{enabled:true,width:300,resizable:true},displayValueOnHover:false,nodes:{defaultWidth:200,maxWidth:320,minWidth:150,resizable:false,reverseY:false},contextMenu:{enabled:true,additionalItems:[]},zoomToFit:{paddingLeft:300,paddingRight:50,paddingTop:110,paddingBottom:50}});function k3(s){const n=me(new MG),i=Symbol("ViewModelToken"),o=me(null),l=gw(o),{switchGraph:f}=C3(n,o),m=_e(()=>l.value&&l.value!==n.value.graph),u=zi(w3()),_=XH(),c=TV(l,_),h=IV(l,n,_),p={renderNode:new Xi(null),renderInterface:new Xi(null)};return yV(l,_,f),wV(l,_),LV(l,_,u),kt(n,(T,$)=>{$&&($.events.registerGraph.unsubscribe(i),$.graphEvents.beforeAddNode.unsubscribe(i),T.nodeHooks.beforeLoad.unsubscribe(i),T.nodeHooks.afterSave.unsubscribe(i),T.graphTemplateHooks.beforeLoad.unsubscribe(i),T.graphTemplateHooks.afterSave.unsubscribe(i),T.graph.hooks.load.unsubscribe(i),T.graph.hooks.save.unsubscribe(i)),T&&(T.nodeHooks.beforeLoad.subscribe(i,(S,y)=>(y.position=S.position??{x:0,y:0},y.width=S.width??u.nodes.defaultWidth,y.twoColumn=S.twoColumn??false,S)),T.nodeHooks.afterSave.subscribe(i,(S,y)=>(S.position=y.position,S.width=y.width,S.twoColumn=y.twoColumn,S)),T.graphTemplateHooks.beforeLoad.subscribe(i,(S,y)=>(y.panning=S.panning,y.scaling=S.scaling,S)),T.graphTemplateHooks.afterSave.subscribe(i,(S,y)=>(S.panning=y.panning,S.scaling=y.scaling,S)),T.graph.hooks.load.subscribe(i,(S,y)=>(y.panning=S.panning,y.scaling=S.scaling,S)),T.graph.hooks.save.subscribe(i,(S,y)=>(S.panning=y.panning,S.scaling=y.scaling,S)),T.graphEvents.beforeAddNode.subscribe(i,S=>O3(S,{defaultWidth:u.nodes.defaultWidth})),n.value.registerNodeType(PI,{category:"Subgraphs"}),n.value.registerNodeType(UI,{category:"Subgraphs"}),f(T.graph))},{immediate:true}),zi({editor:n,displayedGraph:l,isSubgraph:m,settings:u,commandHandler:_,history:c,clipboard:h,hooks:p,switchGraph:f})}function A3(s){let n;return mw({setup(){const i=k3();return n=i,{viewModel:i}},render(){return Wu(zH,{viewModel:this.viewModel})}}).mount(s),n}const L3=Mn({type:"输入",inputs:{name:()=>new Qs("字段名称","").setPort(false)},outputs:{output:()=>new _t("输入值",0)},calculate(){return{}}}),N3=Mn({type:"输出",inputs:{output:()=>new _t("输出值",0)},calculate(){return{}}}),M3=[L3,N3].map(s=>[s,"输入与输出"]),D3=Mn({type:"获取对象属性",inputs:{object:()=>new _t("对象",0),property:()=>new Qs("属性","")},outputs:{value:()=>new _t("值",0)},calculate(){return{}}}),x3=Mn({type:"设置对象属性",inputs:{object:()=>new _t("对象",0),property:()=>new Qs("属性",""),value:()=>new Qs("值","")},outputs:{value:()=>new _t("改变后的对象",0)},calculate(s,n){return{}}}),B3=Tm({type:"创建对象",inputs:{prototype:()=>new Qs("原型，用逗号分隔","").setPort(false)},outputs:{value:()=>new _t("对象",0)},onUpdate(){var s;return{inputs:Object.fromEntries((s=this.inputs.prototype.value)==null?void 0:s.split(",").filter(n=>n).map(n=>[n,()=>new _t(n,0)]))}}}),P3=Tm({type:"分离对象",inputs:{value:()=>new _t("对象",0),prototype:()=>new Qs("原型，用逗号分隔","").setPort(false)},onUpdate(){var s;return{outputs:Object.fromEntries((s=this.inputs.prototype.value)==null?void 0:s.split(",").filter(n=>n).map(n=>[n,()=>new _t(n,0)]))}}}),U3=[B3,P3,D3,x3].map(s=>[s,"对象"]),F3=Mn({type:"二元逻辑运算",inputs:{left:()=>new _t("A",0),right:()=>new _t("B",0),operator:()=>new Im("运算符","A大于B",["A大于B","A小于B","A等于B","A不等于B","A大于等于B","A小于等于B"])},outputs:{value:()=>new _t("输出值",0)}}),G3=Mn({type:"单元逻辑运算",inputs:{value:()=>new _t("值",0),operator:()=>new Im("运算符","!",["取反"])},outputs:{value:()=>new _t("输出值",0)}}),H3=Mn({type:"三元逻辑运算",inputs:{condition:()=>new _t("条件",0),trueValue:()=>new Qs("真值",""),falseValue:()=>new Qs("假值","")},outputs:{value:()=>new _t("输出值",0)}}),V3=[F3,G3,H3].map(s=>[s,"逻辑"]),W3=Tm({type:"字符串模板",inputs:{template:()=>new Qs("模板","").setPort(false)},outputs:{value:()=>new _t("输出","")},onUpdate({template:s}){const n=s.match(/%.+?%/g);return{inputs:n?Object.fromEntries(n.map(i=>i.slice(1,-1)).map(i=>[i,()=>new Qs(i,"")])):void 0}}}),z3=[W3].map(s=>[s,"字符串"]),j3=Mn({type:"数字常量/转为数字",inputs:{value:()=>new Qs("输入","0")},outputs:{value:()=>new _t("输出","0")}}),X3=[j3].map(s=>[s,"数字"]),K3=Mn({type:"队列",inputs:{value:()=>new _t("输入值",0),length:()=>new Qs("长度","10").setPort(false)},outputs:{value:()=>new _t("队列输出",0),overflow:()=>new _t("溢出",0)}}),Y3=[K3].map(s=>[s,"数据结构"]),q3=Mn({type:"HTTP",inputs:{url:()=>new Qs("URL",""),method:()=>new Im("方法","GET",["GET","POST","PUT","DELETE","PATCH","HEAD","OPTIONS"]).setPort(false),headers:()=>new _t("头部",0),body:()=>new _t("主体",0)},outputs:{code:()=>new _t("状态码",0),body:()=>new _t("返回体",0),headers:()=>new _t("返回头部",0)}}),J3=[q3].map(s=>[s,"接口"]),Z3=[...M3,...U3,...V3,...z3,...X3,...Y3,...J3],Q3={style:{height:"100%",width:"100%"}},e4={style:{width:"100%",height:"100%"}},t4=Ke({__name:"data-flow",setup(s){const n=me(null);return Rs(()=>{const i=A3(ue(n));console.info(i),Z3.forEach(o=>i.editor.registerNodeType(o[0],{category:o[1]}))}),(i,o)=>(ne(),ve("div",Q3,[o[0]||(o[0]=de("div",{style:{width:"100%",padding:"5px","padding-left":"20px",height:"25px"}},[de("button",{class:"menu-button"},"退出编辑模式")],-1)),de("div",e4,[de("div",{style:{height:"100%"},ref_key:"baklava_workspace",ref:n},null,512)])]))}}),s4=rr(t4,[["__scopeId","data-v-640d55fc"]]),i4={style:{display:"flex","flex-flow":"column nowrap",height:"100%",width:"100%"}},n4={style:{height:"100%",display:"flex","flex-flow":"column"}},r4={style:{height:"100%"}},o4={style:{position:"fixed",bottom:"0",top:"0",right:"0",width:"400px","background-color":"#ffffff7a","z-index":"1000","backdrop-filter":"blur(50px)","box-shadow":"9px -7px 20px 0px black","background-size":"50px"}},a4={style:{height:"25px",background:"var(--bg1)",display:"flex",width:"100%","z-index":"999"}},l4={style:{"margin-left":"auto","align-self":"center",height:"100%","margin-right":"20px"}},c4=Ke({__name:"index",setup(s){const n=me({import:false,export:false}),i=me(null),o=me(void 0),l=me(false),f=me(false),m=me(false),u=me("blockly"),_=me({}),c=me(null),h=me(0),p=me([]),T=async()=>{try{return await _i("get-all-blockly-blocks")}catch(O){return console.error("获取主页面插件数据失败:",O),null}},$=async()=>{try{const O=await T();O&&Array.isArray(O)&&(p.value=O),h.value++}catch(O){console.error("刷新主页面数据失败:",O)}},S=()=>{if(!o.value)return"主页";const w=(p.value.length>0?p.value:Ir.blockly).find(L=>{var I,k;return((I=L.id)==null?void 0:I.toString())===((k=o.value)==null?void 0:k.toString())});return(w==null?void 0:w.name)??"未命名Koishi代码"},y=me("hidden");let g=me({build:'点击左侧"编译插件"查看'}),E=null;async function v(){await oI(o.value,i.value)}function b(){E&&clearTimeout(E),E=setTimeout(()=>{v(),E=null},1e3)}Rs(async()=>{await $(),kt(o,async(O,w)=>{if(!O)return;l.value=true;const L=await _i("load-blockly-block",parseInt(O.toString()));l.value=false,await rs(()=>{i.value.load(L)}),g.value.build='点击左侧"编译插件"查看'}),kt(y,async(O,w)=>{if(![O,w].includes("hidden"))return;const L=setInterval(()=>{console.info("resize"),i.value.updateSize()},10);setTimeout(()=>{clearInterval(L)},1e3)}),rs(()=>{i.value.setAutoSaveListener(b)})});async function R(O,w){const L=await Vx(O,w);L&&(await $(),o.value=L)}return(O,w)=>{const L=gt("k-empty"),I=gt("k-layout");return ne(),ve(Pt,null,[De($w,{modelValue:n.value.import,"onUpdate:modelValue":w[0]||(w[0]=k=>n.value.import=k),onCallback:R},null,8,["modelValue"]),De(yw,{modelValue:n.value.export,"onUpdate:modelValue":w[1]||(w[1]=k=>n.value.export=k)},null,8,["modelValue"]),De(I,{class:"page-blockly"},{header:je(()=>[xt(" Blockly - "+Bt(S())+" "+Bt(m.value?"保存中...":""),1)]),left:je(()=>[(ne(),Ye(Kx,{key:h.value,blocks:p.value.length>0?p.value:ue(Ir).blockly,current:o.value,"onUpdate:current":w[2]||(w[2]=k=>o.value=k),workspace:i.value,panel:ue(g),dialog:n.value,logger:c.value,"refresh-main":$},null,8,["blocks","current","workspace","panel","dialog","logger"]))]),default:je(()=>[de("div",i4,[de("div",n4,[o.value===void 0&&!f.value?(ne(),Ye(L,{key:0},{default:je(()=>w[13]||(w[13]=[de("div",null,"在左侧选择或创建一个Blockly代码",-1)])),_:1,__:[13]})):Ze("v-if",true),hi((ne(),Ye(Ew,null,[De(SF,{ref_key:"editor",ref:i,flow:_.value,"onUpdate:flow":w[3]||(w[3]=k=>_.value=k),workspace:u.value,"onUpdate:workspace":w[4]||(w[4]=k=>u.value=k)},null,8,["flow","workspace"])],1536)),[[Hi,(u.value==="blockly"||u.value==="meta")&&o.value!=null&&!l.value||f.value]]),hi(de("div",r4,[De(s4,{flow:_.value,"onUpdate:flow":w[5]||(w[5]=k=>_.value=k),workspace:u.value,"onUpdate:workspace":w[6]||(w[6]=k=>u.value=k)},null,8,["flow","workspace"])],512),[[Hi,u.value==="data-flow"&&o.value!=null&&!l.value||f.value]]),De(ac,{name:"meta-ui-change",persisted:""},{default:je(()=>[hi(de("div",o4,[De(oB,{workspace:u.value,"onUpdate:workspace":w[7]||(w[7]=k=>u.value=k),current:o.value,onMetaChange:w[8]||(w[8]=k=>b())},null,8,["workspace","current"])],512),[[Hi,u.value==="meta"&&o.value!=null&&!l.value||f.value]])]),_:1}),Ze(` <div v-show="workspaceType === 'meta' && (currentId!=null && !loading )|| init" style="height: 100%">
        <plugin-meta v-model:workspace="workspaceType" :current="currentId" @metaChange="save()"></plugin-meta>
      </div> `),hi(de("div",null,[o.value===void 0&&!f.value?(ne(),Ye(L,{key:0},{default:je(()=>w[14]||(w[14]=[de("div",null,"Loading...",-1)])),_:1,__:[14]})):Ze("v-if",true)],512),[[Hi,l.value&&!f.value]])]),o.value!=null?(ne(),ve("div",{key:0,class:"transition-animation",style:Hs([{"border-top":"3px solid var(--bg1)",display:"flex","flex-flow":"column nowrap"},{height:y.value.toString()==="hidden"?"25px":"40%"}])},[de("div",a4,[de("div",{style:Hs([{height:"100%",display:"inline-flex","align-self":"center","padding-left":"20px","padding-right":"20px","border-radius":"4px 4px 0px 0px",cursor:"pointer"},{background:y.value=="build"?"var(--bg3)":""}]),onClick:w[9]||(w[9]=k=>y.value="build")},"编译",4),de("div",{style:Hs([{height:"100%",display:"inline-flex","align-self":"center","padding-left":"20px","padding-right":"20px","border-radius":"4px 4px 0px 0px",cursor:"pointer"},{background:y.value=="result"?"var(--bg3)":""}]),onClick:w[10]||(w[10]=k=>y.value="result")},"代码结果",4),de("div",{style:Hs([{height:"100%",display:"inline-flex","align-self":"center","padding-left":"20px","padding-right":"20px","border-radius":"4px 4px 0px 0px",cursor:"pointer"},{background:y.value=="log"?"var(--bg3)":""}]),onClick:w[11]||(w[11]=k=>y.value="log")},"运行日志",4),de("div",l4,[de("div",{style:{height:"18px",width:"18px",background:"var(--bg1)",padding:"2px",margin:"2px"},onClick:w[12]||(w[12]=k=>y.value="hidden")},[De($G)])])]),hi(de("div",{style:Hs([{overflow:"scroll",color:"var(--fg2)",height:"100%",width:"100%",contain:"size"},{background:y.value==="build"?"black":"var(--bg2)"}]),class:"scroll"},[hi(De(RF,{current:o.value,ref_key:"build_console",ref:c,style:{margin:"6px"}},null,8,["current"]),[[Hi,y.value==="build"]]),y.value!="hidden"?hi((ne(),Ye(vG,{key:0,current:o.value,blocklyInformation:ue(g)},null,8,["current","blocklyInformation"])),[[Hi,y.value==="result"]]):Ze("v-if",true)],4),[[Hi,y.value!="hidden"]])],4)):Ze("v-if",true)])]),_:1})],64)}}}),u4=rr(c4,[["__scopeId","data-v-2032188b"]]),h4={},d4={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"};function _4(s,n){return ne(),ve("svg",d4,n[0]||(n[0]=[de("path",{fill:"currentColor",d:"M411.8 207.8C406.2 217.8 395.5 223.1 384 223.1H192C180.5 223.1 169.8 217.8 164.2 207.8C158.5 197.7 158.6 185.4 164.6 175.5L260.6 15.54C266.3 5.897 276.8 0 288 0C299.2 0 309.7 5.898 315.4 15.54L411.4 175.5C417.4 185.4 417.5 197.7 411.8 207.8V207.8zM288 31.1L192 191.1H384L288 31.1zM472 271.1C494.1 271.1 512 289.9 512 311.1V456C512 478.1 494.1 496 472 496H328C305.9 496 288 478.1 288 456V311.1C288 289.9 305.9 271.1 328 271.1H472zM472 303.1H328C323.6 303.1 320 307.6 320 311.1V456C320 460.4 323.6 464 328 464H472C476.4 464 480 460.4 480 456V311.1C480 307.6 476.4 303.1 472 303.1zM256 384C256 454.7 198.7 512 128 512C57.31 512 0 454.7 0 384C0 313.3 57.31 255.1 128 255.1C198.7 255.1 256 313.3 256 384zM128 287.1C74.98 287.1 32 330.1 32 384C32 437 74.98 480 128 480C181 480 224 437 224 384C224 330.1 181 287.1 128 287.1z"},null,-1)]))}const p4=rr(h4,[["render",_4]]);aw.register("blockly",p4);const T4=s=>{s.page({name:"Blockly 可视化编程",path:"/blockly",icon:"blockly",authority:5,component:u4,fields:["blockly"]})};export{T4 as default};
